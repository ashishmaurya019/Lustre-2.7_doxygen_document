<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/ofd/ofd_dev.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/ofd/ofd_dev.c File Reference</h1><code>#include &lt;<a class="el" href="obd__class_8h_source.html">obd_class.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__param_8h_source.html">lustre_param.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__fid_8h_source.html">lustre_fid.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__lfsck_8h_source.html">lustre_lfsck.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__idl_8h_source.html">lustre/lustre_idl.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__dlm_8h_source.html">lustre_dlm.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__quota_8h_source.html">lustre_quota.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__nodemap_8h_source.html">lustre_nodemap.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>&quot;</code><br/>

<p><a href="ofd__dev_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlocked__region.html">locked_region</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>&nbsp;&nbsp;&nbsp;S_FILTER</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a3a5f6b31c127db257ca766d6395c1046">OBD_FAIL_OST_READ_NET</a>&nbsp;&nbsp;&nbsp;OBD_FAIL_OST_BRW_NET</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#abe8655ee7ced4d0fe028b7b0e7e9ca1d">OBD_FAIL_OST_WRITE_NET</a>&nbsp;&nbsp;&nbsp;OBD_FAIL_OST_BRW_NET</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a19ded75b8295ca95e6e986225fc42f14">OST_BRW_READ</a>&nbsp;&nbsp;&nbsp;OST_READ</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a0694fab9e883a2083f97acb017a74e39">OST_BRW_WRITE</a>&nbsp;&nbsp;&nbsp;OST_WRITE</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a4ca01ca1ede242ffd1294c461d6808f8">ofd_connect_to_next</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *m, const char *next, struct <a class="el" href="structobd__export.html">obd_export</a> **exp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Connect OFD to the next device in the stack.  <a href="#a4ca01ca1ede242ffd1294c461d6808f8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#ab1f8ab5e54304e1b1c9a23581d529857">ofd_stack_init</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *m, struct <a class="el" href="structlustre__cfg.html">lustre_cfg</a> *cfg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize stack of devices.  <a href="#ab1f8ab5e54304e1b1c9a23581d529857"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#acc38e4d225251b67c9d81cad12659930">ofd_stack_fini</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *m, struct <a class="el" href="structlu__device.html">lu_device</a> *top)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Finalize the device stack OFD-OSD.  <a href="#acc38e4d225251b67c9d81cad12659930"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a50696c2de5313fbd92a8f1302ccdc40a">match_symlink_param</a> (char *param)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if parameters are symlinks to the OSD.  <a href="#a50696c2de5313fbd92a8f1302ccdc40a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a7d36cd48bea9ce74712a52696b9d6fe8">ofd_process_config</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__device.html">lu_device</a> *d, struct <a class="el" href="structlustre__cfg.html">lustre_cfg</a> *cfg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process various configuration parameters.  <a href="#a7d36cd48bea9ce74712a52696b9d6fe8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a61c7a3d9aad407f0cc5abfdbe4db664a">ofd_object_init</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__object.html">lu_object</a> *o, const struct <a class="el" href="structlu__object__conf.html">lu_object_conf</a> *conf)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structlu__object__operations.html#a15b69dd7ca43e31bee4023da49fbb8a8" title="Allocate lower-layer parts of the object by calling lu_device_operations::ldo_object_alloc()...">lu_object_operations::loo_object_init</a> for OFD.  <a href="#a61c7a3d9aad407f0cc5abfdbe4db664a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a6ce2679ad4f5fd4df37dace8a1d65f0b">ofd_object_free</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__object.html">lu_object</a> *o)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structlu__object__operations.html#a59cf8062ebe405ac01fdcab9d976eed3" title="Dual to lu_device_operations::ldo_object_alloc().">lu_object_operations::loo_object_free</a>.  <a href="#a6ce2679ad4f5fd4df37dace8a1d65f0b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a5e3f686dd562d7a20d2cc24cea21f815">ofd_object_print</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, void *cookie, <a class="el" href="group__lu.html#gac8ccca21472f6dc3ea91d73983740fdc">lu_printer_t</a> p, const struct <a class="el" href="structlu__object.html">lu_object</a> *o)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structlu__object__operations.html#acf091707006dc9d8d216351834d8d974" title="Optional debugging helper.">lu_object_operations::loo_object_print</a>.  <a href="#a5e3f686dd562d7a20d2cc24cea21f815"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__object.html">lu_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a5205246f1469a69bcc54d78aabe80e9b">ofd_object_alloc</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__object__header.html">lu_object_header</a> *hdr, struct <a class="el" href="structlu__device.html">lu_device</a> *d)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="lod__dev_8c.html#a57b562bdcded602b848efc85f2e5c490" title="Implementation of lu_device_operations::ldo_object_alloc() for LOD.">lu_device_operations::lod_object_alloc</a>.  <a href="#a5205246f1469a69bcc54d78aabe80e9b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a441c48c9719a804c09866bfddeb392e0">ofd_lfsck_out_notify</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, void *data, enum <a class="el" href="group__lustreidl.html#gab54acd8a5bcce94c5c2fa2a4c66ff110">lfsck_events</a> event)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the result of LFSCK run to the OFD.  <a href="#a441c48c9719a804c09866bfddeb392e0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#af5a4509c53a70224b8a825233bf4776a">ofd_prepare</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__device.html">lu_device</a> *pdev, struct <a class="el" href="structlu__device.html">lu_device</a> *dev)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structlu__device__operations.html#aae9b682bd4e9a56b8b74ef52ea9a77a9" title="initialize local objects for device.">lu_device_operations::ldo_prepare</a>.  <a href="#af5a4509c53a70224b8a825233bf4776a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#ab0b7aca2c60814ae867ad1f902550306">ofd_recovery_complete</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__device.html">lu_device</a> *dev)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structlu__device__operations.html#a0786583fdaf5ff6bf3f4aaa4e48d3dd9">lu_device_operations::ldo_recovery_complete</a>.  <a href="#ab0b7aca2c60814ae867ad1f902550306"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a4857657b39f13897b740d1b3ccf39a0d">LPROC_SEQ_FOPS</a> (lprocfs_nid_stats_clear)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a02b34314af64cfcc54811168e95292e9">ofd_procfs_init</a> (struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize all needed procfs entries for OFD device.  <a href="#a02b34314af64cfcc54811168e95292e9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a691b2365cbf7513073b26bf06c1864a4">ofd_procfs_add_brw_stats_symlink</a> (struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Expose OSD statistics to OFD layer.  <a href="#a691b2365cbf7513073b26bf06c1864a4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a86076edb38cfc9dd714ef5eea5cb7a4d">ofd_procfs_fini</a> (struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cleanup all procfs entries in OFD.  <a href="#a86076edb38cfc9dd714ef5eea5cb7a4d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a9e84654f575fdd164e707530a9177c29">ofd_fid_fini</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop SEQ/FID server on OFD.  <a href="#a9e84654f575fdd164e707530a9177c29"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a03683c1eafac0ab48333eeb263f06861">ofd_fid_init</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start SEQ/FID server on OFD.  <a href="#a03683c1eafac0ab48333eeb263f06861"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a078aa3b2c42bd8edc2393e15ed5d5232">ofd_set_info_hdl</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OFD request handler for OST_SET_INFO RPC.  <a href="#a078aa3b2c42bd8edc2393e15ed5d5232"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#ad493a8cc1ef417f7c163d365cd3135ed">ofd_fiemap_get</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, struct fiemap *fiemap)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get FIEMAP (FIle Extent MAPping) for object with the given FID.  <a href="#ad493a8cc1ef417f7c163d365cd3135ed"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a3014b7be5ab40f8c3cb64b3a4c181f9c">lock_region</a> (struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *ns, struct <a class="el" href="structldlm__res__id.html">ldlm_res_id</a> *res_id, unsigned long long begin, unsigned long long end, struct <a class="el" href="structlist__head.html">list_head</a> *locked)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Lock single extent and save lock handle in the list.  <a href="#a3014b7be5ab40f8c3cb64b3a4c181f9c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#af1f6a04a69a7523ba577f6fa3d262a77">lock_zero_regions</a> (struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *ns, struct <a class="el" href="structldlm__res__id.html">ldlm_res_id</a> *res_id, struct fiemap *fiemap, struct <a class="el" href="structlist__head.html">list_head</a> *locked)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Lock the sparse areas of given resource.  <a href="#af1f6a04a69a7523ba577f6fa3d262a77"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a06ee5bb6f5484c1e140cafd6049eed33">unlock_zero_regions</a> (struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *ns, struct <a class="el" href="structlist__head.html">list_head</a> *locked)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unlock all previously locked sparse areas for given resource.  <a href="#a06ee5bb6f5484c1e140cafd6049eed33"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#af3d27d973cf2653ee17df593a6241e5b">ofd_get_info_hdl</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OFD request handler for OST_GET_INFO RPC.  <a href="#af3d27d973cf2653ee17df593a6241e5b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a55ab2fbbfe94f4e43ae145ea2cbb9eae">ofd_getattr_hdl</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OFD request handler for OST_GETATTR RPC.  <a href="#a55ab2fbbfe94f4e43ae145ea2cbb9eae"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a47e83abe9acc74e96c33b62058f587f7">ofd_setattr_hdl</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OFD request handler for OST_SETATTR RPC.  <a href="#a47e83abe9acc74e96c33b62058f587f7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a6b087f9b74e92312254d310c3470b3f0">ofd_orphans_destroy</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structobd__export.html">obd_export</a> *exp, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, struct <a class="el" href="structobdo.html">obdo</a> *oa)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy OST orphans.  <a href="#a6b087f9b74e92312254d310c3470b3f0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a173196d00ab98073be92a5d5bef05abd">ofd_create_hdl</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OFD request handler for OST_CREATE RPC.  <a href="#a173196d00ab98073be92a5d5bef05abd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a3c6a5b1c34a5e53346a2451603c8e4ac">ofd_destroy_hdl</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OFD request handler for OST_DESTROY RPC.  <a href="#a3c6a5b1c34a5e53346a2451603c8e4ac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#af6be8cdea32bea774b3422720a4aeabf">ofd_statfs_hdl</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OFD request handler for OST_STATFS RPC.  <a href="#af6be8cdea32bea774b3422720a4aeabf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#ac5e09b8b8e15c8edc8e2f95cbd02b87d">ofd_sync_hdl</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OFD request handler for OST_SYNC RPC.  <a href="#ac5e09b8b8e15c8edc8e2f95cbd02b87d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a0fb7b532e64c93ef55dae7c4982affca">ofd_punch_hdl</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OFD request handler for OST_PUNCH RPC.  <a href="#a0fb7b532e64c93ef55dae7c4982affca"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a34d04f9036e3e6ed94552edbef742de3">ofd_ladvise_hdl</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OFD request handler for OST_LADVISE RPC.  <a href="#a34d04f9036e3e6ed94552edbef742de3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#af7a38823cd81c41cf548b8c567717cb8">ofd_quotactl</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OFD request handler for OST_QUOTACTL RPC.  <a href="#af7a38823cd81c41cf548b8c567717cb8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a89caa0c5b192ff557c996806019da19c">prolong_timeout</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate the amount of time for lock prolongation.  <a href="#a89caa0c5b192ff557c996806019da19c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a12c20538d7a77e621da6e0a1a726f70b">ofd_prolong_one_lock</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi, struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, struct <a class="el" href="structldlm__extent.html">ldlm_extent</a> *extent)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prolong single lock timeout.  <a href="#a12c20538d7a77e621da6e0a1a726f70b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a74d1eec7b173789ee11d9f0db7482d0a">ofd_prolong_extent_locks</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="el" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> end)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prolong lock timeout for the given extent.  <a href="#a74d1eec7b173789ee11d9f0db7482d0a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#ad53c75846f83b05d631a2ff38b6d774f">ofd_rw_hpreq_lock_match</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structptlrpc__hpreq__ops.html#a3c70481ff128411ab4eeb09dc5eac234" title="Check if the lock handle of the given lock is the same as taken from the request...">ptlrpc_hpreq_ops::hpreq_lock_match</a> for OFD RW requests.  <a href="#ad53c75846f83b05d631a2ff38b6d774f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#ac9ee0045255a0e7582b089e481c72f06">ofd_rw_hpreq_check</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of ptlrpc_hpreq_ops::hpreq_lock_check for OFD RW requests.  <a href="#ac9ee0045255a0e7582b089e481c72f06"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a5f5a86e24dc3c797a2b2e484abe27dbb">ofd_rw_hpreq_fini</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of ptlrpc_hpreq_ops::hpreq_lock_fini for OFD RW requests.  <a href="#a5f5a86e24dc3c797a2b2e484abe27dbb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#aafd53a4a1669dc2462e83e3ed63b8ffd">ofd_punch_hpreq_lock_match</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structptlrpc__hpreq__ops.html#a3c70481ff128411ab4eeb09dc5eac234" title="Check if the lock handle of the given lock is the same as taken from the request...">ptlrpc_hpreq_ops::hpreq_lock_match</a> for OST_PUNCH request.  <a href="#aafd53a4a1669dc2462e83e3ed63b8ffd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a5dca3427b2a585ad6aba7bb881112862">ofd_punch_hpreq_check</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of ptlrpc_hpreq_ops::hpreq_lock_check for OST_PUNCH request.  <a href="#a5dca3427b2a585ad6aba7bb881112862"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a81b5a4f0b03a3ce8f31f789e1956f1b7">ofd_punch_hpreq_fini</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of ptlrpc_hpreq_ops::hpreq_lock_fini for OST_PUNCH request.  <a href="#a81b5a4f0b03a3ce8f31f789e1956f1b7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a52bbf692880f326134d4f7048bdece8a">ofd_hp_brw</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Assign high priority operations to an IO request.  <a href="#a52bbf692880f326134d4f7048bdece8a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#abc0899cf42a8240dcb0aea865c0354b7">ofd_hp_punch</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Assign high priority operations to an punch request.  <a href="#abc0899cf42a8240dcb0aea865c0354b7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#aef44539af3831ae3928f810df40adc7e">LU_KEY_INIT_FINI</a> (ofd, struct <a class="el" href="structofd__thread__info.html">ofd_thread_info</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a07ce681cee75414c2db5ebb5a922d950">ofd_key_exit</a> (const struct <a class="el" href="structlu__context.html">lu_context</a> *ctx, struct <a class="el" href="structlu__context__key.html">lu_context_key</a> *key, void *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of lu_context_key::lct_key_exit.  <a href="#a07ce681cee75414c2db5ebb5a922d950"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#ac3a141d87bd16c8d910cad47c0a92c71">ofd_init0</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *m, struct <a class="el" href="structlu__device__type.html">lu_device_type</a> *ldt, struct <a class="el" href="structlustre__cfg.html">lustre_cfg</a> *cfg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize OFD device according to parameters in the config log <em>cfg</em>.  <a href="#ac3a141d87bd16c8d910cad47c0a92c71"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#add6458452ec576caed5b1afff8168be5">ofd_fini</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *m)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop the OFD device.  <a href="#add6458452ec576caed5b1afff8168be5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#ad09f9e60b38319a0dbc4eba5c0666c2d">ofd_device_fini</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__device.html">lu_device</a> *d)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structlu__device__type__operations.html#a9195fd4ea14e00bbe2d9318d60694263" title="Finalize device.">lu_device_type_operations::ldto_device_fini</a>.  <a href="#ad09f9e60b38319a0dbc4eba5c0666c2d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#ad677636a242d0e10784d140707d8eb44">ofd_device_free</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__device.html">lu_device</a> *d)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structlu__device__type__operations.html#a190c1198c588f2ed23ab58052f4001bf" title="Free device.">lu_device_type_operations::ldto_device_free</a>.  <a href="#ad677636a242d0e10784d140707d8eb44"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a429225a2e0fbbe94b4c857ec22297bcc">ofd_device_alloc</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__device__type.html">lu_device_type</a> *t, struct <a class="el" href="structlustre__cfg.html">lustre_cfg</a> *cfg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structlu__device__type__operations.html#acc52dc96707f7a1e4fd5f44c6923e4c6" title="Allocate new device.">lu_device_type_operations::ldto_device_alloc</a>.  <a href="#a429225a2e0fbbe94b4c857ec22297bcc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a6ea0deef575744f23a037dd121abd1c3">LU_TYPE_INIT_FINI</a> (ofd,&amp;<a class="el" href="ofd__internal_8h.html#a5715d5d1456c6eabe4053582059eb50f">ofd_thread_key</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int __init&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a2f860f5002054a79f2e390e75250d35e">ofd_init</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize OFD module.  <a href="#a2f860f5002054a79f2e390e75250d35e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void __exit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a9e418c4606f58c0a62f79e711d674ff7">ofd_exit</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop OFD module.  <a href="#a9e418c4606f58c0a62f79e711d674ff7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#adc10f40acba3bb9b2640e985276b0a7c">MODULE_AUTHOR</a> (&quot;OpenSFS, Inc. &lt;http://www.lustre.org/&gt;&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#af1f64daac0182ca95b29eb8d2dd177dc">MODULE_DESCRIPTION</a> (&quot;Lustre Object Filtering Device&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#ae9c321be2136fb8501887ee69dac11a2">MODULE_VERSION</a> (LUSTRE_VERSION_STRING)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#ad94b36675e7eb067ea3ce6ff9e244a44">MODULE_LICENSE</a> (&quot;GPL&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a18cc0b54e6ebd2b400a2daa25b3a5e86">module_init</a> (ofd_init)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#aeeded45f43c26b4a50efd060acb4a50b">module_exit</a> (ofd_exit)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct kmem_cache *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a0814aa8280da40dec5b35ac1695f0a9f">ofd_object_kmem</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__kmem__descr.html">lu_kmem_descr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a8ddc9f3bf44e39131fa45f333b611a35">ofd_caches</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structcfg__interop__param.html">cfg_interop_param</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#adcaae9239dfa3b5d192da4fa07f1f0f3">ofd_interop_param</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__object__operations.html">lu_object_operations</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a7af9b44974527bcb0de8ffed71c30751">ofd_obj_ops</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__device__operations.html">lu_device_operations</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a651a57c61ce030cf25e3946502d542a7">ofd_lu_ops</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="structlu__device__operations.html" title="Operations common for data and meta-data devices.">lu_device_operations</a> matrix for OFD device.  <a href="#a651a57c61ce030cf25e3946502d542a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structptlrpc__hpreq__ops.html">ptlrpc_hpreq_ops</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a4f9c29777b9ad68a96e857d5bd625746">ofd_hpreq_rw</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structptlrpc__hpreq__ops.html">ptlrpc_hpreq_ops</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a7dba07f262635d2f2a5f75a2fef0c40d">ofd_hpreq_punch</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structtgt__handler.html">tgt_handler</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a75828ea298b6d7f686da4484e1e535ba">ofd_tgt_handlers</a> []</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Table of OFD-specific request handlers.  <a href="#a75828ea298b6d7f686da4484e1e535ba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structtgt__opc__slice.html">tgt_opc_slice</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a2e4707c67c49295bf6b0cbe99f0eb984">ofd_common_slice</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlu__context__key.html">lu_context_key</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a5715d5d1456c6eabe4053582059eb50f">ofd_thread_key</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <br class="typebreak"/>
<a class="el" href="structlu__device__type__operations.html">lu_device_type_operations</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#a0cf9eaa0d1f8de729400f603941b1dce">ofd_device_type_ops</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__device__type.html">lu_device_type</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__dev_8c.html#ac38bd0be90d19209a528126d022b37ae">ofd_device_type</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="abda60744d497fcfe370cfd6b2d65c7ed"></a><!-- doxytag: member="ofd_dev.c::DEBUG_SUBSYSTEM" ref="abda60744d497fcfe370cfd6b2d65c7ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_SUBSYSTEM&nbsp;&nbsp;&nbsp;S_FILTER</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00069">69</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3a5f6b31c127db257ca766d6395c1046"></a><!-- doxytag: member="ofd_dev.c::OBD_FAIL_OST_READ_NET" ref="a3a5f6b31c127db257ca766d6395c1046" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OBD_FAIL_OST_READ_NET&nbsp;&nbsp;&nbsp;OBD_FAIL_OST_BRW_NET</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02675">2675</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="abe8655ee7ced4d0fe028b7b0e7e9ca1d"></a><!-- doxytag: member="ofd_dev.c::OBD_FAIL_OST_WRITE_NET" ref="abe8655ee7ced4d0fe028b7b0e7e9ca1d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OBD_FAIL_OST_WRITE_NET&nbsp;&nbsp;&nbsp;OBD_FAIL_OST_BRW_NET</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02676">2676</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="a19ded75b8295ca95e6e986225fc42f14"></a><!-- doxytag: member="ofd_dev.c::OST_BRW_READ" ref="a19ded75b8295ca95e6e986225fc42f14" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OST_BRW_READ&nbsp;&nbsp;&nbsp;OST_READ</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02677">2677</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0694fab9e883a2083f97acb017a74e39"></a><!-- doxytag: member="ofd_dev.c::OST_BRW_WRITE" ref="a0694fab9e883a2083f97acb017a74e39" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OST_BRW_WRITE&nbsp;&nbsp;&nbsp;OST_WRITE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02678">2678</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a3014b7be5ab40f8c3cb64b3a4c181f9c"></a><!-- doxytag: member="ofd_dev.c::lock_region" ref="a3014b7be5ab40f8c3cb64b3a4c181f9c" args="(struct ldlm_namespace *ns, struct ldlm_res_id *res_id, unsigned long long begin, unsigned long long end, struct list_head *locked)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int lock_region </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *&nbsp;</td>
          <td class="paramname"> <em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__res__id.html">ldlm_res_id</a> *&nbsp;</td>
          <td class="paramname"> <em>res_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long long&nbsp;</td>
          <td class="paramname"> <em>begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long long&nbsp;</td>
          <td class="paramname"> <em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlist__head.html">list_head</a> *&nbsp;</td>
          <td class="paramname"> <em>locked</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Lock single extent and save lock handle in the list. </p>
<p>This is supplemental function for <a class="el" href="ofd__dev_8c.html#af1f6a04a69a7523ba577f6fa3d262a77" title="Lock the sparse areas of given resource.">lock_zero_regions()</a>. It allocates new <a class="el" href="structlocked__region.html">locked_region</a> structure and locks it with extent lock, then adds it to the list of all such regions.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ns</em>&nbsp;</td><td>LDLM namespace </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>res_id</em>&nbsp;</td><td>resource ID </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>begin</em>&nbsp;</td><td>start of region </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>end</em>&nbsp;</td><td>end of region </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>locked</em>&nbsp;</td><td>list head of regions list</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful locking </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l01017">1017</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00141">D_OTHER</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="packet-lustre_8c_source.html#l00293">LCK_PR</a>, <a class="el" href="ofd__dev_8c_source.html#l00998">locked_region::lh</a>, <a class="el" href="ofd__dev_8c_source.html#l00997">locked_region::list</a>, <a class="el" href="list_8h_source.html#l00076">list_add()</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, and <a class="el" href="tgt__handler_8c_source.html#l01676">tgt_extent_lock()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01060">lock_zero_regions()</a>.</p>

</div>
</div>
<a class="anchor" id="af1f6a04a69a7523ba577f6fa3d262a77"></a><!-- doxytag: member="ofd_dev.c::lock_zero_regions" ref="af1f6a04a69a7523ba577f6fa3d262a77" args="(struct ldlm_namespace *ns, struct ldlm_res_id *res_id, struct fiemap *fiemap, struct list_head *locked)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int lock_zero_regions </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *&nbsp;</td>
          <td class="paramname"> <em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__res__id.html">ldlm_res_id</a> *&nbsp;</td>
          <td class="paramname"> <em>res_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct fiemap *&nbsp;</td>
          <td class="paramname"> <em>fiemap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlist__head.html">list_head</a> *&nbsp;</td>
          <td class="paramname"> <em>locked</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Lock the sparse areas of given resource. </p>
<p>The locking of sparse areas will cause dirty data to be flushed back from clients. This is used when getting the FIEMAP of an object to make sure there is no unaccounted cached data on clients.</p>
<p>This function goes through <em>fiemap</em> list of extents and locks only sparse areas between extents.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ns</em>&nbsp;</td><td>LDLM namespace </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>res_id</em>&nbsp;</td><td>resource ID </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fiemap</em>&nbsp;</td><td>file extents mapping on disk </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>locked</em>&nbsp;</td><td>list head of regions list</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l01060">1060</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="mdsrate_8c_source.html#l00130">begin</a>, <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00141">D_OTHER</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="ofd__dev_8c_source.html#l01017">lock_region()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01136">ofd_get_info_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="a4857657b39f13897b740d1b3ccf39a0d"></a><!-- doxytag: member="ofd_dev.c::LPROC_SEQ_FOPS" ref="a4857657b39f13897b740d1b3ccf39a0d" args="(lprocfs_nid_stats_clear)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LPROC_SEQ_FOPS </td>
          <td>(</td>
          <td class="paramtype">lprocfs_nid_stats_clear&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aef44539af3831ae3928f810df40adc7e"></a><!-- doxytag: member="ofd_dev.c::LU_KEY_INIT_FINI" ref="aef44539af3831ae3928f810df40adc7e" args="(ofd, struct ofd_thread_info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LU_KEY_INIT_FINI </td>
          <td>(</td>
          <td class="paramtype">ofd&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__thread__info.html">ofd_thread_info</a>&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6ea0deef575744f23a037dd121abd1c3"></a><!-- doxytag: member="ofd_dev.c::LU_TYPE_INIT_FINI" ref="a6ea0deef575744f23a037dd121abd1c3" args="(ofd,&amp;ofd_thread_key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LU_TYPE_INIT_FINI </td>
          <td>(</td>
          <td class="paramtype">ofd&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&nbsp;</td>
          <td class="paramname"> <em>ofd_thread_key</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a50696c2de5313fbd92a8f1302ccdc40a"></a><!-- doxytag: member="ofd_dev.c::match_symlink_param" ref="a50696c2de5313fbd92a8f1302ccdc40a" args="(char *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool match_symlink_param </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>param</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check if parameters are symlinks to the OSD. </p>
<p>Some parameters were moved from ofd to osd and only their symlinks were kept in ofd by LU-3106. They are: -writehthrough_cache_enable -readcache_max_filesize -read_cache_enable -brw_stats</p>
<p>Since they are not included by the static lprocfs var list, a pre-check is added for them to avoid "unknown param" errors. If they are matched in this check, they will be passed to the OSD directly.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>param</em>&nbsp;</td><td>parameters to check</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>true</em>&nbsp;</td><td>if param is symlink to OSD param false otherwise </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00283">283</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="obd__config_8c_source.html#l00190">class_match_param()</a>, and <a class="el" href="lustre__param_8h_source.html#l00106">PARAM_OST</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l00319">ofd_process_config()</a>.</p>

</div>
</div>
<a class="anchor" id="adc10f40acba3bb9b2640e985276b0a7c"></a><!-- doxytag: member="ofd_dev.c::MODULE_AUTHOR" ref="adc10f40acba3bb9b2640e985276b0a7c" args="(&quot;OpenSFS, Inc. &lt;http://www.lustre.org/&gt;&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MODULE_AUTHOR </td>
          <td>(</td>
          <td class="paramtype">&quot;&nbsp;</td>
          <td class="paramname"> <em>OpenSFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Inc.&lt; http://www.lustre.org/&gt;&quot;&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af1f64daac0182ca95b29eb8d2dd177dc"></a><!-- doxytag: member="ofd_dev.c::MODULE_DESCRIPTION" ref="af1f64daac0182ca95b29eb8d2dd177dc" args="(&quot;Lustre Object Filtering Device&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MODULE_DESCRIPTION </td>
          <td>(</td>
          <td class="paramtype">&quot;Lustre Object Filtering Device&quot;&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aeeded45f43c26b4a50efd060acb4a50b"></a><!-- doxytag: member="ofd_dev.c::module_exit" ref="aeeded45f43c26b4a50efd060acb4a50b" args="(ofd_exit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_exit </td>
          <td>(</td>
          <td class="paramtype">ofd_exit&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a18cc0b54e6ebd2b400a2daa25b3a5e86"></a><!-- doxytag: member="ofd_dev.c::module_init" ref="a18cc0b54e6ebd2b400a2daa25b3a5e86" args="(ofd_init)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_init </td>
          <td>(</td>
          <td class="paramtype">ofd_init&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad94b36675e7eb067ea3ce6ff9e244a44"></a><!-- doxytag: member="ofd_dev.c::MODULE_LICENSE" ref="ad94b36675e7eb067ea3ce6ff9e244a44" args="(&quot;GPL&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MODULE_LICENSE </td>
          <td>(</td>
          <td class="paramtype">&quot;GPL&quot;&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae9c321be2136fb8501887ee69dac11a2"></a><!-- doxytag: member="ofd_dev.c::MODULE_VERSION" ref="ae9c321be2136fb8501887ee69dac11a2" args="(LUSTRE_VERSION_STRING)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MODULE_VERSION </td>
          <td>(</td>
          <td class="paramtype">LUSTRE_VERSION_STRING&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a4ca01ca1ede242ffd1294c461d6808f8"></a><!-- doxytag: member="ofd_dev.c::ofd_connect_to_next" ref="a4ca01ca1ede242ffd1294c461d6808f8" args="(const struct lu_env *env, struct ofd_device *m, const char *next, struct obd_export **exp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_connect_to_next </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> **&nbsp;</td>
          <td class="paramname"> <em>exp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Connect OFD to the next device in the stack. </p>
<p>This function is used for device stack configuration and links OFD device with bottom OSD device.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>m</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>next</em>&nbsp;</td><td>name of next device in the stack </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>export to return</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>and export in <em>exp</em> if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00110">110</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="genops_8c_source.html#l00429">class_name2obd()</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00283">lu_device::ld_site</a>, <a class="el" href="lu__object_8h_source.html#l00619">lu_site::ls_top_dev</a>, <a class="el" href="dt__object_8h_source.html#l01743">lu2dt_dev()</a>, <a class="el" href="lustre__ver_8h_source.html#l00023">LUSTRE_VERSION_CODE</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__class_8h_source.html#l00796">obd_connect()</a>, <a class="el" href="lustre__idl_8h_source.html#l01184">OBD_CONNECT_VERSION</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="obd_8h_source.html#l00595">obd_device::obd_lu_dev</a>, <a class="el" href="obd_8h_source.html#l00598">obd_device::obd_uuid</a>, <a class="el" href="lustre__idl_8h_source.html#l01336">obd_connect_data::ocd_connect_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l01337">obd_connect_data::ocd_version</a>, <a class="el" href="ofd__internal_8h_source.html#l00117">ofd_device::ofd_dt_dev</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__internal_8h_source.html#l00119">ofd_device::ofd_osd_exp</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l00163">ofd_stack_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a173196d00ab98073be92a5d5bef05abd"></a><!-- doxytag: member="ofd_dev.c::ofd_create_hdl" ref="a173196d00ab98073be92a5d5bef05abd" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_create_hdl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OFD request handler for OST_CREATE RPC. </p>
<p>This is OFD-specific part of request handling. Its main purpose is to create new data objects on OST, but it also used to destroy orphans.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l01553">1553</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__time_8h_source.html#l00056">cfs_time_after()</a>, <a class="el" href="libcfs__time_8h_source.html#l00067">cfs_time_shift()</a>, <a class="el" href="genops_8c_source.html#l00803">class_export_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00148">D_HA</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="obd__support_8h_source.html#l00130">DISK_TIMEOUT</a>, <a class="el" href="lustre__user_8h_source.html#l00223">DOSTID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__export_8h_source.html#l00219">obd_export::exp_conn_cnt</a>, <a class="el" href="lustre__idl_8h_source.html#l00457">fid_seq_is_idif()</a>, <a class="el" href="lustre__idl_8h_source.html#l00347">fid_seq_is_mdt()</a>, <a class="el" href="lustre__idl_8h_source.html#l00342">fid_seq_is_mdt0()</a>, <a class="el" href="lustre__idl_8h_source.html#l00472">fid_seq_is_norm()</a>, <a class="el" href="lustre__idl_8h_source.html#l00279">FID_SEQ_OST_MDT0</a>, <a class="el" href="lustre__idl_8h_source.html#l00706">fid_to_ostid()</a>, <a class="el" href="ofd__internal_8h_source.html#l00298">ofd_thread_info::fti_fid</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lustre__idl_8h_source.html#l00320">IDIF_MAX_OID</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs__debug_8h_source.html#l00284">LCONSOLE_WARN</a>, <a class="el" href="ofd__internal_8h_source.html#l00081">LPROC_OFD_STATS_CREATE</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="lustre__fid_8h_source.html#l00182">LUSTRE_DATA_SEQ_MAX_WIDTH</a>, <a class="el" href="pack__generic_8c_source.html#l01188">lustre_msg_get_conn_cnt()</a>, <a class="el" href="pack__generic_8c_source.html#l00829">lustre_msg_get_flags()</a>, <a class="el" href="lustre__idl_8h_source.html#l01154">MSG_REPLAY</a>, <a class="el" href="lustre__idl_8h_source.html#l03398">obdo::o_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l03384">obdo::o_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l03486">ost_body::oa</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00301">OBD_FAIL_OST_EROFS</a>, <a class="el" href="lustre__idl_8h_source.html#l01427">OBD_FL_DELORPHAN</a>, <a class="el" href="lustre__idl_8h_source.html#l01430">OBD_FL_RECREATE_OBJS</a>, <a class="el" href="lustre__idl_8h_source.html#l01667">OBD_MD_FLFLAGS</a>, <a class="el" href="lustre__idl_8h_source.html#l01679">OBD_MD_FLGROUP</a>, <a class="el" href="lustre__idl_8h_source.html#l01656">OBD_MD_FLID</a>, <a class="el" href="ofd__internal_8h_source.html#l00089">ofd_counter_incr()</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__grant_8c_source.html#l01264">ofd_grant_commit()</a>, <a class="el" href="ofd__grant_8c_source.html#l01172">ofd_grant_create()</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00191">ofd_device::ofd_lastid_gen</a>, <a class="el" href="ofd__internal_8h_source.html#l00175">ofd_device::ofd_lastid_rebuilding</a>, <a class="el" href="ofd__internal_8h_source.html#l00190">ofd_device::ofd_lastid_rwsem</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00202">ofd_obd()</a>, <a class="el" href="ofd__obd_8c_source.html#l00411">ofd_obd_disconnect()</a>, <a class="el" href="ofd__dev_8c_source.html#l01461">ofd_orphans_destroy()</a>, <a class="el" href="ofd__fs_8c_source.html#l00061">ofd_precreate_batch()</a>, <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>, <a class="el" href="ofd__fs_8c_source.html#l00164">ofd_seq_last_oid()</a>, <a class="el" href="ofd__fs_8c_source.html#l00181">ofd_seq_last_oid_set()</a>, <a class="el" href="ofd__fs_8c_source.html#l00362">ofd_seq_load()</a>, <a class="el" href="ofd__fs_8c_source.html#l00109">ofd_seq_put()</a>, <a class="el" href="lustre__user_8h_source.html#l00219">ost_id::oi_fid</a>, <a class="el" href="ofd__internal_8h_source.html#l00110">ofd_seq::os_create_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00113">ofd_seq::os_destroys_in_progress</a>, <a class="el" href="ofd__internal_8h_source.html#l00108">ofd_seq::os_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l01770">OST_MAX_PRECREATE</a>, <a class="el" href="lustre__idl_8h_source.html#l00546">ostid_id()</a>, <a class="el" href="lustre__idl_8h_source.html#l00531">ostid_seq()</a>, <a class="el" href="lustre__idl_8h_source.html#l00594">ostid_set_id()</a>, <a class="el" href="lustre__user_8h_source.html#l00224">POSTID</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01105">RMF_OST_BODY</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="lu__target_8h_source.html#l00334">tgt_ses_req()</a>, <a class="el" href="lu__target_8h_source.html#l00203">tgt_session_info::tsi_env</a>, <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>, <a class="el" href="lu__target_8h_source.html#l00227">tgt_session_info::tsi_jobid</a>, <a class="el" href="lu__target_8h_source.html#l00207">tgt_session_info::tsi_ost_body</a>, <a class="el" href="lu__target_8h_source.html#l00193">tgt_session_info::tsi_pill</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="a3c6a5b1c34a5e53346a2451603c8e4ac"></a><!-- doxytag: member="ofd_dev.c::ofd_destroy_hdl" ref="a3c6a5b1c34a5e53346a2451603c8e4ac" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_destroy_hdl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OFD request handler for OST_DESTROY RPC. </p>
<p>This is OFD-specific part of request handling. It destroys data objects related to destroyed object on MDT.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l01825">1825</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00148">D_HA</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="lustre__user_8h_source.html#l00223">DOSTID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__idl_8h_source.html#l00623">fid_set_id()</a>, <a class="el" href="lustre__idl_8h_source.html#l00706">fid_to_ostid()</a>, <a class="el" href="ofd__internal_8h_source.html#l00298">ofd_thread_info::fti_fid</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__import_8h_source.html#l00074">LATF_SKIP</a>, <a class="el" href="ofd__internal_8h_source.html#l00080">LPROC_OFD_STATS_DESTROY</a>, <a class="el" href="lustre__idl_8h_source.html#l03401">obdo::o_misc</a>, <a class="el" href="lustre__idl_8h_source.html#l03384">obdo::o_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l03486">ost_body::oa</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00301">OBD_FAIL_OST_EROFS</a>, <a class="el" href="lustre__idl_8h_source.html#l01707">OBD_MD_FLOBJCOUNT</a>, <a class="el" href="ofd__internal_8h_source.html#l00089">ofd_counter_incr()</a>, <a class="el" href="ofd__obd_8c_source.html#l00984">ofd_destroy_by_fid()</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="lustre__user_8h_source.html#l00219">ost_id::oi_fid</a>, <a class="el" href="lustre__idl_8h_source.html#l00546">ostid_id()</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="lustre__user_8h_source.html#l00224">POSTID</a>, <a class="el" href="lustre__req__layout_8h_source.html#l00058">RCL_CLIENT</a>, <a class="el" href="layout_8c_source.html#l02117">req_capsule_client_get()</a>, <a class="el" href="layout_8c_source.html#l02396">req_capsule_field_present()</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01033">RMF_DLM_REQ</a>, <a class="el" href="layout_8c_source.html#l01105">RMF_OST_BODY</a>, <a class="el" href="lu__target_8h_source.html#l00334">tgt_ses_req()</a>, <a class="el" href="ofd__internal_8h_source.html#l00527">tsi2ofd_info()</a>, <a class="el" href="lu__target_8h_source.html#l00203">tgt_session_info::tsi_env</a>, <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>, <a class="el" href="lu__target_8h_source.html#l00227">tgt_session_info::tsi_jobid</a>, <a class="el" href="lu__target_8h_source.html#l00207">tgt_session_info::tsi_ost_body</a>, <a class="el" href="lu__target_8h_source.html#l00193">tgt_session_info::tsi_pill</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="a429225a2e0fbbe94b4c857ec22297bcc"></a><!-- doxytag: member="ofd_dev.c::ofd_device_alloc" ref="a429225a2e0fbbe94b4c857ec22297bcc" args="(const struct lu_env *env, struct lu_device_type *t, struct lustre_cfg *cfg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structlu__device.html">lu_device</a>* ofd_device_alloc </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__device__type.html">lu_device_type</a> *&nbsp;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlustre__cfg.html">lustre_cfg</a> *&nbsp;</td>
          <td class="paramname"> <em>cfg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structlu__device__type__operations.html#acc52dc96707f7a1e4fd5f44c6923e4c6" title="Allocate new device.">lu_device_type_operations::ldto_device_alloc</a>. </p>
<p>This function allocates the new OFD device. It is called from <a class="el" href="obd__class_8h.html#ac3189c63ab8e2015875d803ad1b5e80e">obd_setup()</a> if OBD device had <a class="el" href="structlu__device__type.html" title="Type of device.">lu_device_type</a> defined.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>t</em>&nbsp;</td><td><a class="el" href="structlu__device__type.html" title="Type of device.">lu_device_type</a> of OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cfg</em>&nbsp;</td><td>configuration log</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pointer</em>&nbsp;</td><td>to the <a class="el" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a> of just allocated OFD </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ERR_PTR</em>&nbsp;</td><td>of return value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l03069">3069</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="dt__object_8c_source.html#l00157">dt_device_init()</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="ofd__dev_8c_source.html#l03046">ofd_device_free()</a>, <a class="el" href="ofd__internal_8h_source.html#l00117">ofd_device::ofd_dt_dev</a>, and <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="ad09f9e60b38319a0dbc4eba5c0666c2d"></a><!-- doxytag: member="ofd_dev.c::ofd_device_fini" ref="ad09f9e60b38319a0dbc4eba5c0666c2d" args="(const struct lu_env *env, struct lu_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structlu__device.html">lu_device</a>* ofd_device_fini </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structlu__device__type__operations.html#a9195fd4ea14e00bbe2d9318d60694263" title="Finalize device.">lu_device_type_operations::ldto_device_fini</a>. </p>
<p>Finalize device. Dual to ofd_device_init(). It is called from <a class="el" href="obd__class_8h.html#aeb2e9551024e3a64759e1433690a9995">obd_precleanup()</a> and stops the current device.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td>LU device of OFD</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>NULL</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l03028">3028</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="ofd__internal_8h_source.html#l00197">ofd_dev()</a>, <a class="el" href="ofd__dev_8c_source.html#l02983">ofd_fini()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

</div>
</div>
<a class="anchor" id="ad677636a242d0e10784d140707d8eb44"></a><!-- doxytag: member="ofd_dev.c::ofd_device_free" ref="ad677636a242d0e10784d140707d8eb44" args="(const struct lu_env *env, struct lu_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structlu__device.html">lu_device</a>* ofd_device_free </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structlu__device__type__operations.html#a190c1198c588f2ed23ab58052f4001bf" title="Free device.">lu_device_type_operations::ldto_device_free</a>. </p>
<p>Free OFD device. Dual to <a class="el" href="ofd__dev_8c.html#a429225a2e0fbbe94b4c857ec22297bcc" title="Implementation of lu_device_type_operations::ldto_device_alloc.">ofd_device_alloc()</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td>LU device of OFD</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>NULL</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l03046">3046</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="dt__object_8c_source.html#l00164">dt_device_fini()</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="ofd__internal_8h_source.html#l00197">ofd_dev()</a>, <a class="el" href="ofd__internal_8h_source.html#l00117">ofd_device::ofd_dt_dev</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l03069">ofd_device_alloc()</a>.</p>

</div>
</div>
<a class="anchor" id="a9e418c4606f58c0a62f79e711d674ff7"></a><!-- doxytag: member="ofd_dev.c::ofd_exit" ref="a9e418c4606f58c0a62f79e711d674ff7" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void __exit ofd_exit </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stop OFD module. </p>
<p>This function is called upon OFD module unloading. It frees all related structures and unregisters OFD device type. </p>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l03148">3148</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="genops_8c_source.html#l00246">class_unregister_type()</a>, <a class="el" href="lu__object_8c_source.html#l02275">lu_kmem_fini()</a>, <a class="el" href="obd_8h_source.html#l00462">LUSTRE_OST_NAME</a>, and <a class="el" href="ofd__fmd_8c_source.html#l00340">ofd_fmd_exit()</a>.</p>

</div>
</div>
<a class="anchor" id="a9e84654f575fdd164e707530a9177c29"></a><!-- doxytag: member="ofd_dev.c::ofd_fid_fini" ref="a9e84654f575fdd164e707530a9177c29" args="(const struct lu_env *env, struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_fid_fini </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stop SEQ/FID server on OFD. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00802">802</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="ofd__internal_8h_source.html#l00186">ofd_device::ofd_seq_site</a>, and <a class="el" href="fid__handler_8c_source.html#l00603">seq_site_fini()</a>.</p>

<p>Referenced by <a class="el" href="ofd__fs_8c_source.html#l00332">ofd_seqs_fini()</a>, and <a class="el" href="ofd__fs_8c_source.html#l00572">ofd_seqs_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a03683c1eafac0ab48333eeb263f06861"></a><!-- doxytag: member="ofd_dev.c::ofd_fid_init" ref="a03683c1eafac0ab48333eeb263f06861" args="(const struct lu_env *env, struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_fid_init </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start SEQ/FID server on OFD. </p>
<p>The SEQ/FID server on OFD is needed to allocate FIDs for new objects. It also connects to the master server to get own FID sequence (SEQ) range to this particular OFD. Typically that happens when the OST is first formatted or in the rare case that it exhausts the local sequence range.</p>
<p>The sequence range is allocated out to the MDTs for OST object allocations, and not directly to the clients.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00824">824</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00645">lu_site::ld_seq_site</a>, <a class="el" href="lu__object_8h_source.html#l00283">lu_device::ld_site</a>, <a class="el" href="lustre__disk_8h_source.html#l00344">lr_server_data::lsd_osd_index</a>, <a class="el" href="lustre__idl_8h_source.html#l00156">lu_seq_range::lsr_index</a>, <a class="el" href="lustre__fid_8h_source.html#l00395">lu_server_seq::lss_space</a>, <a class="el" href="lustre__fid_8h_source.html#l00340">LUSTRE_SEQ_DATA</a>, <a class="el" href="lustre__fid_8h_source.html#l00344">LUSTRE_SEQ_SERVER</a>, <a class="el" href="lu__target_8h_source.html#l00144">lu_target::lut_lsd</a>, <a class="el" href="mdt__coordinator_8c_source.html#l01693">name</a>, <a class="el" href="obd__support_8h_source.html#l00708">OBD_ALLOC</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00776">OBD_FREE</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="ofd__internal_8h_source.html#l00117">ofd_device::ofd_dt_dev</a>, <a class="el" href="ofd__internal_8h_source.html#l00125">ofd_device::ofd_lut</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__internal_8h_source.html#l00186">ofd_device::ofd_seq_site</a>, <a class="el" href="fid__request_8c_source.html#l00506">seq_client_fini()</a>, <a class="el" href="fid__request_8c_source.html#l00468">seq_client_init()</a>, <a class="el" href="fid__handler_8c_source.html#l00591">seq_server_fini()</a>, <a class="el" href="fid__handler_8c_source.html#l00501">seq_server_init()</a>, <a class="el" href="fid__handler_8c_source.html#l00058">seq_server_set_cli()</a>, <a class="el" href="lustre__fid_8h_source.html#l00475">seq_server_site::ss_client_seq</a>, <a class="el" href="lustre__fid_8h_source.html#l00450">seq_server_site::ss_lu</a>, <a class="el" href="lustre__fid_8h_source.html#l00454">seq_server_site::ss_node_id</a>, and <a class="el" href="lustre__fid_8h_source.html#l00464">seq_server_site::ss_server_seq</a>.</p>

<p>Referenced by <a class="el" href="ofd__fs_8c_source.html#l00572">ofd_seqs_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ad493a8cc1ef417f7c163d365cd3135ed"></a><!-- doxytag: member="ofd_dev.c::ofd_fiemap_get" ref="ad493a8cc1ef417f7c163d365cd3135ed" args="(const struct lu_env *env, struct ofd_device *ofd, struct lu_fid *fid, struct fiemap *fiemap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_fiemap_get </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct fiemap *&nbsp;</td>
          <td class="paramname"> <em>fiemap</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get FIEMAP (FIle Extent MAPping) for object with the given FID. </p>
<p>This function returns a list of extents which describes how a file's blocks are laid out on the disk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fiemap</em>&nbsp;</td><td>fiemap structure to fill with data</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if <em>fiemap</em> is filled with data successfully </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00973">973</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="dt__object_8h_source.html#l02426">dt_fiemap_get()</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>, <a class="el" href="ofd__internal_8h_source.html#l00230">ofd_object_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00102">ofd_object_find()</a>, <a class="el" href="ofd__objects_8c_source.html#l00174">ofd_object_put()</a>, <a class="el" href="ofd__internal_8h_source.html#l00255">ofd_read_lock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00263">ofd_read_unlock()</a>, and <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l00651">ofd_get_info()</a>, and <a class="el" href="ofd__dev_8c_source.html#l01136">ofd_get_info_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="add6458452ec576caed5b1afff8168be5"></a><!-- doxytag: member="ofd_dev.c::ofd_fini" ref="add6458452ec576caed5b1afff8168be5" args="(const struct lu_env *env, struct ofd_device *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_fini </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stop the OFD device. </p>
<p>This function stops the OFD device and all its subsystems. This is the end of OFD lifecycle.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>m</em>&nbsp;</td><td>OFD device </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02983">2983</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00287">lu_device::ld_obd</a>, <a class="el" href="lu__object_8h_source.html#l00271">lu_device::ld_ref</a>, <a class="el" href="ldlm__resource_8c_source.html#l01007">ldlm_namespace_free_post()</a>, <a class="el" href="ldlm__resource_8c_source.html#l00966">ldlm_namespace_free_prior()</a>, <a class="el" href="lfsck__lib_8c_source.html#l03651">lfsck_degister()</a>, <a class="el" href="lfsck__lib_8c_source.html#l03213">lfsck_stop()</a>, <a class="el" href="lustre__lfsck__user_8h_source.html#l00219">lfsck_stop::ls_flags</a>, <a class="el" href="lustre__lfsck__user_8h_source.html#l00090">LS_PAUSED</a>, <a class="el" href="lustre__lfsck__user_8h_source.html#l00218">lfsck_stop::ls_status</a>, <a class="el" href="genops_8c_source.html#l01583">obd_exports_barrier()</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_force</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="obd_8h_source.html#l00641">obd_device::obd_namespace</a>, <a class="el" href="genops_8c_source.html#l01745">obd_zombie_barrier()</a>, <a class="el" href="ofd__internal_8h_source.html#l00117">ofd_device::ofd_dt_dev</a>, <a class="el" href="ofd__fs_8c_source.html#l00666">ofd_fs_cleanup()</a>, <a class="el" href="ofd__internal_8h_source.html#l00125">ofd_device::ofd_lut</a>, <a class="el" href="ofd__internal_8h_source.html#l00122">ofd_device::ofd_namespace</a>, <a class="el" href="ofd__internal_8h_source.html#l00202">ofd_obd()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__dev_8c_source.html#l00783">ofd_procfs_fini()</a>, <a class="el" href="ofd__dev_8c_source.html#l00220">ofd_stack_fini()</a>, <a class="el" href="ofd__io_8c_source.html#l00288">ofd_stop_inconsistency_verification_thread()</a>, <a class="el" href="obd__mount__server_8c_source.html#l00193">server_put_mount()</a>, <a class="el" href="mdt__internal_8h.html#ac3db3f215fff161c7d1276d6217b1bfc">target_recovery_fini()</a>, and <a class="el" href="tgt__main_8c_source.html#l00283">tgt_fini()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l03028">ofd_device_fini()</a>.</p>

</div>
</div>
<a class="anchor" id="af3d27d973cf2653ee17df593a6241e5b"></a><!-- doxytag: member="ofd_dev.c::ofd_get_info_hdl" ref="af3d27d973cf2653ee17df593a6241e5b" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_get_info_hdl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OFD request handler for OST_GET_INFO RPC. </p>
<p>This is OFD-specific part of request handling. The OFD-specific keys are:</p>
<ul>
<li>KEY_LAST_ID (obsolete)</li>
<li>KEY_FIEMAP</li>
<li>KEY_LAST_FID</li>
</ul>
<p>This function reads needed data from storage and fills reply with it.</p>
<p>Note: the KEY_LAST_ID is obsolete, replaced by KEY_LAST_FID on newer MDTs, and is kept for compatibility.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l01136">1136</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00148">D_HA</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__net_8h_source.html#l01302">DEBUG_REQ</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__target_8h_source.html#l00498">err_serious()</a>, <a class="el" href="lustre__idl_8h_source.html#l00772">fid_le_to_cpu()</a>, <a class="el" href="ll__fiemap_8h_source.html#l00056">fiemap_count_to_size()</a>, <a class="el" href="ofd__internal_8h_source.html#l00306">ofd_thread_info::fti_ostid</a>, <a class="el" href="ofd__internal_8h_source.html#l00301">ofd_thread_info::fti_resid</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="obd_8h_source.html#l00743">KEY_FIEMAP</a>, <a class="el" href="obd__support_8h_source.html#l00860">KEY_IS</a>, <a class="el" href="obd_8h_source.html#l00750">KEY_LAST_FID</a>, <a class="el" href="obd_8h_source.html#l00749">KEY_LAST_ID</a>, <a class="el" href="lustre__idl_8h_source.html#l03493">ll_fiemap_info_key::lfik_fiemap</a>, <a class="el" href="lustre__idl_8h_source.html#l03492">ll_fiemap_info_key::lfik_oa</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="ofd__dev_8c_source.html#l01060">lock_zero_regions()</a>, <a class="el" href="ofd__internal_8h_source.html#l00083">LPROC_OFD_STATS_GET_INFO</a>, <a class="el" href="lustre__disk_8h_source.html#l00344">lr_server_data::lsd_osd_index</a>, <a class="el" href="lu__target_8h_source.html#l00144">lu_target::lut_lsd</a>, <a class="el" href="lustre__idl_8h_source.html#l03398">obdo::o_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l03384">obdo::o_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l01435">OBD_FL_SRVLOCK</a>, <a class="el" href="lustre__idl_8h_source.html#l01667">OBD_MD_FLFLAGS</a>, <a class="el" href="ofd__internal_8h_source.html#l00089">ofd_counter_incr()</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__dev_8c_source.html#l00973">ofd_fiemap_get()</a>, <a class="el" href="ofd__internal_8h_source.html#l00125">ofd_device::ofd_lut</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00122">ofd_device::ofd_namespace</a>, <a class="el" href="ofd__fs_8c_source.html#l00164">ofd_seq_last_oid()</a>, <a class="el" href="ofd__fs_8c_source.html#l00362">ofd_seq_load()</a>, <a class="el" href="ofd__fs_8c_source.html#l00109">ofd_seq_put()</a>, <a class="el" href="lustre__user_8h_source.html#l00219">ost_id::oi_fid</a>, <a class="el" href="ofd__internal_8h_source.html#l00108">ofd_seq::os_oi</a>, <a class="el" href="lustre__fid_8h_source.html#l00652">ost_fid_build_resid()</a>, <a class="el" href="lustre__idl_8h_source.html#l00531">ostid_seq()</a>, <a class="el" href="lustre__idl_8h_source.html#l00659">ostid_to_fid()</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="lustre__req__layout_8h_source.html#l00058">RCL_CLIENT</a>, <a class="el" href="lustre__req__layout_8h_source.html#l00059">RCL_SERVER</a>, <a class="el" href="layout_8c_source.html#l02117">req_capsule_client_get()</a>, <a class="el" href="layout_8c_source.html#l02339">req_capsule_extend()</a>, <a class="el" href="layout_8c_source.html#l02263">req_capsule_get_size()</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="layout_8c_source.html#l01868">req_capsule_server_pack()</a>, <a class="el" href="layout_8c_source.html#l02226">req_capsule_set_size()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01136">RMF_FID</a>, <a class="el" href="layout_8c_source.html#l01146">RMF_FIEMAP_KEY</a>, <a class="el" href="layout_8c_source.html#l01151">RMF_FIEMAP_VAL</a>, <a class="el" href="layout_8c_source.html#l00903">RMF_GETINFO_KEY</a>, <a class="el" href="layout_8c_source.html#l01131">RMF_OBD_ID</a>, <a class="el" href="layout_8c_source.html#l01675">RQF_OST_GET_INFO_FIEMAP</a>, <a class="el" href="layout_8c_source.html#l01665">RQF_OST_GET_INFO_LAST_FID</a>, <a class="el" href="layout_8c_source.html#l01660">RQF_OST_GET_INFO_LAST_ID</a>, <a class="el" href="tgt__handler_8c_source.html#l00051">tgt_name()</a>, <a class="el" href="lu__target_8h_source.html#l00334">tgt_ses_req()</a>, <a class="el" href="tgt__handler_8c_source.html#l00134">tgt_validate_obdo()</a>, <a class="el" href="ofd__internal_8h_source.html#l00527">tsi2ofd_info()</a>, <a class="el" href="lu__target_8h_source.html#l00203">tgt_session_info::tsi_env</a>, <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>, <a class="el" href="lu__target_8h_source.html#l00227">tgt_session_info::tsi_jobid</a>, <a class="el" href="lu__target_8h_source.html#l00193">tgt_session_info::tsi_pill</a>, <a class="el" href="lu__target_8h_source.html#l00204">tgt_session_info::tsi_tgt</a>, and <a class="el" href="ofd__dev_8c_source.html#l01106">unlock_zero_regions()</a>.</p>

</div>
</div>
<a class="anchor" id="a55ab2fbbfe94f4e43ae145ea2cbb9eae"></a><!-- doxytag: member="ofd_dev.c::ofd_getattr_hdl" ref="a55ab2fbbfe94f4e43ae145ea2cbb9eae" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_getattr_hdl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OFD request handler for OST_GETATTR RPC. </p>
<p>This is OFD-specific part of request handling. It finds the OFD object by its FID, gets attributes from storage and packs result to the reply.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l01281">1281</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="dt__object_8c_source.html#l00553">dt_version_get()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00450">LA_GID</a>, <a class="el" href="lu__object_8h_source.html#l00449">LA_UID</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="packet-lustre_8c_source.html#l00293">LCK_PR</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="ofd__internal_8h_source.html#l00076">LPROC_OFD_STATS_GETATTR</a>, <a class="el" href="lu__target_8h_source.html#l00119">lu_target::lut_obd</a>, <a class="el" href="lustre__idl_8h_source.html#l03414">obdo::o_data_version</a>, <a class="el" href="lustre__idl_8h_source.html#l03398">obdo::o_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l03384">obdo::o_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l03486">ost_body::oa</a>, <a class="el" href="lustre__idl_8h_source.html#l01447">OBD_FL_FLUSH</a>, <a class="el" href="lustre__idl_8h_source.html#l01435">OBD_FL_SRVLOCK</a>, <a class="el" href="lustre__idl_8h_source.html#l01714">OBD_MD_FLDATAVERSION</a>, <a class="el" href="lustre__idl_8h_source.html#l01667">OBD_MD_FLFLAGS</a>, <a class="el" href="lustre__idl_8h_source.html#l01679">OBD_MD_FLGROUP</a>, <a class="el" href="lustre__idl_8h_source.html#l01656">OBD_MD_FLID</a>, <a class="el" href="obd_8h_source.html#l00641">obd_device::obd_namespace</a>, <a class="el" href="lustre__idl_8h_source.html#l01767">OBD_OBJECT_EOF</a>, <a class="el" href="linux-obdo_8c_source.html#l00052">obdo_from_la()</a>, <a class="el" href="ofd__objects_8c_source.html#l00778">ofd_attr_get()</a>, <a class="el" href="ofd__internal_8h_source.html#l00089">ofd_counter_incr()</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>, <a class="el" href="ofd__internal_8h_source.html#l00420">ofd_object_find_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00174">ofd_object_put()</a>, <a class="el" href="ofd__internal_8h_source.html#l00055">OFD_VALID_FLAGS</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01105">RMF_OST_BODY</a>, <a class="el" href="lu__target_8h_source.html#l00519">tgt_drop_id()</a>, <a class="el" href="tgt__handler_8c_source.html#l01676">tgt_extent_lock()</a>, <a class="el" href="tgt__handler_8c_source.html#l01709">tgt_extent_unlock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00527">tsi2ofd_info()</a>, <a class="el" href="lu__target_8h_source.html#l00203">tgt_session_info::tsi_env</a>, <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>, <a class="el" href="lu__target_8h_source.html#l00210">tgt_session_info::tsi_fid</a>, <a class="el" href="lu__target_8h_source.html#l00227">tgt_session_info::tsi_jobid</a>, <a class="el" href="lu__target_8h_source.html#l00207">tgt_session_info::tsi_ost_body</a>, <a class="el" href="lu__target_8h_source.html#l00193">tgt_session_info::tsi_pill</a>, <a class="el" href="lu__target_8h_source.html#l00211">tgt_session_info::tsi_resid</a>, <a class="el" href="lu__target_8h_source.html#l00204">tgt_session_info::tsi_tgt</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="a52bbf692880f326134d4f7048bdece8a"></a><!-- doxytag: member="ofd_dev.c::ofd_hp_brw" ref="a52bbf692880f326134d4f7048bdece8a" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_hp_brw </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Assign high priority operations to an IO request. </p>
<p>Check if the incoming request is a candidate for high-priority processing. If it is, assign it a high priority operations table.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02636">2636</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__idl_8h_source.html#l01777">obd_ioobj::ioo_bufcnt</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__idl_8h_source.html#l01757">OBD_BRW_SRVLOCK</a>, <a class="el" href="layout_8c_source.html#l02117">req_capsule_client_get()</a>, <a class="el" href="layout_8c_source.html#l01115">RMF_NIOBUF_REMOTE</a>, <a class="el" href="layout_8c_source.html#l01110">RMF_OBD_IOOBJ</a>, <a class="el" href="lustre__idl_8h_source.html#l01792">niobuf_remote::rnb_flags</a>, <a class="el" href="lu__target_8h_source.html#l00334">tgt_ses_req()</a>, and <a class="el" href="lu__target_8h_source.html#l00193">tgt_session_info::tsi_pill</a>.</p>

</div>
</div>
<a class="anchor" id="abc0899cf42a8240dcb0aea865c0354b7"></a><!-- doxytag: member="ofd_dev.c::ofd_hp_punch" ref="abc0899cf42a8240dcb0aea865c0354b7" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_hp_punch </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Assign high priority operations to an punch request. </p>
<p>Check if the incoming request is a candidate for high-priority processing. If it is, assign it a high priority operations table.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02665">2665</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__idl_8h_source.html#l03398">obdo::o_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l03486">ost_body::oa</a>, <a class="el" href="lustre__idl_8h_source.html#l01435">OBD_FL_SRVLOCK</a>, <a class="el" href="lustre__idl_8h_source.html#l01667">OBD_MD_FLFLAGS</a>, <a class="el" href="lu__target_8h_source.html#l00334">tgt_ses_req()</a>, and <a class="el" href="lu__target_8h_source.html#l00207">tgt_session_info::tsi_ost_body</a>.</p>

</div>
</div>
<a class="anchor" id="a2f860f5002054a79f2e390e75250d35e"></a><!-- doxytag: member="ofd_dev.c::ofd_init" ref="a2f860f5002054a79f2e390e75250d35e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int __init ofd_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize OFD module. </p>
<p>This function is called upon module loading. It registers OFD device type and prepares all in-memory structures used by all OFD devices.</p>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l03123">3123</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="genops_8c_source.html#l00167">class_register_type()</a>, <a class="el" href="lu__object_8c_source.html#l02275">lu_kmem_fini()</a>, <a class="el" href="lu__object_8c_source.html#l02251">lu_kmem_init()</a>, <a class="el" href="obd_8h_source.html#l00462">LUSTRE_OST_NAME</a>, <a class="el" href="ofd__fmd_8c_source.html#l00323">ofd_fmd_init()</a>, and <a class="el" href="ofd__obd_8c_source.html#l01476">ofd_obd_ops</a>.</p>

</div>
</div>
<a class="anchor" id="ac3a141d87bd16c8d910cad47c0a92c71"></a><!-- doxytag: member="ofd_dev.c::ofd_init0" ref="ac3a141d87bd16c8d910cad47c0a92c71" args="(const struct lu_env *env, struct ofd_device *m, struct lu_device_type *ldt, struct lustre_cfg *cfg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_init0 </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__device__type.html">lu_device_type</a> *&nbsp;</td>
          <td class="paramname"> <em>ldt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlustre__cfg.html">lustre_cfg</a> *&nbsp;</td>
          <td class="paramname"> <em>cfg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize OFD device according to parameters in the config log <em>cfg</em>. </p>
<p>This is the main starting point of OFD initialization. It fills all OFD parameters with their initial values and calls other initializing functions to set up all OFD subsystems.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>m</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ldt</em>&nbsp;</td><td>LU device type of OFD </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cfg</em>&nbsp;</td><td>configuration log</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02814">2814</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="linux-time_8h_source.html#l00242">cfs_time_shift_64()</a>, <a class="el" href="genops_8c_source.html#l00429">class_name2obd()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="dt__object_8h_source.html#l02455">dt_conf_get()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="structofd__thread__info.html#a143cbb933e501df87c3b43b854852113">ofd_thread_info::fti_u</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="lustre__cfg_8h_source.html#l00137">lustre_cfg::lcfg_bufcount</a>, <a class="el" href="lu__object_8h_source.html#l00287">lu_device::ld_obd</a>, <a class="el" href="lu__object_8h_source.html#l00279">lu_device::ld_ops</a>, <a class="el" href="lustre__idl_8h_source.html#l00106">LDLM_CB_REPLY_PORTAL</a>, <a class="el" href="lustre__idl_8h_source.html#l00105">LDLM_CB_REQUEST_PORTAL</a>, <a class="el" href="ldlm__resource_8c_source.html#l01052">ldlm_namespace_free()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00305">LDLM_NAMESPACE_GREEDY</a>, <a class="el" href="ldlm__resource_8c_source.html#l00661">ldlm_namespace_new()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00095">LDLM_NAMESPACE_SERVER</a>, <a class="el" href="lustre__dlm_8h_source.html#l00343">LDLM_NS_TYPE_OST</a>, <a class="el" href="ldlm__lock_8c_source.html#l00159">ldlm_register_intent()</a>, <a class="el" href="lu__object_8c_source.html#l01889">lu_env_refill()</a>, <a class="el" href="lustre__cfg_8h_source.html#l00146">LUSTRE_CFG_BUFLEN</a>, <a class="el" href="lustre__cfg_8h_source.html#l00210">lustre_cfg_string()</a>, <a class="el" href="ofd__internal_8h_source.html#l00309">ofd_thread_info::name</a>, <a class="el" href="lustre__dlm_8h_source.html#l00452">ldlm_namespace::ns_lvbo</a>, <a class="el" href="lustre__dlm_8h_source.html#l00458">ldlm_namespace::ns_lvbp</a>, <a class="el" href="obd_8h_source.html#l00644">obd_device::obd_dev_lock</a>, <a class="el" href="obd__support_8h_source.html#l00296">OBD_FAIL_OST_ALL_REPLY_NET</a>, <a class="el" href="obd__support_8h_source.html#l00297">OBD_FAIL_OST_ALL_REQUEST_NET</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_force</a>, <a class="el" href="obd_8h_source.html#l00642">obd_device::obd_ldlm_client</a>, <a class="el" href="obd_8h_source.html#l00595">obd_device::obd_lu_dev</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="obd_8h_source.html#l00641">obd_device::obd_namespace</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_no_conn</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_replayable</a>, <a class="el" href="obd_8h_source.html#l00598">obd_device::obd_uuid</a>, <a class="el" href="obd__target_8h_source.html#l00041">OBT_MAGIC</a>, <a class="el" href="ofd__internal_8h_source.html#l00136">ofd_device::ofd_batch_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00143">ofd_device::ofd_blockbits</a>, <a class="el" href="ofd__internal_8h_source.html#l00168">ofd_device::ofd_brw_size</a>, <a class="el" href="ofd__internal_8h_source.html#l00120">ofd_device::ofd_dt_conf</a>, <a class="el" href="ofd__internal_8h_source.html#l00117">ofd_device::ofd_dt_dev</a>, <a class="el" href="ofd__internal_8h_source.html#l00174">ofd_device::ofd_flags_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00172">ofd_device::ofd_fmd_max_age</a>, <a class="el" href="ofd__internal_8h_source.html#l00068">OFD_FMD_MAX_AGE_DEFAULT</a>, <a class="el" href="ofd__internal_8h_source.html#l00171">ofd_device::ofd_fmd_max_num</a>, <a class="el" href="ofd__internal_8h_source.html#l00067">OFD_FMD_MAX_NUM_DEFAULT</a>, <a class="el" href="ofd__fs_8c_source.html#l00666">ofd_fs_cleanup()</a>, <a class="el" href="ofd__fs_8c_source.html#l00621">ofd_fs_setup()</a>, <a class="el" href="ofd__internal_8h_source.html#l00175">ofd_device::ofd_grant_compat_disable</a>, <a class="el" href="ofd__internal_8h_source.html#l00157">ofd_device::ofd_grant_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00193">ofd_device::ofd_inconsistency_list</a>, <a class="el" href="ofd__internal_8h_source.html#l00194">ofd_device::ofd_inconsistency_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00192">ofd_device::ofd_inconsistency_thread</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00511">ofd_info_init()</a>, <a class="el" href="ofd__dlm_8c_source.html#l00129">ofd_intent_policy()</a>, <a class="el" href="ofd__internal_8h_source.html#l00190">ofd_device::ofd_lastid_rwsem</a>, <a class="el" href="ofd__internal_8h_source.html#l00125">ofd_device::ofd_lut</a>, <a class="el" href="ofd__lvb_8c_source.html#l00383">ofd_lvbo</a>, <a class="el" href="ofd__internal_8h_source.html#l00122">ofd_device::ofd_namespace</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__internal_8h_source.html#l00142">ofd_device::ofd_osfs_age</a>, <a class="el" href="ofd__internal_8h_source.html#l00153">ofd_device::ofd_osfs_inflight</a>, <a class="el" href="ofd__internal_8h_source.html#l00139">ofd_device::ofd_osfs_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00146">ofd_device::ofd_osfs_unstable</a>, <a class="el" href="ofd__internal_8h_source.html#l00135">ofd_device::ofd_precreate_batch</a>, <a class="el" href="ofd__internal_8h_source.html#l00047">OFD_PRECREATE_BATCH_DEFAULT</a>, <a class="el" href="ofd__internal_8h_source.html#l00052">OFD_PRECREATE_BATCH_SMALL</a>, <a class="el" href="ofd__internal_8h_source.html#l00051">OFD_PRECREATE_SMALL_FS</a>, <a class="el" href="ofd__dev_8c_source.html#l00751">ofd_procfs_add_brw_stats_symlink()</a>, <a class="el" href="ofd__dev_8c_source.html#l00783">ofd_procfs_fini()</a>, <a class="el" href="ofd__dev_8c_source.html#l00681">ofd_procfs_init()</a>, <a class="el" href="ofd__internal_8h_source.html#l00175">ofd_device::ofd_raid_degraded</a>, <a class="el" href="ofd__internal_8h_source.html#l00134">ofd_device::ofd_seq_count</a>, <a class="el" href="ofd__internal_8h_source.html#l00554">ofd_slc_set()</a>, <a class="el" href="ofd__internal_8h_source.html#l00188">ofd_device::ofd_soft_sync_limit</a>, <a class="el" href="ofd__internal_8h_source.html#l00070">OFD_SOFT_SYNC_LIMIT_DEFAULT</a>, <a class="el" href="ofd__dev_8c_source.html#l00220">ofd_stack_fini()</a>, <a class="el" href="ofd__dev_8c_source.html#l00163">ofd_stack_init()</a>, <a class="el" href="ofd__io_8c_source.html#l00247">ofd_start_inconsistency_verification_thread()</a>, <a class="el" href="ofd__internal_8h_source.html#l00150">ofd_device::ofd_statfs_inflight</a>, <a class="el" href="ofd__obd_8c_source.html#l00701">ofd_statfs_internal()</a>, <a class="el" href="ofd__internal_8h_source.html#l00175">ofd_device::ofd_syncjournal</a>, <a class="el" href="ofd__internal_8h_source.html#l00159">ofd_device::ofd_tot_dirty</a>, <a class="el" href="ofd__internal_8h_source.html#l00161">ofd_device::ofd_tot_granted</a>, <a class="el" href="ofd__internal_8h_source.html#l00163">ofd_device::ofd_tot_pending</a>, <a class="el" href="lustre__net_8h_source.html#l00107">ONE_MB_BRW_SIZE</a>, <a class="el" href="lustre__user_8h_source.html#l00109">obd_statfs::os_blocks</a>, <a class="el" href="lustre__user_8h_source.html#l00115">obd_statfs::os_bsize</a>, <a class="el" href="ofd__internal_8h_source.html#l00310">ofd_thread_info::osfs</a>, <a class="el" href="client_8c_source.html#l00074">ptlrpc_init_client()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01532">ptlrpc_thread::t_ctl_waitq</a>, <a class="el" href="tgt__handler_8c_source.html#l01010">tgt_adapt_sptlrpc_conf()</a>, <a class="el" href="tgt__main_8c_source.html#l00283">tgt_fini()</a>, <a class="el" href="tgt__main_8c_source.html#l00147">tgt_init()</a>, <a class="el" href="structobd__device.html#aebe227afed9945c803b5bda6794bb729">obd_device::u</a>, and <a class="el" href="lustre__user_8h_source.html#l00492">obd_uuid::uuid</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l03069">ofd_device_alloc()</a>.</p>

</div>
</div>
<a class="anchor" id="a07ce681cee75414c2db5ebb5a922d950"></a><!-- doxytag: member="ofd_dev.c::ofd_key_exit" ref="a07ce681cee75414c2db5ebb5a922d950" args="(const struct lu_context *ctx, struct lu_context_key *key, void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_key_exit </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__context.html">lu_context</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__context__key.html">lu_context_key</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of lu_context_key::lct_key_exit. </p>
<p>Optional method called on <a class="el" href="group__lu.html#ga85625901fefb6948280ff1e0d4778f61" title="Called after exiting from ctx.">lu_context_exit()</a> for all allocated keys. It is used in OFD to sanitize context values which may be re-used during another request processing by the same thread.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ctx</em>&nbsp;</td><td>execution context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>key</em>&nbsp;</td><td>context key </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td><a class="el" href="structofd__thread__info.html">ofd_thread_info</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02777">2777</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="ofd__internal_8h_source.html#l00292">ofd_thread_info::fti_env</a>, <a class="el" href="ofd__internal_8h_source.html#l00294">ofd_thread_info::fti_exp</a>, <a class="el" href="ofd__internal_8h_source.html#l00296">ofd_thread_info::fti_pre_version</a>, <a class="el" href="ofd__internal_8h_source.html#l00320">ofd_thread_info::fti_used</a>, and <a class="el" href="ofd__internal_8h_source.html#l00295">ofd_thread_info::fti_xid</a>.</p>

</div>
</div>
<a class="anchor" id="a34d04f9036e3e6ed94552edbef742de3"></a><!-- doxytag: member="ofd_dev.c::ofd_ladvise_hdl" ref="a34d04f9036e3e6ed94552edbef742de3" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_ladvise_hdl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OFD request handler for OST_LADVISE RPC. </p>
<p>Tune cache or perfetch policies according to advices.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02118">2118</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__target_8h_source.html#l00498">err_serious()</a>, <a class="el" href="ofd__internal_8h_source.html#l00298">ofd_thread_info::fti_fid</a>, <a class="el" href="lustre__user_8h_source.html#l01411">LADVISE_MAGIC</a>, <a class="el" href="lustre__user_8h_source.html#l01416">ladvise_hdr::lah_count</a>, <a class="el" href="lustre__user_8h_source.html#l01417">ladvise_hdr::lah_flags</a>, <a class="el" href="lustre__user_8h_source.html#l01415">ladvise_hdr::lah_magic</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__user_8h_source.html#l01412">LF_MASK</a>, <a class="el" href="lustre__user_8h_source.html#l01401">lu_ladvise::lla_advice</a>, <a class="el" href="lustre__user_8h_source.html#l01403">lu_ladvise::lla_end</a>, <a class="el" href="lustre__user_8h_source.html#l01402">lu_ladvise::lla_start</a>, <a class="el" href="lustre__disk_8h_source.html#l00344">lr_server_data::lsd_osd_index</a>, <a class="el" href="lu__target_8h_source.html#l00144">lu_target::lut_lsd</a>, <a class="el" href="lustre__idl_8h_source.html#l03384">obdo::o_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l03486">ost_body::oa</a>, <a class="el" href="lustre__idl_8h_source.html#l01656">OBD_MD_FLID</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__internal_8h_source.html#l00511">ofd_info_init()</a>, <a class="el" href="ofd__internal_8h_source.html#l00125">ofd_device::ofd_lut</a>, <a class="el" href="ofd__objects_8c_source.html#l00102">ofd_object_find()</a>, <a class="el" href="ofd__objects_8c_source.html#l00174">ofd_object_put()</a>, <a class="el" href="lustre__idl_8h_source.html#l00659">ostid_to_fid()</a>, <a class="el" href="lustre__req__layout_8h_source.html#l00058">RCL_CLIENT</a>, <a class="el" href="layout_8c_source.html#l02117">req_capsule_client_get()</a>, <a class="el" href="layout_8c_source.html#l02263">req_capsule_get_size()</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01105">RMF_OST_BODY</a>, <a class="el" href="layout_8c_source.html#l01225">RMF_OST_LADVISE</a>, <a class="el" href="layout_8c_source.html#l01219">RMF_OST_LADVISE_HDR</a>, <a class="el" href="lustre__net_8h_source.html#l01121">ptlrpc_request::rq_pill</a>, <a class="el" href="lustre__net_8h_source.html#l00957">ptlrpc_request::rq_status</a>, <a class="el" href="lu__target_8h_source.html#l00334">tgt_ses_req()</a>, <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>, <a class="el" href="lu__target_8h_source.html#l00207">tgt_session_info::tsi_ost_body</a>, and <a class="el" href="lu__target_8h_source.html#l00193">tgt_session_info::tsi_pill</a>.</p>

</div>
</div>
<a class="anchor" id="a441c48c9719a804c09866bfddeb392e0"></a><!-- doxytag: member="ofd_dev.c::ofd_lfsck_out_notify" ref="a441c48c9719a804c09866bfddeb392e0" args="(const struct lu_env *env, void *data, enum lfsck_events event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_lfsck_out_notify </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__lustreidl.html#gab54acd8a5bcce94c5c2fa2a4c66ff110">lfsck_events</a>&nbsp;</td>
          <td class="paramname"> <em>event</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the result of LFSCK run to the OFD. </p>
<p>Notify OFD about result of LFSCK run. That may block the new object creation until problem is fixed by LFSCK.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>pointer to the OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>event</em>&nbsp;</td><td>LFSCK event type</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on unknown event </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00528">528</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="lustre__idl_8h_source.html#l03458">LE_LASTID_REBUILDING</a>, <a class="el" href="lustre__idl_8h_source.html#l03459">LE_LASTID_REBUILT</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="ofd__internal_8h_source.html#l00191">ofd_device::ofd_lastid_gen</a>, <a class="el" href="ofd__internal_8h_source.html#l00175">ofd_device::ofd_lastid_rebuilding</a>, <a class="el" href="ofd__internal_8h_source.html#l00190">ofd_device::ofd_lastid_rwsem</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00202">ofd_obd()</a>, and <a class="el" href="ofd__fs_8c_source.html#l00304">ofd_seqs_free()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l00576">ofd_prepare()</a>.</p>

</div>
</div>
<a class="anchor" id="a5205246f1469a69bcc54d78aabe80e9b"></a><!-- doxytag: member="ofd_dev.c::ofd_object_alloc" ref="a5205246f1469a69bcc54d78aabe80e9b" args="(const struct lu_env *env, const struct lu_object_header *hdr, struct lu_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structlu__object.html">lu_object</a>* ofd_object_alloc </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__object__header.html">lu_object_header</a> *&nbsp;</td>
          <td class="paramname"> <em>hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="lod__dev_8c.html#a57b562bdcded602b848efc85f2e5c490" title="Implementation of lu_device_operations::ldo_object_alloc() for LOD.">lu_device_operations::lod_object_alloc</a>. </p>
<p>This function allocates OFD part of compound OFD-OSD object and initializes its header, because OFD is the top device in stack</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hdr</em>&nbsp;</td><td>object header, NULL for OFD </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td><a class="el" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a></td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>allocated</em>&nbsp;</td><td>object if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NULL</em>&nbsp;</td><td>value on failed allocation </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00490">490</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__object_8h_source.html#l00476">lu_object::lo_ops</a>, <a class="el" href="lu__object_8c_source.html#l01280">lu_object_add_top()</a>, <a class="el" href="lu__object_8c_source.html#l01301">lu_object_header_init()</a>, <a class="el" href="lu__object_8c_source.html#l01242">lu_object_init()</a>, <a class="el" href="obd__support_8h_source.html#l00851">OBD_SLAB_ALLOC_PTR_GFP</a>, <a class="el" href="ofd__dev_8c_source.html#l00083">ofd_object_kmem</a>, <a class="el" href="ofd__internal_8h_source.html#l00218">ofd_object::ofo_header</a>, <a class="el" href="ofd__internal_8h_source.html#l00219">ofd_object::ofo_obj</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

</div>
</div>
<a class="anchor" id="a6ce2679ad4f5fd4df37dace8a1d65f0b"></a><!-- doxytag: member="ofd_dev.c::ofd_object_free" ref="a6ce2679ad4f5fd4df37dace8a1d65f0b" args="(const struct lu_env *env, struct lu_object *o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_object_free </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__object.html">lu_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structlu__object__operations.html#a59cf8062ebe405ac01fdcab9d976eed3" title="Dual to lu_device_operations::ldo_object_alloc().">lu_object_operations::loo_object_free</a>. </p>
<p>Finish OFD object lifecycle and free its memory.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>o</em>&nbsp;</td><td>LU object of OFD object </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00434">434</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lu__object_8h_source.html#l00468">lu_object::lo_header</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="lu__object_8c_source.html#l01259">lu_object_fini()</a>, <a class="el" href="lu__object_8c_source.html#l01316">lu_object_header_fini()</a>, <a class="el" href="obd__support_8h_source.html#l00857">OBD_SLAB_FREE_PTR</a>, <a class="el" href="ofd__internal_8h_source.html#l00225">ofd_obj()</a>, <a class="el" href="ofd__dev_8c_source.html#l00083">ofd_object_kmem</a>, and <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>.</p>

</div>
</div>
<a class="anchor" id="a61c7a3d9aad407f0cc5abfdbe4db664a"></a><!-- doxytag: member="ofd_dev.c::ofd_object_init" ref="a61c7a3d9aad407f0cc5abfdbe4db664a" args="(const struct lu_env *env, struct lu_object *o, const struct lu_object_conf *conf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_object_init </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__object.html">lu_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__object__conf.html">lu_object_conf</a> *&nbsp;</td>
          <td class="paramname"> <em>conf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structlu__object__operations.html#a15b69dd7ca43e31bee4023da49fbb8a8" title="Allocate lower-layer parts of the object by calling lu_device_operations::ldo_object_alloc()...">lu_object_operations::loo_object_init</a> for OFD. </p>
<p>Allocate just the next object (OSD) in stack.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>o</em>&nbsp;</td><td><a class="el" href="structlu__object.html" title="Layer in the layered object.">lu_object</a> of OFD object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>conf</em>&nbsp;</td><td>additional configuration parameters, not used here</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00403">403</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__object_8h_source.html#l00279">lu_device::ld_ops</a>, <a class="el" href="structlu__device__operations.html#a2d0d0803131da38c837d16ab6f979fb0">lu_device_operations::ldo_object_alloc</a>, <a class="el" href="lu__object_8h_source.html#l00472">lu_object::lo_dev</a>, <a class="el" href="lu__object_8h_source.html#l00468">lu_object::lo_header</a>, <a class="el" href="lu__object_8c_source.html#l01292">lu_object_add()</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="ofd__internal_8h_source.html#l00197">ofd_dev()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

</div>
</div>
<a class="anchor" id="a5e3f686dd562d7a20d2cc24cea21f815"></a><!-- doxytag: member="ofd_dev.c::ofd_object_print" ref="a5e3f686dd562d7a20d2cc24cea21f815" args="(const struct lu_env *env, void *cookie, lu_printer_t p, const struct lu_object *o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_object_print </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>cookie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__lu.html#gac8ccca21472f6dc3ea91d73983740fdc">lu_printer_t</a>&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__object.html">lu_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structlu__object__operations.html#acf091707006dc9d8d216351834d8d974" title="Optional debugging helper.">lu_object_operations::loo_object_print</a>. </p>
<p>Print OFD part of compound OFD-OSD object. See <a class="el" href="group__lu.html#gac48202c869a59a25988a89207f85ef7f" title="Print human readable representation of the o to the printer.">lu_object_print()</a> and <a class="el" href="group__lu.html#gae0469b00c8c93e0c85eaacfabd33f6aa" title="Print object description followed by a user-supplied message.">LU_OBJECT_DEBUG()</a> for more details about the compound object printing.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cookie</em>&nbsp;</td><td>opaque data passed to the printer function </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>p</em>&nbsp;</td><td>printer function to use </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>o</em>&nbsp;</td><td>LU object of OFD object</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00465">465</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="obd_8h_source.html#l00462">LUSTRE_OST_NAME</a>.</p>

</div>
</div>
<a class="anchor" id="a6b087f9b74e92312254d310c3470b3f0"></a><!-- doxytag: member="ofd_dev.c::ofd_orphans_destroy" ref="a6b087f9b74e92312254d310c3470b3f0" args="(const struct lu_env *env, struct obd_export *exp, struct ofd_device *ofd, struct obdo *oa)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_orphans_destroy </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobdo.html">obdo</a> *&nbsp;</td>
          <td class="paramname"> <em>oa</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destroy OST orphans. </p>
<p>This is part of OST_CREATE RPC handling. If there is flag OBD_FL_DELORPHAN set then we must destroy possible orphaned objects.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>OBD export </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oa</em>&nbsp;</td><td><a class="el" href="structobdo.html">obdo</a> structure for reply</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l01461">1461</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00280">CEMERG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00148">D_HA</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="parser_8c_source.html#l00044">done</a>, <a class="el" href="lustre__user_8h_source.html#l00223">DOSTID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__export_8h_source.html#l00304">exp_connect_flags()</a>, <a class="el" href="lustre__idl_8h_source.html#l00623">fid_set_id()</a>, <a class="el" href="ofd__internal_8h_source.html#l00298">ofd_thread_info::fti_fid</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs__debug_8h_source.html#l00282">LCONSOLE</a>, <a class="el" href="libcfs__private_8h_source.html#l00309">likely</a>, <a class="el" href="lustre__idl_8h_source.html#l03384">obdo::o_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l01217">OBD_CONNECT_SKIP_ORPHAN</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00324">OBD_FAIL_OST_NODESTROY</a>, <a class="el" href="ofd__obd_8c_source.html#l00984">ofd_destroy_by_fid()</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__fs_8c_source.html#l00084">ofd_seq_get()</a>, <a class="el" href="ofd__fs_8c_source.html#l00164">ofd_seq_last_oid()</a>, <a class="el" href="ofd__fs_8c_source.html#l00181">ofd_seq_last_oid_set()</a>, <a class="el" href="ofd__fs_8c_source.html#l00204">ofd_seq_last_oid_write()</a>, <a class="el" href="ofd__fs_8c_source.html#l00109">ofd_seq_put()</a>, <a class="el" href="structost__id.html#a01d44bff8859d8cd3aabe8a4b0c2ee46">ost_id::oi</a>, <a class="el" href="lustre__user_8h_source.html#l00219">ost_id::oi_fid</a>, <a class="el" href="lustre__idl_8h_source.html#l00546">ostid_id()</a>, <a class="el" href="lustre__idl_8h_source.html#l00531">ostid_seq()</a>, <a class="el" href="lustre__idl_8h_source.html#l00594">ostid_set_id()</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="lustre__user_8h_source.html#l00224">POSTID</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="af5a4509c53a70224b8a825233bf4776a"></a><!-- doxytag: member="ofd_dev.c::ofd_prepare" ref="af5a4509c53a70224b8a825233bf4776a" args="(const struct lu_env *env, struct lu_device *pdev, struct lu_device *dev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_prepare </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td>
          <td class="paramname"> <em>pdev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td>
          <td class="paramname"> <em>dev</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structlu__device__operations.html#aae9b682bd4e9a56b8b74ef52ea9a77a9" title="initialize local objects for device.">lu_device_operations::ldo_prepare</a>. </p>
<p>This method is called after layer has been initialized and before it starts serving user requests. In OFD it starts lfsk check routines and initializes recovery.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pdev</em>&nbsp;</td><td>higher device in stack, NULL for OFD </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dev</em>&nbsp;</td><td><a class="el" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a> of OFD device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00576">576</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00045">LASSERTF</a>, <a class="el" href="lu__object_8h_source.html#l00279">lu_device::ld_ops</a>, <a class="el" href="structlu__device__operations.html#aae9b682bd4e9a56b8b74ef52ea9a77a9">lu_device_operations::ldo_prepare</a>, <a class="el" href="lfsck__lib_8c_source.html#l03474">lfsck_register()</a>, <a class="el" href="lfsck__lib_8c_source.html#l03457">lfsck_register_namespace()</a>, <a class="el" href="obd_8h_source.html#l00644">obd_device::obd_dev_lock</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_no_conn</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_recovering</a>, <a class="el" href="ofd__internal_8h_source.html#l00197">ofd_dev()</a>, <a class="el" href="ofd__internal_8h_source.html#l00511">ofd_info_init()</a>, <a class="el" href="ofd__dev_8c_source.html#l00528">ofd_lfsck_out_notify()</a>, <a class="el" href="ofd__internal_8h_source.html#l00125">ofd_device::ofd_lut</a>, <a class="el" href="ofd__internal_8h_source.html#l00122">ofd_device::ofd_namespace</a>, <a class="el" href="ofd__internal_8h_source.html#l00202">ofd_obd()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__obd_8c_source.html#l00541">ofd_postrecov()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="mdt__internal_8h.html#a8c8ebefb0e9c977840de5620dfd7e655">target_recovery_init()</a>, and <a class="el" href="tgt__handler_8c_source.html#l00653">tgt_request_handle()</a>.</p>

</div>
</div>
<a class="anchor" id="a7d36cd48bea9ce74712a52696b9d6fe8"></a><!-- doxytag: member="ofd_dev.c::ofd_process_config" ref="a7d36cd48bea9ce74712a52696b9d6fe8" args="(const struct lu_env *env, struct lu_device *d, struct lustre_cfg *cfg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_process_config </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlustre__cfg.html">lustre_cfg</a> *&nbsp;</td>
          <td class="paramname"> <em>cfg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process various configuration parameters. </p>
<p>This function is used by MGS to process specific configurations and pass them through to the next device in server stack, i.e. the OSD.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td>LU device of OFD </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cfg</em>&nbsp;</td><td>parameters to process</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00319">319</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="obd__config_8c_source.html#l00095">class_find_old_param()</a>, <a class="el" href="obd__config_8c_source.html#l01322">class_process_proc_param()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="libcfs__debug_8h_source.html#l00153">D_CONFIG</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__cfg_8h_source.html#l00130">lustre_cfg::lcfg_command</a>, <a class="el" href="lustre__cfg_8h_source.html#l00086">LCFG_PARAM</a>, <a class="el" href="lustre__cfg_8h_source.html#l00093">LCFG_SPTLRPC_CONF</a>, <a class="el" href="lu__object_8h_source.html#l00287">lu_device::ld_obd</a>, <a class="el" href="lu__object_8h_source.html#l00279">lu_device::ld_ops</a>, <a class="el" href="structlu__device__operations.html#a892c61097c7e02dd33e5a9148d339dae">lu_device_operations::ldo_process_config</a>, <a class="el" href="obd__config_8c_source.html#l01033">lustre_cfg_rename()</a>, <a class="el" href="lustre__cfg_8h_source.html#l00210">lustre_cfg_string()</a>, <a class="el" href="ofd__dev_8c_source.html#l00283">match_symlink_param()</a>, <a class="el" href="lustre__param_8h_source.html#l00057">cfg_interop_param::new_param</a>, <a class="el" href="obd_8h_source.html#l00716">obd_device::obd_vars</a>, <a class="el" href="ofd__internal_8h_source.html#l00197">ofd_dev()</a>, <a class="el" href="ofd__internal_8h_source.html#l00202">ofd_obd()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="lustre__param_8h_source.html#l00056">cfg_interop_param::old_param</a>, <a class="el" href="lustre__param_8h_source.html#l00106">PARAM_OST</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

</div>
</div>
<a class="anchor" id="a691b2365cbf7513073b26bf06c1864a4"></a><!-- doxytag: member="ofd_dev.c::ofd_procfs_add_brw_stats_symlink" ref="a691b2365cbf7513073b26bf06c1864a4" args="(struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_procfs_add_brw_stats_symlink </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Expose OSD statistics to OFD layer. </p>
<p>The osd interfaces to the backend file system exposes useful data such as <a class="el" href="structbrw__stats.html">brw_stats</a> and read or write cache states. This same data needs to be exposed into the obdfilter (ofd) layer to maintain backwards compatibility. This function creates the symlinks in the proc layer to enable this.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00751">751</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="lprocfs__status_8h_source.html#l00942">lprocfs_add_symlink()</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="obd_8h_source.html#l00712">obd_device::obd_proc_entry</a>, <a class="el" href="obd_8h_source.html#l00592">obd_device::obd_type</a>, <a class="el" href="ofd__internal_8h_source.html#l00202">ofd_obd()</a>, <a class="el" href="ofd__internal_8h_source.html#l00119">ofd_device::ofd_osd_exp</a>, and <a class="el" href="obd_8h_source.html#l00111">obd_type::typ_name</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="a86076edb38cfc9dd714ef5eea5cb7a4d"></a><!-- doxytag: member="ofd_dev.c::ofd_procfs_fini" ref="a86076edb38cfc9dd714ef5eea5cb7a4d" args="(struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_procfs_fini </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Cleanup all procfs entries in OFD. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00783">783</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="lprocfs__status_8h_source.html#l00913">lprocfs_free_obd_stats()</a>, <a class="el" href="lprocfs__status_8h_source.html#l00921">lprocfs_free_per_client_stats()</a>, <a class="el" href="lprocfs__status_8h_source.html#l01063">lprocfs_job_stats_fini()</a>, <a class="el" href="lprocfs__status_8h_source.html#l00959">lprocfs_obd_cleanup()</a>, and <a class="el" href="ofd__internal_8h_source.html#l00202">ofd_obd()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02983">ofd_fini()</a>, and <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="a02b34314af64cfcc54811168e95292e9"></a><!-- doxytag: member="ofd_dev.c::ofd_procfs_init" ref="a02b34314af64cfcc54811168e95292e9" args="(struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_procfs_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize all needed procfs entries for OFD device. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00681">681</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="ofd__internal_8h_source.html#l00086">LPROC_OFD_STATS_LAST</a>, <a class="el" href="lprocfs__status_8h_source.html#l00938">lprocfs_add_simple()</a>, <a class="el" href="lprocfs__status_8h_source.html#l00907">lprocfs_alloc_obd_stats()</a>, <a class="el" href="lprocfs__status_8h_source.html#l00913">lprocfs_free_obd_stats()</a>, <a class="el" href="lprocfs__status_8h_source.html#l01066">lprocfs_job_stats_init()</a>, <a class="el" href="lprocfs__status_8h_source.html#l00959">lprocfs_obd_cleanup()</a>, <a class="el" href="lprocfs__status_8h_source.html#l00957">lprocfs_obd_setup()</a>, <a class="el" href="lprocfs__status_8h_source.html#l00949">lprocfs_register()</a>, <a class="el" href="obd__class_8h_source.html#l00620">obd_cleanup()</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="obd_8h_source.html#l00712">obd_device::obd_proc_entry</a>, <a class="el" href="obd_8h_source.html#l00713">obd_device::obd_proc_exports_entry</a>, <a class="el" href="obd_8h_source.html#l00706">obd_device::obd_stats</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_uses_nid_stats</a>, <a class="el" href="obd_8h_source.html#l00716">obd_device::obd_vars</a>, <a class="el" href="ofd__internal_8h_source.html#l00202">ofd_obd()</a>, <a class="el" href="ofd__internal_8h_source.html#l00396">ofd_stats_counter_init()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="a74d1eec7b173789ee11d9f0db7482d0a"></a><!-- doxytag: member="ofd_dev.c::ofd_prolong_extent_locks" ref="a74d1eec7b173789ee11d9f0db7482d0a" args="(struct tgt_session_info *tsi, __u64 start, __u64 end)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_prolong_extent_locks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>end</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prolong lock timeout for the given extent. </p>
<p>This function finds all locks related with incoming request and prolongs their timeout.</p>
<p>If a client is holding a lock for a long time while it sends read or write RPCs to the OST for the object under this lock, then we don't want the OST to evict the client. Otherwise, if the <a class="el" href="structnetwork.html">network</a> or disk is very busy then the client may not be able to make any progress to clear out dirty pages under the lock and the application will fail.</p>
<p>Every time a Bulk Read/Write (BRW) request arrives for the object covered by the lock, extend the timeout on that lock. The RPC should contain a lock handle for the lock it is using, but this isn't handled correctly by all client versions, and the request may cover multiple locks.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>start</em>&nbsp;</td><td>start of extent </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>end</em>&nbsp;</td><td>end of extent</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>number</em>&nbsp;</td><td>of prolonged locks </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02344">2344</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="linux-time_8h_source.html#l00152">cfs_time_current()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__export_8h_source.html#l00274">obd_export::exp_bl_list</a>, <a class="el" href="lustre__export_8h_source.html#l00275">obd_export::exp_bl_list_lock</a>, <a class="el" href="lustre__dlm_8h_source.html#l00901">ldlm_lock::l_exp_list</a>, <a class="el" href="lustre__dlm_8h_source.html#l00754">ldlm_lock::l_export</a>, <a class="el" href="lustre__dlm_8h_source.html#l00633">ldlm_policy_data::l_extent</a>, <a class="el" href="lustre__dlm_8h_source.html#l00778">ldlm_lock::l_flags</a>, <a class="el" href="lustre__dlm_8h_source.html#l00728">ldlm_lock::l_granted_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00803">ldlm_lock::l_last_used</a>, <a class="el" href="lustre__dlm_8h_source.html#l00772">ldlm_lock::l_policy_data</a>, <a class="el" href="lustre__dlm_8h_source.html#l00724">ldlm_lock::l_req_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="packet-lustre_8c_source.html#l00299">LDLM_EXTENT</a>, <a class="el" href="lustre__idl_8h_source.html#l02834">ldlm_extent_contain()</a>, <a class="el" href="lustre__idl_8h_source.html#l02827">ldlm_extent_overlap()</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00062">LDLM_FL_AST_SENT</a>, <a class="el" href="lustre__dlm_8h_source.html#l01273">ldlm_handle2lock()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01327">LDLM_LOCK_PUT</a>, <a class="el" href="lustre__idl_8h_source.html#l02789">ldlm_res_eq()</a>, <a class="el" href="list_8h_source.html#l00459">list_for_each_entry</a>, <a class="el" href="lustre__dlm_8h_source.html#l00951">ldlm_resource::lr_name</a>, <a class="el" href="lustre__dlm_8h_source.html#l00970">ldlm_resource::lr_type</a>, <a class="el" href="lustre__idl_8h_source.html#l03406">obdo::o_handle</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l03486">ost_body::oa</a>, <a class="el" href="lustre__idl_8h_source.html#l01674">OBD_MD_FLHANDLE</a>, <a class="el" href="ofd__dev_8c_source.html#l02292">ofd_prolong_one_lock()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__idl_8h_source.html#l02822">ldlm_extent::start</a>, <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>, <a class="el" href="lu__target_8h_source.html#l00207">tgt_session_info::tsi_ost_body</a>, and <a class="el" href="lu__target_8h_source.html#l00211">tgt_session_info::tsi_resid</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02572">ofd_punch_hpreq_check()</a>, and <a class="el" href="ofd__dev_8c_source.html#l02471">ofd_rw_hpreq_check()</a>.</p>

</div>
</div>
<a class="anchor" id="a12c20538d7a77e621da6e0a1a726f70b"></a><!-- doxytag: member="ofd_dev.c::ofd_prolong_one_lock" ref="a12c20538d7a77e621da6e0a1a726f70b" args="(struct tgt_session_info *tsi, struct ldlm_lock *lock, struct ldlm_extent *extent)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_prolong_one_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__extent.html">ldlm_extent</a> *&nbsp;</td>
          <td class="paramname"> <em>extent</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prolong single lock timeout. </p>
<p>This is supplemental function to the ofd_prolong_locks(). It prolongs a single lock.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lock</em>&nbsp;</td><td>LDLM lock to prolong </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>extent</em>&nbsp;</td><td>related extent </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>timeout</em>&nbsp;</td><td>timeout value to add</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if lock is not suitable for prolongation </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>if lock was prolonged successfully </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02292">2292</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l02823">ldlm_extent::end</a>, <a class="el" href="lustre__dlm_8h_source.html#l00778">ldlm_lock::l_flags</a>, <a class="el" href="lustre__dlm_8h_source.html#l01168">LDLM_DEBUG</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00062">LDLM_FL_AST_SENT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00309">LDLM_FL_DESTROYED</a>, <a class="el" href="ldlm__lockd_8c_source.html#l00600">ldlm_refresh_waiting_lock()</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="ofd__dev_8c_source.html#l02264">prolong_timeout()</a>, <a class="el" href="lustre__idl_8h_source.html#l02822">ldlm_extent::start</a>, <a class="el" href="lu__target_8h_source.html#l00334">tgt_ses_req()</a>, and <a class="el" href="gnilnd__modparams_8c_source.html#l00052">timeout</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02344">ofd_prolong_extent_locks()</a>.</p>

</div>
</div>
<a class="anchor" id="a0fb7b532e64c93ef55dae7c4982affca"></a><!-- doxytag: member="ofd_dev.c::ofd_punch_hdl" ref="a0fb7b532e64c93ef55dae7c4982affca" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_punch_hdl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OFD request handler for OST_PUNCH RPC. </p>
<p>This is part of request processing. Validate request fields, punch (truncate) the given OFD object and pack reply.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02007">2007</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="osd__iam_8h_source.html#l00054">CLASSERT</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="mdsrate_8c_source.html#l00132">end</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__target_8h_source.html#l00498">err_serious()</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="ofd__internal_8h_source.html#l00303">ofd_thread_info::fti_mds_fid</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="linux-obdo_8c_source.html#l00103">la_from_obdo()</a>, <a class="el" href="lu__object_8h_source.html#l00447">LA_SIZE</a>, <a class="el" href="lu__object_8h_source.html#l00409">lu_attr::la_size</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="packet-lustre_8c_source.html#l00299">LDLM_EXTENT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00151">LDLM_FL_AST_DISCARD_DATA</a>, <a class="el" href="lustre__dlm_8h_source.html#l01296">ldlm_res_lvbo_update()</a>, <a class="el" href="ldlm__resource_8c_source.html#l01179">ldlm_resource_get()</a>, <a class="el" href="ldlm__resource_8c_source.html#l01295">ldlm_resource_putref()</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00046">LPD64</a>, <a class="el" href="ofd__internal_8h_source.html#l00078">LPROC_OFD_STATS_PUNCH</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="lu__target_8h_source.html#l00119">lu_target::lut_obd</a>, <a class="el" href="lustre__idl_8h_source.html#l03390">obdo::o_blocks</a>, <a class="el" href="lustre__idl_8h_source.html#l03398">obdo::o_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l03384">obdo::o_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l03386">obdo::o_size</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l03486">ost_body::oa</a>, <a class="el" href="lustre__idl_8h_source.html#l01189">OBD_CONNECT_TRUNCLOCK</a>, <a class="el" href="lustre__idl_8h_source.html#l01435">OBD_FL_SRVLOCK</a>, <a class="el" href="lustre__idl_8h_source.html#l01657">OBD_MD_FLATIME</a>, <a class="el" href="lustre__idl_8h_source.html#l01661">OBD_MD_FLBLOCKS</a>, <a class="el" href="lustre__idl_8h_source.html#l01659">OBD_MD_FLCTIME</a>, <a class="el" href="lustre__idl_8h_source.html#l01680">OBD_MD_FLFID</a>, <a class="el" href="lustre__idl_8h_source.html#l01667">OBD_MD_FLFLAGS</a>, <a class="el" href="lustre__idl_8h_source.html#l01656">OBD_MD_FLID</a>, <a class="el" href="lustre__idl_8h_source.html#l01658">OBD_MD_FLMTIME</a>, <a class="el" href="lustre__idl_8h_source.html#l01660">OBD_MD_FLSIZE</a>, <a class="el" href="obd_8h_source.html#l00641">obd_device::obd_namespace</a>, <a class="el" href="lustre__idl_8h_source.html#l01767">OBD_OBJECT_EOF</a>, <a class="el" href="ofd__internal_8h_source.html#l00089">ofd_counter_incr()</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__internal_8h_source.html#l00420">ofd_object_find_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>, <a class="el" href="ofd__objects_8c_source.html#l00174">ofd_object_put()</a>, <a class="el" href="ofd__internal_8h_source.html#l00562">ofd_prepare_fidea()</a>, <a class="el" href="lustre__idl_8h_source.html#l01302">OST_CONNECT_SUPPORTED</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01105">RMF_OST_BODY</a>, <a class="el" href="rename__many_8c_source.html#l00057">start</a>, <a class="el" href="tgt__handler_8c_source.html#l01676">tgt_extent_lock()</a>, <a class="el" href="tgt__handler_8c_source.html#l01709">tgt_extent_unlock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00527">tsi2ofd_info()</a>, <a class="el" href="lu__target_8h_source.html#l00203">tgt_session_info::tsi_env</a>, <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>, <a class="el" href="lu__target_8h_source.html#l00210">tgt_session_info::tsi_fid</a>, <a class="el" href="lu__target_8h_source.html#l00227">tgt_session_info::tsi_jobid</a>, <a class="el" href="lu__target_8h_source.html#l00207">tgt_session_info::tsi_ost_body</a>, <a class="el" href="lu__target_8h_source.html#l00193">tgt_session_info::tsi_pill</a>, <a class="el" href="lu__target_8h_source.html#l00211">tgt_session_info::tsi_resid</a>, and <a class="el" href="lu__target_8h_source.html#l00204">tgt_session_info::tsi_tgt</a>.</p>

</div>
</div>
<a class="anchor" id="a5dca3427b2a585ad6aba7bb881112862"></a><!-- doxytag: member="ofd_dev.c::ofd_punch_hpreq_check" ref="a5dca3427b2a585ad6aba7bb881112862" args="(struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_punch_hpreq_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of ptlrpc_hpreq_ops::hpreq_lock_check for OST_PUNCH request. </p>
<p>High-priority queue request check for whether the given punch request (<em>req</em>) is blocking an LDLM lock cancel.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>req</em>&nbsp;</td><td>the incoming request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>if <em>req</em> is blocking an LDLM lock cancel </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if it is not </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02572">2572</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00145">D_DLMTRACE</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="lu__object_8c_source.html#l01574">lu_context_key_get()</a>, <a class="el" href="lustre__idl_8h_source.html#l02780">ldlm_res_id::name</a>, <a class="el" href="lustre__idl_8h_source.html#l03390">obdo::o_blocks</a>, <a class="el" href="lustre__idl_8h_source.html#l03398">obdo::o_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l03386">obdo::o_size</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l03486">ost_body::oa</a>, <a class="el" href="lustre__idl_8h_source.html#l01435">OBD_FL_SRVLOCK</a>, <a class="el" href="lustre__idl_8h_source.html#l01667">OBD_MD_FLFLAGS</a>, <a class="el" href="ofd__dev_8c_source.html#l02344">ofd_prolong_extent_locks()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="tgt__handler_8c_source.html#l00051">tgt_name()</a>, <a class="el" href="tgt__main_8c_source.html#l00375">tgt_session_key</a>, <a class="el" href="lu__target_8h_source.html#l00207">tgt_session_info::tsi_ost_body</a>, <a class="el" href="lu__target_8h_source.html#l00211">tgt_session_info::tsi_resid</a>, and <a class="el" href="lu__target_8h_source.html#l00204">tgt_session_info::tsi_tgt</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02610">ofd_punch_hpreq_fini()</a>.</p>

</div>
</div>
<a class="anchor" id="a81b5a4f0b03a3ce8f31f789e1956f1b7"></a><!-- doxytag: member="ofd_dev.c::ofd_punch_hpreq_fini" ref="a81b5a4f0b03a3ce8f31f789e1956f1b7" args="(struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_punch_hpreq_fini </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of ptlrpc_hpreq_ops::hpreq_lock_fini for OST_PUNCH request. </p>
<p>Called after the request has been handled. It refreshes lock timeout again so that client has more time to send lock cancel RPC.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>req</em>&nbsp;</td><td>request which is being processed. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02610">2610</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="ofd__dev_8c_source.html#l02572">ofd_punch_hpreq_check()</a>.</p>

</div>
</div>
<a class="anchor" id="aafd53a4a1669dc2462e83e3ed63b8ffd"></a><!-- doxytag: member="ofd_dev.c::ofd_punch_hpreq_lock_match" ref="aafd53a4a1669dc2462e83e3ed63b8ffd" args="(struct ptlrpc_request *req, struct ldlm_lock *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_punch_hpreq_lock_match </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structptlrpc__hpreq__ops.html#a3c70481ff128411ab4eeb09dc5eac234" title="Check if the lock handle of the given lock is the same as taken from the request...">ptlrpc_hpreq_ops::hpreq_lock_match</a> for OST_PUNCH request. </p>
<p>This function checks if the given lock is the same by its resname, mode and extent as one taken from the request. It is used to give priority to punch/truncate RPCs that might lead to the fastest release of that lock when a lock is contended.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>req</em>&nbsp;</td><td><a class="el" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> being processed </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lock</em>&nbsp;</td><td>contended lock to match</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>if lock is matched </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>otherwise </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02540">2540</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l01017">lustre_handle::cookie</a>, <a class="el" href="lustre__handles_8h_source.html#l00067">portals_handle::h_cookie</a>, <a class="el" href="lustre__dlm_8h_source.html#l00678">ldlm_lock::l_handle</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8c_source.html#l01574">lu_context_key_get()</a>, <a class="el" href="lustre__idl_8h_source.html#l03406">obdo::o_handle</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l03486">ost_body::oa</a>, <a class="el" href="lustre__idl_8h_source.html#l01674">OBD_MD_FLHANDLE</a>, <a class="el" href="tgt__main_8c_source.html#l00375">tgt_session_key</a>, and <a class="el" href="lu__target_8h_source.html#l00207">tgt_session_info::tsi_ost_body</a>.</p>

</div>
</div>
<a class="anchor" id="af7a38823cd81c41cf548b8c567717cb8"></a><!-- doxytag: member="ofd_dev.c::ofd_quotactl" ref="af7a38823cd81c41cf548b8c567717cb8" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_quotactl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OFD request handler for OST_QUOTACTL RPC. </p>
<p>This is part of request processing to validate incoming request fields, get the requested data from OSD and pack reply.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02210">2210</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__target_8h_source.html#l00498">err_serious()</a>, <a class="el" href="ofd__internal_8h_source.html#l00085">LPROC_OFD_STATS_QUOTACTL</a>, <a class="el" href="lquota__lib_8c_source.html#l00158">lquotactl_slv()</a>, <a class="el" href="lu__target_8h_source.html#l00120">lu_target::lut_bottom</a>, <a class="el" href="lustre__nodemap_8h_source.html#l00048">NODEMAP_CLIENT_TO_FS</a>, <a class="el" href="lustre__nodemap_8h_source.html#l00043">NODEMAP_GID</a>, <a class="el" href="nodemap__handler_8c_source.html#l00519">nodemap_map_id()</a>, <a class="el" href="lustre__nodemap_8h_source.html#l00042">NODEMAP_UID</a>, <a class="el" href="ofd__internal_8h_source.html#l00089">ofd_counter_incr()</a>, <a class="el" href="lustre__idl_8h_source.html#l01858">obd_quotactl::qc_id</a>, <a class="el" href="lustre__idl_8h_source.html#l01857">obd_quotactl::qc_type</a>, <a class="el" href="layout_8c_source.html#l02117">req_capsule_client_get()</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l00943">RMF_OBD_QUOTACTL</a>, <a class="el" href="osd__iam_8h_source.html#l01014">swap</a>, <a class="el" href="lu__target_8h_source.html#l00203">tgt_session_info::tsi_env</a>, <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>, <a class="el" href="lu__target_8h_source.html#l00227">tgt_session_info::tsi_jobid</a>, <a class="el" href="lu__target_8h_source.html#l00193">tgt_session_info::tsi_pill</a>, and <a class="el" href="lu__target_8h_source.html#l00204">tgt_session_info::tsi_tgt</a>.</p>

</div>
</div>
<a class="anchor" id="ab0b7aca2c60814ae867ad1f902550306"></a><!-- doxytag: member="ofd_dev.c::ofd_recovery_complete" ref="ab0b7aca2c60814ae867ad1f902550306" args="(const struct lu_env *env, struct lu_device *dev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_recovery_complete </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td>
          <td class="paramname"> <em>dev</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structlu__device__operations.html#a0786583fdaf5ff6bf3f4aaa4e48d3dd9">lu_device_operations::ldo_recovery_complete</a>. </p>
<p>This method notifies all layers about 'recovery complete' event. That means device is in full state and consistent. An OFD calculates available grant space upon this event.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dev</em>&nbsp;</td><td><a class="el" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a> of OFD device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00634">634</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="dt__object_8h_source.html#l00086">dt_device_param::ddp_inodespace</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="ofd__internal_8h_source.html#l00324">ofd_thread_info::fti_ocd</a>, <a class="el" href="lu__object_8h_source.html#l00287">lu_device::ld_obd</a>, <a class="el" href="lu__object_8h_source.html#l00279">lu_device::ld_ops</a>, <a class="el" href="structlu__device__operations.html#a0786583fdaf5ff6bf3f4aaa4e48d3dd9">lu_device_operations::ldo_recovery_complete</a>, <a class="el" href="lustre__idl_8h_source.html#l01182">OBD_CONNECT_GRANT</a>, <a class="el" href="lustre__idl_8h_source.html#l01229">OBD_CONNECT_GRANT_PARAM</a>, <a class="el" href="obd_8h_source.html#l00655">obd_device::obd_self_export</a>, <a class="el" href="lustre__idl_8h_source.html#l01336">obd_connect_data::ocd_connect_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l01338">obd_connect_data::ocd_grant</a>, <a class="el" href="ofd__internal_8h_source.html#l00197">ofd_dev()</a>, <a class="el" href="ofd__internal_8h_source.html#l00120">ofd_device::ofd_dt_conf</a>, <a class="el" href="ofd__grant_8c_source.html#l00868">ofd_grant_connect()</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="lustre__idl_8h_source.html#l01770">OST_MAX_PRECREATE</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

</div>
</div>
<a class="anchor" id="ac9ee0045255a0e7582b089e481c72f06"></a><!-- doxytag: member="ofd_dev.c::ofd_rw_hpreq_check" ref="ac9ee0045255a0e7582b089e481c72f06" args="(struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_rw_hpreq_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of ptlrpc_hpreq_ops::hpreq_lock_check for OFD RW requests. </p>
<p>Check for whether the given PTLRPC request (<em>req</em>) is blocking an LDLM lock cancel.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>req</em>&nbsp;</td><td>the incoming request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>if <em>req</em> is blocking an LDLM lock cancel </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if it is not </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02471">2471</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00145">D_DLMTRACE</a>, <a class="el" href="libcfs__debug_8h_source.html#l00149">D_RPCTRACE</a>, <a class="el" href="lustre__net_8h_source.html#l01302">DEBUG_REQ</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="mdsrate_8c_source.html#l00132">end</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__idl_8h_source.html#l01777">obd_ioobj::ioo_bufcnt</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="lu__object_8c_source.html#l01574">lu_context_key_get()</a>, <a class="el" href="lustre__idl_8h_source.html#l01757">OBD_BRW_SRVLOCK</a>, <a class="el" href="ofd__dev_8c_source.html#l02344">ofd_prolong_extent_locks()</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="layout_8c_source.html#l02117">req_capsule_client_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01115">RMF_NIOBUF_REMOTE</a>, <a class="el" href="layout_8c_source.html#l01110">RMF_OBD_IOOBJ</a>, <a class="el" href="lustre__idl_8h_source.html#l01792">niobuf_remote::rnb_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l01791">niobuf_remote::rnb_len</a>, <a class="el" href="lustre__idl_8h_source.html#l01790">niobuf_remote::rnb_offset</a>, <a class="el" href="lustre__net_8h_source.html#l01121">ptlrpc_request::rq_pill</a>, <a class="el" href="rename__many_8c_source.html#l00057">start</a>, <a class="el" href="tgt__handler_8c_source.html#l00051">tgt_name()</a>, <a class="el" href="tgt__main_8c_source.html#l00375">tgt_session_key</a>, <a class="el" href="lu__target_8h_source.html#l00210">tgt_session_info::tsi_fid</a>, and <a class="el" href="lu__target_8h_source.html#l00204">tgt_session_info::tsi_tgt</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02521">ofd_rw_hpreq_fini()</a>.</p>

</div>
</div>
<a class="anchor" id="a5f5a86e24dc3c797a2b2e484abe27dbb"></a><!-- doxytag: member="ofd_dev.c::ofd_rw_hpreq_fini" ref="a5f5a86e24dc3c797a2b2e484abe27dbb" args="(struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_rw_hpreq_fini </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of ptlrpc_hpreq_ops::hpreq_lock_fini for OFD RW requests. </p>
<p>Called after the request has been handled. It refreshes lock timeout again so that client has more time to send lock cancel RPC.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>req</em>&nbsp;</td><td>request which is being processed. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02521">2521</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="ofd__dev_8c_source.html#l02471">ofd_rw_hpreq_check()</a>.</p>

</div>
</div>
<a class="anchor" id="ad53c75846f83b05d631a2ff38b6d774f"></a><!-- doxytag: member="ofd_dev.c::ofd_rw_hpreq_lock_match" ref="ad53c75846f83b05d631a2ff38b6d774f" args="(struct ptlrpc_request *req, struct ldlm_lock *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_rw_hpreq_lock_match </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structptlrpc__hpreq__ops.html#a3c70481ff128411ab4eeb09dc5eac234" title="Check if the lock handle of the given lock is the same as taken from the request...">ptlrpc_hpreq_ops::hpreq_lock_match</a> for OFD RW requests. </p>
<p>Determine if <em>lock</em> and the lock from request <em>req</em> are equivalent by comparing their resource <a class="el" href="structnames.html">names</a>, modes, and extents.</p>
<p>It is used to give priority to read and write RPCs being done under this lock so that the client can drop the contended lock more quickly and let other clients use it. This improves overall performance in the case where the first client gets a very large lock extent that prevents other clients from submitting their writes.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>req</em>&nbsp;</td><td><a class="el" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> being processed </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lock</em>&nbsp;</td><td>contended lock to match</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>if lock is matched </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>otherwise </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02422">2422</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l02823">ldlm_extent::end</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__idl_8h_source.html#l01777">obd_ioobj::ioo_bufcnt</a>, <a class="el" href="lustre__idl_8h_source.html#l01773">obd_ioobj::ioo_oid</a>, <a class="el" href="lustre__dlm_8h_source.html#l00633">ldlm_policy_data::l_extent</a>, <a class="el" href="lustre__dlm_8h_source.html#l00728">ldlm_lock::l_granted_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00772">ldlm_lock::l_policy_data</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="packet-lustre_8c_source.html#l00293">LCK_PR</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="lustre__idl_8h_source.html#l02827">ldlm_extent_overlap()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00951">ldlm_resource::lr_name</a>, <a class="el" href="pack__generic_8c_source.html#l00989">lustre_msg_get_opc()</a>, <a class="el" href="mdsrate_8c_source.html#l00114">mode</a>, <a class="el" href="packet-lustre_8c_source.html#l00166">OST_READ</a>, <a class="el" href="lustre__fid_8h_source.html#l00637">ostid_res_name_eq()</a>, <a class="el" href="layout_8c_source.html#l02117">req_capsule_client_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01115">RMF_NIOBUF_REMOTE</a>, <a class="el" href="layout_8c_source.html#l01110">RMF_OBD_IOOBJ</a>, <a class="el" href="lustre__idl_8h_source.html#l01791">niobuf_remote::rnb_len</a>, <a class="el" href="lustre__idl_8h_source.html#l01790">niobuf_remote::rnb_offset</a>, <a class="el" href="lustre__net_8h_source.html#l01121">ptlrpc_request::rq_pill</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, and <a class="el" href="lustre__idl_8h_source.html#l02822">ldlm_extent::start</a>.</p>

</div>
</div>
<a class="anchor" id="a078aa3b2c42bd8edc2393e15ed5d5232"></a><!-- doxytag: member="ofd_dev.c::ofd_set_info_hdl" ref="a078aa3b2c42bd8edc2393e15ed5d5232" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_set_info_hdl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OFD request handler for OST_SET_INFO RPC. </p>
<p>This is OFD-specific part of request handling</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p><p>handle grant shrink, similar to a read request </p>
</p>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00897">897</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00148">D_HA</a>, <a class="el" href="lustre__net_8h_source.html#l01302">DEBUG_REQ</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__target_8h_source.html#l00498">err_serious()</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="obd_8h_source.html#l00742">KEY_EVICT_BY_NID</a>, <a class="el" href="obd_8h_source.html#l00745">KEY_GRANT_SHRINK</a>, <a class="el" href="obd__support_8h_source.html#l00860">KEY_IS</a>, <a class="el" href="obd_8h_source.html#l00759">KEY_SPTLRPC_CONF</a>, <a class="el" href="ofd__internal_8h_source.html#l00084">LPROC_OFD_STATS_SET_INFO</a>, <a class="el" href="genops_8c_source.html#l01442">obd_export_evict_by_nid()</a>, <a class="el" href="ofd__internal_8h_source.html#l00089">ofd_counter_incr()</a>, <a class="el" href="ofd__grant_8c_source.html#l00988">ofd_grant_prepare_read()</a>, <a class="el" href="lustre__req__layout_8h_source.html#l00058">RCL_CLIENT</a>, <a class="el" href="layout_8c_source.html#l02117">req_capsule_client_get()</a>, <a class="el" href="layout_8c_source.html#l02339">req_capsule_extend()</a>, <a class="el" href="layout_8c_source.html#l02263">req_capsule_get_size()</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="layout_8c_source.html#l01868">req_capsule_server_pack()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01105">RMF_OST_BODY</a>, <a class="el" href="layout_8c_source.html#l00974">RMF_SETINFO_KEY</a>, <a class="el" href="layout_8c_source.html#l00899">RMF_SETINFO_VAL</a>, <a class="el" href="layout_8c_source.html#l01650">RQF_OST_SET_GRANT_INFO</a>, <a class="el" href="tgt__handler_8c_source.html#l01010">tgt_adapt_sptlrpc_conf()</a>, <a class="el" href="tgt__handler_8c_source.html#l00051">tgt_name()</a>, <a class="el" href="lu__target_8h_source.html#l00334">tgt_ses_req()</a>, <a class="el" href="lu__target_8h_source.html#l00203">tgt_session_info::tsi_env</a>, <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>, <a class="el" href="lu__target_8h_source.html#l00227">tgt_session_info::tsi_jobid</a>, <a class="el" href="lu__target_8h_source.html#l00193">tgt_session_info::tsi_pill</a>, and <a class="el" href="lu__target_8h_source.html#l00204">tgt_session_info::tsi_tgt</a>.</p>

</div>
</div>
<a class="anchor" id="a47e83abe9acc74e96c33b62058f587f7"></a><!-- doxytag: member="ofd_dev.c::ofd_setattr_hdl" ref="a47e83abe9acc74e96c33b62058f587f7" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_setattr_hdl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OFD request handler for OST_SETATTR RPC. </p>
<p>This is OFD-specific part of request handling. It finds the OFD object by its FID, sets attributes from request and packs result to the reply.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l01363">1363</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="ofd__internal_8h_source.html#l00303">ofd_thread_info::fti_mds_fid</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="linux-obdo_8c_source.html#l00103">la_from_obdo()</a>, <a class="el" href="lu__object_8h_source.html#l00450">LA_GID</a>, <a class="el" href="lu__object_8h_source.html#l00452">LA_TYPE</a>, <a class="el" href="lu__object_8h_source.html#l00449">LA_UID</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="packet-lustre_8c_source.html#l00299">LDLM_EXTENT</a>, <a class="el" href="lustre__dlm_8h_source.html#l01296">ldlm_res_lvbo_update()</a>, <a class="el" href="ldlm__resource_8c_source.html#l01179">ldlm_resource_get()</a>, <a class="el" href="ldlm__resource_8c_source.html#l01295">ldlm_resource_putref()</a>, <a class="el" href="ofd__internal_8h_source.html#l00077">LPROC_OFD_STATS_SETATTR</a>, <a class="el" href="lustre__idl_8h_source.html#l03384">obdo::o_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l03400">obdo::o_parent_oid</a>, <a class="el" href="lustre__idl_8h_source.html#l03385">obdo::o_parent_seq</a>, <a class="el" href="lustre__idl_8h_source.html#l03386">obdo::o_size</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l03486">ost_body::oa</a>, <a class="el" href="genops_8c_source.html#l01433">obd_export_nid2str()</a>, <a class="el" href="lustre__idl_8h_source.html#l01680">OBD_MD_FLFID</a>, <a class="el" href="lustre__idl_8h_source.html#l01679">OBD_MD_FLGROUP</a>, <a class="el" href="lustre__idl_8h_source.html#l01656">OBD_MD_FLID</a>, <a class="el" href="lustre__idl_8h_source.html#l01660">OBD_MD_FLSIZE</a>, <a class="el" href="lustre__idl_8h_source.html#l01767">OBD_OBJECT_EOF</a>, <a class="el" href="linux-obdo_8c_source.html#l00052">obdo_from_la()</a>, <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__internal_8h_source.html#l00089">ofd_counter_incr()</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00122">ofd_device::ofd_namespace</a>, <a class="el" href="ofd__internal_8h_source.html#l00420">ofd_object_find_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00174">ofd_object_put()</a>, <a class="el" href="ofd__internal_8h_source.html#l00562">ofd_prepare_fidea()</a>, <a class="el" href="ofd__internal_8h_source.html#l00055">OFD_VALID_FLAGS</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01105">RMF_OST_BODY</a>, <a class="el" href="lu__target_8h_source.html#l00519">tgt_drop_id()</a>, <a class="el" href="ofd__internal_8h_source.html#l00527">tsi2ofd_info()</a>, <a class="el" href="lu__target_8h_source.html#l00203">tgt_session_info::tsi_env</a>, <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>, <a class="el" href="lu__target_8h_source.html#l00210">tgt_session_info::tsi_fid</a>, <a class="el" href="lu__target_8h_source.html#l00227">tgt_session_info::tsi_jobid</a>, <a class="el" href="lu__target_8h_source.html#l00207">tgt_session_info::tsi_ost_body</a>, <a class="el" href="lu__target_8h_source.html#l00193">tgt_session_info::tsi_pill</a>, and <a class="el" href="lu__target_8h_source.html#l00211">tgt_session_info::tsi_resid</a>.</p>

</div>
</div>
<a class="anchor" id="acc38e4d225251b67c9d81cad12659930"></a><!-- doxytag: member="ofd_dev.c::ofd_stack_fini" ref="acc38e4d225251b67c9d81cad12659930" args="(const struct lu_env *env, struct ofd_device *m, struct lu_device *top)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_stack_fini </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td>
          <td class="paramname"> <em>top</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Finalize the device stack OFD-OSD. </p>
<p>This function cleans OFD-OSD device stack and disconnects OFD from the OSD.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>m</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>top</em>&nbsp;</td><td>top device of stack</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00220">220</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="hash_8c_source.html#l01535">cfs_hash_is_empty()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00146">D_ERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__cfg_8h_source.html#l00075">LCFG_CLEANUP</a>, <a class="el" href="lu__object_8h_source.html#l00279">lu_device::ld_ops</a>, <a class="el" href="lu__object_8h_source.html#l00283">lu_device::ld_site</a>, <a class="el" href="structlu__device__operations.html#a892c61097c7e02dd33e5a9148d339dae">lu_device_operations::ldo_process_config</a>, <a class="el" href="libcfs__debug_8h_source.html#l00201">LIBCFS_DEBUG_MSG_DATA_DECL</a>, <a class="el" href="lu__object_8h_source.html#l00611">lu_site::ls_obj_hash</a>, <a class="el" href="lu__object_8c_source.html#l00491">lu_cdebug_printer()</a>, <a class="el" href="lu__object_8c_source.html#l00905">lu_site_print()</a>, <a class="el" href="lu__object_8c_source.html#l00352">lu_site_purge()</a>, <a class="el" href="lustre__cfg_8h_source.html#l00175">lustre_cfg_bufs_reset()</a>, <a class="el" href="lustre__cfg_8h_source.html#l00168">lustre_cfg_bufs_set_string()</a>, <a class="el" href="lustre__cfg_8h_source.html#l00290">lustre_cfg_free()</a>, <a class="el" href="lustre__cfg_8h_source.html#l00273">lustre_cfg_new()</a>, <a class="el" href="obd__class_8h_source.html#l00842">obd_disconnect()</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_fail</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_force</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="ofd__internal_8h_source.html#l00202">ofd_obd()</a>, <a class="el" href="ofd__internal_8h_source.html#l00119">ofd_device::ofd_osd_exp</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00358">RETURN_EXIT</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02983">ofd_fini()</a>, and <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="ab1f8ab5e54304e1b1c9a23581d529857"></a><!-- doxytag: member="ofd_dev.c::ofd_stack_init" ref="ab1f8ab5e54304e1b1c9a23581d529857" args="(const struct lu_env *env, struct ofd_device *m, struct lustre_cfg *cfg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_stack_init </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlustre__cfg.html">lustre_cfg</a> *&nbsp;</td>
          <td class="paramname"> <em>cfg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize stack of devices. </p>
<p>This function initializes OFD-OSD device stack to serve OST requests</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>m</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cfg</em>&nbsp;</td><td>Lustre config for this server</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00163">163</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="structofd__thread__info.html#a143cbb933e501df87c3b43b854852113">ofd_thread_info::fti_u</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__disk_8h_source.html#l00223">lustre_mount_data::lmd_flags</a>, <a class="el" href="lustre__disk_8h_source.html#l00242">LMD_FLG_SKIP_LFSCK</a>, <a class="el" href="lustre__disk_8h_source.html#l00562">lustre_mount_info::lmi_sb</a>, <a class="el" href="dt__object_8h_source.html#l01743">lu2dt_dev()</a>, <a class="el" href="lustre__cfg_8h_source.html#l00210">lustre_cfg_string()</a>, <a class="el" href="lustre__idl_8h_source.html#l02959">MTI_NAME_MAXLEN</a>, <a class="el" href="ofd__internal_8h_source.html#l00309">ofd_thread_info::name</a>, <a class="el" href="obd__support_8h_source.html#l00708">OBD_ALLOC</a>, <a class="el" href="obd__support_8h_source.html#l00776">OBD_FREE</a>, <a class="el" href="obd_8h_source.html#l00595">obd_device::obd_lu_dev</a>, <a class="el" href="ofd__dev_8c_source.html#l00110">ofd_connect_to_next()</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__internal_8h_source.html#l00119">ofd_device::ofd_osd_exp</a>, <a class="el" href="ofd__internal_8h_source.html#l00175">ofd_device::ofd_skip_lfsck</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="obd__mount__server_8c_source.html#l00157">server_get_mount()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="af6be8cdea32bea774b3422720a4aeabf"></a><!-- doxytag: member="ofd_dev.c::ofd_statfs_hdl" ref="af6be8cdea32bea774b3422720a4aeabf" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_statfs_hdl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OFD request handler for OST_STATFS RPC. </p>
<p>This function gets statfs data from storage as part of request processing.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l01913">1913</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="linux-time_8h_source.html#l00242">cfs_time_shift_64()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="ofd__internal_8h_source.html#l00082">LPROC_OFD_STATS_STATFS</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00322">OBD_FAIL_OST_STATFS_EINPROGRESS</a>, <a class="el" href="obd_8h_source.html#l00357">OBD_STATFS_CACHE_SECONDS</a>, <a class="el" href="ofd__internal_8h_source.html#l00089">ofd_counter_incr()</a>, <a class="el" href="ofd__obd_8c_source.html#l00806">ofd_statfs()</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l00969">RMF_OBD_STATFS</a>, <a class="el" href="tgt__handler_8c_source.html#l00051">tgt_name()</a>, <a class="el" href="lu__target_8h_source.html#l00203">tgt_session_info::tsi_env</a>, <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>, <a class="el" href="lu__target_8h_source.html#l00227">tgt_session_info::tsi_jobid</a>, <a class="el" href="lu__target_8h_source.html#l00193">tgt_session_info::tsi_pill</a>, and <a class="el" href="lu__target_8h_source.html#l00204">tgt_session_info::tsi_tgt</a>.</p>

</div>
</div>
<a class="anchor" id="ac5e09b8b8e15c8edc8e2f95cbd02b87d"></a><!-- doxytag: member="ofd_dev.c::ofd_sync_hdl" ref="ac5e09b8b8e15c8edc8e2f95cbd02b87d" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_sync_hdl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OFD request handler for OST_SYNC RPC. </p>
<p>Sync object data or all filesystem data to the disk and pack the result in reply.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tsi</em>&nbsp;</td><td>target session environment for this request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l01948">1948</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__user_8h_source.html#l00156">fid_is_zero()</a>, <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="ofd__internal_8h_source.html#l00079">LPROC_OFD_STATS_SYNC</a>, <a class="el" href="lustre__idl_8h_source.html#l03390">obdo::o_blocks</a>, <a class="el" href="lustre__idl_8h_source.html#l03384">obdo::o_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l03386">obdo::o_size</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l03486">ost_body::oa</a>, <a class="el" href="lustre__idl_8h_source.html#l01679">OBD_MD_FLGROUP</a>, <a class="el" href="lustre__idl_8h_source.html#l01656">OBD_MD_FLID</a>, <a class="el" href="linux-obdo_8c_source.html#l00052">obdo_from_la()</a>, <a class="el" href="ofd__objects_8c_source.html#l00778">ofd_attr_get()</a>, <a class="el" href="ofd__internal_8h_source.html#l00089">ofd_counter_incr()</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>, <a class="el" href="ofd__internal_8h_source.html#l00420">ofd_object_find_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00174">ofd_object_put()</a>, <a class="el" href="ofd__internal_8h_source.html#l00055">OFD_VALID_FLAGS</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01105">RMF_OST_BODY</a>, <a class="el" href="tgt__handler_8c_source.html#l01274">tgt_sync()</a>, <a class="el" href="ofd__internal_8h_source.html#l00527">tsi2ofd_info()</a>, <a class="el" href="lu__target_8h_source.html#l00203">tgt_session_info::tsi_env</a>, <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>, <a class="el" href="lu__target_8h_source.html#l00210">tgt_session_info::tsi_fid</a>, <a class="el" href="lu__target_8h_source.html#l00227">tgt_session_info::tsi_jobid</a>, <a class="el" href="lu__target_8h_source.html#l00207">tgt_session_info::tsi_ost_body</a>, <a class="el" href="lu__target_8h_source.html#l00193">tgt_session_info::tsi_pill</a>, and <a class="el" href="lu__target_8h_source.html#l00204">tgt_session_info::tsi_tgt</a>.</p>

</div>
</div>
<a class="anchor" id="a89caa0c5b192ff557c996806019da19c"></a><!-- doxytag: member="ofd_dev.c::prolong_timeout" ref="a89caa0c5b192ff557c996806019da19c" args="(struct ptlrpc_request *req, struct ldlm_lock *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int prolong_timeout </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate the amount of time for lock prolongation. </p>
<p>This is helper for <a class="el" href="ofd__dev_8c.html#a74d1eec7b173789ee11d9f0db7482d0a" title="Prolong lock timeout for the given extent.">ofd_prolong_extent_locks()</a> function to get the timeout extra time.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>req</em>&nbsp;</td><td>current request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>amount</em>&nbsp;</td><td>of time to extend the timeout with </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02264">2264</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="lustre__import_8h_source.html#l00328">at_est2timeout()</a>, <a class="el" href="lustre__import_8h_source.html#l00373">at_get()</a>, <a class="el" href="lustre__import_8h_source.html#l00379">AT_OFF</a>, <a class="el" href="class__obd_8c_source.html#l00083">obd_timeout</a>, and <a class="el" href="lustre__net_8h_source.html#l01831">ptlrpc_service_part::scp_at_estimate</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02292">ofd_prolong_one_lock()</a>.</p>

</div>
</div>
<a class="anchor" id="a06ee5bb6f5484c1e140cafd6049eed33"></a><!-- doxytag: member="ofd_dev.c::unlock_zero_regions" ref="a06ee5bb6f5484c1e140cafd6049eed33" args="(struct ldlm_namespace *ns, struct list_head *locked)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void unlock_zero_regions </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *&nbsp;</td>
          <td class="paramname"> <em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlist__head.html">list_head</a> *&nbsp;</td>
          <td class="paramname"> <em>locked</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unlock all previously locked sparse areas for given resource. </p>
<p>This function goes through list of locked regions, unlocking and freeing them one-by-one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ns</em>&nbsp;</td><td>LDLM namespace </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>locked</em>&nbsp;</td><td>list head of regions list </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l01106">1106</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00141">D_OTHER</a>, <a class="el" href="packet-lustre_8c_source.html#l00293">LCK_PR</a>, <a class="el" href="ofd__dev_8c_source.html#l00998">locked_region::lh</a>, <a class="el" href="ofd__dev_8c_source.html#l00997">locked_region::list</a>, <a class="el" href="lnetctl_8c_source.html#l00969">list</a>, <a class="el" href="list_8h_source.html#l00116">list_del()</a>, <a class="el" href="list_8h_source.html#l00484">list_for_each_entry_safe</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, and <a class="el" href="tgt__handler_8c_source.html#l01709">tgt_extent_unlock()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01136">ofd_get_info_hdl()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a8ddc9f3bf44e39131fa45f333b611a35"></a><!-- doxytag: member="ofd_dev.c::ofd_caches" ref="a8ddc9f3bf44e39131fa45f333b611a35" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__kmem__descr.html">lu_kmem_descr</a> <a class="el" href="ofd__dev_8c.html#a8ddc9f3bf44e39131fa45f333b611a35">ofd_caches</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        {
                .ckd_cache = &amp;<a class="code" href="ofd__dev_8c.html#a0814aa8280da40dec5b35ac1695f0a9f">ofd_object_kmem</a>,
                .ckd_name  = <span class="stringliteral">&quot;ofd_obj&quot;</span>,
                .ckd_size  = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structofd__object.html">ofd_object</a>)
        },
        {
                .ckd_cache = NULL
        }
}
</pre></div>
<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00085">85</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2e4707c67c49295bf6b0cbe99f0eb984"></a><!-- doxytag: member="ofd_dev.c::ofd_common_slice" ref="a2e4707c67c49295bf6b0cbe99f0eb984" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structtgt__opc__slice.html">tgt_opc_slice</a> <a class="el" href="ofd__dev_8c.html#a2e4707c67c49295bf6b0cbe99f0eb984">ofd_common_slice</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02721">2721</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac38bd0be90d19209a528126d022b37ae"></a><!-- doxytag: member="ofd_dev.c::ofd_device_type" ref="ac38bd0be90d19209a528126d022b37ae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__device__type.html">lu_device_type</a> <a class="el" href="ofd__dev_8c.html#ac38bd0be90d19209a528126d022b37ae">ofd_device_type</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .ldt_tags       = <a class="code" href="group__lu.html#ggaa318f5b20c40de1d564f59dd72726345a5b8da75da353b465f5ddc30d87c931d9" title="this is data device">LU_DEVICE_DT</a>,
        .ldt_name       = <a class="code" href="obd_8h.html#abb3759ab959a040f487c882fea46e9a1">LUSTRE_OST_NAME</a>,
        .ldt_ops        = &amp;<a class="code" href="ofd__dev_8c.html#a0cf9eaa0d1f8de729400f603941b1dce">ofd_device_type_ops</a>,
        .ldt_ctx_tags   = <a class="code" href="group__lu.html#ggad7e2d14b1b91480b0b25656f63169a0aa130ed4529679eed5a88d5dc63db1921f" title="Thread on dt server.">LCT_DT_THREAD</a>
}
</pre></div>
<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l03107">3107</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0cf9eaa0d1f8de729400f603941b1dce"></a><!-- doxytag: member="ofd_dev.c::ofd_device_type_ops" ref="a0cf9eaa0d1f8de729400f603941b1dce" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__device__type__operations.html">lu_device_type_operations</a> <a class="el" href="ofd__dev_8c.html#a0cf9eaa0d1f8de729400f603941b1dce">ofd_device_type_ops</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .ldto_init              = ofd_type_init,
        .ldto_fini              = ofd_type_fini,

        .ldto_start             = ofd_type_start,
        .ldto_stop              = ofd_type_stop,

        .ldto_device_alloc      = <a class="code" href="ofd__dev_8c.html#a429225a2e0fbbe94b4c857ec22297bcc" title="Implementation of lu_device_type_operations::ldto_device_alloc.">ofd_device_alloc</a>,
        .ldto_device_free       = <a class="code" href="ofd__dev_8c.html#ad677636a242d0e10784d140707d8eb44" title="Implementation of lu_device_type_operations::ldto_device_free.">ofd_device_free</a>,
        .ldto_device_fini       = <a class="code" href="ofd__dev_8c.html#ad09f9e60b38319a0dbc4eba5c0666c2d" title="Implementation of lu_device_type_operations::ldto_device_fini.">ofd_device_fini</a>
}
</pre></div>
<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l03095">3095</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7dba07f262635d2f2a5f75a2fef0c40d"></a><!-- doxytag: member="ofd_dev.c::ofd_hpreq_punch" ref="a7dba07f262635d2f2a5f75a2fef0c40d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structptlrpc__hpreq__ops.html">ptlrpc_hpreq_ops</a> <a class="el" href="ofd__dev_8c.html#a7dba07f262635d2f2a5f75a2fef0c40d">ofd_hpreq_punch</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .hpreq_lock_match       = <a class="code" href="ofd__dev_8c.html#aafd53a4a1669dc2462e83e3ed63b8ffd" title="Implementation of ptlrpc_hpreq_ops::hpreq_lock_match for OST_PUNCH request.">ofd_punch_hpreq_lock_match</a>,
        .hpreq_check            = <a class="code" href="ofd__dev_8c.html#a5dca3427b2a585ad6aba7bb881112862" title="Implementation of ptlrpc_hpreq_ops::hpreq_lock_check for OST_PUNCH request.">ofd_punch_hpreq_check</a>,
        .hpreq_fini             = <a class="code" href="ofd__dev_8c.html#a81b5a4f0b03a3ce8f31f789e1956f1b7" title="Implementation of ptlrpc_hpreq_ops::hpreq_lock_fini for OST_PUNCH request.">ofd_punch_hpreq_fini</a>
}
</pre></div>
<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02621">2621</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4f9c29777b9ad68a96e857d5bd625746"></a><!-- doxytag: member="ofd_dev.c::ofd_hpreq_rw" ref="a4f9c29777b9ad68a96e857d5bd625746" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structptlrpc__hpreq__ops.html">ptlrpc_hpreq_ops</a> <a class="el" href="ofd__dev_8c.html#a4f9c29777b9ad68a96e857d5bd625746">ofd_hpreq_rw</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .hpreq_lock_match       = <a class="code" href="ofd__dev_8c.html#ad53c75846f83b05d631a2ff38b6d774f" title="Implementation of ptlrpc_hpreq_ops::hpreq_lock_match for OFD RW requests.">ofd_rw_hpreq_lock_match</a>,
        .hpreq_check            = <a class="code" href="ofd__dev_8c.html#ac9ee0045255a0e7582b089e481c72f06" title="Implementation of ptlrpc_hpreq_ops::hpreq_lock_check for OFD RW requests.">ofd_rw_hpreq_check</a>,
        .hpreq_fini             = <a class="code" href="ofd__dev_8c.html#a5f5a86e24dc3c797a2b2e484abe27dbb" title="Implementation of ptlrpc_hpreq_ops::hpreq_lock_fini for OFD RW requests.">ofd_rw_hpreq_fini</a>
}
</pre></div>
<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02615">2615</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="adcaae9239dfa3b5d192da4fa07f1f0f3"></a><!-- doxytag: member="ofd_dev.c::ofd_interop_param" ref="adcaae9239dfa3b5d192da4fa07f1f0f3" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcfg__interop__param.html">cfg_interop_param</a> <a class="el" href="ofd__dev_8c.html#adcaae9239dfa3b5d192da4fa07f1f0f3">ofd_interop_param</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        { <span class="stringliteral">&quot;ost.quota_type&quot;</span>,     NULL },
        { NULL }
}
</pre></div>
<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00259">259</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="a651a57c61ce030cf25e3946502d542a7"></a><!-- doxytag: member="ofd_dev.c::ofd_lu_ops" ref="a651a57c61ce030cf25e3946502d542a7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__device__operations.html">lu_device_operations</a> <a class="el" href="ofd__dev_8c.html#a651a57c61ce030cf25e3946502d542a7">ofd_lu_ops</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .ldo_object_alloc       = <a class="code" href="ofd__dev_8c.html#a5205246f1469a69bcc54d78aabe80e9b" title="Implementation of lu_device_operations::lod_object_alloc.">ofd_object_alloc</a>,
        .ldo_process_config     = <a class="code" href="ofd__dev_8c.html#a7d36cd48bea9ce74712a52696b9d6fe8" title="Process various configuration parameters.">ofd_process_config</a>,
        .ldo_recovery_complete  = <a class="code" href="ofd__dev_8c.html#ab0b7aca2c60814ae867ad1f902550306" title="Implementation of lu_device_operations::ldo_recovery_complete.">ofd_recovery_complete</a>,
        .ldo_prepare            = <a class="code" href="ofd__dev_8c.html#af5a4509c53a70224b8a825233bf4776a" title="Implementation of lu_device_operations::ldo_prepare.">ofd_prepare</a>,
}
</pre></div>
<p><a class="el" href="structlu__device__operations.html" title="Operations common for data and meta-data devices.">lu_device_operations</a> matrix for OFD device. </p>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00664">664</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7af9b44974527bcb0de8ffed71c30751"></a><!-- doxytag: member="ofd_dev.c::ofd_obj_ops" ref="a7af9b44974527bcb0de8ffed71c30751" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__object__operations.html">lu_object_operations</a> <a class="el" href="ofd__dev_8c.html#a7af9b44974527bcb0de8ffed71c30751">ofd_obj_ops</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .loo_object_init        = <a class="code" href="ofd__dev_8c.html#a61c7a3d9aad407f0cc5abfdbe4db664a" title="Implementation of lu_object_operations::loo_object_init for OFD.">ofd_object_init</a>,
        .loo_object_free        = <a class="code" href="ofd__dev_8c.html#a6ce2679ad4f5fd4df37dace8a1d65f0b" title="Implementation of lu_object_operations::loo_object_free.">ofd_object_free</a>,
        .loo_object_print       = <a class="code" href="ofd__dev_8c.html#a5e3f686dd562d7a20d2cc24cea21f815" title="Implementation of lu_object_operations::loo_object_print.">ofd_object_print</a>
}
</pre></div>
<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00471">471</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0814aa8280da40dec5b35ac1695f0a9f"></a><!-- doxytag: member="ofd_dev.c::ofd_object_kmem" ref="a0814aa8280da40dec5b35ac1695f0a9f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kmem_cache* <a class="el" href="ofd__dev_8c.html#a0814aa8280da40dec5b35ac1695f0a9f">ofd_object_kmem</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00083">83</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l00490">ofd_object_alloc()</a>, and <a class="el" href="ofd__dev_8c_source.html#l00434">ofd_object_free()</a>.</p>

</div>
</div>
<a class="anchor" id="a75828ea298b6d7f686da4484e1e535ba"></a><!-- doxytag: member="ofd_dev.c::ofd_tgt_handlers" ref="a75828ea298b6d7f686da4484e1e535ba" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structtgt__handler.html">tgt_handler</a> <a class="el" href="ofd__dev_8c.html#a75828ea298b6d7f686da4484e1e535ba">ofd_tgt_handlers</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Table of OFD-specific request handlers. </p>
<p>This table contains all opcodes accepted by OFD and specifies handlers for them. The tgt_request_handler() uses such table from each target to process incoming requests. </p>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02688">2688</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5715d5d1456c6eabe4053582059eb50f"></a><!-- doxytag: member="ofd_dev.c::ofd_thread_key" ref="a5715d5d1456c6eabe4053582059eb50f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__context__key.html">lu_context_key</a> <a class="el" href="ofd__internal_8h.html#a5715d5d1456c6eabe4053582059eb50f">ofd_thread_key</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .lct_tags = <a class="code" href="group__lu.html#ggad7e2d14b1b91480b0b25656f63169a0aa130ed4529679eed5a88d5dc63db1921f" title="Thread on dt server.">LCT_DT_THREAD</a>,
        .lct_init = ofd_key_init,
        .lct_fini = ofd_key_fini,
        .lct_exit = <a class="code" href="ofd__dev_8c.html#a07ce681cee75414c2db5ebb5a922d950" title="Implementation of lu_context_key::lct_key_exit.">ofd_key_exit</a>
}
</pre></div>
<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02792">2792</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>Referenced by <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:49 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
