<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: Miscellaneous operations.</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Miscellaneous operations.<br/>
<small>
[<a class="el" href="group__lnet.html">LNet</a>]</small>
</h1>
<p>Miscellaneous operations.  
<a href="#_details">More...</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__lnet__misc.html#ga1986737ae4fa6d8756708df641f024e3">LNetSetLazyPortal</a> (int portal)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Turn on the lazy portal attribute.  <a href="#ga1986737ae4fa6d8756708df641f024e3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__lnet__misc.html#ga8dd90e2ffad743128236983380bab6db">LNetClearLazyPortal</a> (int portal)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Turn off the lazy portal attribute.  <a href="#ga8dd90e2ffad743128236983380bab6db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__lnet__misc.html#ga4feb5dc040fabdac2a7bd61ee5b2aa64">LNetCtl</a> (unsigned int <a class="el" href="mdsrate_8c.html#a7353cae57e2530c316ddacb27ef14932">cmd</a>, void *arg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">LNet ioctl handler.  <a href="#ga4feb5dc040fabdac2a7bd61ee5b2aa64"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__lnet__misc.html#gab75e868007b205e6bdb46743994ff366">LNetDebugPeer</a> (<a class="el" href="structlnet__process__id__t.html">lnet_process_id_t</a> id)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Miscellaneous operations. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga8dd90e2ffad743128236983380bab6db"></a><!-- doxytag: member="api.h::LNetClearLazyPortal" ref="ga8dd90e2ffad743128236983380bab6db" args="(int portal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int LNetClearLazyPortal </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>portal</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Turn off the lazy portal attribute. </p>
<p>Delayed requests on the portal, if any, will be all dropped when this function returns.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>portal</em>&nbsp;</td><td>Index of the portal to disable the lazy attribute on.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>On success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-EINVAL</em>&nbsp;</td><td>If <em>portal</em> is not a valid index. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="lib-ptl_8c_source.html#l00977">977</a> of file <a class="el" href="lib-ptl_8c_source.html">lib-ptl.c</a>.</p>

<p>References <a class="el" href="lib-ptl_8c_source.html#l00919">lnet_clear_lazy_portal()</a>.</p>

<p>Referenced by <a class="el" href="api-ni_8c_source.html#l01157">lnet_shutdown_lndnis()</a>, <a class="el" href="service_8c_source.html#l02998">ptlrpc_service_unlink_rqbd()</a>, and <a class="el" href="rpc_8c_source.html#l01630">srpc_shutdown()</a>.</p>

</div>
</div>
<a class="anchor" id="ga4feb5dc040fabdac2a7bd61ee5b2aa64"></a><!-- doxytag: member="api.h::LNetCtl" ref="ga4feb5dc040fabdac2a7bd61ee5b2aa64" args="(unsigned int cmd, void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int LNetCtl </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>arg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>LNet ioctl handler. </p>

<p>Definition at line <a class="el" href="api-ni_8c_source.html#l01908">1908</a> of file <a class="el" href="api-ni_8c_source.html">api-ni.c</a>.</p>

<p>References <a class="el" href="ioctl_8h_source.html#l00048">__user</a>, <a class="el" href="structlnet__ioctl__config__data.html#a33fe24a9645c8cace00207c2734c8ad4">lnet_ioctl_config_data::cfg_buffers</a>, <a class="el" href="lib-dlc_8h_source.html#l00121">lnet_ioctl_config_data::cfg_bulk</a>, <a class="el" href="structlnet__ioctl__config__data.html#a028969a693fdc03be6f2ccdd78c7612f">lnet_ioctl_config_data::cfg_config_u</a>, <a class="el" href="lib-dlc_8h_source.html#l00094">lnet_ioctl_config_data::cfg_count</a>, <a class="el" href="lib-dlc_8h_source.html#l00091">lnet_ioctl_config_data::cfg_hdr</a>, <a class="el" href="lib-dlc_8h_source.html#l00093">lnet_ioctl_config_data::cfg_net</a>, <a class="el" href="lib-dlc_8h_source.html#l00095">lnet_ioctl_config_data::cfg_nid</a>, <a class="el" href="structlnet__ioctl__config__data.html#a00668660af162ebb984c226c97000a79">lnet_ioctl_config_data::cfg_route</a>, <a class="el" href="linux-time_8h_source.html#l00152">cfs_time_current()</a>, <a class="el" href="linux-time_8h_source.html#l00157">cfs_time_current_sec()</a>, <a class="el" href="linux-time_8h_source.html#l00182">cfs_time_seconds()</a>, <a class="el" href="osd__iam_8h_source.html#l00054">CLASSERT</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00067">libcfs_ioctl_data::ioc_count</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00066">libcfs_ioctl_data::ioc_flags</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00053">libcfs_ioctl_hdr::ioc_len</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00143">IOC_LIBCFS_ADD_BUF</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00136">IOC_LIBCFS_ADD_ROUTE</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00142">IOC_LIBCFS_CONFIG_RTR</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00137">IOC_LIBCFS_DEL_ROUTE</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00104">IOC_LIBCFS_FAIL_NID</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00144">IOC_LIBCFS_GET_BUF</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00146">IOC_LIBCFS_GET_LNET_STATS</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00141">IOC_LIBCFS_GET_NET</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00103">IOC_LIBCFS_GET_NI</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00145">IOC_LIBCFS_GET_PEER_INFO</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00138">IOC_LIBCFS_GET_ROUTE</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00108">IOC_LIBCFS_LNET_DIST</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00114">IOC_LIBCFS_LNET_FAULT</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00105">IOC_LIBCFS_NOTIFY_ROUTER</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00111">IOC_LIBCFS_PING</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00110">IOC_LIBCFS_TESTPROTOCOMPAT</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00068">libcfs_ioctl_data::ioc_net</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00063">libcfs_ioctl_data::ioc_nid</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00077">libcfs_ioctl_data::ioc_pbuf1</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00076">libcfs_ioctl_data::ioc_plen1</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00069">libcfs_ioctl_data::ioc_u32</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00064">libcfs_ioctl_data::ioc_u64</a>, <a class="el" href="libcfs__ioctl_8h_source.html#l00058">LIBCFS_IOC_DATA_MAX</a>, <a class="el" href="lib-types_8h_source.html#l00637">lnet_t::ln_api_mutex</a>, <a class="el" href="lib-types_8h_source.html#l00654">lnet_t::ln_testprotocompat</a>, <a class="el" href="structlnet__lnd.html#a6e943b70ce8849bf83a9bed37a38d3d9">lnet_lnd::lnd_ctl</a>, <a class="el" href="router_8c_source.html#l00296">lnet_add_route()</a>, <a class="el" href="router_8c_source.html#l00415">lnet_check_routes()</a>, <a class="el" href="api-ni_8c_source.html#l00323">lnet_counters_get()</a>, <a class="el" href="router_8c_source.html#l00472">lnet_del_route()</a>, <a class="el" href="lib-move_8c_source.html#l00050">lnet_fail_nid()</a>, <a class="el" href="net__fault_8c_source.html#l00952">lnet_fault_ctl()</a>, <a class="el" href="api-ni_8c_source.html#l01753">lnet_get_net_config()</a>, <a class="el" href="peer_8c_source.html#l00393">lnet_get_peer_info()</a>, <a class="el" href="router_8c_source.html#l00589">lnet_get_route()</a>, <a class="el" href="router_8c_source.html#l00552">lnet_get_rtr_pool_cfg()</a>, <a class="el" href="lib-lnet_8h_source.html#l00075">LNET_LOCK_EX</a>, <a class="el" href="api-ni_8c_source.html#l00692">lnet_net2ni()</a>, <a class="el" href="lib-lnet_8h_source.html#l00153">lnet_net_lock()</a>, <a class="el" href="lib-lnet_8h_source.html#l00159">lnet_net_unlock()</a>, <a class="el" href="lib-lnet_8h_source.html#l00424">lnet_ni_decref()</a>, <a class="el" href="router_8c_source.html#l01721">lnet_notify()</a>, <a class="el" href="api-ni_8c_source.html#l02169">lnet_ping()</a>, <a class="el" href="router_8c_source.html#l01662">lnet_rtrpools_adjust()</a>, <a class="el" href="router_8c_source.html#l01704">lnet_rtrpools_disable()</a>, <a class="el" href="router_8c_source.html#l01675">lnet_rtrpools_enable()</a>, <a class="el" href="lib-move_8c_source.html#l02460">LNetDist()</a>, <a class="el" href="api-ni_8c_source.html#l02129">LNetGetId()</a>, <a class="el" href="lib-types_8h_source.html#l00285">lnet_ni::ni_lnd</a>, <a class="el" href="lib-dlc_8h_source.html#l00126">lnet_ioctl_peer::pr_count</a>, <a class="el" href="lib-dlc_8h_source.html#l00125">lnet_ioctl_peer::pr_hdr</a>, <a class="el" href="structlnet__ioctl__peer.html#a378879f3e78e52aabf64e5a9dfb7bd85">lnet_ioctl_peer::pr_lnd_u</a>, <a class="el" href="lib-dlc_8h_source.html#l00128">lnet_ioctl_peer::pr_nid</a>, <a class="el" href="structlnet__ioctl__peer.html#ac8138a6c2f4bd9d1eb8e1d96db9508f4">lnet_ioctl_peer::pr_peer_credits</a>, <a class="el" href="lib-dlc_8h_source.html#l00101">lnet_ioctl_config_data::rtr_priority</a>, <a class="el" href="lib-dlc_8h_source.html#l00146">lnet_ioctl_lnet_stats::st_cntrs</a>, and <a class="el" href="lib-dlc_8h_source.html#l00145">lnet_ioctl_lnet_stats::st_hdr</a>.</p>

<p>Referenced by <a class="el" href="lnet_2lnet_2module_8c_source.html#l00131">lnet_ioctl()</a>.</p>

</div>
</div>
<a class="anchor" id="gab75e868007b205e6bdb46743994ff366"></a><!-- doxytag: member="api.h::LNetDebugPeer" ref="gab75e868007b205e6bdb46743994ff366" args="(lnet_process_id_t id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LNetDebugPeer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlnet__process__id__t.html">lnet_process_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>id</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="api-ni_8c_source.html#l02111">2111</a> of file <a class="el" href="api-ni_8c_source.html">api-ni.c</a>.</p>

<p>References <a class="el" href="peer_8c_source.html#l00362">lnet_debug_peer()</a>.</p>

<p>Referenced by <a class="el" href="client_8c_source.html#l02050">ptlrpc_expire_one_request()</a>.</p>

</div>
</div>
<a class="anchor" id="ga1986737ae4fa6d8756708df641f024e3"></a><!-- doxytag: member="api.h::LNetSetLazyPortal" ref="ga1986737ae4fa6d8756708df641f024e3" args="(int portal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int LNetSetLazyPortal </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>portal</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Turn on the lazy portal attribute. </p>
<p>Use with caution!</p>
<p>This portal attribute only affects incoming PUT requests to the portal, and is off by default. By default, if there's no matching MD for an incoming PUT request, it is simply dropped. With the lazy attribute on, such requests are queued indefinitely until either a matching MD is posted to the portal or the lazy attribute is turned off.</p>
<p>It would prevent dropped requests, however it should be regarded as the last line of defense - i.e. users must keep a close watch on active buffers on a lazy portal and once it becomes too low post more buffers as soon as possible. This is because delayed requests usually have detrimental effects on underlying <a class="el" href="structnetwork.html">network</a> connections. A few delayed requests often suffice to bring an underlying connection to a complete halt, due to flow control mechanisms.</p>
<p>There's also a DOS attack risk. If users don't post match-all MDs on a lazy portal, a malicious peer can easily stop a service by sending some PUT requests with match bits that won't match any MD. A routed server is especially vulnerable since the connections to its neighbor routers are shared among all clients.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>portal</em>&nbsp;</td><td>Index of the portal to enable the lazy attribute on.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>On success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-EINVAL</em>&nbsp;</td><td>If <em>portal</em> is not a valid index. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="lib-ptl_8c_source.html#l00896">896</a> of file <a class="el" href="lib-ptl_8c_source.html">lib-ptl.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00138">D_NET</a>, <a class="el" href="lib-types_8h_source.html#l00578">lnet_t::ln_nportals</a>, <a class="el" href="lib-types_8h_source.html#l00580">lnet_t::ln_portals</a>, <a class="el" href="lib-lnet_8h_source.html#l00075">LNET_LOCK_EX</a>, <a class="el" href="lib-types_8h_source.html#l00468">LNET_PTL_LAZY</a>, <a class="el" href="lib-lnet_8h_source.html#l00176">lnet_ptl_lock</a>, <a class="el" href="lib-lnet_8h_source.html#l00545">lnet_ptl_setopt()</a>, <a class="el" href="lib-lnet_8h_source.html#l00177">lnet_ptl_unlock</a>, <a class="el" href="lib-lnet_8h_source.html#l00132">lnet_res_lock()</a>, <a class="el" href="lib-lnet_8h_source.html#l00138">lnet_res_unlock()</a>, and <a class="el" href="api-ni_8c_source.html#l00043">the_lnet</a>.</p>

<p>Referenced by <a class="el" href="service_8c_source.html#l00690">ptlrpc_register_service()</a>, and <a class="el" href="rpc_8c_source.html#l01582">srpc_startup()</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:52 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
