<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/osd-ldiskfs/osd_dynlocks.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>lustre/osd-ldiskfs/osd_dynlocks.h</h1><a href="osd__dynlocks_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef _OSD_DYNLOCKS_H</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define _OSD_DYNLOCKS_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;linux/list.h&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;linux/wait.h&gt;</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="comment">/*</span>
<a name="l00008"></a>00008 <span class="comment"> * lock&apos;s namespace:</span>
<a name="l00009"></a>00009 <span class="comment"> *   - list of locks</span>
<a name="l00010"></a>00010 <span class="comment"> *   - lock to protect this list</span>
<a name="l00011"></a>00011 <span class="comment"> */</span>
<a name="l00012"></a><a class="code" href="structdynlock.html">00012</a> <span class="keyword">struct </span><a class="code" href="structdynlock.html">dynlock</a> {
<a name="l00013"></a><a class="code" href="structdynlock.html#a5327008dc4618bb37858f15fd89b4066">00013</a>         <span class="keywordtype">unsigned</span>                <a class="code" href="structdynlock.html#a5327008dc4618bb37858f15fd89b4066">dl_magic</a>;
<a name="l00014"></a><a class="code" href="structdynlock.html#a305b5c96f37d2deb4df4876c2b073fa6">00014</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structdynlock.html#a305b5c96f37d2deb4df4876c2b073fa6">dl_list</a>;
<a name="l00015"></a><a class="code" href="structdynlock.html#a54f69e5e029afa6f4d2e7c44c04533c6">00015</a>         spinlock_t              <a class="code" href="structdynlock.html#a54f69e5e029afa6f4d2e7c44c04533c6">dl_list_lock</a>;
<a name="l00016"></a>00016 };
<a name="l00017"></a>00017 
<a name="l00018"></a><a class="code" href="osd__dynlocks_8h.html#a2965700a02be69cd5a2339f3d4b289f8">00018</a> <span class="keyword">enum</span> <a class="code" href="osd__dynlocks_8h.html#a2965700a02be69cd5a2339f3d4b289f8">dynlock_type</a> {
<a name="l00019"></a><a class="code" href="osd__dynlocks_8h.html#a2965700a02be69cd5a2339f3d4b289f8aace42992de4c44dbab812f2f0ee5d8b4">00019</a>         <a class="code" href="osd__dynlocks_8h.html#a2965700a02be69cd5a2339f3d4b289f8aace42992de4c44dbab812f2f0ee5d8b4">DLT_WRITE</a>,
<a name="l00020"></a><a class="code" href="osd__dynlocks_8h.html#a2965700a02be69cd5a2339f3d4b289f8a44e58598ac5d93a19f6b54faeddf1296">00020</a>         <a class="code" href="osd__dynlocks_8h.html#a2965700a02be69cd5a2339f3d4b289f8a44e58598ac5d93a19f6b54faeddf1296">DLT_READ</a>
<a name="l00021"></a>00021 };
<a name="l00022"></a>00022 
<a name="l00023"></a><a class="code" href="structdynlock__handle.html">00023</a> <span class="keyword">struct </span><a class="code" href="structdynlock__handle.html">dynlock_handle</a> {
<a name="l00024"></a><a class="code" href="structdynlock__handle.html#a9d7e93d2045568f21912b93b225d161e">00024</a>         <span class="keywordtype">unsigned</span>                <a class="code" href="structdynlock__handle.html#a9d7e93d2045568f21912b93b225d161e">dh_magic</a>;
<a name="l00025"></a><a class="code" href="structdynlock__handle.html#a1642afe936dbb1127c8044d8f37d0b90">00025</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structdynlock__handle.html#a1642afe936dbb1127c8044d8f37d0b90">dh_list</a>;
<a name="l00026"></a><a class="code" href="structdynlock__handle.html#a043f4c8ea97ed7eafe60a3c6943d680d">00026</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>           <a class="code" href="structdynlock__handle.html#a043f4c8ea97ed7eafe60a3c6943d680d">dh_value</a>;       <span class="comment">/* lock value */</span>
<a name="l00027"></a><a class="code" href="structdynlock__handle.html#a1b0c65a5ea3cc04cd3d49fb9804d55cf">00027</a>         <span class="keywordtype">int</span>                     <a class="code" href="structdynlock__handle.html#a1b0c65a5ea3cc04cd3d49fb9804d55cf">dh_refcount</a>;    <span class="comment">/* number of users */</span>
<a name="l00028"></a><a class="code" href="structdynlock__handle.html#a01e1917f145a602e7513c8e3cc0464a2">00028</a>         <span class="keywordtype">int</span>                     <a class="code" href="structdynlock__handle.html#a01e1917f145a602e7513c8e3cc0464a2">dh_readers</a>;
<a name="l00029"></a><a class="code" href="structdynlock__handle.html#a72555058a32a25c485514c248b5642f8">00029</a>         <span class="keywordtype">int</span>                     <a class="code" href="structdynlock__handle.html#a72555058a32a25c485514c248b5642f8">dh_writers</a>;
<a name="l00030"></a><a class="code" href="structdynlock__handle.html#abdfdc97ed0f705938eb5870a56291113">00030</a>         <span class="keywordtype">int</span>                     <a class="code" href="structdynlock__handle.html#abdfdc97ed0f705938eb5870a56291113">dh_pid</a>;         <span class="comment">/* holder of the lock */</span>
<a name="l00031"></a><a class="code" href="structdynlock__handle.html#abf21fc8fe68372556912be7e916e1747">00031</a>         wait_queue_head_t       <a class="code" href="structdynlock__handle.html#abf21fc8fe68372556912be7e916e1747">dh_wait</a>;
<a name="l00032"></a>00032 };
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keywordtype">void</span> <a class="code" href="osd__dynlocks_8c.html#a82f7ed7e6ba13307fa97c9417b4ca9c1">dynlock_init</a>(<span class="keyword">struct</span> <a class="code" href="structdynlock.html">dynlock</a> *dl);
<a name="l00035"></a>00035 <span class="keyword">struct </span><a class="code" href="structdynlock__handle.html">dynlock_handle</a> *<a class="code" href="osd__dynlocks_8c.html#aac0b9926ce2522deec3a4129fc79c150">dynlock_lock</a>(<span class="keyword">struct</span> <a class="code" href="structdynlock.html">dynlock</a> *dl, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> value,
<a name="l00036"></a>00036                                     <span class="keyword">enum</span> <a class="code" href="osd__dynlocks_8h.html#a2965700a02be69cd5a2339f3d4b289f8">dynlock_type</a> lt, gfp_t gfp);
<a name="l00037"></a>00037 <span class="keywordtype">void</span> <a class="code" href="osd__dynlocks_8c.html#a4c1a438286a1900be14d5efc048ed99e">dynlock_unlock</a>(<span class="keyword">struct</span> <a class="code" href="structdynlock.html">dynlock</a> *dl, <span class="keyword">struct</span> <a class="code" href="structdynlock__handle.html">dynlock_handle</a> *lock);
<a name="l00038"></a>00038 <span class="keywordtype">int</span> <a class="code" href="osd__dynlocks_8c.html#ac4e31eadad3606d72d5a09d3ad679a6c">dynlock_is_locked</a>(<span class="keyword">struct</span> <a class="code" href="structdynlock.html">dynlock</a> *dl, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> value);
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:40 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
