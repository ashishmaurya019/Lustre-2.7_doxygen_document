<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/ofd/ofd_lvb.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/ofd/ofd_lvb.c File Reference</h1><code>#include &lt;<a class="el" href="lustre__swab_8h_source.html">lustre_swab.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>&quot;</code><br/>

<p><a href="ofd__lvb_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__lvb_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>&nbsp;&nbsp;&nbsp;S_FILTER</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__lvb_8c.html#a6aa71fc60b4e89abb75f53a50f827b16">ofd_lvbo_free</a> (struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *res)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structldlm__valblock__ops.html#a1f9bba68aafe55b885f59f0ab69cca88">ldlm_valblock_ops::lvbo_free</a> for OFD.  <a href="#a6aa71fc60b4e89abb75f53a50f827b16"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__lvb_8c.html#af1a9defffc5bf96aa69c37e2271211be">ofd_lvbo_init</a> (struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *res)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structldlm__valblock__ops.html#a163fdf3cd2200c7fed6efeffc10a9f9a">ldlm_valblock_ops::lvbo_init</a> for OFD.  <a href="#af1a9defffc5bf96aa69c37e2271211be"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__lvb_8c.html#a8f035d65c5f1fe2223d91482d3dfb16e">ofd_lvbo_update</a> (struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *res, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int increase_only)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structldlm__valblock__ops.html#a2a67bc2634b21d63b85e93494b74a067">ldlm_valblock_ops::lvbo_update</a> for OFD.  <a href="#a8f035d65c5f1fe2223d91482d3dfb16e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__lvb_8c.html#a30622068195041556406cb5b46aefec0">ofd_lvbo_size</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structldlm__valblock__ops.html#ab6db7ae145623d30b6700052ac56367c">ldlm_valblock_ops::lvbo_size</a> for OFD.  <a href="#a30622068195041556406cb5b46aefec0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__lvb_8c.html#addd60c75af4ace6c3ac0e72f913a4505">ofd_lvbo_fill</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, void *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, int buflen)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structldlm__valblock__ops.html#aa3569cda637416d3f27f7a4f1de678ef">ldlm_valblock_ops::lvbo_fill</a> for OFD.  <a href="#addd60c75af4ace6c3ac0e72f913a4505"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structldlm__valblock__ops.html">ldlm_valblock_ops</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__lvb_8c.html#af322483570ead4fcf76f62f40afe5cd8">ofd_lvbo</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="abda60744d497fcfe370cfd6b2d65c7ed"></a><!-- doxytag: member="ofd_lvb.c::DEBUG_SUBSYSTEM" ref="abda60744d497fcfe370cfd6b2d65c7ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_SUBSYSTEM&nbsp;&nbsp;&nbsp;S_FILTER</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__lvb_8c_source.html#l00046">46</a> of file <a class="el" href="ofd__lvb_8c_source.html">ofd_lvb.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="addd60c75af4ace6c3ac0e72f913a4505"></a><!-- doxytag: member="ofd_lvb.c::ofd_lvbo_fill" ref="addd60c75af4ace6c3ac0e72f913a4505" args="(struct ldlm_lock *lock, void *buf, int buflen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_lvbo_fill </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>buflen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structldlm__valblock__ops.html#aa3569cda637416d3f27f7a4f1de678ef">ldlm_valblock_ops::lvbo_fill</a> for OFD. </p>
<p>This function is called to fill the given RPC buffer <em>buf</em> with LVB data</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lock</em>&nbsp;</td><td>LDLM lock </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>RPC buffer to fill </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buflen</em>&nbsp;</td><td>buffer length</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>of LVB data written into <em>buf</em> buffer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__lvb_8c_source.html#l00361">361</a> of file <a class="el" href="ofd__lvb_8c_source.html">ofd_lvb.c</a>.</p>

<p>References <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__dlm_8h_source.html#l01537">lock_res()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00979">ldlm_resource::lr_lvb_data</a>, <a class="el" href="lustre__dlm_8h_source.html#l00976">ldlm_resource::lr_lvb_len</a>, <a class="el" href="ofd__lvb_8c_source.html#l00342">ofd_lvbo_size()</a>, <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>, and <a class="el" href="lustre__dlm_8h_source.html#l01550">unlock_res()</a>.</p>

</div>
</div>
<a class="anchor" id="a6aa71fc60b4e89abb75f53a50f827b16"></a><!-- doxytag: member="ofd_lvb.c::ofd_lvbo_free" ref="a6aa71fc60b4e89abb75f53a50f827b16" args="(struct ldlm_resource *res)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_lvbo_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *&nbsp;</td>
          <td class="paramname"> <em>res</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structldlm__valblock__ops.html#a1f9bba68aafe55b885f59f0ab69cca88">ldlm_valblock_ops::lvbo_free</a> for OFD. </p>
<p>This function frees allocated LVB data if it associated with the given LDLM resource.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>res</em>&nbsp;</td><td>LDLM resource</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on successful setup </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__lvb_8c_source.html#l00062">62</a> of file <a class="el" href="ofd__lvb_8c_source.html">ofd_lvb.c</a>.</p>

<p>References <a class="el" href="lustre__dlm_8h_source.html#l00979">ldlm_resource::lr_lvb_data</a>, <a class="el" href="lustre__dlm_8h_source.html#l00976">ldlm_resource::lr_lvb_len</a>, and <a class="el" href="obd__support_8h_source.html#l00776">OBD_FREE</a>.</p>

</div>
</div>
<a class="anchor" id="af1a9defffc5bf96aa69c37e2271211be"></a><!-- doxytag: member="ofd_lvb.c::ofd_lvbo_init" ref="af1a9defffc5bf96aa69c37e2271211be" args="(struct ldlm_resource *res)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_lvbo_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *&nbsp;</td>
          <td class="paramname"> <em>res</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structldlm__valblock__ops.html#a163fdf3cd2200c7fed6efeffc10a9f9a">ldlm_valblock_ops::lvbo_init</a> for OFD. </p>
<p>This function allocates and initializes new LVB data for the given LDLM resource if it is not allocated yet. New LVB is filled with attributes of the object associated with that resource. Function does nothing if LVB for the given LDLM resource is allocated already.</p>
<p>Called with res-&gt;lr_lvb_sem held.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>res</em>&nbsp;</td><td>LDLM resource</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on successful setup </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__lvb_8c_source.html#l00085">85</a> of file <a class="el" href="ofd__lvb_8c_source.html">ofd_lvb.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00145">D_DLMTRACE</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="ofd__internal_8h_source.html#l00298">ofd_thread_info::fti_fid</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00413">lu_attr::la_atime</a>, <a class="el" href="lu__object_8h_source.html#l00417">lu_attr::la_blocks</a>, <a class="el" href="lu__object_8h_source.html#l00415">lu_attr::la_ctime</a>, <a class="el" href="lu__object_8h_source.html#l00411">lu_attr::la_mtime</a>, <a class="el" href="lu__object_8h_source.html#l00409">lu_attr::la_size</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00999">LCT_DT_THREAD</a>, <a class="el" href="lustre__dlm_8h_source.html#l01000">ldlm_res_to_ns()</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="lustre__dlm_8h_source.html#l00979">ldlm_resource::lr_lvb_data</a>, <a class="el" href="lustre__dlm_8h_source.html#l00976">ldlm_resource::lr_lvb_len</a>, <a class="el" href="lustre__dlm_8h_source.html#l00977">ldlm_resource::lr_lvb_mutex</a>, <a class="el" href="lustre__dlm_8h_source.html#l00951">ldlm_resource::lr_name</a>, <a class="el" href="lustre__disk_8h_source.html#l00344">lr_server_data::lsd_osd_index</a>, <a class="el" href="lu__object_8c_source.html#l01881">lu_env_fini()</a>, <a class="el" href="lu__object_8c_source.html#l01869">lu_env_init()</a>, <a class="el" href="lu__target_8h_source.html#l00144">lu_target::lut_lsd</a>, <a class="el" href="lustre__idl_8h_source.html#l01818">ost_lvb::lvb_atime</a>, <a class="el" href="lustre__idl_8h_source.html#l01820">ost_lvb::lvb_blocks</a>, <a class="el" href="lustre__idl_8h_source.html#l01819">ost_lvb::lvb_ctime</a>, <a class="el" href="lustre__idl_8h_source.html#l01817">ost_lvb::lvb_mtime</a>, <a class="el" href="lustre__idl_8h_source.html#l01816">ost_lvb::lvb_size</a>, <a class="el" href="lustre__dlm_8h_source.html#l00458">ldlm_namespace::ns_lvbp</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00356">OBD_FAIL_LDLM_OST_LVB</a>, <a class="el" href="ofd__objects_8c_source.html#l00778">ofd_attr_get()</a>, <a class="el" href="ofd__internal_8h_source.html#l00511">ofd_info_init()</a>, <a class="el" href="ofd__internal_8h_source.html#l00125">ofd_device::ofd_lut</a>, <a class="el" href="ofd__objects_8c_source.html#l00102">ofd_object_find()</a>, <a class="el" href="ofd__objects_8c_source.html#l00174">ofd_object_put()</a>, <a class="el" href="lustre__fid_8h_source.html#l00666">ost_fid_from_resid()</a>, <a class="el" href="lustre__idl_8h_source.html#l01803">OST_LVB_SET_ERR</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

</div>
</div>
<a class="anchor" id="a30622068195041556406cb5b46aefec0"></a><!-- doxytag: member="ofd_lvb.c::ofd_lvbo_size" ref="a30622068195041556406cb5b46aefec0" args="(struct ldlm_lock *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_lvbo_size </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structldlm__valblock__ops.html#ab6db7ae145623d30b6700052ac56367c">ldlm_valblock_ops::lvbo_size</a> for OFD. </p>
<p>This function returns size of LVB data so appropriate RPC size will be reserved. This is used for compatibility needs between server and client of different Lustre versions.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lock</em>&nbsp;</td><td>LDLM lock</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>of LVB data </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__lvb_8c_source.html#l00342">342</a> of file <a class="el" href="ofd__lvb_8c_source.html">ofd_lvb.c</a>.</p>

<p>References <a class="el" href="lustre__export_8h_source.html#l00382">exp_connect_lvb_type()</a>, and <a class="el" href="lustre__dlm_8h_source.html#l00754">ldlm_lock::l_export</a>.</p>

<p>Referenced by <a class="el" href="ofd__lvb_8c_source.html#l00361">ofd_lvbo_fill()</a>.</p>

</div>
</div>
<a class="anchor" id="a8f035d65c5f1fe2223d91482d3dfb16e"></a><!-- doxytag: member="ofd_lvb.c::ofd_lvbo_update" ref="a8f035d65c5f1fe2223d91482d3dfb16e" args="(struct ldlm_resource *res, struct ptlrpc_request *req, int increase_only)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_lvbo_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *&nbsp;</td>
          <td class="paramname"> <em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>increase_only</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structldlm__valblock__ops.html#a2a67bc2634b21d63b85e93494b74a067">ldlm_valblock_ops::lvbo_update</a> for OFD. </p>
<p>When a client generates a glimpse enqueue, it wants to get the current file size and updated attributes for a stat() type operation, but these attributes may be writeback cached on another client. The client with the DLM extent lock at the highest offset is asked for its current attributes via a glimpse callback on its extent lock, on the assumption that it has the highest file size and the newest timestamps. The timestamps are guaranteed to be correct if there is only a single writer on the file, but may be slightly inaccurate if there are multiple concurrent writers on the same object. In order to avoid race conditions between the glimpse AST and the client cancelling the lock, <a class="el" href="ofd__lvb_8c.html#a8f035d65c5f1fe2223d91482d3dfb16e" title="Implementation of ldlm_valblock_ops::lvbo_update for OFD.">ofd_lvbo_update()</a> also updates the attributes from the local object. If the last client hasn't done any writes yet, or has already written its data and cancelled its lock before it processed the glimpse, then the local inode will have more uptodate information.</p>
<p>This is called in two ways: <em>req</em> != NULL : called by the DLM itself after a glimpse callback <em>req</em> == NULL : called by the OFD after a disk write</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>res</em>&nbsp;</td><td>LDLM resource </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>req</em>&nbsp;</td><td>PTLRPC request </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>increase_only</em>&nbsp;</td><td>don't allow LVB values to decrease</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on successful setup </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__lvb_8c_source.html#l00182">182</a> of file <a class="el" href="ofd__lvb_8c_source.html">ofd_lvb.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00145">D_DLMTRACE</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__export_8h_source.html#l00382">exp_connect_lvb_type()</a>, <a class="el" href="lustre__fid_8h_source.html#l00562">fid_extract_from_res_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="ofd__internal_8h_source.html#l00298">ofd_thread_info::fti_fid</a>, <a class="el" href="ofd__internal_8h_source.html#l00321">ofd_thread_info::fti_lvb</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lustre__export_8h_source.html#l00391">imp_connect_lvb_type()</a>, <a class="el" href="lu__object_8h_source.html#l00413">lu_attr::la_atime</a>, <a class="el" href="lu__object_8h_source.html#l00417">lu_attr::la_blocks</a>, <a class="el" href="lu__object_8h_source.html#l00415">lu_attr::la_ctime</a>, <a class="el" href="lu__object_8h_source.html#l00411">lu_attr::la_mtime</a>, <a class="el" href="lu__object_8h_source.html#l00409">lu_attr::la_size</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00999">LCT_DT_THREAD</a>, <a class="el" href="lustre__dlm_8h_source.html#l01000">ldlm_res_to_ns()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01537">lock_res()</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="lustre__dlm_8h_source.html#l00979">ldlm_resource::lr_lvb_data</a>, <a class="el" href="lustre__dlm_8h_source.html#l00951">ldlm_resource::lr_name</a>, <a class="el" href="lustre__disk_8h_source.html#l00344">lr_server_data::lsd_osd_index</a>, <a class="el" href="lu__object_8c_source.html#l01881">lu_env_fini()</a>, <a class="el" href="lu__object_8c_source.html#l01869">lu_env_init()</a>, <a class="el" href="req-layout_8c_source.html#l00088">lustre_swab_ost_lvb</a>, <a class="el" href="req-layout_8c_source.html#l00087">lustre_swab_ost_lvb_v1</a>, <a class="el" href="lu__target_8h_source.html#l00144">lu_target::lut_lsd</a>, <a class="el" href="lustre__idl_8h_source.html#l01818">ost_lvb::lvb_atime</a>, <a class="el" href="lustre__idl_8h_source.html#l01822">ost_lvb::lvb_atime_ns</a>, <a class="el" href="lustre__idl_8h_source.html#l01820">ost_lvb::lvb_blocks</a>, <a class="el" href="lustre__idl_8h_source.html#l01819">ost_lvb::lvb_ctime</a>, <a class="el" href="lustre__idl_8h_source.html#l01823">ost_lvb::lvb_ctime_ns</a>, <a class="el" href="lustre__idl_8h_source.html#l01817">ost_lvb::lvb_mtime</a>, <a class="el" href="lustre__idl_8h_source.html#l01821">ost_lvb::lvb_mtime_ns</a>, <a class="el" href="lustre__idl_8h_source.html#l01816">ost_lvb::lvb_size</a>, <a class="el" href="lustre__dlm_8h_source.html#l00458">ldlm_namespace::ns_lvbp</a>, <a class="el" href="ofd__objects_8c_source.html#l00778">ofd_attr_get()</a>, <a class="el" href="ofd__internal_8h_source.html#l00511">ofd_info_init()</a>, <a class="el" href="ofd__internal_8h_source.html#l00125">ofd_device::ofd_lut</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__objects_8c_source.html#l00102">ofd_object_find()</a>, <a class="el" href="ofd__objects_8c_source.html#l00174">ofd_object_put()</a>, <a class="el" href="lustre__fid_8h_source.html#l00666">ost_fid_from_resid()</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="layout_8c_source.html#l02171">req_capsule_server_swab_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01049">RMF_DLM_LVB</a>, <a class="el" href="lustre__net_8h_source.html#l01102">ptlrpc_request::rq_export</a>, <a class="el" href="lustre__net_8h_source.html#l01104">ptlrpc_request::rq_import</a>, <a class="el" href="lustre__net_8h_source.html#l01121">ptlrpc_request::rq_pill</a>, and <a class="el" href="lustre__dlm_8h_source.html#l01550">unlock_res()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="af322483570ead4fcf76f62f40afe5cd8"></a><!-- doxytag: member="ofd_lvb.c::ofd_lvbo" ref="af322483570ead4fcf76f62f40afe5cd8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structldlm__valblock__ops.html">ldlm_valblock_ops</a> <a class="el" href="ofd__lvb_8c.html#af322483570ead4fcf76f62f40afe5cd8">ofd_lvbo</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .lvbo_init      = <a class="code" href="ofd__lvb_8c.html#af1a9defffc5bf96aa69c37e2271211be" title="Implementation of ldlm_valblock_ops::lvbo_init for OFD.">ofd_lvbo_init</a>,
        .lvbo_update    = <a class="code" href="ofd__lvb_8c.html#a8f035d65c5f1fe2223d91482d3dfb16e" title="Implementation of ldlm_valblock_ops::lvbo_update for OFD.">ofd_lvbo_update</a>,
        .lvbo_free      = <a class="code" href="ofd__lvb_8c.html#a6aa71fc60b4e89abb75f53a50f827b16" title="Implementation of ldlm_valblock_ops::lvbo_free for OFD.">ofd_lvbo_free</a>,
        .lvbo_size      = <a class="code" href="ofd__lvb_8c.html#a30622068195041556406cb5b46aefec0" title="Implementation of ldlm_valblock_ops::lvbo_size for OFD.">ofd_lvbo_size</a>,
        .lvbo_fill      = <a class="code" href="ofd__lvb_8c.html#addd60c75af4ace6c3ac0e72f913a4505" title="Implementation of ldlm_valblock_ops::lvbo_fill for OFD.">ofd_lvbo_fill</a>
}
</pre></div>
<p>Definition at line <a class="el" href="ofd__lvb_8c_source.html#l00383">383</a> of file <a class="el" href="ofd__lvb_8c_source.html">ofd_lvb.c</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:49 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
