<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/include/lustre_log.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>lustre/include/lustre_log.h</h1><a href="lustre__log_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * GPL HEADER START</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> * it under the terms of the GNU General Public License version 2 only,</span>
<a name="l00008"></a>00008 <span class="comment"> * as published by the Free Software Foundation.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * This program is distributed in the hope that it will be useful, but</span>
<a name="l00011"></a>00011 <span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00013"></a>00013 <span class="comment"> * General Public License version 2 for more details (a copy is included</span>
<a name="l00014"></a>00014 <span class="comment"> * in the LICENSE file that accompanied this code).</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> * version 2 along with this program; If not, see</span>
<a name="l00018"></a>00018 <span class="comment"> * http://www.gnu.org/licenses/gpl-2.0.html</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * GPL HEADER END</span>
<a name="l00021"></a>00021 <span class="comment"> */</span>
<a name="l00022"></a>00022 <span class="comment">/*</span>
<a name="l00023"></a>00023 <span class="comment"> * Copyright (c) 2007, 2010, Oracle and/or its affiliates. All rights reserved.</span>
<a name="l00024"></a>00024 <span class="comment"> * Use is subject to license terms.</span>
<a name="l00025"></a>00025 <span class="comment"> *</span>
<a name="l00026"></a>00026 <span class="comment"> * Copyright (c) 2012, 2015, Intel Corporation.</span>
<a name="l00027"></a>00027 <span class="comment"> */</span>
<a name="l00028"></a>00028 <span class="comment">/*</span>
<a name="l00029"></a>00029 <span class="comment"> * This file is part of Lustre, http://www.lustre.org/</span>
<a name="l00030"></a>00030 <span class="comment"> *</span>
<a name="l00031"></a>00031 <span class="comment"> * lustre/include/lustre_log.h</span>
<a name="l00032"></a>00032 <span class="comment"> *</span>
<a name="l00033"></a>00033 <span class="comment"> * Generic infrastructure for managing a collection of logs.</span>
<a name="l00034"></a>00034 <span class="comment"> * These logs are used for:</span>
<a name="l00035"></a>00035 <span class="comment"> *</span>
<a name="l00036"></a>00036 <span class="comment"> * - orphan recovery: OST adds record on create</span>
<a name="l00037"></a>00037 <span class="comment"> * - mtime/size consistency: the OST adds a record on first write</span>
<a name="l00038"></a>00038 <span class="comment"> * - open/unlinked objects: OST adds a record on destroy</span>
<a name="l00039"></a>00039 <span class="comment"> *</span>
<a name="l00040"></a>00040 <span class="comment"> * - mds unlink log: the MDS adds an entry upon delete</span>
<a name="l00041"></a>00041 <span class="comment"> *</span>
<a name="l00042"></a>00042 <span class="comment"> * - raid1 replication log between OST&apos;s</span>
<a name="l00043"></a>00043 <span class="comment"> * - MDS replication logs</span>
<a name="l00044"></a>00044 <span class="comment"> */</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="preprocessor">#ifndef _LUSTRE_LOG_H</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span><span class="preprocessor">#define _LUSTRE_LOG_H</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &lt;<a class="code" href="obd__class_8h.html">obd_class.h</a>&gt;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &lt;<a class="code" href="lustre__idl_8h.html">lustre/lustre_idl.h</a>&gt;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &lt;<a class="code" href="dt__object_8h.html">dt_object.h</a>&gt;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &lt;<a class="code" href="lustre__log__user_8h.html">lustre_log_user.h</a>&gt;</span>
<a name="l00058"></a>00058 
<a name="l00059"></a><a class="code" href="group__log.html#ga74e6cb03b51a4cf136c43118fe7b8e94">00059</a> <span class="preprocessor">#define LOG_NAME_LIMIT(logname, name)                   \</span>
<a name="l00060"></a>00060 <span class="preprocessor">        snprintf(logname, sizeof(logname), &quot;LOGS/%s&quot;, name)</span>
<a name="l00061"></a><a class="code" href="group__log.html#ga11a3e78a53c53d8166c2ce7b39312626">00061</a> <span class="preprocessor"></span><span class="preprocessor">#define LLOG_EEMPTY 4711</span>
<a name="l00062"></a>00062 <span class="preprocessor"></span>
<a name="l00063"></a><a class="code" href="group__log.html#ga2f1ab12fceef20a1f6a2c3fbf3b28afa">00063</a> <span class="keyword">enum</span> <a class="code" href="group__log.html#ga2f1ab12fceef20a1f6a2c3fbf3b28afa">llog_open_param</a> {
<a name="l00064"></a><a class="code" href="group__log.html#gga2f1ab12fceef20a1f6a2c3fbf3b28afaa073db74e795998cce75026e71ba61132">00064</a>         <a class="code" href="group__log.html#gga2f1ab12fceef20a1f6a2c3fbf3b28afaa073db74e795998cce75026e71ba61132">LLOG_OPEN_EXISTS</a>        = 0x0000,
<a name="l00065"></a><a class="code" href="group__log.html#gga2f1ab12fceef20a1f6a2c3fbf3b28afaa4d8bcc2f3a93dd7afb6b4bb857f7d103">00065</a>         <a class="code" href="group__log.html#gga2f1ab12fceef20a1f6a2c3fbf3b28afaa4d8bcc2f3a93dd7afb6b4bb857f7d103">LLOG_OPEN_NEW</a>           = 0x0001,
<a name="l00066"></a>00066 };
<a name="l00067"></a>00067 
<a name="l00068"></a><a class="code" href="structplain__handle__data.html">00068</a> <span class="keyword">struct </span><a class="code" href="structplain__handle__data.html">plain_handle_data</a> {
<a name="l00069"></a><a class="code" href="structplain__handle__data.html#a5aa609866edc9f7dab3d8ec7b1ac977d">00069</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structplain__handle__data.html#a5aa609866edc9f7dab3d8ec7b1ac977d">phd_entry</a>;
<a name="l00070"></a><a class="code" href="structplain__handle__data.html#ad451ee1ad3ba2debc574e34b619d9282">00070</a>         <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a>      *<a class="code" href="structplain__handle__data.html#ad451ee1ad3ba2debc574e34b619d9282">phd_cat_handle</a>;
<a name="l00071"></a>00071         <span class="comment">/* cookie of this log in its cat */</span>
<a name="l00072"></a><a class="code" href="structplain__handle__data.html#afd78de1ff0100703057fe5536ab27ad7">00072</a>         <span class="keyword">struct </span><a class="code" href="structllog__cookie.html" title="log cookies are used to reference a specific log file and a record therein">llog_cookie</a>      <a class="code" href="structplain__handle__data.html#afd78de1ff0100703057fe5536ab27ad7">phd_cookie</a>;
<a name="l00073"></a>00073 };
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="structcat__handle__data.html">00075</a> <span class="keyword">struct </span><a class="code" href="structcat__handle__data.html">cat_handle_data</a> {
<a name="l00076"></a><a class="code" href="structcat__handle__data.html#a2975687d0c8cfda735d4d8c30ee8dcb7">00076</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structcat__handle__data.html#a2975687d0c8cfda735d4d8c30ee8dcb7">chd_head</a>;
<a name="l00077"></a><a class="code" href="structcat__handle__data.html#a5692057e5e819d115a73b35a7121379b">00077</a>         <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a>     *<a class="code" href="structcat__handle__data.html#a5692057e5e819d115a73b35a7121379b">chd_current_log</a>;<span class="comment">/* currently open log */</span>
<a name="l00078"></a><a class="code" href="structcat__handle__data.html#a9b3bbc4f87ab7f504750732c8edaa197">00078</a>         <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a>     *<a class="code" href="structcat__handle__data.html#a9b3bbc4f87ab7f504750732c8edaa197">chd_next_log</a>;   <span class="comment">/* llog to be used next */</span>
<a name="l00079"></a>00079 };
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a>;
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <span class="comment">/* llog.c  -  general API */</span>
<a name="l00084"></a>00084 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga546fd23355c24d4ee2a5a668423c0156">llog_init_handle</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *handle,
<a name="l00085"></a>00085                      <span class="keywordtype">int</span> flags, <span class="keyword">struct</span> <a class="code" href="structobd__uuid.html">obd_uuid</a> *<a class="code" href="llog__test_8c.html#aaa83f069991aa91e0383af81ef30f13f">uuid</a>);
<a name="l00086"></a>00086 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga29d5501b6e8f8d880d210907b6ef8f68">llog_copy_handler</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *llh,
<a name="l00087"></a>00087                       <span class="keyword">struct</span> <a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec, <span class="keywordtype">void</span> *data);
<a name="l00088"></a>00088 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga80616f32350d097166d698292330b6b2">llog_process</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *loghandle,
<a name="l00089"></a>00089                  <a class="code" href="obd__class_8h.html#a6753dc16f88d31c1a4fdd28a48dc1cf9">llog_cb_t</a> <a class="code" href="it__test_8c.html#a3edc96db5310d665bb056d7adc554a8f">cb</a>, <span class="keywordtype">void</span> *data, <span class="keywordtype">void</span> *catdata);
<a name="l00090"></a>00090 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gaf0d3652ea7d74d6ac5ee335584a33d72">llog_process_or_fork</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00091"></a>00091                          <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *loghandle,
<a name="l00092"></a>00092                          <a class="code" href="obd__class_8h.html#a6753dc16f88d31c1a4fdd28a48dc1cf9">llog_cb_t</a> <a class="code" href="it__test_8c.html#a3edc96db5310d665bb056d7adc554a8f">cb</a>, <span class="keywordtype">void</span> *data, <span class="keywordtype">void</span> *catdata, <span class="keywordtype">bool</span> fork);
<a name="l00093"></a>00093 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga97008e41a5f1114f3b26e8718c8e73de">llog_reverse_process</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00094"></a>00094                          <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *loghandle, <a class="code" href="obd__class_8h.html#a6753dc16f88d31c1a4fdd28a48dc1cf9">llog_cb_t</a> <a class="code" href="it__test_8c.html#a3edc96db5310d665bb056d7adc554a8f">cb</a>,
<a name="l00095"></a>00095                          <span class="keywordtype">void</span> *data, <span class="keywordtype">void</span> *catdata);
<a name="l00096"></a>00096 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gae7cdad9d32ae44d0ae5428b11741368d">llog_cancel_rec</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *loghandle,
<a name="l00097"></a>00097                     <span class="keywordtype">int</span> index);
<a name="l00098"></a>00098 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gae5358b955b7d709ed7f5416022472539">llog_open</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt,
<a name="l00099"></a>00099               <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> **lgh, <span class="keyword">struct</span> <a class="code" href="structllog__logid.html" title="Identifier for a single log object.">llog_logid</a> *logid,
<a name="l00100"></a>00100               <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="keyword">enum</span> <a class="code" href="group__log.html#ga2f1ab12fceef20a1f6a2c3fbf3b28afa">llog_open_param</a> open_param);
<a name="l00101"></a>00101 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga9487d7128a3cf457ff2a9181ce152b74">llog_close</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *cathandle);
<a name="l00102"></a>00102 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga313d57d22838eb9027b38ee417701af3" title="Helper function to get the llog size in records.">llog_is_empty</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt,
<a name="l00103"></a>00103                   <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00104"></a>00104 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga2abc0dd1d2e6e6e1fca19069346475fa">llog_backup</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structobd__device.html">obd_device</a> *obd,
<a name="l00105"></a>00105                 <span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt, <span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *bak_ctxt,
<a name="l00106"></a>00106                 <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="keywordtype">char</span> *backup);
<a name="l00107"></a>00107 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga3dff118eacffed836e2f50775e042350">llog_read_header</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *handle,
<a name="l00108"></a>00108                      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structobd__uuid.html">obd_uuid</a> *<a class="code" href="llog__test_8c.html#aaa83f069991aa91e0383af81ef30f13f">uuid</a>);
<a name="l00109"></a>00109 <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="group__log.html#gaae74cc5ecdf5ceda1159ad495cef0113">llog_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *llh);
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 <span class="comment">/* llog_process flags */</span>
<a name="l00112"></a><a class="code" href="group__log.html#ga35da509d8eee29b3b11292e4e81d1c2f">00112</a> <span class="preprocessor">#define LLOG_FLAG_NODEAMON 0x0001</span>
<a name="l00113"></a>00113 <span class="preprocessor"></span>
<a name="l00114"></a>00114 <span class="comment">/* llog_cat.c - catalog api */</span>
<a name="l00115"></a><a class="code" href="structllog__process__data.html">00115</a> <span class="keyword">struct </span><a class="code" href="structllog__process__data.html">llog_process_data</a> {
<a name="l00120"></a><a class="code" href="structllog__process__data.html#a648146cbe02366a5d4d9f0c02f80a405">00120</a>         <span class="keywordtype">void</span>                *<a class="code" href="structllog__process__data.html#a648146cbe02366a5d4d9f0c02f80a405" title="Any useful data needed while processing catalog.">lpd_data</a>;
<a name="l00125"></a><a class="code" href="structllog__process__data.html#a1a2d3c012640e757f3da9ab5a10725f0">00125</a>         <a class="code" href="obd__class_8h.html#a6753dc16f88d31c1a4fdd28a48dc1cf9">llog_cb_t</a>            <a class="code" href="structllog__process__data.html#a1a2d3c012640e757f3da9ab5a10725f0" title="Catalog process callback function, called for each record in catalog.">lpd_cb</a>;
<a name="l00129"></a><a class="code" href="structllog__process__data.html#a051255f0e379f17774529e445a4549ac">00129</a>         <span class="keywordtype">int</span>                  <a class="code" href="structllog__process__data.html#a051255f0e379f17774529e445a4549ac" title="Start processing the catalog from startcat/startidx.">lpd_startcat</a>;
<a name="l00130"></a><a class="code" href="structllog__process__data.html#af8b2675e8cc4723c5aa534b0f2abd159">00130</a>         <span class="keywordtype">int</span>                  <a class="code" href="structllog__process__data.html#af8b2675e8cc4723c5aa534b0f2abd159">lpd_startidx</a>;
<a name="l00131"></a>00131 };
<a name="l00132"></a>00132 
<a name="l00133"></a><a class="code" href="structllog__process__cat__data.html">00133</a> <span class="keyword">struct </span><a class="code" href="structllog__process__cat__data.html">llog_process_cat_data</a> {
<a name="l00137"></a><a class="code" href="structllog__process__cat__data.html#a7ab2ded8bab7d2d749f397911acc686a">00137</a>         <span class="keywordtype">int</span>                  <a class="code" href="structllog__process__cat__data.html#a7ab2ded8bab7d2d749f397911acc686a" title="Temporary stored first_idx while scanning log.">lpcd_first_idx</a>;
<a name="l00141"></a><a class="code" href="structllog__process__cat__data.html#aed95ee6a3cc58810fe47fad32e072b1b">00141</a>         <span class="keywordtype">int</span>                  <a class="code" href="structllog__process__cat__data.html#aed95ee6a3cc58810fe47fad32e072b1b" title="Temporary stored last_idx while scanning log.">lpcd_last_idx</a>;
<a name="l00142"></a>00142 };
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga8b069ab8307aa0e5c401f0d0c3a2f43d">llog_cat_close</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *cathandle);
<a name="l00145"></a>00145 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gab876e211f585e8c75174f6b974e658c6">llog_cat_add_rec</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *cathandle,
<a name="l00146"></a>00146                      <span class="keyword">struct</span> <a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec, <span class="keyword">struct</span> <a class="code" href="structllog__cookie.html" title="log cookies are used to reference a specific log file and a record therein">llog_cookie</a> *reccookie,
<a name="l00147"></a>00147                      <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00148"></a>00148 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga7eff35965cc93d0bc953eb542a1d6a28">llog_cat_declare_add_rec</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00149"></a>00149                              <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *cathandle,
<a name="l00150"></a>00150                              <span class="keyword">struct</span> <a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00151"></a>00151 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga29a5a9134a1ef39c0042541245851ec6">llog_cat_add</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *cathandle,
<a name="l00152"></a>00152                  <span class="keyword">struct</span> <a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec, <span class="keyword">struct</span> <a class="code" href="structllog__cookie.html" title="log cookies are used to reference a specific log file and a record therein">llog_cookie</a> *reccookie);
<a name="l00153"></a>00153 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga0c7162acb072c7ebd237441cab38a622">llog_cat_cancel_records</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00154"></a>00154                             <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *cathandle, <span class="keywordtype">int</span> count,
<a name="l00155"></a>00155                             <span class="keyword">struct</span> <a class="code" href="structllog__cookie.html" title="log cookies are used to reference a specific log file and a record therein">llog_cookie</a> *cookies);
<a name="l00156"></a>00156 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga3a958539869b4156163d2c006bd92f5a">llog_cat_process_or_fork</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00157"></a>00157                              <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *cat_llh, <a class="code" href="obd__class_8h.html#a6753dc16f88d31c1a4fdd28a48dc1cf9">llog_cb_t</a> cat_cb,
<a name="l00158"></a>00158                              <a class="code" href="obd__class_8h.html#a6753dc16f88d31c1a4fdd28a48dc1cf9">llog_cb_t</a> <a class="code" href="it__test_8c.html#a3edc96db5310d665bb056d7adc554a8f">cb</a>, <span class="keywordtype">void</span> *data, <span class="keywordtype">int</span> startcat,
<a name="l00159"></a>00159                              <span class="keywordtype">int</span> startidx, <span class="keywordtype">bool</span> fork);
<a name="l00160"></a>00160 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga466f538de595963c4d02460408b4ca01">llog_cat_process</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *cat_llh,
<a name="l00161"></a>00161                      <a class="code" href="obd__class_8h.html#a6753dc16f88d31c1a4fdd28a48dc1cf9">llog_cb_t</a> <a class="code" href="it__test_8c.html#a3edc96db5310d665bb056d7adc554a8f">cb</a>, <span class="keywordtype">void</span> *data, <span class="keywordtype">int</span> startcat, <span class="keywordtype">int</span> startidx);
<a name="l00162"></a>00162 <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="group__log.html#ga27b76b93ed632e0efcdeb31e0fac56a3">llog_cat_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *cat_llh);
<a name="l00163"></a>00163 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga8fed8fb641b91d077e635dfdc6b8446c">llog_cat_reverse_process</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00164"></a>00164                              <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *cat_llh, <a class="code" href="obd__class_8h.html#a6753dc16f88d31c1a4fdd28a48dc1cf9">llog_cb_t</a> <a class="code" href="it__test_8c.html#a3edc96db5310d665bb056d7adc554a8f">cb</a>,
<a name="l00165"></a>00165                              <span class="keywordtype">void</span> *data);
<a name="l00166"></a>00166 <span class="comment">/* llog_obd.c */</span>
<a name="l00167"></a>00167 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gaadc4cac8bd450c264283656f9ef4fc78">llog_setup</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structobd__device.html">obd_device</a> *obd,
<a name="l00168"></a>00168                <span class="keyword">struct</span> <a class="code" href="structobd__llog__group.html">obd_llog_group</a> *olg, <span class="keywordtype">int</span> index,
<a name="l00169"></a>00169                <span class="keyword">struct</span> <a class="code" href="structobd__device.html">obd_device</a> *disk_obd, <span class="keyword">struct</span> <a class="code" href="structllog__operations.html">llog_operations</a> *<a class="code" href="iam__ut_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>);
<a name="l00170"></a>00170 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gab112c9591fc2a2f0efcf70bc2954134f">__llog_ctxt_put</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt);
<a name="l00171"></a>00171 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga2c27342dc9861167548b2e367677a394">llog_cleanup</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *);
<a name="l00172"></a>00172 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga470133f89aab4b9f9047b2ab53d17de0">llog_sync</a>(<span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt, <span class="keyword">struct</span> <a class="code" href="structobd__export.html" title="Export structure.">obd_export</a> *exp, <span class="keywordtype">int</span> flags);
<a name="l00173"></a>00173 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gacd31f6ab5afd67b879a840de8c6600da">llog_cancel</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt,
<a name="l00174"></a>00174                 <span class="keyword">struct</span> <a class="code" href="structllog__cookie.html" title="log cookies are used to reference a specific log file and a record therein">llog_cookie</a> *cookies, <span class="keywordtype">int</span> flags);
<a name="l00175"></a>00175 
<a name="l00176"></a>00176 <span class="comment">/* llog_ioctl.c */</span>
<a name="l00177"></a>00177 <span class="keyword">struct </span><a class="code" href="structobd__ioctl__data.html">obd_ioctl_data</a>;
<a name="l00178"></a>00178 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gaf09a118e062a45bcf3f7b4382b26658c">llog_ioctl</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt, <span class="keywordtype">int</span> <a class="code" href="mdsrate_8c.html#a7353cae57e2530c316ddacb27ef14932">cmd</a>,
<a name="l00179"></a>00179                <span class="keyword">struct</span> <a class="code" href="structobd__ioctl__data.html">obd_ioctl_data</a> *data);
<a name="l00180"></a>00180 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga1ffba3225716e68236cb031d76182315">llog_catalog_list</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *d,
<a name="l00181"></a>00181                       <span class="keywordtype">int</span> count, <span class="keyword">struct</span> <a class="code" href="structobd__ioctl__data.html">obd_ioctl_data</a> *data,
<a name="l00182"></a>00182                       <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid);
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="comment">/* llog_net.c */</span>
<a name="l00185"></a>00185 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gad9a6174ab2a5e0b1262d0b7c851fabb1">llog_initiator_connect</a>(<span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt);
<a name="l00186"></a>00186 
<a name="l00187"></a><a class="code" href="structllog__operations.html">00187</a> <span class="keyword">struct </span><a class="code" href="structllog__operations.html">llog_operations</a> {
<a name="l00188"></a>00188         int (*<a class="code" href="structllog__operations.html#a5ef863efa13a5e4eaf5920b176c9bd66">lop_declare_destroy</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00189"></a>00189                            <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *handle, <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00190"></a>00190         int (*<a class="code" href="structllog__operations.html#a12902ffa891d835b9dc331d13f58316a">lop_destroy</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00191"></a>00191                            <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *handle, <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00192"></a>00192         int (*<a class="code" href="structllog__operations.html#ad0ec4a0a2f4dc80122b545f96bfafe19">lop_next_block</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *h,
<a name="l00193"></a>00193                               <span class="keywordtype">int</span> *curr_idx, <span class="keywordtype">int</span> next_idx, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *offset,
<a name="l00194"></a>00194                               <span class="keywordtype">void</span> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>, <span class="keywordtype">int</span> len);
<a name="l00195"></a>00195         int (*<a class="code" href="structllog__operations.html#a2c18ae2dbd35efba4c2ea1189d9b42bf">lop_prev_block</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *h,
<a name="l00196"></a>00196                               <span class="keywordtype">int</span> prev_idx, <span class="keywordtype">void</span> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>, <span class="keywordtype">int</span> len);
<a name="l00197"></a>00197         int (*<a class="code" href="structllog__operations.html#aa56eaf539028c053fba807755f2e52c6">lop_read_header</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00198"></a>00198                                <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *handle);
<a name="l00199"></a>00199         int (*<a class="code" href="structllog__operations.html#aa60c77a514c92bec4f788b6e624697a1">lop_setup</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structobd__device.html">obd_device</a> *obd,
<a name="l00200"></a>00200                          <span class="keyword">struct </span><a class="code" href="structobd__llog__group.html">obd_llog_group</a> *olg, <span class="keywordtype">int</span> ctxt_idx,
<a name="l00201"></a>00201                          <span class="keyword">struct </span><a class="code" href="structobd__device.html">obd_device</a> *disk_obd);
<a name="l00202"></a>00202         int (*<a class="code" href="structllog__operations.html#a3b5067c31bb613cc608b216627024c32">lop_sync</a>)(<span class="keyword">struct </span><a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt, <span class="keyword">struct </span><a class="code" href="structobd__export.html" title="Export structure.">obd_export</a> *exp,
<a name="l00203"></a>00203                         <span class="keywordtype">int</span> flags);
<a name="l00204"></a>00204         int (*<a class="code" href="structllog__operations.html#a27c3479a9b5464a027e1be85e128bb5c">lop_cleanup</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt);
<a name="l00205"></a>00205         int (*<a class="code" href="structllog__operations.html#ad51b832125eb3d3faa9586231a754526">lop_cancel</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt,
<a name="l00206"></a>00206                           <span class="keyword">struct </span><a class="code" href="structllog__cookie.html" title="log cookies are used to reference a specific log file and a record therein">llog_cookie</a> *cookies, <span class="keywordtype">int</span> flags);
<a name="l00207"></a>00207         int (*<a class="code" href="structllog__operations.html#a2e71f161d19a63bed0fabc5489b3cff2">lop_connect</a>)(<span class="keyword">struct </span><a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt, <span class="keyword">struct </span><a class="code" href="structllog__logid.html" title="Identifier for a single log object.">llog_logid</a> *logid,
<a name="l00208"></a>00208                            <span class="keyword">struct </span><a class="code" href="structllog__gen.html">llog_gen</a> *gen, <span class="keyword">struct </span><a class="code" href="structobd__uuid.html">obd_uuid</a> *<a class="code" href="llog__test_8c.html#aaa83f069991aa91e0383af81ef30f13f">uuid</a>);
<a name="l00214"></a>00214         int (*<a class="code" href="structllog__operations.html#a139a9f0deac13b8017cc19644232ecfb" title="Any llog file must be opened first using llog_open().">lop_open</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *lgh,
<a name="l00215"></a>00215                         <span class="keyword">struct </span><a class="code" href="structllog__logid.html" title="Identifier for a single log object.">llog_logid</a> *logid, <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,
<a name="l00216"></a>00216                         <span class="keyword">enum</span> <a class="code" href="group__log.html#ga2f1ab12fceef20a1f6a2c3fbf3b28afa">llog_open_param</a>);
<a name="l00221"></a>00221         int (*<a class="code" href="structllog__operations.html#ada3ec98e78c44d6186c26adf91f807a6" title="Opened llog may not exist and this must be checked where needed using the llog_exist()...">lop_exist</a>)(<span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *lgh);
<a name="l00226"></a>00226         int (*<a class="code" href="structllog__operations.html#ad1e04ab8212c5c53d654ea391c870b28" title="Close llog file and calls llog_free_handle() implicitly.">lop_close</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *handle);
<a name="l00231"></a>00231         int (*<a class="code" href="structllog__operations.html#ad999e480d8c46187a83855f78e8184ab" title="Create new llog file.">lop_declare_create</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00232"></a>00232                                   <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *handle,
<a name="l00233"></a>00233                                   <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00234"></a>00234         int (*<a class="code" href="structllog__operations.html#a5334de987fe3f3a3d5fc7c4a25abeffc">lop_create</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *handle,
<a name="l00235"></a>00235                           <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00240"></a>00240         int (*<a class="code" href="structllog__operations.html#ada38484d5d6669b28db201124b9ebc9e" title="write new record in llog.">lop_declare_write_rec</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00241"></a>00241                                      <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *lgh,
<a name="l00242"></a>00242                                      <span class="keyword">struct </span><a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec,
<a name="l00243"></a>00243                                      <span class="keywordtype">int</span> idx, <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00244"></a>00244         int (*<a class="code" href="structllog__operations.html#a164ddd70a80c75651e932792c774a325">lop_write_rec</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00245"></a>00245                              <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *loghandle,
<a name="l00246"></a>00246                              <span class="keyword">struct </span><a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec,
<a name="l00247"></a>00247                              <span class="keyword">struct </span><a class="code" href="structllog__cookie.html" title="log cookies are used to reference a specific log file and a record therein">llog_cookie</a> *cookie,
<a name="l00248"></a>00248                              <span class="keywordtype">int</span> idx, <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00253"></a>00253         int (*<a class="code" href="structllog__operations.html#a8d45958b3740ebc3a1e5316abaf002c7" title="Add new record in llog catalog.">lop_declare_add</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00254"></a>00254                                <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *lgh,
<a name="l00255"></a>00255                                <span class="keyword">struct </span><a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec, <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00256"></a>00256         int (*<a class="code" href="structllog__operations.html#ab49da4026ce87fc82e994ee69ba3d811">lop_add</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> *lgh,
<a name="l00257"></a>00257                        <span class="keyword">struct </span><a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec, <span class="keyword">struct </span><a class="code" href="structllog__cookie.html" title="log cookies are used to reference a specific log file and a record therein">llog_cookie</a> *cookie,
<a name="l00258"></a>00258                        <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00259"></a>00259 };
<a name="l00260"></a>00260 
<a name="l00261"></a>00261 <span class="comment">/* In-memory descriptor for a log object or log catalog */</span>
<a name="l00262"></a><a class="code" href="structllog__handle.html">00262</a> <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a> {
<a name="l00263"></a><a class="code" href="structllog__handle.html#a775258f953291914424fb99fae414d06">00263</a>         <span class="keyword">struct </span>rw_semaphore      <a class="code" href="structllog__handle.html#a775258f953291914424fb99fae414d06">lgh_lock</a>;
<a name="l00264"></a><a class="code" href="structllog__handle.html#a046bd4a53e0cf1cafd6ee02fd5f6a54e">00264</a>         <span class="keyword">struct </span>mutex             <a class="code" href="structllog__handle.html#a046bd4a53e0cf1cafd6ee02fd5f6a54e">lgh_hdr_mutex</a>; <span class="comment">/* protect lgh_hdr data */</span>
<a name="l00265"></a><a class="code" href="structllog__handle.html#ac6111ff7a45bf2191577f4a8174488fb">00265</a>         <span class="keyword">struct </span><a class="code" href="structllog__logid.html" title="Identifier for a single log object.">llog_logid</a>        <a class="code" href="structllog__handle.html#ac6111ff7a45bf2191577f4a8174488fb">lgh_id</a>; <span class="comment">/* id of this log */</span>
<a name="l00266"></a><a class="code" href="structllog__handle.html#a1e70205e9f7abb9140cfcb37a42611e8">00266</a>         <span class="keyword">struct </span><a class="code" href="structllog__log__hdr.html">llog_log_hdr</a>     *<a class="code" href="structllog__handle.html#a1e70205e9f7abb9140cfcb37a42611e8">lgh_hdr</a>; <span class="comment">/* may be vmalloc&apos;d */</span>
<a name="l00267"></a><a class="code" href="structllog__handle.html#a35be130a0a3b5ef609f19c0677670c42">00267</a>         <span class="keywordtype">size_t</span>                  <a class="code" href="structllog__handle.html#a35be130a0a3b5ef609f19c0677670c42">lgh_hdr_size</a>;
<a name="l00268"></a><a class="code" href="structllog__handle.html#afa5bbd13c6d5f5760b79ec0f01856a49">00268</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>        *<a class="code" href="structllog__handle.html#afa5bbd13c6d5f5760b79ec0f01856a49">lgh_obj</a>;
<a name="l00269"></a>00269         <span class="comment">/* For a Catalog, is the last/newest used index for a plain slot.</span>
<a name="l00270"></a>00270 <span class="comment">         * Used in conjunction with llh_cat_idx to handle Catalog wrap-around</span>
<a name="l00271"></a>00271 <span class="comment">         * case, after it will have reached LLOG_HDR_BITMAP_SIZE, llh_cat_idx</span>
<a name="l00272"></a>00272 <span class="comment">         * will become its upper limit */</span>
<a name="l00273"></a><a class="code" href="structllog__handle.html#a35595d2c187895289c2ced0ee281bbec">00273</a>         <span class="keywordtype">int</span>                      <a class="code" href="structllog__handle.html#a35595d2c187895289c2ced0ee281bbec">lgh_last_idx</a>;
<a name="l00274"></a><a class="code" href="structllog__handle.html#aed0beb30321784cb2f7527dc1f1637f1">00274</a>         <span class="keywordtype">int</span>                      <a class="code" href="structllog__handle.html#aed0beb30321784cb2f7527dc1f1637f1">lgh_cur_idx</a>; <span class="comment">/* used during llog_process */</span>
<a name="l00275"></a><a class="code" href="structllog__handle.html#a7060bdbbfdeda62a2639fe3944ddc27d">00275</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                    <a class="code" href="structllog__handle.html#a7060bdbbfdeda62a2639fe3944ddc27d">lgh_cur_offset</a>; <span class="comment">/* used during llog_process */</span>
<a name="l00276"></a>00276         <span class="comment">/* used during llog_osd_write_rec */</span>
<a name="l00277"></a><a class="code" href="structllog__handle.html#abd54eaeb20d67f8eebb09532ffb6c5b0">00277</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                    <a class="code" href="structllog__handle.html#abd54eaeb20d67f8eebb09532ffb6c5b0">lgh_write_offset</a>;
<a name="l00278"></a><a class="code" href="structllog__handle.html#aa4ded7ba0f2bdfb242813efe5d7dd761">00278</a>         <span class="keyword">struct </span><a class="code" href="structllog__ctxt.html">llog_ctxt</a>        *<a class="code" href="structllog__handle.html#aa4ded7ba0f2bdfb242813efe5d7dd761">lgh_ctxt</a>;
<a name="l00279"></a>00279         <span class="keyword">union </span>{
<a name="l00280"></a><a class="code" href="structllog__handle.html#aaa9c3d45d9ff8e095efc9d5982b19e5d">00280</a>                 <span class="keyword">struct </span><a class="code" href="structplain__handle__data.html">plain_handle_data</a>         <a class="code" href="structllog__handle.html#aaa9c3d45d9ff8e095efc9d5982b19e5d">phd</a>;
<a name="l00281"></a><a class="code" href="structllog__handle.html#a9afa53f25e1d6aedc2ce515c793bb7ba">00281</a>                 <span class="keyword">struct </span><a class="code" href="structcat__handle__data.html">cat_handle_data</a>           <a class="code" href="structllog__handle.html#a9afa53f25e1d6aedc2ce515c793bb7ba">chd</a>;
<a name="l00282"></a>00282         } <a class="code" href="structllog__handle.html#a6b57b14cf19ad1632ccff6ca9d53ef1c">u</a>;
<a name="l00283"></a><a class="code" href="structllog__handle.html#a45fc53375d1efb244bdd0ee880c85191">00283</a>         <span class="keywordtype">char</span>                    *<a class="code" href="structllog__handle.html#a45fc53375d1efb244bdd0ee880c85191">lgh_name</a>;
<a name="l00284"></a><a class="code" href="structllog__handle.html#aa53df796bf1f8a99ae798c6a3e0cf067">00284</a>         <span class="keywordtype">void</span>                    *<a class="code" href="structllog__handle.html#aa53df796bf1f8a99ae798c6a3e0cf067">private_data</a>;
<a name="l00285"></a><a class="code" href="structllog__handle.html#ad3f86290a0443a30040692213224ac6d">00285</a>         <span class="keyword">struct </span><a class="code" href="structllog__operations.html">llog_operations</a>  *<a class="code" href="structllog__handle.html#ad3f86290a0443a30040692213224ac6d">lgh_logops</a>;
<a name="l00286"></a><a class="code" href="structllog__handle.html#abc3f60d2fe4ca30ad39de3ee6df2425a">00286</a>         atomic_t                 <a class="code" href="structllog__handle.html#abc3f60d2fe4ca30ad39de3ee6df2425a">lgh_refcount</a>;
<a name="l00287"></a>00287 
<a name="l00288"></a><a class="code" href="structllog__handle.html#a290b35412d13bbeffa5131d02ec8bb9a">00288</a>         __u32                   <a class="code" href="structllog__handle.html#a290b35412d13bbeffa5131d02ec8bb9a">lgh_stale</a>:1;
<a name="l00289"></a>00289 };
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 <span class="comment">/* llog_osd.c */</span>
<a name="l00292"></a>00292 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structllog__operations.html">llog_operations</a> <a class="code" href="group__log.html#ga9fe78077b320f0957c7c7c3e8052aaaa">llog_osd_ops</a>;
<a name="l00293"></a>00293 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structllog__operations.html">llog_operations</a> <a class="code" href="group__log.html#gaf91e7b25f0a5c9ca6385440f60b7b375">llog_common_cat_ops</a>;
<a name="l00294"></a>00294 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gaf0dee2455ecbe5cbeeec044344224613" title="Read the special file which contains the list of llog catalogs IDs.">llog_osd_get_cat_list</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *d,
<a name="l00295"></a>00295                           <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> count, <span class="keyword">struct</span> <a class="code" href="structllog__catid.html">llog_catid</a> *idarray,
<a name="l00296"></a>00296                           <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid);
<a name="l00297"></a>00297 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga4b308f3bee04638c301ba0bead3ad070" title="Write the special file which contains the list of llog catalogs IDs.">llog_osd_put_cat_list</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *d,
<a name="l00298"></a>00298                           <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> count, <span class="keyword">struct</span> <a class="code" href="structllog__catid.html">llog_catid</a> *idarray,
<a name="l00299"></a>00299                           <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid);
<a name="l00300"></a>00300 
<a name="l00301"></a><a class="code" href="group__log.html#ga9957e14aee1418edfa389cb625de57a7">00301</a> <span class="preprocessor">#define LLOG_CTXT_FLAG_UNINITIALIZED     0x00000001</span>
<a name="l00302"></a><a class="code" href="group__log.html#gad66792d5e5504a0a7e824ef5c67330d9">00302</a> <span class="preprocessor"></span><span class="preprocessor">#define LLOG_CTXT_FLAG_STOP              0x00000002</span>
<a name="l00303"></a>00303 <span class="preprocessor"></span>
<a name="l00304"></a>00304 <span class="comment">/* Indicate the llog objects under this context are normal FID objects,</span>
<a name="l00305"></a>00305 <span class="comment"> * instead of objects with local FID. */</span>
<a name="l00306"></a><a class="code" href="group__log.html#ga4fb64387d4343fd5387485fc0f600cb0">00306</a> <span class="preprocessor">#define LLOG_CTXT_FLAG_NORMAL_FID        0x00000004</span>
<a name="l00307"></a>00307 <span class="preprocessor"></span>
<a name="l00308"></a><a class="code" href="structllog__ctxt.html">00308</a> <span class="keyword">struct </span><a class="code" href="structllog__ctxt.html">llog_ctxt</a> {
<a name="l00309"></a><a class="code" href="structllog__ctxt.html#a038cba61b1e0d2e6afe3f7f5cd826bb3">00309</a>         <span class="keywordtype">int</span>                      <a class="code" href="structllog__ctxt.html#a038cba61b1e0d2e6afe3f7f5cd826bb3">loc_idx</a>; <span class="comment">/* my index the obd array of ctxt&apos;s */</span>
<a name="l00310"></a><a class="code" href="structllog__ctxt.html#af4ce05673ba2fbb2557f1a014c0e9b21">00310</a>         <span class="keyword">struct </span><a class="code" href="structobd__device.html">obd_device</a>       *<a class="code" href="structllog__ctxt.html#af4ce05673ba2fbb2557f1a014c0e9b21">loc_obd</a>; <span class="comment">/* points back to the containing obd*/</span>
<a name="l00311"></a><a class="code" href="structllog__ctxt.html#afc93cd7c7ac1149c57f07890deae799b">00311</a>         <span class="keyword">struct </span><a class="code" href="structobd__llog__group.html">obd_llog_group</a>   *<a class="code" href="structllog__ctxt.html#afc93cd7c7ac1149c57f07890deae799b">loc_olg</a>; <span class="comment">/* group containing that ctxt */</span>
<a name="l00312"></a><a class="code" href="structllog__ctxt.html#a93f50121ade9b2988083cebd479bf427">00312</a>         <span class="keyword">struct </span><a class="code" href="structobd__export.html" title="Export structure.">obd_export</a>       *<a class="code" href="structllog__ctxt.html#a93f50121ade9b2988083cebd479bf427">loc_exp</a>; <span class="comment">/* parent &quot;disk&quot; export (e.g. MDS) */</span>
<a name="l00313"></a><a class="code" href="structllog__ctxt.html#aecfe13577303cefaad1a6eb3eb629d27">00313</a>         <span class="keyword">struct </span><a class="code" href="structobd__import.html" title="Defintion of PortalRPC import structure.">obd_import</a>       *<a class="code" href="structllog__ctxt.html#aecfe13577303cefaad1a6eb3eb629d27">loc_imp</a>; <span class="comment">/* to use in RPC&apos;s: can be backward</span>
<a name="l00314"></a>00314 <span class="comment">                                             pointing import */</span>
<a name="l00315"></a><a class="code" href="structllog__ctxt.html#a830b425ae2ecfb6886f73cacdd80abc5">00315</a>         <span class="keyword">struct </span><a class="code" href="structllog__operations.html">llog_operations</a>  *<a class="code" href="structllog__ctxt.html#a830b425ae2ecfb6886f73cacdd80abc5">loc_logops</a>;
<a name="l00316"></a><a class="code" href="structllog__ctxt.html#aaab133ab19e5aa7a60c180698d4a831c">00316</a>         <span class="keyword">struct </span><a class="code" href="structllog__handle.html">llog_handle</a>      *<a class="code" href="structllog__ctxt.html#aaab133ab19e5aa7a60c180698d4a831c">loc_handle</a>;
<a name="l00317"></a><a class="code" href="structllog__ctxt.html#a96d69278481b030c8c3fe4798257cad4">00317</a>         <span class="keyword">struct </span>mutex             <a class="code" href="structllog__ctxt.html#a96d69278481b030c8c3fe4798257cad4">loc_mutex</a>; <span class="comment">/* protect loc_imp */</span>
<a name="l00318"></a><a class="code" href="structllog__ctxt.html#a98db114c94b3b5afa701f1d5261518a5">00318</a>         atomic_t                 <a class="code" href="structllog__ctxt.html#a98db114c94b3b5afa701f1d5261518a5">loc_refcount</a>;
<a name="l00319"></a><a class="code" href="structllog__ctxt.html#a415612178c6234f1dae35f8181ebbaf5">00319</a>         <span class="keywordtype">long</span>                     <a class="code" href="structllog__ctxt.html#a415612178c6234f1dae35f8181ebbaf5">loc_flags</a>; <span class="comment">/* flags, see above defines */</span>
<a name="l00320"></a><a class="code" href="structllog__ctxt.html#ace10c556980d546cb2369a724bbb75c7">00320</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>        *<a class="code" href="structllog__ctxt.html#ace10c556980d546cb2369a724bbb75c7">loc_dir</a>;
<a name="l00321"></a><a class="code" href="structllog__ctxt.html#a1bc03c4727658d52239774afd3ff05f7">00321</a>         <span class="keyword">struct </span><a class="code" href="structlocal__oid__storage.html">local_oid_storage</a> *<a class="code" href="structllog__ctxt.html#a1bc03c4727658d52239774afd3ff05f7">loc_los_nameless</a>;
<a name="l00322"></a><a class="code" href="structllog__ctxt.html#ac139aa693930e88a2a6c685c1aafd42d">00322</a>         <span class="keyword">struct </span><a class="code" href="structlocal__oid__storage.html">local_oid_storage</a> *<a class="code" href="structllog__ctxt.html#ac139aa693930e88a2a6c685c1aafd42d">loc_los_named</a>;
<a name="l00323"></a>00323         <span class="comment">/* llog chunk size, and llog record size can not be bigger than</span>
<a name="l00324"></a>00324 <span class="comment">         * loc_chunk_size */</span>
<a name="l00325"></a><a class="code" href="structllog__ctxt.html#a615b7885d02ab2de69f1eb869f4ddfac">00325</a>         __u32                    <a class="code" href="structllog__ctxt.html#a615b7885d02ab2de69f1eb869f4ddfac">loc_chunk_size</a>;
<a name="l00326"></a>00326 };
<a name="l00327"></a>00327 
<a name="l00328"></a><a class="code" href="group__log.html#gacdf0b47ad08d82835a118113f7472129">00328</a> <span class="preprocessor">#define LLOG_PROC_BREAK 0x0001</span>
<a name="l00329"></a><a class="code" href="group__log.html#ga1504202bf86ed271947570109ba14063">00329</a> <span class="preprocessor"></span><span class="preprocessor">#define LLOG_DEL_RECORD 0x0002</span>
<a name="l00330"></a><a class="code" href="group__log.html#ga537dcd78aa2fe2715b25f811bd5b4484">00330</a> <span class="preprocessor"></span><span class="preprocessor">#define LLOG_DEL_PLAIN  0x0003</span>
<a name="l00331"></a>00331 <span class="preprocessor"></span>
<a name="l00332"></a><a class="code" href="group__log.html#ga7f992ede04801280372ff61459941fe5">00332</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga7f992ede04801280372ff61459941fe5">llog_obd2ops</a>(<span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt,
<a name="l00333"></a>00333                                <span class="keyword">struct</span> <a class="code" href="structllog__operations.html">llog_operations</a> **lop)
<a name="l00334"></a>00334 {
<a name="l00335"></a>00335         <span class="keywordflow">if</span> (ctxt == NULL)
<a name="l00336"></a>00336                 <span class="keywordflow">return</span> -ENOTCONN;
<a name="l00337"></a>00337 
<a name="l00338"></a>00338         *lop = ctxt-&gt;<a class="code" href="structllog__ctxt.html#a830b425ae2ecfb6886f73cacdd80abc5">loc_logops</a>;
<a name="l00339"></a>00339         <span class="keywordflow">if</span> (*lop == NULL)
<a name="l00340"></a>00340                 <span class="keywordflow">return</span> -EOPNOTSUPP;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342         <span class="keywordflow">return</span> 0;
<a name="l00343"></a>00343 }
<a name="l00344"></a>00344 
<a name="l00345"></a><a class="code" href="group__log.html#ga427b3b7fcb73b3e21891f1b696d05992">00345</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga427b3b7fcb73b3e21891f1b696d05992">llog_handle2ops</a>(<span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *loghandle,
<a name="l00346"></a>00346                                   <span class="keyword">struct</span> <a class="code" href="structllog__operations.html">llog_operations</a> **lop)
<a name="l00347"></a>00347 {
<a name="l00348"></a>00348         <span class="keywordflow">if</span> (loghandle == NULL || loghandle-&gt;<a class="code" href="structllog__handle.html#ad3f86290a0443a30040692213224ac6d">lgh_logops</a> == NULL)
<a name="l00349"></a>00349                 <span class="keywordflow">return</span> -EINVAL;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351         *lop = loghandle-&gt;<a class="code" href="structllog__handle.html#ad3f86290a0443a30040692213224ac6d">lgh_logops</a>;
<a name="l00352"></a>00352         <span class="keywordflow">return</span> 0;
<a name="l00353"></a>00353 }
<a name="l00354"></a>00354 
<a name="l00355"></a><a class="code" href="group__log.html#ga2cb18b5f17a813719e7a45b2f731c9fa">00355</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga2cb18b5f17a813719e7a45b2f731c9fa">llog_data_len</a>(<span class="keywordtype">int</span> len)
<a name="l00356"></a>00356 {
<a name="l00357"></a>00357         <span class="keywordflow">return</span> <a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">cfs_size_round</a>(len);
<a name="l00358"></a>00358 }
<a name="l00359"></a>00359 
<a name="l00360"></a><a class="code" href="group__log.html#gac6cb4f1eca30e10268c569d1c4d98b8e">00360</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__log.html#gac6cb4f1eca30e10268c569d1c4d98b8e">llog_get_size</a>(<span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *loghandle)
<a name="l00361"></a>00361 {
<a name="l00362"></a>00362         <span class="keywordflow">if</span> (loghandle &amp;&amp; loghandle-&gt;<a class="code" href="structllog__handle.html#a1e70205e9f7abb9140cfcb37a42611e8">lgh_hdr</a>)
<a name="l00363"></a>00363                 <span class="keywordflow">return</span> loghandle-&gt;<a class="code" href="structllog__handle.html#a1e70205e9f7abb9140cfcb37a42611e8">lgh_hdr</a>-&gt;<a class="code" href="structllog__log__hdr.html#acf8a93eebfdf7cb367365aabd9de6187">llh_count</a>;
<a name="l00364"></a>00364         <span class="keywordflow">return</span> 0;
<a name="l00365"></a>00365 }
<a name="l00366"></a>00366 
<a name="l00367"></a><a class="code" href="group__log.html#ga5a7a4b2c40454970420123fad5b0f9a9">00367</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structllog__ctxt.html">llog_ctxt</a> *<a class="code" href="group__log.html#ga5a7a4b2c40454970420123fad5b0f9a9">llog_ctxt_get</a>(<span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt)
<a name="l00368"></a>00368 {
<a name="l00369"></a>00369         atomic_inc(&amp;ctxt-&gt;<a class="code" href="structllog__ctxt.html#a98db114c94b3b5afa701f1d5261518a5">loc_refcount</a>);
<a name="l00370"></a>00370         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#a61818a4c2cf85e96d77e6e46ca4ea853">D_INFO</a>, <span class="stringliteral">&quot;GETting ctxt %p : new refcount %d\n&quot;</span>, ctxt,
<a name="l00371"></a>00371                atomic_read(&amp;ctxt-&gt;<a class="code" href="structllog__ctxt.html#a98db114c94b3b5afa701f1d5261518a5">loc_refcount</a>));
<a name="l00372"></a>00372         <span class="keywordflow">return</span> ctxt;
<a name="l00373"></a>00373 }
<a name="l00374"></a>00374 
<a name="l00375"></a><a class="code" href="group__log.html#ga6074eb1c111e356e1a05fdb6a2189a65">00375</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__log.html#ga6074eb1c111e356e1a05fdb6a2189a65">llog_ctxt_put</a>(<span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt)
<a name="l00376"></a>00376 {
<a name="l00377"></a>00377         <span class="keywordflow">if</span> (ctxt == NULL)
<a name="l00378"></a>00378                 <span class="keywordflow">return</span>;
<a name="l00379"></a>00379         <a class="code" href="libcfs__private_8h.html#a29d874ab2febafca45d0950e06bb8c09" title="assert value of is great than  and little than ">LASSERT_ATOMIC_GT_LT</a>(&amp;ctxt-&gt;<a class="code" href="structllog__ctxt.html#a98db114c94b3b5afa701f1d5261518a5">loc_refcount</a>, 0, LI_POISON);
<a name="l00380"></a>00380         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#a61818a4c2cf85e96d77e6e46ca4ea853">D_INFO</a>, <span class="stringliteral">&quot;PUTting ctxt %p : new refcount %d\n&quot;</span>, ctxt,
<a name="l00381"></a>00381                atomic_read(&amp;ctxt-&gt;<a class="code" href="structllog__ctxt.html#a98db114c94b3b5afa701f1d5261518a5">loc_refcount</a>) - 1);
<a name="l00382"></a>00382         <a class="code" href="group__log.html#gab112c9591fc2a2f0efcf70bc2954134f">__llog_ctxt_put</a>(NULL, ctxt);
<a name="l00383"></a>00383 }
<a name="l00384"></a>00384 
<a name="l00385"></a><a class="code" href="group__log.html#ga422812a93eb89ae78af4cf28b661c58d">00385</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__log.html#ga422812a93eb89ae78af4cf28b661c58d">llog_group_init</a>(<span class="keyword">struct</span> <a class="code" href="structobd__llog__group.html">obd_llog_group</a> *olg)
<a name="l00386"></a>00386 {
<a name="l00387"></a>00387         init_waitqueue_head(&amp;olg-&gt;<a class="code" href="structobd__llog__group.html#acdbd360ebaee4fb8811967fe254afeb3">olg_waitq</a>);
<a name="l00388"></a>00388         spin_lock_init(&amp;olg-&gt;<a class="code" href="structobd__llog__group.html#a863c9c98a864d7fe8bf15268aeb969d2">olg_lock</a>);
<a name="l00389"></a>00389         mutex_init(&amp;olg-&gt;<a class="code" href="structobd__llog__group.html#a05ae8a330e5656ec8581f161ee0a8dc5">olg_cat_processing</a>);
<a name="l00390"></a>00390 }
<a name="l00391"></a>00391 
<a name="l00392"></a><a class="code" href="group__log.html#ga39118175485f4bfd0d263c56d12173eb">00392</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga39118175485f4bfd0d263c56d12173eb">llog_group_set_ctxt</a>(<span class="keyword">struct</span> <a class="code" href="structobd__llog__group.html">obd_llog_group</a> *olg,
<a name="l00393"></a>00393                                       <span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt, <span class="keywordtype">int</span> index)
<a name="l00394"></a>00394 {
<a name="l00395"></a>00395         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(index &gt;= 0 &amp;&amp; index &lt; <a class="code" href="group__lustreidl.html#ggaedddc461eb6cbba1f4f39241cabf24f1a8b20f3ec9ea67643038ef255c98d68f3">LLOG_MAX_CTXTS</a>);
<a name="l00396"></a>00396 
<a name="l00397"></a>00397         spin_lock(&amp;olg-&gt;<a class="code" href="structobd__llog__group.html#a863c9c98a864d7fe8bf15268aeb969d2">olg_lock</a>);
<a name="l00398"></a>00398         <span class="keywordflow">if</span> (olg-&gt;<a class="code" href="structobd__llog__group.html#a8a3460979f9026c62cdd98e11fcea2b0">olg_ctxts</a>[index] != NULL) {
<a name="l00399"></a>00399                 spin_unlock(&amp;olg-&gt;<a class="code" href="structobd__llog__group.html#a863c9c98a864d7fe8bf15268aeb969d2">olg_lock</a>);
<a name="l00400"></a>00400                 <span class="keywordflow">return</span> -EEXIST;
<a name="l00401"></a>00401         }
<a name="l00402"></a>00402         olg-&gt;<a class="code" href="structobd__llog__group.html#a8a3460979f9026c62cdd98e11fcea2b0">olg_ctxts</a>[index] = ctxt;
<a name="l00403"></a>00403         spin_unlock(&amp;olg-&gt;<a class="code" href="structobd__llog__group.html#a863c9c98a864d7fe8bf15268aeb969d2">olg_lock</a>);
<a name="l00404"></a>00404         <span class="keywordflow">return</span> 0;
<a name="l00405"></a>00405 }
<a name="l00406"></a>00406 
<a name="l00407"></a><a class="code" href="group__log.html#ga9f0d21cd3c68589e57bc3aca3a4c1959">00407</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structllog__ctxt.html">llog_ctxt</a> *<a class="code" href="group__log.html#ga9f0d21cd3c68589e57bc3aca3a4c1959">llog_group_get_ctxt</a>(<span class="keyword">struct</span> <a class="code" href="structobd__llog__group.html">obd_llog_group</a> *olg,
<a name="l00408"></a>00408                                                     <span class="keywordtype">int</span> index)
<a name="l00409"></a>00409 {
<a name="l00410"></a>00410         <span class="keyword">struct </span><a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(index &gt;= 0 &amp;&amp; index &lt; <a class="code" href="group__lustreidl.html#ggaedddc461eb6cbba1f4f39241cabf24f1a8b20f3ec9ea67643038ef255c98d68f3">LLOG_MAX_CTXTS</a>);
<a name="l00413"></a>00413 
<a name="l00414"></a>00414         spin_lock(&amp;olg-&gt;<a class="code" href="structobd__llog__group.html#a863c9c98a864d7fe8bf15268aeb969d2">olg_lock</a>);
<a name="l00415"></a>00415         <span class="keywordflow">if</span> (olg-&gt;<a class="code" href="structobd__llog__group.html#a8a3460979f9026c62cdd98e11fcea2b0">olg_ctxts</a>[index] == NULL)
<a name="l00416"></a>00416                 ctxt = NULL;
<a name="l00417"></a>00417         <span class="keywordflow">else</span>
<a name="l00418"></a>00418                 ctxt = <a class="code" href="group__log.html#ga5a7a4b2c40454970420123fad5b0f9a9">llog_ctxt_get</a>(olg-&gt;<a class="code" href="structobd__llog__group.html#a8a3460979f9026c62cdd98e11fcea2b0">olg_ctxts</a>[index]);
<a name="l00419"></a>00419         spin_unlock(&amp;olg-&gt;<a class="code" href="structobd__llog__group.html#a863c9c98a864d7fe8bf15268aeb969d2">olg_lock</a>);
<a name="l00420"></a>00420         <span class="keywordflow">return</span> ctxt;
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a><a class="code" href="group__log.html#ga2ea54fa88db209fc4e2fef22cf1860ab">00423</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__log.html#ga2ea54fa88db209fc4e2fef22cf1860ab">llog_group_clear_ctxt</a>(<span class="keyword">struct</span> <a class="code" href="structobd__llog__group.html">obd_llog_group</a> *olg, <span class="keywordtype">int</span> index)
<a name="l00424"></a>00424 {
<a name="l00425"></a>00425         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(index &gt;= 0 &amp;&amp; index &lt; <a class="code" href="group__lustreidl.html#ggaedddc461eb6cbba1f4f39241cabf24f1a8b20f3ec9ea67643038ef255c98d68f3">LLOG_MAX_CTXTS</a>);
<a name="l00426"></a>00426         spin_lock(&amp;olg-&gt;<a class="code" href="structobd__llog__group.html#a863c9c98a864d7fe8bf15268aeb969d2">olg_lock</a>);
<a name="l00427"></a>00427         olg-&gt;<a class="code" href="structobd__llog__group.html#a8a3460979f9026c62cdd98e11fcea2b0">olg_ctxts</a>[index] = NULL;
<a name="l00428"></a>00428         spin_unlock(&amp;olg-&gt;<a class="code" href="structobd__llog__group.html#a863c9c98a864d7fe8bf15268aeb969d2">olg_lock</a>);
<a name="l00429"></a>00429 }
<a name="l00430"></a>00430 
<a name="l00431"></a><a class="code" href="group__log.html#ga3cc62169ef1388794fdb682e1cb5f35e">00431</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structllog__ctxt.html">llog_ctxt</a> *<a class="code" href="group__log.html#ga3cc62169ef1388794fdb682e1cb5f35e">llog_get_context</a>(<span class="keyword">struct</span> <a class="code" href="structobd__device.html">obd_device</a> *obd,
<a name="l00432"></a>00432                                                  <span class="keywordtype">int</span> index)
<a name="l00433"></a>00433 {
<a name="l00434"></a>00434         <span class="keywordflow">return</span> <a class="code" href="group__log.html#ga9f0d21cd3c68589e57bc3aca3a4c1959">llog_group_get_ctxt</a>(&amp;obd-&gt;<a class="code" href="structobd__device.html#ad56e6e4fb14d775d5730057c26b2e9d1">obd_olg</a>, index);
<a name="l00435"></a>00435 }
<a name="l00436"></a>00436 
<a name="l00437"></a><a class="code" href="group__log.html#gaf336cd80bd0b187ef463f38701e95abb">00437</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__log.html#gaf336cd80bd0b187ef463f38701e95abb">llog_group_ctxt_null</a>(<span class="keyword">struct</span> <a class="code" href="structobd__llog__group.html">obd_llog_group</a> *olg, <span class="keywordtype">int</span> index)
<a name="l00438"></a>00438 {
<a name="l00439"></a>00439         <span class="keywordflow">return</span> (olg-&gt;<a class="code" href="structobd__llog__group.html#a8a3460979f9026c62cdd98e11fcea2b0">olg_ctxts</a>[index] == NULL);
<a name="l00440"></a>00440 }
<a name="l00441"></a>00441 
<a name="l00442"></a><a class="code" href="group__log.html#ga98f2f6427e3c27f1d1583fd5338cba3f">00442</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga98f2f6427e3c27f1d1583fd5338cba3f">llog_ctxt_null</a>(<span class="keyword">struct</span> <a class="code" href="structobd__device.html">obd_device</a> *obd, <span class="keywordtype">int</span> index)
<a name="l00443"></a>00443 {
<a name="l00444"></a>00444         <span class="keywordflow">return</span> (<a class="code" href="group__log.html#gaf336cd80bd0b187ef463f38701e95abb">llog_group_ctxt_null</a>(&amp;obd-&gt;<a class="code" href="structobd__device.html#ad56e6e4fb14d775d5730057c26b2e9d1">obd_olg</a>, index));
<a name="l00445"></a>00445 }
<a name="l00446"></a>00446 
<a name="l00447"></a><a class="code" href="group__log.html#gac77bab9be9fe12770ee08af0906eb647">00447</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__log.html#gac77bab9be9fe12770ee08af0906eb647">llog_next_block</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00448"></a>00448                                   <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *loghandle, <span class="keywordtype">int</span> *cur_idx,
<a name="l00449"></a>00449                                   <span class="keywordtype">int</span> next_idx, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *cur_offset, <span class="keywordtype">void</span> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l00450"></a>00450                                   <span class="keywordtype">int</span> len)
<a name="l00451"></a>00451 {
<a name="l00452"></a>00452         <span class="keyword">struct </span><a class="code" href="structllog__operations.html">llog_operations</a> *lop;
<a name="l00453"></a>00453         <span class="keywordtype">int</span> rc;
<a name="l00454"></a>00454 
<a name="l00455"></a>00455         <a class="code" href="flock_8c.html#affebc0cf7e41098a8c78a8c2c4586d72">ENTRY</a>;
<a name="l00456"></a>00456 
<a name="l00457"></a>00457         rc = <a class="code" href="group__log.html#ga427b3b7fcb73b3e21891f1b696d05992">llog_handle2ops</a>(loghandle, &amp;lop);
<a name="l00458"></a>00458         <span class="keywordflow">if</span> (rc)
<a name="l00459"></a>00459                 <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(rc);
<a name="l00460"></a>00460         <span class="keywordflow">if</span> (lop-&gt;<a class="code" href="structllog__operations.html#ad0ec4a0a2f4dc80122b545f96bfafe19">lop_next_block</a> == NULL)
<a name="l00461"></a>00461                 <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(-EOPNOTSUPP);
<a name="l00462"></a>00462 
<a name="l00463"></a>00463         rc = lop-&gt;<a class="code" href="structllog__operations.html#ad0ec4a0a2f4dc80122b545f96bfafe19">lop_next_block</a>(env, loghandle, cur_idx, next_idx,
<a name="l00464"></a>00464                                  cur_offset, buf, len);
<a name="l00465"></a>00465         <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(rc);
<a name="l00466"></a>00466 }
<a name="l00467"></a>00467 
<a name="l00468"></a><a class="code" href="group__log.html#ga6361c837408fbf640b0f017a5adb9afd">00468</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga6361c837408fbf640b0f017a5adb9afd">llog_prev_block</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00469"></a>00469                                   <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *loghandle,
<a name="l00470"></a>00470                                   <span class="keywordtype">int</span> prev_idx, <span class="keywordtype">void</span> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>, <span class="keywordtype">int</span> len)
<a name="l00471"></a>00471 {
<a name="l00472"></a>00472         <span class="keyword">struct </span><a class="code" href="structllog__operations.html">llog_operations</a> *lop;
<a name="l00473"></a>00473         <span class="keywordtype">int</span> rc;
<a name="l00474"></a>00474 
<a name="l00475"></a>00475         <a class="code" href="flock_8c.html#affebc0cf7e41098a8c78a8c2c4586d72">ENTRY</a>;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477         rc = <a class="code" href="group__log.html#ga427b3b7fcb73b3e21891f1b696d05992">llog_handle2ops</a>(loghandle, &amp;lop);
<a name="l00478"></a>00478         <span class="keywordflow">if</span> (rc)
<a name="l00479"></a>00479                 <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(rc);
<a name="l00480"></a>00480         <span class="keywordflow">if</span> (lop-&gt;<a class="code" href="structllog__operations.html#a2c18ae2dbd35efba4c2ea1189d9b42bf">lop_prev_block</a> == NULL)
<a name="l00481"></a>00481                 <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(-EOPNOTSUPP);
<a name="l00482"></a>00482 
<a name="l00483"></a>00483         rc = lop-&gt;<a class="code" href="structllog__operations.html#a2c18ae2dbd35efba4c2ea1189d9b42bf">lop_prev_block</a>(env, loghandle, prev_idx, buf, len);
<a name="l00484"></a>00484         <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(rc);
<a name="l00485"></a>00485 }
<a name="l00486"></a>00486 
<a name="l00487"></a><a class="code" href="group__log.html#gaff446f4f40cf22c8f7824e97949b3bbf">00487</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__log.html#gaff446f4f40cf22c8f7824e97949b3bbf">llog_connect</a>(<span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt,
<a name="l00488"></a>00488                                <span class="keyword">struct</span> <a class="code" href="structllog__logid.html" title="Identifier for a single log object.">llog_logid</a> *logid, <span class="keyword">struct</span> <a class="code" href="structllog__gen.html">llog_gen</a> *gen,
<a name="l00489"></a>00489                                <span class="keyword">struct</span> <a class="code" href="structobd__uuid.html">obd_uuid</a> *<a class="code" href="llog__test_8c.html#aaa83f069991aa91e0383af81ef30f13f">uuid</a>)
<a name="l00490"></a>00490 {
<a name="l00491"></a>00491         <span class="keyword">struct </span><a class="code" href="structllog__operations.html">llog_operations</a>  *lop;
<a name="l00492"></a>00492         <span class="keywordtype">int</span>                      rc;
<a name="l00493"></a>00493 
<a name="l00494"></a>00494         <a class="code" href="flock_8c.html#affebc0cf7e41098a8c78a8c2c4586d72">ENTRY</a>;
<a name="l00495"></a>00495 
<a name="l00496"></a>00496         rc = <a class="code" href="group__log.html#ga7f992ede04801280372ff61459941fe5">llog_obd2ops</a>(ctxt, &amp;lop);
<a name="l00497"></a>00497         <span class="keywordflow">if</span> (rc)
<a name="l00498"></a>00498                 <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(rc);
<a name="l00499"></a>00499         <span class="keywordflow">if</span> (lop-&gt;<a class="code" href="structllog__operations.html#a2e71f161d19a63bed0fabc5489b3cff2">lop_connect</a> == NULL)
<a name="l00500"></a>00500                 <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(-EOPNOTSUPP);
<a name="l00501"></a>00501 
<a name="l00502"></a>00502         rc = lop-&gt;<a class="code" href="structllog__operations.html#a2e71f161d19a63bed0fabc5489b3cff2">lop_connect</a>(ctxt, logid, gen, uuid);
<a name="l00503"></a>00503         <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(rc);
<a name="l00504"></a>00504 }
<a name="l00505"></a>00505 
<a name="l00506"></a><a class="code" href="group__log.html#ga5c4343d7efacc22e7fe33fe6597ccf9c">00506</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga5c4343d7efacc22e7fe33fe6597ccf9c">llog_is_full</a>(<span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *llh)
<a name="l00507"></a>00507 {
<a name="l00508"></a>00508         <span class="keywordflow">return</span> llh-&gt;<a class="code" href="structllog__handle.html#a35595d2c187895289c2ced0ee281bbec">lgh_last_idx</a> &gt;= <a class="code" href="group__lustreidl.html#gab2b7cae67de8c1053d1e5bb6d0293092">LLOG_HDR_BITMAP_SIZE</a>(llh-&gt;<a class="code" href="structllog__handle.html#a1e70205e9f7abb9140cfcb37a42611e8">lgh_hdr</a>) - 1;
<a name="l00509"></a>00509 }
<a name="l00510"></a>00510 
<a name="l00511"></a><a class="code" href="structllog__cfg__rec.html">00511</a> <span class="keyword">struct </span><a class="code" href="structllog__cfg__rec.html">llog_cfg_rec</a> {
<a name="l00512"></a><a class="code" href="structllog__cfg__rec.html#a14b3c41837c0a457eddaac44cbaf6b12">00512</a>         <span class="keyword">struct </span><a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a>     <a class="code" href="structllog__cfg__rec.html#a14b3c41837c0a457eddaac44cbaf6b12">lcr_hdr</a>;
<a name="l00513"></a><a class="code" href="structllog__cfg__rec.html#a4c420272f4e91f205bcddf5bea3a967c">00513</a>         <span class="keyword">struct </span><a class="code" href="structlustre__cfg.html">lustre_cfg</a>       <a class="code" href="structllog__cfg__rec.html#a4c420272f4e91f205bcddf5bea3a967c">lcr_cfg</a>;
<a name="l00514"></a><a class="code" href="structllog__cfg__rec.html#a95abaa1069f311c352999989aba93789">00514</a>         <span class="keyword">struct </span><a class="code" href="structllog__rec__tail.html">llog_rec_tail</a>    <a class="code" href="structllog__cfg__rec.html#a95abaa1069f311c352999989aba93789">lcr_tail</a>;
<a name="l00515"></a>00515 };
<a name="l00516"></a>00516 
<a name="l00517"></a>00517 <span class="keyword">struct </span><a class="code" href="structllog__cfg__rec.html">llog_cfg_rec</a> *<a class="code" href="group__log.html#gac148d3e66927a5ca148207c69ba4b8a5">lustre_cfg_rec_new</a>(<span class="keywordtype">int</span> <a class="code" href="mdsrate_8c.html#a7353cae57e2530c316ddacb27ef14932">cmd</a>, <span class="keyword">struct</span> <a class="code" href="structlustre__cfg__bufs.html">lustre_cfg_bufs</a> *bufs);
<a name="l00518"></a>00518 <span class="keywordtype">void</span> <a class="code" href="group__log.html#gadac76f066c96cf4ae43ccbce06593e21">lustre_cfg_rec_free</a>(<span class="keyword">struct</span> <a class="code" href="structllog__cfg__rec.html">llog_cfg_rec</a> *<a class="code" href="llog__test_8c.html#ad055657f9d954e69f4bd5193f01514c5">lcr</a>);
<a name="l00519"></a>00519 
<a name="l00520"></a>00520 <span class="keyword">enum</span> {
<a name="l00521"></a><a class="code" href="group__log.html#gga2f80701c36e79c0640d91c788feee0b3a9e3f5a45a9b1488b2fc203fe85242388">00521</a>         <a class="code" href="group__log.html#gga2f80701c36e79c0640d91c788feee0b3a9e3f5a45a9b1488b2fc203fe85242388">LLOG_NEXT_IDX</a> = -1,
<a name="l00522"></a><a class="code" href="group__log.html#gga2f80701c36e79c0640d91c788feee0b3a9a7ce7bfa4dc1b552b7eb882c8028d71">00522</a>         <a class="code" href="group__log.html#gga2f80701c36e79c0640d91c788feee0b3a9a7ce7bfa4dc1b552b7eb882c8028d71">LLOG_HEADER_IDX</a> = 0,
<a name="l00523"></a>00523 };
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 <span class="comment">/* llog.c */</span>
<a name="l00526"></a>00526 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gab4498d20e447d4dbeaff34eb3b305d57" title="new llog API">llog_exist</a>(<span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *loghandle);
<a name="l00527"></a>00527 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga4f29ac09d8ce9183650aa713038b2c92">llog_declare_create</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00528"></a>00528                         <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *loghandle, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00529"></a>00529 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gad1dcf7f6a3d54acd725f99455d849ca8">llog_create</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *handle,
<a name="l00530"></a>00530                 <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00531"></a>00531 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gadac4383f18bef43704ff9b2403398263">llog_trans_destroy</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *handle,
<a name="l00532"></a>00532                        <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00533"></a>00533 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga5fbc4e5a4154513556d4dedc7d23e486">llog_destroy</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *handle);
<a name="l00534"></a>00534 
<a name="l00535"></a>00535 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga1db1cffd9f210c9f081370af6106a606">llog_declare_write_rec</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00536"></a>00536                            <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *handle,
<a name="l00537"></a>00537                            <span class="keyword">struct</span> <a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec, <span class="keywordtype">int</span> idx,
<a name="l00538"></a>00538                            <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00539"></a>00539 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga38790001c86a4ad331c76a6e8698b6e9">llog_write_rec</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *handle,
<a name="l00540"></a>00540                    <span class="keyword">struct</span> <a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec, <span class="keyword">struct</span> <a class="code" href="structllog__cookie.html" title="log cookies are used to reference a specific log file and a record therein">llog_cookie</a> *logcookies,
<a name="l00541"></a>00541                    <span class="keywordtype">int</span> idx, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00542"></a>00542 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gace38c6753f06b86177bebbe0121fde90">llog_add</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *lgh,
<a name="l00543"></a>00543              <span class="keyword">struct</span> <a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec, <span class="keyword">struct</span> <a class="code" href="structllog__cookie.html" title="log cookies are used to reference a specific log file and a record therein">llog_cookie</a> *logcookies,
<a name="l00544"></a>00544              <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00545"></a>00545 <span class="keywordtype">int</span> <a class="code" href="group__log.html#ga682d7fd8bcbf72f370ee2aab71eadfa9">llog_declare_add</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *lgh,
<a name="l00546"></a>00546                      <span class="keyword">struct</span> <a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00547"></a>00547 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gab379f30f30f88aebf9be8c61b7f55152" title="Get a config log from the MGS and process it.">lustre_process_log</a>(<span class="keyword">struct</span> super_block *sb, <span class="keywordtype">char</span> *logname,
<a name="l00548"></a>00548                        <span class="keyword">struct</span> <a class="code" href="structconfig__llog__instance.html">config_llog_instance</a> *cfg);
<a name="l00549"></a>00549 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gae876fd8eccc7582b545d5e187e5b3e92">lustre_end_log</a>(<span class="keyword">struct</span> super_block *sb, <span class="keywordtype">char</span> *logname,
<a name="l00550"></a>00550                    <span class="keyword">struct</span> <a class="code" href="structconfig__llog__instance.html">config_llog_instance</a> *cfg);
<a name="l00551"></a>00551 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gae96db4e0338a67db6a75218a14d22b4f" title="Helper function to open llog or create it if doesn&amp;#39;t exist.">llog_open_create</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt,
<a name="l00552"></a>00552                      <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> **res, <span class="keyword">struct</span> <a class="code" href="structllog__logid.html" title="Identifier for a single log object.">llog_logid</a> *logid,
<a name="l00553"></a>00553                      <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00554"></a>00554 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gaf5171710a6a625218951e36e3c7d3e01" title="Helper function to delete existent llog.">llog_erase</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__ctxt.html">llog_ctxt</a> *ctxt,
<a name="l00555"></a>00555                <span class="keyword">struct</span> <a class="code" href="structllog__logid.html" title="Identifier for a single log object.">llog_logid</a> *logid, <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00556"></a>00556 <span class="keywordtype">int</span> <a class="code" href="group__log.html#gad1dd01ae4a118379d446d5afcbb261fa">llog_write</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structllog__handle.html">llog_handle</a> *loghandle,
<a name="l00557"></a>00557                <span class="keyword">struct</span> <a class="code" href="structllog__rec__hdr.html" title="Log record header - stored in little endian order.">llog_rec_hdr</a> *rec, <span class="keywordtype">int</span> idx);
<a name="l00558"></a>00558 
<a name="l00561"></a>00561 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:35 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
