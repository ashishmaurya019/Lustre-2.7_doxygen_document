<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/mdt/mdt_reint.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/mdt/mdt_reint.c File Reference</h1><code>#include &lt;<a class="el" href="lprocfs__status_8h_source.html">lprocfs_status.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="mdt__internal_8h_source.html">mdt_internal.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="lustre__lmv_8h_source.html">lustre_lmv.h</a>&gt;</code><br/>

<p><a href="mdt__reint_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmdt__lock__list.html">mdt_lock_list</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmdt__reinter.html">mdt_reinter</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>&nbsp;&nbsp;&nbsp;S_MDS</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a890a2935986a670adc3ae5871aa4e9b7">mdt_reint_init_ma</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmd__attr.html">md_attr</a> *ma)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a0a1bf406d3622631fca3dbf0e4d872fd">mdt_obj_version_get</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__object.html">mdt_object</a> *o, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *<a class="el" href="mount__lustre_8c.html#aad880fc4455c253781e8968f2239d56f">version</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get version of object by fid.  <a href="#a0a1bf406d3622631fca3dbf0e4d872fd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#afe03c72b6a4f17d63aacbae36eb3072c">mdt_version_check</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="el" href="mount__lustre_8c.html#aad880fc4455c253781e8968f2239d56f">version</a>, int idx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check version is correct.  <a href="#afe03c72b6a4f17d63aacbae36eb3072c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a226f445d21d5bf08977dfc8cac94d97c">mdt_version_save</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="el" href="mount__lustre_8c.html#aad880fc4455c253781e8968f2239d56f">version</a>, int idx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Save pre-versions in reply.  <a href="#a226f445d21d5bf08977dfc8cac94d97c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#ac25fa545265f38ab0bfeeeb96dcc5696">mdt_enoent_version_save</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, int idx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Save enoent version, it is needed when it is obvious that object doesn't exist, e.g.  <a href="#ac25fa545265f38ab0bfeeeb96dcc5696"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a7e5bd5fc9b3b64f3168d16dc748a6c26">mdt_version_get_save</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__object.html">mdt_object</a> *mto, int idx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get version from disk and save in reply buffer.  <a href="#a7e5bd5fc9b3b64f3168d16dc748a6c26"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a91e41b2d147c1b71106ba66c909c2bc9">mdt_version_get_check</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__object.html">mdt_object</a> *mto, int idx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get version from disk and check it, no save in reply.  <a href="#a91e41b2d147c1b71106ba66c909c2bc9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#ad7d34c46ecb88c4672d8e054ab836f4d">mdt_version_get_check_save</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__object.html">mdt_object</a> *mto, int idx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get version from disk and check if recovery or just save.  <a href="#ad7d34c46ecb88c4672d8e054ab836f4d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#aabd4aaa38b782d513547ae51a346bb25">mdt_lookup_version_check</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__object.html">mdt_object</a> *p, const struct <a class="el" href="structlu__name.html">lu_name</a> *lname, struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, int idx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Lookup with version checking.  <a href="#aabd4aaa38b782d513547ae51a346bb25"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a6f5c9ccdf7d8de126dd055ae59122b49">mdt_remote_permission_check</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a8280e7ea9f38fbcd79b77d6b37ed6cfe">mdt_remote_permission</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">mdt_remote_permission: Check whether the remote operation is permitted,  <a href="#a8280e7ea9f38fbcd79b77d6b37ed6cfe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a43ca4d9336aaf502a41908a613e3d913">mdt_unlock_slaves</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *mti, struct <a class="el" href="structmdt__object.html">mdt_object</a> *obj, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> ibits, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *s0_lh, struct <a class="el" href="structmdt__object.html">mdt_object</a> *s0_obj, struct <a class="el" href="structldlm__enqueue__info.html">ldlm_enqueue_info</a> *einfo, int decref)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a018cab90db0d11d58b4aaff7fd31f5d0">mdt_init_slaves</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *mti, struct <a class="el" href="structmdt__object.html">mdt_object</a> *obj, struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a2df32552c3a6167cdc2adbe2b9d0e150">mdt_lock_slaves</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *mti, struct <a class="el" href="structmdt__object.html">mdt_object</a> *obj, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> ibits, struct <a class="el" href="structlu__fid.html">lu_fid</a> *s0_fid, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *s0_lh, struct <a class="el" href="structmdt__object.html">mdt_object</a> **s0_objp, struct <a class="el" href="structldlm__enqueue__info.html">ldlm_enqueue_info</a> *einfo)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Lock slave stripes if necessary, the lock handles of slave stripes will be stored in einfo-&gt;ei_cbdata.  <a href="#a2df32552c3a6167cdc2adbe2b9d0e150"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#ad386c52f6b122c53bd18e442af530d9e">mdt_md_create</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a740292636af1964d3b01272e4088261f">mdt_attr_set</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__object.html">mdt_object</a> *mo, struct <a class="el" href="structmd__attr.html">md_attr</a> *ma)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#aa826d89f4788c4be92889ce7a6de2973">mdt_add_dirty_flag</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__object.html">mdt_object</a> *mo, struct <a class="el" href="structmd__attr.html">md_attr</a> *ma)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check HSM flags and add HS_DIRTY flag if relevant.  <a href="#aa826d89f4788c4be92889ce7a6de2973"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a2c46df2dd5227b971a5de380778ddbfd">mdt_reint_setattr</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *lhc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a34277249dcc51aa787015b1a9ce18c1d">mdt_reint_create</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *lhc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a350a77e2484064c0dbf4c55d6e95d36b">mdt_reint_unlink</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *lhc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a95975d21ba86e14bc6f70e912fc6ef5c">mdt_reint_link</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *lhc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#ae75122dd0246e65b05cdcefd84866545">mdt_pdir_hash_lock</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *lh, struct <a class="el" href="structmdt__object.html">mdt_object</a> *obj, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> ibits, bool cos_incompat)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">lock the part of the directory according to the hash of the name (lh-&gt;mlh_pdo_hash) in parallel directory lock.  <a href="#ae75122dd0246e65b05cdcefd84866545"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#afdbc826fe633955420a23a36857494ba">mdt_rename_lock</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *lh)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get BFL lock for rename or migrate process.  <a href="#afdbc826fe633955420a23a36857494ba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a34f59835afd6ba371f77893b1df9d979">mdt_rename_unlock</a> (struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *lh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#af08da1e5a889c25fcb31946a86c91407">mdt_is_subdir</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__object.html">mdt_object</a> *<a class="el" href="mdsrate_8c.html#a929b6cee0a8e867ee7380bf26947cef2">dir</a>, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a2201c041c570c32904f3de197600a55f">mdt_unlock_list</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structlist__head.html">list_head</a> *<a class="el" href="lnetctl_8c.html#ac75dee5cf9c8f0128e744b7d95db6767">list</a>, int rc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a644b49559120455a651ebfb0795bef94">mdt_lock_objects_in_linkea</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__object.html">mdt_object</a> *obj, struct <a class="el" href="structmdt__object.html">mdt_object</a> *pobj, struct <a class="el" href="structlist__head.html">list_head</a> *lock_list)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a55df5ffcd82ac56791e2ae952bd3322e">mdt_reint_migrate_internal</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *lhc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a6df1fae44d838c0f6dbede8d99405bd6">mdt_object_find_check</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, int idx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a5e448b7e4f88a5b66c7fb75d3e35d080">mdt_object_lock_save</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__object.html">mdt_object</a> *<a class="el" href="mdsrate_8c.html#a929b6cee0a8e867ee7380bf26947cef2">dir</a>, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *lh, int idx, bool cos_incompat)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#ae590e7b6e38f3bac80dd6c242d65e783">mdt_reint_rename_internal</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *lhc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For DNE phase I, only these renames are allowed mv src_p/src_c tgt_p/tgt_c 1.  <a href="#ae590e7b6e38f3bac80dd6c242d65e783"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#aa7c86ef4bf93ff1cab90fcd563c85c26">mdt_reint_rename_or_migrate</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *lhc, bool rename)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a54aab0fe39593a99787adb4273e9a56c">mdt_reint_rename</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *lhc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a71f38f8d8f8a55cbc394ef74fefe6e0c">mdt_reint_migrate</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *lhc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#ad9f4c4a1103c5c8232e0ac635589e62b">mdt_reint_rec</a> (struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *info, struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *lhc)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structmdt__reinter.html">mdt_reinter</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdt__reint_8c.html#a953d17879ea46d70b0b2d003fa712f71">mdt_reinters</a> []</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="abda60744d497fcfe370cfd6b2d65c7ed"></a><!-- doxytag: member="mdt_reint.c::DEBUG_SUBSYSTEM" ref="abda60744d497fcfe370cfd6b2d65c7ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_SUBSYSTEM&nbsp;&nbsp;&nbsp;S_MDS</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00047">47</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa826d89f4788c4be92889ce7a6de2973"></a><!-- doxytag: member="mdt_reint.c::mdt_add_dirty_flag" ref="aa826d89f4788c4be92889ce7a6de2973" args="(struct mdt_thread_info *info, struct mdt_object *mo, struct md_attr *ma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mdt_add_dirty_flag </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>mo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmd__attr.html">md_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>ma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check HSM flags and add HS_DIRTY flag if relevant. </p>
<p>A file could be set dirty only if it has a copy in the backend (HS_EXISTS) and is not RELEASED. </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00678">678</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__user_8h_source.html#l01046">HS_DIRTY</a>, <a class="el" href="lustre__user_8h_source.html#l01045">HS_EXISTS</a>, <a class="el" href="lustre__user_8h_source.html#l01047">HS_RELEASED</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="md__object_8h_source.html#l00121">md_attr::ma_hsm</a>, <a class="el" href="md__object_8h_source.html#l00078">MA_HSM</a>, <a class="el" href="md__object_8h_source.html#l00117">md_attr::ma_need</a>, <a class="el" href="md__object_8h_source.html#l00116">md_attr::ma_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l02093">MDS_INODELOCK_XATTR</a>, <a class="el" href="mdt__handler_8c_source.html#l00819">mdt_attr_get_complex()</a>, <a class="el" href="mdt__hsm_8c_source.html#l00058">mdt_hsm_attr_set()</a>, <a class="el" href="mdt__internal_8h_source.html#l00270">MDT_LH_CHILD</a>, <a class="el" href="mdt__handler_8c_source.html#l00163">mdt_lock_reg_init()</a>, <a class="el" href="mdt__internal_8h_source.html#l00543">mdt_object_fid()</a>, <a class="el" href="mdt__handler_8c_source.html#l02619">mdt_object_lock()</a>, <a class="el" href="mdt__handler_8c_source.html#l02771">mdt_object_unlock()</a>, <a class="el" href="md__object_8h_source.html#l00110">md_hsm::mh_flags</a>, <a class="el" href="mdt__internal_8h_source.html#l00328">mdt_thread_info::mti_lh</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="mdt__handler_8c_source.html#l05106">mdt_ctxt_add_dirty_flag()</a>, <a class="el" href="mdt__open_8c_source.html#l01939">mdt_mfd_close()</a>, and <a class="el" href="mdt__reint_8c_source.html#l00715">mdt_reint_setattr()</a>.</p>

</div>
</div>
<a class="anchor" id="a740292636af1964d3b01272e4088261f"></a><!-- doxytag: member="mdt_reint.c::mdt_attr_set" ref="a740292636af1964d3b01272e4088261f" args="(struct mdt_thread_info *info, struct mdt_object *mo, struct md_attr *ma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_attr_set </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>mo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmd__attr.html">md_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>ma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00596">596</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00446">LA_CTIME</a>, <a class="el" href="lu__object_8h_source.html#l00453">LA_FLAGS</a>, <a class="el" href="lu__object_8h_source.html#l00450">LA_GID</a>, <a class="el" href="lu__object_8h_source.html#l00448">LA_MODE</a>, <a class="el" href="lu__object_8h_source.html#l00449">LA_UID</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="md__object_8h_source.html#l00119">md_attr::ma_attr</a>, <a class="el" href="md__object_8h_source.html#l00118">md_attr::ma_attr_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l02076">MDS_INODELOCK_LOOKUP</a>, <a class="el" href="lustre__idl_8h_source.html#l02092">MDS_INODELOCK_PERM</a>, <a class="el" href="lustre__idl_8h_source.html#l02079">MDS_INODELOCK_UPDATE</a>, <a class="el" href="lustre__idl_8h_source.html#l02360">MDS_VTX_BYPASS</a>, <a class="el" href="mdt__internal_8h_source.html#l00168">mdt_device::mdt_bottom</a>, <a class="el" href="mdt__internal_8h_source.html#l00896">mdt_fail_write()</a>, <a class="el" href="mdt__reint_8c_source.html#l00336">mdt_init_slaves()</a>, <a class="el" href="mdt__internal_8h_source.html#l00275">MDT_LH_LOCAL</a>, <a class="el" href="mdt__internal_8h_source.html#l00269">MDT_LH_PARENT</a>, <a class="el" href="mdt__handler_8c_source.html#l00163">mdt_lock_reg_init()</a>, <a class="el" href="mdt__reint_8c_source.html#l00378">mdt_lock_slaves()</a>, <a class="el" href="mdt__internal_8h_source.html#l00760">mdt_obj2dt()</a>, <a class="el" href="mdt__internal_8h_source.html#l00500">mdt_object_child()</a>, <a class="el" href="mdt__handler_8c_source.html#l02771">mdt_object_unlock()</a>, <a class="el" href="mdt__handler_8c_source.html#l02625">mdt_reint_object_lock()</a>, <a class="el" href="mdt__reint_8c_source.html#l00295">mdt_unlock_slaves()</a>, <a class="el" href="mdt__reint_8c_source.html#l00176">mdt_version_get_check_save()</a>, <a class="el" href="md__object_8h_source.html#l00362">mo_attr_set()</a>, <a class="el" href="mdt__internal_8h_source.html#l00242">mdt_object::mot_lov_mutex</a>, <a class="el" href="mdt__internal_8h_source.html#l00430">mdt_thread_info::mti_einfo</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00328">mdt_thread_info::mti_lh</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00396">mdt_thread_info::mti_tmp_fid1</a>, <a class="el" href="obd__support_8h_source.html#l00169">OBD_FAIL_MDS_REINT_SETATTR_WRITE</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lu__target_8h_source.html#l00245">tgt_vbr_obj_set()</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00715">mdt_reint_setattr()</a>.</p>

</div>
</div>
<a class="anchor" id="ac25fa545265f38ab0bfeeeb96dcc5696"></a><!-- doxytag: member="mdt_reint.c::mdt_enoent_version_save" ref="ac25fa545265f38ab0bfeeeb96dcc5696" args="(struct mdt_thread_info *info, int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mdt_enoent_version_save </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Save enoent version, it is needed when it is obvious that object doesn't exist, e.g. </p>
<p>child during create. </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00135">135</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="lustre__disk_8h_source.html#l00267">ENOENT_VERSION</a>, <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__reint_8c_source.html#l00116">mdt_version_save()</a>, <a class="el" href="mdt__internal_8h_source.html#l00382">mdt_thread_info::mti_ver</a>, and <a class="el" href="lu__target_8h_source.html#l00345">req_is_replay()</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00436">mdt_md_create()</a>, and <a class="el" href="mdt__reint_8c_source.html#l01833">mdt_reint_rename_internal()</a>.</p>

</div>
</div>
<a class="anchor" id="a018cab90db0d11d58b4aaff7fd31f5d0"></a><!-- doxytag: member="mdt_reint.c::mdt_init_slaves" ref="a018cab90db0d11d58b4aaff7fd31f5d0" args="(struct mdt_thread_info *mti, struct mdt_object *obj, struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_init_slaves </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>mti</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00336">336</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="parallel__grouplock_8c_source.html#l00078">buf</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__idl_8h_source.html#l00772">fid_le_to_cpu()</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="byteorder_8h_source.html#l00056">le32_to_cpu</a>, <a class="el" href="lustre__idl_8h_source.html#l02577">lmv_mds_md_v1::lmv_magic</a>, <a class="el" href="lustre__idl_8h_source.html#l02596">LMV_MAGIC_V1</a>, <a class="el" href="lustre__idl_8h_source.html#l02593">lmv_mds_md_v1::lmv_stripe_fids</a>, <a class="el" href="lu__object_8h_source.html#l00539">lu_object_header::loh_attr</a>, <a class="el" href="mdt__handler_8c_source.html#l00658">mdt_big_xattr_get()</a>, <a class="el" href="mdt__internal_8h_source.html#l00500">mdt_object_child()</a>, <a class="el" href="md__object_8h_source.html#l00370">mo_xattr_get()</a>, <a class="el" href="mdt__internal_8h_source.html#l00236">mdt_object::mot_header</a>, <a class="el" href="mdt__internal_8h_source.html#l00424">mdt_thread_info::mti_big_lmm</a>, <a class="el" href="mdt__internal_8h_source.html#l00425">mdt_thread_info::mti_big_lmmsize</a>, <a class="el" href="mdt__internal_8h_source.html#l00418">mdt_thread_info::mti_buf</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00429">mdt_thread_info::mti_xattr_buf</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="lustre__idl_8h_source.html#l01596">XATTR_NAME_LMV</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00596">mdt_attr_set()</a>, <a class="el" href="mdt__reint_8c_source.html#l00378">mdt_lock_slaves()</a>, <a class="el" href="mdt__reint_8c_source.html#l00436">mdt_md_create()</a>, and <a class="el" href="mdt__reint_8c_source.html#l00871">mdt_reint_unlink()</a>.</p>

</div>
</div>
<a class="anchor" id="af08da1e5a889c25fcb31946a86c91407"></a><!-- doxytag: member="mdt_reint.c::mdt_is_subdir" ref="af08da1e5a889c25fcb31946a86c91407" args="(struct mdt_thread_info *info, struct mdt_object *dir, const struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_is_subdir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l01308">1308</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__object_8h_source.html#l00525">lu_object_header::loh_fid</a>, <a class="el" href="lustre__idl_8h_source.html#l00801">lu_fid_eq()</a>, <a class="el" href="md__object_8h_source.html#l00531">mdo_is_subdir()</a>, <a class="el" href="mdt__internal_8h_source.html#l01048">mdt_obd_name()</a>, <a class="el" href="mdt__internal_8h_source.html#l00500">mdt_object_child()</a>, <a class="el" href="mdt__internal_8h_source.html#l00533">mdt_object_exists()</a>, <a class="el" href="mdt__internal_8h_source.html#l00236">mdt_object::mot_header</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l01833">mdt_reint_rename_internal()</a>.</p>

</div>
</div>
<a class="anchor" id="a644b49559120455a651ebfb0795bef94"></a><!-- doxytag: member="mdt_reint.c::mdt_lock_objects_in_linkea" ref="a644b49559120455a651ebfb0795bef94" args="(struct mdt_thread_info *info, struct mdt_object *obj, struct mdt_object *pobj, struct list_head *lock_list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_lock_objects_in_linkea </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>pobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlist__head.html">list_head</a> *&nbsp;</td>
          <td class="paramname"> <em>lock_list</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l01362">1362</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="parallel__grouplock_8c_source.html#l00078">buf</a>, <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="lustre__linkea_8h_source.html#l00036">linkea_data::ld_buf</a>, <a class="el" href="lustre__linkea_8h_source.html#l00041">linkea_data::ld_lee</a>, <a class="el" href="lustre__linkea_8h_source.html#l00040">linkea_data::ld_leh</a>, <a class="el" href="lustre__linkea_8h_source.html#l00042">linkea_data::ld_reclen</a>, <a class="el" href="lustre__dlm_8h_source.html#l01273">ldlm_handle2lock()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01327">LDLM_LOCK_PUT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00260">ldlm_set_atomic_cb</a>, <a class="el" href="lustre__idl_8h_source.html#l03674">link_ea_header::leh_reccount</a>, <a class="el" href="linkea_8c_source.html#l00097">linkea_entry_unpack()</a>, <a class="el" href="list_8h_source.html#l00090">list_add_tail()</a>, <a class="el" href="list_8h_source.html#l00459">list_for_each_entry</a>, <a class="el" href="lu__object_8h_source.html#l01297">lu_name::ln_name</a>, <a class="el" href="l__lock_8c_source.html#l00051">lock_res_and_lock()</a>, <a class="el" href="lu__object_8c_source.html#l02369">lu_buf_check_and_alloc()</a>, <a class="el" href="lu__object_8h_source.html#l00860">lu_object_attr()</a>, <a class="el" href="lustre__idl_8h_source.html#l02079">MDS_INODELOCK_UPDATE</a>, <a class="el" href="mdt__handler_8c_source.html#l05420">mdt_links_read()</a>, <a class="el" href="mdt__handler_8c_source.html#l00171">mdt_lock_pdo_init()</a>, <a class="el" href="mdt__internal_8h_source.html#l01048">mdt_obd_name()</a>, <a class="el" href="mdt__internal_8h_source.html#l00533">mdt_object_exists()</a>, <a class="el" href="mdt__handler_8c_source.html#l02224">mdt_object_find()</a>, <a class="el" href="mdt__handler_8c_source.html#l02619">mdt_object_lock()</a>, <a class="el" href="mdt__internal_8h_source.html#l00525">mdt_object_put()</a>, <a class="el" href="mdt__internal_8h_source.html#l00538">mdt_object_remote()</a>, <a class="el" href="mdt__handler_8c_source.html#l02803">mdt_object_unlock_put()</a>, <a class="el" href="mdt__handler_8c_source.html#l02647">mdt_reint_object_lock_try()</a>, <a class="el" href="mdt__reint_8c_source.html#l01349">mdt_unlock_list()</a>, <a class="el" href="mdt__internal_8h_source.html#l00264">mdt_lock_handle::mlh_rreg_lh</a>, <a class="el" href="mdt__reint_8c_source.html#l01345">mdt_lock_list::mll_lh</a>, <a class="el" href="mdt__reint_8c_source.html#l01346">mdt_lock_list::mll_list</a>, <a class="el" href="mdt__reint_8c_source.html#l01344">mdt_lock_list::mll_obj</a>, <a class="el" href="mdt__internal_8h_source.html#l00237">mdt_object::mot_obj</a>, <a class="el" href="mdt__internal_8h_source.html#l00419">mdt_thread_info::mti_big_buf</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="o2iblnd__modparams_8c_source.html#l00091">retry_count</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="l__lock_8c_source.html#l00067">unlock_res_and_lock()</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l01503">mdt_reint_migrate_internal()</a>.</p>

</div>
</div>
<a class="anchor" id="a2df32552c3a6167cdc2adbe2b9d0e150"></a><!-- doxytag: member="mdt_reint.c::mdt_lock_slaves" ref="a2df32552c3a6167cdc2adbe2b9d0e150" args="(struct mdt_thread_info *mti, struct mdt_object *obj, enum ldlm_mode mode, __u64 ibits, struct lu_fid *s0_fid, struct mdt_lock_handle *s0_lh, struct mdt_object **s0_objp, struct ldlm_enqueue_info *einfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_lock_slaves </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>mti</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>ibits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>s0_fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>s0_lh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> **&nbsp;</td>
          <td class="paramname"> <em>s0_objp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__enqueue__info.html">ldlm_enqueue_info</a> *&nbsp;</td>
          <td class="paramname"> <em>einfo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Lock slave stripes if necessary, the lock handles of slave stripes will be stored in einfo-&gt;ei_cbdata. </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00378">378</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l02841">ldlm_inodebits::bits</a>, <a class="el" href="lustre__dlm_8h_source.html#l01099">ldlm_enqueue_info::ei_cb_bl</a>, <a class="el" href="lustre__dlm_8h_source.html#l01101">ldlm_enqueue_info::ei_cb_cp</a>, <a class="el" href="lustre__dlm_8h_source.html#l01100">ldlm_enqueue_info::ei_cb_local_bl</a>, <a class="el" href="lustre__dlm_8h_source.html#l01105">ldlm_enqueue_info::ei_enq_slave</a>, <a class="el" href="lustre__dlm_8h_source.html#l01098">ldlm_enqueue_info::ei_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l01104">ldlm_enqueue_info::ei_namespace</a>, <a class="el" href="lustre__dlm_8h_source.html#l01097">ldlm_enqueue_info::ei_type</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__dlm_8h_source.html#l00635">ldlm_policy_data::l_inodebits</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="ldlm__request_8c_source.html#l00230">ldlm_completion_ast()</a>, <a class="el" href="packet-lustre_8c_source.html#l00301">LDLM_IBITS</a>, <a class="el" href="lu__object_8h_source.html#l00539">lu_object_header::loh_attr</a>, <a class="el" href="lustre__idl_8h_source.html#l00801">lu_fid_eq()</a>, <a class="el" href="mdt__handler_8c_source.html#l02308">mdt_blocking_ast()</a>, <a class="el" href="mdt__reint_8c_source.html#l00336">mdt_init_slaves()</a>, <a class="el" href="mdt__internal_8h_source.html#l00162">mdt_device::mdt_namespace</a>, <a class="el" href="mdt__internal_8h_source.html#l00500">mdt_object_child()</a>, <a class="el" href="mdt__internal_8h_source.html#l00543">mdt_object_fid()</a>, <a class="el" href="mdt__handler_8c_source.html#l02224">mdt_object_find()</a>, <a class="el" href="mdt__internal_8h_source.html#l00525">mdt_object_put()</a>, <a class="el" href="mdt__handler_8c_source.html#l02625">mdt_reint_object_lock()</a>, <a class="el" href="mdt__handler_8c_source.html#l02366">mdt_remote_blocking_ast()</a>, <a class="el" href="md__object_8h_source.html#l00447">mo_object_lock()</a>, <a class="el" href="mdt__internal_8h_source.html#l00236">mdt_object::mot_header</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00398">mdt_thread_info::mti_policy</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00596">mdt_attr_set()</a>, <a class="el" href="mdt__reint_8c_source.html#l00436">mdt_md_create()</a>, and <a class="el" href="mdt__reint_8c_source.html#l00871">mdt_reint_unlink()</a>.</p>

</div>
</div>
<a class="anchor" id="aabd4aaa38b782d513547ae51a346bb25"></a><!-- doxytag: member="mdt_reint.c::mdt_lookup_version_check" ref="aabd4aaa38b782d513547ae51a346bb25" args="(struct mdt_thread_info *info, struct mdt_object *p, const struct lu_name *lname, struct lu_fid *fid, int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_lookup_version_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__name.html">lu_name</a> *&nbsp;</td>
          <td class="paramname"> <em>lname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Lookup with version checking. </p>
<p>This checks version of 'name'. Many reint functions uses 'name' for child not FID, therefore we need to get object by name and check its version. </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00196">196</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="lustre__disk_8h_source.html#l00267">ENOENT_VERSION</a>, <a class="el" href="libcfs__private_8h_source.html#l00309">likely</a>, <a class="el" href="md__object_8h_source.html#l00466">mdo_lookup()</a>, <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__reint_8c_source.html#l00065">mdt_obj_version_get()</a>, <a class="el" href="mdt__internal_8h_source.html#l00500">mdt_object_child()</a>, <a class="el" href="mdt__handler_8c_source.html#l02224">mdt_object_find()</a>, <a class="el" href="mdt__internal_8h_source.html#l00525">mdt_object_put()</a>, <a class="el" href="mdt__reint_8c_source.html#l00083">mdt_version_check()</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00386">mdt_thread_info::mti_spec</a>, <a class="el" href="mdt__internal_8h_source.html#l00382">mdt_thread_info::mti_ver</a>, and <a class="el" href="lu__target_8h_source.html#l00345">req_is_replay()</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00436">mdt_md_create()</a>, <a class="el" href="mdt__reint_8c_source.html#l01098">mdt_reint_link()</a>, <a class="el" href="mdt__reint_8c_source.html#l01503">mdt_reint_migrate_internal()</a>, <a class="el" href="mdt__reint_8c_source.html#l01833">mdt_reint_rename_internal()</a>, and <a class="el" href="mdt__reint_8c_source.html#l00871">mdt_reint_unlink()</a>.</p>

</div>
</div>
<a class="anchor" id="ad386c52f6b122c53bd18e442af530d9e"></a><!-- doxytag: member="mdt_reint.c::mdt_md_create" ref="ad386c52f6b122c53bd18e442af530d9e" args="(struct mdt_thread_info *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_md_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00436">436</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__net_8h_source.html#l01302">DEBUG_REQ</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="lu__object_8h_source.html#l01325">DNAME</a>, <a class="el" href="dt__object_8c_source.html#l00575">dt_directory_features</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__fid_8h_source.html#l00331">fid_is_md_operative()</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00419">lu_attr::la_mode</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="md__object_8h_source.html#l00119">md_attr::ma_attr</a>, <a class="el" href="md__object_8h_source.html#l00072">MA_INODE</a>, <a class="el" href="md__object_8h_source.html#l00117">md_attr::ma_need</a>, <a class="el" href="md__object_8h_source.html#l00116">md_attr::ma_valid</a>, <a class="el" href="md__object_8h_source.html#l00485">mdo_create()</a>, <a class="el" href="lustre__idl_8h_source.html#l02079">MDS_INODELOCK_UPDATE</a>, <a class="el" href="mdt__handler_8c_source.html#l00819">mdt_attr_get_complex()</a>, <a class="el" href="mdt__internal_8h_source.html#l00168">mdt_device::mdt_bottom</a>, <a class="el" href="mdt__internal_8h_source.html#l00990">mdt_dlm_mode2mdl_mode()</a>, <a class="el" href="mdt__reint_8c_source.html#l00135">mdt_enoent_version_save()</a>, <a class="el" href="mdt__internal_8h_source.html#l00896">mdt_fail_write()</a>, <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__reint_8c_source.html#l00336">mdt_init_slaves()</a>, <a class="el" href="mdt__internal_8h_source.html#l00270">MDT_LH_CHILD</a>, <a class="el" href="mdt__internal_8h_source.html#l00275">MDT_LH_LOCAL</a>, <a class="el" href="mdt__internal_8h_source.html#l00269">MDT_LH_PARENT</a>, <a class="el" href="mdt__handler_8c_source.html#l02888">mdt_lock_handle_init()</a>, <a class="el" href="mdt__handler_8c_source.html#l00171">mdt_lock_pdo_init()</a>, <a class="el" href="mdt__handler_8c_source.html#l00163">mdt_lock_reg_init()</a>, <a class="el" href="mdt__reint_8c_source.html#l00378">mdt_lock_slaves()</a>, <a class="el" href="mdt__reint_8c_source.html#l00196">mdt_lookup_version_check()</a>, <a class="el" href="mdt__internal_8h_source.html#l00760">mdt_obj2dt()</a>, <a class="el" href="mdt__internal_8h_source.html#l00500">mdt_object_child()</a>, <a class="el" href="mdt__internal_8h_source.html#l00533">mdt_object_exists()</a>, <a class="el" href="mdt__internal_8h_source.html#l00543">mdt_object_fid()</a>, <a class="el" href="mdt__handler_8c_source.html#l02224">mdt_object_find()</a>, <a class="el" href="mdt__handler_8c_source.html#l02619">mdt_object_lock()</a>, <a class="el" href="mdt__handler_8c_source.html#l02206">mdt_object_new()</a>, <a class="el" href="mdt__internal_8h_source.html#l00525">mdt_object_put()</a>, <a class="el" href="mdt__internal_8h_source.html#l00538">mdt_object_remote()</a>, <a class="el" href="mdt__handler_8c_source.html#l02771">mdt_object_unlock()</a>, <a class="el" href="mdt__handler_8c_source.html#l00501">mdt_pack_attr2body()</a>, <a class="el" href="mdt__handler_8c_source.html#l02625">mdt_reint_object_lock()</a>, <a class="el" href="mdt__reint_8c_source.html#l00250">mdt_remote_permission()</a>, <a class="el" href="mdt__internal_8h_source.html#l00982">mdt_slc_is_enabled()</a>, <a class="el" href="mdt__reint_8c_source.html#l00295">mdt_unlock_slaves()</a>, <a class="el" href="mdt__reint_8c_source.html#l00176">mdt_version_get_check_save()</a>, <a class="el" href="mdt__internal_8h_source.html#l00260">mdt_lock_handle::mlh_pdo_mode</a>, <a class="el" href="mdt__internal_8h_source.html#l00347">mdt_thread_info::mti_attr</a>, <a class="el" href="mdt__internal_8h_source.html#l00430">mdt_thread_info::mti_einfo</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00328">mdt_thread_info::mti_lh</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00320">mdt_thread_info::mti_pill</a>, <a class="el" href="mdt__internal_8h_source.html#l00380">mdt_thread_info::mti_rr</a>, <a class="el" href="mdt__internal_8h_source.html#l00386">mdt_thread_info::mti_spec</a>, <a class="el" href="mdt__internal_8h_source.html#l00396">mdt_thread_info::mti_tmp_fid1</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00564">OBD_FAIL_LFSCK_BAD_SLAVE_NAME</a>, <a class="el" href="obd__support_8h_source.html#l00171">OBD_FAIL_MDS_REINT_CREATE_WRITE</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="lu__object_8h_source.html#l01326">PNAME</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l00938">RMF_MDT_BODY</a>, <a class="el" href="mdt__internal_8h_source.html#l00294">mdt_reint_record::rr_fid1</a>, <a class="el" href="mdt__internal_8h_source.html#l00295">mdt_reint_record::rr_fid2</a>, <a class="el" href="mdt__internal_8h_source.html#l00296">mdt_reint_record::rr_name</a>, <a class="el" href="md__object_8h_source.html#l00146">md_op_spec::sp_cr_lookup</a>, <a class="el" href="md__object_8h_source.html#l00152">md_op_spec::sp_cr_mode</a>, <a class="el" href="md__object_8h_source.html#l00155">md_op_spec::sp_feat</a>, <a class="el" href="lu__target_8h_source.html#l00245">tgt_vbr_obj_set()</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00826">mdt_reint_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a0a1bf406d3622631fca3dbf0e4d872fd"></a><!-- doxytag: member="mdt_reint.c::mdt_obj_version_get" ref="a0a1bf406d3622631fca3dbf0e4d872fd" args="(struct mdt_thread_info *info, struct mdt_object *o, __u64 *version)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mdt_obj_version_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *&nbsp;</td>
          <td class="paramname"> <em>version</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get version of object by fid. </p>
<p>Return real version or ENOENT_VERSION if object doesn't exist </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00065">65</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="dt__object_8c_source.html#l00553">dt_version_get()</a>, <a class="el" href="lustre__disk_8h_source.html#l00267">ENOENT_VERSION</a>, <a class="el" href="lustre__fid_8h_source.html#l00271">fid_is_obf()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="mdt__internal_8h_source.html#l00760">mdt_obj2dt()</a>, <a class="el" href="mdt__internal_8h_source.html#l00533">mdt_object_exists()</a>, <a class="el" href="mdt__internal_8h_source.html#l00543">mdt_object_fid()</a>, <a class="el" href="mdt__internal_8h_source.html#l00538">mdt_object_remote()</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, and <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00196">mdt_lookup_version_check()</a>, <a class="el" href="mdt__reint_8c_source.html#l00162">mdt_version_get_check()</a>, <a class="el" href="mdt__reint_8c_source.html#l00176">mdt_version_get_check_save()</a>, and <a class="el" href="mdt__reint_8c_source.html#l00149">mdt_version_get_save()</a>.</p>

</div>
</div>
<a class="anchor" id="a6df1fae44d838c0f6dbede8d99405bd6"></a><!-- doxytag: member="mdt_reint.c::mdt_object_find_check" ref="a6df1fae44d838c0f6dbede8d99405bd6" args="(struct mdt_thread_info *info, const struct lu_fid *fid, int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structmdt__object.html">mdt_object</a>* mdt_object_find_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l01776">1776</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="mmap__sanity_8c_source.html#l00053">dir</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="mdt__handler_8c_source.html#l02224">mdt_object_find()</a>, <a class="el" href="mdt__internal_8h_source.html#l00525">mdt_object_put()</a>, <a class="el" href="mdt__reint_8c_source.html#l00162">mdt_version_get_check()</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l01833">mdt_reint_rename_internal()</a>.</p>

</div>
</div>
<a class="anchor" id="a5e448b7e4f88a5b66c7fb75d3e35d080"></a><!-- doxytag: member="mdt_reint.c::mdt_object_lock_save" ref="a5e448b7e4f88a5b66c7fb75d3e35d080" args="(struct mdt_thread_info *info, struct mdt_object *dir, struct mdt_lock_handle *lh, int idx, bool cos_incompat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_object_lock_save </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>cos_incompat</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l01799">1799</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l02079">MDS_INODELOCK_UPDATE</a>, <a class="el" href="mdt__handler_8c_source.html#l02625">mdt_reint_object_lock()</a>, and <a class="el" href="mdt__reint_8c_source.html#l00149">mdt_version_get_save()</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l01833">mdt_reint_rename_internal()</a>.</p>

</div>
</div>
<a class="anchor" id="ae75122dd0246e65b05cdcefd84866545"></a><!-- doxytag: member="mdt_reint.c::mdt_pdir_hash_lock" ref="ae75122dd0246e65b05cdcefd84866545" args="(struct mdt_thread_info *info, struct mdt_lock_handle *lh, struct mdt_object *obj, __u64 ibits, bool cos_incompat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_pdir_hash_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>ibits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>cos_incompat</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>lock the part of the directory according to the hash of the name (lh-&gt;mlh_pdo_hash) in parallel directory lock. </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l01215">1215</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="lustre__idl_8h_source.html#l02841">ldlm_inodebits::bits</a>, <a class="el" href="lustre__export_8h_source.html#l00175">obd_export::exp_handle</a>, <a class="el" href="lustre__fid_8h_source.html#l00597">fid_build_pdo_res_name()</a>, <a class="el" href="lustre__handles_8h_source.html#l00067">portals_handle::h_cookie</a>, <a class="el" href="lustre__dlm_8h_source.html#l00635">ldlm_policy_data::l_inodebits</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="packet-lustre_8c_source.html#l00291">LCK_EX</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00258">LDLM_FL_ATOMIC_CB</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00136">LDLM_FL_COS_INCOMPAT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00191">LDLM_FL_LOCAL_ONLY</a>, <a class="el" href="mdt__internal_8h_source.html#l00959">mdt_fid_lock()</a>, <a class="el" href="mdt__internal_8h_source.html#l00162">mdt_device::mdt_namespace</a>, <a class="el" href="mdt__internal_8h_source.html#l00543">mdt_object_fid()</a>, <a class="el" href="mdt__internal_8h_source.html#l00261">mdt_lock_handle::mlh_pdo_hash</a>, <a class="el" href="mdt__internal_8h_source.html#l00255">mdt_lock_handle::mlh_reg_lh</a>, <a class="el" href="mdt__internal_8h_source.html#l00256">mdt_lock_handle::mlh_reg_mode</a>, <a class="el" href="mdt__internal_8h_source.html#l00324">mdt_thread_info::mti_exp</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00398">mdt_thread_info::mti_policy</a>, and <a class="el" href="mdt__internal_8h_source.html#l00399">mdt_thread_info::mti_res_id</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l01833">mdt_reint_rename_internal()</a>.</p>

</div>
</div>
<a class="anchor" id="a34277249dcc51aa787015b1a9ce18c1d"></a><!-- doxytag: member="mdt_reint.c::mdt_reint_create" ref="a34277249dcc51aa787015b1a9ce18c1d" args="(struct mdt_thread_info *info, struct mdt_lock_handle *lhc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_reint_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lhc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00826">826</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__target_8h_source.html#l00498">err_serious()</a>, <a class="el" href="lu__object_8h_source.html#l00419">lu_attr::la_mode</a>, <a class="el" href="lustre__import_8h_source.html#l00074">LATF_SKIP</a>, <a class="el" href="mdt__internal_8h_source.html#l01015">LPROC_MDT_MKDIR</a>, <a class="el" href="mdt__internal_8h_source.html#l01012">LPROC_MDT_MKNOD</a>, <a class="el" href="lu__object_8h_source.html#l01320">lu_name_is_valid()</a>, <a class="el" href="md__object_8h_source.html#l00119">md_attr::ma_attr</a>, <a class="el" href="mdt__lproc_8c_source.html#l00929">mdt_counter_incr()</a>, <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__reint_8c_source.html#l00436">mdt_md_create()</a>, <a class="el" href="mdt__internal_8h_source.html#l01048">mdt_obd_name()</a>, <a class="el" href="mdt__internal_8h_source.html#l00347">mdt_thread_info::mti_attr</a>, <a class="el" href="mdt__internal_8h_source.html#l00359">mdt_thread_info::mti_dlm_req</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00380">mdt_thread_info::mti_rr</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00170">OBD_FAIL_MDS_REINT_CREATE</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="mdt__internal_8h_source.html#l00296">mdt_reint_record::rr_name</a>.</p>

</div>
</div>
<a class="anchor" id="a890a2935986a670adc3ae5871aa4e9b7"></a><!-- doxytag: member="mdt_reint.c::mdt_reint_init_ma" ref="a890a2935986a670adc3ae5871aa4e9b7" args="(struct mdt_thread_info *info, struct md_attr *ma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mdt_reint_init_ma </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmd__attr.html">md_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>ma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00053">53</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="md__object_8h_source.html#l00072">MA_INODE</a>, <a class="el" href="md__object_8h_source.html#l00117">md_attr::ma_need</a>, and <a class="el" href="md__object_8h_source.html#l00116">md_attr::ma_valid</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l01503">mdt_reint_migrate_internal()</a>, and <a class="el" href="mdt__reint_8c_source.html#l01833">mdt_reint_rename_internal()</a>.</p>

</div>
</div>
<a class="anchor" id="a95975d21ba86e14bc6f70e912fc6ef5c"></a><!-- doxytag: member="mdt_reint.c::mdt_reint_link" ref="a95975d21ba86e14bc6f70e912fc6ef5c" args="(struct mdt_thread_info *info, struct mdt_lock_handle *lhc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_reint_link </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lhc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>check target version by name during replay </p>
</p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l01098">1098</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__net_8h_source.html#l01302">DEBUG_REQ</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="lu__object_8h_source.html#l01325">DNAME</a>, <a class="el" href="lustre__disk_8h_source.html#l00267">ENOENT_VERSION</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__target_8h_source.html#l00498">err_serious()</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__fid_8h_source.html#l00331">fid_is_md_operative()</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lustre__import_8h_source.html#l00074">LATF_SKIP</a>, <a class="el" href="packet-lustre_8c_source.html#l00291">LCK_EX</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="mdt__internal_8h_source.html#l01013">LPROC_MDT_LINK</a>, <a class="el" href="lustre__idl_8h_source.html#l00801">lu_fid_eq()</a>, <a class="el" href="md__object_8h_source.html#l00540">mdo_link()</a>, <a class="el" href="lustre__idl_8h_source.html#l02079">MDS_INODELOCK_UPDATE</a>, <a class="el" href="lustre__idl_8h_source.html#l02093">MDS_INODELOCK_XATTR</a>, <a class="el" href="mdt__internal_8h_source.html#l00168">mdt_device::mdt_bottom</a>, <a class="el" href="mdt__lproc_8c_source.html#l00929">mdt_counter_incr()</a>, <a class="el" href="mdt__internal_8h_source.html#l00896">mdt_fail_write()</a>, <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__internal_8h_source.html#l00270">MDT_LH_CHILD</a>, <a class="el" href="mdt__internal_8h_source.html#l00269">MDT_LH_PARENT</a>, <a class="el" href="mdt__handler_8c_source.html#l00171">mdt_lock_pdo_init()</a>, <a class="el" href="mdt__handler_8c_source.html#l00163">mdt_lock_reg_init()</a>, <a class="el" href="mdt__reint_8c_source.html#l00196">mdt_lookup_version_check()</a>, <a class="el" href="mdt__internal_8h_source.html#l01048">mdt_obd_name()</a>, <a class="el" href="mdt__internal_8h_source.html#l00760">mdt_obj2dt()</a>, <a class="el" href="mdt__internal_8h_source.html#l00500">mdt_object_child()</a>, <a class="el" href="mdt__internal_8h_source.html#l00533">mdt_object_exists()</a>, <a class="el" href="mdt__handler_8c_source.html#l02224">mdt_object_find()</a>, <a class="el" href="mdt__internal_8h_source.html#l00525">mdt_object_put()</a>, <a class="el" href="mdt__internal_8h_source.html#l00538">mdt_object_remote()</a>, <a class="el" href="mdt__handler_8c_source.html#l02771">mdt_object_unlock()</a>, <a class="el" href="mdt__handler_8c_source.html#l02625">mdt_reint_object_lock()</a>, <a class="el" href="mdt__reint_8c_source.html#l00176">mdt_version_get_check_save()</a>, <a class="el" href="mdt__reint_8c_source.html#l00116">mdt_version_save()</a>, <a class="el" href="mdt__internal_8h_source.html#l00347">mdt_thread_info::mti_attr</a>, <a class="el" href="mdt__internal_8h_source.html#l00359">mdt_thread_info::mti_dlm_req</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00328">mdt_thread_info::mti_lh</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00380">mdt_thread_info::mti_rr</a>, <a class="el" href="mdt__internal_8h_source.html#l00396">mdt_thread_info::mti_tmp_fid1</a>, <a class="el" href="mdt__internal_8h_source.html#l00382">mdt_thread_info::mti_ver</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00174">OBD_FAIL_MDS_REINT_LINK</a>, <a class="el" href="obd__support_8h_source.html#l00175">OBD_FAIL_MDS_REINT_LINK_WRITE</a>, <a class="el" href="obd__support_8h_source.html#l00244">OBD_FAIL_MDS_RENAME3</a>, <a class="el" href="obd__support_8h_source.html#l00624">OBD_FAIL_TIMEOUT</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="lu__object_8h_source.html#l01326">PNAME</a>, <a class="el" href="lu__target_8h_source.html#l00345">req_is_replay()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="mdt__internal_8h_source.html#l00294">mdt_reint_record::rr_fid1</a>, <a class="el" href="mdt__internal_8h_source.html#l00295">mdt_reint_record::rr_fid2</a>, <a class="el" href="mdt__internal_8h_source.html#l00296">mdt_reint_record::rr_name</a>, and <a class="el" href="lu__target_8h_source.html#l00245">tgt_vbr_obj_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a71f38f8d8f8a55cbc394ef74fefe6e0c"></a><!-- doxytag: member="mdt_reint.c::mdt_reint_migrate" ref="a71f38f8d8f8a55cbc394ef74fefe6e0c" args="(struct mdt_thread_info *info, struct mdt_lock_handle *lhc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_reint_migrate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lhc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l02185">2185</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="mdt__reint_8c_source.html#l02139">mdt_reint_rename_or_migrate()</a>.</p>

</div>
</div>
<a class="anchor" id="a55df5ffcd82ac56791e2ae952bd3322e"></a><!-- doxytag: member="mdt_reint.c::mdt_reint_migrate_internal" ref="a55df5ffcd82ac56791e2ae952bd3322e" args="(struct mdt_thread_info *info, struct mdt_lock_handle *lhc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_reint_migrate_internal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lhc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l01503">1503</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="lustre__idl_8h_source.html#l03987">close_data::cd_handle</a>, <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="lu__object_8h_source.html#l01325">DNAME</a>, <a class="el" href="lustre__dlm_8h_source.html#l00074">ELDLM_OK</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__fid_8h_source.html#l00331">fid_is_md_operative()</a>, <a class="el" href="lustre__idl_8h_source.html#l00793">fid_is_sane()</a>, <a class="el" href="lustre__idl_8h_source.html#l00260">fid_zero()</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="packet-lustre_8c_source.html#l00291">LCK_EX</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="lustre__dlm_8h_source.html#l01168">LDLM_DEBUG</a>, <a class="el" href="lustre__dlm_8h_source.html#l01273">ldlm_handle2lock()</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00186">ldlm_is_cancel</a>, <a class="el" href="ldlm__lock_8c_source.html#l02249">ldlm_lock_cancel()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01327">LDLM_LOCK_PUT</a>, <a class="el" href="ldlm__lock_8c_source.html#l02147">ldlm_reprocess_all()</a>, <a class="el" href="lustre__idl_8h_source.html#l02608">LMV_HASH_FLAG_MIGRATION</a>, <a class="el" href="lustre__idl_8h_source.html#l02582">lmv_mds_md_v1::lmv_hash_type</a>, <a class="el" href="lustre__lmv_8h_source.html#l00103">lmv_le_to_cpu()</a>, <a class="el" href="lustre__idl_8h_source.html#l02654">lmv_mds_md::lmv_md_v1</a>, <a class="el" href="lustre__idl_8h_source.html#l02593">lmv_mds_md_v1::lmv_stripe_fids</a>, <a class="el" href="l__lock_8c_source.html#l00051">lock_res_and_lock()</a>, <a class="el" href="lustre__idl_8h_source.html#l00801">lu_fid_eq()</a>, <a class="el" href="lu__object_8h_source.html#l00860">lu_object_attr()</a>, <a class="el" href="md__object_8h_source.html#l00121">md_attr::ma_hsm</a>, <a class="el" href="md__object_8h_source.html#l00078">MA_HSM</a>, <a class="el" href="md__object_8h_source.html#l00123">md_attr::ma_lmv</a>, <a class="el" href="md__object_8h_source.html#l00075">MA_LMV</a>, <a class="el" href="md__object_8h_source.html#l00126">md_attr::ma_lmv_size</a>, <a class="el" href="md__object_8h_source.html#l00117">md_attr::ma_need</a>, <a class="el" href="md__object_8h_source.html#l00116">md_attr::ma_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l02192">mdt_body::mbo_valid</a>, <a class="el" href="md__object_8h_source.html#l00520">mdo_migrate()</a>, <a class="el" href="lustre__idl_8h_source.html#l02081">MDS_INODELOCK_LAYOUT</a>, <a class="el" href="lustre__idl_8h_source.html#l02076">MDS_INODELOCK_LOOKUP</a>, <a class="el" href="lustre__idl_8h_source.html#l02079">MDS_INODELOCK_UPDATE</a>, <a class="el" href="mdt__handler_8c_source.html#l00819">mdt_attr_get_complex()</a>, <a class="el" href="mdt__internal_8h_source.html#l00168">mdt_device::mdt_bottom</a>, <a class="el" href="mdt__open_8c_source.html#l02009">mdt_close_internal()</a>, <a class="el" href="mdt__internal_8h_source.html#l00896">mdt_fail_write()</a>, <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__internal_8h_source.html#l00270">MDT_LH_CHILD</a>, <a class="el" href="mdt__internal_8h_source.html#l00271">MDT_LH_OLD</a>, <a class="el" href="mdt__internal_8h_source.html#l00269">MDT_LH_PARENT</a>, <a class="el" href="mdt__reint_8c_source.html#l01362">mdt_lock_objects_in_linkea()</a>, <a class="el" href="mdt__handler_8c_source.html#l00171">mdt_lock_pdo_init()</a>, <a class="el" href="mdt__handler_8c_source.html#l00163">mdt_lock_reg_init()</a>, <a class="el" href="mdt__reint_8c_source.html#l00196">mdt_lookup_version_check()</a>, <a class="el" href="mdt__internal_8h_source.html#l00211">mdt_device::mdt_md_root_fid</a>, <a class="el" href="mdt__internal_8h_source.html#l01048">mdt_obd_name()</a>, <a class="el" href="mdt__internal_8h_source.html#l00500">mdt_object_child()</a>, <a class="el" href="mdt__internal_8h_source.html#l00543">mdt_object_fid()</a>, <a class="el" href="mdt__handler_8c_source.html#l02224">mdt_object_find()</a>, <a class="el" href="mdt__internal_8h_source.html#l00525">mdt_object_put()</a>, <a class="el" href="mdt__internal_8h_source.html#l00538">mdt_object_remote()</a>, <a class="el" href="mdt__handler_8c_source.html#l02771">mdt_object_unlock()</a>, <a class="el" href="mdt__reint_8c_source.html#l00053">mdt_reint_init_ma()</a>, <a class="el" href="mdt__handler_8c_source.html#l02625">mdt_reint_object_lock()</a>, <a class="el" href="mdt__handler_8c_source.html#l02431">mdt_remote_object_lock()</a>, <a class="el" href="mdt__reint_8c_source.html#l00250">mdt_remote_permission()</a>, <a class="el" href="mdt__handler_8c_source.html#l00697">mdt_stripe_get()</a>, <a class="el" href="mdt__reint_8c_source.html#l01349">mdt_unlock_list()</a>, <a class="el" href="mdt__reint_8c_source.html#l00176">mdt_version_get_check_save()</a>, <a class="el" href="md__object_8h_source.html#l00110">md_hsm::mh_flags</a>, <a class="el" href="mdt__internal_8h_source.html#l00264">mdt_lock_handle::mlh_rreg_lh</a>, <a class="el" href="mdt__internal_8h_source.html#l00265">mdt_lock_handle::mlh_rreg_mode</a>, <a class="el" href="mdt__internal_8h_source.html#l00237">mdt_object::mot_obj</a>, <a class="el" href="mdt__internal_8h_source.html#l00245">mdt_object::mot_open_sem</a>, <a class="el" href="mdt__internal_8h_source.html#l00347">mdt_thread_info::mti_attr</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00328">mdt_thread_info::mti_lh</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00320">mdt_thread_info::mti_pill</a>, <a class="el" href="mdt__internal_8h_source.html#l00380">mdt_thread_info::mti_rr</a>, <a class="el" href="mdt__internal_8h_source.html#l00386">mdt_thread_info::mti_spec</a>, <a class="el" href="mdt__internal_8h_source.html#l00396">mdt_thread_info::mti_tmp_fid1</a>, <a class="el" href="mdt__internal_8h_source.html#l00429">mdt_thread_info::mti_xattr_buf</a>, <a class="el" href="obd__support_8h_source.html#l00177">OBD_FAIL_MDS_REINT_RENAME_WRITE</a>, <a class="el" href="lustre__idl_8h_source.html#l01715">OBD_MD_CLOSE_INTENT_EXECED</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="lu__object_8h_source.html#l01326">PNAME</a>, <a class="el" href="lustre__req__layout_8h_source.html#l00058">RCL_CLIENT</a>, <a class="el" href="layout_8c_source.html#l02117">req_capsule_client_get()</a>, <a class="el" href="layout_8c_source.html#l02396">req_capsule_field_present()</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l00964">RMF_CLOSE_DATA</a>, <a class="el" href="layout_8c_source.html#l00938">RMF_MDT_BODY</a>, <a class="el" href="layout_8c_source.html#l00954">RMF_MDT_EPOCH</a>, <a class="el" href="mdt__internal_8h_source.html#l00294">mdt_reint_record::rr_fid1</a>, <a class="el" href="mdt__internal_8h_source.html#l00295">mdt_reint_record::rr_fid2</a>, <a class="el" href="mdt__internal_8h_source.html#l00296">mdt_reint_record::rr_name</a>, <a class="el" href="md__object_8h_source.html#l00146">md_op_spec::sp_migrate_close</a>, <a class="el" href="l__lock_8c_source.html#l00067">unlock_res_and_lock()</a>, and <a class="el" href="lustre__idl_8h_source.html#l01596">XATTR_NAME_LMV</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l02139">mdt_reint_rename_or_migrate()</a>.</p>

</div>
</div>
<a class="anchor" id="ad9f4c4a1103c5c8232e0ac635589e62b"></a><!-- doxytag: member="mdt_reint.c::mdt_reint_rec" ref="ad9f4c4a1103c5c8232e0ac635589e62b" args="(struct mdt_thread_info *info, struct mdt_lock_handle *lhc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mdt_reint_rec </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lhc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l02235">2235</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="lustreapi_8h_source.html#l00049">ARRAY_SIZE</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lprocfs__status_8h_source.html#l00869">lprocfs_counter_incr()</a>, <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__reint_8c_source.html#l02193">mdt_reinter::mr_extra_opc</a>, <a class="el" href="structmdt__reinter.html#af228ff3394946fc0718a9a7c160ef1e2">mdt_reinter::mr_handler</a>, <a class="el" href="mdt__internal_8h_source.html#l00380">mdt_thread_info::mti_rr</a>, <a class="el" href="lprocfs__status_8h_source.html#l00336">PTLRPC_LAST_CNTR</a>, <a class="el" href="lustre__net_8h_source.html#l02583">ptlrpc_req2svc()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="mdt__internal_8h_source.html#l00292">mdt_reint_record::rr_opcode</a>.</p>

<p>Referenced by <a class="el" href="mdt__handler_8c_source.html#l01806">mdt_reint_internal()</a>.</p>

</div>
</div>
<a class="anchor" id="a54aab0fe39593a99787adb4273e9a56c"></a><!-- doxytag: member="mdt_reint.c::mdt_reint_rename" ref="a54aab0fe39593a99787adb4273e9a56c" args="(struct mdt_thread_info *info, struct mdt_lock_handle *lhc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_reint_rename </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lhc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l02179">2179</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="mdt__reint_8c_source.html#l02139">mdt_reint_rename_or_migrate()</a>.</p>

</div>
</div>
<a class="anchor" id="ae590e7b6e38f3bac80dd6c242d65e783"></a><!-- doxytag: member="mdt_reint.c::mdt_reint_rename_internal" ref="ae590e7b6e38f3bac80dd6c242d65e783" args="(struct mdt_thread_info *info, struct mdt_lock_handle *lhc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_reint_rename_internal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lhc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>For DNE phase I, only these renames are allowed mv src_p/src_c tgt_p/tgt_c 1. </p>
<p>src_p/src_c/tgt_p/tgt_c are in the same MDT. 2. src_p and tgt_p are same directory, and tgt_c does not exists. In this case, all of modification will happen in the MDT where ithesource parent is, only one remote update is needed, i.e. set c_time/m_time on the child. And tgt_c will be still in the same MDT as the original src_c. </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l01833">1833</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__net_8h_source.html#l01302">DEBUG_REQ</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="lu__object_8h_source.html#l01325">DNAME</a>, <a class="el" href="lustre__dlm_8h_source.html#l00074">ELDLM_OK</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__fid_8h_source.html#l00331">fid_is_md_operative()</a>, <a class="el" href="lustre__idl_8h_source.html#l00260">fid_zero()</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="packet-lustre_8c_source.html#l00291">LCK_EX</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="mdt__internal_8h_source.html#l01017">LPROC_MDT_RENAME</a>, <a class="el" href="lustre__idl_8h_source.html#l00801">lu_fid_eq()</a>, <a class="el" href="lu__object_8h_source.html#l00860">lu_object_attr()</a>, <a class="el" href="lustre__idl_8h_source.html#l02189">mdt_body::mbo_fid1</a>, <a class="el" href="lustre__idl_8h_source.html#l02192">mdt_body::mbo_valid</a>, <a class="el" href="md__object_8h_source.html#l00506">mdo_rename()</a>, <a class="el" href="lustre__idl_8h_source.html#l02076">MDS_INODELOCK_LOOKUP</a>, <a class="el" href="lustre__idl_8h_source.html#l02079">MDS_INODELOCK_UPDATE</a>, <a class="el" href="lustre__idl_8h_source.html#l02093">MDS_INODELOCK_XATTR</a>, <a class="el" href="mdt__internal_8h_source.html#l00168">mdt_device::mdt_bottom</a>, <a class="el" href="mdt__lproc_8c_source.html#l00929">mdt_counter_incr()</a>, <a class="el" href="mdt__reint_8c_source.html#l00135">mdt_enoent_version_save()</a>, <a class="el" href="mdt__internal_8h_source.html#l00896">mdt_fail_write()</a>, <a class="el" href="mdt__lib_8c_source.html#l00811">mdt_handle_last_unlink()</a>, <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__reint_8c_source.html#l01308">mdt_is_subdir()</a>, <a class="el" href="mdt__internal_8h_source.html#l00270">MDT_LH_CHILD</a>, <a class="el" href="mdt__internal_8h_source.html#l00273">MDT_LH_NEW</a>, <a class="el" href="mdt__internal_8h_source.html#l00271">MDT_LH_OLD</a>, <a class="el" href="mdt__internal_8h_source.html#l00269">MDT_LH_PARENT</a>, <a class="el" href="mdt__handler_8c_source.html#l00171">mdt_lock_pdo_init()</a>, <a class="el" href="mdt__handler_8c_source.html#l00163">mdt_lock_reg_init()</a>, <a class="el" href="mdt__reint_8c_source.html#l00196">mdt_lookup_version_check()</a>, <a class="el" href="mdt__internal_8h_source.html#l00760">mdt_obj2dt()</a>, <a class="el" href="mdt__internal_8h_source.html#l00500">mdt_object_child()</a>, <a class="el" href="mdt__internal_8h_source.html#l00543">mdt_object_fid()</a>, <a class="el" href="mdt__handler_8c_source.html#l02224">mdt_object_find()</a>, <a class="el" href="mdt__reint_8c_source.html#l01776">mdt_object_find_check()</a>, <a class="el" href="mdt__internal_8h_source.html#l00517">mdt_object_get()</a>, <a class="el" href="mdt__reint_8c_source.html#l01799">mdt_object_lock_save()</a>, <a class="el" href="mdt__internal_8h_source.html#l00525">mdt_object_put()</a>, <a class="el" href="mdt__internal_8h_source.html#l00538">mdt_object_remote()</a>, <a class="el" href="mdt__handler_8c_source.html#l02771">mdt_object_unlock()</a>, <a class="el" href="mdt__reint_8c_source.html#l01215">mdt_pdir_hash_lock()</a>, <a class="el" href="mdt__reint_8c_source.html#l00053">mdt_reint_init_ma()</a>, <a class="el" href="mdt__handler_8c_source.html#l02625">mdt_reint_object_lock()</a>, <a class="el" href="mdt__handler_8c_source.html#l02431">mdt_remote_object_lock()</a>, <a class="el" href="mdt__lproc_8c_source.html#l00172">mdt_rename_counter_tally()</a>, <a class="el" href="mdt__reint_8c_source.html#l00149">mdt_version_get_save()</a>, <a class="el" href="mdt__internal_8h_source.html#l00261">mdt_lock_handle::mlh_pdo_hash</a>, <a class="el" href="mdt__internal_8h_source.html#l00264">mdt_lock_handle::mlh_rreg_lh</a>, <a class="el" href="mdt__internal_8h_source.html#l00265">mdt_lock_handle::mlh_rreg_mode</a>, <a class="el" href="mdt__internal_8h_source.html#l00242">mdt_object::mot_lov_mutex</a>, <a class="el" href="mdt__internal_8h_source.html#l00237">mdt_object::mot_obj</a>, <a class="el" href="mdt__internal_8h_source.html#l00347">mdt_thread_info::mti_attr</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00328">mdt_thread_info::mti_lh</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00320">mdt_thread_info::mti_pill</a>, <a class="el" href="mdt__internal_8h_source.html#l00380">mdt_thread_info::mti_rr</a>, <a class="el" href="mdt__internal_8h_source.html#l00396">mdt_thread_info::mti_tmp_fid1</a>, <a class="el" href="mdt__internal_8h_source.html#l00397">mdt_thread_info::mti_tmp_fid2</a>, <a class="el" href="obd__support_8h_source.html#l00229">OBD_FAIL_MDS_PDO_LOCK2</a>, <a class="el" href="obd__support_8h_source.html#l00177">OBD_FAIL_MDS_REINT_RENAME_WRITE</a>, <a class="el" href="obd__support_8h_source.html#l00242">OBD_FAIL_MDS_RENAME</a>, <a class="el" href="obd__support_8h_source.html#l00243">OBD_FAIL_MDS_RENAME2</a>, <a class="el" href="obd__support_8h_source.html#l00244">OBD_FAIL_MDS_RENAME3</a>, <a class="el" href="obd__support_8h_source.html#l00245">OBD_FAIL_MDS_RENAME4</a>, <a class="el" href="obd__support_8h_source.html#l00624">OBD_FAIL_TIMEOUT</a>, <a class="el" href="lustre__idl_8h_source.html#l01656">OBD_MD_FLID</a>, <a class="el" href="lustre__idl_8h_source.html#l01689">OBD_MD_MDS</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="lu__object_8h_source.html#l01326">PNAME</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l00938">RMF_MDT_BODY</a>, <a class="el" href="mdt__internal_8h_source.html#l00294">mdt_reint_record::rr_fid1</a>, <a class="el" href="mdt__internal_8h_source.html#l00295">mdt_reint_record::rr_fid2</a>, <a class="el" href="mdt__internal_8h_source.html#l00296">mdt_reint_record::rr_name</a>, <a class="el" href="mdt__internal_8h_source.html#l00297">mdt_reint_record::rr_tgt_name</a>, and <a class="el" href="lu__target_8h_source.html#l00245">tgt_vbr_obj_set()</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l02139">mdt_reint_rename_or_migrate()</a>.</p>

</div>
</div>
<a class="anchor" id="aa7c86ef4bf93ff1cab90fcd563c85c26"></a><!-- doxytag: member="mdt_reint.c::mdt_reint_rename_or_migrate" ref="aa7c86ef4bf93ff1cab90fcd563c85c26" args="(struct mdt_thread_info *info, struct mdt_lock_handle *lhc, bool rename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_reint_rename_or_migrate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lhc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>rename</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l02139">2139</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__fid_8h_source.html#l00331">fid_is_md_operative()</a>, <a class="el" href="lustre__import_8h_source.html#l00074">LATF_SKIP</a>, <a class="el" href="lustre__idl_8h_source.html#l01021">lustre_handle_is_used()</a>, <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__internal_8h_source.html#l01048">mdt_obd_name()</a>, <a class="el" href="mdt__reint_8c_source.html#l01503">mdt_reint_migrate_internal()</a>, <a class="el" href="mdt__reint_8c_source.html#l01833">mdt_reint_rename_internal()</a>, <a class="el" href="mdt__reint_8c_source.html#l01250">mdt_rename_lock()</a>, <a class="el" href="mdt__reint_8c_source.html#l01294">mdt_rename_unlock()</a>, <a class="el" href="mdt__internal_8h_source.html#l00359">mdt_thread_info::mti_dlm_req</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00380">mdt_thread_info::mti_rr</a>, <a class="el" href="lu__target_8h_source.html#l00345">req_is_replay()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="mdt__internal_8h_source.html#l00294">mdt_reint_record::rr_fid1</a>, and <a class="el" href="mdt__internal_8h_source.html#l00295">mdt_reint_record::rr_fid2</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l02185">mdt_reint_migrate()</a>, and <a class="el" href="mdt__reint_8c_source.html#l02179">mdt_reint_rename()</a>.</p>

</div>
</div>
<a class="anchor" id="a2c46df2dd5227b971a5de380778ddbfd"></a><!-- doxytag: member="mdt_reint.c::mdt_reint_setattr" ref="a2c46df2dd5227b971a5de380778ddbfd" args="(struct mdt_thread_info *info, struct mdt_lock_handle *lhc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_reint_setattr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lhc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00715">715</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="parallel__grouplock_8c_source.html#l00078">buf</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__net_8h_source.html#l01302">DEBUG_REQ</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00447">LA_SIZE</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="lustre__import_8h_source.html#l00074">LATF_SKIP</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="mdt__internal_8h_source.html#l01019">LPROC_MDT_SETATTR</a>, <a class="el" href="md__object_8h_source.html#l00119">md_attr::ma_attr</a>, <a class="el" href="md__object_8h_source.html#l00118">md_attr::ma_attr_flags</a>, <a class="el" href="md__object_8h_source.html#l00072">MA_INODE</a>, <a class="el" href="md__object_8h_source.html#l00122">md_attr::ma_lmm</a>, <a class="el" href="md__object_8h_source.html#l00125">md_attr::ma_lmm_size</a>, <a class="el" href="md__object_8h_source.html#l00123">md_attr::ma_lmv</a>, <a class="el" href="md__object_8h_source.html#l00075">MA_LMV</a>, <a class="el" href="md__object_8h_source.html#l00126">md_attr::ma_lmv_size</a>, <a class="el" href="md__object_8h_source.html#l00073">MA_LOV</a>, <a class="el" href="md__object_8h_source.html#l00117">md_attr::ma_need</a>, <a class="el" href="md__object_8h_source.html#l00116">md_attr::ma_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l02367">MDS_DATA_MODIFIED</a>, <a class="el" href="lustre__idl_8h_source.html#l02093">MDS_INODELOCK_XATTR</a>, <a class="el" href="mdt__reint_8c_source.html#l00678">mdt_add_dirty_flag()</a>, <a class="el" href="mdt__handler_8c_source.html#l00819">mdt_attr_get_complex()</a>, <a class="el" href="mdt__reint_8c_source.html#l00596">mdt_attr_set()</a>, <a class="el" href="mdt__handler_8c_source.html#l00600">mdt_client_compatibility()</a>, <a class="el" href="mdt__lproc_8c_source.html#l00929">mdt_counter_incr()</a>, <a class="el" href="mdt__lib_8c_source.html#l00689">mdt_fix_reply()</a>, <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__internal_8h_source.html#l00269">MDT_LH_PARENT</a>, <a class="el" href="mdt__handler_8c_source.html#l00163">mdt_lock_reg_init()</a>, <a class="el" href="mdt__internal_8h_source.html#l00500">mdt_object_child()</a>, <a class="el" href="mdt__internal_8h_source.html#l00533">mdt_object_exists()</a>, <a class="el" href="mdt__internal_8h_source.html#l00543">mdt_object_fid()</a>, <a class="el" href="mdt__handler_8c_source.html#l02224">mdt_object_find()</a>, <a class="el" href="mdt__handler_8c_source.html#l02619">mdt_object_lock()</a>, <a class="el" href="mdt__internal_8h_source.html#l00525">mdt_object_put()</a>, <a class="el" href="mdt__internal_8h_source.html#l00538">mdt_object_remote()</a>, <a class="el" href="mdt__handler_8c_source.html#l02771">mdt_object_unlock()</a>, <a class="el" href="mdt__handler_8c_source.html#l00501">mdt_pack_attr2body()</a>, <a class="el" href="mdt__reint_8c_source.html#l00250">mdt_remote_permission()</a>, <a class="el" href="mdt__open_8c_source.html#l00141">mdt_write_read()</a>, <a class="el" href="md__object_8h_source.html#l00387">mo_xattr_set()</a>, <a class="el" href="mdt__internal_8h_source.html#l00304">MRF_OPEN_TRUNC</a>, <a class="el" href="mdt__internal_8h_source.html#l00347">mdt_thread_info::mti_attr</a>, <a class="el" href="mdt__internal_8h_source.html#l00418">mdt_thread_info::mti_buf</a>, <a class="el" href="mdt__internal_8h_source.html#l00359">mdt_thread_info::mti_dlm_req</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00328">mdt_thread_info::mti_lh</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00320">mdt_thread_info::mti_pill</a>, <a class="el" href="mdt__internal_8h_source.html#l00380">mdt_thread_info::mti_rr</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="layout_8c_source.html#l00938">RMF_MDT_BODY</a>, <a class="el" href="mdt__internal_8h_source.html#l00294">mdt_reint_record::rr_fid1</a>, <a class="el" href="mdt__internal_8h_source.html#l00300">mdt_reint_record::rr_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l01597">XATTR_NAME_DEFAULT_LMV</a>, and <a class="el" href="lustre__idl_8h_source.html#l01594">XATTR_NAME_LOV</a>.</p>

</div>
</div>
<a class="anchor" id="a350a77e2484064c0dbf4c55d6e95d36b"></a><!-- doxytag: member="mdt_reint.c::mdt_reint_unlink" ref="a350a77e2484064c0dbf4c55d6e95d36b" args="(struct mdt_thread_info *info, struct mdt_lock_handle *lhc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_reint_unlink </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lhc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00871">871</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="curproc_8h_source.html#l00118">CFS_CAP_SYS_ADMIN</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__net_8h_source.html#l01302">DEBUG_REQ</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="lu__object_8h_source.html#l01325">DNAME</a>, <a class="el" href="lustre__dlm_8h_source.html#l00074">ELDLM_OK</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__target_8h_source.html#l00498">err_serious()</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__fid_8h_source.html#l00331">fid_is_md_operative()</a>, <a class="el" href="lustre__user_8h_source.html#l00156">fid_is_zero()</a>, <a class="el" href="lustre__idl_8h_source.html#l00260">fid_zero()</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00419">lu_attr::la_mode</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00045">LASSERTF</a>, <a class="el" href="lustre__import_8h_source.html#l00074">LATF_SKIP</a>, <a class="el" href="packet-lustre_8c_source.html#l00291">LCK_EX</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="mdt__internal_8h_source.html#l01016">LPROC_MDT_RMDIR</a>, <a class="el" href="mdt__internal_8h_source.html#l01014">LPROC_MDT_UNLINK</a>, <a class="el" href="lu__object_8h_source.html#l00719">lu_object_is_dying()</a>, <a class="el" href="pack__generic_8c_source.html#l00829">lustre_msg_get_flags()</a>, <a class="el" href="md__object_8h_source.html#l00119">md_attr::ma_attr</a>, <a class="el" href="md__object_8h_source.html#l00072">MA_INODE</a>, <a class="el" href="md__object_8h_source.html#l00117">md_attr::ma_need</a>, <a class="el" href="md__object_8h_source.html#l00116">md_attr::ma_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l02189">mdt_body::mbo_fid1</a>, <a class="el" href="lustre__idl_8h_source.html#l02192">mdt_body::mbo_valid</a>, <a class="el" href="md__object_8h_source.html#l00618">md_capable()</a>, <a class="el" href="md__object_8h_source.html#l00550">mdo_unlink()</a>, <a class="el" href="lustre__idl_8h_source.html#l02076">MDS_INODELOCK_LOOKUP</a>, <a class="el" href="lustre__idl_8h_source.html#l02079">MDS_INODELOCK_UPDATE</a>, <a class="el" href="mdt__handler_8c_source.html#l00819">mdt_attr_get_complex()</a>, <a class="el" href="mdt__internal_8h_source.html#l00168">mdt_device::mdt_bottom</a>, <a class="el" href="mdt__lproc_8c_source.html#l00929">mdt_counter_incr()</a>, <a class="el" href="mdt__internal_8h_source.html#l00896">mdt_fail_write()</a>, <a class="el" href="mdt__lib_8c_source.html#l00811">mdt_handle_last_unlink()</a>, <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__reint_8c_source.html#l00336">mdt_init_slaves()</a>, <a class="el" href="mdt__internal_8h_source.html#l00565">mdt_is_dne_client()</a>, <a class="el" href="mdt__internal_8h_source.html#l00270">MDT_LH_CHILD</a>, <a class="el" href="mdt__internal_8h_source.html#l00275">MDT_LH_LOCAL</a>, <a class="el" href="mdt__internal_8h_source.html#l00269">MDT_LH_PARENT</a>, <a class="el" href="mdt__handler_8c_source.html#l00171">mdt_lock_pdo_init()</a>, <a class="el" href="mdt__handler_8c_source.html#l00163">mdt_lock_reg_init()</a>, <a class="el" href="mdt__reint_8c_source.html#l00378">mdt_lock_slaves()</a>, <a class="el" href="mdt__reint_8c_source.html#l00196">mdt_lookup_version_check()</a>, <a class="el" href="mdt__internal_8h_source.html#l01048">mdt_obd_name()</a>, <a class="el" href="mdt__internal_8h_source.html#l00500">mdt_object_child()</a>, <a class="el" href="mdt__internal_8h_source.html#l00543">mdt_object_fid()</a>, <a class="el" href="mdt__handler_8c_source.html#l02224">mdt_object_find()</a>, <a class="el" href="mdt__handler_8c_source.html#l02619">mdt_object_lock()</a>, <a class="el" href="mdt__internal_8h_source.html#l00525">mdt_object_put()</a>, <a class="el" href="mdt__internal_8h_source.html#l00538">mdt_object_remote()</a>, <a class="el" href="mdt__handler_8c_source.html#l02771">mdt_object_unlock()</a>, <a class="el" href="mdt__handler_8c_source.html#l02625">mdt_reint_object_lock()</a>, <a class="el" href="mdt__handler_8c_source.html#l02431">mdt_remote_object_lock()</a>, <a class="el" href="mdt__handler_8c_source.html#l06063">mdt_ucred()</a>, <a class="el" href="mdt__reint_8c_source.html#l00295">mdt_unlock_slaves()</a>, <a class="el" href="mdt__reint_8c_source.html#l00176">mdt_version_get_check_save()</a>, <a class="el" href="mdt__reint_8c_source.html#l00149">mdt_version_get_save()</a>, <a class="el" href="mdt__internal_8h_source.html#l00264">mdt_lock_handle::mlh_rreg_lh</a>, <a class="el" href="mdt__internal_8h_source.html#l00265">mdt_lock_handle::mlh_rreg_mode</a>, <a class="el" href="mdt__internal_8h_source.html#l00236">mdt_object::mot_header</a>, <a class="el" href="mdt__internal_8h_source.html#l00242">mdt_object::mot_lov_mutex</a>, <a class="el" href="lustre__idl_8h_source.html#l01153">MSG_RESENT</a>, <a class="el" href="mdt__internal_8h_source.html#l00347">mdt_thread_info::mti_attr</a>, <a class="el" href="mdt__internal_8h_source.html#l00359">mdt_thread_info::mti_dlm_req</a>, <a class="el" href="mdt__internal_8h_source.html#l00430">mdt_thread_info::mti_einfo</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00328">mdt_thread_info::mti_lh</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00320">mdt_thread_info::mti_pill</a>, <a class="el" href="mdt__internal_8h_source.html#l00380">mdt_thread_info::mti_rr</a>, <a class="el" href="mdt__internal_8h_source.html#l00386">mdt_thread_info::mti_spec</a>, <a class="el" href="mdt__internal_8h_source.html#l00396">mdt_thread_info::mti_tmp_fid1</a>, <a class="el" href="mdt__internal_8h_source.html#l00397">mdt_thread_info::mti_tmp_fid2</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00172">OBD_FAIL_MDS_REINT_UNLINK</a>, <a class="el" href="obd__support_8h_source.html#l00173">OBD_FAIL_MDS_REINT_UNLINK_WRITE</a>, <a class="el" href="lustre__idl_8h_source.html#l01656">OBD_MD_FLID</a>, <a class="el" href="lustre__idl_8h_source.html#l01689">OBD_MD_MDS</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="lu__object_8h_source.html#l01326">PNAME</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l00938">RMF_MDT_BODY</a>, <a class="el" href="lustre__net_8h_source.html#l01102">ptlrpc_request::rq_export</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="mdt__internal_8h_source.html#l00294">mdt_reint_record::rr_fid1</a>, <a class="el" href="mdt__internal_8h_source.html#l00295">mdt_reint_record::rr_fid2</a>, <a class="el" href="mdt__internal_8h_source.html#l00296">mdt_reint_record::rr_name</a>, and <a class="el" href="md__object_8h_source.html#l00146">md_op_spec::sp_rm_entry</a>.</p>

</div>
</div>
<a class="anchor" id="a8280e7ea9f38fbcd79b77d6b37ed6cfe"></a><!-- doxytag: member="mdt_reint.c::mdt_remote_permission" ref="a8280e7ea9f38fbcd79b77d6b37ed6cfe" args="(struct mdt_thread_info *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_remote_permission </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>mdt_remote_permission: Check whether the remote operation is permitted, </p>
<p>Only sysadmin can create remote directory / striped directory, migrate directory and set default stripedEA on directory, unless</p>
<p>lctl set_param mdt.*.enable_remote_dir_gid=allow_gid.</p>
<p>param[in] info: <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a>.</p>
<p>retval = 0 remote operation is allowed. &lt; 0 remote operation is denied. </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00250">250</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="lu__object_8h_source.html#l00419">lu_attr::la_mode</a>, <a class="el" href="byteorder_8h_source.html#l00056">le32_to_cpu</a>, <a class="el" href="lustre__user_8h_source.html#l00458">lmv_user_md</a>, <a class="el" href="md__object_8h_source.html#l00119">md_attr::ma_attr</a>, <a class="el" href="md__object_8h_source.html#l00075">MA_LMV</a>, <a class="el" href="md__object_8h_source.html#l00116">md_attr::ma_valid</a>, <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__internal_8h_source.html#l00565">mdt_is_dne_client()</a>, <a class="el" href="mdt__internal_8h_source.html#l00570">mdt_is_striped_client()</a>, <a class="el" href="mdt__reint_8c_source.html#l00223">mdt_remote_permission_check()</a>, <a class="el" href="mdt__internal_8h_source.html#l00347">mdt_thread_info::mti_attr</a>, <a class="el" href="mdt__internal_8h_source.html#l00380">mdt_thread_info::mti_rr</a>, <a class="el" href="mdt__internal_8h_source.html#l00386">mdt_thread_info::mti_spec</a>, <a class="el" href="packet-lustre_8c_source.html#l00250">REINT_CREATE</a>, <a class="el" href="lustre__idl_8h_source.html#l02056">REINT_MIGRATE</a>, <a class="el" href="packet-lustre_8c_source.html#l00249">REINT_SETATTR</a>, <a class="el" href="lustre__net_8h_source.html#l01102">ptlrpc_request::rq_export</a>, <a class="el" href="mdt__internal_8h_source.html#l00292">mdt_reint_record::rr_opcode</a>, <a class="el" href="structmd__op__spec.html#ad74c1d49e024fdbc5a44e764a5a82c05">md_op_spec::sp_ea</a>, and <a class="el" href="structmd__op__spec.html#a13d810e55e3284f5244598d00fe84ca3">md_op_spec::u</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00436">mdt_md_create()</a>, <a class="el" href="mdt__reint_8c_source.html#l01503">mdt_reint_migrate_internal()</a>, and <a class="el" href="mdt__reint_8c_source.html#l00715">mdt_reint_setattr()</a>.</p>

</div>
</div>
<a class="anchor" id="a6f5c9ccdf7d8de126dd055ae59122b49"></a><!-- doxytag: member="mdt_reint.c::mdt_remote_permission_check" ref="a6f5c9ccdf7d8de126dd055ae59122b49" args="(struct mdt_thread_info *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_remote_permission_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00223">223</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="curproc_8h_source.html#l00118">CFS_CAP_SYS_ADMIN</a>, <a class="el" href="md__object_8h_source.html#l00618">md_capable()</a>, <a class="el" href="mdt__internal_8h_source.html#l00201">mdt_device::mdt_enable_remote_dir_gid</a>, <a class="el" href="mdt__handler_8c_source.html#l06063">mdt_ucred()</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, and <a class="el" href="md__object_8h_source.html#l00590">lu_ucred::uc_gid</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00250">mdt_remote_permission()</a>.</p>

</div>
</div>
<a class="anchor" id="afdbc826fe633955420a23a36857494ba"></a><!-- doxytag: member="mdt_reint.c::mdt_rename_lock" ref="afdbc826fe633955420a23a36857494ba" args="(struct mdt_thread_info *info, struct lustre_handle *lh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_rename_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get BFL lock for rename or migrate process. </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l01250">1250</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="lustre__idl_8h_source.html#l02841">ldlm_inodebits::bits</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__export_8h_source.html#l00175">obd_export::exp_handle</a>, <a class="el" href="lustre__fid_8h_source.html#l00541">fid_build_reg_res_name()</a>, <a class="el" href="lustre__handles_8h_source.html#l00067">portals_handle::h_cookie</a>, <a class="el" href="lustre__dlm_8h_source.html#l00635">ldlm_policy_data::l_inodebits</a>, <a class="el" href="packet-lustre_8c_source.html#l00291">LCK_EX</a>, <a class="el" href="ldlm__request_8c_source.html#l00354">ldlm_blocking_ast()</a>, <a class="el" href="ldlm__request_8c_source.html#l00415">ldlm_cli_enqueue_local()</a>, <a class="el" href="ldlm__request_8c_source.html#l00230">ldlm_completion_ast()</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00258">LDLM_FL_ATOMIC_CB</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00191">LDLM_FL_LOCAL_ONLY</a>, <a class="el" href="packet-lustre_8c_source.html#l00301">LDLM_IBITS</a>, <a class="el" href="lustre__idl_8h_source.html#l00409">lu_root_fid()</a>, <a class="el" href="fid__lib_8c_source.html#l00078">LUSTRE_BFL_FID</a>, <a class="el" href="lustre__dlm_8h_source.html#l00646">LVB_T_NONE</a>, <a class="el" href="lustre__idl_8h_source.html#l02079">MDS_INODELOCK_UPDATE</a>, <a class="el" href="mdt__internal_8h_source.html#l00162">mdt_device::mdt_namespace</a>, <a class="el" href="mdt__handler_8c_source.html#l02224">mdt_object_find()</a>, <a class="el" href="mdt__internal_8h_source.html#l00525">mdt_object_put()</a>, <a class="el" href="mdt__handler_8c_source.html#l02431">mdt_remote_object_lock()</a>, <a class="el" href="mdt__internal_8h_source.html#l00553">mdt_seq_site()</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00324">mdt_thread_info::mti_exp</a>, <a class="el" href="mdt__internal_8h_source.html#l00330">mdt_thread_info::mti_mdt</a>, <a class="el" href="mdt__internal_8h_source.html#l00398">mdt_thread_info::mti_policy</a>, <a class="el" href="mdt__internal_8h_source.html#l00399">mdt_thread_info::mti_res_id</a>, <a class="el" href="mdt__internal_8h_source.html#l00396">mdt_thread_info::mti_tmp_fid1</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="lustre__fid_8h_source.html#l00454">seq_server_site::ss_node_id</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l02139">mdt_reint_rename_or_migrate()</a>.</p>

</div>
</div>
<a class="anchor" id="a34f59835afd6ba371f77893b1df9d979"></a><!-- doxytag: member="mdt_reint.c::mdt_rename_unlock" ref="a34f59835afd6ba371f77893b1df9d979" args="(struct lustre_handle *lh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mdt_rename_unlock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>lh</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l01294">1294</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="packet-lustre_8c_source.html#l00291">LCK_EX</a>, <a class="el" href="ldlm__lock_8c_source.html#l00918">ldlm_lock_decref_and_cancel()</a>, and <a class="el" href="lustre__idl_8h_source.html#l01021">lustre_handle_is_used()</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l02139">mdt_reint_rename_or_migrate()</a>.</p>

</div>
</div>
<a class="anchor" id="a2201c041c570c32904f3de197600a55f"></a><!-- doxytag: member="mdt_reint.c::mdt_unlock_list" ref="a2201c041c570c32904f3de197600a55f" args="(struct mdt_thread_info *info, struct list_head *list, int rc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mdt_unlock_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlist__head.html">list_head</a> *&nbsp;</td>
          <td class="paramname"> <em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l01349">1349</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="list_8h_source.html#l00116">list_del()</a>, <a class="el" href="list_8h_source.html#l00484">list_for_each_entry_safe</a>, <a class="el" href="mdt__handler_8c_source.html#l02803">mdt_object_unlock_put()</a>, <a class="el" href="mdt__reint_8c_source.html#l01345">mdt_lock_list::mll_lh</a>, <a class="el" href="mdt__reint_8c_source.html#l01346">mdt_lock_list::mll_list</a>, <a class="el" href="mdt__reint_8c_source.html#l01344">mdt_lock_list::mll_obj</a>, and <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l01362">mdt_lock_objects_in_linkea()</a>, and <a class="el" href="mdt__reint_8c_source.html#l01503">mdt_reint_migrate_internal()</a>.</p>

</div>
</div>
<a class="anchor" id="a43ca4d9336aaf502a41908a613e3d913"></a><!-- doxytag: member="mdt_reint.c::mdt_unlock_slaves" ref="a43ca4d9336aaf502a41908a613e3d913" args="(struct mdt_thread_info *mti, struct mdt_object *obj, __u64 ibits, struct mdt_lock_handle *s0_lh, struct mdt_object *s0_obj, struct ldlm_enqueue_info *einfo, int decref)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_unlock_slaves </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>mti</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>ibits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__lock__handle.html">mdt_lock_handle</a> *&nbsp;</td>
          <td class="paramname"> <em>s0_lh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>s0_obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__enqueue__info.html">ldlm_enqueue_info</a> *&nbsp;</td>
          <td class="paramname"> <em>einfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>decref</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00295">295</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l02841">ldlm_inodebits::bits</a>, <a class="el" href="lustre__idl_8h_source.html#l01017">lustre_handle::cookie</a>, <a class="el" href="lustre__idl_8h_source.html#l01039">lustre_handle_array::count</a>, <a class="el" href="lustre__dlm_8h_source.html#l01103">ldlm_enqueue_info::ei_cbdata</a>, <a class="el" href="lustre__dlm_8h_source.html#l01098">ldlm_enqueue_info::ei_mode</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__idl_8h_source.html#l01040">lustre_handle_array::handles</a>, <a class="el" href="lustre__dlm_8h_source.html#l00635">ldlm_policy_data::l_inodebits</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00539">lu_object_header::loh_attr</a>, <a class="el" href="lustre__idl_8h_source.html#l01021">lustre_handle_is_used()</a>, <a class="el" href="mdt__handler_8c_source.html#l00163">mdt_lock_reg_init()</a>, <a class="el" href="mdt__internal_8h_source.html#l00500">mdt_object_child()</a>, <a class="el" href="mdt__handler_8c_source.html#l02771">mdt_object_unlock()</a>, <a class="el" href="mdt__handler_8c_source.html#l02803">mdt_object_unlock_put()</a>, <a class="el" href="mdt__internal_8h_source.html#l00255">mdt_lock_handle::mlh_reg_lh</a>, <a class="el" href="mdt__internal_8h_source.html#l00264">mdt_lock_handle::mlh_rreg_lh</a>, <a class="el" href="md__object_8h_source.html#l00457">mo_object_unlock()</a>, <a class="el" href="mdt__internal_8h_source.html#l00236">mdt_object::mot_header</a>, <a class="el" href="mdt__internal_8h_source.html#l00331">mdt_thread_info::mti_env</a>, <a class="el" href="mdt__internal_8h_source.html#l00398">mdt_thread_info::mti_policy</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00596">mdt_attr_set()</a>, <a class="el" href="mdt__reint_8c_source.html#l00436">mdt_md_create()</a>, and <a class="el" href="mdt__reint_8c_source.html#l00871">mdt_reint_unlink()</a>.</p>

</div>
</div>
<a class="anchor" id="afe03c72b6a4f17d63aacbae36eb3072c"></a><!-- doxytag: member="mdt_reint.c::mdt_version_check" ref="afe03c72b6a4f17d63aacbae36eb3072c" args="(struct ptlrpc_request *req, __u64 version, int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int mdt_version_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check version is correct. </p>
<p>Should be called only during replay. </p>

<p><p>VBR: version is checked always because costs nothing</p>
<p>Sanity check for malformed buffers </p>
</p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00083">83</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__export_8h_source.html#l00356">exp_connect_vbr()</a>, <a class="el" href="lustre__export_8h_source.html#l00240">obd_export::exp_lock</a>, <a class="el" href="lustre__export_8h_source.html#l00245">obd_export::exp_vbr_failed</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="pack__generic_8c_source.html#l01062">lustre_msg_get_versions()</a>, <a class="el" href="lustre__idl_8h_source.html#l01063">PTLRPC_NUM_VERSIONS</a>, <a class="el" href="lu__target_8h_source.html#l00345">req_is_replay()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01102">ptlrpc_request::rq_export</a>, and <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00196">mdt_lookup_version_check()</a>, <a class="el" href="mdt__reint_8c_source.html#l00162">mdt_version_get_check()</a>, and <a class="el" href="mdt__reint_8c_source.html#l00176">mdt_version_get_check_save()</a>.</p>

</div>
</div>
<a class="anchor" id="a91e41b2d147c1b71106ba66c909c2bc9"></a><!-- doxytag: member="mdt_reint.c::mdt_version_get_check" ref="a91e41b2d147c1b71106ba66c909c2bc9" args="(struct mdt_thread_info *info, struct mdt_object *mto, int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mdt_version_get_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>mto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get version from disk and check it, no save in reply. </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00162">162</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__reint_8c_source.html#l00065">mdt_obj_version_get()</a>, <a class="el" href="mdt__reint_8c_source.html#l00083">mdt_version_check()</a>, <a class="el" href="mdt__internal_8h_source.html#l00382">mdt_thread_info::mti_ver</a>, and <a class="el" href="lu__target_8h_source.html#l00345">req_is_replay()</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l01776">mdt_object_find_check()</a>, and <a class="el" href="mdt__open_8c_source.html#l01180">mdt_reint_open()</a>.</p>

</div>
</div>
<a class="anchor" id="ad7d34c46ecb88c4672d8e054ab836f4d"></a><!-- doxytag: member="mdt_reint.c::mdt_version_get_check_save" ref="ad7d34c46ecb88c4672d8e054ab836f4d" args="(struct mdt_thread_info *info, struct mdt_object *mto, int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mdt_version_get_check_save </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>mto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get version from disk and check if recovery or just save. </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00176">176</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__reint_8c_source.html#l00065">mdt_obj_version_get()</a>, <a class="el" href="mdt__reint_8c_source.html#l00083">mdt_version_check()</a>, <a class="el" href="mdt__reint_8c_source.html#l00116">mdt_version_save()</a>, <a class="el" href="mdt__internal_8h_source.html#l00382">mdt_thread_info::mti_ver</a>, and <a class="el" href="lu__target_8h_source.html#l00345">req_is_replay()</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00596">mdt_attr_set()</a>, <a class="el" href="mdt__reint_8c_source.html#l00436">mdt_md_create()</a>, <a class="el" href="mdt__reint_8c_source.html#l01098">mdt_reint_link()</a>, <a class="el" href="mdt__reint_8c_source.html#l01503">mdt_reint_migrate_internal()</a>, <a class="el" href="mdt__xattr_8c_source.html#l00363">mdt_reint_setxattr()</a>, and <a class="el" href="mdt__reint_8c_source.html#l00871">mdt_reint_unlink()</a>.</p>

</div>
</div>
<a class="anchor" id="a7e5bd5fc9b3b64f3168d16dc748a6c26"></a><!-- doxytag: member="mdt_reint.c::mdt_version_get_save" ref="a7e5bd5fc9b3b64f3168d16dc748a6c26" args="(struct mdt_thread_info *info, struct mdt_object *mto, int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mdt_version_get_save </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmdt__thread__info.html">mdt_thread_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmdt__object.html">mdt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>mto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get version from disk and save in reply buffer. </p>
<p>Versions are saved in reply only during normal operations not replays. </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00149">149</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="mdt__internal_8h_source.html#l00506">mdt_info_req()</a>, <a class="el" href="mdt__reint_8c_source.html#l00065">mdt_obj_version_get()</a>, <a class="el" href="mdt__reint_8c_source.html#l00116">mdt_version_save()</a>, <a class="el" href="mdt__internal_8h_source.html#l00382">mdt_thread_info::mti_ver</a>, and <a class="el" href="lu__target_8h_source.html#l00345">req_is_replay()</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l01799">mdt_object_lock_save()</a>, <a class="el" href="mdt__open_8c_source.html#l01180">mdt_reint_open()</a>, <a class="el" href="mdt__reint_8c_source.html#l01833">mdt_reint_rename_internal()</a>, and <a class="el" href="mdt__reint_8c_source.html#l00871">mdt_reint_unlink()</a>.</p>

</div>
</div>
<a class="anchor" id="a226f445d21d5bf08977dfc8cac94d97c"></a><!-- doxytag: member="mdt_reint.c::mdt_version_save" ref="a226f445d21d5bf08977dfc8cac94d97c" args="(struct ptlrpc_request *req, __u64 version, int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mdt_version_save </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Save pre-versions in reply. </p>

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l00116">116</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="lustre__export_8h_source.html#l00356">exp_connect_vbr()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="pack__generic_8c_source.html#l01062">lustre_msg_get_versions()</a>, <a class="el" href="lu__target_8h_source.html#l00345">req_is_replay()</a>, <a class="el" href="lustre__net_8h_source.html#l01102">ptlrpc_request::rq_export</a>, and <a class="el" href="lustre__net_8h_source.html#l01032">ptlrpc_request::rq_repmsg</a>.</p>

<p>Referenced by <a class="el" href="mdt__reint_8c_source.html#l00135">mdt_enoent_version_save()</a>, <a class="el" href="mdt__reint_8c_source.html#l01098">mdt_reint_link()</a>, <a class="el" href="mdt__reint_8c_source.html#l00176">mdt_version_get_check_save()</a>, and <a class="el" href="mdt__reint_8c_source.html#l00149">mdt_version_get_save()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a953d17879ea46d70b0b2d003fa712f71"></a><!-- doxytag: member="mdt_reint.c::mdt_reinters" ref="a953d17879ea46d70b0b2d003fa712f71" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structmdt__reinter.html">mdt_reinter</a> <a class="el" href="mdt__reint_8c.html#a953d17879ea46d70b0b2d003fa712f71">mdt_reinters</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mdt__reint_8c_source.html#l02196">2196</a> of file <a class="el" href="mdt__reint_8c_source.html">mdt_reint.c</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:49 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
