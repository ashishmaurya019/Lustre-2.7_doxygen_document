<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lov_object Struct Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structure&nbsp;Index</span></a></li>
      <li><a href="functions.html"><span>Data&nbsp;Fields</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lov_object Struct Reference<br/>
<small>
[<a class="el" href="group__lov.html">lov</a>]</small>
</h1><!-- doxytag: class="lov_object" -->
<p>lov-specific file state.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="lov__cl__internal_8h_source.html">lov_cl_internal.h</a>&gt;</code></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">union &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionlov__object_1_1lov__layout__state.html">lov_layout_state</a></td></tr>
<tr><td colspan="2"><h2>Data Fields</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcl__object.html">cl_object</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlov__object.html#af6b1712509f232166f9c7eb5c333dcff">lo_cl</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct rw_semaphore&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlov__object.html#aab2ef978c79c508d47197c8078abf098">lo_type_guard</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Serializes object operations with transitions between layout types.  <a href="#aab2ef978c79c508d47197c8078abf098"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="group__lov.html#ga28761ebc7af42a0c032a063f295c5ffb">lov_layout_type</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlov__object.html#ab8b1070ca6fafc078bf5aa26c105382b">lo_type</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Type of an object.  <a href="#ab8b1070ca6fafc078bf5aa26c105382b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlov__object.html#a727ffe65ad9258f29f0b9849013dea55">lo_layout_invalid</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True if layout is invalid.  <a href="#a727ffe65ad9258f29f0b9849013dea55"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">atomic_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlov__object.html#ad226b54b1209770b9ed33a6c6a36f62c">lo_active_ios</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">How many IOs are on going on this object.  <a href="#ad226b54b1209770b9ed33a6c6a36f62c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">wait_queue_head_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlov__object.html#a134c9f082f0e90422d7a2a84e3289ecd">lo_waitq</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Waitq - wait for no one else is using lo_lsm.  <a href="#a134c9f082f0e90422d7a2a84e3289ecd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlov__stripe__md.html">lov_stripe_md</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlov__object.html#a3c923cc1d7a5577213df50f1940c2be9">lo_lsm</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Layout metadata.  <a href="#a3c923cc1d7a5577213df50f1940c2be9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">union <a class="el" href="unionlov__object_1_1lov__layout__state.html">lov_object::lov_layout_state</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlov__object.html#ae90dc837681e3c81f1daa77fc8d2dce4">u</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct task_struct *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlov__object.html#a3814521c58719ed71173f785659532ac">lo_owner</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Thread that acquired <a class="el" href="structlov__object.html#aab2ef978c79c508d47197c8078abf098" title="Serializes object operations with transitions between layout types.">lov_object::lo_type_guard</a> in an exclusive mode.  <a href="#a3814521c58719ed71173f785659532ac"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>lov-specific file state. </p>
<p>lov object has particular layout type, determining how top-object is built on top of sub-objects. Layout type can change dynamically. When this happens, <a class="el" href="structlov__object.html#aab2ef978c79c508d47197c8078abf098" title="Serializes object operations with transitions between layout types.">lov_object::lo_type_guard</a> semaphore is taken in exclusive mode, all state pertaining to the old layout type is destroyed, and new state is constructed. All object methods take said semaphore in the shared mode, providing serialization against transition between layout types.</p>
<p>To avoid multiple `if' or `switch' statements, selecting behavior for the current layout type, object methods perform double-dispatch, invoking function corresponding to the current layout type. </p>

<p>Definition at line <a class="el" href="lov__cl__internal_8h_source.html#l00187">187</a> of file <a class="el" href="lov__cl__internal_8h_source.html">lov_cl_internal.h</a>.</p>
<hr/><h2>Field Documentation</h2>
<a class="anchor" id="ad226b54b1209770b9ed33a6c6a36f62c"></a><!-- doxytag: member="lov_object::lo_active_ios" ref="ad226b54b1209770b9ed33a6c6a36f62c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">atomic_t <a class="el" href="structlov__object.html#ad226b54b1209770b9ed33a6c6a36f62c">lov_object::lo_active_ios</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>How many IOs are on going on this object. </p>
<p>Layout can be changed only if there is no active IO. </p>

<p>Definition at line <a class="el" href="lov__cl__internal_8h_source.html#l00211">211</a> of file <a class="el" href="lov__cl__internal_8h_source.html">lov_cl_internal.h</a>.</p>

<p>Referenced by <a class="el" href="lov__object_8c_source.html#l00843">lov_conf_set()</a>, <a class="el" href="lov__io_8c_source.html#l00967">lov_empty_io_fini()</a>, <a class="el" href="lov__io_8c_source.html#l00401">lov_io_fini()</a>, <a class="el" href="lov__io_8c_source.html#l01064">lov_io_init_empty()</a>, <a class="el" href="lov__io_8c_source.html#l01042">lov_io_init_raid0()</a>, <a class="el" href="lov__io_8c_source.html#l01104">lov_io_init_released()</a>, <a class="el" href="lov__object_8c_source.html#l00729">lov_layout_change()</a>, <a class="el" href="lov__object_8c_source.html#l00713">lov_layout_wait()</a>, and <a class="el" href="lov__object_8c_source.html#l00802">lov_object_init()</a>.</p>

</div>
</div>
<a class="anchor" id="af6b1712509f232166f9c7eb5c333dcff"></a><!-- doxytag: member="lov_object::lo_cl" ref="af6b1712509f232166f9c7eb5c333dcff" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcl__object.html">cl_object</a> <a class="el" href="structlov__object.html#af6b1712509f232166f9c7eb5c333dcff">lov_object::lo_cl</a><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lov__cl__internal_8h_source.html#l00188">188</a> of file <a class="el" href="lov__cl__internal_8h_source.html">lov_cl_internal.h</a>.</p>

<p>Referenced by <a class="el" href="lov__cl__internal_8h_source.html#l00637">cl2lov()</a>, <a class="el" href="lov__cl__internal_8h_source.html#l00626">lov2cl()</a>, <a class="el" href="lov__cl__internal_8h_source.html#l00621">lov2lu()</a>, <a class="el" href="lov__object_8c_source.html#l00222">lov_init_raid0()</a>, <a class="el" href="lov__object_8c_source.html#l00729">lov_layout_change()</a>, <a class="el" href="lov__object_8c_source.html#l01505">lov_object_alloc()</a>, <a class="el" href="lov__object_8c_source.html#l00046">lov_object_dev()</a>, <a class="el" href="lov__object_8c_source.html#l00206">lov_page_slice_fixup()</a>, <a class="el" href="lovsub__object_8c_source.html#l00118">lovsub_object_glimpse()</a>, <a class="el" href="lovsub__object_8c_source.html#l00133">lovsub_req_attr_set()</a>, and <a class="el" href="lov__cl__internal_8h_source.html#l00631">lu2lov()</a>.</p>

</div>
</div>
<a class="anchor" id="a727ffe65ad9258f29f0b9849013dea55"></a><!-- doxytag: member="lov_object::lo_layout_invalid" ref="a727ffe65ad9258f29f0b9849013dea55" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="structlov__object.html#a727ffe65ad9258f29f0b9849013dea55">lov_object::lo_layout_invalid</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>True if layout is invalid. </p>
<p>This bit is cleared when layout lock is lost. </p>

<p>Definition at line <a class="el" href="lov__cl__internal_8h_source.html#l00206">206</a> of file <a class="el" href="lov__cl__internal_8h_source.html">lov_cl_internal.h</a>.</p>

<p>Referenced by <a class="el" href="lov__object_8c_source.html#l00843">lov_conf_set()</a>, <a class="el" href="lov__object_8c_source.html#l00222">lov_init_raid0()</a>, <a class="el" href="lov__object_8c_source.html#l00135">lov_init_sub()</a>, <a class="el" href="lov__object_8c_source.html#l01530">lov_lsm_addref()</a>, <a class="el" href="lov__object_8c_source.html#l00467">lov_print_empty()</a>, <a class="el" href="lov__object_8c_source.html#l00474">lov_print_raid0()</a>, and <a class="el" href="lov__object_8c_source.html#l00499">lov_print_released()</a>.</p>

</div>
</div>
<a class="anchor" id="a3c923cc1d7a5577213df50f1940c2be9"></a><!-- doxytag: member="lov_object::lo_lsm" ref="a3c923cc1d7a5577213df50f1940c2be9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlov__stripe__md.html">lov_stripe_md</a>* <a class="el" href="structlov__object.html#a3c923cc1d7a5577213df50f1940c2be9">lov_object::lo_lsm</a><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Layout metadata. </p>
<p>NULL if empty layout. </p>

<p>Definition at line <a class="el" href="lov__cl__internal_8h_source.html#l00219">219</a> of file <a class="el" href="lov__cl__internal_8h_source.html">lov_cl_internal.h</a>.</p>

<p>Referenced by <a class="el" href="lov__object_8c_source.html#l00527">lov_attr_get_raid0()</a>, <a class="el" href="lov__object_8c_source.html#l00843">lov_conf_set()</a>, <a class="el" href="lov__object_8c_source.html#l00406">lov_delete_raid0()</a>, <a class="el" href="lov__object_8c_source.html#l00441">lov_fini_raid0()</a>, <a class="el" href="lov__object_8c_source.html#l00458">lov_fini_released()</a>, <a class="el" href="lov__object_8c_source.html#l00222">lov_init_raid0()</a>, <a class="el" href="lov__object_8c_source.html#l00306">lov_init_released()</a>, <a class="el" href="lov__object_8c_source.html#l00135">lov_init_sub()</a>, <a class="el" href="lov__io_8c_source.html#l01104">lov_io_init_released()</a>, <a class="el" href="lov__io_8c_source.html#l00429">lov_io_iter_init()</a>, <a class="el" href="lov__io_8c_source.html#l00631">lov_io_read_ahead()</a>, <a class="el" href="lov__io_8c_source.html#l00480">lov_io_rw_iter_init()</a>, <a class="el" href="lov__io_8c_source.html#l00326">lov_io_slice_init()</a>, <a class="el" href="lov__io_8c_source.html#l00085">lov_io_sub_inherit()</a>, <a class="el" href="lov__io_8c_source.html#l00299">lov_io_subio_init()</a>, <a class="el" href="lov__lock_8c_source.html#l00126">lov_lock_sub_init()</a>, <a class="el" href="lov__object_8c_source.html#l01530">lov_lsm_addref()</a>, <a class="el" href="lov__page_8c_source.html#l00069">lov_page_init_raid0()</a>, <a class="el" href="lov__io_8c_source.html#l00281">lov_page_subio()</a>, <a class="el" href="lov__object_8c_source.html#l00474">lov_print_raid0()</a>, <a class="el" href="lov__object_8c_source.html#l00499">lov_print_released()</a>, <a class="el" href="lov__cl__internal_8h_source.html#l00724">lov_r0()</a>, and <a class="el" href="lov__object_8c_source.html#l01545">lov_read_and_clear_async_rc()</a>.</p>

</div>
</div>
<a class="anchor" id="a3814521c58719ed71173f785659532ac"></a><!-- doxytag: member="lov_object::lo_owner" ref="a3814521c58719ed71173f785659532ac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct task_struct* <a class="el" href="structlov__object.html#a3814521c58719ed71173f785659532ac">lov_object::lo_owner</a><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Thread that acquired <a class="el" href="structlov__object.html#aab2ef978c79c508d47197c8078abf098" title="Serializes object operations with transitions between layout types.">lov_object::lo_type_guard</a> in an exclusive mode. </p>

<p>Definition at line <a class="el" href="lov__cl__internal_8h_source.html#l00268">268</a> of file <a class="el" href="lov__cl__internal_8h_source.html">lov_cl_internal.h</a>.</p>

<p>Referenced by <a class="el" href="lov__object_8c_source.html#l00655">lov_conf_freeze()</a>, <a class="el" href="lov__object_8c_source.html#l00699">lov_conf_lock()</a>, <a class="el" href="lov__object_8c_source.html#l00661">lov_conf_thaw()</a>, and <a class="el" href="lov__object_8c_source.html#l00707">lov_conf_unlock()</a>.</p>

</div>
</div>
<a class="anchor" id="ab8b1070ca6fafc078bf5aa26c105382b"></a><!-- doxytag: member="lov_object::lo_type" ref="ab8b1070ca6fafc078bf5aa26c105382b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__lov.html#ga28761ebc7af42a0c032a063f295c5ffb">lov_layout_type</a> <a class="el" href="structlov__object.html#ab8b1070ca6fafc078bf5aa26c105382b">lov_object::lo_type</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Type of an object. </p>
<p>Protected by <a class="el" href="structlov__object.html#aab2ef978c79c508d47197c8078abf098" title="Serializes object operations with transitions between layout types.">lov_object::lo_type_guard</a>. </p>

<p>Definition at line <a class="el" href="lov__cl__internal_8h_source.html#l00201">201</a> of file <a class="el" href="lov__cl__internal_8h_source.html">lov_cl_internal.h</a>.</p>

<p>Referenced by <a class="el" href="lov__object_8c_source.html#l00350">lov_delete_empty()</a>, <a class="el" href="lov__object_8c_source.html#l00320">lov_find_subobj()</a>, <a class="el" href="lov__object_8c_source.html#l00435">lov_fini_empty()</a>, <a class="el" href="lov__object_8c_source.html#l00729">lov_layout_change()</a>, <a class="el" href="lov__object_8c_source.html#l01505">lov_object_alloc()</a>, <a class="el" href="lov__object_8c_source.html#l00802">lov_object_init()</a>, <a class="el" href="lov__cl__internal_8h_source.html#l00724">lov_r0()</a>, <a class="el" href="lov__object_8c_source.html#l01545">lov_read_and_clear_async_rc()</a>, and <a class="el" href="lovsub__object_8c_source.html#l00077">lovsub_object_free()</a>.</p>

</div>
</div>
<a class="anchor" id="aab2ef978c79c508d47197c8078abf098"></a><!-- doxytag: member="lov_object::lo_type_guard" ref="aab2ef978c79c508d47197c8078abf098" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct rw_semaphore <a class="el" href="structlov__object.html#aab2ef978c79c508d47197c8078abf098">lov_object::lo_type_guard</a><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Serializes object operations with transitions between layout types. </p>
<p>This semaphore is taken in shared mode by all object methods, and is taken in exclusive mode when object type is changed.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="structlov__object.html#ab8b1070ca6fafc078bf5aa26c105382b" title="Type of an object.">lov_object::lo_type</a> </dd></dl>

<p>Definition at line <a class="el" href="lov__cl__internal_8h_source.html#l00197">197</a> of file <a class="el" href="lov__cl__internal_8h_source.html">lov_cl_internal.h</a>.</p>

<p>Referenced by <a class="el" href="lov__object_8c_source.html#l00655">lov_conf_freeze()</a>, <a class="el" href="lov__object_8c_source.html#l00699">lov_conf_lock()</a>, <a class="el" href="lov__object_8c_source.html#l00661">lov_conf_thaw()</a>, <a class="el" href="lov__object_8c_source.html#l00707">lov_conf_unlock()</a>, and <a class="el" href="lov__object_8c_source.html#l00802">lov_object_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a134c9f082f0e90422d7a2a84e3289ecd"></a><!-- doxytag: member="lov_object::lo_waitq" ref="a134c9f082f0e90422d7a2a84e3289ecd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">wait_queue_head_t <a class="el" href="structlov__object.html#a134c9f082f0e90422d7a2a84e3289ecd">lov_object::lo_waitq</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Waitq - wait for no one else is using lo_lsm. </p>

<p>Definition at line <a class="el" href="lov__cl__internal_8h_source.html#l00215">215</a> of file <a class="el" href="lov__cl__internal_8h_source.html">lov_cl_internal.h</a>.</p>

<p>Referenced by <a class="el" href="lov__io_8c_source.html#l00967">lov_empty_io_fini()</a>, <a class="el" href="lov__io_8c_source.html#l00401">lov_io_fini()</a>, <a class="el" href="lov__object_8c_source.html#l00713">lov_layout_wait()</a>, and <a class="el" href="lov__object_8c_source.html#l00802">lov_object_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ae90dc837681e3c81f1daa77fc8d2dce4"></a><!-- doxytag: member="lov_object::u" ref="ae90dc837681e3c81f1daa77fc8d2dce4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">union <a class="el" href="unionlov__object_1_1lov__layout__state.html">lov_object::lov_layout_state</a>  <a class="el" href="structlov__object.html#ae90dc837681e3c81f1daa77fc8d2dce4">lov_object::u</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="lov__object_8c_source.html#l00729">lov_layout_change()</a>, <a class="el" href="lov__object_8c_source.html#l00905">lov_object_delete()</a>, <a class="el" href="lov__object_8c_source.html#l00914">lov_object_free()</a>, <a class="el" href="lov__object_8c_source.html#l00802">lov_object_init()</a>, <a class="el" href="lov__cl__internal_8h_source.html#l00724">lov_r0()</a>, <a class="el" href="lov__object_8c_source.html#l00359">lov_subobject_kill()</a>, and <a class="el" href="lovsub__object_8c_source.html#l00077">lovsub_object_free()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>lustre/lov/<a class="el" href="lov__cl__internal_8h_source.html">lov_cl_internal.h</a></li>
</ul>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:53 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
