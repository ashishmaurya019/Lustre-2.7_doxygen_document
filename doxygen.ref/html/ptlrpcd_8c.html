<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/ptlrpc/ptlrpcd.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/ptlrpc/ptlrpcd.c File Reference</h1><code>#include &lt;linux/kthread.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="libcfs_8h_source.html">libcfs/libcfs.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__net_8h_source.html">lustre_net.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__lib_8h_source.html">lustre_lib.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__ha_8h_source.html">lustre_ha.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__class_8h_source.html">obd_class.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__support_8h_source.html">obd_support.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="cl__object_8h_source.html">cl_object.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lprocfs__status_8h_source.html">lprocfs_status.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="ptlrpc__internal_8h_source.html">ptlrpc_internal.h</a>&quot;</code><br/>

<p><a href="ptlrpcd_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpcd.html">ptlrpcd</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gabda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>&nbsp;&nbsp;&nbsp;S_RPC</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga04063a22d0ab5f2c0df443b03402f9fa">module_param</a> (<a class="el" href="group__ptlrpcd.html#gaa2d648d41351bca341d06dbbfc8cb8cd">max_ptlrpcds</a>, int, 0644)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga5d8f1182b8a0638f8c35a9e48c44f3db">MODULE_PARM_DESC</a> (<a class="el" href="group__ptlrpcd.html#gaa2d648d41351bca341d06dbbfc8cb8cd">max_ptlrpcds</a>,&quot;Max <a class="el" href="structptlrpcd.html">ptlrpcd</a> <a class="el" href="obd_8c.html#a20057145635eb007e0621c11bc2d7176">thread</a> count to be started.&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga1cff15935a0a23c6d5234d16a3a282d1">module_param</a> (<a class="el" href="group__ptlrpcd.html#ga8996b8c047045d33194d9e06a0cbfa8d">ptlrpcd_bind_policy</a>, int, 0644)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gaace70b4794d14cf0451d150068a47ad6">MODULE_PARM_DESC</a> (<a class="el" href="group__ptlrpcd.html#ga8996b8c047045d33194d9e06a0cbfa8d">ptlrpcd_bind_policy</a>,&quot;Ptlrpcd threads binding <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a> (obsolete).&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga880b4abe7ea4dee766b81450cf56d06d">MODULE_PARM_DESC</a> (<a class="el" href="group__ptlrpcd.html#ga8bf56da50f49fb9cc7c0bc52bc8e78eb">ptlrpcd_per_cpt_max</a>,&quot;Max <a class="el" href="structptlrpcd.html">ptlrpcd</a> <a class="el" href="obd_8c.html#a20057145635eb007e0621c11bc2d7176">thread</a> count to be started per cpt.&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga05cb73fd5f563bdc305d09aa0c4c4f8f">module_param</a> (<a class="el" href="group__ptlrpcd.html#ga93b98f6cd43f50f5c001464b4d516613">ptlrpcd_partner_group_size</a>, int, 0644)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gadc465e27776c4c8e26953f06b831089f">MODULE_PARM_DESC</a> (<a class="el" href="group__ptlrpcd.html#ga93b98f6cd43f50f5c001464b4d516613">ptlrpcd_partner_group_size</a>,&quot;Number of <a class="el" href="structptlrpcd.html">ptlrpcd</a> threads in a partner group.&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga6d81978a6dd9a0bcaefc3ce49d499dee">module_param</a> (<a class="el" href="group__ptlrpcd.html#ga39ee00fea2c30128a7f73313dd863a6e">ptlrpcd_cpts</a>, charp, 0644)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gafa7e8027b148e5cdf3e97c5b992cb656">MODULE_PARM_DESC</a> (<a class="el" href="group__ptlrpcd.html#ga39ee00fea2c30128a7f73313dd863a6e">ptlrpcd_cpts</a>,&quot;CPU partitions <a class="el" href="structptlrpcd.html">ptlrpcd</a> threads should run in&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga2acfae9e6349420190608a611125bb78">ptlrpcd_wake</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structptlrpcd__ctl.html">ptlrpcd_ctl</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gabcd085253aea52532fca8a4f6ae05d7c">ptlrpcd_select_pc</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga8786798db7200aeedbfe4cd0a855232f">ptlrpcd_add_rqset</a> (struct <a class="el" href="structptlrpc__request__set.html">ptlrpc_request_set</a> *set)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Move all request from an existing request set to the <a class="el" href="structptlrpcd.html">ptlrpcd</a> queue.  <a href="group__ptlrpcd.html#ga8786798db7200aeedbfe4cd0a855232f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga1cddf9869def1f66fd29dae1f5d877f6">ptlrpcd_steal_rqset</a> (struct <a class="el" href="structptlrpc__request__set.html">ptlrpc_request_set</a> *des, struct <a class="el" href="structptlrpc__request__set.html">ptlrpc_request_set</a> *src)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return transferred RPCs count.  <a href="group__ptlrpcd.html#ga1cddf9869def1f66fd29dae1f5d877f6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gad8a1fd19f62cb6e52ee2b145c63f5dd1">ptlrpcd_add_req</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Requests that are added to the <a class="el" href="structptlrpcd.html">ptlrpcd</a> queue are sent via ptlrpcd_check-&gt;<a class="el" href="group__net.html#ga63613680c8953223c8efc4331656b11a" title="this sends any unsent RPCs in set and returns 1 if all are sent and no more replies...">ptlrpc_check_set()</a>.  <a href="group__ptlrpcd.html#gad8a1fd19f62cb6e52ee2b145c63f5dd1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gad58ba78046465270e42ffa47d11f4d7e">ptlrpc_reqset_get</a> (struct <a class="el" href="structptlrpc__request__set.html">ptlrpc_request_set</a> *set)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga1a5f6f050d58107722206e6d2e651cbd">ptlrpcd_check</a> (struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structptlrpcd__ctl.html">ptlrpcd_ctl</a> *pc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if there is more work to do on <a class="el" href="structptlrpcd.html">ptlrpcd</a> set.  <a href="group__ptlrpcd.html#ga1a5f6f050d58107722206e6d2e651cbd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga9f9a9070ef2ee141f96e15a2512be310">ptlrpcd</a> (void *arg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Main <a class="el" href="structptlrpcd.html">ptlrpcd</a> thread.  <a href="group__ptlrpcd.html#ga9f9a9070ef2ee141f96e15a2512be310"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gac8b793ed162ef61c41412704f68f7f3f">ptlrpcd_ctl_init</a> (struct <a class="el" href="structptlrpcd__ctl.html">ptlrpcd_ctl</a> *pc, int index, int cpt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga764145e94d8f4420766ad10bfbc1adfe">ptlrpcd_partners</a> (struct <a class="el" href="structptlrpcd.html">ptlrpcd</a> *pd, int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga92e1290b388e5bd6c5ae97f5c753589a">ptlrpcd_start</a> (struct <a class="el" href="structptlrpcd__ctl.html">ptlrpcd_ctl</a> *pc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gadf6c0a253a44e1a561d3650cafa0aeab">ptlrpcd_stop</a> (struct <a class="el" href="structptlrpcd__ctl.html">ptlrpcd_ctl</a> *pc, int force)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gad8ef02e8c2a1c0621b003d24cd5975c4">ptlrpcd_free</a> (struct <a class="el" href="structptlrpcd__ctl.html">ptlrpcd_ctl</a> *pc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga173deb041e269c0a7947472f6531f896">ptlrpcd_fini</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gaebe808422bac6e9eb036cf569e852fe4">ptlrpcd_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga2b4cdaf9bce76784e8efa1f9bda8c58b">ptlrpcd_addref</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga54a4bcf408e22400c741b530bbb8ec06">ptlrpcd_decref</a> (void)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gaa2d648d41351bca341d06dbbfc8cb8cd">max_ptlrpcds</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga8996b8c047045d33194d9e06a0cbfa8d">ptlrpcd_bind_policy</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga8bf56da50f49fb9cc7c0bc52bc8e78eb">ptlrpcd_per_cpt_max</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga93b98f6cd43f50f5c001464b4d516613">ptlrpcd_partner_group_size</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga39ee00fea2c30128a7f73313dd863a6e">ptlrpcd_cpts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gaaa33d3a9af24cd317ab8fc6de2da819a">ptlrpcds_cpt_idx</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga017ff18bbbf12192cf2b330e12a7bf49">ptlrpcds_num</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structptlrpcd.html">ptlrpcd</a> **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gacf5cc1f3f7e39c237392469db7f89d2f">ptlrpcds</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structptlrpcd__ctl.html">ptlrpcd_ctl</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga550d33725a6034d2b73ee1ac87e7b087">ptlrpcd_rcv</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct mutex&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#ga7723c3e0086e4476292c06bb0fa8db00">ptlrpcd_mutex</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ptlrpcd.html#gab1e1324450eb18f953c4131b03edcc80">ptlrpcd_users</a> = 0</td></tr>
</table>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:50 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
