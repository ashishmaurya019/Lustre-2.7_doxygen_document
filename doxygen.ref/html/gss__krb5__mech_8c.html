<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/ptlrpc/gss/gss_krb5_mech.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/ptlrpc/gss/gss_krb5_mech.c File Reference</h1><code>#include &lt;linux/init.h&gt;</code><br/>
<code>#include &lt;linux/module.h&gt;</code><br/>
<code>#include &lt;linux/slab.h&gt;</code><br/>
<code>#include &lt;linux/crypto.h&gt;</code><br/>
<code>#include &lt;linux/mutex.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd_8h_source.html">obd.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__class_8h_source.html">obd_class.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__support_8h_source.html">obd_support.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__idl_8h_source.html">lustre/lustre_idl.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__net_8h_source.html">lustre_net.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__import_8h_source.html">lustre_import.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__sec_8h_source.html">lustre_sec.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="gss__err_8h_source.html">gss_err.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gss__internal_8h_source.html">gss_internal.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gss__api_8h_source.html">gss_api.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gss__asn1_8h_source.html">gss_asn1.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gss__krb5_8h_source.html">gss_krb5.h</a>&quot;</code><br/>

<p><a href="gss__krb5__mech_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkrb5__enctype.html">krb5_enctype</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>&nbsp;&nbsp;&nbsp;S_SEC</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a1f7c76c630a195f602026fd6f87b1c8e">MAX_ENCTYPES</a>&nbsp;&nbsp;&nbsp;sizeof(<a class="el" href="gss__krb5__mech_8c.html#a621d404de65285bbad64601c442c7a3b">enctypes</a>)/sizeof(struct <a class="el" href="structkrb5__enctype.html">krb5_enctype</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#ab8ab2005c9f500180c58cfe0cc829b7c">KRB5_CTX_FLAG_INITIATOR</a>&nbsp;&nbsp;&nbsp;0x00000001</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a3e71ff40cfd36bdef5b1f702f79b96b6">KRB5_CTX_FLAG_CFX</a>&nbsp;&nbsp;&nbsp;0x00000002</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a7e342fcab199a5b145cadb49309de7b4">KRB5_CTX_FLAG_ACCEPTOR_SUBKEY</a>&nbsp;&nbsp;&nbsp;0x00000004</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a2b0bc8e0636d465d99beda03fb13e146">enctype2str</a> (__u32 enctype)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#adf9e73412cda4eb68605bc594c048437">keyblock_init</a> (struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *kb, char *alg_name, int alg_mode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a162d6b993e310fee9c130e55dd202648">krb5_init_keys</a> (struct <a class="el" href="structkrb5__ctx.html">krb5_ctx</a> *kctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a5e6734889a631395daf019f575ebe7cc">keyblock_free</a> (struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *kb)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a99114d7894b874df58e600b876681c21">keyblock_dup</a> (struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *new, struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *kb)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a299b358ed8c2f34ce679952f1b1bc220">get_bytes</a> (char **ptr, const char *end, void *res, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#aa854e7aa842791eb8939f7fa9125a1e7">get_rawobj</a> (char **ptr, const char *end, <a class="el" href="structrawobj__s.html">rawobj_t</a> *res)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a75281ad46502bd4cc73df0ed17e18583">get_keyblock</a> (char **ptr, const char *end, struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *kb, __u32 keysize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a9861896dacf34d88412280e3dbafdd6f">delete_context_kerberos</a> (struct <a class="el" href="structkrb5__ctx.html">krb5_ctx</a> *kctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a83559422d05ee726c4419ea5fb4e43ea">import_context_rfc1964</a> (struct <a class="el" href="structkrb5__ctx.html">krb5_ctx</a> *kctx, char *p, char *end)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a3b29874f1fac98abd1f1c17e5094aa6c">import_context_rfc4121</a> (struct <a class="el" href="structkrb5__ctx.html">krb5_ctx</a> *kctx, char *p, char *end)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a99de25d936e6fcf33993c03fc672b8e2">gss_import_sec_context_kerberos</a> (<a class="el" href="structrawobj__s.html">rawobj_t</a> *inbuf, struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *gctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#ac50a1797a3a065370026c14bd3b10c22">gss_copy_reverse_context_kerberos</a> (struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *gctx, struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *gctx_new)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a5fca2c874c8e5941c7b38613a3472d77">gss_inquire_context_kerberos</a> (struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *gctx, unsigned long *endtime)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#ad7af5fb9e6e5480090b13df1cd393f31">gss_delete_sec_context_kerberos</a> (void *internal_ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a382c7545d0f7d2c6c8af0e075b69e413">setup_sgtable</a> (struct sg_table *sgt, struct scatterlist *prealloc_sg, const void *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, unsigned int buf_len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#ad065505ba7c40de30c5a976f5ed3cf88">teardown_sgtable</a> (struct sg_table *sgt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a1a20df8e3fa0b29bd957c12a532df621">krb5_encrypt</a> (struct crypto_blkcipher *tfm, int decrypt, void *iv, void *in, void *out, int length)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a238b668e45926472d3aa71e2b258e444">krb5_digest_hmac</a> (struct crypto_hash *tfm, <a class="el" href="structrawobj__s.html">rawobj_t</a> *key, struct <a class="el" href="structkrb5__header.html">krb5_header</a> *khdr, int msgcnt, <a class="el" href="structrawobj__s.html">rawobj_t</a> *msgs, int iovcnt, <a class="el" href="structlnet__kiov__t.html">lnet_kiov_t</a> *iovs, <a class="el" href="structrawobj__s.html">rawobj_t</a> *<a class="el" href="o2iblnd__modparams_8c.html#a4f533d7ca3de0b7d7ecc95de785b4d2c">cksum</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a63ecc35461e7bcc575d163255f02f46a">krb5_digest_norm</a> (struct crypto_hash *tfm, struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *kb, struct <a class="el" href="structkrb5__header.html">krb5_header</a> *khdr, int msgcnt, <a class="el" href="structrawobj__s.html">rawobj_t</a> *msgs, int iovcnt, <a class="el" href="structlnet__kiov__t.html">lnet_kiov_t</a> *iovs, <a class="el" href="structrawobj__s.html">rawobj_t</a> *<a class="el" href="o2iblnd__modparams_8c.html#a4f533d7ca3de0b7d7ecc95de785b4d2c">cksum</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __s32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a3f4c7e44f83537665182f971f20640fa">krb5_make_checksum</a> (__u32 enctype, struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *kb, struct <a class="el" href="structkrb5__header.html">krb5_header</a> *khdr, int msgcnt, <a class="el" href="structrawobj__s.html">rawobj_t</a> *msgs, int iovcnt, <a class="el" href="structlnet__kiov__t.html">lnet_kiov_t</a> *iovs, <a class="el" href="structrawobj__s.html">rawobj_t</a> *<a class="el" href="o2iblnd__modparams_8c.html#a4f533d7ca3de0b7d7ecc95de785b4d2c">cksum</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a74a94c0036d7bc506f76605379fa65da">fill_krb5_header</a> (struct <a class="el" href="structkrb5__ctx.html">krb5_ctx</a> *kctx, struct <a class="el" href="structkrb5__header.html">krb5_header</a> *khdr, int privacy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#adff0bd7680776627e5cb6a2c47c2ce87">verify_krb5_header</a> (struct <a class="el" href="structkrb5__ctx.html">krb5_ctx</a> *kctx, struct <a class="el" href="structkrb5__header.html">krb5_header</a> *khdr, int privacy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a6256894bd01c88b06dc4f047a0ee524f">gss_get_mic_kerberos</a> (struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *gctx, int msgcnt, <a class="el" href="structrawobj__s.html">rawobj_t</a> *msgs, int iovcnt, <a class="el" href="structlnet__kiov__t.html">lnet_kiov_t</a> *iovs, <a class="el" href="structrawobj__s.html">rawobj_t</a> *token)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a73c5277c06913279f6b81098f636f27b">gss_verify_mic_kerberos</a> (struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *gctx, int msgcnt, <a class="el" href="structrawobj__s.html">rawobj_t</a> *msgs, int iovcnt, <a class="el" href="structlnet__kiov__t.html">lnet_kiov_t</a> *iovs, <a class="el" href="structrawobj__s.html">rawobj_t</a> *token)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a277a72802862ea0faa828449f0813d20">add_padding</a> (<a class="el" href="structrawobj__s.html">rawobj_t</a> *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, int msg_buflen, int blocksize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#ab164118f879bec2558d0fca6556864a9">krb5_encrypt_rawobjs</a> (struct crypto_blkcipher *tfm, int mode_ecb, int inobj_cnt, <a class="el" href="structrawobj__s.html">rawobj_t</a> *inobjs, <a class="el" href="structrawobj__s.html">rawobj_t</a> *outobj, int enc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#aaa90d394eea18d82f33e0cc172df01c3">krb5_encrypt_bulk</a> (struct crypto_blkcipher *tfm, struct <a class="el" href="structkrb5__header.html">krb5_header</a> *khdr, char *confounder, struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *desc, <a class="el" href="structrawobj__s.html">rawobj_t</a> *cipher, int adj_nob)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#ab4f1bfb8fa0f71672f5d98d7c7f84107">krb5_decrypt_bulk</a> (struct crypto_blkcipher *tfm, struct <a class="el" href="structkrb5__header.html">krb5_header</a> *khdr, struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *desc, <a class="el" href="structrawobj__s.html">rawobj_t</a> *cipher, <a class="el" href="structrawobj__s.html">rawobj_t</a> *plain, int adj_nob)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#ab20e27aa6836da0665e263f4debbf4c8">gss_wrap_kerberos</a> (struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *gctx, <a class="el" href="structrawobj__s.html">rawobj_t</a> *gsshdr, <a class="el" href="structrawobj__s.html">rawobj_t</a> *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, int msg_buflen, <a class="el" href="structrawobj__s.html">rawobj_t</a> *token)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a61abda37c9a7a846a336db503dfabf47">gss_prep_bulk_kerberos</a> (struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *gctx, struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *desc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a4eae963cb8dee97b0e94d210783c422d">gss_wrap_bulk_kerberos</a> (struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *gctx, struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *desc, <a class="el" href="structrawobj__s.html">rawobj_t</a> *token, int adj_nob)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a2a821e3506bf97b662ec6e020066c1dc">gss_unwrap_kerberos</a> (struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *gctx, <a class="el" href="structrawobj__s.html">rawobj_t</a> *gsshdr, <a class="el" href="structrawobj__s.html">rawobj_t</a> *token, <a class="el" href="structrawobj__s.html">rawobj_t</a> *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#afd7cf7c3476740e7741bd16c6bbed199">gss_unwrap_bulk_kerberos</a> (struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *gctx, struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *desc, <a class="el" href="structrawobj__s.html">rawobj_t</a> *token, int adj_nob)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a8ea854c10d5ff1e57d382998a0d7f641">gss_display_kerberos</a> (struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *ctx, char *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, int <a class="el" href="multiop_8c.html#a199ab88d4ca8eab30e1cb7d35edacca5">bufsize</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int __init&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a72f7a3103bb07011441f7302717f901e">init_kerberos_module</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a6aa1f87c49d05abd3a3fd5f0a38084dc">cleanup_kerberos_module</a> (void)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static spinlock_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#abd1ae143efca0bdaa2f183871b649061">krb5_seq_lock</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structkrb5__enctype.html">krb5_enctype</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a621d404de65285bbad64601c442c7a3b">enctypes</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structgss__api__ops.html">gss_api_ops</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#aa74e0849d21dc694b9a811dd6f770d5c">gss_kerberos_ops</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structsubflavor__desc.html">subflavor_desc</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#a0a67655841b4bc609ae5fa7bb105d19f">gss_kerberos_sfs</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structgss__api__mech.html">gss_api_mech</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gss__krb5__mech_8c.html#ac70554525a18ff9f598e237238c2b9ae">gss_kerberos_mech</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="abda60744d497fcfe370cfd6b2d65c7ed"></a><!-- doxytag: member="gss_krb5_mech.c::DEBUG_SUBSYSTEM" ref="abda60744d497fcfe370cfd6b2d65c7ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_SUBSYSTEM&nbsp;&nbsp;&nbsp;S_SEC</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00051">51</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7e342fcab199a5b145cadb49309de7b4"></a><!-- doxytag: member="gss_krb5_mech.c::KRB5_CTX_FLAG_ACCEPTOR_SUBKEY" ref="a7e342fcab199a5b145cadb49309de7b4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KRB5_CTX_FLAG_ACCEPTOR_SUBKEY&nbsp;&nbsp;&nbsp;0x00000004</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00353">353</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00356">import_context_rfc4121()</a>.</p>

</div>
</div>
<a class="anchor" id="a3e71ff40cfd36bdef5b1f702f79b96b6"></a><!-- doxytag: member="gss_krb5_mech.c::KRB5_CTX_FLAG_CFX" ref="a3e71ff40cfd36bdef5b1f702f79b96b6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KRB5_CTX_FLAG_CFX&nbsp;&nbsp;&nbsp;0x00000002</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00352">352</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00356">import_context_rfc4121()</a>.</p>

</div>
</div>
<a class="anchor" id="ab8ab2005c9f500180c58cfe0cc829b7c"></a><!-- doxytag: member="gss_krb5_mech.c::KRB5_CTX_FLAG_INITIATOR" ref="ab8ab2005c9f500180c58cfe0cc829b7c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KRB5_CTX_FLAG_INITIATOR&nbsp;&nbsp;&nbsp;0x00000001</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00351">351</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00356">import_context_rfc4121()</a>.</p>

</div>
</div>
<a class="anchor" id="a1f7c76c630a195f602026fd6f87b1c8e"></a><!-- doxytag: member="gss_krb5_mech.c::MAX_ENCTYPES" ref="a1f7c76c630a195f602026fd6f87b1c8e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_ENCTYPES&nbsp;&nbsp;&nbsp;sizeof(<a class="el" href="gss__krb5__mech_8c.html#a621d404de65285bbad64601c442c7a3b">enctypes</a>)/sizeof(struct <a class="el" href="structkrb5__enctype.html">krb5_enctype</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00137">137</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00139">enctype2str()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00167">krb5_init_keys()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a277a72802862ea0faa828449f0813d20"></a><!-- doxytag: member="gss_krb5_mech.c::add_padding" ref="a277a72802862ea0faa828449f0813d20" args="(rawobj_t *msg, int msg_buflen, int blocksize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int add_padding </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msg_buflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>blocksize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00956">956</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, and <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l01344">gss_wrap_kerberos()</a>.</p>

</div>
</div>
<a class="anchor" id="a6aa1f87c49d05abd3a3fd5f0a38084dc"></a><!-- doxytag: member="gss_krb5_mech.c::cleanup_kerberos_module" ref="a6aa1f87c49d05abd3a3fd5f0a38084dc" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cleanup_kerberos_module </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01972">1972</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="gss__mech__switch_8c_source.html#l00076">lgss_mech_unregister()</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02932">sptlrpc_gss_exit()</a>, and <a class="el" href="sec__gss_8c_source.html#l02872">sptlrpc_gss_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a9861896dacf34d88412280e3dbafdd6f"></a><!-- doxytag: member="gss_krb5_mech.c::delete_context_kerberos" ref="a9861896dacf34d88412280e3dbafdd6f" args="(struct krb5_ctx *kctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void delete_context_kerberos </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkrb5__ctx.html">krb5_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>kctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00267">267</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="gss__krb5_8h_source.html#l00093">krb5_ctx::kc_keyc</a>, <a class="el" href="gss__krb5_8h_source.html#l00091">krb5_ctx::kc_keye</a>, <a class="el" href="gss__krb5_8h_source.html#l00092">krb5_ctx::kc_keyi</a>, <a class="el" href="gss__krb5_8h_source.html#l00094">krb5_ctx::kc_mech_used</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00196">keyblock_free()</a>, and <a class="el" href="gss__rawobj_8c_source.html#l00076">rawobj_free()</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00463">gss_copy_reverse_context_kerberos()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00517">gss_delete_sec_context_kerberos()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00418">gss_import_sec_context_kerberos()</a>.</p>

</div>
</div>
<a class="anchor" id="a2b0bc8e0636d465d99beda03fb13e146"></a><!-- doxytag: member="gss_krb5_mech.c::enctype2str" ref="a2b0bc8e0636d465d99beda03fb13e146" args="(__u32 enctype)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static const char* enctype2str </td>
          <td>(</td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>enctype</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00139">139</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="gss__krb5__mech_8c_source.html#l00075">krb5_enctype::ke_dispname</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00137">MAX_ENCTYPES</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l01893">gss_display_kerberos()</a>.</p>

</div>
</div>
<a class="anchor" id="a74a94c0036d7bc506f76605379fa65da"></a><!-- doxytag: member="gss_krb5_mech.c::fill_krb5_header" ref="a74a94c0036d7bc506f76605379fa65da" args="(struct krb5_ctx *kctx, struct krb5_header *khdr, int privacy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void fill_krb5_header </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkrb5__ctx.html">krb5_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>kctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkrb5__header.html">krb5_header</a> *&nbsp;</td>
          <td class="paramname"> <em>khdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>privacy</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00803">803</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="byteorder_8h_source.html#l00062">cpu_to_be16</a>, <a class="el" href="byteorder_8h_source.html#l00066">cpu_to_be64</a>, <a class="el" href="gss__krb5_8h_source.html#l00062">FLAG_SENDER_IS_ACCEPTOR</a>, <a class="el" href="gss__krb5_8h_source.html#l00063">FLAG_WRAP_CONFIDENTIAL</a>, <a class="el" href="gss__krb5_8h_source.html#l00082">krb5_ctx::kc_initiate</a>, <a class="el" href="gss__krb5_8h_source.html#l00088">krb5_ctx::kc_seq_send</a>, <a class="el" href="gss__krb5_8h_source.html#l00059">KG_TOK_MIC_MSG</a>, <a class="el" href="gss__krb5_8h_source.html#l00060">KG_TOK_WRAP_MSG</a>, <a class="el" href="gss__krb5_8h_source.html#l00070">krb5_header::kh_ec</a>, <a class="el" href="gss__krb5_8h_source.html#l00069">krb5_header::kh_filler</a>, <a class="el" href="gss__krb5_8h_source.html#l00068">krb5_header::kh_flags</a>, <a class="el" href="gss__krb5_8h_source.html#l00071">krb5_header::kh_rrc</a>, <a class="el" href="gss__krb5_8h_source.html#l00072">krb5_header::kh_seq</a>, <a class="el" href="gss__krb5_8h_source.html#l00067">krb5_header::kh_tok_id</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00072">krb5_seq_lock</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00872">gss_get_mic_kerberos()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l01522">gss_wrap_bulk_kerberos()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l01344">gss_wrap_kerberos()</a>.</p>

</div>
</div>
<a class="anchor" id="a299b358ed8c2f34ce679952f1b1bc220"></a><!-- doxytag: member="gss_krb5_mech.c::get_bytes" ref="a299b358ed8c2f34ce679952f1b1bc220" args="(char **ptr, const char *end, void *res, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int get_bytes </td>
          <td>(</td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00210">210</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00247">get_keyblock()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00223">get_rawobj()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00418">gss_import_sec_context_kerberos()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00277">import_context_rfc1964()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00356">import_context_rfc4121()</a>.</p>

</div>
</div>
<a class="anchor" id="a75281ad46502bd4cc73df0ed17e18583"></a><!-- doxytag: member="gss_krb5_mech.c::get_keyblock" ref="a75281ad46502bd4cc73df0ed17e18583" args="(char **ptr, const char *end, struct krb5_keyblock *kb, __u32 keysize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int get_keyblock </td>
          <td>(</td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *&nbsp;</td>
          <td class="paramname"> <em>kb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>keysize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00247">247</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="parallel__grouplock_8c_source.html#l00078">buf</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00210">get_bytes()</a>, <a class="el" href="gss__krb5_8h_source.html#l00077">krb5_keyblock::kb_key</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, and <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00277">import_context_rfc1964()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00356">import_context_rfc4121()</a>.</p>

</div>
</div>
<a class="anchor" id="aa854e7aa842791eb8939f7fa9125a1e7"></a><!-- doxytag: member="gss_krb5_mech.c::get_rawobj" ref="aa854e7aa842791eb8939f7fa9125a1e7" args="(char **ptr, const char *end, rawobj_t *res)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int get_rawobj </td>
          <td>(</td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>res</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00223">223</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00210">get_bytes()</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, and <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00277">import_context_rfc1964()</a>.</p>

</div>
</div>
<a class="anchor" id="ac50a1797a3a065370026c14bd3b10c22"></a><!-- doxytag: member="gss_krb5_mech.c::gss_copy_reverse_context_kerberos" ref="ac50a1797a3a065370026c14bd3b10c22" args="(struct gss_ctx *gctx, struct gss_ctx *gctx_new)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 gss_copy_reverse_context_kerberos </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx_new</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00463">463</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00267">delete_context_kerberos()</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="gss__api_8h_source.html#l00027">gss_ctx::internal_ctx_id</a>, <a class="el" href="gss__krb5_8h_source.html#l00082">krb5_ctx::kc_cfx</a>, <a class="el" href="gss__krb5_8h_source.html#l00090">krb5_ctx::kc_enctype</a>, <a class="el" href="gss__krb5_8h_source.html#l00086">krb5_ctx::kc_endtime</a>, <a class="el" href="gss__krb5_8h_source.html#l00082">krb5_ctx::kc_have_acceptor_subkey</a>, <a class="el" href="gss__krb5_8h_source.html#l00082">krb5_ctx::kc_initiate</a>, <a class="el" href="gss__krb5_8h_source.html#l00093">krb5_ctx::kc_keyc</a>, <a class="el" href="gss__krb5_8h_source.html#l00091">krb5_ctx::kc_keye</a>, <a class="el" href="gss__krb5_8h_source.html#l00092">krb5_ctx::kc_keyi</a>, <a class="el" href="gss__krb5_8h_source.html#l00094">krb5_ctx::kc_mech_used</a>, <a class="el" href="gss__krb5_8h_source.html#l00087">krb5_ctx::kc_seed</a>, <a class="el" href="gss__krb5_8h_source.html#l00082">krb5_ctx::kc_seed_init</a>, <a class="el" href="gss__krb5_8h_source.html#l00089">krb5_ctx::kc_seq_recv</a>, <a class="el" href="gss__krb5_8h_source.html#l00088">krb5_ctx::kc_seq_send</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00204">keyblock_dup()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00167">krb5_init_keys()</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, and <a class="el" href="gss__rawobj_8c_source.html#l00097">rawobj_dup()</a>.</p>

</div>
</div>
<a class="anchor" id="ad7af5fb9e6e5480090b13df1cd393f31"></a><!-- doxytag: member="gss_krb5_mech.c::gss_delete_sec_context_kerberos" ref="ad7af5fb9e6e5480090b13df1cd393f31" args="(void *internal_ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void gss_delete_sec_context_kerberos </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>internal_ctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00517">517</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="gss__krb5__mech_8c_source.html#l00267">delete_context_kerberos()</a>, and <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>.</p>

</div>
</div>
<a class="anchor" id="a8ea854c10d5ff1e57d382998a0d7f641"></a><!-- doxytag: member="gss_krb5_mech.c::gss_display_kerberos" ref="a8ea854c10d5ff1e57d382998a0d7f641" args="(struct gss_ctx *ctx, char *buf, int bufsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_display_kerberos </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>bufsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01893">1893</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="gss__krb5__mech_8c_source.html#l00139">enctype2str()</a>, <a class="el" href="gss__api_8h_source.html#l00027">gss_ctx::internal_ctx_id</a>, and <a class="el" href="gss__krb5_8h_source.html#l00090">krb5_ctx::kc_enctype</a>.</p>

</div>
</div>
<a class="anchor" id="a6256894bd01c88b06dc4f047a0ee524f"></a><!-- doxytag: member="gss_krb5_mech.c::gss_get_mic_kerberos" ref="a6256894bd01c88b06dc4f047a0ee524f" args="(struct gss_ctx *gctx, int msgcnt, rawobj_t *msgs, int iovcnt, lnet_kiov_t *iovs, rawobj_t *token)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 gss_get_mic_kerberos </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgcnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>msgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>iovcnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlnet__kiov__t.html">lnet_kiov_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iovs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>token</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00872">872</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="o2iblnd__modparams_8c_source.html#l00047">cksum</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00803">fill_krb5_header()</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="gss__api_8h_source.html#l00027">gss_ctx::internal_ctx_id</a>, <a class="el" href="gss__krb5_8h_source.html#l00090">krb5_ctx::kc_enctype</a>, <a class="el" href="gss__krb5_8h_source.html#l00093">krb5_ctx::kc_keyc</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00079">krb5_enctype::ke_hash_size</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00765">krb5_make_checksum()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="gss__internal_8h_source.html#l00031">RAWOBJ_EMPTY</a>, and <a class="el" href="gss__rawobj_8c_source.html#l00076">rawobj_free()</a>.</p>

</div>
</div>
<a class="anchor" id="a99de25d936e6fcf33993c03fc672b8e2"></a><!-- doxytag: member="gss_krb5_mech.c::gss_import_sec_context_kerberos" ref="a99de25d936e6fcf33993c03fc672b8e2" args="(rawobj_t *inbuf, struct gss_ctx *gctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 gss_import_sec_context_kerberos </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>inbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00418">418</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00267">delete_context_kerberos()</a>, <a class="el" href="mdsrate_8c_source.html#l00132">end</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00210">get_bytes()</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00277">import_context_rfc1964()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00356">import_context_rfc4121()</a>, <a class="el" href="gss__api_8h_source.html#l00027">gss_ctx::internal_ctx_id</a>, <a class="el" href="gss__krb5_8h_source.html#l00082">krb5_ctx::kc_initiate</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00167">krb5_init_keys()</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, and <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>.</p>

</div>
</div>
<a class="anchor" id="a5fca2c874c8e5941c7b38613a3472d77"></a><!-- doxytag: member="gss_krb5_mech.c::gss_inquire_context_kerberos" ref="a5fca2c874c8e5941c7b38613a3472d77" args="(struct gss_ctx *gctx, unsigned long *endtime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 gss_inquire_context_kerberos </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&nbsp;</td>
          <td class="paramname"> <em>endtime</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00507">507</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__api_8h_source.html#l00027">gss_ctx::internal_ctx_id</a>, and <a class="el" href="gss__krb5_8h_source.html#l00086">krb5_ctx::kc_endtime</a>.</p>

</div>
</div>
<a class="anchor" id="a61abda37c9a7a846a336db503dfabf47"></a><!-- doxytag: member="gss_krb5_mech.c::gss_prep_bulk_kerberos" ref="a61abda37c9a7a846a336db503dfabf47" args="(struct gss_ctx *gctx, struct ptlrpc_bulk_desc *desc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 gss_prep_bulk_kerberos </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01486">1486</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="lustre__net_8h_source.html#l01487">BD_GET_ENC_KIOV</a>, <a class="el" href="lustre__net_8h_source.html#l01485">BD_GET_KIOV</a>, <a class="el" href="lustre__net_8h_source.html#l01453">ptlrpc_bulk_desc::bd_iov_count</a>, <a class="el" href="lustre__net_8h_source.html#l01442">ptlrpc_bulk_desc::bd_type</a>, <a class="el" href="osd__iam__lvar_8c_source.html#l00084">blocksize()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="lustre__net_8h_source.html#l01486">GET_ENC_KIOV</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="gss__api_8h_source.html#l00027">gss_ctx::internal_ctx_id</a>, <a class="el" href="gss__krb5_8h_source.html#l00078">krb5_keyblock::kb_tfm</a>, <a class="el" href="gss__krb5_8h_source.html#l00091">krb5_ctx::kc_keye</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, and <a class="el" href="lustre__net_8h_source.html#l01375">ptlrpc_is_bulk_desc_kiov()</a>.</p>

</div>
</div>
<a class="anchor" id="afd7cf7c3476740e7741bd16c6bbed199"></a><!-- doxytag: member="gss_krb5_mech.c::gss_unwrap_bulk_kerberos" ref="afd7cf7c3476740e7741bd16c6bbed199" args="(struct gss_ctx *gctx, struct ptlrpc_bulk_desc *desc, rawobj_t *token, int adj_nob)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 gss_unwrap_bulk_kerberos </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>adj_nob</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01801">1801</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="lustre__net_8h_source.html#l01453">ptlrpc_bulk_desc::bd_iov_count</a>, <a class="el" href="lustre__net_8h_source.html#l01442">ptlrpc_bulk_desc::bd_type</a>, <a class="el" href="osd__iam__lvar_8c_source.html#l00084">blocksize()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="o2iblnd__modparams_8c_source.html#l00047">cksum</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__krb5_8h_source.html#l00159">ENCTYPE_ARCFOUR_HMAC</a>, <a class="el" href="lustre__net_8h_source.html#l01484">GET_KIOV</a>, <a class="el" href="gss__err_8h_source.html#l00145">GSS_S_BAD_SIG</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00151">GSS_S_DEFECTIVE_TOKEN</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="gss__api_8h_source.html#l00027">gss_ctx::internal_ctx_id</a>, <a class="el" href="gss__krb5_8h_source.html#l00078">krb5_keyblock::kb_tfm</a>, <a class="el" href="gss__krb5_8h_source.html#l00090">krb5_ctx::kc_enctype</a>, <a class="el" href="gss__krb5_8h_source.html#l00091">krb5_ctx::kc_keye</a>, <a class="el" href="gss__krb5_8h_source.html#l00092">krb5_ctx::kc_keyi</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00079">krb5_enctype::ke_hash_size</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l01174">krb5_decrypt_bulk()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00765">krb5_make_checksum()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="lustre__net_8h_source.html#l01375">ptlrpc_is_bulk_desc_kiov()</a>, <a class="el" href="gss__internal_8h_source.html#l00031">RAWOBJ_EMPTY</a>, <a class="el" href="gss__rawobj_8c_source.html#l00076">rawobj_free()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00829">verify_krb5_header()</a>.</p>

</div>
</div>
<a class="anchor" id="a2a821e3506bf97b662ec6e020066c1dc"></a><!-- doxytag: member="gss_krb5_mech.c::gss_unwrap_kerberos" ref="a2a821e3506bf97b662ec6e020066c1dc" args="(struct gss_ctx *gctx, rawobj_t *gsshdr, rawobj_t *token, rawobj_t *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 gss_unwrap_kerberos </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>gsshdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01634">1634</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="osd__iam__lvar_8c_source.html#l00084">blocksize()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="o2iblnd__modparams_8c_source.html#l00047">cksum</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__krb5_8h_source.html#l00159">ENCTYPE_ARCFOUR_HMAC</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00151">GSS_S_DEFECTIVE_TOKEN</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="gss__api_8h_source.html#l00027">gss_ctx::internal_ctx_id</a>, <a class="el" href="gss__krb5_8h_source.html#l00078">krb5_keyblock::kb_tfm</a>, <a class="el" href="gss__krb5_8h_source.html#l00090">krb5_ctx::kc_enctype</a>, <a class="el" href="gss__krb5_8h_source.html#l00091">krb5_ctx::kc_keye</a>, <a class="el" href="gss__krb5_8h_source.html#l00092">krb5_ctx::kc_keyi</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00080">krb5_enctype::ke_conf_size</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00079">krb5_enctype::ke_hash_size</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00977">krb5_encrypt_rawobjs()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00765">krb5_make_checksum()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="gss__internal_8h_source.html#l00031">RAWOBJ_EMPTY</a>, <a class="el" href="gss__rawobj_8c_source.html#l00076">rawobj_free()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00829">verify_krb5_header()</a>.</p>

</div>
</div>
<a class="anchor" id="a73c5277c06913279f6b81098f636f27b"></a><!-- doxytag: member="gss_krb5_mech.c::gss_verify_mic_kerberos" ref="a73c5277c06913279f6b81098f636f27b" args="(struct gss_ctx *gctx, int msgcnt, rawobj_t *msgs, int iovcnt, lnet_kiov_t *iovs, rawobj_t *token)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 gss_verify_mic_kerberos </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgcnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>msgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>iovcnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlnet__kiov__t.html">lnet_kiov_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iovs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>token</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00905">905</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="o2iblnd__modparams_8c_source.html#l00047">cksum</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__err_8h_source.html#l00145">GSS_S_BAD_SIG</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00151">GSS_S_DEFECTIVE_TOKEN</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="gss__api_8h_source.html#l00027">gss_ctx::internal_ctx_id</a>, <a class="el" href="gss__krb5_8h_source.html#l00090">krb5_ctx::kc_enctype</a>, <a class="el" href="gss__krb5_8h_source.html#l00093">krb5_ctx::kc_keyc</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00079">krb5_enctype::ke_hash_size</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00765">krb5_make_checksum()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="gss__internal_8h_source.html#l00031">RAWOBJ_EMPTY</a>, <a class="el" href="gss__rawobj_8c_source.html#l00076">rawobj_free()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00829">verify_krb5_header()</a>.</p>

</div>
</div>
<a class="anchor" id="a4eae963cb8dee97b0e94d210783c422d"></a><!-- doxytag: member="gss_krb5_mech.c::gss_wrap_bulk_kerberos" ref="a4eae963cb8dee97b0e94d210783c422d" args="(struct gss_ctx *gctx, struct ptlrpc_bulk_desc *desc, rawobj_t *token, int adj_nob)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 gss_wrap_bulk_kerberos </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>adj_nob</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01522">1522</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="lustre__net_8h_source.html#l01453">ptlrpc_bulk_desc::bd_iov_count</a>, <a class="el" href="lustre__net_8h_source.html#l01442">ptlrpc_bulk_desc::bd_type</a>, <a class="el" href="osd__iam__lvar_8c_source.html#l00084">blocksize()</a>, <a class="el" href="prng_8c_source.html#l00111">cfs_get_random_bytes()</a>, <a class="el" href="o2iblnd__modparams_8c_source.html#l00047">cksum</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__krb5_8h_source.html#l00159">ENCTYPE_ARCFOUR_HMAC</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00803">fill_krb5_header()</a>, <a class="el" href="lustre__net_8h_source.html#l01484">GET_KIOV</a>, <a class="el" href="gss__internal_8h_source.html#l00090">GSS_MAX_CIPHER_BLOCK</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="gss__api_8h_source.html#l00027">gss_ctx::internal_ctx_id</a>, <a class="el" href="gss__krb5_8h_source.html#l00078">krb5_keyblock::kb_tfm</a>, <a class="el" href="gss__krb5_8h_source.html#l00090">krb5_ctx::kc_enctype</a>, <a class="el" href="gss__krb5_8h_source.html#l00091">krb5_ctx::kc_keye</a>, <a class="el" href="gss__krb5_8h_source.html#l00092">krb5_ctx::kc_keyi</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00080">krb5_enctype::ke_conf_size</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00079">krb5_enctype::ke_hash_size</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l01054">krb5_encrypt_bulk()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00765">krb5_make_checksum()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="lustre__net_8h_source.html#l01375">ptlrpc_is_bulk_desc_kiov()</a>, <a class="el" href="gss__internal_8h_source.html#l00031">RAWOBJ_EMPTY</a>, and <a class="el" href="gss__rawobj_8c_source.html#l00076">rawobj_free()</a>.</p>

</div>
</div>
<a class="anchor" id="ab20e27aa6836da0665e263f4debbf4c8"></a><!-- doxytag: member="gss_krb5_mech.c::gss_wrap_kerberos" ref="ab20e27aa6836da0665e263f4debbf4c8" args="(struct gss_ctx *gctx, rawobj_t *gsshdr, rawobj_t *msg, int msg_buflen, rawobj_t *token)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 gss_wrap_kerberos </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>gsshdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msg_buflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>token</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01344">1344</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="gss__krb5__mech_8c_source.html#l00956">add_padding()</a>, <a class="el" href="osd__iam__lvar_8c_source.html#l00084">blocksize()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="prng_8c_source.html#l00111">cfs_get_random_bytes()</a>, <a class="el" href="o2iblnd__modparams_8c_source.html#l00047">cksum</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__krb5_8h_source.html#l00159">ENCTYPE_ARCFOUR_HMAC</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00803">fill_krb5_header()</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="gss__internal_8h_source.html#l00090">GSS_MAX_CIPHER_BLOCK</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="gss__api_8h_source.html#l00027">gss_ctx::internal_ctx_id</a>, <a class="el" href="gss__krb5_8h_source.html#l00078">krb5_keyblock::kb_tfm</a>, <a class="el" href="gss__krb5_8h_source.html#l00090">krb5_ctx::kc_enctype</a>, <a class="el" href="gss__krb5_8h_source.html#l00091">krb5_ctx::kc_keye</a>, <a class="el" href="gss__krb5_8h_source.html#l00092">krb5_ctx::kc_keyi</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00080">krb5_enctype::ke_conf_size</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00079">krb5_enctype::ke_hash_size</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00977">krb5_encrypt_rawobjs()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00765">krb5_make_checksum()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="gss__internal_8h_source.html#l00031">RAWOBJ_EMPTY</a>, and <a class="el" href="gss__rawobj_8c_source.html#l00076">rawobj_free()</a>.</p>

</div>
</div>
<a class="anchor" id="a83559422d05ee726c4419ea5fb4e43ea"></a><!-- doxytag: member="gss_krb5_mech.c::import_context_rfc1964" ref="a83559422d05ee726c4419ea5fb4e43ea" args="(struct krb5_ctx *kctx, char *p, char *end)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 import_context_rfc1964 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkrb5__ctx.html">krb5_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>kctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>end</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00277">277</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00210">get_bytes()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00247">get_keyblock()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00223">get_rawobj()</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="gss__krb5_8h_source.html#l00090">krb5_ctx::kc_enctype</a>, <a class="el" href="gss__krb5_8h_source.html#l00086">krb5_ctx::kc_endtime</a>, <a class="el" href="gss__krb5_8h_source.html#l00093">krb5_ctx::kc_keyc</a>, <a class="el" href="gss__krb5_8h_source.html#l00091">krb5_ctx::kc_keye</a>, <a class="el" href="gss__krb5_8h_source.html#l00092">krb5_ctx::kc_keyi</a>, <a class="el" href="gss__krb5_8h_source.html#l00094">krb5_ctx::kc_mech_used</a>, <a class="el" href="gss__krb5_8h_source.html#l00087">krb5_ctx::kc_seed</a>, <a class="el" href="gss__krb5_8h_source.html#l00082">krb5_ctx::kc_seed_init</a>, <a class="el" href="gss__krb5_8h_source.html#l00088">krb5_ctx::kc_seq_send</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00204">keyblock_dup()</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00418">gss_import_sec_context_kerberos()</a>.</p>

</div>
</div>
<a class="anchor" id="a3b29874f1fac98abd1f1c17e5094aa6c"></a><!-- doxytag: member="gss_krb5_mech.c::import_context_rfc4121" ref="a3b29874f1fac98abd1f1c17e5094aa6c" args="(struct krb5_ctx *kctx, char *p, char *end)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 import_context_rfc4121 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkrb5__ctx.html">krb5_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>kctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>end</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00356">356</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00210">get_bytes()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00247">get_keyblock()</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="gss__krb5_8h_source.html#l00082">krb5_ctx::kc_cfx</a>, <a class="el" href="gss__krb5_8h_source.html#l00090">krb5_ctx::kc_enctype</a>, <a class="el" href="gss__krb5_8h_source.html#l00086">krb5_ctx::kc_endtime</a>, <a class="el" href="gss__krb5_8h_source.html#l00082">krb5_ctx::kc_have_acceptor_subkey</a>, <a class="el" href="gss__krb5_8h_source.html#l00082">krb5_ctx::kc_initiate</a>, <a class="el" href="gss__krb5_8h_source.html#l00093">krb5_ctx::kc_keyc</a>, <a class="el" href="gss__krb5_8h_source.html#l00091">krb5_ctx::kc_keye</a>, <a class="el" href="gss__krb5_8h_source.html#l00092">krb5_ctx::kc_keyi</a>, <a class="el" href="gss__krb5_8h_source.html#l00088">krb5_ctx::kc_seq_send</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00353">KRB5_CTX_FLAG_ACCEPTOR_SUBKEY</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00352">KRB5_CTX_FLAG_CFX</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00351">KRB5_CTX_FLAG_INITIATOR</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00418">gss_import_sec_context_kerberos()</a>.</p>

</div>
</div>
<a class="anchor" id="a72f7a3103bb07011441f7302717f901e"></a><!-- doxytag: member="gss_krb5_mech.c::init_kerberos_module" ref="a72f7a3103bb07011441f7302717f901e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int __init init_kerberos_module </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01960">1960</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00072">krb5_seq_lock</a>, <a class="el" href="gss__mech__switch_8c_source.html#l00067">lgss_mech_register()</a>, and <a class="el" href="lustre__rsync_8c_source.html#l00187">status</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02872">sptlrpc_gss_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a99114d7894b874df58e600b876681c21"></a><!-- doxytag: member="gss_krb5_mech.c::keyblock_dup" ref="a99114d7894b874df58e600b876681c21" args="(struct krb5_keyblock *new, struct krb5_keyblock *kb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int keyblock_dup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *&nbsp;</td>
          <td class="paramname"> <em>new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *&nbsp;</td>
          <td class="paramname"> <em>kb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00204">204</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="gss__krb5_8h_source.html#l00077">krb5_keyblock::kb_key</a>, and <a class="el" href="gss__rawobj_8c_source.html#l00097">rawobj_dup()</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00463">gss_copy_reverse_context_kerberos()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00277">import_context_rfc1964()</a>.</p>

</div>
</div>
<a class="anchor" id="a5e6734889a631395daf019f575ebe7cc"></a><!-- doxytag: member="gss_krb5_mech.c::keyblock_free" ref="a5e6734889a631395daf019f575ebe7cc" args="(struct krb5_keyblock *kb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void keyblock_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *&nbsp;</td>
          <td class="paramname"> <em>kb</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00196">196</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="gss__krb5_8h_source.html#l00077">krb5_keyblock::kb_key</a>, <a class="el" href="gss__krb5_8h_source.html#l00078">krb5_keyblock::kb_tfm</a>, and <a class="el" href="gss__rawobj_8c_source.html#l00076">rawobj_free()</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00267">delete_context_kerberos()</a>.</p>

</div>
</div>
<a class="anchor" id="adf9e73412cda4eb68605bc594c048437"></a><!-- doxytag: member="gss_krb5_mech.c::keyblock_init" ref="adf9e73412cda4eb68605bc594c048437" args="(struct krb5_keyblock *kb, char *alg_name, int alg_mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int keyblock_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *&nbsp;</td>
          <td class="paramname"> <em>kb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>alg_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>alg_mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00148">148</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__krb5_8h_source.html#l00077">krb5_keyblock::kb_key</a>, <a class="el" href="gss__krb5_8h_source.html#l00078">krb5_keyblock::kb_tfm</a>, and <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00167">krb5_init_keys()</a>.</p>

</div>
</div>
<a class="anchor" id="ab4f1bfb8fa0f71672f5d98d7c7f84107"></a><!-- doxytag: member="gss_krb5_mech.c::krb5_decrypt_bulk" ref="ab4f1bfb8fa0f71672f5d98d7c7f84107" args="(struct crypto_blkcipher *tfm, struct krb5_header *khdr, struct ptlrpc_bulk_desc *desc, rawobj_t *cipher, rawobj_t *plain, int adj_nob)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int krb5_decrypt_bulk </td>
          <td>(</td>
          <td class="paramtype">struct crypto_blkcipher *&nbsp;</td>
          <td class="paramname"> <em>tfm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkrb5__header.html">krb5_header</a> *&nbsp;</td>
          <td class="paramname"> <em>khdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>plain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>adj_nob</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01174">1174</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="lustre__net_8h_source.html#l01487">BD_GET_ENC_KIOV</a>, <a class="el" href="lustre__net_8h_source.html#l01485">BD_GET_KIOV</a>, <a class="el" href="lustre__net_8h_source.html#l01453">ptlrpc_bulk_desc::bd_iov_count</a>, <a class="el" href="lustre__net_8h_source.html#l01455">ptlrpc_bulk_desc::bd_nob</a>, <a class="el" href="lustre__net_8h_source.html#l01456">ptlrpc_bulk_desc::bd_nob_transferred</a>, <a class="el" href="lustre__net_8h_source.html#l01442">ptlrpc_bulk_desc::bd_type</a>, <a class="el" href="osd__iam__lvar_8c_source.html#l00084">blocksize()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="lustre__net_8h_source.html#l01486">GET_ENC_KIOV</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="lustre__net_8h_source.html#l01375">ptlrpc_is_bulk_desc_kiov()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00537">setup_sgtable()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00590">teardown_sgtable()</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l01801">gss_unwrap_bulk_kerberos()</a>.</p>

</div>
</div>
<a class="anchor" id="a238b668e45926472d3aa71e2b258e444"></a><!-- doxytag: member="gss_krb5_mech.c::krb5_digest_hmac" ref="a238b668e45926472d3aa71e2b258e444" args="(struct crypto_hash *tfm, rawobj_t *key, struct krb5_header *khdr, int msgcnt, rawobj_t *msgs, int iovcnt, lnet_kiov_t *iovs, rawobj_t *cksum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int krb5_digest_hmac </td>
          <td>(</td>
          <td class="paramtype">struct crypto_hash *&nbsp;</td>
          <td class="paramname"> <em>tfm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkrb5__header.html">krb5_header</a> *&nbsp;</td>
          <td class="paramname"> <em>khdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgcnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>msgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>iovcnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlnet__kiov__t.html">lnet_kiov_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iovs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cksum</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00648">648</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00537">setup_sgtable()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00590">teardown_sgtable()</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00765">krb5_make_checksum()</a>.</p>

</div>
</div>
<a class="anchor" id="a63ecc35461e7bcc575d163255f02f46a"></a><!-- doxytag: member="gss_krb5_mech.c::krb5_digest_norm" ref="a63ecc35461e7bcc575d163255f02f46a" args="(struct crypto_hash *tfm, struct krb5_keyblock *kb, struct krb5_header *khdr, int msgcnt, rawobj_t *msgs, int iovcnt, lnet_kiov_t *iovs, rawobj_t *cksum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int krb5_digest_norm </td>
          <td>(</td>
          <td class="paramtype">struct crypto_hash *&nbsp;</td>
          <td class="paramname"> <em>tfm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *&nbsp;</td>
          <td class="paramname"> <em>kb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkrb5__header.html">krb5_header</a> *&nbsp;</td>
          <td class="paramname"> <em>khdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgcnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>msgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>iovcnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlnet__kiov__t.html">lnet_kiov_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iovs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cksum</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00703">703</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__krb5_8h_source.html#l00078">krb5_keyblock::kb_tfm</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00597">krb5_encrypt()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00537">setup_sgtable()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00590">teardown_sgtable()</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00765">krb5_make_checksum()</a>.</p>

</div>
</div>
<a class="anchor" id="a1a20df8e3fa0b29bd957c12a532df621"></a><!-- doxytag: member="gss_krb5_mech.c::krb5_encrypt" ref="a1a20df8e3fa0b29bd957c12a532df621" args="(struct crypto_blkcipher *tfm, int decrypt, void *iv, void *in, void *out, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 krb5_encrypt </td>
          <td>(</td>
          <td class="paramtype">struct crypto_blkcipher *&nbsp;</td>
          <td class="paramname"> <em>tfm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>decrypt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00597">597</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00047">ret</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00537">setup_sgtable()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00590">teardown_sgtable()</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00703">krb5_digest_norm()</a>.</p>

</div>
</div>
<a class="anchor" id="aaa90d394eea18d82f33e0cc172df01c3"></a><!-- doxytag: member="gss_krb5_mech.c::krb5_encrypt_bulk" ref="aaa90d394eea18d82f33e0cc172df01c3" args="(struct crypto_blkcipher *tfm, struct krb5_header *khdr, char *confounder, struct ptlrpc_bulk_desc *desc, rawobj_t *cipher, int adj_nob)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int krb5_encrypt_bulk </td>
          <td>(</td>
          <td class="paramtype">struct crypto_blkcipher *&nbsp;</td>
          <td class="paramname"> <em>tfm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkrb5__header.html">krb5_header</a> *&nbsp;</td>
          <td class="paramname"> <em>khdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>confounder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>adj_nob</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01054">1054</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="lustre__net_8h_source.html#l01487">BD_GET_ENC_KIOV</a>, <a class="el" href="lustre__net_8h_source.html#l01485">BD_GET_KIOV</a>, <a class="el" href="lustre__net_8h_source.html#l01453">ptlrpc_bulk_desc::bd_iov_count</a>, <a class="el" href="lustre__net_8h_source.html#l01455">ptlrpc_bulk_desc::bd_nob</a>, <a class="el" href="lustre__net_8h_source.html#l01442">ptlrpc_bulk_desc::bd_type</a>, <a class="el" href="osd__iam__lvar_8c_source.html#l00084">blocksize()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="lustre__net_8h_source.html#l01486">GET_ENC_KIOV</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="lustre__net_8h_source.html#l01375">ptlrpc_is_bulk_desc_kiov()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00537">setup_sgtable()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00590">teardown_sgtable()</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l01522">gss_wrap_bulk_kerberos()</a>.</p>

</div>
</div>
<a class="anchor" id="ab164118f879bec2558d0fca6556864a9"></a><!-- doxytag: member="gss_krb5_mech.c::krb5_encrypt_rawobjs" ref="ab164118f879bec2558d0fca6556864a9" args="(struct crypto_blkcipher *tfm, int mode_ecb, int inobj_cnt, rawobj_t *inobjs, rawobj_t *outobj, int enc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int krb5_encrypt_rawobjs </td>
          <td>(</td>
          <td class="paramtype">struct crypto_blkcipher *&nbsp;</td>
          <td class="paramname"> <em>tfm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>mode_ecb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>inobj_cnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>inobjs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>outobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>enc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00977">977</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="parallel__grouplock_8c_source.html#l00078">buf</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00537">setup_sgtable()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00590">teardown_sgtable()</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l01634">gss_unwrap_kerberos()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l01344">gss_wrap_kerberos()</a>.</p>

</div>
</div>
<a class="anchor" id="a162d6b993e310fee9c130e55dd202648"></a><!-- doxytag: member="gss_krb5_mech.c::krb5_init_keys" ref="a162d6b993e310fee9c130e55dd202648" args="(struct krb5_ctx *kctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int krb5_init_keys </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkrb5__ctx.html">krb5_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>kctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00167">167</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__krb5_8h_source.html#l00159">ENCTYPE_ARCFOUR_HMAC</a>, <a class="el" href="gss__krb5_8h_source.html#l00090">krb5_ctx::kc_enctype</a>, <a class="el" href="gss__krb5_8h_source.html#l00093">krb5_ctx::kc_keyc</a>, <a class="el" href="gss__krb5_8h_source.html#l00091">krb5_ctx::kc_keye</a>, <a class="el" href="gss__krb5_8h_source.html#l00092">krb5_ctx::kc_keyi</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00078">krb5_enctype::ke_enc_mode</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00076">krb5_enctype::ke_enc_name</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00081">krb5_enctype::ke_hash_hmac</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00079">krb5_enctype::ke_hash_size</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00148">keyblock_init()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00137">MAX_ENCTYPES</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00463">gss_copy_reverse_context_kerberos()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00418">gss_import_sec_context_kerberos()</a>.</p>

</div>
</div>
<a class="anchor" id="a3f4c7e44f83537665182f971f20640fa"></a><!-- doxytag: member="gss_krb5_mech.c::krb5_make_checksum" ref="a3f4c7e44f83537665182f971f20640fa" args="(__u32 enctype, struct krb5_keyblock *kb, struct krb5_header *khdr, int msgcnt, rawobj_t *msgs, int iovcnt, lnet_kiov_t *iovs, rawobj_t *cksum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __s32 krb5_make_checksum </td>
          <td>(</td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>enctype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkrb5__keyblock.html">krb5_keyblock</a> *&nbsp;</td>
          <td class="paramname"> <em>kb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkrb5__header.html">krb5_header</a> *&nbsp;</td>
          <td class="paramname"> <em>khdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgcnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>msgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>iovcnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlnet__kiov__t.html">lnet_kiov_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iovs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>cksum</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00765">765</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="gss__krb5_8h_source.html#l00077">krb5_keyblock::kb_key</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00081">krb5_enctype::ke_hash_hmac</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00077">krb5_enctype::ke_hash_name</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00648">krb5_digest_hmac()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00703">krb5_digest_norm()</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, and <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00872">gss_get_mic_kerberos()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l01801">gss_unwrap_bulk_kerberos()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l01634">gss_unwrap_kerberos()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00905">gss_verify_mic_kerberos()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l01522">gss_wrap_bulk_kerberos()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l01344">gss_wrap_kerberos()</a>.</p>

</div>
</div>
<a class="anchor" id="a382c7545d0f7d2c6c8af0e075b69e413"></a><!-- doxytag: member="gss_krb5_mech.c::setup_sgtable" ref="a382c7545d0f7d2c6c8af0e075b69e413" args="(struct sg_table *sgt, struct scatterlist *prealloc_sg, const void *buf, unsigned int buf_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int setup_sgtable </td>
          <td>(</td>
          <td class="paramtype">struct sg_table *&nbsp;</td>
          <td class="paramname"> <em>sgt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct scatterlist *&nbsp;</td>
          <td class="paramname"> <em>prealloc_sg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>buf_len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00537">537</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00047">ret</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l01174">krb5_decrypt_bulk()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00648">krb5_digest_hmac()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00703">krb5_digest_norm()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00597">krb5_encrypt()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l01054">krb5_encrypt_bulk()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00977">krb5_encrypt_rawobjs()</a>.</p>

</div>
</div>
<a class="anchor" id="ad065505ba7c40de30c5a976f5ed3cf88"></a><!-- doxytag: member="gss_krb5_mech.c::teardown_sgtable" ref="ad065505ba7c40de30c5a976f5ed3cf88" args="(struct sg_table *sgt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void teardown_sgtable </td>
          <td>(</td>
          <td class="paramtype">struct sg_table *&nbsp;</td>
          <td class="paramname"> <em>sgt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00590">590</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l01174">krb5_decrypt_bulk()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00648">krb5_digest_hmac()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00703">krb5_digest_norm()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l00597">krb5_encrypt()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l01054">krb5_encrypt_bulk()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00977">krb5_encrypt_rawobjs()</a>.</p>

</div>
</div>
<a class="anchor" id="adff0bd7680776627e5cb6a2c47c2ce87"></a><!-- doxytag: member="gss_krb5_mech.c::verify_krb5_header" ref="adff0bd7680776627e5cb6a2c47c2ce87" args="(struct krb5_ctx *kctx, struct krb5_header *khdr, int privacy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 verify_krb5_header </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkrb5__ctx.html">krb5_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>kctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkrb5__header.html">krb5_header</a> *&nbsp;</td>
          <td class="paramname"> <em>khdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>privacy</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00829">829</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>References <a class="el" href="byteorder_8h_source.html#l00061">be16_to_cpu</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__krb5_8h_source.html#l00062">FLAG_SENDER_IS_ACCEPTOR</a>, <a class="el" href="gss__krb5_8h_source.html#l00063">FLAG_WRAP_CONFIDENTIAL</a>, <a class="el" href="gss__err_8h_source.html#l00145">GSS_S_BAD_SIG</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00151">GSS_S_DEFECTIVE_TOKEN</a>, <a class="el" href="gss__krb5_8h_source.html#l00082">krb5_ctx::kc_initiate</a>, <a class="el" href="gss__krb5_8h_source.html#l00059">KG_TOK_MIC_MSG</a>, <a class="el" href="gss__krb5_8h_source.html#l00060">KG_TOK_WRAP_MSG</a>, <a class="el" href="gss__krb5_8h_source.html#l00070">krb5_header::kh_ec</a>, <a class="el" href="gss__krb5_8h_source.html#l00069">krb5_header::kh_filler</a>, <a class="el" href="gss__krb5_8h_source.html#l00068">krb5_header::kh_flags</a>, <a class="el" href="gss__krb5_8h_source.html#l00071">krb5_header::kh_rrc</a>, and <a class="el" href="gss__krb5_8h_source.html#l00067">krb5_header::kh_tok_id</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l01801">gss_unwrap_bulk_kerberos()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l01634">gss_unwrap_kerberos()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l00905">gss_verify_mic_kerberos()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a621d404de65285bbad64601c442c7a3b"></a><!-- doxytag: member="gss_krb5_mech.c::enctypes" ref="a621d404de65285bbad64601c442c7a3b" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structkrb5__enctype.html">krb5_enctype</a> <a class="el" href="gss__krb5__mech_8c.html#a621d404de65285bbad64601c442c7a3b">enctypes</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00089">89</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac70554525a18ff9f598e237238c2b9ae"></a><!-- doxytag: member="gss_krb5_mech.c::gss_kerberos_mech" ref="ac70554525a18ff9f598e237238c2b9ae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structgss__api__mech.html">gss_api_mech</a> <a class="el" href="gss__krb5__mech_8c.html#ac70554525a18ff9f598e237238c2b9ae">gss_kerberos_mech</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .gm_owner       = NULL, 
        .gm_name        = <span class="stringliteral">&quot;krb5&quot;</span>,
        .gm_oid         = (<a class="code" href="structrawobj__s.html">rawobj_t</a>)
                                {9, <span class="stringliteral">&quot;\052\206\110\206\367\022\001\002\002&quot;</span>},
        .gm_ops         = &amp;<a class="code" href="gss__krb5__mech_8c.html#aa74e0849d21dc694b9a811dd6f770d5c">gss_kerberos_ops</a>,
        .gm_sf_num      = 4,
        .gm_sfs         = <a class="code" href="gss__krb5__mech_8c.html#a0a67655841b4bc609ae5fa7bb105d19f">gss_kerberos_sfs</a>,
}
</pre></div>
<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01950">1950</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa74e0849d21dc694b9a811dd6f770d5c"></a><!-- doxytag: member="gss_krb5_mech.c::gss_kerberos_ops" ref="aa74e0849d21dc694b9a811dd6f770d5c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structgss__api__ops.html">gss_api_ops</a> <a class="el" href="gss__krb5__mech_8c.html#aa74e0849d21dc694b9a811dd6f770d5c">gss_kerberos_ops</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .gss_import_sec_context     = <a class="code" href="gss__krb5__mech_8c.html#a99de25d936e6fcf33993c03fc672b8e2">gss_import_sec_context_kerberos</a>,
        .gss_copy_reverse_context   = <a class="code" href="gss__krb5__mech_8c.html#ac50a1797a3a065370026c14bd3b10c22">gss_copy_reverse_context_kerberos</a>,
        .gss_inquire_context        = <a class="code" href="gss__krb5__mech_8c.html#a5fca2c874c8e5941c7b38613a3472d77">gss_inquire_context_kerberos</a>,
        .gss_get_mic                = <a class="code" href="gss__krb5__mech_8c.html#a6256894bd01c88b06dc4f047a0ee524f">gss_get_mic_kerberos</a>,
        .gss_verify_mic             = <a class="code" href="gss__krb5__mech_8c.html#a73c5277c06913279f6b81098f636f27b">gss_verify_mic_kerberos</a>,
        .gss_wrap                   = <a class="code" href="gss__krb5__mech_8c.html#ab20e27aa6836da0665e263f4debbf4c8">gss_wrap_kerberos</a>,
        .gss_unwrap                 = <a class="code" href="gss__krb5__mech_8c.html#a2a821e3506bf97b662ec6e020066c1dc">gss_unwrap_kerberos</a>,
        .gss_prep_bulk              = <a class="code" href="gss__krb5__mech_8c.html#a61abda37c9a7a846a336db503dfabf47">gss_prep_bulk_kerberos</a>,
        .gss_wrap_bulk              = <a class="code" href="gss__krb5__mech_8c.html#a4eae963cb8dee97b0e94d210783c422d">gss_wrap_bulk_kerberos</a>,
        .gss_unwrap_bulk            = <a class="code" href="gss__krb5__mech_8c.html#afd7cf7c3476740e7741bd16c6bbed199">gss_unwrap_bulk_kerberos</a>,
        .gss_delete_sec_context     = <a class="code" href="gss__krb5__mech_8c.html#ad7af5fb9e6e5480090b13df1cd393f31">gss_delete_sec_context_kerberos</a>,
        .gss_display                = <a class="code" href="gss__krb5__mech_8c.html#a8ea854c10d5ff1e57d382998a0d7f641">gss_display_kerberos</a>,
}
</pre></div>
<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01905">1905</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0a67655841b4bc609ae5fa7bb105d19f"></a><!-- doxytag: member="gss_krb5_mech.c::gss_kerberos_sfs" ref="a0a67655841b4bc609ae5fa7bb105d19f" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsubflavor__desc.html">subflavor_desc</a> <a class="el" href="gss__krb5__mech_8c.html#a0a67655841b4bc609ae5fa7bb105d19f">gss_kerberos_sfs</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        {
                .sf_subflavor   = <a class="code" href="group__flavor.html#gae1b8778086d5ed14ae8e6221b33c1f11">SPTLRPC_SUBFLVR_KRB5N</a>,
                .sf_qop         = 0,
                .sf_service     = <a class="code" href="group__flavor.html#ggab48fb51b4fb60d481bc12e344e73df3aa9962cb9ccc8b90b4c67ada0e7b00210b" title="no security">SPTLRPC_SVC_NULL</a>,
                .sf_name        = <span class="stringliteral">&quot;krb5n&quot;</span>
        },
        {
                .sf_subflavor   = <a class="code" href="group__flavor.html#gaaf075afc2390f59e398fecc796c2e114">SPTLRPC_SUBFLVR_KRB5A</a>,
                .sf_qop         = 0,
                .sf_service     = <a class="code" href="group__flavor.html#ggab48fb51b4fb60d481bc12e344e73df3aa691acc99dba7191db4f6c2e177331e30" title="authentication only">SPTLRPC_SVC_AUTH</a>,
                .sf_name        = <span class="stringliteral">&quot;krb5a&quot;</span>
        },
        {
                .sf_subflavor   = <a class="code" href="group__flavor.html#ga2797337a80382122fd03b594ff5446a1">SPTLRPC_SUBFLVR_KRB5I</a>,
                .sf_qop         = 0,
                .sf_service     = <a class="code" href="group__flavor.html#ggab48fb51b4fb60d481bc12e344e73df3aa74b1cc494dcf8dbf001b3a19e8790fd9" title="integrity">SPTLRPC_SVC_INTG</a>,
                .sf_name        = <span class="stringliteral">&quot;krb5i&quot;</span>
        },
        {
                .sf_subflavor   = <a class="code" href="group__flavor.html#ga3746925332e647ef5305583ca3e15806">SPTLRPC_SUBFLVR_KRB5P</a>,
                .sf_qop         = 0,
                .sf_service     = <a class="code" href="group__flavor.html#ggab48fb51b4fb60d481bc12e344e73df3aa1baf868991ad935c71ceb65c53389564" title="privacy">SPTLRPC_SVC_PRIV</a>,
                .sf_name        = <span class="stringliteral">&quot;krb5p&quot;</span>
        },
}
</pre></div>
<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l01920">1920</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

</div>
</div>
<a class="anchor" id="abd1ae143efca0bdaa2f183871b649061"></a><!-- doxytag: member="gss_krb5_mech.c::krb5_seq_lock" ref="abd1ae143efca0bdaa2f183871b649061" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">spinlock_t <a class="el" href="gss__krb5__mech_8c.html#abd1ae143efca0bdaa2f183871b649061">krb5_seq_lock</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gss__krb5__mech_8c_source.html#l00072">72</a> of file <a class="el" href="gss__krb5__mech_8c_source.html">gss_krb5_mech.c</a>.</p>

<p>Referenced by <a class="el" href="gss__krb5__mech_8c_source.html#l00803">fill_krb5_header()</a>, and <a class="el" href="gss__krb5__mech_8c_source.html#l01960">init_kerberos_module()</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:50 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
