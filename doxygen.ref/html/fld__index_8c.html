<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/fld/fld_index.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/fld/fld_index.c File Reference</h1><code>#include &lt;<a class="el" href="libcfs_8h_source.html">libcfs/libcfs.h</a>&gt;</code><br/>
<code>#include &lt;linux/module.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__support_8h_source.html">obd_support.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="dt__object_8h_source.html">dt_object.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__fid_8h_source.html">lustre_fid.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__fld_8h_source.html">lustre_fld.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="fld__internal_8h_source.html">fld_internal.h</a>&quot;</code><br/>

<p><a href="fld__index_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>&nbsp;&nbsp;&nbsp;S_FLD</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#a024796ba9c3dfc856c2044ace1e63aa5">fld_declare_index_create</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *fld, const struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a> *new_range, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#a58d9d0cef29dd51c24476bb44ea73be1">fld_index_create</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *fld, const struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a> *new_range, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">insert range in fld store.  <a href="#a58d9d0cef29dd51c24476bb44ea73be1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#ac1533b7cb3edf0f559721b9efa6a89bd">fld_index_lookup</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *fld, u64 seq, struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a> *range)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">lookup range for a seq passed.  <a href="#ac1533b7cb3edf0f559721b9efa6a89bd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fld.html#gae8f48350563bdfa8ce96124db14eed9f">fld_insert_entry</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *fld, const struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a> *range)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">insert entry in fld store.  <a href="group__fld.html#gae8f48350563bdfa8ce96124db14eed9f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#a1146bad76d2a1fe2277ae51d91b8a2e1">fld_insert_special_entries</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *fld)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#a949ba36ed0e4321bf963779da893bc96">fld_index_init</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *fld, struct <a class="el" href="structdt__device.html">dt_device</a> *dt, int type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#aa8c0b03b55d3a5e46e1a9e0a9471628e">fld_index_fini</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *fld)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#a54deb263e84ae9f9f61b3447349844b0">fld_server_read</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *fld, struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a> *range, void *data, int data_len)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#a88f5491c55d77da0d850026877f3cabf">fld_index_name</a> [] = &quot;fld&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#aaa71f2645fa227bf7c511870b2b97037">IGIF_FLD_RANGE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#a92ccddb58740948f8fcbfeca32cc4d95">DOT_LUSTRE_FLD_RANGE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#a19c5b5c274b3b5a13438f8aa65b558f6">ROOT_FLD_RANGE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structdt__index__features.html">dt_index_features</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#a8a1003505a209d17bebb96681f371c50">fld_index_features</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlu__context__key.html">lu_context_key</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fld__index_8c.html#a12f28dd47191e9bf4638da40f3790c68">fld_thread_key</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="abda60744d497fcfe370cfd6b2d65c7ed"></a><!-- doxytag: member="fld_index.c::DEBUG_SUBSYSTEM" ref="abda60744d497fcfe370cfd6b2d65c7ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_SUBSYSTEM&nbsp;&nbsp;&nbsp;S_FLD</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00042">42</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a024796ba9c3dfc856c2044ace1e63aa5"></a><!-- doxytag: member="fld_index.c::fld_declare_index_create" ref="a024796ba9c3dfc856c2044ace1e63aa5" args="(const struct lu_env *env, struct lu_server_fld *fld, const struct lu_seq_range *new_range, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fld_declare_index_create </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *&nbsp;</td>
          <td class="paramname"> <em>fld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a> *&nbsp;</td>
          <td class="paramname"> <em>new_range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00086">86</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="seq__range_8h_source.html#l00184">DRANGE</a>, <a class="el" href="dt__object_8h_source.html#l02615">dt_declare_delete()</a>, <a class="el" href="dt__object_8h_source.html#l02481">dt_declare_insert()</a>, <a class="el" href="dt__object_8c_source.html#l00058">dt_key</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="fld__index_8c_source.html#l00233">fld_index_lookup()</a>, <a class="el" href="fld__index_8c.html#a12f28dd47191e9bf4638da40f3790c68">fld_thread_key</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01273">lu_env::le_ctx</a>, <a class="el" href="lustre__fld_8h_source.html#l00097">lu_server_fld::lsf_name</a>, <a class="el" href="lustre__fld_8h_source.html#l00080">lu_server_fld::lsf_obj</a>, <a class="el" href="lustre__idl_8h_source.html#l00155">lu_seq_range::lsr_end</a>, <a class="el" href="lustre__idl_8h_source.html#l00154">lu_seq_range::lsr_start</a>, <a class="el" href="lu__object_8c_source.html#l01574">lu_context_key_get()</a>, <a class="el" href="seq__range_8h_source.html#l00174">lu_seq_range_compare_loc()</a>, <a class="el" href="seq__range_8h_source.html#l00186">PRANGE</a>, <a class="el" href="lustre__fid_8h_source.html#l00779">range_cpu_to_be()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="fld__handler_8c_source.html#l00076">fld_declare_server_create()</a>, and <a class="el" href="fld__index_8c_source.html#l00273">fld_insert_entry()</a>.</p>

</div>
</div>
<a class="anchor" id="a58d9d0cef29dd51c24476bb44ea73be1"></a><!-- doxytag: member="fld_index.c::fld_index_create" ref="a58d9d0cef29dd51c24476bb44ea73be1" args="(const struct lu_env *env, struct lu_server_fld *fld, const struct lu_seq_range *new_range, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fld_index_create </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *&nbsp;</td>
          <td class="paramname"> <em>fld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a> *&nbsp;</td>
          <td class="paramname"> <em>new_range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>insert range in fld store. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>range</em>&nbsp;</td><td>range to be inserted </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>th</em>&nbsp;</td><td>transaction for this operation as it could compound transaction.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-ve</em>&nbsp;</td><td>error</td></tr>
  </table>
  </dd>
</dl>
<p>The whole fld index insertion is protected by seq-&gt;lss_mutex (see seq_server_alloc_super), i.e. only one thread will access fldb each time, so we do not need worry the fld file and cache will being changed between declare and create. Because the fld entry can only be increamental, so we will only check whether it can be merged from the left.</p>
<p>Caller must hold fld-&gt;lsf_lock </p>

<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00160">160</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="seq__range_8h_source.html#l00184">DRANGE</a>, <a class="el" href="dt__object_8h_source.html#l02630">dt_delete()</a>, <a class="el" href="dt__object_8h_source.html#l02497">dt_insert()</a>, <a class="el" href="dt__object_8c_source.html#l00058">dt_key</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="fld__internal_8h_source.html#l00096">fld_cache::fci_lock</a>, <a class="el" href="fld__cache_8c_source.html#l00456">fld_cache_delete_nolock()</a>, <a class="el" href="fld__cache_8c_source.html#l00368">fld_cache_entry_create()</a>, <a class="el" href="fld__cache_8c_source.html#l00388">fld_cache_insert_nolock()</a>, <a class="el" href="fld__index_8c_source.html#l00233">fld_index_lookup()</a>, <a class="el" href="fld__index_8c.html#a12f28dd47191e9bf4638da40f3790c68">fld_thread_key</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01273">lu_env::le_ctx</a>, <a class="el" href="lustre__fld_8h_source.html#l00089">lu_server_fld::lsf_cache</a>, <a class="el" href="lustre__fld_8h_source.html#l00093">lu_server_fld::lsf_lock</a>, <a class="el" href="lustre__fld_8h_source.html#l00097">lu_server_fld::lsf_name</a>, <a class="el" href="lustre__fld_8h_source.html#l00080">lu_server_fld::lsf_obj</a>, <a class="el" href="lustre__idl_8h_source.html#l00155">lu_seq_range::lsr_end</a>, <a class="el" href="lustre__idl_8h_source.html#l00154">lu_seq_range::lsr_start</a>, <a class="el" href="lu__object_8c_source.html#l01574">lu_context_key_get()</a>, <a class="el" href="seq__range_8h_source.html#l00174">lu_seq_range_compare_loc()</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="seq__range_8h_source.html#l00186">PRANGE</a>, <a class="el" href="lustre__fid_8h_source.html#l00779">range_cpu_to_be()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="fld__index_8c_source.html#l00273">fld_insert_entry()</a>, and <a class="el" href="fld__handler_8c_source.html#l00094">fld_server_create()</a>.</p>

</div>
</div>
<a class="anchor" id="aa8c0b03b55d3a5e46e1a9e0a9471628e"></a><!-- doxytag: member="fld_index.c::fld_index_fini" ref="aa8c0b03b55d3a5e46e1a9e0a9471628e" args="(const struct lu_env *env, struct lu_server_fld *fld)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fld_index_fini </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *&nbsp;</td>
          <td class="paramname"> <em>fld</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00446">446</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__fld_8h_source.html#l00080">lu_server_fld::lsf_obj</a>, and <a class="el" href="lu__object_8c_source.html#l00097">lu_object_put()</a>.</p>

<p>Referenced by <a class="el" href="fld__handler_8c_source.html#l00487">fld_server_fini()</a>, and <a class="el" href="fld__handler_8c_source.html#l00443">fld_server_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a949ba36ed0e4321bf963779da893bc96"></a><!-- doxytag: member="fld_index.c::fld_index_init" ref="a949ba36ed0e4321bf963779da893bc96" args="(const struct lu_env *env, struct lu_server_fld *fld, struct dt_device *dt, int type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fld_index_init </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *&nbsp;</td>
          <td class="paramname"> <em>fld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__device.html">dt_device</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00326">326</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="dt__object_8h_source.html#l00386">DFT_INDEX</a>, <a class="el" href="structdt__index__operations.html#a16b19879e71b5cb1aaa459d731d580cb">dt_index_operations::dio_it</a>, <a class="el" href="dt__object_8h_source.html#l01753">dt_object::do_index_ops</a>, <a class="el" href="structdt__object__operations.html#ac317771bd9f0827b4d8fcec4d51a63c2">dt_object_operations::do_index_try</a>, <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="dt__object_8h_source.html#l01751">dt_object::do_ops</a>, <a class="el" href="structdt__object__format.html#a2570277a076882708ae6b6d1419bfa13">dt_object_format::dof_idx</a>, <a class="el" href="dt__object_8h_source.html#l00396">dt_object_format::dof_type</a>, <a class="el" href="dt__object_8c_source.html#l00388">dt_find_or_create()</a>, <a class="el" href="dt__object_8h_source.html#l01926">dt_locate()</a>, <a class="el" href="dt__object_8h_source.html#l01790">dt_object_exists()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="fld__cache_8c_source.html#l00437">fld_cache_insert()</a>, <a class="el" href="fld__index_8c_source.html#l00052">fld_index_name</a>, <a class="el" href="lustre__fid_8h_source.html#l00211">FLD_INDEX_OID</a>, <a class="el" href="fld__index_8c_source.html#l00308">fld_insert_special_entries()</a>, <a class="el" href="fld__handler_8c_source.html#l00110">fld_name_to_index()</a>, <a class="el" href="fld__index_8c.html#a12f28dd47191e9bf4638da40f3790c68">fld_thread_key</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="structdt__index__operations_1_1dt__it__ops.html#a74b9db7e1791f6accf99c80a3a0c43e2">dt_index_operations::dt_it_ops::init</a>, <a class="el" href="lu__object_8h_source.html#l00419">lu_attr::la_mode</a>, <a class="el" href="lu__object_8h_source.html#l00448">LA_MODE</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01273">lu_env::le_ctx</a>, <a class="el" href="lustre__fld_8h_source.html#l00089">lu_server_fld::lsf_cache</a>, <a class="el" href="lustre__fld_8h_source.html#l00093">lu_server_fld::lsf_lock</a>, <a class="el" href="lustre__fld_8h_source.html#l00097">lu_server_fld::lsf_name</a>, <a class="el" href="lustre__fld_8h_source.html#l00109">lu_server_fld::lsf_new</a>, <a class="el" href="lustre__fld_8h_source.html#l00080">lu_server_fld::lsf_obj</a>, <a class="el" href="lu__object_8c_source.html#l01574">lu_context_key_get()</a>, <a class="el" href="lustre__fid_8h_source.html#l00242">lu_local_obj_fid()</a>, <a class="el" href="lu__object_8c_source.html#l00097">lu_object_put()</a>, <a class="el" href="lustre__idl_8h_source.html#l00166">LU_SEQ_RANGE_MDT</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="lustre__fid_8h_source.html#l00788">range_be_to_cpu()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="structdt__object__format.html#ab53de8222a0a448faf6fe773746a36ed">dt_object_format::u</a>.</p>

<p>Referenced by <a class="el" href="fld__handler_8c_source.html#l00443">fld_server_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ac1533b7cb3edf0f559721b9efa6a89bd"></a><!-- doxytag: member="fld_index.c::fld_index_lookup" ref="ac1533b7cb3edf0f559721b9efa6a89bd" args="(const struct lu_env *env, struct lu_server_fld *fld, u64 seq, struct lu_seq_range *range)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fld_index_lookup </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *&nbsp;</td>
          <td class="paramname"> <em>fld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&nbsp;</td>
          <td class="paramname"> <em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a> *&nbsp;</td>
          <td class="paramname"> <em>range</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>lookup range for a seq passed. </p>
<p>note here we only care about the start/end, caller should handle the attached location data (flags, index).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>seq</em>&nbsp;</td><td>seq for lookup. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>range</em>&nbsp;</td><td>result of lookup.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>found, <em>range</em> is the matched range; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-ENOENT</em>&nbsp;</td><td>not found, <em>range</em> is the left-side range; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-ve</em>&nbsp;</td><td>other error; </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00233">233</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="seq__range_8h_source.html#l00184">DRANGE</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="fld__cache_8c_source.html#l00528">fld_cache_lookup()</a>, <a class="el" href="fld__index_8c.html#a12f28dd47191e9bf4638da40f3790c68">fld_thread_key</a>, <a class="el" href="lu__object_8h_source.html#l01273">lu_env::le_ctx</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="lustre__fld_8h_source.html#l00089">lu_server_fld::lsf_cache</a>, <a class="el" href="lustre__fld_8h_source.html#l00097">lu_server_fld::lsf_name</a>, <a class="el" href="lu__object_8c_source.html#l01574">lu_context_key_get()</a>, <a class="el" href="seq__range_8h_source.html#l00136">lu_seq_range_within()</a>, <a class="el" href="seq__range_8h_source.html#l00186">PRANGE</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="fld__index_8c_source.html#l00086">fld_declare_index_create()</a>, and <a class="el" href="fld__index_8c_source.html#l00160">fld_index_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a1146bad76d2a1fe2277ae51d91b8a2e1"></a><!-- doxytag: member="fld_index.c::fld_insert_special_entries" ref="a1146bad76d2a1fe2277ae51d91b8a2e1" args="(const struct lu_env *env, struct lu_server_fld *fld)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int fld_insert_special_entries </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *&nbsp;</td>
          <td class="paramname"> <em>fld</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00308">308</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

<p>References <a class="el" href="fld__index_8c_source.html#l00273">fld_insert_entry()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="fld__index_8c_source.html#l00326">fld_index_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a54deb263e84ae9f9f61b3447349844b0"></a><!-- doxytag: member="fld_index.c::fld_server_read" ref="a54deb263e84ae9f9f61b3447349844b0" args="(const struct lu_env *env, struct lu_server_fld *fld, struct lu_seq_range *range, void *data, int data_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fld_server_read </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__server__fld.html">lu_server_fld</a> *&nbsp;</td>
          <td class="paramname"> <em>fld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a> *&nbsp;</td>
          <td class="paramname"> <em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>data_len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00457">457</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

<p>References <a class="el" href="structdt__index__operations.html#a16b19879e71b5cb1aaa459d731d580cb">dt_index_operations::dio_it</a>, <a class="el" href="dt__object_8h_source.html#l01753">dt_object::do_index_ops</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="fld__index_8c.html#a12f28dd47191e9bf4638da40f3790c68">fld_thread_key</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="structdt__index__operations_1_1dt__it__ops.html#a74b9db7e1791f6accf99c80a3a0c43e2">dt_index_operations::dt_it_ops::init</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01273">lu_env::le_ctx</a>, <a class="el" href="lustre__fld_8h_source.html#l00080">lu_server_fld::lsf_obj</a>, <a class="el" href="lustre__idl_8h_source.html#l00155">lu_seq_range::lsr_end</a>, <a class="el" href="lustre__idl_8h_source.html#l00157">lu_seq_range::lsr_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l00156">lu_seq_range::lsr_index</a>, <a class="el" href="lustre__idl_8h_source.html#l00154">lu_seq_range::lsr_start</a>, <a class="el" href="lustre__idl_8h_source.html#l00161">lu_seq_range_array::lsra_count</a>, <a class="el" href="lustre__idl_8h_source.html#l00163">lu_seq_range_array::lsra_lsr</a>, <a class="el" href="lu__object_8c_source.html#l01574">lu_context_key_get()</a>, <a class="el" href="lustre__user_8h_source.html#l01032">offsetof</a>, <a class="el" href="lustre__fid_8h_source.html#l00796">range_array_cpu_to_le()</a>, <a class="el" href="lustre__fid_8h_source.html#l00788">range_be_to_cpu()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="fld__handler_8c_source.html#l00320">fld_handle_read()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a92ccddb58740948f8fcbfeca32cc4d95"></a><!-- doxytag: member="fld_index.c::DOT_LUSTRE_FLD_RANGE" ref="a92ccddb58740948f8fcbfeca32cc4d95" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a> <a class="el" href="fld__index_8c.html#a92ccddb58740948f8fcbfeca32cc4d95">DOT_LUSTRE_FLD_RANGE</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .lsr_start = <a class="code" href="group__lu__fid.html#gga962ff98f105cccff448c45b0c7b77e2fab4f64c953ed40b5e363022f03c1a12ba">FID_SEQ_DOT_LUSTRE</a>,
        .lsr_end   = <a class="code" href="group__lu__fid.html#gga962ff98f105cccff448c45b0c7b77e2fab4f64c953ed40b5e363022f03c1a12ba">FID_SEQ_DOT_LUSTRE</a> + 1,
        .lsr_index = 0,
        .lsr_flags = <a class="code" href="group__lustreidl.html#gad908f571ea4756a145878ade71027708">LU_SEQ_RANGE_MDT</a>
}
</pre></div>
<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00061">61</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8a1003505a209d17bebb96681f371c50"></a><!-- doxytag: member="fld_index.c::fld_index_features" ref="a8a1003505a209d17bebb96681f371c50" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdt__index__features.html">dt_index_features</a> <a class="el" href="fld__index_8c.html#a8a1003505a209d17bebb96681f371c50">fld_index_features</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .dif_flags       = <a class="code" href="group__dt.html#ggaea9a8b2931d0590dac0d8265121fd073a6528f1359f7a4f7626b6e1aa3b0d0eef" title="index can be modified">DT_IND_UPDATE</a>,
        .dif_keysize_min = <span class="keyword">sizeof</span>(u64),
        .dif_keysize_max = <span class="keyword">sizeof</span>(u64),
        .dif_recsize_min = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structlu__seq__range.html" title="Describes a range of sequence, lsr_start is included but lsr_end is not in the range...">lu_seq_range</a>),
        .dif_recsize_max = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structlu__seq__range.html" title="Describes a range of sequence, lsr_start is included but lsr_end is not in the range...">lu_seq_range</a>),
        .dif_ptrsize     = 4
}
</pre></div>
<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00075">75</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

</div>
</div>
<a class="anchor" id="a88f5491c55d77da0d850026877f3cabf"></a><!-- doxytag: member="fld_index.c::fld_index_name" ref="a88f5491c55d77da0d850026877f3cabf" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char <a class="el" href="fld__index_8c.html#a88f5491c55d77da0d850026877f3cabf">fld_index_name</a>[] = &quot;fld&quot;<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00052">52</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

<p>Referenced by <a class="el" href="fld__index_8c_source.html#l00326">fld_index_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a12f28dd47191e9bf4638da40f3790c68"></a><!-- doxytag: member="fld_index.c::fld_thread_key" ref="a12f28dd47191e9bf4638da40f3790c68" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__context__key.html">lu_context_key</a> <a class="el" href="fld__index_8c.html#a12f28dd47191e9bf4638da40f3790c68">fld_thread_key</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fld__handler_8c_source.html#l00371">fid_is_local()</a>, <a class="el" href="fld__index_8c_source.html#l00086">fld_declare_index_create()</a>, <a class="el" href="fld__index_8c_source.html#l00160">fld_index_create()</a>, <a class="el" href="fld__index_8c_source.html#l00326">fld_index_init()</a>, <a class="el" href="fld__index_8c_source.html#l00233">fld_index_lookup()</a>, <a class="el" href="fld__handler_8c_source.html#l00205">fld_local_lookup()</a>, <a class="el" href="fld__handler_8c_source.html#l00071">fld_server_mod_exit()</a>, <a class="el" href="fld__handler_8c_source.html#l00065">fld_server_mod_init()</a>, <a class="el" href="fld__index_8c_source.html#l00457">fld_server_read()</a>, and <a class="el" href="fld__handler_8c_source.html#l00128">fld_update_from_controller()</a>.</p>

</div>
</div>
<a class="anchor" id="aaa71f2645fa227bf7c511870b2b97037"></a><!-- doxytag: member="fld_index.c::IGIF_FLD_RANGE" ref="aaa71f2645fa227bf7c511870b2b97037" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a> <a class="el" href="fld__index_8c.html#aaa71f2645fa227bf7c511870b2b97037">IGIF_FLD_RANGE</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .lsr_start = <a class="code" href="group__lu__fid.html#gga962ff98f105cccff448c45b0c7b77e2fadb072d1ca73f880a6d97bbb4aeeff330">FID_SEQ_IGIF</a>,
        .lsr_end   = <a class="code" href="group__lu__fid.html#gga962ff98f105cccff448c45b0c7b77e2fa86dfed33c3ba3f4fbc868e0dfa0f7270">FID_SEQ_IGIF_MAX</a> + 1,
        .lsr_index = 0,
        .lsr_flags = <a class="code" href="group__lustreidl.html#gad908f571ea4756a145878ade71027708">LU_SEQ_RANGE_MDT</a>
}
</pre></div>
<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00054">54</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

</div>
</div>
<a class="anchor" id="a19c5b5c274b3b5a13438f8aa65b558f6"></a><!-- doxytag: member="fld_index.c::ROOT_FLD_RANGE" ref="a19c5b5c274b3b5a13438f8aa65b558f6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__seq__range.html">lu_seq_range</a> <a class="el" href="fld__index_8c.html#a19c5b5c274b3b5a13438f8aa65b558f6">ROOT_FLD_RANGE</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .lsr_start = <a class="code" href="group__lu__fid.html#gga962ff98f105cccff448c45b0c7b77e2fa6b49e3b5c37113a8a157dbd1dcc94fe9">FID_SEQ_ROOT</a>,
        .lsr_end   = <a class="code" href="group__lu__fid.html#gga962ff98f105cccff448c45b0c7b77e2fa6b49e3b5c37113a8a157dbd1dcc94fe9">FID_SEQ_ROOT</a> + 1,
        .lsr_index = 0,
        .lsr_flags = <a class="code" href="group__lustreidl.html#gad908f571ea4756a145878ade71027708">LU_SEQ_RANGE_MDT</a>
}
</pre></div>
<p>Definition at line <a class="el" href="fld__index_8c_source.html#l00068">68</a> of file <a class="el" href="fld__index_8c_source.html">fld_index.c</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:46 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
