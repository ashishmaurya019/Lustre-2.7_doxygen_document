<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/include/lustre_quota.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/include/lustre_quota.h File Reference</h1><code>#include &lt;linux/fs.h&gt;</code><br/>
<code>#include &lt;linux/quota.h&gt;</code><br/>
<code>#include &lt;linux/quotaops.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="dt__object_8h_source.html">dt_object.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__fid_8h_source.html">lustre_fid.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__dlm_8h_source.html">lustre_dlm.h</a>&gt;</code><br/>

<p><a href="lustre__quota_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">union &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionlquota__rec.html">lquota_rec</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structqmt__handlers.html">qmt_handlers</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlquota__id__info.html">lquota_id_info</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlquota__trans.html">lquota_trans</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a790974d66bb90f29e69ea7beef79d5e9">MAX_IQ_TIME</a>&nbsp;&nbsp;&nbsp;604800</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a6a216a59e1e7896c0829ef845bce1e26">MAX_DQ_TIME</a>&nbsp;&nbsp;&nbsp;604800</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a901d1dc9ff4d0019c433bd311d988f38">QUOTA_METAPOOL_NAME</a>&nbsp;&nbsp;&nbsp;&quot;mdt=&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a7382e007a8dcdc6afc5f3148566407cb">QUOTA_DATAPOOL_NAME</a>&nbsp;&nbsp;&nbsp;&quot;ost=&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a58d3c18f67a2ff543f33fe6765b443b1">QUOTA_MAX_TRANSIDS</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a7b327c3a75d612bb42896a9e3801226b">QUOTA_FL_OVER_USRQUOTA</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a7da286bd89809e932df2a7b8a86aab31">QUOTA_FL_OVER_GRPQUOTA</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#aa66f117109e4ded2f0a3e04d1fb45478">QUOTA_FL_SYNC</a>&nbsp;&nbsp;&nbsp;0x04</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a9e25eb7522527d6f8b19b3a153e685f2">IS_LQUOTA_RES</a>(res)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a5186328595885f84c38412b064ba9abc">qsd_init</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *, char *, struct <a class="el" href="structdt__device.html">dt_device</a> *, struct proc_dir_entry *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a4cda00ab64163413090407a8e12c7831">qsd_prepare</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *, struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#af28106e42a71911a3e3822e1de0847aa">qsd_start</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *, struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a57a165d79ab15484c93c02d101c7c164">qsd_fini</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *, struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a03c0b162634a9096bc054ccb6e75cb35">qsd_op_begin</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *, struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *, struct <a class="el" href="structlquota__trans.html">lquota_trans</a> *, struct <a class="el" href="structlquota__id__info.html">lquota_id_info</a> *, int *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enforce quota, it's called in the declaration of each operation.  <a href="#a03c0b162634a9096bc054ccb6e75cb35"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#af2c802f3768264de9886361b59e59f4a">qsd_op_end</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *, struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *, struct <a class="el" href="structlquota__trans.html">lquota_trans</a> *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Post quota operation.  <a href="#af2c802f3768264de9886361b59e59f4a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a68f46290e7c2fe3d254eea62a91b6fed">qsd_op_adjust</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *, struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *, union <a class="el" href="unionlquota__id.html">lquota_id</a> *, int)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Trigger pre-acquire/release if necessary.  <a href="#a68f46290e7c2fe3d254eea62a91b6fed"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#ae9a847d90a2cf240db6d1640deee5a29">lquotactl_slv</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *, struct <a class="el" href="structdt__device.html">dt_device</a> *, struct <a class="el" href="structobd__quotactl.html">obd_quotactl</a> *)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdt__index__features.html">dt_index_features</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a75aa37d7ba5d6bf6eba75e73f2f9fbb1">dt_quota_iusr_features</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdt__index__features.html">dt_index_features</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a57f8296a33771f506f3f992ea5c315a7">dt_quota_busr_features</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdt__index__features.html">dt_index_features</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a5f865f56b037a36859f3a9aed32a0a1e">dt_quota_igrp_features</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdt__index__features.html">dt_index_features</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#aa5c890012613f369d8f8f8e09286aabe">dt_quota_bgrp_features</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structqmt__handlers.html">qmt_handlers</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lustre__quota_8h.html#a61f6cf34d1f0aa9b69fcb83477deab90">qmt_hdls</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a9e25eb7522527d6f8b19b3a153e685f2"></a><!-- doxytag: member="lustre_quota.h::IS_LQUOTA_RES" ref="a9e25eb7522527d6f8b19b3a153e685f2" args="(res)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IS_LQUOTA_RES</td>
          <td>(</td>
          <td class="paramtype">res&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">(res-&gt;lr_name.name[<a class="code" href="group__lustreidl.html#ggae4d5251432e1a9e6803c0240cc492e18a16d776c2c1fe3c3725108d6196bbbee2">LUSTRE_RES_ID_SEQ_OFF</a>] == <a class="code" href="group__lu__fid.html#gga962ff98f105cccff448c45b0c7b77e2faadd046565072ae426115d62a1cc0c76f">FID_SEQ_QUOTA</a> ||   \
         res-&gt;lr_name.name[<a class="code" href="group__lustreidl.html#ggae4d5251432e1a9e6803c0240cc492e18a16d776c2c1fe3c3725108d6196bbbee2">LUSTRE_RES_ID_SEQ_OFF</a>] == <a class="code" href="group__lu__fid.html#gga962ff98f105cccff448c45b0c7b77e2fa8cbd27ab7d7c843c46c932426e6945d7">FID_SEQ_QUOTA_GLB</a>)
</pre></div>
<p>Definition at line <a class="el" href="lustre__quota_8h_source.html#l00227">227</a> of file <a class="el" href="lustre__quota_8h_source.html">lustre_quota.h</a>.</p>

<p>Referenced by <a class="el" href="mdt__lvb_8c_source.html#l00095">mdt_lvbo_fill()</a>, <a class="el" href="mdt__lvb_8c_source.html#l00183">mdt_lvbo_free()</a>, <a class="el" href="mdt__lvb_8c_source.html#l00037">mdt_lvbo_init()</a>, <a class="el" href="mdt__lvb_8c_source.html#l00073">mdt_lvbo_size()</a>, and <a class="el" href="mdt__lvb_8c_source.html#l00053">mdt_lvbo_update()</a>.</p>

</div>
</div>
<a class="anchor" id="a6a216a59e1e7896c0829ef845bce1e26"></a><!-- doxytag: member="lustre_quota.h::MAX_DQ_TIME" ref="a6a216a59e1e7896c0829ef845bce1e26" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_DQ_TIME&nbsp;&nbsp;&nbsp;604800</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lustre__quota_8h_source.html#l00047">47</a> of file <a class="el" href="lustre__quota_8h_source.html">lustre_quota.h</a>.</p>

<p>Referenced by <a class="el" href="qmt__pool_8c_source.html#l00494">qmt_pool_prepare()</a>.</p>

</div>
</div>
<a class="anchor" id="a790974d66bb90f29e69ea7beef79d5e9"></a><!-- doxytag: member="lustre_quota.h::MAX_IQ_TIME" ref="a790974d66bb90f29e69ea7beef79d5e9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_IQ_TIME&nbsp;&nbsp;&nbsp;604800</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lustre__quota_8h_source.html#l00043">43</a> of file <a class="el" href="lustre__quota_8h_source.html">lustre_quota.h</a>.</p>

<p>Referenced by <a class="el" href="qmt__pool_8c_source.html#l00494">qmt_pool_prepare()</a>.</p>

</div>
</div>
<a class="anchor" id="a7382e007a8dcdc6afc5f3148566407cb"></a><!-- doxytag: member="lustre_quota.h::QUOTA_DATAPOOL_NAME" ref="a7382e007a8dcdc6afc5f3148566407cb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QUOTA_DATAPOOL_NAME&nbsp;&nbsp;&nbsp;&quot;ost=&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lustre__quota_8h_source.html#l00074">74</a> of file <a class="el" href="lustre__quota_8h_source.html">lustre_quota.h</a>.</p>

<p>Referenced by <a class="el" href="mgs__llog_8c_source.html#l02846">mgs_write_log_quota()</a>, and <a class="el" href="qsd__config_8c_source.html#l00128">qsd_process_config()</a>.</p>

</div>
</div>
<a class="anchor" id="a7da286bd89809e932df2a7b8a86aab31"></a><!-- doxytag: member="lustre_quota.h::QUOTA_FL_OVER_GRPQUOTA" ref="a7da286bd89809e932df2a7b8a86aab31" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QUOTA_FL_OVER_GRPQUOTA&nbsp;&nbsp;&nbsp;0x02</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lustre__quota_8h_source.html#l00224">224</a> of file <a class="el" href="lustre__quota_8h_source.html">lustre_quota.h</a>.</p>

<p>Referenced by <a class="el" href="osd-ldiskfs_2osd__io_8c_source.html#l01095">osd_declare_write_commit()</a>.</p>

</div>
</div>
<a class="anchor" id="a7b327c3a75d612bb42896a9e3801226b"></a><!-- doxytag: member="lustre_quota.h::QUOTA_FL_OVER_USRQUOTA" ref="a7b327c3a75d612bb42896a9e3801226b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QUOTA_FL_OVER_USRQUOTA&nbsp;&nbsp;&nbsp;0x01</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lustre__quota_8h_source.html#l00223">223</a> of file <a class="el" href="lustre__quota_8h_source.html">lustre_quota.h</a>.</p>

<p>Referenced by <a class="el" href="osd-ldiskfs_2osd__io_8c_source.html#l01095">osd_declare_write_commit()</a>.</p>

</div>
</div>
<a class="anchor" id="aa66f117109e4ded2f0a3e04d1fb45478"></a><!-- doxytag: member="lustre_quota.h::QUOTA_FL_SYNC" ref="aa66f117109e4ded2f0a3e04d1fb45478" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QUOTA_FL_SYNC&nbsp;&nbsp;&nbsp;0x04</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lustre__quota_8h_source.html#l00225">225</a> of file <a class="el" href="lustre__quota_8h_source.html">lustre_quota.h</a>.</p>

<p>Referenced by <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00567">osd_declare_write_commit()</a>, and <a class="el" href="qsd__handler_8c_source.html#l00686">qsd_op_begin0()</a>.</p>

</div>
</div>
<a class="anchor" id="a58d3c18f67a2ff543f33fe6765b443b1"></a><!-- doxytag: member="lustre_quota.h::QUOTA_MAX_TRANSIDS" ref="a58d3c18f67a2ff543f33fe6765b443b1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QUOTA_MAX_TRANSIDS&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lustre__quota_8h_source.html#l00214">214</a> of file <a class="el" href="lustre__quota_8h_source.html">lustre_quota.h</a>.</p>

<p>Referenced by <a class="el" href="qsd__handler_8c_source.html#l00825">qsd_op_begin()</a>.</p>

</div>
</div>
<a class="anchor" id="a901d1dc9ff4d0019c433bd311d988f38"></a><!-- doxytag: member="lustre_quota.h::QUOTA_METAPOOL_NAME" ref="a901d1dc9ff4d0019c433bd311d988f38" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QUOTA_METAPOOL_NAME&nbsp;&nbsp;&nbsp;&quot;mdt=&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lustre__quota_8h_source.html#l00073">73</a> of file <a class="el" href="lustre__quota_8h_source.html">lustre_quota.h</a>.</p>

<p>Referenced by <a class="el" href="mgs__llog_8c_source.html#l02846">mgs_write_log_quota()</a>, and <a class="el" href="qsd__config_8c_source.html#l00128">qsd_process_config()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ae9a847d90a2cf240db6d1640deee5a29"></a><!-- doxytag: member="lustre_quota.h::lquotactl_slv" ref="ae9a847d90a2cf240db6d1640deee5a29" args="(const struct lu_env *, struct dt_device *, struct obd_quotactl *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int lquotactl_slv </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__device.html">dt_device</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__quotactl.html">obd_quotactl</a> *&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lquota__lib_8c_source.html#l00158">158</a> of file <a class="el" href="lquota__lib_8c_source.html">lquota_lib.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="lquota__lib_8c_source.html#l00065">acct_obj_lookup()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="dt__object_8h_source.html#l01753">dt_object::do_index_ops</a>, <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="lustre__user_8h_source.html#l00657">obd_dqblk::dqb_bhardlimit</a>, <a class="el" href="lustre__user_8h_source.html#l00662">obd_dqblk::dqb_curinodes</a>, <a class="el" href="lustre__user_8h_source.html#l00659">obd_dqblk::dqb_curspace</a>, <a class="el" href="lustre__user_8h_source.html#l00660">obd_dqblk::dqb_ihardlimit</a>, <a class="el" href="lustre__user_8h_source.html#l00665">obd_dqblk::dqb_valid</a>, <a class="el" href="dt__object_8c_source.html#l00058">dt_key</a>, <a class="el" href="dt__object_8h_source.html#l02654">dt_lookup()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00287">lu_device::ld_obd</a>, <a class="el" href="lu__object_8h_source.html#l00283">lu_device::ld_site</a>, <a class="el" href="lquota__internal_8h_source.html#l00308">lquota_info()</a>, <a class="el" href="lu__object_8h_source.html#l00619">lu_site::ls_top_dev</a>, <a class="el" href="lu__object_8h_source.html#l00399">lu_device_is_md()</a>, <a class="el" href="lu__object_8c_source.html#l00097">lu_object_put()</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="lustre__user_8h_source.html#l00570">Q_GETOQUOTA</a>, <a class="el" href="lustre__idl_8h_source.html#l01856">obd_quotactl::qc_cmd</a>, <a class="el" href="lustre__idl_8h_source.html#l01861">obd_quotactl::qc_dqblk</a>, <a class="el" href="lustre__idl_8h_source.html#l01858">obd_quotactl::qc_id</a>, <a class="el" href="lustre__idl_8h_source.html#l01857">obd_quotactl::qc_type</a>, <a class="el" href="lustre__user_8h_source.html#l00629">QIF_LIMITS</a>, <a class="el" href="lustre__user_8h_source.html#l00630">QIF_USAGE</a>, <a class="el" href="lquota__lib_8c_source.html#l00109">quota_obj_lookup()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="mdt__handler_8c_source.html#l02016">mdt_quotactl()</a>, and <a class="el" href="ofd__dev_8c_source.html#l02210">ofd_quotactl()</a>.</p>

</div>
</div>
<a class="anchor" id="a57a165d79ab15484c93c02d101c7c164"></a><!-- doxytag: member="lustre_quota.h::qsd_fini" ref="a57a165d79ab15484c93c02d101c7c164" args="(const struct lu_env *, struct qsd_instance *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsd_fini </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qsd__lib_8c_source.html#l00474">474</a> of file <a class="el" href="qsd__lib_8c_source.html">qsd_lib.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00155">D_QUOTA</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lu__object_8h_source.html#l00291">lu_device::ld_reference</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="lprocfs__status_8h_source.html#l00952">lprocfs_remove()</a>, <a class="el" href="lu__object_8c_source.html#l01190">lu_device_put()</a>, <a class="el" href="lu__object_8c_source.html#l00097">lu_object_put()</a>, <a class="el" href="lu__ref_8h_source.html#l00223">lu_ref_del()</a>, <a class="el" href="obd__mount__server_8c_source.html#l00458">lustre_deregister_lwp_item()</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="qsd__internal_8h_source.html#l00195">qsd_fsinfo::qfs_mutex</a>, <a class="el" href="qsd__internal_8h_source.html#l00052">qsd_instance::qsd_dev</a>, <a class="el" href="qsd__internal_8h_source.html#l00059">qsd_instance::qsd_exp</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_exp_valid</a>, <a class="el" href="qsd__internal_8h_source.html#l00076">qsd_instance::qsd_fsinfo</a>, <a class="el" href="qsd__internal_8h_source.html#l00079">qsd_instance::qsd_link</a>, <a class="el" href="qsd__internal_8h_source.html#l00098">qsd_instance::qsd_lock</a>, <a class="el" href="qsd__internal_8h_source.html#l00062">qsd_instance::qsd_ns</a>, <a class="el" href="qsd__internal_8h_source.html#l00056">qsd_instance::qsd_proc</a>, <a class="el" href="qsd__config_8c_source.html#l00047">qsd_put_fsinfo()</a>, <a class="el" href="qsd__lib_8c_source.html#l00273">qsd_qtype_fini()</a>, <a class="el" href="qsd__internal_8h_source.html#l00065">qsd_instance::qsd_root</a>, <a class="el" href="qsd__reint_8c_source.html#l00544">qsd_stop_reint_thread()</a>, <a class="el" href="qsd__writeback_8c_source.html#l00563">qsd_stop_upd_thread()</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_stopping</a>, <a class="el" href="qsd__internal_8h_source.html#l00046">qsd_instance::qsd_svname</a>, <a class="el" href="qsd__internal_8h_source.html#l00073">qsd_instance::qsd_type_array</a>, <a class="el" href="libcfs__debug_8h_source.html#l00358">RETURN_EXIT</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="osd-ldiskfs_2osd__handler_8c_source.html#l06186">osd_shutdown()</a>, and <a class="el" href="qsd__lib_8c_source.html#l00557">qsd_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a5186328595885f84c38412b064ba9abc"></a><!-- doxytag: member="lustre_quota.h::qsd_init" ref="a5186328595885f84c38412b064ba9abc" args="(const struct lu_env *, char *, struct dt_device *, struct proc_dir_entry *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structqsd__instance.html">qsd_instance</a>* qsd_init </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__device.html">dt_device</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct proc_dir_entry *&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qsd__lib_8c_source.html#l00557">557</a> of file <a class="el" href="qsd__lib_8c_source.html">qsd_lib.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="lu__object_8h_source.html#l00291">lu_device::ld_reference</a>, <a class="el" href="lustre__disk_8h_source.html#l00080">LDD_F_SV_TYPE_MDT</a>, <a class="el" href="lustre__disk_8h_source.html#l00081">LDD_F_SV_TYPE_OST</a>, <a class="el" href="list_8h_source.html#l00090">list_add_tail()</a>, <a class="el" href="lprocfs__status_8h_source.html#l00949">lprocfs_register()</a>, <a class="el" href="lu__object_8c_source.html#l01181">lu_device_get()</a>, <a class="el" href="lu__ref_8h_source.html#l00204">lu_ref_add()</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="qsd__internal_8h_source.html#l00195">qsd_fsinfo::qfs_mutex</a>, <a class="el" href="qsd__internal_8h_source.html#l00194">qsd_fsinfo::qfs_qsd_list</a>, <a class="el" href="qsd__internal_8h_source.html#l00082">qsd_instance::qsd_adjust_list</a>, <a class="el" href="qsd__internal_8h_source.html#l00085">qsd_instance::qsd_adjust_lock</a>, <a class="el" href="qsd__internal_8h_source.html#l00052">qsd_instance::qsd_dev</a>, <a class="el" href="lustre__disk_8h_source.html#l00071">QSD_DIR</a>, <a class="el" href="qsd__lib_8c_source.html#l00474">qsd_fini()</a>, <a class="el" href="qsd__internal_8h_source.html#l00076">qsd_instance::qsd_fsinfo</a>, <a class="el" href="qsd__config_8c_source.html#l00074">qsd_get_fsinfo()</a>, <a class="el" href="qsd__internal_8h_source.html#l00261">qsd_info()</a>, <a class="el" href="qsd__internal_8h_source.html#l00079">qsd_instance::qsd_link</a>, <a class="el" href="qsd__internal_8h_source.html#l00098">qsd_instance::qsd_lock</a>, <a class="el" href="qsd__internal_8h_source.html#l00049">qsd_instance::qsd_pool_id</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_prepared</a>, <a class="el" href="qsd__internal_8h_source.html#l00056">qsd_instance::qsd_proc</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_started</a>, <a class="el" href="qsd__internal_8h_source.html#l00046">qsd_instance::qsd_svname</a>, <a class="el" href="qsd__internal_8h_source.html#l00091">qsd_instance::qsd_upd_list</a>, <a class="el" href="qsd__internal_8h_source.html#l00088">qsd_instance::qsd_upd_thread</a>, <a class="el" href="qsd__internal_8h_source.html#l00255">qsd_thread_info::qti_buf</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="obd__mount_8c_source.html#l00685">server_name2fsname()</a>, <a class="el" href="obd__mount_8c_source.html#l00790">server_name2index()</a>, <a class="el" href="string_8c_source.html#l00058">strlcpy()</a>, <a class="el" href="lustre__net_8h_source.html#l01494">SVC_STOPPED</a>, <a class="el" href="lustre__net_8h_source.html#l01532">ptlrpc_thread::t_ctl_waitq</a>, and <a class="el" href="lustre__net_8h_source.html#l01577">thread_set_flags()</a>.</p>

<p>Referenced by <a class="el" href="osd-ldiskfs_2osd__handler_8c_source.html#l06404">osd_device_init0()</a>, and <a class="el" href="osd-zfs_2osd__handler_8c_source.html#l00947">osd_mount()</a>.</p>

</div>
</div>
<a class="anchor" id="a68f46290e7c2fe3d254eea62a91b6fed"></a><!-- doxytag: member="lustre_quota.h::qsd_op_adjust" ref="a68f46290e7c2fe3d254eea62a91b6fed" args="(const struct lu_env *, struct qsd_instance *, union lquota_id *, int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsd_op_adjust </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *&nbsp;</td>
          <td class="paramname"> <em>qsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">union <a class="el" href="unionlquota__id.html">lquota_id</a> *&nbsp;</td>
          <td class="paramname"> <em>qid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>qtype</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Trigger pre-acquire/release if necessary. </p>
<p>It's only used by ldiskfs osd so far. When unlink a file in ldiskfs, the quota accounting isn't updated when the transaction stopped. Instead, it'll be updated on the final iput, so <a class="el" href="lustre__quota_8h.html#a68f46290e7c2fe3d254eea62a91b6fed" title="Trigger pre-acquire/release if necessary.">qsd_op_adjust()</a> will be called then (in <a class="el" href="osd-ldiskfs_2osd__handler_8c.html#ac09ce1e09b94642ed2d9e47b5246158a">osd_object_delete()</a>) to trigger quota release if necessary.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>env</em>&nbsp;</td><td>- the environment passed by the caller </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qsd</em>&nbsp;</td><td>- is the qsd instance associated with the device in charge of the operation. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qid</em>&nbsp;</td><td>- is the lquota ID of the user/group for which to trigger quota space adjustment </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qtype</em>&nbsp;</td><td>- is the quota type (USRQUOTA or GRPQUOTA) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qsd__handler_8c_source.html#l01119">1119</a> of file <a class="el" href="qsd__handler_8c_source.html">qsd_handler.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="lquota__entry_8c_source.html#l00313">lqe_locate()</a>, <a class="el" href="lquota__internal_8h_source.html#l00228">lqe_putref()</a>, <a class="el" href="lquota__internal_8h_source.html#l00258">lqe_read_lock()</a>, <a class="el" href="lquota__internal_8h_source.html#l00266">lqe_read_unlock()</a>, <a class="el" href="lustre__idl_8h_source.html#l01850">lquota_id::qid_uid</a>, <a class="el" href="qsd__internal_8h_source.html#l00147">qsd_qtype_info::qqi_acct_obj</a>, <a class="el" href="qsd__internal_8h_source.html#l00157">qsd_qtype_info::qqi_site</a>, <a class="el" href="qsd__handler_8c_source.html#l00902">qsd_adjust()</a>, <a class="el" href="qsd__handler_8c_source.html#l00293">qsd_adjust_needed()</a>, <a class="el" href="qsd__internal_8h_source.html#l00098">qsd_instance::qsd_lock</a>, <a class="el" href="qsd__entry_8c_source.html#l00186">qsd_refresh_usage()</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_started</a>, <a class="el" href="qsd__internal_8h_source.html#l00046">qsd_instance::qsd_svname</a>, <a class="el" href="qsd__internal_8h_source.html#l00073">qsd_instance::qsd_type_array</a>, <a class="el" href="qsd__internal_8h_source.html#l00275">qsd_type_enabled()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00358">RETURN_EXIT</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="osd-ldiskfs_2osd__handler_8c_source.html#l01514">osd_object_delete()</a>.</p>

</div>
</div>
<a class="anchor" id="a03c0b162634a9096bc054ccb6e75cb35"></a><!-- doxytag: member="lustre_quota.h::qsd_op_begin" ref="a03c0b162634a9096bc054ccb6e75cb35" args="(const struct lu_env *, struct qsd_instance *, struct lquota_trans *, struct lquota_id_info *, int *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int qsd_op_begin </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *&nbsp;</td>
          <td class="paramname"> <em>qsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlquota__trans.html">lquota_trans</a> *&nbsp;</td>
          <td class="paramname"> <em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlquota__id__info.html">lquota_id_info</a> *&nbsp;</td>
          <td class="paramname"> <em>qi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Enforce quota, it's called in the declaration of each operation. </p>
<p><a class="el" href="lustre__quota_8h.html#af2c802f3768264de9886361b59e59f4a" title="Post quota operation.">qsd_op_end()</a> will then be called later once all the operations have been completed in order to release/adjust the quota space.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>env</em>&nbsp;</td><td>- the environment passed by the caller </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qsd</em>&nbsp;</td><td>- is the qsd instance associated with the device in charge of the operation. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>trans</em>&nbsp;</td><td>- is the quota transaction information </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qi</em>&nbsp;</td><td>- qid &amp; space required by current operation </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flags</em>&nbsp;</td><td>- if the operation is write, return caller no user/group and sync commit flags</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>- success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-EDQUOT</em>&nbsp;</td><td>- out of quota </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-EINPROGRESS</em>&nbsp;</td><td>- inform client to retry write </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-ve</em>&nbsp;</td><td>- other appropriate errors </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qsd__handler_8c_source.html#l00825">825</a> of file <a class="el" href="qsd__handler_8c_source.html">qsd_handler.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00045">LASSERTF</a>, <a class="el" href="lustre__quota_8h_source.html#l00191">lquota_id_info::lqi_id</a>, <a class="el" href="lustre__quota_8h_source.html#l00205">lquota_id_info::lqi_is_blk</a>, <a class="el" href="lustre__quota_8h_source.html#l00199">lquota_id_info::lqi_space</a>, <a class="el" href="lustre__quota_8h_source.html#l00195">lquota_id_info::lqi_type</a>, <a class="el" href="lustre__quota_8h_source.html#l00218">lquota_trans::lqt_id_cnt</a>, <a class="el" href="lustre__quota_8h_source.html#l00219">lquota_trans::lqt_ids</a>, <a class="el" href="qsd__handler_8c_source.html#l00799">qid_equal()</a>, <a class="el" href="lustre__idl_8h_source.html#l01850">lquota_id::qid_uid</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_acct_failed</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_is_md</a>, <a class="el" href="qsd__internal_8h_source.html#l00098">qsd_instance::qsd_lock</a>, <a class="el" href="qsd__handler_8c_source.html#l00686">qsd_op_begin0()</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_started</a>, <a class="el" href="qsd__internal_8h_source.html#l00046">qsd_instance::qsd_svname</a>, <a class="el" href="qsd__internal_8h_source.html#l00073">qsd_instance::qsd_type_array</a>, <a class="el" href="qsd__internal_8h_source.html#l00275">qsd_type_enabled()</a>, <a class="el" href="lustre__quota_8h_source.html#l00214">QUOTA_MAX_TRANSIDS</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="osd-ldiskfs_2osd__quota_8c_source.html#l00504">osd_declare_qid()</a>, <a class="el" href="osd-zfs_2osd__quota_8c_source.html#l00482">osd_declare_quota()</a>, and <a class="el" href="osd__object_8c_source.html#l00790">qsd_transfer()</a>.</p>

</div>
</div>
<a class="anchor" id="af2c802f3768264de9886361b59e59f4a"></a><!-- doxytag: member="lustre_quota.h::qsd_op_end" ref="af2c802f3768264de9886361b59e59f4a" args="(const struct lu_env *, struct qsd_instance *, struct lquota_trans *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsd_op_end </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *&nbsp;</td>
          <td class="paramname"> <em>qsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlquota__trans.html">lquota_trans</a> *&nbsp;</td>
          <td class="paramname"> <em>trans</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Post quota operation. </p>
<p>It's called after each operation transaction stopped.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>env</em>&nbsp;</td><td>- the environment passed by the caller </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qsd</em>&nbsp;</td><td>- is the qsd instance associated with device which is handling the operation. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qids</em>&nbsp;</td><td>- all qids information attached in the transaction handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>- is the number of qid entries in the qids array.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>- success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-ve</em>&nbsp;</td><td>- failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qsd__handler_8c_source.html#l01069">1069</a> of file <a class="el" href="qsd__handler_8c_source.html">qsd_handler.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__quota_8h_source.html#l00202">lquota_id_info::lqi_qentry</a>, <a class="el" href="lustre__quota_8h_source.html#l00195">lquota_id_info::lqi_type</a>, <a class="el" href="lustre__quota_8h_source.html#l00218">lquota_trans::lqt_id_cnt</a>, <a class="el" href="lustre__quota_8h_source.html#l00219">lquota_trans::lqt_ids</a>, <a class="el" href="qsd__internal_8h_source.html#l00098">qsd_instance::qsd_lock</a>, <a class="el" href="qsd__handler_8c_source.html#l01019">qsd_op_end0()</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_started</a>, <a class="el" href="qsd__internal_8h_source.html#l00073">qsd_instance::qsd_type_array</a>, <a class="el" href="libcfs__debug_8h_source.html#l00358">RETURN_EXIT</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="osd-zfs_2osd__handler_8c_source.html#l00132">osd_trans_commit_cb()</a>, and <a class="el" href="osd-ldiskfs_2osd__handler_8c_source.html#l01413">osd_trans_stop()</a>.</p>

</div>
</div>
<a class="anchor" id="a4cda00ab64163413090407a8e12c7831"></a><!-- doxytag: member="lustre_quota.h::qsd_prepare" ref="a4cda00ab64163413090407a8e12c7831" args="(const struct lu_env *, struct qsd_instance *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int qsd_prepare </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qsd__lib_8c_source.html#l00656">656</a> of file <a class="el" href="qsd__lib_8c_source.html">qsd_lib.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="libcfs__debug_8h_source.html#l00287">LCONSOLE_ERROR</a>, <a class="el" href="lu__object_8h_source.html#l00283">lu_device::ld_site</a>, <a class="el" href="lquota__disk_8c_source.html#l00158">lquota_disk_dir_find_create()</a>, <a class="el" href="lquota__internal_8h_source.html#l00279">LQUOTA_LEAST_QUNIT</a>, <a class="el" href="lustre__idl_8h_source.html#l01917">LQUOTA_RES_DT</a>, <a class="el" href="lustre__idl_8h_source.html#l01916">LQUOTA_RES_MD</a>, <a class="el" href="lu__object_8h_source.html#l00619">lu_site::ls_top_dev</a>, <a class="el" href="lu__object_8h_source.html#l00399">lu_device_is_md()</a>, <a class="el" href="obd__mount__server_8c_source.html#l00405">lustre_register_lwp_item()</a>, <a class="el" href="lustre__idl_8h_source.html#l02959">MTI_NAME_MAXLEN</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_acct_failed</a>, <a class="el" href="qsd__lib_8c_source.html#l00232">qsd_conn_callback()</a>, <a class="el" href="qsd__internal_8h_source.html#l00052">qsd_instance::qsd_dev</a>, <a class="el" href="lustre__disk_8h_source.html#l00071">QSD_DIR</a>, <a class="el" href="qsd__internal_8h_source.html#l00059">qsd_instance::qsd_exp</a>, <a class="el" href="qsd__internal_8h_source.html#l00261">qsd_info()</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_is_md</a>, <a class="el" href="qsd__internal_8h_source.html#l00098">qsd_instance::qsd_lock</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_prepared</a>, <a class="el" href="qsd__lib_8c_source.html#l00360">qsd_qtype_init()</a>, <a class="el" href="qsd__internal_8h_source.html#l00065">qsd_instance::qsd_root</a>, <a class="el" href="qsd__reint_8c_source.html#l00624">qsd_start_reint_thread()</a>, <a class="el" href="qsd__writeback_8c_source.html#l00493">qsd_start_upd_thread()</a>, <a class="el" href="qsd__internal_8h_source.html#l00046">qsd_instance::qsd_svname</a>, <a class="el" href="qsd__internal_8h_source.html#l00103">qsd_instance::qsd_sync_threshold</a>, <a class="el" href="qsd__internal_8h_source.html#l00073">qsd_instance::qsd_type_array</a>, <a class="el" href="qsd__internal_8h_source.html#l00275">qsd_type_enabled()</a>, <a class="el" href="qsd__internal_8h_source.html#l00255">qsd_thread_info::qti_buf</a>, <a class="el" href="lquota__internal_8h_source.html#l00034">QTYPE_NAME</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="obd__mount__server_8c_source.html#l00349">tgt_name2lwp_name()</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="osd-ldiskfs_2osd__handler_8c_source.html#l06648">osd_prepare()</a>.</p>

</div>
</div>
<a class="anchor" id="af28106e42a71911a3e3822e1de0847aa"></a><!-- doxytag: member="lustre_quota.h::qsd_start" ref="af28106e42a71911a3e3822e1de0847aa" args="(const struct lu_env *, struct qsd_instance *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int qsd_start </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structqsd__instance.html">qsd_instance</a> *&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qsd__lib_8c_source.html#l00768">768</a> of file <a class="el" href="qsd__lib_8c_source.html">qsd_lib.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="qsd__internal_8h_source.html#l00160">qsd_qtype_info::qqi_reint_thread</a>, <a class="el" href="qsd__internal_8h_source.html#l00098">qsd_instance::qsd_lock</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_prepared</a>, <a class="el" href="qsd__internal_8h_source.html#l00110">qsd_instance::qsd_started</a>, <a class="el" href="qsd__internal_8h_source.html#l00046">qsd_instance::qsd_svname</a>, <a class="el" href="qsd__internal_8h_source.html#l00073">qsd_instance::qsd_type_array</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01532">ptlrpc_thread::t_ctl_waitq</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="osd-ldiskfs_2osd__handler_8c_source.html#l06580">osd_recovery_complete()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="aa5c890012613f369d8f8f8e09286aabe"></a><!-- doxytag: member="lustre_quota.h::dt_quota_bgrp_features" ref="aa5c890012613f369d8f8f8e09286aabe" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdt__index__features.html">dt_index_features</a> <a class="el" href="lustre__quota_8h.html#aa5c890012613f369d8f8f8e09286aabe">dt_quota_bgrp_features</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a57f8296a33771f506f3f992ea5c315a7"></a><!-- doxytag: member="lustre_quota.h::dt_quota_busr_features" ref="a57f8296a33771f506f3f992ea5c315a7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdt__index__features.html">dt_index_features</a> <a class="el" href="lustre__quota_8h.html#a57f8296a33771f506f3f992ea5c315a7">dt_quota_busr_features</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a5f865f56b037a36859f3a9aed32a0a1e"></a><!-- doxytag: member="lustre_quota.h::dt_quota_igrp_features" ref="a5f865f56b037a36859f3a9aed32a0a1e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdt__index__features.html">dt_index_features</a> <a class="el" href="lustre__quota_8h.html#a5f865f56b037a36859f3a9aed32a0a1e">dt_quota_igrp_features</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a75aa37d7ba5d6bf6eba75e73f2f9fbb1"></a><!-- doxytag: member="lustre_quota.h::dt_quota_iusr_features" ref="a75aa37d7ba5d6bf6eba75e73f2f9fbb1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdt__index__features.html">dt_index_features</a> <a class="el" href="lustre__quota_8h.html#a75aa37d7ba5d6bf6eba75e73f2f9fbb1">dt_quota_iusr_features</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a61f6cf34d1f0aa9b69fcb83477deab90"></a><!-- doxytag: member="lustre_quota.h::qmt_hdls" ref="a61f6cf34d1f0aa9b69fcb83477deab90" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structqmt__handlers.html">qmt_handlers</a> <a class="el" href="qmt__handler_8c.html#a61f6cf34d1f0aa9b69fcb83477deab90">qmt_hdls</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qmt__handler_8c_source.html#l00680">680</a> of file <a class="el" href="qmt__handler_8c_source.html">qmt_handler.c</a>.</p>

<p>Referenced by <a class="el" href="mdt__handler_8c_source.html#l03554">mdt_intent_opc()</a>, <a class="el" href="mdt__lvb_8c_source.html#l00095">mdt_lvbo_fill()</a>, <a class="el" href="mdt__lvb_8c_source.html#l00183">mdt_lvbo_free()</a>, <a class="el" href="mdt__lvb_8c_source.html#l00037">mdt_lvbo_init()</a>, <a class="el" href="mdt__lvb_8c_source.html#l00073">mdt_lvbo_size()</a>, <a class="el" href="mdt__lvb_8c_source.html#l00053">mdt_lvbo_update()</a>, <a class="el" href="mdt__handler_8c_source.html#l02192">mdt_quota_dqacq()</a>, and <a class="el" href="mdt__handler_8c_source.html#l02016">mdt_quotactl()</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:47 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
