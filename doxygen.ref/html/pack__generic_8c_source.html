<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/ptlrpc/pack_generic.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>lustre/ptlrpc/pack_generic.c</h1><a href="pack__generic_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * GPL HEADER START</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> * it under the terms of the GNU General Public License version 2 only,</span>
<a name="l00008"></a>00008 <span class="comment"> * as published by the Free Software Foundation.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * This program is distributed in the hope that it will be useful, but</span>
<a name="l00011"></a>00011 <span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00013"></a>00013 <span class="comment"> * General Public License version 2 for more details (a copy is included</span>
<a name="l00014"></a>00014 <span class="comment"> * in the LICENSE file that accompanied this code).</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> * version 2 along with this program; If not, see</span>
<a name="l00018"></a>00018 <span class="comment"> * http://www.sun.com/software/products/lustre/docs/GPLv2.pdf</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * Please contact Sun Microsystems, Inc., 4150 Network Circle, Santa Clara,</span>
<a name="l00021"></a>00021 <span class="comment"> * CA 95054 USA or visit www.sun.com if you need additional information or</span>
<a name="l00022"></a>00022 <span class="comment"> * have any questions.</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * GPL HEADER END</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 <span class="comment">/*</span>
<a name="l00027"></a>00027 <span class="comment"> * Copyright (c) 2002, 2010, Oracle and/or its affiliates. All rights reserved.</span>
<a name="l00028"></a>00028 <span class="comment"> * Use is subject to license terms.</span>
<a name="l00029"></a>00029 <span class="comment"> *</span>
<a name="l00030"></a>00030 <span class="comment"> * Copyright (c) 2011, 2015, Intel Corporation.</span>
<a name="l00031"></a>00031 <span class="comment"> */</span>
<a name="l00032"></a>00032 <span class="comment">/*</span>
<a name="l00033"></a>00033 <span class="comment"> * This file is part of Lustre, http://www.lustre.org/</span>
<a name="l00034"></a>00034 <span class="comment"> * Lustre is a trademark of Sun Microsystems, Inc.</span>
<a name="l00035"></a>00035 <span class="comment"> *</span>
<a name="l00036"></a>00036 <span class="comment"> * lustre/ptlrpc/pack_generic.c</span>
<a name="l00037"></a>00037 <span class="comment"> *</span>
<a name="l00038"></a>00038 <span class="comment"> * (Un)packing of OST requests</span>
<a name="l00039"></a>00039 <span class="comment"> *</span>
<a name="l00040"></a>00040 <span class="comment"> * Author: Peter J. Braam &lt;braam@clusterfs.com&gt;</span>
<a name="l00041"></a>00041 <span class="comment"> * Author: Phil Schwan &lt;phil@clusterfs.com&gt;</span>
<a name="l00042"></a>00042 <span class="comment"> * Author: Eric Barton &lt;eeb@clusterfs.com&gt;</span>
<a name="l00043"></a>00043 <span class="comment"> */</span>
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="pack__generic_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">00045</a> <span class="preprocessor">#define DEBUG_SUBSYSTEM S_RPC</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;<a class="code" href="libcfs_8h.html">libcfs/libcfs.h</a>&gt;</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;<a class="code" href="ll__fiemap_8h.html">lustre/ll_fiemap.h</a>&gt;</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;<a class="code" href="llog__swab_8h.html">llog_swab.h</a>&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;<a class="code" href="lustre__net_8h.html">lustre_net.h</a>&gt;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &lt;<a class="code" href="lustre__swab_8h.html">lustre_swab.h</a>&gt;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &lt;<a class="code" href="obd__cksum_8h.html">obd_cksum.h</a>&gt;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &lt;<a class="code" href="obd__class_8h.html">obd_class.h</a>&gt;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &lt;<a class="code" href="obd__support_8h.html">obd_support.h</a>&gt;</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="ptlrpc__internal_8h.html">ptlrpc_internal.h</a>&quot;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="pack__generic_8c.html#a6e11ffbe975c84147fd948f0f7585ad5">00060</a> <span class="keyword">static</span> <span class="keyword">inline</span> __u32 <a class="code" href="pack__generic_8c.html#a6e11ffbe975c84147fd948f0f7585ad5">lustre_msg_hdr_size_v2</a>(__u32 count)
<a name="l00061"></a>00061 {
<a name="l00062"></a>00062         <span class="keywordflow">return</span> <a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">cfs_size_round</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(<span class="keyword">struct</span> <a class="code" href="structlustre__msg__v2.html">lustre_msg_v2</a>,
<a name="l00063"></a>00063                                        lm_buflens[count]));
<a name="l00064"></a>00064 }
<a name="l00065"></a>00065 
<a name="l00066"></a><a class="code" href="group__net.html#gaff9112552bf89bd375921061a1dd2b85">00066</a> __u32 <a class="code" href="group__net.html#gaff9112552bf89bd375921061a1dd2b85">lustre_msg_hdr_size</a>(__u32 magic, __u32 count)
<a name="l00067"></a>00067 {
<a name="l00068"></a>00068         <span class="keywordflow">switch</span> (magic) {
<a name="l00069"></a>00069         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00070"></a>00070                 <span class="keywordflow">return</span> <a class="code" href="pack__generic_8c.html#a6e11ffbe975c84147fd948f0f7585ad5">lustre_msg_hdr_size_v2</a>(count);
<a name="l00071"></a>00071         <span class="keywordflow">default</span>:
<a name="l00072"></a>00072                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, magic);
<a name="l00073"></a>00073                 <span class="keywordflow">return</span> 0;
<a name="l00074"></a>00074         }
<a name="l00075"></a>00075 }
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="group__net.html#ga6920d79557ab62c16abd7c03d5f27ed7">00077</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga6920d79557ab62c16abd7c03d5f27ed7">ptlrpc_buf_set_swabbed</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req, <span class="keyword">const</span> <span class="keywordtype">int</span> inout,
<a name="l00078"></a>00078                             __u32 index)
<a name="l00079"></a>00079 {
<a name="l00080"></a>00080         <span class="keywordflow">if</span> (inout)
<a name="l00081"></a>00081                 <a class="code" href="group__net.html#ga22d3ca15bd8e1bb881b078fd04381ab0" title="Mark request buffer at offset index that it was already swabbed.">lustre_set_req_swabbed</a>(req, index);
<a name="l00082"></a>00082         <span class="keywordflow">else</span>
<a name="l00083"></a>00083                 <a class="code" href="group__net.html#gad4b6df694791481d94ff9f1ad1ea539b" title="Mark request reply buffer at offset index that it was already swabbed.">lustre_set_rep_swabbed</a>(req, index);
<a name="l00084"></a>00084 }
<a name="l00085"></a>00085 
<a name="l00086"></a><a class="code" href="group__net.html#gaa22239843a54a1577998de2a44fd8af7">00086</a> <span class="keywordtype">int</span> <a class="code" href="group__net.html#gaa22239843a54a1577998de2a44fd8af7" title="ptlrpc msg buffer and swab interface">ptlrpc_buf_need_swab</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req, <span class="keyword">const</span> <span class="keywordtype">int</span> inout,
<a name="l00087"></a>00087                          __u32 index)
<a name="l00088"></a>00088 {
<a name="l00089"></a>00089         <span class="keywordflow">if</span> (inout)
<a name="l00090"></a>00090                 <span class="keywordflow">return</span> (<a class="code" href="group__net.html#ga63e57d4ee82cc1841fd1206a8aa2c911" title="Returns 1 if request needs to be swabbed into local cpu byteorder.">ptlrpc_req_need_swab</a>(req) &amp;&amp;
<a name="l00091"></a>00091                         !<a class="code" href="group__net.html#ga97210df2b7b859cbbab53473e6cfec93" title="Returns 1 if request buffer at offset index was already swabbed.">lustre_req_swabbed</a>(req, index));
<a name="l00092"></a>00092         <span class="keywordflow">else</span>
<a name="l00093"></a>00093                 <span class="keywordflow">return</span> (<a class="code" href="group__net.html#ga0b3a5500b0280eeb94b4ff22212350b6" title="Returns 1 if request reply needs to be swabbed into local cpu byteorder.">ptlrpc_rep_need_swab</a>(req) &amp;&amp;
<a name="l00094"></a>00094                         !<a class="code" href="group__net.html#ga5f979a04012e6bbb25233e7580676f92" title="Returns 1 if request reply buffer at offset index was already swabbed.">lustre_rep_swabbed</a>(req, index));
<a name="l00095"></a>00095 }
<a name="l00096"></a>00096 
<a name="l00097"></a><a class="code" href="pack__generic_8c.html#aaa9ff74268c6d2d505c87b3018637f9c">00097</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="pack__generic_8c.html#aaa9ff74268c6d2d505c87b3018637f9c">lustre_msg_check_version_v2</a>(<span class="keyword">struct</span> <a class="code" href="structlustre__msg__v2.html">lustre_msg_v2</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>,
<a name="l00098"></a>00098                                                 __u32 <a class="code" href="packet-lnet_8c.html#a0a5c5891c90b30e72f5cfca80915338e">version</a>)
<a name="l00099"></a>00099 {
<a name="l00100"></a>00100         __u32 ver = <a class="code" href="group__net.html#ga89d53cb5a8d4f00ed4c92a25969c444d">lustre_msg_get_version</a>(msg);
<a name="l00101"></a>00101         <span class="keywordflow">return</span> (ver &amp; <a class="code" href="packet-lustre_8c.html#a8023d23bbb5d4c5c63320f368f171c23">LUSTRE_VERSION_MASK</a>) != version;
<a name="l00102"></a>00102 }
<a name="l00103"></a>00103 
<a name="l00104"></a><a class="code" href="group__net.html#gac7a9b2c131fb724a634b28295311e90d">00104</a> <span class="keywordtype">int</span> <a class="code" href="group__net.html#gac7a9b2c131fb724a634b28295311e90d">lustre_msg_check_version</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 <a class="code" href="packet-lnet_8c.html#a0a5c5891c90b30e72f5cfca80915338e">version</a>)
<a name="l00105"></a>00105 {
<a name="l00106"></a>00106 <span class="preprocessor">#define LUSTRE_MSG_MAGIC_V1 0x0BD00BD0</span>
<a name="l00107"></a>00107 <span class="preprocessor"></span>        <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00108"></a>00108         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#af50918768b3f7392c31f72fcb6bb5973">LUSTRE_MSG_MAGIC_V1</a>:
<a name="l00109"></a>00109                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;msg v1 not supported - please upgrade you system\n&quot;</span>);
<a name="l00110"></a>00110                 <span class="keywordflow">return</span> -EINVAL;
<a name="l00111"></a>00111         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00112"></a>00112                 <span class="keywordflow">return</span> <a class="code" href="pack__generic_8c.html#aaa9ff74268c6d2d505c87b3018637f9c">lustre_msg_check_version_v2</a>(msg, version);
<a name="l00113"></a>00113         <span class="keywordflow">default</span>:
<a name="l00114"></a>00114                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00115"></a>00115                 <span class="keywordflow">return</span> -EPROTO;
<a name="l00116"></a>00116         }
<a name="l00117"></a>00117 <span class="preprocessor">#undef LUSTRE_MSG_MAGIC_V1</span>
<a name="l00118"></a>00118 <span class="preprocessor"></span>}
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="comment">/* early reply size */</span>
<a name="l00121"></a><a class="code" href="group__net.html#ga0ec5cd43001c5914c7921da08598ba0c">00121</a> __u32 <a class="code" href="group__net.html#ga0ec5cd43001c5914c7921da08598ba0c">lustre_msg_early_size</a>()
<a name="l00122"></a>00122 {
<a name="l00123"></a>00123         <span class="keyword">static</span> __u32 <a class="code" href="lp__utils_8h.html#a439227feff9d7f55384e8780cfc2eb82">size</a>;
<a name="l00124"></a>00124         <span class="keywordflow">if</span> (!size) {
<a name="l00125"></a>00125                 <span class="comment">/* Always reply old ptlrpc_body_v2 to keep interoprability</span>
<a name="l00126"></a>00126 <span class="comment">                 * with the old client (&lt; 2.3) which doesn&apos;t have pb_jobid</span>
<a name="l00127"></a>00127 <span class="comment">                 * in the ptlrpc_body.</span>
<a name="l00128"></a>00128 <span class="comment">                 *</span>
<a name="l00129"></a>00129 <span class="comment">                 * XXX Remove this whenever we dorp interoprability with such</span>
<a name="l00130"></a>00130 <span class="comment">                 *     client.</span>
<a name="l00131"></a>00131 <span class="comment">                 */</span>
<a name="l00132"></a>00132                 __u32 pblen = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structptlrpc__body__v2.html">ptlrpc_body_v2</a>);
<a name="l00133"></a>00133                 size = <a class="code" href="group__net.html#ga32c4986e896273a264d87bbc5d28bc70">lustre_msg_size</a>(<a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>, 1, &amp;pblen);
<a name="l00134"></a>00134         }
<a name="l00135"></a>00135         <span class="keywordflow">return</span> size;
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga0ec5cd43001c5914c7921da08598ba0c">lustre_msg_early_size</a>);
<a name="l00138"></a>00138 
<a name="l00139"></a><a class="code" href="group__net.html#ga4a6268b0e3e950415cc3d4900b744f5d">00139</a> __u32 <a class="code" href="group__net.html#ga4a6268b0e3e950415cc3d4900b744f5d">lustre_msg_size_v2</a>(<span class="keywordtype">int</span> count, __u32 *lengths)
<a name="l00140"></a>00140 {
<a name="l00141"></a>00141         __u32 <a class="code" href="lp__utils_8h.html#a439227feff9d7f55384e8780cfc2eb82">size</a>;
<a name="l00142"></a>00142         <span class="keywordtype">int</span> i;
<a name="l00143"></a>00143 
<a name="l00144"></a>00144         size = <a class="code" href="pack__generic_8c.html#a6e11ffbe975c84147fd948f0f7585ad5">lustre_msg_hdr_size_v2</a>(count);
<a name="l00145"></a>00145         <span class="keywordflow">for</span> (i = 0; i &lt; count; i++)
<a name="l00146"></a>00146                 size += <a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">cfs_size_round</a>(lengths[i]);
<a name="l00147"></a>00147 
<a name="l00148"></a>00148         <span class="keywordflow">return</span> size;
<a name="l00149"></a>00149 }
<a name="l00150"></a>00150 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga4a6268b0e3e950415cc3d4900b744f5d">lustre_msg_size_v2</a>);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 <span class="comment">/* This returns the size of the buffer that is required to hold a lustre_msg</span>
<a name="l00153"></a>00153 <span class="comment"> * with the given sub-buffer lengths.</span>
<a name="l00154"></a>00154 <span class="comment"> * NOTE: this should only be used for NEW requests, and should always be</span>
<a name="l00155"></a>00155 <span class="comment"> *       in the form of a v2 request.  If this is a connection to a v1</span>
<a name="l00156"></a>00156 <span class="comment"> *       target then the first buffer will be stripped because the ptlrpc</span>
<a name="l00157"></a>00157 <span class="comment"> *       data is part of the lustre_msg_v1 header. b=14043 */</span>
<a name="l00158"></a><a class="code" href="group__net.html#ga32c4986e896273a264d87bbc5d28bc70">00158</a> __u32 <a class="code" href="group__net.html#ga32c4986e896273a264d87bbc5d28bc70">lustre_msg_size</a>(__u32 magic, <span class="keywordtype">int</span> count, __u32 *lens)
<a name="l00159"></a>00159 {
<a name="l00160"></a>00160         __u32 <a class="code" href="lp__utils_8h.html#a439227feff9d7f55384e8780cfc2eb82">size</a>[] = { <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a>) };
<a name="l00161"></a>00161 
<a name="l00162"></a>00162         <span class="keywordflow">if</span> (!lens) {
<a name="l00163"></a>00163                 <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(count == 1);
<a name="l00164"></a>00164                 lens = size;
<a name="l00165"></a>00165         }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(count &gt; 0);
<a name="l00168"></a>00168         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(lens[<a class="code" href="group__lustreidl.html#gad7ddfc6368a84f8cf442c0d4aabcbdc8">MSG_PTLRPC_BODY_OFF</a>] &gt;= <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__body__v2.html">ptlrpc_body_v2</a>));
<a name="l00169"></a>00169 
<a name="l00170"></a>00170         <span class="keywordflow">switch</span> (magic) {
<a name="l00171"></a>00171         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00172"></a>00172                 <span class="keywordflow">return</span> <a class="code" href="group__net.html#ga4a6268b0e3e950415cc3d4900b744f5d">lustre_msg_size_v2</a>(count, lens);
<a name="l00173"></a>00173         <span class="keywordflow">default</span>:
<a name="l00174"></a>00174                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, magic);
<a name="l00175"></a>00175                 <span class="keywordflow">return</span> 0;
<a name="l00176"></a>00176         }
<a name="l00177"></a>00177 }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 <span class="comment">/* This is used to determine the size of a buffer that was already packed</span>
<a name="l00180"></a>00180 <span class="comment"> * and will correctly handle the different message formats. */</span>
<a name="l00181"></a><a class="code" href="group__net.html#ga39c3c778d0a57ae7fa1d99ca0b9650f1">00181</a> __u32 <a class="code" href="group__net.html#ga39c3c778d0a57ae7fa1d99ca0b9650f1">lustre_packed_msg_size</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l00182"></a>00182 {
<a name="l00183"></a>00183         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00184"></a>00184         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00185"></a>00185                 <span class="keywordflow">return</span> <a class="code" href="group__net.html#ga4a6268b0e3e950415cc3d4900b744f5d">lustre_msg_size_v2</a>(msg-&gt;lm_bufcount, msg-&gt;lm_buflens);
<a name="l00186"></a>00186         <span class="keywordflow">default</span>:
<a name="l00187"></a>00187                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00188"></a>00188                 <span class="keywordflow">return</span> 0;
<a name="l00189"></a>00189         }
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="group__net.html#ga675f94ce12272868d6f12b98ee1def0d">00192</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga675f94ce12272868d6f12b98ee1def0d">lustre_init_msg_v2</a>(<span class="keyword">struct</span> <a class="code" href="structlustre__msg__v2.html">lustre_msg_v2</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <span class="keywordtype">int</span> count, __u32 *lens,
<a name="l00193"></a>00193                         <span class="keywordtype">char</span> **bufs)
<a name="l00194"></a>00194 {
<a name="l00195"></a>00195         <span class="keywordtype">char</span> *ptr;
<a name="l00196"></a>00196         <span class="keywordtype">int</span> i;
<a name="l00197"></a>00197 
<a name="l00198"></a>00198         msg-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a> = count;
<a name="l00199"></a>00199         <span class="comment">/* XXX: lm_secflvr uninitialized here */</span>
<a name="l00200"></a>00200         msg-&gt;<a class="code" href="structlustre__msg__v2.html#a27b4fa911830bfadb492098308a557af">lm_magic</a> = <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>;
<a name="l00201"></a>00201 
<a name="l00202"></a>00202         <span class="keywordflow">for</span> (i = 0; i &lt; count; i++)
<a name="l00203"></a>00203                 msg-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>[i] = lens[i];
<a name="l00204"></a>00204 
<a name="l00205"></a>00205         if (bufs == NULL)
<a name="l00206"></a>00206                 <span class="keywordflow">return</span>;
<a name="l00207"></a>00207 
<a name="l00208"></a>00208         ptr = (<span class="keywordtype">char</span> *)msg + <a class="code" href="pack__generic_8c.html#a6e11ffbe975c84147fd948f0f7585ad5">lustre_msg_hdr_size_v2</a>(count);
<a name="l00209"></a>00209         <span class="keywordflow">for</span> (i = 0; i &lt; count; i++) {
<a name="l00210"></a>00210                 <span class="keywordtype">char</span> *tmp = bufs[i];
<a name="l00211"></a>00211                 <a class="code" href="libcfs__private_8h.html#abad18fd5c280d235e05d3abcb49c24f1">LOGL</a>(tmp, lens[i], ptr);
<a name="l00212"></a>00212         }
<a name="l00213"></a>00213 }
<a name="l00214"></a>00214 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga675f94ce12272868d6f12b98ee1def0d">lustre_init_msg_v2</a>);
<a name="l00215"></a>00215 
<a name="l00216"></a><a class="code" href="pack__generic_8c.html#aa0c5fa57a8a305ecf9e97f758e5688b4">00216</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="pack__generic_8c.html#aa0c5fa57a8a305ecf9e97f758e5688b4">lustre_pack_request_v2</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req,
<a name="l00217"></a>00217                                   <span class="keywordtype">int</span> count, __u32 *lens, <span class="keywordtype">char</span> **bufs)
<a name="l00218"></a>00218 {
<a name="l00219"></a>00219         <span class="keywordtype">int</span> reqlen, rc;
<a name="l00220"></a>00220 
<a name="l00221"></a>00221         reqlen = <a class="code" href="group__net.html#ga4a6268b0e3e950415cc3d4900b744f5d">lustre_msg_size_v2</a>(count, lens);
<a name="l00222"></a>00222 
<a name="l00223"></a>00223         rc = <a class="code" href="group__sptlrpc.html#gaafb426af1f450b0f25952ba1b38f640d" title="Used by ptlrpc client to allocate request buffer of req.">sptlrpc_cli_alloc_reqbuf</a>(req, reqlen);
<a name="l00224"></a>00224         <span class="keywordflow">if</span> (rc)
<a name="l00225"></a>00225                 <span class="keywordflow">return</span> rc;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227         req-&gt;<a class="code" href="structptlrpc__request.html#a9746010150c167d5b6e62786d61f18df" title="Request length.">rq_reqlen</a> = reqlen;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229         <a class="code" href="group__net.html#ga675f94ce12272868d6f12b98ee1def0d">lustre_init_msg_v2</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>, count, lens, bufs);
<a name="l00230"></a>00230         <a class="code" href="group__net.html#ga066a801c595cf650dd7538bf3e8f773a">lustre_msg_add_version</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>, <a class="code" href="group__lustreidl.html#gafd8fb38cd999df7c7b4eafca9aeafd78">PTLRPC_MSG_VERSION</a>);
<a name="l00231"></a>00231         <span class="keywordflow">return</span> 0;
<a name="l00232"></a>00232 }
<a name="l00233"></a>00233 
<a name="l00234"></a><a class="code" href="group__net.html#gaaf9e68de9b741fc678c0427fd15a9763">00234</a> <span class="keywordtype">int</span> <a class="code" href="group__net.html#gaaf9e68de9b741fc678c0427fd15a9763">lustre_pack_request</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req, __u32 magic, <span class="keywordtype">int</span> count,
<a name="l00235"></a>00235                         __u32 *lens, <span class="keywordtype">char</span> **bufs)
<a name="l00236"></a>00236 {
<a name="l00237"></a>00237         __u32 size[] = { <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a>) };
<a name="l00238"></a>00238 
<a name="l00239"></a>00239         <span class="keywordflow">if</span> (!lens) {
<a name="l00240"></a>00240                 <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(count == 1);
<a name="l00241"></a>00241                 lens = size;
<a name="l00242"></a>00242         }
<a name="l00243"></a>00243 
<a name="l00244"></a>00244         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(count &gt; 0);
<a name="l00245"></a>00245         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(lens[<a class="code" href="group__lustreidl.html#gad7ddfc6368a84f8cf442c0d4aabcbdc8">MSG_PTLRPC_BODY_OFF</a>] == <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a>));
<a name="l00246"></a>00246 
<a name="l00247"></a>00247         <span class="comment">/* only use new format, we don&apos;t need to be compatible with 1.4 */</span>
<a name="l00248"></a>00248         magic = <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>;
<a name="l00249"></a>00249 
<a name="l00250"></a>00250         <span class="keywordflow">switch</span> (magic) {
<a name="l00251"></a>00251         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00252"></a>00252                 <span class="keywordflow">return</span> <a class="code" href="pack__generic_8c.html#aa0c5fa57a8a305ecf9e97f758e5688b4">lustre_pack_request_v2</a>(req, count, lens, bufs);
<a name="l00253"></a>00253         <span class="keywordflow">default</span>:
<a name="l00254"></a>00254                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, magic);
<a name="l00255"></a>00255                 <span class="keywordflow">return</span> -EINVAL;
<a name="l00256"></a>00256         }
<a name="l00257"></a>00257 }
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 <span class="preprocessor">#if RS_DEBUG</span>
<a name="l00260"></a>00260 <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a> ptlrpc_rs_debug_lru =
<a name="l00261"></a>00261         <a class="code" href="list_8h.html#a4642d4b7df28478bb762fe43c85b5c63">LIST_HEAD_INIT</a>(ptlrpc_rs_debug_lru);
<a name="l00262"></a>00262 spinlock_t ptlrpc_rs_debug_lock;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 <span class="preprocessor">#define PTLRPC_RS_DEBUG_LRU_ADD(rs)                                     \</span>
<a name="l00265"></a>00265 <span class="preprocessor">do {                                                                    \</span>
<a name="l00266"></a>00266 <span class="preprocessor">        spin_lock(&amp;ptlrpc_rs_debug_lock);                               \</span>
<a name="l00267"></a>00267 <span class="preprocessor">        list_add_tail(&amp;(rs)-&gt;rs_debug_list, &amp;ptlrpc_rs_debug_lru);      \</span>
<a name="l00268"></a>00268 <span class="preprocessor">        spin_unlock(&amp;ptlrpc_rs_debug_lock);                             \</span>
<a name="l00269"></a>00269 <span class="preprocessor">} while (0)</span>
<a name="l00270"></a>00270 <span class="preprocessor"></span>
<a name="l00271"></a>00271 <span class="preprocessor">#define PTLRPC_RS_DEBUG_LRU_DEL(rs)                                     \</span>
<a name="l00272"></a>00272 <span class="preprocessor">do {                                                                    \</span>
<a name="l00273"></a>00273 <span class="preprocessor">        spin_lock(&amp;ptlrpc_rs_debug_lock);                               \</span>
<a name="l00274"></a>00274 <span class="preprocessor">        list_del(&amp;(rs)-&gt;rs_debug_list);                         \</span>
<a name="l00275"></a>00275 <span class="preprocessor">        spin_unlock(&amp;ptlrpc_rs_debug_lock);                             \</span>
<a name="l00276"></a>00276 <span class="preprocessor">} while (0)</span>
<a name="l00277"></a>00277 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00278"></a><a class="code" href="pack__generic_8c.html#a98e1627e1c5e64232b0dd624a1e86f56">00278</a> <span class="preprocessor"></span><span class="preprocessor"># define PTLRPC_RS_DEBUG_LRU_ADD(rs) do {} while(0)</span>
<a name="l00279"></a><a class="code" href="pack__generic_8c.html#afa708baa5902108efc6eca6900622cfc">00279</a> <span class="preprocessor"></span><span class="preprocessor"># define PTLRPC_RS_DEBUG_LRU_DEL(rs) do {} while(0)</span>
<a name="l00280"></a>00280 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00281"></a>00281 <span class="preprocessor"></span>
<a name="l00282"></a>00282 <span class="keyword">struct </span><a class="code" href="structptlrpc__reply__state.html" title="Structure to define reply state on the server Reply state holds various reply message...">ptlrpc_reply_state</a> *
<a name="l00283"></a><a class="code" href="ptlrpc__internal_8h.html#ac6bc1814a6d8c411e923f7691095ba94">00283</a> <a class="code" href="pack__generic_8c.html#ac6bc1814a6d8c411e923f7691095ba94">lustre_get_emerg_rs</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__service__part.html" title="Definition of PortalRPC service partition data.">ptlrpc_service_part</a> *svcpt)
<a name="l00284"></a>00284 {
<a name="l00285"></a>00285         <span class="keyword">struct </span><a class="code" href="structptlrpc__reply__state.html" title="Structure to define reply state on the server Reply state holds various reply message...">ptlrpc_reply_state</a> *rs = NULL;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287         spin_lock(&amp;svcpt-&gt;scp_rep_lock);
<a name="l00288"></a>00288 
<a name="l00289"></a>00289         <span class="comment">/* See if we have anything in a pool, and wait if nothing */</span>
<a name="l00290"></a>00290         <span class="keywordflow">while</span> (<a class="code" href="list_8h.html#a0fce12be81e8f2677b3a272fee1652ac" title="Test whether a list is empty.">list_empty</a>(&amp;svcpt-&gt;<a class="code" href="structptlrpc__service__part.html#a1ba1dd17ce94daf0c4b82611d2203b77" title="List of free reply_states.">scp_rep_idle</a>)) {
<a name="l00291"></a>00291                 <span class="keyword">struct </span><a class="code" href="structl__wait__info.html">l_wait_info</a>      lwi;
<a name="l00292"></a>00292                 <span class="keywordtype">int</span>                     rc;
<a name="l00293"></a>00293 
<a name="l00294"></a>00294                 spin_unlock(&amp;svcpt-&gt;scp_rep_lock);
<a name="l00295"></a>00295                 <span class="comment">/* If we cannot get anything for some long time, we better</span>
<a name="l00296"></a>00296 <span class="comment">                 * bail out instead of waiting infinitely */</span>
<a name="l00297"></a>00297                 lwi = <a class="code" href="group__lib.html#ga2c8a9c91f1f21e7ff21abedc365140f9">LWI_TIMEOUT</a>(<a class="code" href="linux-time_8h.html#a025b413736cfecdc30256f4e5d3d2605">cfs_time_seconds</a>(10), NULL, NULL);
<a name="l00298"></a>00298                 rc = <a class="code" href="group__lib.html#ga277da3a4d12da2eb0be28a20ba56d900">l_wait_event</a>(svcpt-&gt;<a class="code" href="structptlrpc__service__part.html#a2053b8073689ec3cedd16a7095656a13" title="waitq to run, when adding stuff to srv_free_rs_list">scp_rep_waitq</a>,
<a name="l00299"></a>00299                                   !<a class="code" href="list_8h.html#a0fce12be81e8f2677b3a272fee1652ac" title="Test whether a list is empty.">list_empty</a>(&amp;svcpt-&gt;<a class="code" href="structptlrpc__service__part.html#a1ba1dd17ce94daf0c4b82611d2203b77" title="List of free reply_states.">scp_rep_idle</a>), &amp;lwi);
<a name="l00300"></a>00300                 <span class="keywordflow">if</span> (rc != 0)
<a name="l00301"></a>00301                         <span class="keywordflow">goto</span> out;
<a name="l00302"></a>00302                 spin_lock(&amp;svcpt-&gt;scp_rep_lock);
<a name="l00303"></a>00303         }
<a name="l00304"></a>00304 
<a name="l00305"></a>00305         rs = <a class="code" href="list_8h.html#a26c976b7f654e70df318c1843e5094de" title="Get the container of a list.">list_entry</a>(svcpt-&gt;<a class="code" href="structptlrpc__service__part.html#a1ba1dd17ce94daf0c4b82611d2203b77" title="List of free reply_states.">scp_rep_idle</a>.<a class="code" href="structlist__head.html#ac3b0ff0dfb978a0cfbdad6b9d19cdcfe">next</a>,
<a name="l00306"></a>00306                             <span class="keyword">struct</span> <a class="code" href="structptlrpc__reply__state.html" title="Structure to define reply state on the server Reply state holds various reply message...">ptlrpc_reply_state</a>, rs_list);
<a name="l00307"></a>00307         <a class="code" href="list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title="Remove an entry from the list it is currently in.">list_del</a>(&amp;rs-&gt;<a class="code" href="structptlrpc__reply__state.html#ae257df3424c4ec7aaf280aaee8a440fd" title="Linkage for list of all reply states in a system.">rs_list</a>);
<a name="l00308"></a>00308 
<a name="l00309"></a>00309         spin_unlock(&amp;svcpt-&gt;scp_rep_lock);
<a name="l00310"></a>00310 
<a name="l00311"></a>00311         memset(rs, 0, svcpt-&gt;scp_service-&gt;srv_max_reply_size);
<a name="l00312"></a>00312         rs-&gt;<a class="code" href="structptlrpc__reply__state.html#abd444372b3d524a011b825249ea1a7b6" title="Size of the state.">rs_size</a> = svcpt-&gt;scp_service-&gt;srv_max_reply_size;
<a name="l00313"></a>00313         rs-&gt;<a class="code" href="structptlrpc__reply__state.html#aca1f0b4b5dc96eb0b9c8c7012cfa4ba4">rs_svcpt</a> = svcpt;
<a name="l00314"></a>00314         rs-&gt;<a class="code" href="structptlrpc__reply__state.html#a3d47ca6daf59da05c9ea672ecf54bf96">rs_prealloc</a> = 1;
<a name="l00315"></a>00315 out:
<a name="l00316"></a>00316         <span class="keywordflow">return</span> rs;
<a name="l00317"></a>00317 }
<a name="l00318"></a>00318 
<a name="l00319"></a><a class="code" href="ptlrpc__internal_8h.html#a2616d6293a96a4c602d5b649af8f1496">00319</a> <span class="keywordtype">void</span> <a class="code" href="pack__generic_8c.html#a2616d6293a96a4c602d5b649af8f1496">lustre_put_emerg_rs</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__reply__state.html" title="Structure to define reply state on the server Reply state holds various reply message...">ptlrpc_reply_state</a> *rs)
<a name="l00320"></a>00320 {
<a name="l00321"></a>00321         <span class="keyword">struct </span><a class="code" href="structptlrpc__service__part.html" title="Definition of PortalRPC service partition data.">ptlrpc_service_part</a> *svcpt = rs-&gt;<a class="code" href="structptlrpc__reply__state.html#aca1f0b4b5dc96eb0b9c8c7012cfa4ba4">rs_svcpt</a>;
<a name="l00322"></a>00322 
<a name="l00323"></a>00323         spin_lock(&amp;svcpt-&gt;scp_rep_lock);
<a name="l00324"></a>00324         <a class="code" href="list_8h.html#a0373c4b3c8ce51a451a569ad978b32e1" title="Insert an entry at the start of a list.">list_add</a>(&amp;rs-&gt;<a class="code" href="structptlrpc__reply__state.html#ae257df3424c4ec7aaf280aaee8a440fd" title="Linkage for list of all reply states in a system.">rs_list</a>, &amp;svcpt-&gt;<a class="code" href="structptlrpc__service__part.html#a1ba1dd17ce94daf0c4b82611d2203b77" title="List of free reply_states.">scp_rep_idle</a>);
<a name="l00325"></a>00325         spin_unlock(&amp;svcpt-&gt;scp_rep_lock);
<a name="l00326"></a>00326         wake_up(&amp;svcpt-&gt;<a class="code" href="structptlrpc__service__part.html#a2053b8073689ec3cedd16a7095656a13" title="waitq to run, when adding stuff to srv_free_rs_list">scp_rep_waitq</a>);
<a name="l00327"></a>00327 }
<a name="l00328"></a>00328 
<a name="l00329"></a><a class="code" href="group__net.html#ga33e4ff610e2b182cd78c74131c847cb0">00329</a> <span class="keywordtype">int</span> <a class="code" href="group__net.html#ga33e4ff610e2b182cd78c74131c847cb0">lustre_pack_reply_v2</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req, <span class="keywordtype">int</span> count,
<a name="l00330"></a>00330                          __u32 *lens, <span class="keywordtype">char</span> **bufs, <span class="keywordtype">int</span> flags)
<a name="l00331"></a>00331 {
<a name="l00332"></a>00332         <span class="keyword">struct </span><a class="code" href="structptlrpc__reply__state.html" title="Structure to define reply state on the server Reply state holds various reply message...">ptlrpc_reply_state</a> *rs;
<a name="l00333"></a>00333         <span class="keywordtype">int</span>                        msg_len, rc;
<a name="l00334"></a>00334         <a class="code" href="flock_8c.html#affebc0cf7e41098a8c78a8c2c4586d72">ENTRY</a>;
<a name="l00335"></a>00335 
<a name="l00336"></a>00336         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(req-&gt;rq_reply_state == NULL);
<a name="l00337"></a>00337 
<a name="l00338"></a>00338         <span class="keywordflow">if</span> ((flags &amp; <a class="code" href="group__net.html#ga199fecbfb969a5e469f5f84fcffa12a4">LPRFL_EARLY_REPLY</a>) == 0) {
<a name="l00339"></a>00339                 spin_lock(&amp;req-&gt;<a class="code" href="structptlrpc__request.html#afb9723e194dc3b27d3721e45e5428d62" title="Lock to protect request flags and some other important bits, like rq_list.">rq_lock</a>);
<a name="l00340"></a>00340                 req-&gt;<a class="code" href="structptlrpc__request.html#aadfcdd8f9119f3f92f018aae66c6ffce" title="packed final reply">rq_packed_final</a> = 1;
<a name="l00341"></a>00341                 spin_unlock(&amp;req-&gt;<a class="code" href="structptlrpc__request.html#afb9723e194dc3b27d3721e45e5428d62" title="Lock to protect request flags and some other important bits, like rq_list.">rq_lock</a>);
<a name="l00342"></a>00342         }
<a name="l00343"></a>00343 
<a name="l00344"></a>00344         msg_len = <a class="code" href="group__net.html#ga4a6268b0e3e950415cc3d4900b744f5d">lustre_msg_size_v2</a>(count, lens);
<a name="l00345"></a>00345         rc = <a class="code" href="group__sptlrpc.html#ga1bcf6cf901c5c461f6f273a9b764430a" title="Used by ptlrpc server, to allocate reply buffer for req.">sptlrpc_svc_alloc_rs</a>(req, msg_len);
<a name="l00346"></a>00346         <span class="keywordflow">if</span> (rc)
<a name="l00347"></a>00347                 <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(rc);
<a name="l00348"></a>00348 
<a name="l00349"></a>00349         rs = req-&gt;rq_reply_state;
<a name="l00350"></a>00350         atomic_set(&amp;rs-&gt;<a class="code" href="structptlrpc__reply__state.html#a08c5bc984187398da6b6c17e3d2874e1">rs_refcount</a>, 1);        <span class="comment">/* 1 ref for rq_reply_state */</span>
<a name="l00351"></a>00351         rs-&gt;<a class="code" href="structptlrpc__reply__state.html#a822cfc83a489857d3511fc0bb49de345" title="Callback description.">rs_cb_id</a>.<a class="code" href="structptlrpc__cb__id.html#a58f3b9cf321abbbda3162af4e35c310e">cbid_fn</a> = <a class="code" href="group__net.html#gac80d5dea22a333f5aa859f2b57e84a8f">reply_out_callback</a>;
<a name="l00352"></a>00352         rs-&gt;<a class="code" href="structptlrpc__reply__state.html#a822cfc83a489857d3511fc0bb49de345" title="Callback description.">rs_cb_id</a>.<a class="code" href="structptlrpc__cb__id.html#a599f9ca488ebfefef38c3e0e7052f300">cbid_arg</a> = rs;
<a name="l00353"></a>00353         rs-&gt;<a class="code" href="structptlrpc__reply__state.html#aca1f0b4b5dc96eb0b9c8c7012cfa4ba4">rs_svcpt</a> = req-&gt;rq_rqbd-&gt;rqbd_svcpt;
<a name="l00354"></a>00354         <a class="code" href="list_8h.html#a0ffe9d28c36d7b018a9cfae33bae45c0">INIT_LIST_HEAD</a>(&amp;rs-&gt;<a class="code" href="structptlrpc__reply__state.html#aa51185c7e39693f894ddb9e9733edf20" title="Linkage for list of all reply states on same export.">rs_exp_list</a>);
<a name="l00355"></a>00355         <a class="code" href="list_8h.html#a0ffe9d28c36d7b018a9cfae33bae45c0">INIT_LIST_HEAD</a>(&amp;rs-&gt;<a class="code" href="structptlrpc__reply__state.html#a123f596acacfe1cc660bf4ea5407c032" title="Linkage for list of all reply states for same obd.">rs_obd_list</a>);
<a name="l00356"></a>00356         <a class="code" href="list_8h.html#a0ffe9d28c36d7b018a9cfae33bae45c0">INIT_LIST_HEAD</a>(&amp;rs-&gt;<a class="code" href="structptlrpc__reply__state.html#ae257df3424c4ec7aaf280aaee8a440fd" title="Linkage for list of all reply states in a system.">rs_list</a>);
<a name="l00357"></a>00357         spin_lock_init(&amp;rs-&gt;<a class="code" href="structptlrpc__reply__state.html#a24c7229b07c8544dcd749c5726595cbe" title="A spinlock to protect the reply state flags.">rs_lock</a>);
<a name="l00358"></a>00358 
<a name="l00359"></a>00359         req-&gt;<a class="code" href="structptlrpc__request.html#aaa9ba7e7b71ad2057d1650469ab15076" title="Reply length.">rq_replen</a> = msg_len;
<a name="l00360"></a>00360         req-&gt;rq_reply_state = rs;
<a name="l00361"></a>00361         req-&gt;<a class="code" href="structptlrpc__request.html#a0c10a934ec07154a75ee696126876f3e" title="Reply message - server response.">rq_repmsg</a> = rs-&gt;<a class="code" href="structptlrpc__reply__state.html#af08fd77ced5fd2bf1db68fb9191f3701" title="Actual reply message.">rs_msg</a>;
<a name="l00362"></a>00362 
<a name="l00363"></a>00363         <a class="code" href="group__net.html#ga675f94ce12272868d6f12b98ee1def0d">lustre_init_msg_v2</a>(rs-&gt;<a class="code" href="structptlrpc__reply__state.html#af08fd77ced5fd2bf1db68fb9191f3701" title="Actual reply message.">rs_msg</a>, count, lens, bufs);
<a name="l00364"></a>00364         <a class="code" href="group__net.html#ga066a801c595cf650dd7538bf3e8f773a">lustre_msg_add_version</a>(rs-&gt;<a class="code" href="structptlrpc__reply__state.html#af08fd77ced5fd2bf1db68fb9191f3701" title="Actual reply message.">rs_msg</a>, <a class="code" href="group__lustreidl.html#gafd8fb38cd999df7c7b4eafca9aeafd78">PTLRPC_MSG_VERSION</a>);
<a name="l00365"></a>00365 
<a name="l00366"></a>00366         <a class="code" href="pack__generic_8c.html#a98e1627e1c5e64232b0dd624a1e86f56">PTLRPC_RS_DEBUG_LRU_ADD</a>(rs);
<a name="l00367"></a>00367 
<a name="l00368"></a>00368         <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(0);
<a name="l00369"></a>00369 }
<a name="l00370"></a>00370 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga33e4ff610e2b182cd78c74131c847cb0">lustre_pack_reply_v2</a>);
<a name="l00371"></a>00371 
<a name="l00372"></a><a class="code" href="group__net.html#ga59c89b28811f4f38f28b2b7d339797f6">00372</a> <span class="keywordtype">int</span> <a class="code" href="group__net.html#ga59c89b28811f4f38f28b2b7d339797f6">lustre_pack_reply_flags</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req, <span class="keywordtype">int</span> count, __u32 *lens,
<a name="l00373"></a>00373                             <span class="keywordtype">char</span> **bufs, <span class="keywordtype">int</span> flags)
<a name="l00374"></a>00374 {
<a name="l00375"></a>00375         <span class="keywordtype">int</span> rc = 0;
<a name="l00376"></a>00376         __u32 size[] = { <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a>) };
<a name="l00377"></a>00377 
<a name="l00378"></a>00378         <span class="keywordflow">if</span> (!lens) {
<a name="l00379"></a>00379                 <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(count == 1);
<a name="l00380"></a>00380                 lens = size;
<a name="l00381"></a>00381         }
<a name="l00382"></a>00382 
<a name="l00383"></a>00383         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(count &gt; 0);
<a name="l00384"></a>00384         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(lens[<a class="code" href="group__lustreidl.html#gad7ddfc6368a84f8cf442c0d4aabcbdc8">MSG_PTLRPC_BODY_OFF</a>] == <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a>));
<a name="l00385"></a>00385 
<a name="l00386"></a>00386         <span class="keywordflow">switch</span> (req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_magic) {
<a name="l00387"></a>00387         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00388"></a>00388                 rc = <a class="code" href="group__net.html#ga33e4ff610e2b182cd78c74131c847cb0">lustre_pack_reply_v2</a>(req, count, lens, bufs, flags);
<a name="l00389"></a>00389                 <span class="keywordflow">break</span>;
<a name="l00390"></a>00390         <span class="keywordflow">default</span>:
<a name="l00391"></a>00391                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>,
<a name="l00392"></a>00392                          req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_magic);
<a name="l00393"></a>00393                 rc = -EINVAL;
<a name="l00394"></a>00394         }
<a name="l00395"></a>00395         <span class="keywordflow">if</span> (rc != 0)
<a name="l00396"></a>00396                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;lustre_pack_reply failed: rc=%d size=%d\n&quot;</span>, rc,
<a name="l00397"></a>00397                        <a class="code" href="group__net.html#ga32c4986e896273a264d87bbc5d28bc70">lustre_msg_size</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_magic, count, lens));
<a name="l00398"></a>00398         <span class="keywordflow">return</span> rc;
<a name="l00399"></a>00399 }
<a name="l00400"></a>00400 
<a name="l00401"></a><a class="code" href="group__net.html#ga931e9c4b5f584f4101c94dfcd3462c5f">00401</a> <span class="keywordtype">int</span> <a class="code" href="group__net.html#ga931e9c4b5f584f4101c94dfcd3462c5f">lustre_pack_reply</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req, <span class="keywordtype">int</span> count, __u32 *lens,
<a name="l00402"></a>00402                       <span class="keywordtype">char</span> **bufs)
<a name="l00403"></a>00403 {
<a name="l00404"></a>00404         <span class="keywordflow">return</span> <a class="code" href="group__net.html#ga59c89b28811f4f38f28b2b7d339797f6">lustre_pack_reply_flags</a>(req, count, lens, bufs, 0);
<a name="l00405"></a>00405 }
<a name="l00406"></a>00406 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga931e9c4b5f584f4101c94dfcd3462c5f">lustre_pack_reply</a>);
<a name="l00407"></a>00407 
<a name="l00408"></a><a class="code" href="group__net.html#gac7dfe0f3f8a3973f5b2c2853454dcde6">00408</a> <span class="keywordtype">void</span> *<a class="code" href="group__net.html#gac7dfe0f3f8a3973f5b2c2853454dcde6">lustre_msg_buf_v2</a>(<span class="keyword">struct</span> <a class="code" href="structlustre__msg__v2.html">lustre_msg_v2</a> *m, __u32 n, __u32 min_size)
<a name="l00409"></a>00409 {
<a name="l00410"></a>00410         __u32 i, offset, buflen, bufcount;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(m != NULL);
<a name="l00413"></a>00413 
<a name="l00414"></a>00414         bufcount = m-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a>;
<a name="l00415"></a>00415         <span class="keywordflow">if</span> (<a class="code" href="libcfs__private_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(n &gt;= bufcount)) {
<a name="l00416"></a>00416                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#a61818a4c2cf85e96d77e6e46ca4ea853">D_INFO</a>, <span class="stringliteral">&quot;msg %p buffer[%d] not present (count %d)\n&quot;</span>,
<a name="l00417"></a>00417                        m, n, bufcount);
<a name="l00418"></a>00418                 <span class="keywordflow">return</span> NULL;
<a name="l00419"></a>00419         }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421         buflen = m-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>[n];
<a name="l00422"></a>00422         <span class="keywordflow">if</span> (<a class="code" href="libcfs__private_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(buflen &lt; min_size)) {
<a name="l00423"></a>00423                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;msg %p buffer[%d] size %d too small &quot;</span>
<a name="l00424"></a>00424                        <span class="stringliteral">&quot;(required %d, opc=%d)\n&quot;</span>, m, n, buflen, min_size,
<a name="l00425"></a>00425                        n == <a class="code" href="group__lustreidl.html#gad7ddfc6368a84f8cf442c0d4aabcbdc8">MSG_PTLRPC_BODY_OFF</a> ? -1 : <a class="code" href="group__net.html#ga5889b19f527897c102df244998c9de02">lustre_msg_get_opc</a>(m));
<a name="l00426"></a>00426                 <span class="keywordflow">return</span> NULL;
<a name="l00427"></a>00427         }
<a name="l00428"></a>00428 
<a name="l00429"></a>00429         offset = <a class="code" href="pack__generic_8c.html#a6e11ffbe975c84147fd948f0f7585ad5">lustre_msg_hdr_size_v2</a>(bufcount);
<a name="l00430"></a>00430         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l00431"></a>00431                 offset += <a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">cfs_size_round</a>(m-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>[i]);
<a name="l00432"></a>00432 
<a name="l00433"></a>00433         <span class="keywordflow">return</span> (<span class="keywordtype">char</span> *)m + offset;
<a name="l00434"></a>00434 }
<a name="l00435"></a>00435 
<a name="l00436"></a><a class="code" href="group__net.html#gaf86387935cc1ebf32b6befd3c486f9d1">00436</a> <span class="keywordtype">void</span> *<a class="code" href="group__net.html#gaf86387935cc1ebf32b6befd3c486f9d1">lustre_msg_buf</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *m, __u32 n, __u32 min_size)
<a name="l00437"></a>00437 {
<a name="l00438"></a>00438         <span class="keywordflow">switch</span> (m-&gt;lm_magic) {
<a name="l00439"></a>00439         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00440"></a>00440                 <span class="keywordflow">return</span> <a class="code" href="group__net.html#gac7dfe0f3f8a3973f5b2c2853454dcde6">lustre_msg_buf_v2</a>(m, n, min_size);
<a name="l00441"></a>00441         <span class="keywordflow">default</span>:
<a name="l00442"></a>00442                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x (msg:%p)\n&quot;</span>,
<a name="l00443"></a>00443                          m-&gt;lm_magic, m);
<a name="l00444"></a>00444                 <span class="keywordflow">return</span> NULL;
<a name="l00445"></a>00445         }
<a name="l00446"></a>00446 }
<a name="l00447"></a>00447 EXPORT_SYMBOL(<a class="code" href="group__net.html#gaf86387935cc1ebf32b6befd3c486f9d1">lustre_msg_buf</a>);
<a name="l00448"></a>00448 
<a name="l00449"></a><a class="code" href="pack__generic_8c.html#adda18aebb2a2e11f8a63f6d59d268d7b">00449</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="pack__generic_8c.html#adda18aebb2a2e11f8a63f6d59d268d7b">lustre_shrink_msg_v2</a>(<span class="keyword">struct</span> <a class="code" href="structlustre__msg__v2.html">lustre_msg_v2</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 segment,
<a name="l00450"></a>00450                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newlen, <span class="keywordtype">int</span> move_data)
<a name="l00451"></a>00451 {
<a name="l00452"></a>00452         <span class="keywordtype">char</span>   *tail = NULL, *newpos;
<a name="l00453"></a>00453         <span class="keywordtype">int</span>     tail_len = 0, n;
<a name="l00454"></a>00454 
<a name="l00455"></a>00455         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(msg);
<a name="l00456"></a>00456         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(msg-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a> &gt; segment);
<a name="l00457"></a>00457         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(msg-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>[segment] &gt;= newlen);
<a name="l00458"></a>00458 
<a name="l00459"></a>00459         <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>[segment] == newlen)
<a name="l00460"></a>00460                 <span class="keywordflow">goto</span> out;
<a name="l00461"></a>00461 
<a name="l00462"></a>00462         <span class="keywordflow">if</span> (move_data &amp;&amp; msg-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a> &gt; segment + 1) {
<a name="l00463"></a>00463                 tail = <a class="code" href="group__net.html#gac7dfe0f3f8a3973f5b2c2853454dcde6">lustre_msg_buf_v2</a>(msg, segment + 1, 0);
<a name="l00464"></a>00464                 <span class="keywordflow">for</span> (n = segment + 1; n &lt; msg-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a>; n++)
<a name="l00465"></a>00465                         tail_len += <a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">cfs_size_round</a>(msg-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>[n]);
<a name="l00466"></a>00466         }
<a name="l00467"></a>00467 
<a name="l00468"></a>00468         msg-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>[segment] = newlen;
<a name="l00469"></a>00469 
<a name="l00470"></a>00470         <span class="keywordflow">if</span> (tail &amp;&amp; tail_len) {
<a name="l00471"></a>00471                 newpos = <a class="code" href="group__net.html#gac7dfe0f3f8a3973f5b2c2853454dcde6">lustre_msg_buf_v2</a>(msg, segment + 1, 0);
<a name="l00472"></a>00472                 <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(newpos &lt;= tail);
<a name="l00473"></a>00473                 <span class="keywordflow">if</span> (newpos != tail)
<a name="l00474"></a>00474                         memmove(newpos, tail, tail_len);
<a name="l00475"></a>00475         }
<a name="l00476"></a>00476 out:
<a name="l00477"></a>00477         <span class="keywordflow">return</span> <a class="code" href="group__net.html#ga4a6268b0e3e950415cc3d4900b744f5d">lustre_msg_size_v2</a>(msg-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a>, msg-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>);
<a name="l00478"></a>00478 }
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 <span class="comment">/*</span>
<a name="l00481"></a>00481 <span class="comment"> * for @msg, shrink @segment to size @newlen. if @move_data is non-zero,</span>
<a name="l00482"></a>00482 <span class="comment"> * we also move data forward from @segment + 1.</span>
<a name="l00483"></a>00483 <span class="comment"> *</span>
<a name="l00484"></a>00484 <span class="comment"> * if @newlen == 0, we remove the segment completely, but we still keep the</span>
<a name="l00485"></a>00485 <span class="comment"> * totally bufcount the same to save possible data moving. this will leave a</span>
<a name="l00486"></a>00486 <span class="comment"> * unused segment with size 0 at the tail, but that&apos;s ok.</span>
<a name="l00487"></a>00487 <span class="comment"> *</span>
<a name="l00488"></a>00488 <span class="comment"> * return new msg size after shrinking.</span>
<a name="l00489"></a>00489 <span class="comment"> *</span>
<a name="l00490"></a>00490 <span class="comment"> * CAUTION:</span>
<a name="l00491"></a>00491 <span class="comment"> * + if any buffers higher than @segment has been filled in, must call shrink</span>
<a name="l00492"></a>00492 <span class="comment"> *   with non-zero @move_data.</span>
<a name="l00493"></a>00493 <span class="comment"> * + caller should NOT keep pointers to msg buffers which higher than @segment</span>
<a name="l00494"></a>00494 <span class="comment"> *   after call shrink.</span>
<a name="l00495"></a>00495 <span class="comment"> */</span>
<a name="l00496"></a><a class="code" href="group__net.html#ga2e757694495c0c01d68d49b78c586125">00496</a> <span class="keywordtype">int</span> <a class="code" href="group__net.html#ga2e757694495c0c01d68d49b78c586125">lustre_shrink_msg</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <span class="keywordtype">int</span> segment,
<a name="l00497"></a>00497                       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newlen, <span class="keywordtype">int</span> move_data)
<a name="l00498"></a>00498 {
<a name="l00499"></a>00499         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00500"></a>00500         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00501"></a>00501                 <span class="keywordflow">return</span> <a class="code" href="pack__generic_8c.html#adda18aebb2a2e11f8a63f6d59d268d7b">lustre_shrink_msg_v2</a>(msg, segment, newlen, move_data);
<a name="l00502"></a>00502         <span class="keywordflow">default</span>:
<a name="l00503"></a>00503                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00504"></a>00504         }
<a name="l00505"></a>00505 }
<a name="l00506"></a>00506 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga2e757694495c0c01d68d49b78c586125">lustre_shrink_msg</a>);
<a name="l00507"></a>00507 
<a name="l00508"></a><a class="code" href="group__net.html#ga3f4bc7c975ca5f3f346d7869bb3f4091">00508</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga3f4bc7c975ca5f3f346d7869bb3f4091">lustre_free_reply_state</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__reply__state.html" title="Structure to define reply state on the server Reply state holds various reply message...">ptlrpc_reply_state</a> *rs)
<a name="l00509"></a>00509 {
<a name="l00510"></a>00510         <a class="code" href="pack__generic_8c.html#afa708baa5902108efc6eca6900622cfc">PTLRPC_RS_DEBUG_LRU_DEL</a>(rs);
<a name="l00511"></a>00511 
<a name="l00512"></a>00512         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(atomic_read(&amp;rs-&gt;<a class="code" href="structptlrpc__reply__state.html#a08c5bc984187398da6b6c17e3d2874e1">rs_refcount</a>) == 0);
<a name="l00513"></a>00513         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(!rs-&gt;<a class="code" href="structptlrpc__reply__state.html#a053119600f608d97cd028b4e145772f2" title="Reply state flags.">rs_difficult</a> || rs-&gt;<a class="code" href="structptlrpc__reply__state.html#a373792d6f110ada420c4dee13c5ba870">rs_handled</a>);
<a name="l00514"></a>00514         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(!rs-&gt;<a class="code" href="structptlrpc__reply__state.html#aa0a0ce60c4f057f43da410140eca3598">rs_on_net</a>);
<a name="l00515"></a>00515         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(!rs-&gt;<a class="code" href="structptlrpc__reply__state.html#a5ecfa6736210f6c83ec1c15fea5cd3ac">rs_scheduled</a>);
<a name="l00516"></a>00516         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(rs-&gt;<a class="code" href="structptlrpc__reply__state.html#af0e79312da8f31e77da05b03ed266430">rs_export</a> == NULL);
<a name="l00517"></a>00517         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(rs-&gt;<a class="code" href="structptlrpc__reply__state.html#a971c2d968f9044adfbb3361f6d938e51" title="Number of locks awaiting client ACK.">rs_nlocks</a> == 0);
<a name="l00518"></a>00518         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(<a class="code" href="list_8h.html#a0fce12be81e8f2677b3a272fee1652ac" title="Test whether a list is empty.">list_empty</a>(&amp;rs-&gt;<a class="code" href="structptlrpc__reply__state.html#aa51185c7e39693f894ddb9e9733edf20" title="Linkage for list of all reply states on same export.">rs_exp_list</a>));
<a name="l00519"></a>00519         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(<a class="code" href="list_8h.html#a0fce12be81e8f2677b3a272fee1652ac" title="Test whether a list is empty.">list_empty</a>(&amp;rs-&gt;<a class="code" href="structptlrpc__reply__state.html#a123f596acacfe1cc660bf4ea5407c032" title="Linkage for list of all reply states for same obd.">rs_obd_list</a>));
<a name="l00520"></a>00520 
<a name="l00521"></a>00521         <a class="code" href="group__sptlrpc.html#ga993608bc2cfa31615e26f5f368801d30" title="Used by ptlrpc server, to free reply_state.">sptlrpc_svc_free_rs</a>(rs);
<a name="l00522"></a>00522 }
<a name="l00523"></a>00523 
<a name="l00524"></a><a class="code" href="pack__generic_8c.html#aae5faf503d5d445060852c107b6799ab">00524</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="pack__generic_8c.html#aae5faf503d5d445060852c107b6799ab">lustre_unpack_msg_v2</a>(<span class="keyword">struct</span> <a class="code" href="structlustre__msg__v2.html">lustre_msg_v2</a> *m, <span class="keywordtype">int</span> len)
<a name="l00525"></a>00525 {
<a name="l00526"></a>00526         <span class="keywordtype">int</span> swabbed, required_len, i;
<a name="l00527"></a>00527 
<a name="l00528"></a>00528         <span class="comment">/* Now we know the sender speaks my language. */</span>
<a name="l00529"></a>00529         required_len = <a class="code" href="pack__generic_8c.html#a6e11ffbe975c84147fd948f0f7585ad5">lustre_msg_hdr_size_v2</a>(0);
<a name="l00530"></a>00530         <span class="keywordflow">if</span> (len &lt; required_len) {
<a name="l00531"></a>00531                 <span class="comment">/* can&apos;t even look inside the message */</span>
<a name="l00532"></a>00532                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;message length %d too small for lustre_msg\n&quot;</span>, len);
<a name="l00533"></a>00533                 <span class="keywordflow">return</span> -EINVAL;
<a name="l00534"></a>00534         }
<a name="l00535"></a>00535 
<a name="l00536"></a>00536         swabbed = (m-&gt;<a class="code" href="structlustre__msg__v2.html#a27b4fa911830bfadb492098308a557af">lm_magic</a> == <a class="code" href="group__lustreidl.html#ga72e42577fd7b937f1e8de91ec225b892">LUSTRE_MSG_MAGIC_V2_SWABBED</a>);
<a name="l00537"></a>00537 
<a name="l00538"></a>00538         <span class="keywordflow">if</span> (swabbed) {
<a name="l00539"></a>00539                 <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;m-&gt;<a class="code" href="structlustre__msg__v2.html#a27b4fa911830bfadb492098308a557af">lm_magic</a>);
<a name="l00540"></a>00540                 <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;m-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a>);
<a name="l00541"></a>00541                 <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;m-&gt;<a class="code" href="structlustre__msg__v2.html#a9227f7537b44687f631625944b0609d7">lm_secflvr</a>);
<a name="l00542"></a>00542                 <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;m-&gt;<a class="code" href="structlustre__msg__v2.html#a1604394cf4092ad85baaf9ebb34f1e5d">lm_repsize</a>);
<a name="l00543"></a>00543                 <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;m-&gt;<a class="code" href="structlustre__msg__v2.html#a04f127d509818748cc27548bd8874af7">lm_cksum</a>);
<a name="l00544"></a>00544                 <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;m-&gt;<a class="code" href="structlustre__msg__v2.html#af3b557908a6e7b59fca49edad23295cc">lm_flags</a>);
<a name="l00545"></a>00545                 <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*m), lm_padding_2) != 0);
<a name="l00546"></a>00546                 <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*m), lm_padding_3) != 0);
<a name="l00547"></a>00547         }
<a name="l00548"></a>00548 
<a name="l00549"></a>00549         required_len = <a class="code" href="pack__generic_8c.html#a6e11ffbe975c84147fd948f0f7585ad5">lustre_msg_hdr_size_v2</a>(m-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a>);
<a name="l00550"></a>00550         <span class="keywordflow">if</span> (len &lt; required_len) {
<a name="l00551"></a>00551                 <span class="comment">/* didn&apos;t receive all the buffer lengths */</span>
<a name="l00552"></a>00552                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a> (<span class="stringliteral">&quot;message length %d too small for %d buflens\n&quot;</span>,
<a name="l00553"></a>00553                         len, m-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a>);
<a name="l00554"></a>00554                 <span class="keywordflow">return</span> -EINVAL;
<a name="l00555"></a>00555         }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557         <span class="keywordflow">for</span> (i = 0; i &lt; m-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a>; i++) {
<a name="l00558"></a>00558                 <span class="keywordflow">if</span> (swabbed)
<a name="l00559"></a>00559                         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;m-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>[i]);
<a name="l00560"></a>00560                 required_len += <a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">cfs_size_round</a>(m-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>[i]);
<a name="l00561"></a>00561         }
<a name="l00562"></a>00562 
<a name="l00563"></a>00563         <span class="keywordflow">if</span> (len &lt; required_len) {
<a name="l00564"></a>00564                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;len: %d, required_len %d\n&quot;</span>, len, required_len);
<a name="l00565"></a>00565                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;bufcount: %d\n&quot;</span>, m-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a>);
<a name="l00566"></a>00566                 <span class="keywordflow">for</span> (i = 0; i &lt; m-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a>; i++)
<a name="l00567"></a>00567                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;buffer %d length %d\n&quot;</span>, i, m-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>[i]);
<a name="l00568"></a>00568                 <span class="keywordflow">return</span> -EINVAL;
<a name="l00569"></a>00569         }
<a name="l00570"></a>00570 
<a name="l00571"></a>00571         <span class="keywordflow">return</span> swabbed;
<a name="l00572"></a>00572 }
<a name="l00573"></a>00573 
<a name="l00574"></a><a class="code" href="group__net.html#ga0868ef692f15726090390fd3a1ae258d">00574</a> <span class="keywordtype">int</span> <a class="code" href="group__net.html#ga0868ef692f15726090390fd3a1ae258d">__lustre_unpack_msg</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *m, <span class="keywordtype">int</span> len)
<a name="l00575"></a>00575 {
<a name="l00576"></a>00576         <span class="keywordtype">int</span> required_len, rc;
<a name="l00577"></a>00577         <a class="code" href="flock_8c.html#affebc0cf7e41098a8c78a8c2c4586d72">ENTRY</a>;
<a name="l00578"></a>00578 
<a name="l00579"></a>00579         <span class="comment">/* We can provide a slightly better error log, if we check the</span>
<a name="l00580"></a>00580 <span class="comment">         * message magic and version first.  In the future, struct</span>
<a name="l00581"></a>00581 <span class="comment">         * lustre_msg may grow, and we&apos;d like to log a version mismatch,</span>
<a name="l00582"></a>00582 <span class="comment">         * rather than a short message.</span>
<a name="l00583"></a>00583 <span class="comment">         *</span>
<a name="l00584"></a>00584 <span class="comment">         */</span>
<a name="l00585"></a>00585         required_len = <a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a>, lm_magic) +
<a name="l00586"></a>00586                        <span class="keyword">sizeof</span>(m-&gt;lm_magic);
<a name="l00587"></a>00587         <span class="keywordflow">if</span> (len &lt; required_len) {
<a name="l00588"></a>00588                 <span class="comment">/* can&apos;t even look inside the message */</span>
<a name="l00589"></a>00589                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;message length %d too small for magic/version check\n&quot;</span>,
<a name="l00590"></a>00590                        len);
<a name="l00591"></a>00591                 <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(-EINVAL);
<a name="l00592"></a>00592         }
<a name="l00593"></a>00593 
<a name="l00594"></a>00594         rc = <a class="code" href="pack__generic_8c.html#aae5faf503d5d445060852c107b6799ab">lustre_unpack_msg_v2</a>(m, len);
<a name="l00595"></a>00595 
<a name="l00596"></a>00596         <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(rc);
<a name="l00597"></a>00597 }
<a name="l00598"></a>00598 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga0868ef692f15726090390fd3a1ae258d">__lustre_unpack_msg</a>);
<a name="l00599"></a>00599 
<a name="l00600"></a><a class="code" href="group__net.html#ga880aa3ea008857e45135398b11077193">00600</a> <span class="keywordtype">int</span> <a class="code" href="group__net.html#ga880aa3ea008857e45135398b11077193">ptlrpc_unpack_req_msg</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req, <span class="keywordtype">int</span> len)
<a name="l00601"></a>00601 {
<a name="l00602"></a>00602         <span class="keywordtype">int</span> rc;
<a name="l00603"></a>00603         rc = <a class="code" href="group__net.html#ga0868ef692f15726090390fd3a1ae258d">__lustre_unpack_msg</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>, len);
<a name="l00604"></a>00604         <span class="keywordflow">if</span> (rc == 1) {
<a name="l00605"></a>00605                 <a class="code" href="group__net.html#ga22d3ca15bd8e1bb881b078fd04381ab0" title="Mark request buffer at offset index that it was already swabbed.">lustre_set_req_swabbed</a>(req, <a class="code" href="group__lustreidl.html#gafa5c71e7497acfe5dea4f5efd14ef8ec" title="only use in req-&amp;gt;rq_{req,rep}_swab_mask">MSG_PTLRPC_HEADER_OFF</a>);
<a name="l00606"></a>00606                 rc = 0;
<a name="l00607"></a>00607         }
<a name="l00608"></a>00608         <span class="keywordflow">return</span> rc;
<a name="l00609"></a>00609 }
<a name="l00610"></a>00610 
<a name="l00611"></a><a class="code" href="group__net.html#ga39ce8a4b0728469e0174c3aa68fd381e">00611</a> <span class="keywordtype">int</span> <a class="code" href="group__net.html#ga39ce8a4b0728469e0174c3aa68fd381e">ptlrpc_unpack_rep_msg</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req, <span class="keywordtype">int</span> len)
<a name="l00612"></a>00612 {
<a name="l00613"></a>00613         <span class="keywordtype">int</span> rc;
<a name="l00614"></a>00614         rc = <a class="code" href="group__net.html#ga0868ef692f15726090390fd3a1ae258d">__lustre_unpack_msg</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a0c10a934ec07154a75ee696126876f3e" title="Reply message - server response.">rq_repmsg</a>, len);
<a name="l00615"></a>00615         <span class="keywordflow">if</span> (rc == 1) {
<a name="l00616"></a>00616                 <a class="code" href="group__net.html#gad4b6df694791481d94ff9f1ad1ea539b" title="Mark request reply buffer at offset index that it was already swabbed.">lustre_set_rep_swabbed</a>(req, <a class="code" href="group__lustreidl.html#gafa5c71e7497acfe5dea4f5efd14ef8ec" title="only use in req-&amp;gt;rq_{req,rep}_swab_mask">MSG_PTLRPC_HEADER_OFF</a>);
<a name="l00617"></a>00617                 rc = 0;
<a name="l00618"></a>00618         }
<a name="l00619"></a>00619         <span class="keywordflow">return</span> rc;
<a name="l00620"></a>00620 }
<a name="l00621"></a>00621 
<a name="l00622"></a><a class="code" href="pack__generic_8c.html#a863eb9f5ae74d82ad68a9ca7279224c4">00622</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="pack__generic_8c.html#a863eb9f5ae74d82ad68a9ca7279224c4">lustre_unpack_ptlrpc_body_v2</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req,
<a name="l00623"></a>00623                                                <span class="keyword">const</span> <span class="keywordtype">int</span> inout, <span class="keywordtype">int</span> offset)
<a name="l00624"></a>00624 {
<a name="l00625"></a>00625         <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb;
<a name="l00626"></a>00626         <span class="keyword">struct </span><a class="code" href="structlustre__msg__v2.html">lustre_msg_v2</a> *m = inout ? req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a> : req-&gt;<a class="code" href="structptlrpc__request.html#a0c10a934ec07154a75ee696126876f3e" title="Reply message - server response.">rq_repmsg</a>;
<a name="l00627"></a>00627 
<a name="l00628"></a>00628         pb = <a class="code" href="group__net.html#gac7dfe0f3f8a3973f5b2c2853454dcde6">lustre_msg_buf_v2</a>(m, offset, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__body__v2.html">ptlrpc_body_v2</a>));
<a name="l00629"></a>00629         <span class="keywordflow">if</span> (!pb) {
<a name="l00630"></a>00630                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;error unpacking ptlrpc body\n&quot;</span>);
<a name="l00631"></a>00631                 <span class="keywordflow">return</span> -EFAULT;
<a name="l00632"></a>00632         }
<a name="l00633"></a>00633         <span class="keywordflow">if</span> (<a class="code" href="group__net.html#gaa22239843a54a1577998de2a44fd8af7" title="ptlrpc msg buffer and swab interface">ptlrpc_buf_need_swab</a>(req, inout, offset)) {
<a name="l00634"></a>00634                 <a class="code" href="req-layout_8c.html#a8fdd690fffd319277581579eba02adbf">lustre_swab_ptlrpc_body</a>(pb);
<a name="l00635"></a>00635                 <a class="code" href="group__net.html#ga6920d79557ab62c16abd7c03d5f27ed7">ptlrpc_buf_set_swabbed</a>(req, inout, offset);
<a name="l00636"></a>00636         }
<a name="l00637"></a>00637 
<a name="l00638"></a>00638         <span class="keywordflow">if</span> ((pb-&gt;pb_version &amp; ~<a class="code" href="packet-lustre_8c.html#a8023d23bbb5d4c5c63320f368f171c23">LUSTRE_VERSION_MASK</a>) != <a class="code" href="group__lustreidl.html#gafd8fb38cd999df7c7b4eafca9aeafd78">PTLRPC_MSG_VERSION</a>) {
<a name="l00639"></a>00639                  <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;wrong lustre_msg version %08x\n&quot;</span>, pb-&gt;pb_version);
<a name="l00640"></a>00640                  <span class="keywordflow">return</span> -EINVAL;
<a name="l00641"></a>00641         }
<a name="l00642"></a>00642 
<a name="l00643"></a>00643         <span class="keywordflow">if</span> (!inout)
<a name="l00644"></a>00644                 pb-&gt;pb_status = <a class="code" href="group__net.html#ga82d561dae83ac80f5c8b1d2ba27c40b3">ptlrpc_status_ntoh</a>(pb-&gt;pb_status);
<a name="l00645"></a>00645 
<a name="l00646"></a>00646         <span class="keywordflow">return</span> 0;
<a name="l00647"></a>00647 }
<a name="l00648"></a>00648 
<a name="l00649"></a><a class="code" href="ptlrpc__internal_8h.html#a75e70c906ed859881dddce7a938c5e9d">00649</a> <span class="keywordtype">int</span> <a class="code" href="pack__generic_8c.html#a75e70c906ed859881dddce7a938c5e9d">lustre_unpack_req_ptlrpc_body</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req, <span class="keywordtype">int</span> offset)
<a name="l00650"></a>00650 {
<a name="l00651"></a>00651         <span class="keywordflow">switch</span> (req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_magic) {
<a name="l00652"></a>00652         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00653"></a>00653                 <span class="keywordflow">return</span> <a class="code" href="pack__generic_8c.html#a863eb9f5ae74d82ad68a9ca7279224c4">lustre_unpack_ptlrpc_body_v2</a>(req, 1, offset);
<a name="l00654"></a>00654         <span class="keywordflow">default</span>:
<a name="l00655"></a>00655                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;bad lustre msg magic: %08x\n&quot;</span>,
<a name="l00656"></a>00656                        req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_magic);
<a name="l00657"></a>00657                 <span class="keywordflow">return</span> -EINVAL;
<a name="l00658"></a>00658         }
<a name="l00659"></a>00659 }
<a name="l00660"></a>00660 
<a name="l00661"></a><a class="code" href="ptlrpc__internal_8h.html#a32c0e0049701f1cbef3380e8718c5983">00661</a> <span class="keywordtype">int</span> <a class="code" href="pack__generic_8c.html#a32c0e0049701f1cbef3380e8718c5983">lustre_unpack_rep_ptlrpc_body</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req, <span class="keywordtype">int</span> offset)
<a name="l00662"></a>00662 {
<a name="l00663"></a>00663         <span class="keywordflow">switch</span> (req-&gt;<a class="code" href="structptlrpc__request.html#a0c10a934ec07154a75ee696126876f3e" title="Reply message - server response.">rq_repmsg</a>-&gt;lm_magic) {
<a name="l00664"></a>00664         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00665"></a>00665                 <span class="keywordflow">return</span> <a class="code" href="pack__generic_8c.html#a863eb9f5ae74d82ad68a9ca7279224c4">lustre_unpack_ptlrpc_body_v2</a>(req, 0, offset);
<a name="l00666"></a>00666         <span class="keywordflow">default</span>:
<a name="l00667"></a>00667                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;bad lustre msg magic: %08x\n&quot;</span>,
<a name="l00668"></a>00668                        req-&gt;<a class="code" href="structptlrpc__request.html#a0c10a934ec07154a75ee696126876f3e" title="Reply message - server response.">rq_repmsg</a>-&gt;lm_magic);
<a name="l00669"></a>00669                 <span class="keywordflow">return</span> -EINVAL;
<a name="l00670"></a>00670         }
<a name="l00671"></a>00671 }
<a name="l00672"></a>00672 
<a name="l00673"></a><a class="code" href="pack__generic_8c.html#aaa81d4fe3bee7e221da037c414a6daf9">00673</a> <span class="keyword">static</span> <span class="keyword">inline</span> __u32 <a class="code" href="pack__generic_8c.html#aaa81d4fe3bee7e221da037c414a6daf9">lustre_msg_buflen_v2</a>(<span class="keyword">struct</span> <a class="code" href="structlustre__msg__v2.html">lustre_msg_v2</a> *m, __u32 n)
<a name="l00674"></a>00674 {
<a name="l00675"></a>00675         <span class="keywordflow">if</span> (n &gt;= m-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a>)
<a name="l00676"></a>00676                 <span class="keywordflow">return</span> 0;
<a name="l00677"></a>00677 
<a name="l00678"></a>00678         <span class="keywordflow">return</span> m-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>[n];
<a name="l00679"></a>00679 }
<a name="l00680"></a>00680 
<a name="l00688"></a><a class="code" href="group__net.html#ga8ddfe4bfdb34b2159b8281fb3c6e09a4">00688</a> __u32 <a class="code" href="group__net.html#ga8ddfe4bfdb34b2159b8281fb3c6e09a4" title="lustre_msg_buflen - return the length of buffer n in message m ">lustre_msg_buflen</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *m, __u32 n)
<a name="l00689"></a>00689 {
<a name="l00690"></a>00690         <span class="keywordflow">switch</span> (m-&gt;lm_magic) {
<a name="l00691"></a>00691         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00692"></a>00692                 <span class="keywordflow">return</span> <a class="code" href="pack__generic_8c.html#aaa81d4fe3bee7e221da037c414a6daf9">lustre_msg_buflen_v2</a>(m, n);
<a name="l00693"></a>00693         <span class="keywordflow">default</span>:
<a name="l00694"></a>00694                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, m-&gt;lm_magic);
<a name="l00695"></a>00695                 <span class="keywordflow">return</span> 0;
<a name="l00696"></a>00696         }
<a name="l00697"></a>00697 }
<a name="l00698"></a>00698 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga8ddfe4bfdb34b2159b8281fb3c6e09a4" title="lustre_msg_buflen - return the length of buffer n in message m ">lustre_msg_buflen</a>);
<a name="l00699"></a>00699 
<a name="l00700"></a>00700 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00701"></a><a class="code" href="pack__generic_8c.html#a7a150da80e285c0d54bdfbba13fe49d2">00701</a> <a class="code" href="pack__generic_8c.html#a7a150da80e285c0d54bdfbba13fe49d2">lustre_msg_set_buflen_v2</a>(<span class="keyword">struct</span> <a class="code" href="structlustre__msg__v2.html">lustre_msg_v2</a> *m, __u32 n, __u32 len)
<a name="l00702"></a>00702 {
<a name="l00703"></a>00703         <span class="keywordflow">if</span> (n &gt;= m-&gt;<a class="code" href="structlustre__msg__v2.html#a167ed64e146e829e87fb5b1053710e8f">lm_bufcount</a>)
<a name="l00704"></a>00704                 <a class="code" href="libcfs__private_8h.html#a08eceadb65d1adcf8c198cff27081d5f">LBUG</a>();
<a name="l00705"></a>00705 
<a name="l00706"></a>00706         m-&gt;<a class="code" href="structlustre__msg__v2.html#ad8278e717a21ee38d132268058ee05d8">lm_buflens</a>[n] = len;
<a name="l00707"></a>00707 }
<a name="l00708"></a>00708 
<a name="l00709"></a><a class="code" href="group__net.html#gaa079849f1357fc2699237871d0531258">00709</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#gaa079849f1357fc2699237871d0531258">lustre_msg_set_buflen</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *m, __u32 n, __u32 len)
<a name="l00710"></a>00710 {
<a name="l00711"></a>00711         <span class="keywordflow">switch</span> (m-&gt;lm_magic) {
<a name="l00712"></a>00712         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00713"></a>00713                 <a class="code" href="pack__generic_8c.html#a7a150da80e285c0d54bdfbba13fe49d2">lustre_msg_set_buflen_v2</a>(m, n, len);
<a name="l00714"></a>00714                 <span class="keywordflow">return</span>;
<a name="l00715"></a>00715         <span class="keywordflow">default</span>:
<a name="l00716"></a>00716                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, m-&gt;lm_magic);
<a name="l00717"></a>00717         }
<a name="l00718"></a>00718 }
<a name="l00719"></a>00719 
<a name="l00720"></a>00720 <span class="comment">/* NB return the bufcount for lustre_msg_v2 format, so if message is packed</span>
<a name="l00721"></a>00721 <span class="comment"> * in V1 format, the result is one bigger. (add struct ptlrpc_body). */</span>
<a name="l00722"></a><a class="code" href="group__net.html#ga6f44a8677c4acf578c772774ba0cf93e">00722</a> __u32 <a class="code" href="group__net.html#ga6f44a8677c4acf578c772774ba0cf93e">lustre_msg_bufcount</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *m)
<a name="l00723"></a>00723 {
<a name="l00724"></a>00724         <span class="keywordflow">switch</span> (m-&gt;lm_magic) {
<a name="l00725"></a>00725         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00726"></a>00726                 <span class="keywordflow">return</span> m-&gt;lm_bufcount;
<a name="l00727"></a>00727         <span class="keywordflow">default</span>:
<a name="l00728"></a>00728                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, m-&gt;lm_magic);
<a name="l00729"></a>00729                 <span class="keywordflow">return</span> 0;
<a name="l00730"></a>00730         }
<a name="l00731"></a>00731 }
<a name="l00732"></a>00732 
<a name="l00733"></a><a class="code" href="group__net.html#ga330ed85a023a0002340a4ba73a1e808d">00733</a> <span class="keywordtype">char</span> *<a class="code" href="group__net.html#ga330ed85a023a0002340a4ba73a1e808d">lustre_msg_string</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *m, __u32 index, __u32 max_len)
<a name="l00734"></a>00734 {
<a name="l00735"></a>00735         <span class="comment">/* max_len == 0 means the string should fill the buffer */</span>
<a name="l00736"></a>00736         <span class="keywordtype">char</span> *str;
<a name="l00737"></a>00737         __u32 slen, blen;
<a name="l00738"></a>00738 
<a name="l00739"></a>00739         <span class="keywordflow">switch</span> (m-&gt;lm_magic) {
<a name="l00740"></a>00740         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00741"></a>00741                 str = <a class="code" href="group__net.html#gac7dfe0f3f8a3973f5b2c2853454dcde6">lustre_msg_buf_v2</a>(m, index, 0);
<a name="l00742"></a>00742                 blen = <a class="code" href="pack__generic_8c.html#aaa81d4fe3bee7e221da037c414a6daf9">lustre_msg_buflen_v2</a>(m, index);
<a name="l00743"></a>00743                 <span class="keywordflow">break</span>;
<a name="l00744"></a>00744         <span class="keywordflow">default</span>:
<a name="l00745"></a>00745                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, m-&gt;lm_magic);
<a name="l00746"></a>00746         }
<a name="l00747"></a>00747 
<a name="l00748"></a>00748         <span class="keywordflow">if</span> (str == NULL) {
<a name="l00749"></a>00749                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a> (<span class="stringliteral">&quot;can&apos;t unpack string in msg %p buffer[%d]\n&quot;</span>, m, index);
<a name="l00750"></a>00750                 <span class="keywordflow">return</span> NULL;
<a name="l00751"></a>00751         }
<a name="l00752"></a>00752 
<a name="l00753"></a>00753         slen = <a class="code" href="lnet_2utils_2wirecheck_8c.html#a598c2fb1d8a84dcbe8ab575d5132f9ba">strnlen</a>(str, blen);
<a name="l00754"></a>00754 
<a name="l00755"></a>00755         <span class="keywordflow">if</span> (slen == blen) {                     <span class="comment">/* not NULL terminated */</span>
<a name="l00756"></a>00756                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;can&apos;t unpack non-NULL terminated string in &quot;</span>
<a name="l00757"></a>00757                         <span class="stringliteral">&quot;msg %p buffer[%d] len %d\n&quot;</span>, m, index, blen);
<a name="l00758"></a>00758                 <span class="keywordflow">return</span> NULL;
<a name="l00759"></a>00759         }
<a name="l00760"></a>00760 
<a name="l00761"></a>00761         <span class="keywordflow">if</span> (max_len == 0) {
<a name="l00762"></a>00762                 <span class="keywordflow">if</span> (slen != blen - 1) {
<a name="l00763"></a>00763                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;can&apos;t unpack short string in msg %p &quot;</span>
<a name="l00764"></a>00764                                <span class="stringliteral">&quot;buffer[%d] len %d: strlen %d\n&quot;</span>,
<a name="l00765"></a>00765                                m, index, blen, slen);
<a name="l00766"></a>00766                         <span class="keywordflow">return</span> NULL;
<a name="l00767"></a>00767                 }
<a name="l00768"></a>00768         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (slen &gt; max_len) {
<a name="l00769"></a>00769                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;can&apos;t unpack oversized string in msg %p &quot;</span>
<a name="l00770"></a>00770                        <span class="stringliteral">&quot;buffer[%d] len %d strlen %d: max %d expected\n&quot;</span>,
<a name="l00771"></a>00771                        m, index, blen, slen, max_len);
<a name="l00772"></a>00772                 <span class="keywordflow">return</span> NULL;
<a name="l00773"></a>00773         }
<a name="l00774"></a>00774 
<a name="l00775"></a>00775         <span class="keywordflow">return</span> str;
<a name="l00776"></a>00776 }
<a name="l00777"></a>00777 
<a name="l00778"></a>00778 <span class="comment">/* Wrap up the normal fixed length cases */</span>
<a name="l00779"></a><a class="code" href="pack__generic_8c.html#a30fa6fc4027c3ade4116c8f255ff4e3d">00779</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> *<a class="code" href="pack__generic_8c.html#a30fa6fc4027c3ade4116c8f255ff4e3d">__lustre_swab_buf</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 index,
<a name="l00780"></a>00780                                       __u32 min_size, <span class="keywordtype">void</span> *swabber)
<a name="l00781"></a>00781 {
<a name="l00782"></a>00782         <span class="keywordtype">void</span> *ptr = NULL;
<a name="l00783"></a>00783 
<a name="l00784"></a>00784         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(msg != NULL);
<a name="l00785"></a>00785         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00786"></a>00786         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00787"></a>00787                 ptr = <a class="code" href="group__net.html#gac7dfe0f3f8a3973f5b2c2853454dcde6">lustre_msg_buf_v2</a>(msg, index, min_size);
<a name="l00788"></a>00788                 <span class="keywordflow">break</span>;
<a name="l00789"></a>00789         <span class="keywordflow">default</span>:
<a name="l00790"></a>00790                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00791"></a>00791         }
<a name="l00792"></a>00792 
<a name="l00793"></a>00793         <span class="keywordflow">if</span> (ptr != NULL &amp;&amp; swabber != NULL)
<a name="l00794"></a>00794                 ((void (*)(<span class="keywordtype">void</span> *))swabber)(ptr);
<a name="l00795"></a>00795 
<a name="l00796"></a>00796         <span class="keywordflow">return</span> ptr;
<a name="l00797"></a>00797 }
<a name="l00798"></a>00798 
<a name="l00799"></a><a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">00799</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *<a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l00800"></a>00800 {
<a name="l00801"></a>00801         <span class="keywordflow">return</span> <a class="code" href="group__net.html#gac7dfe0f3f8a3973f5b2c2853454dcde6">lustre_msg_buf_v2</a>(msg, <a class="code" href="group__lustreidl.html#gad7ddfc6368a84f8cf442c0d4aabcbdc8">MSG_PTLRPC_BODY_OFF</a>,
<a name="l00802"></a>00802                                  <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__body__v2.html">ptlrpc_body_v2</a>));
<a name="l00803"></a>00803 }
<a name="l00804"></a>00804 
<a name="l00805"></a><a class="code" href="group__net.html#gafa52f54de41c43cabe289cdaa7fedc1b">00805</a> __u32 <a class="code" href="group__net.html#gafa52f54de41c43cabe289cdaa7fedc1b">lustre_msghdr_get_flags</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l00806"></a>00806 {
<a name="l00807"></a>00807         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00808"></a>00808         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00809"></a>00809                 <span class="comment">/* already in host endian */</span>
<a name="l00810"></a>00810                 <span class="keywordflow">return</span> msg-&gt;lm_flags;
<a name="l00811"></a>00811         <span class="keywordflow">default</span>:
<a name="l00812"></a>00812                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00813"></a>00813                 <span class="keywordflow">return</span> 0;
<a name="l00814"></a>00814         }
<a name="l00815"></a>00815 }
<a name="l00816"></a>00816 EXPORT_SYMBOL(<a class="code" href="group__net.html#gafa52f54de41c43cabe289cdaa7fedc1b">lustre_msghdr_get_flags</a>);
<a name="l00817"></a>00817 
<a name="l00818"></a><a class="code" href="group__net.html#ga641c3578b5bba1f589b31f8b05a635bf">00818</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga641c3578b5bba1f589b31f8b05a635bf">lustre_msghdr_set_flags</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 flags)
<a name="l00819"></a>00819 {
<a name="l00820"></a>00820         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00821"></a>00821         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l00822"></a>00822                 msg-&gt;lm_flags = flags;
<a name="l00823"></a>00823                 <span class="keywordflow">return</span>;
<a name="l00824"></a>00824         <span class="keywordflow">default</span>:
<a name="l00825"></a>00825                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00826"></a>00826         }
<a name="l00827"></a>00827 }
<a name="l00828"></a>00828 
<a name="l00829"></a><a class="code" href="group__net.html#ga7039633508af55679f204cff967f1879">00829</a> __u32 <a class="code" href="group__net.html#ga7039633508af55679f204cff967f1879">lustre_msg_get_flags</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l00830"></a>00830 {
<a name="l00831"></a>00831         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00832"></a>00832         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l00833"></a>00833                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l00834"></a>00834                 <span class="keywordflow">if</span> (pb != NULL)
<a name="l00835"></a>00835                         <span class="keywordflow">return</span> pb-&gt;pb_flags;
<a name="l00836"></a>00836 
<a name="l00837"></a>00837                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l00838"></a>00838         }
<a name="l00839"></a>00839         <span class="comment">/* no break */</span>
<a name="l00840"></a>00840         <span class="keywordflow">default</span>:
<a name="l00841"></a>00841                 <span class="comment">/* flags might be printed in debug code while message</span>
<a name="l00842"></a>00842 <span class="comment">                 * uninitialized */</span>
<a name="l00843"></a>00843                 <span class="keywordflow">return</span> 0;
<a name="l00844"></a>00844         }
<a name="l00845"></a>00845 }
<a name="l00846"></a>00846 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga7039633508af55679f204cff967f1879">lustre_msg_get_flags</a>);
<a name="l00847"></a>00847 
<a name="l00848"></a><a class="code" href="group__net.html#ga680b03200ebe0b9e31464e5d5999091a">00848</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga680b03200ebe0b9e31464e5d5999091a">lustre_msg_add_flags</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 flags)
<a name="l00849"></a>00849 {
<a name="l00850"></a>00850         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00851"></a>00851         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l00852"></a>00852                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l00853"></a>00853                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l00854"></a>00854                 pb-&gt;pb_flags |= flags;
<a name="l00855"></a>00855                 <span class="keywordflow">return</span>;
<a name="l00856"></a>00856         }
<a name="l00857"></a>00857         <span class="keywordflow">default</span>:
<a name="l00858"></a>00858                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00859"></a>00859         }
<a name="l00860"></a>00860 }
<a name="l00861"></a>00861 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga680b03200ebe0b9e31464e5d5999091a">lustre_msg_add_flags</a>);
<a name="l00862"></a>00862 
<a name="l00863"></a><a class="code" href="group__net.html#gada3542d777501a1faceed38b584aacf0">00863</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#gada3542d777501a1faceed38b584aacf0">lustre_msg_set_flags</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 flags)
<a name="l00864"></a>00864 {
<a name="l00865"></a>00865         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00866"></a>00866         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l00867"></a>00867                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l00868"></a>00868                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l00869"></a>00869                 pb-&gt;pb_flags = flags;
<a name="l00870"></a>00870                 <span class="keywordflow">return</span>;
<a name="l00871"></a>00871         }
<a name="l00872"></a>00872         <span class="keywordflow">default</span>:
<a name="l00873"></a>00873                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00874"></a>00874         }
<a name="l00875"></a>00875 }
<a name="l00876"></a>00876 
<a name="l00877"></a><a class="code" href="group__net.html#ga4407c10c8d31d9a5c3e6bedee6e1bde0">00877</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga4407c10c8d31d9a5c3e6bedee6e1bde0">lustre_msg_clear_flags</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 flags)
<a name="l00878"></a>00878 {
<a name="l00879"></a>00879         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00880"></a>00880         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l00881"></a>00881                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l00882"></a>00882                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l00883"></a>00883                 pb-&gt;pb_flags &amp;= ~(<a class="code" href="group__lustreidl.html#ga1df57268180a6a4acc4e0b12392d3aae">MSG_GEN_FLAG_MASK</a> &amp; flags);
<a name="l00884"></a>00884                 <span class="keywordflow">return</span>;
<a name="l00885"></a>00885         }
<a name="l00886"></a>00886         <span class="keywordflow">default</span>:
<a name="l00887"></a>00887                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00888"></a>00888         }
<a name="l00889"></a>00889 }
<a name="l00890"></a>00890 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga4407c10c8d31d9a5c3e6bedee6e1bde0">lustre_msg_clear_flags</a>);
<a name="l00891"></a>00891 
<a name="l00892"></a><a class="code" href="group__net.html#ga6b9caf652e934e32217574de70f0ee18">00892</a> __u32 <a class="code" href="group__net.html#ga6b9caf652e934e32217574de70f0ee18">lustre_msg_get_op_flags</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l00893"></a>00893 {
<a name="l00894"></a>00894         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00895"></a>00895         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l00896"></a>00896                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l00897"></a>00897                 <span class="keywordflow">if</span> (pb != NULL)
<a name="l00898"></a>00898                         <span class="keywordflow">return</span> pb-&gt;pb_op_flags;
<a name="l00899"></a>00899 
<a name="l00900"></a>00900                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l00901"></a>00901         }
<a name="l00902"></a>00902         <span class="comment">/* no break */</span>
<a name="l00903"></a>00903         <span class="keywordflow">default</span>:
<a name="l00904"></a>00904                 <span class="keywordflow">return</span> 0;
<a name="l00905"></a>00905         }
<a name="l00906"></a>00906 }
<a name="l00907"></a>00907 
<a name="l00908"></a><a class="code" href="group__net.html#ga936d750268a27c353fdd2ac940ab20c8">00908</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga936d750268a27c353fdd2ac940ab20c8">lustre_msg_add_op_flags</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 flags)
<a name="l00909"></a>00909 {
<a name="l00910"></a>00910         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00911"></a>00911         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l00912"></a>00912                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l00913"></a>00913                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l00914"></a>00914                 pb-&gt;pb_op_flags |= flags;
<a name="l00915"></a>00915                 <span class="keywordflow">return</span>;
<a name="l00916"></a>00916         }
<a name="l00917"></a>00917         <span class="keywordflow">default</span>:
<a name="l00918"></a>00918                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00919"></a>00919         }
<a name="l00920"></a>00920 }
<a name="l00921"></a>00921 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga936d750268a27c353fdd2ac940ab20c8">lustre_msg_add_op_flags</a>);
<a name="l00922"></a>00922 
<a name="l00923"></a><a class="code" href="group__net.html#gad75d2dc265242a98676033489842e8c1">00923</a> <span class="keyword">struct </span><a class="code" href="structlustre__handle.html">lustre_handle</a> *<a class="code" href="group__net.html#gad75d2dc265242a98676033489842e8c1">lustre_msg_get_handle</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l00924"></a>00924 {
<a name="l00925"></a>00925         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00926"></a>00926         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l00927"></a>00927                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l00928"></a>00928                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l00929"></a>00929                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l00930"></a>00930                         <span class="keywordflow">return</span> NULL;
<a name="l00931"></a>00931                 }
<a name="l00932"></a>00932                 <span class="keywordflow">return</span> &amp;pb-&gt;pb_handle;
<a name="l00933"></a>00933         }
<a name="l00934"></a>00934         <span class="keywordflow">default</span>:
<a name="l00935"></a>00935                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00936"></a>00936                 <span class="keywordflow">return</span> NULL;
<a name="l00937"></a>00937         }
<a name="l00938"></a>00938 }
<a name="l00939"></a>00939 
<a name="l00940"></a><a class="code" href="group__net.html#ga01d33f66f8a27c313cd4db66ea0bdbc6">00940</a> __u32 <a class="code" href="group__net.html#ga01d33f66f8a27c313cd4db66ea0bdbc6">lustre_msg_get_type</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l00941"></a>00941 {
<a name="l00942"></a>00942         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00943"></a>00943         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l00944"></a>00944                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l00945"></a>00945                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l00946"></a>00946                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l00947"></a>00947                         <span class="keywordflow">return</span> <a class="code" href="packet-lustre_8c.html#a6d5da660bbb1050e506026b75bc59c85">PTL_RPC_MSG_ERR</a>;
<a name="l00948"></a>00948                 }
<a name="l00949"></a>00949                 <span class="keywordflow">return</span> pb-&gt;pb_type;
<a name="l00950"></a>00950         }
<a name="l00951"></a>00951         <span class="keywordflow">default</span>:
<a name="l00952"></a>00952                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00953"></a>00953                 <span class="keywordflow">return</span> <a class="code" href="packet-lustre_8c.html#a6d5da660bbb1050e506026b75bc59c85">PTL_RPC_MSG_ERR</a>;
<a name="l00954"></a>00954         }
<a name="l00955"></a>00955 }
<a name="l00956"></a>00956 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga01d33f66f8a27c313cd4db66ea0bdbc6">lustre_msg_get_type</a>);
<a name="l00957"></a>00957 
<a name="l00958"></a><a class="code" href="group__net.html#ga89d53cb5a8d4f00ed4c92a25969c444d">00958</a> __u32 <a class="code" href="group__net.html#ga89d53cb5a8d4f00ed4c92a25969c444d">lustre_msg_get_version</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l00959"></a>00959 {
<a name="l00960"></a>00960         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00961"></a>00961         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l00962"></a>00962                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l00963"></a>00963                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l00964"></a>00964                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l00965"></a>00965                         <span class="keywordflow">return</span> 0;
<a name="l00966"></a>00966                 }
<a name="l00967"></a>00967                 <span class="keywordflow">return</span> pb-&gt;pb_version;
<a name="l00968"></a>00968         }
<a name="l00969"></a>00969         <span class="keywordflow">default</span>:
<a name="l00970"></a>00970                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00971"></a>00971                 <span class="keywordflow">return</span> 0;
<a name="l00972"></a>00972         }
<a name="l00973"></a>00973 }
<a name="l00974"></a>00974 
<a name="l00975"></a><a class="code" href="group__net.html#ga066a801c595cf650dd7538bf3e8f773a">00975</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga066a801c595cf650dd7538bf3e8f773a">lustre_msg_add_version</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 <a class="code" href="packet-lnet_8c.html#a0a5c5891c90b30e72f5cfca80915338e">version</a>)
<a name="l00976"></a>00976 {
<a name="l00977"></a>00977         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00978"></a>00978         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l00979"></a>00979                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l00980"></a>00980                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l00981"></a>00981                 pb-&gt;pb_version |= version;
<a name="l00982"></a>00982                 <span class="keywordflow">return</span>;
<a name="l00983"></a>00983         }
<a name="l00984"></a>00984         <span class="keywordflow">default</span>:
<a name="l00985"></a>00985                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l00986"></a>00986         }
<a name="l00987"></a>00987 }
<a name="l00988"></a>00988 
<a name="l00989"></a><a class="code" href="group__net.html#ga5889b19f527897c102df244998c9de02">00989</a> __u32 <a class="code" href="group__net.html#ga5889b19f527897c102df244998c9de02">lustre_msg_get_opc</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l00990"></a>00990 {
<a name="l00991"></a>00991         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l00992"></a>00992         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l00993"></a>00993                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l00994"></a>00994                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l00995"></a>00995                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l00996"></a>00996                         <span class="keywordflow">return</span> 0;
<a name="l00997"></a>00997                 }
<a name="l00998"></a>00998                 <span class="keywordflow">return</span> pb-&gt;pb_opc;
<a name="l00999"></a>00999         }
<a name="l01000"></a>01000         <span class="keywordflow">default</span>:
<a name="l01001"></a>01001                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x (msg:%p)\n&quot;</span>,
<a name="l01002"></a>01002                        msg-&gt;lm_magic, msg);
<a name="l01003"></a>01003                 <span class="keywordflow">return</span> 0;
<a name="l01004"></a>01004         }
<a name="l01005"></a>01005 }
<a name="l01006"></a>01006 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga5889b19f527897c102df244998c9de02">lustre_msg_get_opc</a>);
<a name="l01007"></a>01007 
<a name="l01008"></a><a class="code" href="group__net.html#gae1e0c34642d37fbb79ad0decc534a802">01008</a> <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="group__net.html#gae1e0c34642d37fbb79ad0decc534a802">lustre_msg_get_last_xid</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01009"></a>01009 {
<a name="l01010"></a>01010         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01011"></a>01011         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01012"></a>01012                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01013"></a>01013                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l01014"></a>01014                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01015"></a>01015                         <span class="keywordflow">return</span> 0;
<a name="l01016"></a>01016                 }
<a name="l01017"></a>01017                 <span class="keywordflow">return</span> pb-&gt;pb_last_xid;
<a name="l01018"></a>01018         }
<a name="l01019"></a>01019         <span class="keywordflow">default</span>:
<a name="l01020"></a>01020                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01021"></a>01021                 <span class="keywordflow">return</span> 0;
<a name="l01022"></a>01022         }
<a name="l01023"></a>01023 }
<a name="l01024"></a>01024 EXPORT_SYMBOL(<a class="code" href="group__net.html#gae1e0c34642d37fbb79ad0decc534a802">lustre_msg_get_last_xid</a>);
<a name="l01025"></a>01025 
<a name="l01026"></a><a class="code" href="group__net.html#gad697a66b5792cd2cd75bcf95f87d012b">01026</a> __u16 <a class="code" href="group__net.html#gad697a66b5792cd2cd75bcf95f87d012b">lustre_msg_get_tag</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01027"></a>01027 {
<a name="l01028"></a>01028         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01029"></a>01029         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01030"></a>01030                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01031"></a>01031                 <span class="keywordflow">if</span> (!pb) {
<a name="l01032"></a>01032                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01033"></a>01033                         <span class="keywordflow">return</span> 0;
<a name="l01034"></a>01034                 }
<a name="l01035"></a>01035                 <span class="keywordflow">return</span> pb-&gt;pb_tag;
<a name="l01036"></a>01036         }
<a name="l01037"></a>01037         <span class="keywordflow">default</span>:
<a name="l01038"></a>01038                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01039"></a>01039                 <span class="keywordflow">return</span> 0;
<a name="l01040"></a>01040         }
<a name="l01041"></a>01041 }
<a name="l01042"></a>01042 EXPORT_SYMBOL(<a class="code" href="group__net.html#gad697a66b5792cd2cd75bcf95f87d012b">lustre_msg_get_tag</a>);
<a name="l01043"></a>01043 
<a name="l01044"></a><a class="code" href="group__net.html#ga4ac5547cd6b69a63dd6232cf44428f11">01044</a> <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="group__net.html#ga4ac5547cd6b69a63dd6232cf44428f11">lustre_msg_get_last_committed</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01045"></a>01045 {
<a name="l01046"></a>01046         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01047"></a>01047         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01048"></a>01048                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01049"></a>01049                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l01050"></a>01050                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01051"></a>01051                         <span class="keywordflow">return</span> 0;
<a name="l01052"></a>01052                 }
<a name="l01053"></a>01053                 <span class="keywordflow">return</span> pb-&gt;pb_last_committed;
<a name="l01054"></a>01054         }
<a name="l01055"></a>01055         <span class="keywordflow">default</span>:
<a name="l01056"></a>01056                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01057"></a>01057                 <span class="keywordflow">return</span> 0;
<a name="l01058"></a>01058         }
<a name="l01059"></a>01059 }
<a name="l01060"></a>01060 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga4ac5547cd6b69a63dd6232cf44428f11">lustre_msg_get_last_committed</a>);
<a name="l01061"></a>01061 
<a name="l01062"></a><a class="code" href="group__net.html#gaf4f241bad6b8f2477c2d1176835fa44f">01062</a> <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *<a class="code" href="group__net.html#gaf4f241bad6b8f2477c2d1176835fa44f">lustre_msg_get_versions</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01063"></a>01063 {
<a name="l01064"></a>01064         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01065"></a>01065         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01066"></a>01066                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01067"></a>01067                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l01068"></a>01068                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01069"></a>01069                         <span class="keywordflow">return</span> NULL;
<a name="l01070"></a>01070                 }
<a name="l01071"></a>01071                 <span class="keywordflow">return</span> pb-&gt;pb_pre_versions;
<a name="l01072"></a>01072         }
<a name="l01073"></a>01073         <span class="keywordflow">default</span>:
<a name="l01074"></a>01074                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01075"></a>01075                 <span class="keywordflow">return</span> NULL;
<a name="l01076"></a>01076         }
<a name="l01077"></a>01077 }
<a name="l01078"></a>01078 EXPORT_SYMBOL(<a class="code" href="group__net.html#gaf4f241bad6b8f2477c2d1176835fa44f">lustre_msg_get_versions</a>);
<a name="l01079"></a>01079 
<a name="l01080"></a><a class="code" href="group__net.html#ga9bedef213e170e969899bfab36bb8fb0">01080</a> <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="group__net.html#ga9bedef213e170e969899bfab36bb8fb0">lustre_msg_get_transno</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01081"></a>01081 {
<a name="l01082"></a>01082         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01083"></a>01083         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01084"></a>01084                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01085"></a>01085                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l01086"></a>01086                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01087"></a>01087                         <span class="keywordflow">return</span> 0;
<a name="l01088"></a>01088                 }
<a name="l01089"></a>01089                 <span class="keywordflow">return</span> pb-&gt;pb_transno;
<a name="l01090"></a>01090         }
<a name="l01091"></a>01091         <span class="keywordflow">default</span>:
<a name="l01092"></a>01092                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01093"></a>01093                 <span class="keywordflow">return</span> 0;
<a name="l01094"></a>01094         }
<a name="l01095"></a>01095 }
<a name="l01096"></a>01096 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga9bedef213e170e969899bfab36bb8fb0">lustre_msg_get_transno</a>);
<a name="l01097"></a>01097 
<a name="l01098"></a><a class="code" href="group__net.html#gaaa6ef42a52d75cf87cb0b7834606093b">01098</a> <span class="keywordtype">int</span> <a class="code" href="group__net.html#gaaa6ef42a52d75cf87cb0b7834606093b">lustre_msg_get_status</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01099"></a>01099 {
<a name="l01100"></a>01100         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01101"></a>01101         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01102"></a>01102                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01103"></a>01103                 <span class="keywordflow">if</span> (pb != NULL)
<a name="l01104"></a>01104                         <span class="keywordflow">return</span> pb-&gt;pb_status;
<a name="l01105"></a>01105                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01106"></a>01106         }
<a name="l01107"></a>01107         <span class="comment">/* no break */</span>
<a name="l01108"></a>01108         <span class="keywordflow">default</span>:
<a name="l01109"></a>01109                 <span class="comment">/* status might be printed in debug code while message</span>
<a name="l01110"></a>01110 <span class="comment">                * uninitialized */</span>
<a name="l01111"></a>01111                 <span class="keywordflow">return</span> -EINVAL;
<a name="l01112"></a>01112         }
<a name="l01113"></a>01113 }
<a name="l01114"></a>01114 EXPORT_SYMBOL(<a class="code" href="group__net.html#gaaa6ef42a52d75cf87cb0b7834606093b">lustre_msg_get_status</a>);
<a name="l01115"></a>01115 
<a name="l01116"></a><a class="code" href="group__net.html#ga75b1983d0a0620bce67698d9c74606ce">01116</a> <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="group__net.html#ga75b1983d0a0620bce67698d9c74606ce">lustre_msg_get_slv</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01117"></a>01117 {
<a name="l01118"></a>01118         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01119"></a>01119         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01120"></a>01120                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01121"></a>01121                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l01122"></a>01122                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01123"></a>01123                         <span class="keywordflow">return</span> -EINVAL;
<a name="l01124"></a>01124                 }
<a name="l01125"></a>01125                 <span class="keywordflow">return</span> pb-&gt;pb_slv;
<a name="l01126"></a>01126         }
<a name="l01127"></a>01127         <span class="keywordflow">default</span>:
<a name="l01128"></a>01128                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg magic %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01129"></a>01129                 <span class="keywordflow">return</span> -EINVAL;
<a name="l01130"></a>01130         }
<a name="l01131"></a>01131 }
<a name="l01132"></a>01132 
<a name="l01133"></a>01133 
<a name="l01134"></a><a class="code" href="group__net.html#gab04cac335854c3ed32f2d61d7ea8f20d">01134</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#gab04cac335854c3ed32f2d61d7ea8f20d">lustre_msg_set_slv</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> slv)
<a name="l01135"></a>01135 {
<a name="l01136"></a>01136         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01137"></a>01137         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01138"></a>01138                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01139"></a>01139                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l01140"></a>01140                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01141"></a>01141                         <span class="keywordflow">return</span>;
<a name="l01142"></a>01142                 }
<a name="l01143"></a>01143                 pb-&gt;pb_slv = slv;
<a name="l01144"></a>01144                 <span class="keywordflow">return</span>;
<a name="l01145"></a>01145         }
<a name="l01146"></a>01146         <span class="keywordflow">default</span>:
<a name="l01147"></a>01147                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg magic %x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01148"></a>01148                 <span class="keywordflow">return</span>;
<a name="l01149"></a>01149         }
<a name="l01150"></a>01150 }
<a name="l01151"></a>01151 
<a name="l01152"></a><a class="code" href="group__net.html#gaee4ba63f57ed3b69dfa3d34d31c56fcb">01152</a> __u32 <a class="code" href="group__net.html#gaee4ba63f57ed3b69dfa3d34d31c56fcb">lustre_msg_get_limit</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01153"></a>01153 {
<a name="l01154"></a>01154         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01155"></a>01155         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01156"></a>01156                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01157"></a>01157                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l01158"></a>01158                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01159"></a>01159                         <span class="keywordflow">return</span> -EINVAL;
<a name="l01160"></a>01160                 }
<a name="l01161"></a>01161                 <span class="keywordflow">return</span> pb-&gt;pb_limit;
<a name="l01162"></a>01162         }
<a name="l01163"></a>01163         <span class="keywordflow">default</span>:
<a name="l01164"></a>01164                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg magic %x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01165"></a>01165                 <span class="keywordflow">return</span> -EINVAL;
<a name="l01166"></a>01166         }
<a name="l01167"></a>01167 }
<a name="l01168"></a>01168 
<a name="l01169"></a>01169 
<a name="l01170"></a><a class="code" href="group__net.html#gaac6d72b5cde5803459955f9b39480b73">01170</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#gaac6d72b5cde5803459955f9b39480b73">lustre_msg_set_limit</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> limit)
<a name="l01171"></a>01171 {
<a name="l01172"></a>01172         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01173"></a>01173         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01174"></a>01174                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01175"></a>01175                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l01176"></a>01176                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01177"></a>01177                         <span class="keywordflow">return</span>;
<a name="l01178"></a>01178                 }
<a name="l01179"></a>01179                 pb-&gt;pb_limit = limit;
<a name="l01180"></a>01180                 <span class="keywordflow">return</span>;
<a name="l01181"></a>01181         }
<a name="l01182"></a>01182         <span class="keywordflow">default</span>:
<a name="l01183"></a>01183                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg magic %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01184"></a>01184                 <span class="keywordflow">return</span>;
<a name="l01185"></a>01185         }
<a name="l01186"></a>01186 }
<a name="l01187"></a>01187 
<a name="l01188"></a><a class="code" href="group__net.html#ga8a5b544ffbfafa4fb89c592e719ac9e5">01188</a> __u32 <a class="code" href="group__net.html#ga8a5b544ffbfafa4fb89c592e719ac9e5">lustre_msg_get_conn_cnt</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01189"></a>01189 {
<a name="l01190"></a>01190         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01191"></a>01191         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01192"></a>01192                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01193"></a>01193                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l01194"></a>01194                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01195"></a>01195                         <span class="keywordflow">return</span> 0;
<a name="l01196"></a>01196                 }
<a name="l01197"></a>01197                 <span class="keywordflow">return</span> pb-&gt;pb_conn_cnt;
<a name="l01198"></a>01198         }
<a name="l01199"></a>01199         <span class="keywordflow">default</span>:
<a name="l01200"></a>01200                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01201"></a>01201                 <span class="keywordflow">return</span> 0;
<a name="l01202"></a>01202         }
<a name="l01203"></a>01203 }
<a name="l01204"></a>01204 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga8a5b544ffbfafa4fb89c592e719ac9e5">lustre_msg_get_conn_cnt</a>);
<a name="l01205"></a>01205 
<a name="l01206"></a><a class="code" href="group__net.html#ga01eb6e83d9ebdde883ab568eb3f8dc27">01206</a> __u32 <a class="code" href="group__net.html#ga01eb6e83d9ebdde883ab568eb3f8dc27">lustre_msg_get_magic</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01207"></a>01207 {
<a name="l01208"></a>01208         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01209"></a>01209         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l01210"></a>01210                 <span class="keywordflow">return</span> msg-&gt;lm_magic;
<a name="l01211"></a>01211         <span class="keywordflow">default</span>:
<a name="l01212"></a>01212                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01213"></a>01213                 <span class="keywordflow">return</span> 0;
<a name="l01214"></a>01214         }
<a name="l01215"></a>01215 }
<a name="l01216"></a>01216 
<a name="l01217"></a><a class="code" href="group__net.html#gac8ece5ff148e7b332a8408646971193c">01217</a> __u32 <a class="code" href="group__net.html#gac8ece5ff148e7b332a8408646971193c">lustre_msg_get_timeout</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01218"></a>01218 {
<a name="l01219"></a>01219         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01220"></a>01220         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01221"></a>01221                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01222"></a>01222                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l01223"></a>01223                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01224"></a>01224                         <span class="keywordflow">return</span> 0;
<a name="l01225"></a>01225                 }
<a name="l01226"></a>01226                 <span class="keywordflow">return</span> pb-&gt;pb_timeout;
<a name="l01227"></a>01227         }
<a name="l01228"></a>01228         <span class="keywordflow">default</span>:
<a name="l01229"></a>01229                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01230"></a>01230                 <span class="keywordflow">return</span> 0;
<a name="l01231"></a>01231         }
<a name="l01232"></a>01232 }
<a name="l01233"></a>01233 
<a name="l01234"></a><a class="code" href="group__net.html#gace5ea0242057ff28a144714e38029efe">01234</a> __u32 <a class="code" href="group__net.html#gace5ea0242057ff28a144714e38029efe">lustre_msg_get_service_time</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01235"></a>01235 {
<a name="l01236"></a>01236         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01237"></a>01237         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01238"></a>01238                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01239"></a>01239                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l01240"></a>01240                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01241"></a>01241                         <span class="keywordflow">return</span> 0;
<a name="l01242"></a>01242                 }
<a name="l01243"></a>01243                 <span class="keywordflow">return</span> pb-&gt;pb_service_time;
<a name="l01244"></a>01244         }
<a name="l01245"></a>01245         <span class="keywordflow">default</span>:
<a name="l01246"></a>01246                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01247"></a>01247                 <span class="keywordflow">return</span> 0;
<a name="l01248"></a>01248         }
<a name="l01249"></a>01249 }
<a name="l01250"></a>01250 
<a name="l01251"></a><a class="code" href="group__net.html#ga31246dd9883e11558349659fa4d34162">01251</a> <span class="keywordtype">char</span> *<a class="code" href="group__net.html#ga31246dd9883e11558349659fa4d34162">lustre_msg_get_jobid</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01252"></a>01252 {
<a name="l01253"></a>01253         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01254"></a>01254         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01255"></a>01255                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb =
<a name="l01256"></a>01256                         <a class="code" href="group__net.html#gac7dfe0f3f8a3973f5b2c2853454dcde6">lustre_msg_buf_v2</a>(msg, <a class="code" href="group__lustreidl.html#gad7ddfc6368a84f8cf442c0d4aabcbdc8">MSG_PTLRPC_BODY_OFF</a>,
<a name="l01257"></a>01257                                           <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a>));
<a name="l01258"></a>01258                 <span class="keywordflow">if</span> (!pb)
<a name="l01259"></a>01259                         <span class="keywordflow">return</span> NULL;
<a name="l01260"></a>01260 
<a name="l01261"></a>01261                 <span class="keywordflow">return</span> pb-&gt;pb_jobid;
<a name="l01262"></a>01262         }
<a name="l01263"></a>01263         <span class="keywordflow">default</span>:
<a name="l01264"></a>01264                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01265"></a>01265                 <span class="keywordflow">return</span> NULL;
<a name="l01266"></a>01266         }
<a name="l01267"></a>01267 }
<a name="l01268"></a>01268 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga31246dd9883e11558349659fa4d34162">lustre_msg_get_jobid</a>);
<a name="l01269"></a>01269 
<a name="l01270"></a><a class="code" href="group__net.html#gab1fab96e53cfbe27a7634cde2fd6146e">01270</a> __u32 <a class="code" href="group__net.html#gab1fab96e53cfbe27a7634cde2fd6146e">lustre_msg_get_cksum</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01271"></a>01271 {
<a name="l01272"></a>01272         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01273"></a>01273         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l01274"></a>01274                 <span class="keywordflow">return</span> msg-&gt;lm_cksum;
<a name="l01275"></a>01275         <span class="keywordflow">default</span>:
<a name="l01276"></a>01276                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01277"></a>01277                 <span class="keywordflow">return</span> 0;
<a name="l01278"></a>01278         }
<a name="l01279"></a>01279 }
<a name="l01280"></a>01280 
<a name="l01281"></a><a class="code" href="group__net.html#ga88b6efce1585cbc6a60b84006e486678">01281</a> <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="group__net.html#ga88b6efce1585cbc6a60b84006e486678">lustre_msg_get_mbits</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01282"></a>01282 {
<a name="l01283"></a>01283         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01284"></a>01284         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01285"></a>01285                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01286"></a>01286                 <span class="keywordflow">if</span> (pb == NULL) {
<a name="l01287"></a>01287                         <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01288"></a>01288                         <span class="keywordflow">return</span> 0;
<a name="l01289"></a>01289                 }
<a name="l01290"></a>01290                 <span class="keywordflow">return</span> pb-&gt;pb_mbits;
<a name="l01291"></a>01291         }
<a name="l01292"></a>01292         <span class="keywordflow">default</span>:
<a name="l01293"></a>01293                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01294"></a>01294                 <span class="keywordflow">return</span> 0;
<a name="l01295"></a>01295         }
<a name="l01296"></a>01296 }
<a name="l01297"></a>01297 
<a name="l01298"></a><a class="code" href="group__net.html#ga1f3e7b2437b921cd4173cc356084583b">01298</a> __u32 <a class="code" href="group__net.html#ga1f3e7b2437b921cd4173cc356084583b">lustre_msg_calc_cksum</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l01299"></a>01299 {
<a name="l01300"></a>01300         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01301"></a>01301         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01302"></a>01302                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01303"></a>01303                 __u32 len = <a class="code" href="group__net.html#ga8ddfe4bfdb34b2159b8281fb3c6e09a4" title="lustre_msg_buflen - return the length of buffer n in message m ">lustre_msg_buflen</a>(msg, <a class="code" href="group__lustreidl.html#gad7ddfc6368a84f8cf442c0d4aabcbdc8">MSG_PTLRPC_BODY_OFF</a>);
<a name="l01304"></a>01304 
<a name="l01305"></a>01305                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hsize = 4;
<a name="l01306"></a>01306                 __u32 crc;
<a name="l01307"></a>01307 
<a name="l01308"></a>01308                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01309"></a>01309                 <a class="code" href="libcfs__crypto_8h.html#a675da3d868db4d32d69f695085d851f5" title="Calculate hash digest for the passed buffer.">cfs_crypto_hash_digest</a>(<a class="code" href="libcfs__crypto_8h.html#acca8f0493c19fe3ae434d2c8c2891788a10e703152794fdbbdb7c1e25269cfede">CFS_HASH_ALG_CRC32</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)pb,
<a name="l01310"></a>01310                                        len, NULL, 0, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)&amp;crc,
<a name="l01311"></a>01311                                        &amp;hsize);
<a name="l01312"></a>01312                 <span class="keywordflow">return</span> crc;
<a name="l01313"></a>01313         }
<a name="l01314"></a>01314         <span class="keywordflow">default</span>:
<a name="l01315"></a>01315                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01316"></a>01316                 <span class="keywordflow">return</span> 0;
<a name="l01317"></a>01317         }
<a name="l01318"></a>01318 }
<a name="l01319"></a>01319 
<a name="l01320"></a><a class="code" href="group__net.html#ga9661a4e2ee3f8bb75a5512d9070903cd">01320</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga9661a4e2ee3f8bb75a5512d9070903cd">lustre_msg_set_handle</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <span class="keyword">struct</span> <a class="code" href="structlustre__handle.html">lustre_handle</a> *handle)
<a name="l01321"></a>01321 {
<a name="l01322"></a>01322         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01323"></a>01323         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01324"></a>01324                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01325"></a>01325                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01326"></a>01326                 pb-&gt;pb_handle = *handle;
<a name="l01327"></a>01327                 <span class="keywordflow">return</span>;
<a name="l01328"></a>01328         }
<a name="l01329"></a>01329         <span class="keywordflow">default</span>:
<a name="l01330"></a>01330                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01331"></a>01331         }
<a name="l01332"></a>01332 }
<a name="l01333"></a>01333 
<a name="l01334"></a><a class="code" href="group__net.html#ga69bbda1293ed3ddb76113eda09cd7e05">01334</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga69bbda1293ed3ddb76113eda09cd7e05">lustre_msg_set_type</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 type)
<a name="l01335"></a>01335 {
<a name="l01336"></a>01336         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01337"></a>01337         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01338"></a>01338                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01339"></a>01339                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01340"></a>01340                 pb-&gt;pb_type = type;
<a name="l01341"></a>01341                 <span class="keywordflow">return</span>;
<a name="l01342"></a>01342                 }
<a name="l01343"></a>01343         <span class="keywordflow">default</span>:
<a name="l01344"></a>01344                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01345"></a>01345         }
<a name="l01346"></a>01346 }
<a name="l01347"></a>01347 
<a name="l01348"></a><a class="code" href="group__net.html#ga340f5c94b8d8274c155dd269283a3bb5">01348</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga340f5c94b8d8274c155dd269283a3bb5">lustre_msg_set_opc</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 opc)
<a name="l01349"></a>01349 {
<a name="l01350"></a>01350         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01351"></a>01351         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01352"></a>01352                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01353"></a>01353                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01354"></a>01354                 pb-&gt;pb_opc = opc;
<a name="l01355"></a>01355                 <span class="keywordflow">return</span>;
<a name="l01356"></a>01356         }
<a name="l01357"></a>01357         <span class="keywordflow">default</span>:
<a name="l01358"></a>01358                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01359"></a>01359         }
<a name="l01360"></a>01360 }
<a name="l01361"></a>01361 
<a name="l01362"></a><a class="code" href="group__net.html#gad22d60ce1da1272ccbdb640de0c4ab38">01362</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#gad22d60ce1da1272ccbdb640de0c4ab38">lustre_msg_set_last_xid</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> last_xid)
<a name="l01363"></a>01363 {
<a name="l01364"></a>01364         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01365"></a>01365         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01366"></a>01366                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01367"></a>01367                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01368"></a>01368                 pb-&gt;pb_last_xid = last_xid;
<a name="l01369"></a>01369                 <span class="keywordflow">return</span>;
<a name="l01370"></a>01370         }
<a name="l01371"></a>01371         <span class="keywordflow">default</span>:
<a name="l01372"></a>01372                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01373"></a>01373         }
<a name="l01374"></a>01374 }
<a name="l01375"></a>01375 EXPORT_SYMBOL(<a class="code" href="group__net.html#gad22d60ce1da1272ccbdb640de0c4ab38">lustre_msg_set_last_xid</a>);
<a name="l01376"></a>01376 
<a name="l01377"></a><a class="code" href="group__net.html#ga49511c8ab44ce45f0cb42052399a6a00">01377</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga49511c8ab44ce45f0cb42052399a6a00">lustre_msg_set_tag</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u16 tag)
<a name="l01378"></a>01378 {
<a name="l01379"></a>01379         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01380"></a>01380         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01381"></a>01381                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01382"></a>01382                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01383"></a>01383                 pb-&gt;pb_tag = tag;
<a name="l01384"></a>01384                 <span class="keywordflow">return</span>;
<a name="l01385"></a>01385         }
<a name="l01386"></a>01386         <span class="keywordflow">default</span>:
<a name="l01387"></a>01387                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01388"></a>01388         }
<a name="l01389"></a>01389 }
<a name="l01390"></a>01390 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga49511c8ab44ce45f0cb42052399a6a00">lustre_msg_set_tag</a>);
<a name="l01391"></a>01391 
<a name="l01392"></a><a class="code" href="group__net.html#ga3c3a3ba4abbddaf007796fa6532a91ee">01392</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga3c3a3ba4abbddaf007796fa6532a91ee">lustre_msg_set_last_committed</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> last_committed)
<a name="l01393"></a>01393 {
<a name="l01394"></a>01394         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01395"></a>01395         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01396"></a>01396                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01397"></a>01397                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01398"></a>01398                 pb-&gt;pb_last_committed = last_committed;
<a name="l01399"></a>01399                 <span class="keywordflow">return</span>;
<a name="l01400"></a>01400         }
<a name="l01401"></a>01401         <span class="keywordflow">default</span>:
<a name="l01402"></a>01402                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01403"></a>01403         }
<a name="l01404"></a>01404 }
<a name="l01405"></a>01405 
<a name="l01406"></a><a class="code" href="group__net.html#ga3ae7fb0ee2a942e263d0b35929530d79">01406</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga3ae7fb0ee2a942e263d0b35929530d79">lustre_msg_set_versions</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *versions)
<a name="l01407"></a>01407 {
<a name="l01408"></a>01408         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01409"></a>01409         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01410"></a>01410                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01411"></a>01411                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01412"></a>01412                 pb-&gt;pb_pre_versions[0] = versions[0];
<a name="l01413"></a>01413                 pb-&gt;pb_pre_versions[1] = versions[1];
<a name="l01414"></a>01414                 pb-&gt;pb_pre_versions[2] = versions[2];
<a name="l01415"></a>01415                 pb-&gt;pb_pre_versions[3] = versions[3];
<a name="l01416"></a>01416                 <span class="keywordflow">return</span>;
<a name="l01417"></a>01417         }
<a name="l01418"></a>01418         <span class="keywordflow">default</span>:
<a name="l01419"></a>01419                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01420"></a>01420         }
<a name="l01421"></a>01421 }
<a name="l01422"></a>01422 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga3ae7fb0ee2a942e263d0b35929530d79">lustre_msg_set_versions</a>);
<a name="l01423"></a>01423 
<a name="l01424"></a><a class="code" href="group__net.html#ga3866ca9b0ab811a58b005c6459519b3a">01424</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga3866ca9b0ab811a58b005c6459519b3a">lustre_msg_set_transno</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> transno)
<a name="l01425"></a>01425 {
<a name="l01426"></a>01426         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01427"></a>01427         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01428"></a>01428                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01429"></a>01429                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01430"></a>01430                 pb-&gt;pb_transno = transno;
<a name="l01431"></a>01431                 <span class="keywordflow">return</span>;
<a name="l01432"></a>01432         }
<a name="l01433"></a>01433         <span class="keywordflow">default</span>:
<a name="l01434"></a>01434                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01435"></a>01435         }
<a name="l01436"></a>01436 }
<a name="l01437"></a>01437 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga3866ca9b0ab811a58b005c6459519b3a">lustre_msg_set_transno</a>);
<a name="l01438"></a>01438 
<a name="l01439"></a><a class="code" href="group__net.html#ga7f9de05092069e96b6ec4932bcd138d1">01439</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga7f9de05092069e96b6ec4932bcd138d1">lustre_msg_set_status</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 <a class="code" href="lustre__rsync_8c.html#a55591f17a60f597b63f070969c54fd6c">status</a>)
<a name="l01440"></a>01440 {
<a name="l01441"></a>01441         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01442"></a>01442         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01443"></a>01443                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01444"></a>01444                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01445"></a>01445                 pb-&gt;pb_status = status;
<a name="l01446"></a>01446                 <span class="keywordflow">return</span>;
<a name="l01447"></a>01447         }
<a name="l01448"></a>01448         <span class="keywordflow">default</span>:
<a name="l01449"></a>01449                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01450"></a>01450         }
<a name="l01451"></a>01451 }
<a name="l01452"></a>01452 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga7f9de05092069e96b6ec4932bcd138d1">lustre_msg_set_status</a>);
<a name="l01453"></a>01453 
<a name="l01454"></a><a class="code" href="group__net.html#ga53b3384718936bcef0bce14187a7c379">01454</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga53b3384718936bcef0bce14187a7c379">lustre_msg_set_conn_cnt</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 conn_cnt)
<a name="l01455"></a>01455 {
<a name="l01456"></a>01456         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01457"></a>01457         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01458"></a>01458                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01459"></a>01459                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01460"></a>01460                 pb-&gt;pb_conn_cnt = conn_cnt;
<a name="l01461"></a>01461                 <span class="keywordflow">return</span>;
<a name="l01462"></a>01462         }
<a name="l01463"></a>01463         <span class="keywordflow">default</span>:
<a name="l01464"></a>01464                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01465"></a>01465         }
<a name="l01466"></a>01466 }
<a name="l01467"></a>01467 
<a name="l01468"></a><a class="code" href="group__net.html#gaeaac365936d81c960708510421690066">01468</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#gaeaac365936d81c960708510421690066">lustre_msg_set_timeout</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 <a class="code" href="gnilnd__modparams_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>)
<a name="l01469"></a>01469 {
<a name="l01470"></a>01470         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01471"></a>01471         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01472"></a>01472                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01473"></a>01473                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01474"></a>01474                 pb-&gt;pb_timeout = timeout;
<a name="l01475"></a>01475                 <span class="keywordflow">return</span>;
<a name="l01476"></a>01476         }
<a name="l01477"></a>01477         <span class="keywordflow">default</span>:
<a name="l01478"></a>01478                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01479"></a>01479         }
<a name="l01480"></a>01480 }
<a name="l01481"></a>01481 
<a name="l01482"></a><a class="code" href="group__net.html#ga4e3c3687a2b470bfea8a0093067e26f5">01482</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga4e3c3687a2b470bfea8a0093067e26f5">lustre_msg_set_service_time</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 service_time)
<a name="l01483"></a>01483 {
<a name="l01484"></a>01484         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01485"></a>01485         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01486"></a>01486                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01487"></a>01487                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01488"></a>01488                 pb-&gt;pb_service_time = service_time;
<a name="l01489"></a>01489                 <span class="keywordflow">return</span>;
<a name="l01490"></a>01490         }
<a name="l01491"></a>01491         <span class="keywordflow">default</span>:
<a name="l01492"></a>01492                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01493"></a>01493         }
<a name="l01494"></a>01494 }
<a name="l01495"></a>01495 
<a name="l01496"></a><a class="code" href="group__net.html#ga1c7457d1600c44342f8be69cb25a2646">01496</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga1c7457d1600c44342f8be69cb25a2646">lustre_msg_set_jobid</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <span class="keywordtype">char</span> *jobid)
<a name="l01497"></a>01497 {
<a name="l01498"></a>01498         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01499"></a>01499         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01500"></a>01500                 __u32 opc = <a class="code" href="group__net.html#ga5889b19f527897c102df244998c9de02">lustre_msg_get_opc</a>(msg);
<a name="l01501"></a>01501                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb;
<a name="l01502"></a>01502 
<a name="l01503"></a>01503                 <span class="comment">/* Don&apos;t set jobid for ldlm ast RPCs, they&apos;ve been shrinked.</span>
<a name="l01504"></a>01504 <span class="comment">                 * See the comment in ptlrpc_request_pack(). */</span>
<a name="l01505"></a>01505                 <span class="keywordflow">if</span> (!opc || opc == <a class="code" href="packet-lustre_8c.html#a84b2e666d9e1e57928d1521c22a3d9f9">LDLM_BL_CALLBACK</a> ||
<a name="l01506"></a>01506                     opc == <a class="code" href="packet-lustre_8c.html#afe6ffdf7867a3e3e20de2e5d26257761">LDLM_CP_CALLBACK</a> || opc == <a class="code" href="packet-lustre_8c.html#a70035b7ee9554257648ff591d5b088ae">LDLM_GL_CALLBACK</a>)
<a name="l01507"></a>01507                         <span class="keywordflow">return</span>;
<a name="l01508"></a>01508 
<a name="l01509"></a>01509                 pb = <a class="code" href="group__net.html#gac7dfe0f3f8a3973f5b2c2853454dcde6">lustre_msg_buf_v2</a>(msg, <a class="code" href="group__lustreidl.html#gad7ddfc6368a84f8cf442c0d4aabcbdc8">MSG_PTLRPC_BODY_OFF</a>,
<a name="l01510"></a>01510                                        <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a>));
<a name="l01511"></a>01511                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01512"></a>01512 
<a name="l01513"></a>01513                 <span class="keywordflow">if</span> (jobid != NULL)
<a name="l01514"></a>01514                         memcpy(pb-&gt;pb_jobid, jobid, <a class="code" href="group__lustreuser.html#ga0c0d05b1c505aa119e08771fbc1f0f72">LUSTRE_JOBID_SIZE</a>);
<a name="l01515"></a>01515                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pb-&gt;pb_jobid[0] == <span class="charliteral">&apos;\0&apos;</span>)
<a name="l01516"></a>01516                         <a class="code" href="obd__class_8h.html#a5e9656dd304903ab477879fda0fbb73d">lustre_get_jobid</a>(pb-&gt;pb_jobid);
<a name="l01517"></a>01517                 <span class="keywordflow">return</span>;
<a name="l01518"></a>01518         }
<a name="l01519"></a>01519         <span class="keywordflow">default</span>:
<a name="l01520"></a>01520                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01521"></a>01521         }
<a name="l01522"></a>01522 }
<a name="l01523"></a>01523 EXPORT_SYMBOL(<a class="code" href="group__net.html#ga1c7457d1600c44342f8be69cb25a2646">lustre_msg_set_jobid</a>);
<a name="l01524"></a>01524 
<a name="l01525"></a><a class="code" href="group__net.html#ga2da3c742415b9c88d9b8ad49211a0bfd">01525</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga2da3c742415b9c88d9b8ad49211a0bfd">lustre_msg_set_cksum</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, __u32 <a class="code" href="o2iblnd__modparams_8c.html#a4f533d7ca3de0b7d7ecc95de785b4d2c">cksum</a>)
<a name="l01526"></a>01526 {
<a name="l01527"></a>01527         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01528"></a>01528         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l01529"></a>01529                 msg-&gt;lm_cksum = cksum;
<a name="l01530"></a>01530                 <span class="keywordflow">return</span>;
<a name="l01531"></a>01531         <span class="keywordflow">default</span>:
<a name="l01532"></a>01532                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01533"></a>01533         }
<a name="l01534"></a>01534 }
<a name="l01535"></a>01535 
<a name="l01536"></a><a class="code" href="group__net.html#ga682a6cac8b98c3a8ad2122b3c887ca15">01536</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga682a6cac8b98c3a8ad2122b3c887ca15">lustre_msg_set_mbits</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga89e700d146c2a3e6d25089bdf59fb0b9">lustre_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> mbits)
<a name="l01537"></a>01537 {
<a name="l01538"></a>01538         <span class="keywordflow">switch</span> (msg-&gt;lm_magic) {
<a name="l01539"></a>01539         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>: {
<a name="l01540"></a>01540                 <span class="keyword">struct </span><a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *pb = <a class="code" href="pack__generic_8c.html#ada13c3529bec1c99b24c79c727a6316a">lustre_msg_ptlrpc_body</a>(msg);
<a name="l01541"></a>01541 
<a name="l01542"></a>01542                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(pb != NULL, <span class="stringliteral">&quot;invalid msg %p: no ptlrpc body!\n&quot;</span>, msg);
<a name="l01543"></a>01543                 pb-&gt;pb_mbits = mbits;
<a name="l01544"></a>01544                 <span class="keywordflow">return</span>;
<a name="l01545"></a>01545         }
<a name="l01546"></a>01546         <span class="keywordflow">default</span>:
<a name="l01547"></a>01547                 <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(0, <span class="stringliteral">&quot;incorrect message magic: %08x\n&quot;</span>, msg-&gt;lm_magic);
<a name="l01548"></a>01548         }
<a name="l01549"></a>01549 }
<a name="l01550"></a>01550 
<a name="l01551"></a><a class="code" href="group__net.html#gad6590c2ad5fda846f88583c0b8b3db24">01551</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#gad6590c2ad5fda846f88583c0b8b3db24">ptlrpc_request_set_replen</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req)
<a name="l01552"></a>01552 {
<a name="l01553"></a>01553         <span class="keywordtype">int</span> count = <a class="code" href="group__req__layout.html#gab0f7a8e2a51867454ce8f87bb48b0f77" title="Fills in any parts of the rc_area of a pill that haven&amp;#39;t been filled in yet.">req_capsule_filled_sizes</a>(&amp;req-&gt;<a class="code" href="structptlrpc__request.html#ab7324f88fb8682a894baf36052f78da5" title="request format description">rq_pill</a>, <a class="code" href="group__req__layout.html#gga0c07ccef9ef768eb7bf6cb2946c28261a4dac5db7141584c5bd83eae83a8439c0">RCL_SERVER</a>);
<a name="l01554"></a>01554 
<a name="l01555"></a>01555         req-&gt;<a class="code" href="structptlrpc__request.html#aaa9ba7e7b71ad2057d1650469ab15076" title="Reply length.">rq_replen</a> = <a class="code" href="group__net.html#ga32c4986e896273a264d87bbc5d28bc70">lustre_msg_size</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_magic, count,
<a name="l01556"></a>01556                                          req-&gt;<a class="code" href="structptlrpc__request.html#ab7324f88fb8682a894baf36052f78da5" title="request format description">rq_pill</a>.<a class="code" href="structreq__capsule.html#a8517c4eef1b28343cb33da2f122ab938">rc_area</a>[<a class="code" href="group__req__layout.html#gga0c07ccef9ef768eb7bf6cb2946c28261a4dac5db7141584c5bd83eae83a8439c0">RCL_SERVER</a>]);
<a name="l01557"></a>01557         <span class="keywordflow">if</span> (req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_magic == <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>)
<a name="l01558"></a>01558                 req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_repsize = req-&gt;<a class="code" href="structptlrpc__request.html#aaa9ba7e7b71ad2057d1650469ab15076" title="Reply length.">rq_replen</a>;
<a name="l01559"></a>01559 }
<a name="l01560"></a>01560 EXPORT_SYMBOL(<a class="code" href="group__net.html#gad6590c2ad5fda846f88583c0b8b3db24">ptlrpc_request_set_replen</a>);
<a name="l01561"></a>01561 
<a name="l01562"></a><a class="code" href="group__net.html#ga9ce11af085c01fdcf0a2f251b955eb47">01562</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#ga9ce11af085c01fdcf0a2f251b955eb47">ptlrpc_req_set_repsize</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req, <span class="keywordtype">int</span> count, __u32 *lens)
<a name="l01563"></a>01563 {
<a name="l01564"></a>01564         req-&gt;<a class="code" href="structptlrpc__request.html#aaa9ba7e7b71ad2057d1650469ab15076" title="Reply length.">rq_replen</a> = <a class="code" href="group__net.html#ga32c4986e896273a264d87bbc5d28bc70">lustre_msg_size</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_magic, count, lens);
<a name="l01565"></a>01565         <span class="keywordflow">if</span> (req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_magic == <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>)
<a name="l01566"></a>01566                 req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_repsize = req-&gt;<a class="code" href="structptlrpc__request.html#aaa9ba7e7b71ad2057d1650469ab15076" title="Reply length.">rq_replen</a>;
<a name="l01567"></a>01567 }
<a name="l01568"></a>01568 
<a name="l01574"></a><a class="code" href="group__lib.html#gafc5cf9a5b2924b90734e720301742315">01574</a> <span class="keywordtype">int</span> <a class="code" href="group__lib.html#gafc5cf9a5b2924b90734e720301742315" title="Send a remote set_info_async.">do_set_info_async</a>(<span class="keyword">struct</span> <a class="code" href="structobd__import.html" title="Defintion of PortalRPC import structure.">obd_import</a> *imp,
<a name="l01575"></a>01575                       <span class="keywordtype">int</span> opcode, <span class="keywordtype">int</span> <a class="code" href="packet-lnet_8c.html#a0a5c5891c90b30e72f5cfca80915338e">version</a>,
<a name="l01576"></a>01576                       <span class="keywordtype">size_t</span> keylen, <span class="keywordtype">void</span> *key,
<a name="l01577"></a>01577                       <span class="keywordtype">size_t</span> vallen, <span class="keywordtype">void</span> *val,
<a name="l01578"></a>01578                       <span class="keyword">struct</span> <a class="code" href="structptlrpc__request__set.html" title="Definition of request set structure.">ptlrpc_request_set</a> *<span class="keyword">set</span>)
<a name="l01579"></a>01579 {
<a name="l01580"></a>01580         <span class="keyword">struct </span><a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req;
<a name="l01581"></a>01581         <span class="keywordtype">char</span>                  *tmp;
<a name="l01582"></a>01582         <span class="keywordtype">int</span>                    rc;
<a name="l01583"></a>01583         <a class="code" href="flock_8c.html#affebc0cf7e41098a8c78a8c2c4586d72">ENTRY</a>;
<a name="l01584"></a>01584 
<a name="l01585"></a>01585         req = <a class="code" href="group__net.html#ga2bf080a905f488f676248838514e264a" title="Allocate new request structure for import imp and initialize its buffer structure...">ptlrpc_request_alloc</a>(imp, &amp;<a class="code" href="group__req__layout.html#ga5a87266704e432bc673b40193340bdde">RQF_OBD_SET_INFO</a>);
<a name="l01586"></a>01586         <span class="keywordflow">if</span> (req == NULL)
<a name="l01587"></a>01587                 <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(-ENOMEM);
<a name="l01588"></a>01588 
<a name="l01589"></a>01589         <a class="code" href="group__req__layout.html#ga6d0a3a11367bcd9fe40dc723243e7b0d" title="Set the size of the PTLRPC request/reply (loc) buffer for the given field of the...">req_capsule_set_size</a>(&amp;req-&gt;<a class="code" href="structptlrpc__request.html#ab7324f88fb8682a894baf36052f78da5" title="request format description">rq_pill</a>, &amp;<a class="code" href="group__req__layout.html#ga5a1cec6661bbaef33e8f8e0534af66c6">RMF_SETINFO_KEY</a>,
<a name="l01590"></a>01590                              <a class="code" href="group__req__layout.html#gga0c07ccef9ef768eb7bf6cb2946c28261adc73f20c9bd76c23dfb04d1ab75f8ca6">RCL_CLIENT</a>, keylen);
<a name="l01591"></a>01591         <a class="code" href="group__req__layout.html#ga6d0a3a11367bcd9fe40dc723243e7b0d" title="Set the size of the PTLRPC request/reply (loc) buffer for the given field of the...">req_capsule_set_size</a>(&amp;req-&gt;<a class="code" href="structptlrpc__request.html#ab7324f88fb8682a894baf36052f78da5" title="request format description">rq_pill</a>, &amp;<a class="code" href="group__req__layout.html#ga13757565e338a67f1abf3f4ba1a357ea">RMF_SETINFO_VAL</a>,
<a name="l01592"></a>01592                              <a class="code" href="group__req__layout.html#gga0c07ccef9ef768eb7bf6cb2946c28261adc73f20c9bd76c23dfb04d1ab75f8ca6">RCL_CLIENT</a>, vallen);
<a name="l01593"></a>01593         rc = <a class="code" href="group__net.html#gaa1d6f5834629cf755c8f1f0b1a4349de" title="Pack request buffers for network transfer, performing necessary encryption steps...">ptlrpc_request_pack</a>(req, version, opcode);
<a name="l01594"></a>01594         <span class="keywordflow">if</span> (rc) {
<a name="l01595"></a>01595                 <a class="code" href="group__net.html#ga35e91945e5dfe7314c1b31519907929f" title="For requests not from pool, free memory of the request structure.">ptlrpc_request_free</a>(req);
<a name="l01596"></a>01596                 <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(rc);
<a name="l01597"></a>01597         }
<a name="l01598"></a>01598 
<a name="l01599"></a>01599         tmp = <a class="code" href="group__req__layout.html#ga0ecb097da2dfa5ac12ec0ef1f33d3e88" title="Trivial wrapper around __req_capsule_get(), that returns the PTLRPC request buffer...">req_capsule_client_get</a>(&amp;req-&gt;<a class="code" href="structptlrpc__request.html#ab7324f88fb8682a894baf36052f78da5" title="request format description">rq_pill</a>, &amp;<a class="code" href="group__req__layout.html#ga5a1cec6661bbaef33e8f8e0534af66c6">RMF_SETINFO_KEY</a>);
<a name="l01600"></a>01600         memcpy(tmp, key, keylen);
<a name="l01601"></a>01601         tmp = <a class="code" href="group__req__layout.html#ga0ecb097da2dfa5ac12ec0ef1f33d3e88" title="Trivial wrapper around __req_capsule_get(), that returns the PTLRPC request buffer...">req_capsule_client_get</a>(&amp;req-&gt;<a class="code" href="structptlrpc__request.html#ab7324f88fb8682a894baf36052f78da5" title="request format description">rq_pill</a>, &amp;<a class="code" href="group__req__layout.html#ga13757565e338a67f1abf3f4ba1a357ea">RMF_SETINFO_VAL</a>);
<a name="l01602"></a>01602         memcpy(tmp, val, vallen);
<a name="l01603"></a>01603 
<a name="l01604"></a>01604         <a class="code" href="group__net.html#gad6590c2ad5fda846f88583c0b8b3db24">ptlrpc_request_set_replen</a>(req);
<a name="l01605"></a>01605 
<a name="l01606"></a>01606         <span class="keywordflow">if</span> (<span class="keyword">set</span>) {
<a name="l01607"></a>01607                 <a class="code" href="group__net.html#ga5da56461932d974b4c2487f179d8e6d8" title="Add a new request to the general purpose request set.">ptlrpc_set_add_req</a>(<span class="keyword">set</span>, req);
<a name="l01608"></a>01608                 <a class="code" href="group__net.html#ga63613680c8953223c8efc4331656b11a" title="this sends any unsent RPCs in set and returns 1 if all are sent and no more replies...">ptlrpc_check_set</a>(NULL, <span class="keyword">set</span>);
<a name="l01609"></a>01609         } <span class="keywordflow">else</span> {
<a name="l01610"></a>01610                 rc = <a class="code" href="group__net.html#ga003cd2f0c09fd578821500e8084f8c48" title="Send request and wait until it completes.">ptlrpc_queue_wait</a>(req);
<a name="l01611"></a>01611                 <a class="code" href="group__net.html#gaf16bb640b9f0c667d79b7254ac965288" title="Drops one reference count for a request.">ptlrpc_req_finished</a>(req);
<a name="l01612"></a>01612         }
<a name="l01613"></a>01613 
<a name="l01614"></a>01614         <a class="code" href="libcfs__debug_8h.html#a787d0616756df8ab4dceb42a0b73e6d6">RETURN</a>(rc);
<a name="l01615"></a>01615 }
<a name="l01616"></a>01616 EXPORT_SYMBOL(<a class="code" href="group__lib.html#gafc5cf9a5b2924b90734e720301742315" title="Send a remote set_info_async.">do_set_info_async</a>);
<a name="l01617"></a>01617 
<a name="l01618"></a>01618 <span class="comment">/* byte flipping routines for all wire types declared in</span>
<a name="l01619"></a>01619 <span class="comment"> * lustre_idl.h implemented here.</span>
<a name="l01620"></a>01620 <span class="comment"> */</span>
<a name="l01621"></a><a class="code" href="pack__generic_8c.html#af2d798273975e35119e99d03a71ed6ff">01621</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a8fdd690fffd319277581579eba02adbf">lustre_swab_ptlrpc_body</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga56927184b0ee7605c8d10e55ee50da69">ptlrpc_body</a> *b)
<a name="l01622"></a>01622 {
<a name="l01623"></a>01623         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;b-&gt;pb_type);
<a name="l01624"></a>01624         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;b-&gt;pb_version);
<a name="l01625"></a>01625         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;b-&gt;pb_opc);
<a name="l01626"></a>01626         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;b-&gt;pb_status);
<a name="l01627"></a>01627         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;pb_last_xid);
<a name="l01628"></a>01628         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a> (&amp;b-&gt;pb_tag);
<a name="l01629"></a>01629         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;pb_last_committed);
<a name="l01630"></a>01630         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;pb_transno);
<a name="l01631"></a>01631         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;b-&gt;pb_flags);
<a name="l01632"></a>01632         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;b-&gt;pb_op_flags);
<a name="l01633"></a>01633         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;b-&gt;pb_conn_cnt);
<a name="l01634"></a>01634         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;b-&gt;pb_timeout);
<a name="l01635"></a>01635         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;b-&gt;pb_service_time);
<a name="l01636"></a>01636         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;b-&gt;pb_limit);
<a name="l01637"></a>01637         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;pb_slv);
<a name="l01638"></a>01638         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;pb_pre_versions[0]);
<a name="l01639"></a>01639         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;pb_pre_versions[1]);
<a name="l01640"></a>01640         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;pb_pre_versions[2]);
<a name="l01641"></a>01641         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;pb_pre_versions[3]);
<a name="l01642"></a>01642         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;b-&gt;pb_mbits);
<a name="l01643"></a>01643         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), pb_padding0) != 0);
<a name="l01644"></a>01644         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), pb_padding1) != 0);
<a name="l01645"></a>01645         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), pb_padding64_0) != 0);
<a name="l01646"></a>01646         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), pb_padding64_1) != 0);
<a name="l01647"></a>01647         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), pb_padding64_2) != 0);
<a name="l01648"></a>01648         <span class="comment">/* While we need to maintain compatibility between</span>
<a name="l01649"></a>01649 <span class="comment">         * clients and servers without ptlrpc_body_v2 (&lt; 2.3)</span>
<a name="l01650"></a>01650 <span class="comment">         * do not swab any fields beyond pb_jobid, as we are</span>
<a name="l01651"></a>01651 <span class="comment">         * using this swab function for both ptlrpc_body</span>
<a name="l01652"></a>01652 <span class="comment">         * and ptlrpc_body_v2. */</span>
<a name="l01653"></a>01653         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), pb_jobid) != 0);
<a name="l01654"></a>01654 }
<a name="l01655"></a>01655 
<a name="l01656"></a><a class="code" href="pack__generic_8c.html#a0618556ab6dc1ba859dbdf1c1f557049">01656</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#afd3bd6c5a51aaa32359172fa85f5c965">lustre_swab_connect</a>(<span class="keyword">struct</span> <a class="code" href="structobd__connect__data.html">obd_connect_data</a> *ocd)
<a name="l01657"></a>01657 {
<a name="l01658"></a>01658         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#a056d6aaded7f397e902843b52a36a6a5">ocd_connect_flags</a>);
<a name="l01659"></a>01659         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#a39eb02ac915328a18a07c5888c8fc3bc">ocd_version</a>);
<a name="l01660"></a>01660         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#a8f4d1b80cefb3a1b0a4e07a7ee7a0a77">ocd_grant</a>);
<a name="l01661"></a>01661         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#ab074e17beaa68f6b18b8934e3c787f95">ocd_ibits_known</a>);
<a name="l01662"></a>01662         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#a437db419961240accf336a58e5a25b2c">ocd_index</a>);
<a name="l01663"></a>01663         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#a30da77f33210cf12e0d487bb723c0063">ocd_brw_size</a>);
<a name="l01664"></a>01664         <span class="comment">/* ocd_blocksize and ocd_inodespace don&apos;t need to be swabbed because</span>
<a name="l01665"></a>01665 <span class="comment">         * they are 8-byte values */</span>
<a name="l01666"></a>01666         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#a1941b5ac51e8b44534da5d987923b711">ocd_grant_tax_kb</a>);
<a name="l01667"></a>01667         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#af260bc118148cf4809a1d8855e3d735f">ocd_grant_max_blks</a>);
<a name="l01668"></a>01668         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#ac24e4159252d1cb7eaa53090f7931420">ocd_transno</a>);
<a name="l01669"></a>01669         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#a42b5555b86633a89977d423b4213af7c">ocd_group</a>);
<a name="l01670"></a>01670         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#a442fc0152071cb5e1da477b5e33f39b8">ocd_cksum_types</a>);
<a name="l01671"></a>01671         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#a9eb3f8950d1915976618e34bee8630b7">ocd_instance</a>);
<a name="l01672"></a>01672         <span class="comment">/* Fields after ocd_cksum_types are only accessible by the receiver</span>
<a name="l01673"></a>01673 <span class="comment">         * if the corresponding flag in ocd_connect_flags is set. Accessing</span>
<a name="l01674"></a>01674 <span class="comment">         * any field after ocd_maxbytes on the receiver without a valid flag</span>
<a name="l01675"></a>01675 <span class="comment">         * may result in out-of-bound memory access and kernel oops. */</span>
<a name="l01676"></a>01676         <span class="keywordflow">if</span> (ocd-&gt;<a class="code" href="structobd__connect__data.html#a056d6aaded7f397e902843b52a36a6a5">ocd_connect_flags</a> &amp; <a class="code" href="group__lustreidl.html#gae59a2b9eba9b1184fad4aa4eec604381">OBD_CONNECT_MAX_EASIZE</a>)
<a name="l01677"></a>01677                 <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#ae3bc0a28d591a67258c46c63887aac34">ocd_max_easize</a>);
<a name="l01678"></a>01678         <span class="keywordflow">if</span> (ocd-&gt;<a class="code" href="structobd__connect__data.html#a056d6aaded7f397e902843b52a36a6a5">ocd_connect_flags</a> &amp; <a class="code" href="group__lustreidl.html#gad251fc9c8bffd5f3379d6054ffdbf039">OBD_CONNECT_MAXBYTES</a>)
<a name="l01679"></a>01679                 <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#a2347ee8bf8c372b1cae104685de8e523">ocd_maxbytes</a>);
<a name="l01680"></a>01680         <span class="keywordflow">if</span> (ocd-&gt;<a class="code" href="structobd__connect__data.html#a056d6aaded7f397e902843b52a36a6a5">ocd_connect_flags</a> &amp; <a class="code" href="group__lustreidl.html#ga6602fc82ea0e11fa5946c8cdf802550d">OBD_CONNECT_MULTIMODRPCS</a>)
<a name="l01681"></a>01681                 <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#ae08b7631fcbf24b410a9f38c2057e154">ocd_maxmodrpcs</a>);
<a name="l01682"></a>01682         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), padding0) != 0);
<a name="l01683"></a>01683         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), padding1) != 0);
<a name="l01684"></a>01684         <span class="keywordflow">if</span> (ocd-&gt;<a class="code" href="structobd__connect__data.html#a056d6aaded7f397e902843b52a36a6a5">ocd_connect_flags</a> &amp; <a class="code" href="group__lustreidl.html#gaf225799e6a152fa01e31609931fdb52c">OBD_CONNECT_FLAGS2</a>)
<a name="l01685"></a>01685                 <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ocd-&gt;<a class="code" href="structobd__connect__data.html#a103c494bcf8379f539036bcb42b3d4be">ocd_connect_flags2</a>);
<a name="l01686"></a>01686         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), padding3) != 0);
<a name="l01687"></a>01687         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), padding4) != 0);
<a name="l01688"></a>01688         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), padding5) != 0);
<a name="l01689"></a>01689         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), padding6) != 0);
<a name="l01690"></a>01690         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), padding7) != 0);
<a name="l01691"></a>01691         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), padding8) != 0);
<a name="l01692"></a>01692         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), padding9) != 0);
<a name="l01693"></a>01693         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), paddingA) != 0);
<a name="l01694"></a>01694         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), paddingB) != 0);
<a name="l01695"></a>01695         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), paddingC) != 0);
<a name="l01696"></a>01696         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), paddingD) != 0);
<a name="l01697"></a>01697         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), paddingE) != 0);
<a name="l01698"></a>01698         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ocd), paddingF) != 0);
<a name="l01699"></a>01699 }
<a name="l01700"></a>01700 
<a name="l01701"></a><a class="code" href="pack__generic_8c.html#af409bf9cf86ce3091da2e24f34b62efc">01701</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#af409bf9cf86ce3091da2e24f34b62efc">lustre_swab_obdo</a> (<span class="keyword">struct</span> <a class="code" href="structobdo.html">obdo</a>  *o)
<a name="l01702"></a>01702 {
<a name="l01703"></a>01703         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a0602c2272bf3c8483593a6c0bf01a66e">o_valid</a>);
<a name="l01704"></a>01704         <a class="code" href="req-layout_8c.html#a9ebbf49c1d5f446685c3cf4b45f30c62">lustre_swab_ost_id</a>(&amp;o-&gt;<a class="code" href="structobdo.html#a0153b0c6b62ca1ecd1edf36546385cbf">o_oi</a>);
<a name="l01705"></a>01705         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a957449d80d20b11aaaf945f1addc99b6">o_parent_seq</a>);
<a name="l01706"></a>01706         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#abbfa08bf1585f3d5b7a054c55bb1335f">o_size</a>);
<a name="l01707"></a>01707         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a33faaf06b017327f72b23b597311baef">o_mtime</a>);
<a name="l01708"></a>01708         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a6b6b9d4b05c515a36d9d6a682d13148c">o_atime</a>);
<a name="l01709"></a>01709         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a2a15d5de3521a888575545a2f0453d61">o_ctime</a>);
<a name="l01710"></a>01710         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#ab78543505ca489f2c0370660908ba6f5">o_blocks</a>);
<a name="l01711"></a>01711         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a9f775f3fda1cecfaab285a50b8eff864">o_grant</a>);
<a name="l01712"></a>01712         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#ab59a5b464e93a3400197a1aee5eca54a">o_blksize</a>);
<a name="l01713"></a>01713         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a03cb35c43b98e76b9e9b3502f5d69430">o_mode</a>);
<a name="l01714"></a>01714         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a3b458b58ea7917e722ce30a48036d5b5">o_uid</a>);
<a name="l01715"></a>01715         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#aa5e64f099438620d92d234c058c8826f">o_gid</a>);
<a name="l01716"></a>01716         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a3e52c30c4c312d5175be8f1964a9ba08">o_flags</a>);
<a name="l01717"></a>01717         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#af09447b7e89729811173025afaa90e05">o_nlink</a>);
<a name="l01718"></a>01718         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a3f352005b700bc38caecbced7882550f">o_parent_oid</a>);
<a name="l01719"></a>01719         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a2f1f62ca05c673947307bbb4b14169b1">o_misc</a>);
<a name="l01720"></a>01720         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a85c2eabb19225287e404c2b3b39c3163">o_ioepoch</a>);
<a name="l01721"></a>01721         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a98c16dc63976028a2bf826dc12beb66c">o_stripe_idx</a>);
<a name="l01722"></a>01722         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a7db267735d5a4c68a73723a1e3c90484">o_parent_ver</a>);
<a name="l01723"></a>01723         <span class="comment">/* o_handle is opaque */</span>
<a name="l01724"></a>01724         <span class="comment">/* o_lcookie is swabbed elsewhere */</span>
<a name="l01725"></a>01725         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a82dc811da3c620dbd4abab82c34cc16c">o_uid_h</a>);
<a name="l01726"></a>01726         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a0d999b15f3a8ce5c6fea3b598d1d69b0">o_gid_h</a>);
<a name="l01727"></a>01727         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;o-&gt;<a class="code" href="structobdo.html#a845639314f46c97fcdfb4f17a760c9b6">o_data_version</a>);
<a name="l01728"></a>01728         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*o), o_padding_4) != 0);
<a name="l01729"></a>01729         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*o), o_padding_5) != 0);
<a name="l01730"></a>01730         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*o), o_padding_6) != 0);
<a name="l01731"></a>01731 
<a name="l01732"></a>01732 }
<a name="l01733"></a>01733 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#af409bf9cf86ce3091da2e24f34b62efc">lustre_swab_obdo</a>);
<a name="l01734"></a>01734 
<a name="l01735"></a><a class="code" href="pack__generic_8c.html#a4bb1410adcaf601fa1a776c293da710a">01735</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#acc930bebb529aee79ad9b1c16f9afbcd">lustre_swab_obd_statfs</a> (<span class="keyword">struct</span> <a class="code" href="structobd__statfs.html">obd_statfs</a> *os)
<a name="l01736"></a>01736 {
<a name="l01737"></a>01737         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;os-&gt;<a class="code" href="structobd__statfs.html#aa36511a41f5d57c481bc24551a1f0f08">os_type</a>);
<a name="l01738"></a>01738         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;os-&gt;<a class="code" href="structobd__statfs.html#a215b3668739be30efec2bd7f19fbb0c7">os_blocks</a>);
<a name="l01739"></a>01739         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;os-&gt;<a class="code" href="structobd__statfs.html#a49eece096fcec171e80fff33bd629487">os_bfree</a>);
<a name="l01740"></a>01740         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;os-&gt;<a class="code" href="structobd__statfs.html#a7f951cad5548622404e7f191ee03c833">os_bavail</a>);
<a name="l01741"></a>01741         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;os-&gt;<a class="code" href="structobd__statfs.html#a587a46e0db7f8e9f0da22f11bd7ae708">os_files</a>);
<a name="l01742"></a>01742         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;os-&gt;<a class="code" href="structobd__statfs.html#a36dd2709d23604535cf66c5e26ee0520">os_ffree</a>);
<a name="l01743"></a>01743         <span class="comment">/* no need to swab os_fsid */</span>
<a name="l01744"></a>01744         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;os-&gt;<a class="code" href="structobd__statfs.html#a76344faa86ca38a0c85c321f252cc0c3">os_bsize</a>);
<a name="l01745"></a>01745         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;os-&gt;<a class="code" href="structobd__statfs.html#a89590ccf87540d046c7156cd30c799a6">os_namelen</a>);
<a name="l01746"></a>01746         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;os-&gt;<a class="code" href="structobd__statfs.html#a7983422f0e0484d5c00051699da040b7">os_maxbytes</a>);
<a name="l01747"></a>01747         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;os-&gt;<a class="code" href="structobd__statfs.html#ae4a21d5d37c353b564d8aacba5c00320" title="obd_statfs_state OS_STATE_* flag">os_state</a>);
<a name="l01748"></a>01748         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*os), os_fprecreated) != 0);
<a name="l01749"></a>01749         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*os), os_spare2) != 0);
<a name="l01750"></a>01750         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*os), os_spare3) != 0);
<a name="l01751"></a>01751         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*os), os_spare4) != 0);
<a name="l01752"></a>01752         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*os), os_spare5) != 0);
<a name="l01753"></a>01753         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*os), os_spare6) != 0);
<a name="l01754"></a>01754         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*os), os_spare7) != 0);
<a name="l01755"></a>01755         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*os), os_spare8) != 0);
<a name="l01756"></a>01756         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*os), os_spare9) != 0);
<a name="l01757"></a>01757 }
<a name="l01758"></a>01758 
<a name="l01759"></a><a class="code" href="pack__generic_8c.html#a166784a1e77d6c71c036acfaaa81ea32">01759</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a474268bb9689c75c55c2bd5b71da1cc9">lustre_swab_obd_ioobj</a>(<span class="keyword">struct</span> <a class="code" href="structobd__ioobj.html">obd_ioobj</a> *ioo)
<a name="l01760"></a>01760 {
<a name="l01761"></a>01761         <a class="code" href="req-layout_8c.html#a9ebbf49c1d5f446685c3cf4b45f30c62">lustre_swab_ost_id</a>(&amp;ioo-&gt;<a class="code" href="structobd__ioobj.html#aa48d826cec9e602ae5f62cd026c489d2">ioo_oid</a>);
<a name="l01762"></a>01762         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ioo-&gt;<a class="code" href="structobd__ioobj.html#a5406884eaae32b0a6c335e2e8bc40605">ioo_max_brw</a>);
<a name="l01763"></a>01763         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ioo-&gt;<a class="code" href="structobd__ioobj.html#acc084a016e4057c2b4e4ba299f940aae">ioo_bufcnt</a>);
<a name="l01764"></a>01764 }
<a name="l01765"></a>01765 
<a name="l01766"></a><a class="code" href="pack__generic_8c.html#ad5aa12bd4140c2024aff9409be30d99a">01766</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a887fcd6048b2987248ec8ebdbffa1a67">lustre_swab_niobuf_remote</a>(<span class="keyword">struct</span> <a class="code" href="structniobuf__remote.html">niobuf_remote</a> *nbr)
<a name="l01767"></a>01767 {
<a name="l01768"></a>01768         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;nbr-&gt;<a class="code" href="structniobuf__remote.html#af3d2780ccf8895eab786247d4f69418f">rnb_offset</a>);
<a name="l01769"></a>01769         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;nbr-&gt;<a class="code" href="structniobuf__remote.html#aa99016bb10a3ca18e16121bd181770fe">rnb_len</a>);
<a name="l01770"></a>01770         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;nbr-&gt;<a class="code" href="structniobuf__remote.html#aa9a6fcbad64c4395cc6d95bee4bb9f8a">rnb_flags</a>);
<a name="l01771"></a>01771 }
<a name="l01772"></a>01772 
<a name="l01773"></a><a class="code" href="pack__generic_8c.html#add63df1469d73d46139925c1a3fafae5">01773</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a88f663fb79cfef895a49b9e174e573b1">lustre_swab_ost_body</a> (<span class="keyword">struct</span> <a class="code" href="structost__body.html">ost_body</a> *b)
<a name="l01774"></a>01774 {
<a name="l01775"></a>01775         <a class="code" href="lustre__swab_8h.html#af409bf9cf86ce3091da2e24f34b62efc">lustre_swab_obdo</a> (&amp;b-&gt;<a class="code" href="structost__body.html#a347fc2eca12ad6c8f029bcd0eac8ac64">oa</a>);
<a name="l01776"></a>01776 }
<a name="l01777"></a>01777 
<a name="l01778"></a><a class="code" href="pack__generic_8c.html#a2db88783a0598fd0118546cc17017359">01778</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a94f234166c758bc8e2d62b48ce3c5e8c">lustre_swab_ost_last_id</a>(u64 *<span class="keywordtype">id</span>)
<a name="l01779"></a>01779 {
<a name="l01780"></a>01780         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(<span class="keywordtype">id</span>);
<a name="l01781"></a>01781 }
<a name="l01782"></a>01782 
<a name="l01783"></a><a class="code" href="pack__generic_8c.html#a52719d066eb6be3124fec26e641c7594">01783</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a91dfc4bfa0ca6aafe84be092eae57e67">lustre_swab_generic_32s</a>(__u32 *val)
<a name="l01784"></a>01784 {
<a name="l01785"></a>01785         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(val);
<a name="l01786"></a>01786 }
<a name="l01787"></a>01787 
<a name="l01788"></a><a class="code" href="pack__generic_8c.html#af4965d2c8906723c7a5b1c3e298af39c">01788</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a47c023ea6f3186342e939c2e6a061c0a">lustre_swab_gl_desc</a>(<span class="keyword">union</span> <a class="code" href="unionldlm__gl__desc.html">ldlm_gl_desc</a> *desc)
<a name="l01789"></a>01789 {
<a name="l01790"></a>01790         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;desc-&gt;<a class="code" href="unionldlm__gl__desc.html#a9cb9af1be9ae52e09b836f6570923b2f">lquota_desc</a>.<a class="code" href="structldlm__gl__lquota__desc.html#a7b34439f441bc058e8987a65ad8c750c">gl_id</a>.<a class="code" href="unionlquota__id.html#a4c90d42fb31dedd1a5ffa93422a173ec">qid_fid</a>);
<a name="l01791"></a>01791         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;desc-&gt;<a class="code" href="unionldlm__gl__desc.html#a9cb9af1be9ae52e09b836f6570923b2f">lquota_desc</a>.<a class="code" href="structldlm__gl__lquota__desc.html#a527461a2937ff35f235e8dfa04730758">gl_flags</a>);
<a name="l01792"></a>01792         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;desc-&gt;<a class="code" href="unionldlm__gl__desc.html#a9cb9af1be9ae52e09b836f6570923b2f">lquota_desc</a>.<a class="code" href="structldlm__gl__lquota__desc.html#af24f12ba741a752499e20ea259c1099f">gl_ver</a>);
<a name="l01793"></a>01793         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;desc-&gt;<a class="code" href="unionldlm__gl__desc.html#a9cb9af1be9ae52e09b836f6570923b2f">lquota_desc</a>.<a class="code" href="structldlm__gl__lquota__desc.html#ac9dcfc233d19a33fffc24ae90537b7cf">gl_hardlimit</a>);
<a name="l01794"></a>01794         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;desc-&gt;<a class="code" href="unionldlm__gl__desc.html#a9cb9af1be9ae52e09b836f6570923b2f">lquota_desc</a>.<a class="code" href="structldlm__gl__lquota__desc.html#a466caae243f672826a81b07c6c6f276a">gl_softlimit</a>);
<a name="l01795"></a>01795         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;desc-&gt;<a class="code" href="unionldlm__gl__desc.html#a9cb9af1be9ae52e09b836f6570923b2f">lquota_desc</a>.<a class="code" href="structldlm__gl__lquota__desc.html#a68d060248b4e2d3c205e39f45f9ce743">gl_time</a>);
<a name="l01796"></a>01796         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(desc-&gt;<a class="code" href="unionldlm__gl__desc.html#a9cb9af1be9ae52e09b836f6570923b2f">lquota_desc</a>), gl_pad2) != 0);
<a name="l01797"></a>01797 }
<a name="l01798"></a>01798 
<a name="l01799"></a><a class="code" href="pack__generic_8c.html#a12937aaf4e02ca2e4e4deea5efe05946">01799</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a06bf4e85b56d340ef367f20eab455d8c">lustre_swab_ost_lvb_v1</a>(<span class="keyword">struct</span> <a class="code" href="structost__lvb__v1.html">ost_lvb_v1</a> *lvb)
<a name="l01800"></a>01800 {
<a name="l01801"></a>01801         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb__v1.html#ace7a022282237c385edbad1c82594640">lvb_size</a>);
<a name="l01802"></a>01802         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb__v1.html#abdb368a7889885f49c62cbbdb6c953de">lvb_mtime</a>);
<a name="l01803"></a>01803         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb__v1.html#a5470704f8ad54d5c96ac727c2516f62d">lvb_atime</a>);
<a name="l01804"></a>01804         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb__v1.html#a73dd3289d98a372cbc01b71b0af5a4f8">lvb_ctime</a>);
<a name="l01805"></a>01805         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb__v1.html#a45be32aa5a87cedd52b8d3452123b0b1">lvb_blocks</a>);
<a name="l01806"></a>01806 }
<a name="l01807"></a>01807 EXPORT_SYMBOL(<a class="code" href="req-layout_8c.html#a06bf4e85b56d340ef367f20eab455d8c">lustre_swab_ost_lvb_v1</a>);
<a name="l01808"></a>01808 
<a name="l01809"></a><a class="code" href="pack__generic_8c.html#adf7506258f029900af093c82310f70a3">01809</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a1edcfa3b58405609a34eca03682a3dbe">lustre_swab_ost_lvb</a>(<span class="keyword">struct</span> <a class="code" href="structost__lvb.html">ost_lvb</a> *lvb)
<a name="l01810"></a>01810 {
<a name="l01811"></a>01811         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb.html#a6e02b563ed2659d7fa0dfed6865db416">lvb_size</a>);
<a name="l01812"></a>01812         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb.html#a7deb2297b19d3bd30999a7080e1c9958">lvb_mtime</a>);
<a name="l01813"></a>01813         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb.html#aaaef6b18a0f1fc3555f89fddc070f3d3">lvb_atime</a>);
<a name="l01814"></a>01814         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb.html#aa4d41257b0d3fa34f0e37ee2c416655a">lvb_ctime</a>);
<a name="l01815"></a>01815         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb.html#a5a01f47975e892bd6030681836bccf3a">lvb_blocks</a>);
<a name="l01816"></a>01816         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb.html#aec2782039c7e57cd0250e98d1405d620">lvb_mtime_ns</a>);
<a name="l01817"></a>01817         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb.html#a2c597566f4be86915c416b329d543dbc">lvb_atime_ns</a>);
<a name="l01818"></a>01818         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb.html#a54c6c6e2e0b29957495610e3208b2dc2">lvb_ctime_ns</a>);
<a name="l01819"></a>01819         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lvb-&gt;<a class="code" href="structost__lvb.html#a793abcd42fcd8be7a3795fe3a03204b9">lvb_padding</a>);
<a name="l01820"></a>01820 }
<a name="l01821"></a>01821 EXPORT_SYMBOL(<a class="code" href="req-layout_8c.html#a1edcfa3b58405609a34eca03682a3dbe">lustre_swab_ost_lvb</a>);
<a name="l01822"></a>01822 
<a name="l01823"></a><a class="code" href="pack__generic_8c.html#a0b69896ba22ca35293380d36e0053a31">01823</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#a0b69896ba22ca35293380d36e0053a31">lustre_swab_lquota_lvb</a>(<span class="keyword">struct</span> <a class="code" href="structlquota__lvb.html">lquota_lvb</a> *lvb)
<a name="l01824"></a>01824 {
<a name="l01825"></a>01825         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structlquota__lvb.html#ac709a1e09ab716aa6420fbbc83ae1a8b">lvb_flags</a>);
<a name="l01826"></a>01826         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structlquota__lvb.html#a109bb1838dc65de9c5c9f7014761ad1a">lvb_id_may_rel</a>);
<a name="l01827"></a>01827         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structlquota__lvb.html#a1169594fa4ccafa0afa942213be6b348">lvb_id_rel</a>);
<a name="l01828"></a>01828         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structlquota__lvb.html#aef8f0eff7a9777be522cb1ef2d1e8452">lvb_id_qunit</a>);
<a name="l01829"></a>01829         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lvb-&gt;<a class="code" href="structlquota__lvb.html#a040f9df7ff9878c1814e408d65fcab54">lvb_pad1</a>);
<a name="l01830"></a>01830 }
<a name="l01831"></a>01831 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#a0b69896ba22ca35293380d36e0053a31">lustre_swab_lquota_lvb</a>);
<a name="l01832"></a>01832 
<a name="l01833"></a><a class="code" href="pack__generic_8c.html#a8430776510bcc40adea99aa019533155">01833</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a741edf5013cbd5034c26aa900769d9ba">lustre_swab_mdt_body</a> (<span class="keyword">struct</span> <a class="code" href="structmdt__body.html">mdt_body</a> *b)
<a name="l01834"></a>01834 {
<a name="l01835"></a>01835         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#af95f5f511b3aacf651ad7822ee8b324b">mbo_fid1</a>);
<a name="l01836"></a>01836         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#afd6f6a03d5026207695733f18debf281">mbo_fid2</a>);
<a name="l01837"></a>01837         <span class="comment">/* handle is opaque */</span>
<a name="l01838"></a>01838         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a1b206c7182c4ded5e8b9fbb1e8670bb5">mbo_valid</a>);
<a name="l01839"></a>01839         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a3f93f884a6cdf708923972df37ea0ad9">mbo_size</a>);
<a name="l01840"></a>01840         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a9db74eea42ff8424c332fa31ff5b73cb">mbo_mtime</a>);
<a name="l01841"></a>01841         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a3ff7310065ba9b640686ebd8c0d0e0e4">mbo_atime</a>);
<a name="l01842"></a>01842         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a1ab5950fa0a8ee995a466f80fe688c52">mbo_ctime</a>);
<a name="l01843"></a>01843         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a009cacd2be0f8306a0bd2ccf68cb24cd">mbo_blocks</a>);
<a name="l01844"></a>01844         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#adf0797e4c450742ad0df5f889694317c">mbo_ioepoch</a>);
<a name="l01845"></a>01845         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a4df278523ad2f8c4374591ac2574038e">mbo_t_state</a>);
<a name="l01846"></a>01846         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#af163c3cd300a0f129570081d5eac83d9">mbo_fsuid</a>);
<a name="l01847"></a>01847         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a37d4212a0e5abf8a11b5ba29fd02207e">mbo_fsgid</a>);
<a name="l01848"></a>01848         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#ade7c169d995563fc10fea065de871343">mbo_capability</a>);
<a name="l01849"></a>01849         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a4c08c2c6725ffd918c4ef835e1fdd740">mbo_mode</a>);
<a name="l01850"></a>01850         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#aa69f440ff2d167cbf5ea11770bc4d6ce">mbo_uid</a>);
<a name="l01851"></a>01851         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a2ca9cca562df5979ad3502db0646db20">mbo_gid</a>);
<a name="l01852"></a>01852         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a377b0b21bc97e0f7c14a9c391d30b053">mbo_flags</a>);
<a name="l01853"></a>01853         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a8d5c5c4bf3f224d0bf8c5c251c3ab3b1">mbo_rdev</a>);
<a name="l01854"></a>01854         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a96c642f63e2b6ce21e7672d548185069">mbo_nlink</a>);
<a name="l01855"></a>01855         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), mbo_unused2) != 0);
<a name="l01856"></a>01856         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a8366be645fd4e8fd5fcba29243b23528">mbo_suppgid</a>);
<a name="l01857"></a>01857         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a359eea15d049e4e64c13734f1869cfd5">mbo_eadatasize</a>);
<a name="l01858"></a>01858         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#aad4dfd22cdf6492eec9b758fcfd801fd">mbo_aclsize</a>);
<a name="l01859"></a>01859         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a47fc4e6a0c0ed3628e96eb3c319e9d9d">mbo_max_mdsize</a>);
<a name="l01860"></a>01860         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), mbo_unused3) != 0);
<a name="l01861"></a>01861         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#aba1dce946be8fc4751096c6b93e170e3">mbo_uid_h</a>);
<a name="l01862"></a>01862         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structmdt__body.html#a721a32df515d60e1dbb3a6b405b10bde">mbo_gid_h</a>);
<a name="l01863"></a>01863         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), mbo_padding_5) != 0);
<a name="l01864"></a>01864 }
<a name="l01865"></a>01865 
<a name="l01866"></a><a class="code" href="pack__generic_8c.html#a6b90debcea2bee6d9140f6778a0b802a">01866</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a618974e63b6ee06302a4899042caba64">lustre_swab_mdt_ioepoch</a>(<span class="keyword">struct</span> <a class="code" href="structmdt__ioepoch.html">mdt_ioepoch</a> *b)
<a name="l01867"></a>01867 {
<a name="l01868"></a>01868         <span class="comment">/* mio_handle is opaque */</span>
<a name="l01869"></a>01869         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), mio_unused1) != 0);
<a name="l01870"></a>01870         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), mio_unused2) != 0);
<a name="l01871"></a>01871         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), mio_padding) != 0);
<a name="l01872"></a>01872 }
<a name="l01873"></a>01873 
<a name="l01874"></a><a class="code" href="pack__generic_8c.html#aced88d9891e89de6e7d02181ac9d61cb">01874</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a1b9cf5ee157e87008e9cc93f106ece49">lustre_swab_mgs_target_info</a>(<span class="keyword">struct</span> <a class="code" href="structmgs__target__info.html">mgs_target_info</a> *mti)
<a name="l01875"></a>01875 {
<a name="l01876"></a>01876         <span class="keywordtype">int</span> i;
<a name="l01877"></a>01877         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;mti-&gt;<a class="code" href="structmgs__target__info.html#a3785b30ba59af366bcb99f98b53006ea">mti_lustre_ver</a>);
<a name="l01878"></a>01878         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;mti-&gt;<a class="code" href="structmgs__target__info.html#a1404469bf9bb9d09144a197494592875">mti_stripe_index</a>);
<a name="l01879"></a>01879         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;mti-&gt;<a class="code" href="structmgs__target__info.html#afbd159f1e2914a7a3cb80f33d82d9b12">mti_config_ver</a>);
<a name="l01880"></a>01880         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;mti-&gt;<a class="code" href="structmgs__target__info.html#aef50f50b6db8f64dc2cc822b42c6a63f">mti_flags</a>);
<a name="l01881"></a>01881         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;mti-&gt;<a class="code" href="structmgs__target__info.html#a9eb61d5e55c2bdcb0ba894e596833dbe">mti_instance</a>);
<a name="l01882"></a>01882         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;mti-&gt;<a class="code" href="structmgs__target__info.html#a4fb07f821396e99095d4a4ffa8b8c047">mti_nid_count</a>);
<a name="l01883"></a>01883         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<span class="keyword">sizeof</span>(<a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a>) == <span class="keyword">sizeof</span>(<a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>));
<a name="l01884"></a>01884         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group__lustreidl.html#ga61a8d6a24adae4027846fcde2c759ce5">MTI_NIDS_MAX</a>; i++)
<a name="l01885"></a>01885                 <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;mti-&gt;<a class="code" href="structmgs__target__info.html#a0a714f700d17dc58498e26f58126c65f">mti_nids</a>[i]);
<a name="l01886"></a>01886 }
<a name="l01887"></a>01887 
<a name="l01888"></a><a class="code" href="pack__generic_8c.html#aabe38cc167e35f72f2d23b4fe66b230d">01888</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#a659752fe9fdbd0c89db71651da47ca9a">lustre_swab_mgs_nidtbl_entry</a>(<span class="keyword">struct</span> <a class="code" href="structmgs__nidtbl__entry.html">mgs_nidtbl_entry</a> *entry)
<a name="l01889"></a>01889 {
<a name="l01890"></a>01890         __u8 i;
<a name="l01891"></a>01891 
<a name="l01892"></a>01892         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;entry-&gt;<a class="code" href="structmgs__nidtbl__entry.html#abaf7e3a3826a2b7a46ec94c9a2811447">mne_version</a>);
<a name="l01893"></a>01893         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;entry-&gt;<a class="code" href="structmgs__nidtbl__entry.html#a76fa149ebbd120407694b8db0e6ac4bf">mne_instance</a>);
<a name="l01894"></a>01894         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;entry-&gt;<a class="code" href="structmgs__nidtbl__entry.html#a14ec94aad67c611dcb33d0b8b76a2955">mne_index</a>);
<a name="l01895"></a>01895         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;entry-&gt;<a class="code" href="structmgs__nidtbl__entry.html#a18ce27e1d65b1f3db68a1c830751e2ea">mne_length</a>);
<a name="l01896"></a>01896 
<a name="l01897"></a>01897         <span class="comment">/* mne_nid_(count|type) must be one byte size because we&apos;re gonna</span>
<a name="l01898"></a>01898 <span class="comment">         * access it w/o swapping. */</span>
<a name="l01899"></a>01899         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<span class="keyword">sizeof</span>(entry-&gt;<a class="code" href="structmgs__nidtbl__entry.html#aa5a433ea62cd1ad02df1bae6dc530faa">mne_nid_count</a>) == <span class="keyword">sizeof</span>(__u8));
<a name="l01900"></a>01900         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<span class="keyword">sizeof</span>(entry-&gt;<a class="code" href="structmgs__nidtbl__entry.html#a37feeeec964d35261abe75380d6b3a44">mne_nid_type</a>) == <span class="keyword">sizeof</span>(__u8));
<a name="l01901"></a>01901 
<a name="l01902"></a>01902         <span class="comment">/* remove this assertion if ipv6 is supported. */</span>
<a name="l01903"></a>01903         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(entry-&gt;<a class="code" href="structmgs__nidtbl__entry.html#a37feeeec964d35261abe75380d6b3a44">mne_nid_type</a> == 0);
<a name="l01904"></a>01904         <span class="keywordflow">for</span> (i = 0; i &lt; entry-&gt;<a class="code" href="structmgs__nidtbl__entry.html#aa5a433ea62cd1ad02df1bae6dc530faa">mne_nid_count</a>; i++) {
<a name="l01905"></a>01905                 <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<span class="keyword">sizeof</span>(<a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a>) == <span class="keyword">sizeof</span>(<a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>));
<a name="l01906"></a>01906                 <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;entry-&gt;<a class="code" href="structmgs__nidtbl__entry.html#afeb30a15efab5b5bb10f53cdb051aa38">u</a>.<a class="code" href="structmgs__nidtbl__entry.html#a64da89b36ba6a99d2c4d01c724e79600">nids</a>[i]);
<a name="l01907"></a>01907         }
<a name="l01908"></a>01908 }
<a name="l01909"></a>01909 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#a659752fe9fdbd0c89db71651da47ca9a">lustre_swab_mgs_nidtbl_entry</a>);
<a name="l01910"></a>01910 
<a name="l01911"></a><a class="code" href="pack__generic_8c.html#a1a4d599af06ed47024f0ad0da4aabc74">01911</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a389483d8e2becb8eec849d22c725d2d0">lustre_swab_mgs_config_body</a>(<span class="keyword">struct</span> <a class="code" href="structmgs__config__body.html">mgs_config_body</a> *body)
<a name="l01912"></a>01912 {
<a name="l01913"></a>01913         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;body-&gt;<a class="code" href="structmgs__config__body.html#a9dfd5124b39257825b2666bbf2eee46b">mcb_offset</a>);
<a name="l01914"></a>01914         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;body-&gt;<a class="code" href="structmgs__config__body.html#a894300267e2c12ffdc912cfbcfa379e1">mcb_units</a>);
<a name="l01915"></a>01915         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;body-&gt;<a class="code" href="structmgs__config__body.html#a88c2299bba7bd58bc1d3cbab443ce667">mcb_type</a>);
<a name="l01916"></a>01916 }
<a name="l01917"></a>01917 
<a name="l01918"></a><a class="code" href="pack__generic_8c.html#ac48d6d9b1f533ed35708af706114c33d">01918</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a0d81510c907c931510d875ec9e67dd53">lustre_swab_mgs_config_res</a>(<span class="keyword">struct</span> <a class="code" href="structmgs__config__res.html">mgs_config_res</a> *body)
<a name="l01919"></a>01919 {
<a name="l01920"></a>01920         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;body-&gt;<a class="code" href="structmgs__config__res.html#aac190f8a03fa3e6eb82caa3b96586f52">mcr_offset</a>);
<a name="l01921"></a>01921         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;body-&gt;<a class="code" href="structmgs__config__res.html#a2cf5ccb3c70ce258adc4194e438ff985">mcr_size</a>);
<a name="l01922"></a>01922 }
<a name="l01923"></a>01923 
<a name="l01924"></a><a class="code" href="pack__generic_8c.html#a06f2cce8fdf0c558485aedecd7b380be">01924</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="pack__generic_8c.html#a06f2cce8fdf0c558485aedecd7b380be">lustre_swab_obd_dqinfo</a> (<span class="keyword">struct</span> <a class="code" href="structobd__dqinfo.html">obd_dqinfo</a> *i)
<a name="l01925"></a>01925 {
<a name="l01926"></a>01926         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;i-&gt;<a class="code" href="structobd__dqinfo.html#a79415941d144d11aaa5b7354cc21c302">dqi_bgrace</a>);
<a name="l01927"></a>01927         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;i-&gt;<a class="code" href="structobd__dqinfo.html#aab3e70013712aeb2cec48528fccda7e3">dqi_igrace</a>);
<a name="l01928"></a>01928         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;i-&gt;<a class="code" href="structobd__dqinfo.html#a9e1893e463f703df2d4ad6ea0a193d4a">dqi_flags</a>);
<a name="l01929"></a>01929         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;i-&gt;<a class="code" href="structobd__dqinfo.html#ac13108e3ebb35eeed2b03845bec62968">dqi_valid</a>);
<a name="l01930"></a>01930 }
<a name="l01931"></a>01931 
<a name="l01932"></a><a class="code" href="pack__generic_8c.html#aa8764d099f06fcc0b7fa60b3fde67275">01932</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="pack__generic_8c.html#aa8764d099f06fcc0b7fa60b3fde67275">lustre_swab_obd_dqblk</a> (<span class="keyword">struct</span> <a class="code" href="structobd__dqblk.html">obd_dqblk</a> *b)
<a name="l01933"></a>01933 {
<a name="l01934"></a>01934         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;<a class="code" href="structobd__dqblk.html#adaf461d51eca9ed0c1eb33a052ec1f9e">dqb_ihardlimit</a>);
<a name="l01935"></a>01935         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;<a class="code" href="structobd__dqblk.html#a10df1256eec6da70180875f0f9b683fc">dqb_isoftlimit</a>);
<a name="l01936"></a>01936         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;<a class="code" href="structobd__dqblk.html#a8ba495c46c1830b5cae65eab46464345">dqb_curinodes</a>);
<a name="l01937"></a>01937         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;<a class="code" href="structobd__dqblk.html#affd5cf3e1a0aeee6bc7e822a45b7dffe">dqb_bhardlimit</a>);
<a name="l01938"></a>01938         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;<a class="code" href="structobd__dqblk.html#a8a9b427abd384eccbbc560f6b8ba6e17">dqb_bsoftlimit</a>);
<a name="l01939"></a>01939         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;<a class="code" href="structobd__dqblk.html#a5aa03e351791e9cf09a12f32789f2040">dqb_curspace</a>);
<a name="l01940"></a>01940         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;<a class="code" href="structobd__dqblk.html#ad6d7540fbadc5319d5d70aab05538640">dqb_btime</a>);
<a name="l01941"></a>01941         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;b-&gt;<a class="code" href="structobd__dqblk.html#a240ffd0188af4b74e62845ddf69c1ddc">dqb_itime</a>);
<a name="l01942"></a>01942         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;b-&gt;<a class="code" href="structobd__dqblk.html#ae0695eab0a653977a549f3d2b14fa025">dqb_valid</a>);
<a name="l01943"></a>01943         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*b), dqb_padding) != 0);
<a name="l01944"></a>01944 }
<a name="l01945"></a>01945 
<a name="l01946"></a><a class="code" href="pack__generic_8c.html#abc88310f32d9b2efb434f064b194b309">01946</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a4905ba538598760a9ece44dcbfb68444">lustre_swab_obd_quotactl</a> (<span class="keyword">struct</span> <a class="code" href="structobd__quotactl.html">obd_quotactl</a> *q)
<a name="l01947"></a>01947 {
<a name="l01948"></a>01948         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;q-&gt;<a class="code" href="structobd__quotactl.html#aea26e1f46a26a3ff0f7e9d388797cd6e">qc_cmd</a>);
<a name="l01949"></a>01949         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;q-&gt;<a class="code" href="structobd__quotactl.html#a40a342769abca58f21055ef8702a91b9">qc_type</a>);
<a name="l01950"></a>01950         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;q-&gt;<a class="code" href="structobd__quotactl.html#a02fbc1cb7d7c133b44239b1c859022d9">qc_id</a>);
<a name="l01951"></a>01951         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;q-&gt;<a class="code" href="structobd__quotactl.html#a449a6db2822a4e705bb2e669a1f9a8e3">qc_stat</a>);
<a name="l01952"></a>01952         <a class="code" href="pack__generic_8c.html#a06f2cce8fdf0c558485aedecd7b380be">lustre_swab_obd_dqinfo</a> (&amp;q-&gt;<a class="code" href="structobd__quotactl.html#a1bd34138ed67b061b745566e3c1c5972">qc_dqinfo</a>);
<a name="l01953"></a>01953         <a class="code" href="pack__generic_8c.html#aa8764d099f06fcc0b7fa60b3fde67275">lustre_swab_obd_dqblk</a> (&amp;q-&gt;<a class="code" href="structobd__quotactl.html#afc30dadc5b3bbfab38692a28bf4b4d0d">qc_dqblk</a>);
<a name="l01954"></a>01954 }
<a name="l01955"></a>01955 
<a name="l01956"></a><a class="code" href="pack__generic_8c.html#a3df4ac7d1ec2498ba1df7f62073792e2">01956</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#a3df4ac7d1ec2498ba1df7f62073792e2">lustre_swab_mdt_remote_perm</a> (<span class="keyword">struct</span> <a class="code" href="structmdt__remote__perm.html">mdt_remote_perm</a> *p)
<a name="l01957"></a>01957 {
<a name="l01958"></a>01958         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;p-&gt;<a class="code" href="structmdt__remote__perm.html#a511e153a7d5d3435846fd684a76e4229">rp_uid</a>);
<a name="l01959"></a>01959         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;p-&gt;<a class="code" href="structmdt__remote__perm.html#adf4e10b44e6cbcbf7c5f06569f1f5ad7">rp_gid</a>);
<a name="l01960"></a>01960         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;p-&gt;<a class="code" href="structmdt__remote__perm.html#ac3e2db549e0e04b30d6de693666bcfa4">rp_fsuid</a>);
<a name="l01961"></a>01961         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;p-&gt;<a class="code" href="structmdt__remote__perm.html#a6cd98540efc8f5bb13575345e1230bb7">rp_fsuid_h</a>);
<a name="l01962"></a>01962         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;p-&gt;<a class="code" href="structmdt__remote__perm.html#aa01b1abc7f46ec9dc108ca80a671cece">rp_fsgid</a>);
<a name="l01963"></a>01963         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;p-&gt;<a class="code" href="structmdt__remote__perm.html#a60516ce066e0155b0c6e81449920d2a4">rp_fsgid_h</a>);
<a name="l01964"></a>01964         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;p-&gt;<a class="code" href="structmdt__remote__perm.html#a3357c9cd8bae50b0897c69b03c4e1262">rp_access_perm</a>);
<a name="l01965"></a>01965         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;p-&gt;<a class="code" href="structmdt__remote__perm.html#acfee4dc7849f4dfc9503abcbd92672bf">rp_padding</a>);
<a name="l01966"></a>01966 };
<a name="l01967"></a>01967 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#a3df4ac7d1ec2498ba1df7f62073792e2">lustre_swab_mdt_remote_perm</a>);
<a name="l01968"></a>01968 
<a name="l01969"></a><a class="code" href="pack__generic_8c.html#a965b4cb97b074e855d45fdbedea1ae14">01969</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#a965b4cb97b074e855d45fdbedea1ae14">lustre_swab_fid2path</a>(<span class="keyword">struct</span> <a class="code" href="structgetinfo__fid2path.html" title="fid2path request/reply structure">getinfo_fid2path</a> *gf)
<a name="l01970"></a>01970 {
<a name="l01971"></a>01971         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;gf-&gt;<a class="code" href="structgetinfo__fid2path.html#a3778ddcb31f669c84c9165a425671fa9">gf_fid</a>);
<a name="l01972"></a>01972         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;gf-&gt;<a class="code" href="structgetinfo__fid2path.html#a76ec44d74a921af7b166cae9d52e71d9">gf_recno</a>);
<a name="l01973"></a>01973         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;gf-&gt;<a class="code" href="structgetinfo__fid2path.html#a31947c9d34b99725767abcb2eb2f8b21">gf_linkno</a>);
<a name="l01974"></a>01974         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;gf-&gt;<a class="code" href="structgetinfo__fid2path.html#a9b07b0a2629b838040d0ff7fbac7327a">gf_pathlen</a>);
<a name="l01975"></a>01975 }
<a name="l01976"></a>01976 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#a965b4cb97b074e855d45fdbedea1ae14">lustre_swab_fid2path</a>);
<a name="l01977"></a>01977 
<a name="l01978"></a><a class="code" href="pack__generic_8c.html#a33c44686481aaf2a03b628b6ba038fde">01978</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="pack__generic_8c.html#a33c44686481aaf2a03b628b6ba038fde">lustre_swab_fiemap_extent</a>(<span class="keyword">struct</span> fiemap_extent *fm_extent)
<a name="l01979"></a>01979 {
<a name="l01980"></a>01980         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;fm_extent-&gt;fe_logical);
<a name="l01981"></a>01981         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;fm_extent-&gt;fe_physical);
<a name="l01982"></a>01982         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;fm_extent-&gt;fe_length);
<a name="l01983"></a>01983         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;fm_extent-&gt;fe_flags);
<a name="l01984"></a>01984         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;fm_extent-&gt;fe_device);
<a name="l01985"></a>01985 }
<a name="l01986"></a>01986 
<a name="l01987"></a><a class="code" href="pack__generic_8c.html#a395f904e4eba1de1b084b68e1904261b">01987</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a645601e4a3d578afd6554c0bd2bc052b">lustre_swab_fiemap</a>(<span class="keyword">struct</span> fiemap *fiemap)
<a name="l01988"></a>01988 {
<a name="l01989"></a>01989         __u32 i;
<a name="l01990"></a>01990 
<a name="l01991"></a>01991         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;fiemap-&gt;fm_start);
<a name="l01992"></a>01992         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;fiemap-&gt;fm_length);
<a name="l01993"></a>01993         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;fiemap-&gt;fm_flags);
<a name="l01994"></a>01994         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;fiemap-&gt;fm_mapped_extents);
<a name="l01995"></a>01995         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;fiemap-&gt;fm_extent_count);
<a name="l01996"></a>01996         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;fiemap-&gt;fm_reserved);
<a name="l01997"></a>01997 
<a name="l01998"></a>01998         <span class="keywordflow">for</span> (i = 0; i &lt; fiemap-&gt;fm_mapped_extents; i++)
<a name="l01999"></a>01999                 <a class="code" href="pack__generic_8c.html#a33c44686481aaf2a03b628b6ba038fde">lustre_swab_fiemap_extent</a>(&amp;fiemap-&gt;fm_extents[i]);
<a name="l02000"></a>02000 }
<a name="l02001"></a>02001 
<a name="l02002"></a><a class="code" href="pack__generic_8c.html#aa8089b6b0b1565500cef6a0d7f9a5fa8">02002</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a17cf321945ba9b5deb7ca2979d7d3632">lustre_swab_idx_info</a>(<span class="keyword">struct</span> <a class="code" href="structidx__info.html">idx_info</a> *ii)
<a name="l02003"></a>02003 {
<a name="l02004"></a>02004         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ii-&gt;<a class="code" href="structidx__info.html#ab4d65da0f5fa9dd5acb4fa618e774e12">ii_magic</a>);
<a name="l02005"></a>02005         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ii-&gt;<a class="code" href="structidx__info.html#a33ae4005da2c56c417d9c5877e1fc377">ii_flags</a>);
<a name="l02006"></a>02006         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;ii-&gt;<a class="code" href="structidx__info.html#a5640f7f38c07e18a9112adb2237a0e6a">ii_count</a>);
<a name="l02007"></a>02007         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ii-&gt;<a class="code" href="structidx__info.html#a0c441653df2297d074c1959110698916">ii_attrs</a>);
<a name="l02008"></a>02008         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;ii-&gt;<a class="code" href="structidx__info.html#a434daddb88b2d7df21257c99b98d7dae">ii_fid</a>);
<a name="l02009"></a>02009         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ii-&gt;<a class="code" href="structidx__info.html#a3887495e9cc6c769a46bcad6cd6972ac">ii_version</a>);
<a name="l02010"></a>02010         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ii-&gt;<a class="code" href="structidx__info.html#ae3d758ed7af029f0af8f2e8846b19f02">ii_hash_start</a>);
<a name="l02011"></a>02011         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ii-&gt;<a class="code" href="structidx__info.html#a38a5189c7c732824da55e75035d4b5c3">ii_hash_end</a>);
<a name="l02012"></a>02012         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;ii-&gt;<a class="code" href="structidx__info.html#a2541883d516f8bd4aa1978e50e1cf037">ii_keysize</a>);
<a name="l02013"></a>02013         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;ii-&gt;<a class="code" href="structidx__info.html#a33f96ce276bf54f9b5270ec8db708681">ii_recsize</a>);
<a name="l02014"></a>02014 }
<a name="l02015"></a>02015 
<a name="l02016"></a><a class="code" href="pack__generic_8c.html#a2dd0688d6ed83f4ce6b16e7642e0e1fa">02016</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#a2dd0688d6ed83f4ce6b16e7642e0e1fa">lustre_swab_lip_header</a>(<span class="keyword">struct</span> <a class="code" href="structlu__idxpage.html">lu_idxpage</a> *lip)
<a name="l02017"></a>02017 {
<a name="l02018"></a>02018         <span class="comment">/* swab header */</span>
<a name="l02019"></a>02019         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lip-&gt;<a class="code" href="structlu__idxpage.html#abbf5b8e4f78a624bac21aad57e5d309a">lip_magic</a>);
<a name="l02020"></a>02020         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;lip-&gt;<a class="code" href="structlu__idxpage.html#ae7e4f043e5649147c3e4264976544dfd">lip_flags</a>);
<a name="l02021"></a>02021         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;lip-&gt;<a class="code" href="structlu__idxpage.html#a00a2db1647742ba8a6d5bef6c089b819">lip_nr</a>);
<a name="l02022"></a>02022 }
<a name="l02023"></a>02023 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#a2dd0688d6ed83f4ce6b16e7642e0e1fa">lustre_swab_lip_header</a>);
<a name="l02024"></a>02024 
<a name="l02025"></a><a class="code" href="pack__generic_8c.html#ab95e1173fe37e5c0a4a86b74fd8b56a0">02025</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a4831dfe175963a2c1b178eba7748e43f">lustre_swab_mdt_rec_reint</a> (<span class="keyword">struct</span> <a class="code" href="structmdt__rec__reint.html">mdt_rec_reint</a> *rr)
<a name="l02026"></a>02026 {
<a name="l02027"></a>02027         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#aafcc623091a6e5367bad4b6b6f770910">rr_opcode</a>);
<a name="l02028"></a>02028         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#afdba24ee40b8dbc9baeb2dc7e9690998">rr_cap</a>);
<a name="l02029"></a>02029         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#abd92b2a727ca596a6d1a88ff3a5457c5">rr_fsuid</a>);
<a name="l02030"></a>02030         <span class="comment">/* rr_fsuid_h is unused */</span>
<a name="l02031"></a>02031         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#a394566a27b1c46756f6fcdeffb7ad907">rr_fsgid</a>);
<a name="l02032"></a>02032         <span class="comment">/* rr_fsgid_h is unused */</span>
<a name="l02033"></a>02033         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#ad9ecf91eeea873649bef430d220979bf">rr_suppgid1</a>);
<a name="l02034"></a>02034         <span class="comment">/* rr_suppgid1_h is unused */</span>
<a name="l02035"></a>02035         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#a9df180013da3d42b39ffd92fcb86b414">rr_suppgid2</a>);
<a name="l02036"></a>02036         <span class="comment">/* rr_suppgid2_h is unused */</span>
<a name="l02037"></a>02037         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#a8f95eb8e3275a598063b9f3551a77712">rr_fid1</a>);
<a name="l02038"></a>02038         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#a812f4e27ef9878c6144a1f5b39f931bb">rr_fid2</a>);
<a name="l02039"></a>02039         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#a68842b6bc61e499a01018158352f9643">rr_mtime</a>);
<a name="l02040"></a>02040         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#ad4c079bfb9a2f93b5ef55b7095951c92">rr_atime</a>);
<a name="l02041"></a>02041         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#a1e1701248de1b3edd25b48d9fbd9d987">rr_ctime</a>);
<a name="l02042"></a>02042         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#afbc040f26ec17aa8e28e4721ea06c444">rr_size</a>);
<a name="l02043"></a>02043         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#a17c7267d2f8dd6a6b9b77d5d05a82b4a">rr_blocks</a>);
<a name="l02044"></a>02044         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#a9ffa3efb3ac5d951dbf4ba03775fda56">rr_bias</a>);
<a name="l02045"></a>02045         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#a02ea8a2110907a82a819c11becc3de32">rr_mode</a>);
<a name="l02046"></a>02046         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#a47bcdd0379324cd97778ca3373e6580f">rr_flags</a>);
<a name="l02047"></a>02047         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#af253be1342b9df451229ff512beced42">rr_flags_h</a>);
<a name="l02048"></a>02048         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;rr-&gt;<a class="code" href="structmdt__rec__reint.html#acc96e46d916031619b67986ce8b6669f">rr_umask</a>);
<a name="l02049"></a>02049 
<a name="l02050"></a>02050         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*rr), rr_padding_4) != 0);
<a name="l02051"></a>02051 };
<a name="l02052"></a>02052 
<a name="l02053"></a><a class="code" href="pack__generic_8c.html#a1572fa59a8929b50455b279959c025b7">02053</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#a1572fa59a8929b50455b279959c025b7">lustre_swab_lov_desc</a> (<span class="keyword">struct</span> <a class="code" href="structlov__desc.html">lov_desc</a> *ld)
<a name="l02054"></a>02054 {
<a name="l02055"></a>02055         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;ld-&gt;<a class="code" href="structlov__desc.html#ae0dab4d70fbf47fb1396118063e29efc">ld_tgt_count</a>);
<a name="l02056"></a>02056         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;ld-&gt;<a class="code" href="structlov__desc.html#a8982b0377ab59b189c41ca8c54f412d7">ld_active_tgt_count</a>);
<a name="l02057"></a>02057         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;ld-&gt;<a class="code" href="structlov__desc.html#afe1f5e1c047e843ae536aaa0bd97bc80">ld_default_stripe_count</a>);
<a name="l02058"></a>02058         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;ld-&gt;<a class="code" href="structlov__desc.html#ac0b3cdfdbc5c4e1e3b7dfcefe461b499">ld_pattern</a>);
<a name="l02059"></a>02059         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;ld-&gt;<a class="code" href="structlov__desc.html#a2b1139641dc3bb0310e663d947fa2e13">ld_default_stripe_size</a>);
<a name="l02060"></a>02060         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;ld-&gt;<a class="code" href="structlov__desc.html#a5f0938339dac881d3d82a2fdde68547f">ld_default_stripe_offset</a>);
<a name="l02061"></a>02061         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;ld-&gt;<a class="code" href="structlov__desc.html#a19eb5f8fa9c4794272f08c2723eda52b">ld_qos_maxage</a>);
<a name="l02062"></a>02062         <span class="comment">/* uuid endian insensitive */</span>
<a name="l02063"></a>02063 }
<a name="l02064"></a>02064 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#a1572fa59a8929b50455b279959c025b7">lustre_swab_lov_desc</a>);
<a name="l02065"></a>02065 
<a name="l02066"></a><a class="code" href="pack__generic_8c.html#aa17ebce50c33f3cb1aa2a9651de8ff3d">02066</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#aa17ebce50c33f3cb1aa2a9651de8ff3d">lustre_swab_lmv_desc</a> (<span class="keyword">struct</span> <a class="code" href="structlmv__desc.html">lmv_desc</a> *ld)
<a name="l02067"></a>02067 {
<a name="l02068"></a>02068         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;ld-&gt;<a class="code" href="structlmv__desc.html#a4d4d4efe2de62e2d54e49dde2c2e2854">ld_tgt_count</a>);
<a name="l02069"></a>02069         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;ld-&gt;<a class="code" href="structlmv__desc.html#a1ba21704d398ca3271311f34748d440e">ld_active_tgt_count</a>);
<a name="l02070"></a>02070         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;ld-&gt;<a class="code" href="structlmv__desc.html#a7253cc59a16831378c7a495753ba84b0">ld_default_stripe_count</a>);
<a name="l02071"></a>02071         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;ld-&gt;<a class="code" href="structlmv__desc.html#a83b1cf4ecfc8759660ad6a7aeef3c922">ld_pattern</a>);
<a name="l02072"></a>02072         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;ld-&gt;<a class="code" href="structlmv__desc.html#a434a18f942269c978c11717680e27b60">ld_default_hash_size</a>);
<a name="l02073"></a>02073         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;ld-&gt;<a class="code" href="structlmv__desc.html#af8956d75e49ef2512ea80d5c3504c0d2">ld_qos_maxage</a>);
<a name="l02074"></a>02074         <span class="comment">/* uuid endian insensitive */</span>
<a name="l02075"></a>02075 }
<a name="l02076"></a>02076 
<a name="l02077"></a>02077 <span class="comment">/* This structure is always in little-endian */</span>
<a name="l02078"></a><a class="code" href="pack__generic_8c.html#a92bf81cefb1a4114ac6082bca8441a10">02078</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="pack__generic_8c.html#a92bf81cefb1a4114ac6082bca8441a10">lustre_swab_lmv_mds_md_v1</a>(<span class="keyword">struct</span> <a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a> *lmm1)
<a name="l02079"></a>02079 {
<a name="l02080"></a>02080         <span class="keywordtype">int</span> i;
<a name="l02081"></a>02081 
<a name="l02082"></a>02082         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lmm1-&gt;<a class="code" href="structlmv__mds__md__v1.html#ac2b14a45c4dd28ad5872864b645fe944">lmv_magic</a>);
<a name="l02083"></a>02083         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lmm1-&gt;<a class="code" href="structlmv__mds__md__v1.html#a3002cd6110eb9b23fc13986d18d60591">lmv_stripe_count</a>);
<a name="l02084"></a>02084         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lmm1-&gt;<a class="code" href="structlmv__mds__md__v1.html#a84b8f3843894cd656966dc846fa36763">lmv_master_mdt_index</a>);
<a name="l02085"></a>02085         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lmm1-&gt;<a class="code" href="structlmv__mds__md__v1.html#a319805ff1f68b1bf3354d715fbfdf1d5">lmv_hash_type</a>);
<a name="l02086"></a>02086         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lmm1-&gt;<a class="code" href="structlmv__mds__md__v1.html#ac03443e0880b55f3105b28d2bbd683c1">lmv_layout_version</a>);
<a name="l02087"></a>02087         <span class="keywordflow">for</span> (i = 0; i &lt; lmm1-&gt;<a class="code" href="structlmv__mds__md__v1.html#a3002cd6110eb9b23fc13986d18d60591">lmv_stripe_count</a>; i++)
<a name="l02088"></a>02088                 <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;lmm1-&gt;<a class="code" href="structlmv__mds__md__v1.html#a665969d5fd3737b04b8d5a6c0bf556b7">lmv_stripe_fids</a>[i]);
<a name="l02089"></a>02089 }
<a name="l02090"></a>02090 
<a name="l02091"></a><a class="code" href="pack__generic_8c.html#a19834f7c643189bd95d9bc99fbcf0baa">02091</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#a19834f7c643189bd95d9bc99fbcf0baa">lustre_swab_lmv_mds_md</a>(<span class="keyword">union</span> <a class="code" href="unionlmv__mds__md.html">lmv_mds_md</a> *lmm)
<a name="l02092"></a>02092 {
<a name="l02093"></a>02093         <span class="keywordflow">switch</span> (lmm-&gt;<a class="code" href="unionlmv__mds__md.html#a76a8b364103705d95533fd915cbfff17">lmv_magic</a>) {
<a name="l02094"></a>02094         <span class="keywordflow">case</span> <a class="code" href="group__lustreidl.html#gab6a609ad077d7b362a74873489238c89">LMV_MAGIC_V1</a>:
<a name="l02095"></a>02095                 <a class="code" href="pack__generic_8c.html#a92bf81cefb1a4114ac6082bca8441a10">lustre_swab_lmv_mds_md_v1</a>(&amp;lmm-&gt;<a class="code" href="unionlmv__mds__md.html#a4e9f4a4a56fa910ec829ec890a713130">lmv_md_v1</a>);
<a name="l02096"></a>02096                 <span class="keywordflow">break</span>;
<a name="l02097"></a>02097         <span class="keywordflow">default</span>:
<a name="l02098"></a>02098                 <span class="keywordflow">break</span>;
<a name="l02099"></a>02099         }
<a name="l02100"></a>02100 }
<a name="l02101"></a>02101 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#a19834f7c643189bd95d9bc99fbcf0baa">lustre_swab_lmv_mds_md</a>);
<a name="l02102"></a>02102 
<a name="l02103"></a><a class="code" href="pack__generic_8c.html#aa391632ccb257b46fce4c5f6106fc0cb">02103</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a2cd5013ceb4af904e8c0a563318614a9">lustre_swab_lmv_user_md</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreuser.html#ga738c0eb770a010b5c6a8c6f4804cdbe4">lmv_user_md</a> *lum)
<a name="l02104"></a>02104 {
<a name="l02105"></a>02105         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lum-&gt;lum_magic);
<a name="l02106"></a>02106         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lum-&gt;lum_stripe_count);
<a name="l02107"></a>02107         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lum-&gt;lum_stripe_offset);
<a name="l02108"></a>02108         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lum-&gt;lum_hash_type);
<a name="l02109"></a>02109         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lum-&gt;lum_type);
<a name="l02110"></a>02110         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*lum), lum_padding1) != 0);
<a name="l02111"></a>02111 }
<a name="l02112"></a>02112 EXPORT_SYMBOL(<a class="code" href="req-layout_8c.html#a2cd5013ceb4af904e8c0a563318614a9">lustre_swab_lmv_user_md</a>);
<a name="l02113"></a>02113 
<a name="l02114"></a><a class="code" href="group__lustreidl.html#ga6265e83fcdf6cfa54792c67c3650567b">02114</a> <span class="keywordtype">void</span> <a class="code" href="group__lustreidl.html#ga6265e83fcdf6cfa54792c67c3650567b">lustre_print_user_md</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lvl, <span class="keyword">struct</span> <a class="code" href="group__lustreuser.html#ga9c004c151be5b9c6f1886530cbd17136">lov_user_md</a> *lum,
<a name="l02115"></a>02115                           <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l02116"></a>02116 {
<a name="l02117"></a>02117         <span class="keywordflow">if</span> (<a class="code" href="libcfs__private_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a>(!<a class="code" href="libcfs__debug_8h.html#a7cb6b1ff959b11c833671412fd2df88c">cfs_cdebug_show</a>(lvl, <a class="code" href="fid__handler_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>)))
<a name="l02118"></a>02118                 <span class="keywordflow">return</span>;
<a name="l02119"></a>02119 
<a name="l02120"></a>02120         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(lvl, <span class="stringliteral">&quot;%s lov_user_md %p:\n&quot;</span>, msg, lum);
<a name="l02121"></a>02121         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(lvl, <span class="stringliteral">&quot;\tlmm_magic: %#x\n&quot;</span>, lum-&gt;lmm_magic);
<a name="l02122"></a>02122         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(lvl, <span class="stringliteral">&quot;\tlmm_pattern: %#x\n&quot;</span>, lum-&gt;lmm_pattern);
<a name="l02123"></a>02123         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(lvl, <span class="stringliteral">&quot;\tlmm_object_id: &quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a5ef11521803262dc2f972061520e41f2">LPU64</a><span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="group__lustreidl.html#gadbfa52aacd66d86a733ecbe18b45707e">lmm_oi_id</a>(&amp;lum-&gt;lmm_oi));
<a name="l02124"></a>02124         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(lvl, <span class="stringliteral">&quot;\tlmm_object_gr: &quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a5ef11521803262dc2f972061520e41f2">LPU64</a><span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="group__lustreidl.html#ga8c5b2cb7772e96f94b2fa1a96db928b5">lmm_oi_seq</a>(&amp;lum-&gt;lmm_oi));
<a name="l02125"></a>02125         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(lvl, <span class="stringliteral">&quot;\tlmm_stripe_size: %#x\n&quot;</span>, lum-&gt;lmm_stripe_size);
<a name="l02126"></a>02126         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(lvl, <span class="stringliteral">&quot;\tlmm_stripe_count: %#x\n&quot;</span>, lum-&gt;lmm_stripe_count);
<a name="l02127"></a>02127         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(lvl, <span class="stringliteral">&quot;\tlmm_stripe_offset/lmm_layout_gen: %#x\n&quot;</span>,
<a name="l02128"></a>02128                lum-&gt;lmm_stripe_offset);
<a name="l02129"></a>02129         <span class="keywordflow">if</span> (lum-&gt;lmm_magic == <a class="code" href="group__lustreuser.html#gade10fb540dbbc743f2a3140ca3bb4811">LOV_USER_MAGIC_V3</a>) {
<a name="l02130"></a>02130                 <span class="keyword">struct </span><a class="code" href="structlov__user__md__v3.html">lov_user_md_v3</a> *v3 = (<span class="keywordtype">void</span> *)lum;
<a name="l02131"></a>02131                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(lvl, <span class="stringliteral">&quot;\tlmm_pool_name: %s\n&quot;</span>, v3-&gt;<a class="code" href="structlov__user__md__v3.html#a9acfd7af44a40edbeb720bb0414d36c0">lmm_pool_name</a>);
<a name="l02132"></a>02132         }
<a name="l02133"></a>02133         <span class="keywordflow">if</span> (lum-&gt;lmm_magic == <a class="code" href="group__lustreuser.html#ga45d8f3dbfd52624efe358a3f3bd3057f">LOV_USER_MAGIC_SPECIFIC</a>) {
<a name="l02134"></a>02134                 <span class="keyword">struct </span><a class="code" href="structlov__user__md__v3.html">lov_user_md_v3</a> *v3 = (<span class="keywordtype">void</span> *)lum;
<a name="l02135"></a>02135                 <span class="keywordtype">int</span> i;
<a name="l02136"></a>02136 
<a name="l02137"></a>02137                 <span class="keywordflow">if</span> (v3-&gt;<a class="code" href="structlov__user__md__v3.html#a9acfd7af44a40edbeb720bb0414d36c0">lmm_pool_name</a>[0] != <span class="charliteral">&apos;\0&apos;</span>)
<a name="l02138"></a>02138                         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(lvl, <span class="stringliteral">&quot;\tlmm_pool_name: %s\n&quot;</span>, v3-&gt;<a class="code" href="structlov__user__md__v3.html#a9acfd7af44a40edbeb720bb0414d36c0">lmm_pool_name</a>);
<a name="l02139"></a>02139 
<a name="l02140"></a>02140                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(lvl, <span class="stringliteral">&quot;\ttarget list:\n&quot;</span>);
<a name="l02141"></a>02141                 <span class="keywordflow">for</span> (i = 0; i &lt; v3-&gt;<a class="code" href="structlov__user__md__v3.html#a554e3ea255169ce02c18ca3712305e84">lmm_stripe_count</a>; i++)
<a name="l02142"></a>02142                         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(lvl, <span class="stringliteral">&quot;\t\t%u\n&quot;</span>, v3-&gt;<a class="code" href="structlov__user__md__v3.html#a039fc7e6a74d31f6324ac64328730d30">lmm_objects</a>[i].<a class="code" href="structlov__user__ost__data__v1.html#acc13a44e57e18a5ba950ecec646bde86">l_ost_idx</a>);
<a name="l02143"></a>02143         }
<a name="l02144"></a>02144 }
<a name="l02145"></a>02145 EXPORT_SYMBOL(<a class="code" href="group__lustreidl.html#ga6265e83fcdf6cfa54792c67c3650567b">lustre_print_user_md</a>);
<a name="l02146"></a>02146 
<a name="l02147"></a><a class="code" href="pack__generic_8c.html#a3c459f136c9213199a318ac5db565422">02147</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="pack__generic_8c.html#a3c459f136c9213199a318ac5db565422">lustre_swab_lmm_oi</a>(<span class="keyword">struct</span> <a class="code" href="structost__id.html" title="OST object IDentifier.">ost_id</a> *oi)
<a name="l02148"></a>02148 {
<a name="l02149"></a>02149         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;oi-&gt;<a class="code" href="structost__id.html#a01d44bff8859d8cd3aabe8a4b0c2ee46">oi</a>.oi_id);
<a name="l02150"></a>02150         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;oi-&gt;<a class="code" href="structost__id.html#a01d44bff8859d8cd3aabe8a4b0c2ee46">oi</a>.oi_seq);
<a name="l02151"></a>02151 }
<a name="l02152"></a>02152 
<a name="l02153"></a><a class="code" href="pack__generic_8c.html#af3b322f23c3e6e81f053acd6be1f0e28">02153</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="pack__generic_8c.html#af3b322f23c3e6e81f053acd6be1f0e28">lustre_swab_lov_user_md_common</a>(<span class="keyword">struct</span> <a class="code" href="structlov__user__md__v1.html">lov_user_md_v1</a> *lum)
<a name="l02154"></a>02154 {
<a name="l02155"></a>02155         <a class="code" href="flock_8c.html#affebc0cf7e41098a8c78a8c2c4586d72">ENTRY</a>;
<a name="l02156"></a>02156         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lum-&gt;<a class="code" href="structlov__user__md__v1.html#ae52fc00a465a1548ea03606c7f1cf65c">lmm_magic</a>);
<a name="l02157"></a>02157         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lum-&gt;<a class="code" href="structlov__user__md__v1.html#ae17b5386d46654a2a226a70286c677dc">lmm_pattern</a>);
<a name="l02158"></a>02158         <a class="code" href="pack__generic_8c.html#a3c459f136c9213199a318ac5db565422">lustre_swab_lmm_oi</a>(&amp;lum-&gt;<a class="code" href="structlov__user__md__v1.html#a1398d668081fa73c1c014bfffd691cbb">lmm_oi</a>);
<a name="l02159"></a>02159         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lum-&gt;<a class="code" href="structlov__user__md__v1.html#ad42629be430d2a1bd985611c9e9936d8">lmm_stripe_size</a>);
<a name="l02160"></a>02160         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;lum-&gt;<a class="code" href="structlov__user__md__v1.html#a67618600e73fe76e46ea365c6696de2b">lmm_stripe_count</a>);
<a name="l02161"></a>02161         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;lum-&gt;<a class="code" href="structlov__user__md__v1.html#a28a02dad5fab8bf35b8340f802db6725">lmm_stripe_offset</a>);
<a name="l02162"></a>02162         <a class="code" href="flock_8c.html#ad111e603bbebe5d87f6bc39264ce4733">EXIT</a>;
<a name="l02163"></a>02163 }
<a name="l02164"></a>02164 
<a name="l02165"></a><a class="code" href="pack__generic_8c.html#a7f3563ea89929b7128b7c044d3a310a9">02165</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#a7f3563ea89929b7128b7c044d3a310a9">lustre_swab_lov_user_md_v1</a>(<span class="keyword">struct</span> <a class="code" href="structlov__user__md__v1.html">lov_user_md_v1</a> *lum)
<a name="l02166"></a>02166 {
<a name="l02167"></a>02167         <a class="code" href="flock_8c.html#affebc0cf7e41098a8c78a8c2c4586d72">ENTRY</a>;
<a name="l02168"></a>02168         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#ac7f58d3617434ae1289aa59f62299d7e">D_IOCTL</a>, <span class="stringliteral">&quot;swabbing lov_user_md v1\n&quot;</span>);
<a name="l02169"></a>02169         <a class="code" href="pack__generic_8c.html#af3b322f23c3e6e81f053acd6be1f0e28">lustre_swab_lov_user_md_common</a>(lum);
<a name="l02170"></a>02170         <a class="code" href="flock_8c.html#ad111e603bbebe5d87f6bc39264ce4733">EXIT</a>;
<a name="l02171"></a>02171 }
<a name="l02172"></a>02172 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#a7f3563ea89929b7128b7c044d3a310a9">lustre_swab_lov_user_md_v1</a>);
<a name="l02173"></a>02173 
<a name="l02174"></a><a class="code" href="pack__generic_8c.html#af15acfe3cb5a1aa40090e556a8726955">02174</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#af15acfe3cb5a1aa40090e556a8726955">lustre_swab_lov_user_md_v3</a>(<span class="keyword">struct</span> <a class="code" href="structlov__user__md__v3.html">lov_user_md_v3</a> *lum)
<a name="l02175"></a>02175 {
<a name="l02176"></a>02176         <a class="code" href="flock_8c.html#affebc0cf7e41098a8c78a8c2c4586d72">ENTRY</a>;
<a name="l02177"></a>02177         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#ac7f58d3617434ae1289aa59f62299d7e">D_IOCTL</a>, <span class="stringliteral">&quot;swabbing lov_user_md v3\n&quot;</span>);
<a name="l02178"></a>02178         <a class="code" href="pack__generic_8c.html#af3b322f23c3e6e81f053acd6be1f0e28">lustre_swab_lov_user_md_common</a>((<span class="keyword">struct</span> <a class="code" href="structlov__user__md__v1.html">lov_user_md_v1</a> *)lum);
<a name="l02179"></a>02179         <span class="comment">/* lmm_pool_name nothing to do with char */</span>
<a name="l02180"></a>02180         <a class="code" href="flock_8c.html#ad111e603bbebe5d87f6bc39264ce4733">EXIT</a>;
<a name="l02181"></a>02181 }
<a name="l02182"></a>02182 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#af15acfe3cb5a1aa40090e556a8726955">lustre_swab_lov_user_md_v3</a>);
<a name="l02183"></a>02183 
<a name="l02184"></a><a class="code" href="pack__generic_8c.html#a7c06517fcaa348fc4ef5c6fedc7c2352">02184</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#a7c06517fcaa348fc4ef5c6fedc7c2352">lustre_swab_lov_mds_md</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreidl.html#ga120d1e282e1d65132fbcd7f17ae908c7">lov_mds_md</a> *lmm)
<a name="l02185"></a>02185 {
<a name="l02186"></a>02186         <a class="code" href="flock_8c.html#affebc0cf7e41098a8c78a8c2c4586d72">ENTRY</a>;
<a name="l02187"></a>02187         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#ac7f58d3617434ae1289aa59f62299d7e">D_IOCTL</a>, <span class="stringliteral">&quot;swabbing lov_mds_md\n&quot;</span>);
<a name="l02188"></a>02188         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lmm-&gt;lmm_magic);
<a name="l02189"></a>02189         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lmm-&gt;lmm_pattern);
<a name="l02190"></a>02190         <a class="code" href="pack__generic_8c.html#a3c459f136c9213199a318ac5db565422">lustre_swab_lmm_oi</a>(&amp;lmm-&gt;lmm_oi);
<a name="l02191"></a>02191         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lmm-&gt;lmm_stripe_size);
<a name="l02192"></a>02192         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;lmm-&gt;lmm_stripe_count);
<a name="l02193"></a>02193         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;lmm-&gt;lmm_layout_gen);
<a name="l02194"></a>02194         <a class="code" href="flock_8c.html#ad111e603bbebe5d87f6bc39264ce4733">EXIT</a>;
<a name="l02195"></a>02195 }
<a name="l02196"></a>02196 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#a7c06517fcaa348fc4ef5c6fedc7c2352">lustre_swab_lov_mds_md</a>);
<a name="l02197"></a>02197 
<a name="l02198"></a><a class="code" href="pack__generic_8c.html#a90649a452503c0e9ec3eef0d204088a8">02198</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#a90649a452503c0e9ec3eef0d204088a8">lustre_swab_lov_user_md_objects</a>(<span class="keyword">struct</span> <a class="code" href="group__lustreuser.html#ga93740a566eb23b6f35ea20be820da0c5">lov_user_ost_data</a> *lod,
<a name="l02199"></a>02199                                      <span class="keywordtype">int</span> stripe_count)
<a name="l02200"></a>02200 {
<a name="l02201"></a>02201         <span class="keywordtype">int</span> i;
<a name="l02202"></a>02202         <a class="code" href="flock_8c.html#affebc0cf7e41098a8c78a8c2c4586d72">ENTRY</a>;
<a name="l02203"></a>02203         <span class="keywordflow">for</span> (i = 0; i &lt; stripe_count; i++) {
<a name="l02204"></a>02204                 <a class="code" href="req-layout_8c.html#a9ebbf49c1d5f446685c3cf4b45f30c62">lustre_swab_ost_id</a>(&amp;(lod[i].l_ost_oi));
<a name="l02205"></a>02205                 <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;(lod[i].l_ost_gen));
<a name="l02206"></a>02206                 <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;(lod[i].l_ost_idx));
<a name="l02207"></a>02207         }
<a name="l02208"></a>02208         <a class="code" href="flock_8c.html#ad111e603bbebe5d87f6bc39264ce4733">EXIT</a>;
<a name="l02209"></a>02209 }
<a name="l02210"></a>02210 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#a90649a452503c0e9ec3eef0d204088a8">lustre_swab_lov_user_md_objects</a>);
<a name="l02211"></a>02211 
<a name="l02212"></a><a class="code" href="pack__generic_8c.html#aa3172059e2e03b1af50180e3fd339450">02212</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#aa3172059e2e03b1af50180e3fd339450">lustre_swab_ldlm_res_id</a> (<span class="keyword">struct</span> <a class="code" href="structldlm__res__id.html">ldlm_res_id</a> *<span class="keywordtype">id</span>)
<a name="l02213"></a>02213 {
<a name="l02214"></a>02214         <span class="keywordtype">int</span>  i;
<a name="l02215"></a>02215 
<a name="l02216"></a>02216         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group__lustreidl.html#ga7ab749c7b5d3f9c9b007a9b64a42856c">RES_NAME_SIZE</a>; i++)
<a name="l02217"></a>02217                 <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;id-&gt;<a class="code" href="structldlm__res__id.html#a0348c56bc955cd6ad2f136605c1fcd4a">name</a>[i]);
<a name="l02218"></a>02218 }
<a name="l02219"></a>02219 
<a name="l02220"></a><a class="code" href="pack__generic_8c.html#afb7ffb5c88ea5a66315a9aee68ea1716">02220</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#afb7ffb5c88ea5a66315a9aee68ea1716">lustre_swab_ldlm_policy_data</a>(<span class="keyword">union</span> <a class="code" href="unionldlm__wire__policy__data.html">ldlm_wire_policy_data</a> *d)
<a name="l02221"></a>02221 {
<a name="l02222"></a>02222         <span class="comment">/* the lock data is a union and the first two fields are always an</span>
<a name="l02223"></a>02223 <span class="comment">         * extent so it&apos;s ok to process an LDLM_EXTENT and LDLM_FLOCK lock</span>
<a name="l02224"></a>02224 <span class="comment">         * data the same way. */</span>
<a name="l02225"></a>02225         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;d-&gt;<a class="code" href="unionldlm__wire__policy__data.html#a42662e613a5b12c12386661b519d0bba">l_extent</a>.<a class="code" href="structldlm__extent.html#af09bacd52ee801eb10e12807fc6ed5b7">start</a>);
<a name="l02226"></a>02226         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;d-&gt;<a class="code" href="unionldlm__wire__policy__data.html#a42662e613a5b12c12386661b519d0bba">l_extent</a>.<a class="code" href="structldlm__extent.html#a46a04a5a0a47f6e4b476bb37648c5ffc">end</a>);
<a name="l02227"></a>02227         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;d-&gt;<a class="code" href="unionldlm__wire__policy__data.html#a42662e613a5b12c12386661b519d0bba">l_extent</a>.<a class="code" href="structldlm__extent.html#a26ed2c10540083850c4075cd178ae1c5">gid</a>);
<a name="l02228"></a>02228         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;d-&gt;<a class="code" href="unionldlm__wire__policy__data.html#a81322bc0e3346c02e2a5057e83dac997">l_flock</a>.<a class="code" href="structldlm__flock__wire.html#a9565f85a0b1de63ff4388b86b5069b43">lfw_owner</a>);
<a name="l02229"></a>02229         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;d-&gt;<a class="code" href="unionldlm__wire__policy__data.html#a81322bc0e3346c02e2a5057e83dac997">l_flock</a>.<a class="code" href="structldlm__flock__wire.html#a1e8c8c5ac1f205d831e551344d5c7a2e">lfw_pid</a>);
<a name="l02230"></a>02230 }
<a name="l02231"></a>02231 
<a name="l02232"></a><a class="code" href="pack__generic_8c.html#abcfcd8c7af5613a747eaff5e7df6862e">02232</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#ac9b730eaa4f6d80282202eff268e6647">lustre_swab_ldlm_intent</a> (<span class="keyword">struct</span> <a class="code" href="structldlm__intent.html">ldlm_intent</a> *i)
<a name="l02233"></a>02233 {
<a name="l02234"></a>02234         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;i-&gt;<a class="code" href="structldlm__intent.html#a41b1682357cf32d469db0872570104ae">opc</a>);
<a name="l02235"></a>02235 }
<a name="l02236"></a>02236 
<a name="l02237"></a><a class="code" href="pack__generic_8c.html#ab0fa28123bfa3ef8c10c54944a97363c">02237</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#ab0fa28123bfa3ef8c10c54944a97363c">lustre_swab_ldlm_resource_desc</a>(<span class="keyword">struct</span> <a class="code" href="structldlm__resource__desc.html">ldlm_resource_desc</a> *r)
<a name="l02238"></a>02238 {
<a name="l02239"></a>02239         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;r-&gt;<a class="code" href="structldlm__resource__desc.html#a96dfe750266ccbd93bf0705e2fc3aa08">lr_type</a>);
<a name="l02240"></a>02240         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*r), lr_pad) != 0);
<a name="l02241"></a>02241         <a class="code" href="lustre__swab_8h.html#aa3172059e2e03b1af50180e3fd339450">lustre_swab_ldlm_res_id</a>(&amp;r-&gt;<a class="code" href="structldlm__resource__desc.html#a07dda1b3727078781399be820e092cb4">lr_name</a>);
<a name="l02242"></a>02242 }
<a name="l02243"></a>02243 
<a name="l02244"></a><a class="code" href="pack__generic_8c.html#a9f2538bb03c3185ee30fa9437318966b">02244</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#a9f2538bb03c3185ee30fa9437318966b">lustre_swab_ldlm_lock_desc</a> (<span class="keyword">struct</span> <a class="code" href="structldlm__lock__desc.html">ldlm_lock_desc</a> *l)
<a name="l02245"></a>02245 {
<a name="l02246"></a>02246         <a class="code" href="lustre__swab_8h.html#ab0fa28123bfa3ef8c10c54944a97363c">lustre_swab_ldlm_resource_desc</a> (&amp;l-&gt;<a class="code" href="structldlm__lock__desc.html#ab45b63e3702f60b662708279aed53e05">l_resource</a>);
<a name="l02247"></a>02247         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;l-&gt;<a class="code" href="structldlm__lock__desc.html#a39fa230b781404c56005f3f6aa79d6dc">l_req_mode</a>);
<a name="l02248"></a>02248         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;l-&gt;<a class="code" href="structldlm__lock__desc.html#a14a52fe2f2dc1dc3bba4e666de40fddb">l_granted_mode</a>);
<a name="l02249"></a>02249         <a class="code" href="lustre__swab_8h.html#afb7ffb5c88ea5a66315a9aee68ea1716">lustre_swab_ldlm_policy_data</a> (&amp;l-&gt;<a class="code" href="structldlm__lock__desc.html#ae8a9e021dca78428840dc492e9047ec3">l_policy_data</a>);
<a name="l02250"></a>02250 }
<a name="l02251"></a>02251 
<a name="l02252"></a><a class="code" href="pack__generic_8c.html#a0f8f64552d2440750aa71bec0cf32788">02252</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a259b5e2307806f9014711df26aa6ba38">lustre_swab_ldlm_request</a> (<span class="keyword">struct</span> <a class="code" href="structldlm__request.html">ldlm_request</a> *rq)
<a name="l02253"></a>02253 {
<a name="l02254"></a>02254         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;rq-&gt;<a class="code" href="structldlm__request.html#a382cbc1162f0be77ccca5cbdd3a50dcc">lock_flags</a>);
<a name="l02255"></a>02255         <a class="code" href="lustre__swab_8h.html#a9f2538bb03c3185ee30fa9437318966b">lustre_swab_ldlm_lock_desc</a> (&amp;rq-&gt;<a class="code" href="structldlm__request.html#af1937d4ef40e793629fc1f28225e77b2">lock_desc</a>);
<a name="l02256"></a>02256         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;rq-&gt;<a class="code" href="structldlm__request.html#a7de36ab10679c38518c469d3c1fcdae1">lock_count</a>);
<a name="l02257"></a>02257         <span class="comment">/* lock_handle[] opaque */</span>
<a name="l02258"></a>02258 }
<a name="l02259"></a>02259 
<a name="l02260"></a><a class="code" href="pack__generic_8c.html#a30a21f536e81d88a650f986fbe579061">02260</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a986ecb07eaf0fdaa4d7127880ecb1b60">lustre_swab_ldlm_reply</a> (<span class="keyword">struct</span> <a class="code" href="structldlm__reply.html">ldlm_reply</a> *r)
<a name="l02261"></a>02261 {
<a name="l02262"></a>02262         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;r-&gt;<a class="code" href="structldlm__reply.html#a44a8fec4dcf5e9d98e6264f8d90034e6">lock_flags</a>);
<a name="l02263"></a>02263         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*r), lock_padding) != 0);
<a name="l02264"></a>02264         <a class="code" href="lustre__swab_8h.html#a9f2538bb03c3185ee30fa9437318966b">lustre_swab_ldlm_lock_desc</a> (&amp;r-&gt;<a class="code" href="structldlm__reply.html#a88f4e75680bfeadb157efd2c34a0f2d9">lock_desc</a>);
<a name="l02265"></a>02265         <span class="comment">/* lock_handle opaque */</span>
<a name="l02266"></a>02266         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;r-&gt;<a class="code" href="structldlm__reply.html#ab658a9237128f1196e3913df41eff3be">lock_policy_res1</a>);
<a name="l02267"></a>02267         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;r-&gt;<a class="code" href="structldlm__reply.html#a9842c6c8c2c13c68c23f4779a40685a2">lock_policy_res2</a>);
<a name="l02268"></a>02268 }
<a name="l02269"></a>02269 
<a name="l02270"></a><a class="code" href="pack__generic_8c.html#aae9666b8772b4a45e744a0f7b95fde09">02270</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a833d9209041487e8f2f2eb7eb1dbaeb8">lustre_swab_quota_body</a>(<span class="keyword">struct</span> <a class="code" href="structquota__body.html">quota_body</a> *b)
<a name="l02271"></a>02271 {
<a name="l02272"></a>02272         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;b-&gt;<a class="code" href="structquota__body.html#a80a62de873e93ccf9899986d89c5e48d">qb_fid</a>);
<a name="l02273"></a>02273         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>((<span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *)&amp;b-&gt;<a class="code" href="structquota__body.html#ab7fb0e454a05c4ca50b13b9433a9af49">qb_id</a>);
<a name="l02274"></a>02274         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;b-&gt;<a class="code" href="structquota__body.html#a1c73aa0dbd67cfd9d59c39050e1ad3bb">qb_flags</a>);
<a name="l02275"></a>02275         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;b-&gt;<a class="code" href="structquota__body.html#a0b1dcb900617e5812a99e8a31958fed7">qb_count</a>);
<a name="l02276"></a>02276         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;b-&gt;<a class="code" href="structquota__body.html#a6682a7ba30e177021cd623646a1715c3">qb_usage</a>);
<a name="l02277"></a>02277         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;b-&gt;<a class="code" href="structquota__body.html#aaa435fcbd9e7bfdf1d0db14ada29f366">qb_slv_ver</a>);
<a name="l02278"></a>02278 }
<a name="l02279"></a>02279 
<a name="l02280"></a>02280 <span class="comment">/* Dump functions */</span>
<a name="l02281"></a><a class="code" href="group__lustreidl.html#ga885338308dbd6c3105897ab09d4868bf">02281</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a8c0437b7267426bcf227ee0e5605bf4d">dump_ioo</a>(<span class="keyword">struct</span> <a class="code" href="structobd__ioobj.html">obd_ioobj</a> *ioo)
<a name="l02282"></a>02282 {
<a name="l02283"></a>02283         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>,
<a name="l02284"></a>02284                <span class="stringliteral">&quot;obd_ioobj: ioo_oid=&quot;</span><a class="code" href="group__lustreuser.html#gac64b04c9d195f0918fc22b881d2260e5">DOSTID</a><span class="stringliteral">&quot;, ioo_max_brw=%#x, &quot;</span>
<a name="l02285"></a>02285                <span class="stringliteral">&quot;ioo_bufct=%d\n&quot;</span>, <a class="code" href="group__lustreuser.html#gad3b44cf710fe39c4adc4ae65a2a98543">POSTID</a>(&amp;ioo-&gt;<a class="code" href="structobd__ioobj.html#aa48d826cec9e602ae5f62cd026c489d2">ioo_oid</a>), ioo-&gt;<a class="code" href="structobd__ioobj.html#a5406884eaae32b0a6c335e2e8bc40605">ioo_max_brw</a>,
<a name="l02286"></a>02286                ioo-&gt;<a class="code" href="structobd__ioobj.html#acc084a016e4057c2b4e4ba299f940aae">ioo_bufcnt</a>);
<a name="l02287"></a>02287 }
<a name="l02288"></a>02288 
<a name="l02289"></a><a class="code" href="group__lustreidl.html#gadfa9effc4d4d837706a057dbee2048bb">02289</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a6b871efa5322438f31eb38527ff4488c">dump_rniobuf</a>(<span class="keyword">struct</span> <a class="code" href="structniobuf__remote.html">niobuf_remote</a> *nb)
<a name="l02290"></a>02290 {
<a name="l02291"></a>02291         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;niobuf_remote: offset=&quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a5ef11521803262dc2f972061520e41f2">LPU64</a><span class="stringliteral">&quot;, len=%d, flags=%x\n&quot;</span>,
<a name="l02292"></a>02292                nb-&gt;<a class="code" href="structniobuf__remote.html#af3d2780ccf8895eab786247d4f69418f">rnb_offset</a>, nb-&gt;<a class="code" href="structniobuf__remote.html#aa99016bb10a3ca18e16121bd181770fe">rnb_len</a>, nb-&gt;<a class="code" href="structniobuf__remote.html#aa9a6fcbad64c4395cc6d95bee4bb9f8a">rnb_flags</a>);
<a name="l02293"></a>02293 }
<a name="l02294"></a>02294 
<a name="l02295"></a><a class="code" href="pack__generic_8c.html#abf3f7ddbceb5e8ff2db804d339eff8f5">02295</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a71e10c68fc87fb53e26cc81c054c7796">dump_obdo</a>(<span class="keyword">struct</span> <a class="code" href="structobdo.html">obdo</a> *oa)
<a name="l02296"></a>02296 {
<a name="l02297"></a>02297         u64 valid = oa-&gt;<a class="code" href="structobdo.html#a0602c2272bf3c8483593a6c0bf01a66e">o_valid</a>;
<a name="l02298"></a>02298 
<a name="l02299"></a>02299         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_valid = &quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#abd4b7b7675c19f574aa3c3cd3a7f770f">LPX64</a><span class="stringliteral">&quot;\n&quot;</span>, valid);
<a name="l02300"></a>02300         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga2e8f30d9b26c4985fd2fb686cabaa1b6">OBD_MD_FLID</a>)
<a name="l02301"></a>02301                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: id = &quot;</span><a class="code" href="group__lustreuser.html#gac64b04c9d195f0918fc22b881d2260e5">DOSTID</a><span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="group__lustreuser.html#gad3b44cf710fe39c4adc4ae65a2a98543">POSTID</a>(&amp;oa-&gt;<a class="code" href="structobdo.html#a0153b0c6b62ca1ecd1edf36546385cbf">o_oi</a>));
<a name="l02302"></a>02302         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga9e1f3283939c1689d17be2824e262c8a">OBD_MD_FLFID</a>)
<a name="l02303"></a>02303                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_parent_seq = &quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#abd4b7b7675c19f574aa3c3cd3a7f770f">LPX64</a><span class="stringliteral">&quot;\n&quot;</span>,
<a name="l02304"></a>02304                        oa-&gt;<a class="code" href="structobdo.html#a957449d80d20b11aaaf945f1addc99b6">o_parent_seq</a>);
<a name="l02305"></a>02305         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga1dd583375ea509f04945ef68fbcb46e8">OBD_MD_FLSIZE</a>)
<a name="l02306"></a>02306                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_size = &quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a414a71ca04d1db8d7875631cf51d45bf">LPD64</a><span class="stringliteral">&quot;\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#abbfa08bf1585f3d5b7a054c55bb1335f">o_size</a>);
<a name="l02307"></a>02307         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga9821990b5b356600bc6c27b9c6ee99b7">OBD_MD_FLMTIME</a>)
<a name="l02308"></a>02308                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_mtime = &quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a414a71ca04d1db8d7875631cf51d45bf">LPD64</a><span class="stringliteral">&quot;\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#a33faaf06b017327f72b23b597311baef">o_mtime</a>);
<a name="l02309"></a>02309         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga16c7309c5c639a04e530c54874dc2d17">OBD_MD_FLATIME</a>)
<a name="l02310"></a>02310                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_atime = &quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a414a71ca04d1db8d7875631cf51d45bf">LPD64</a><span class="stringliteral">&quot;\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#a6b6b9d4b05c515a36d9d6a682d13148c">o_atime</a>);
<a name="l02311"></a>02311         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga766c92a3dc8cd7907c01c9605593a38a">OBD_MD_FLCTIME</a>)
<a name="l02312"></a>02312                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_ctime = &quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a414a71ca04d1db8d7875631cf51d45bf">LPD64</a><span class="stringliteral">&quot;\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#a2a15d5de3521a888575545a2f0453d61">o_ctime</a>);
<a name="l02313"></a>02313         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga855af6035d66c69ff392f2f25efcf6bb">OBD_MD_FLBLOCKS</a>)   <span class="comment">/* allocation of space */</span>
<a name="l02314"></a>02314                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_blocks = &quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a414a71ca04d1db8d7875631cf51d45bf">LPD64</a><span class="stringliteral">&quot;\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#ab78543505ca489f2c0370660908ba6f5">o_blocks</a>);
<a name="l02315"></a>02315         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga5acd524f7c56dec4c715418b9cf51c1b">OBD_MD_FLGRANT</a>)
<a name="l02316"></a>02316                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_grant = &quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a414a71ca04d1db8d7875631cf51d45bf">LPD64</a><span class="stringliteral">&quot;\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#a9f775f3fda1cecfaab285a50b8eff864">o_grant</a>);
<a name="l02317"></a>02317         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga0e836c19bb20865ba94baba369be188c">OBD_MD_FLBLKSZ</a>)
<a name="l02318"></a>02318                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_blksize = %d\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#ab59a5b464e93a3400197a1aee5eca54a">o_blksize</a>);
<a name="l02319"></a>02319         <span class="keywordflow">if</span> (valid &amp; (<a class="code" href="group__lustreidl.html#ga2e19bb58077cca13212ca78a6b355363">OBD_MD_FLTYPE</a> | <a class="code" href="group__lustreidl.html#gaca15d069858d54a300fba1bb6ac56f22">OBD_MD_FLMODE</a>))
<a name="l02320"></a>02320                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_mode = %o\n&quot;</span>,
<a name="l02321"></a>02321                        oa-&gt;<a class="code" href="structobdo.html#a03cb35c43b98e76b9e9b3502f5d69430">o_mode</a> &amp; ((valid &amp; <a class="code" href="group__lustreidl.html#ga2e19bb58077cca13212ca78a6b355363">OBD_MD_FLTYPE</a> ?  S_IFMT : 0) |
<a name="l02322"></a>02322                                      (valid &amp; <a class="code" href="group__lustreidl.html#gaca15d069858d54a300fba1bb6ac56f22">OBD_MD_FLMODE</a> ? ~S_IFMT : 0)));
<a name="l02323"></a>02323         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga80680d36ac760d896540bfd9291b2a80">OBD_MD_FLUID</a>)
<a name="l02324"></a>02324                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_uid = %u\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#a3b458b58ea7917e722ce30a48036d5b5">o_uid</a>);
<a name="l02325"></a>02325         <span class="keywordflow">if</span> (valid &amp; OBD_MD_FLUID)
<a name="l02326"></a>02326                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_uid_h = %u\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#a82dc811da3c620dbd4abab82c34cc16c">o_uid_h</a>);
<a name="l02327"></a>02327         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga2dc4d52439af7e068c1c6b150821e66c">OBD_MD_FLGID</a>)
<a name="l02328"></a>02328                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_gid = %u\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#aa5e64f099438620d92d234c058c8826f">o_gid</a>);
<a name="l02329"></a>02329         <span class="keywordflow">if</span> (valid &amp; OBD_MD_FLGID)
<a name="l02330"></a>02330                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_gid_h = %u\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#a0d999b15f3a8ce5c6fea3b598d1d69b0">o_gid_h</a>);
<a name="l02331"></a>02331         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga4a3edb54367cb7a576d55e717d11d569">OBD_MD_FLFLAGS</a>)
<a name="l02332"></a>02332                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_flags = %x\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#a3e52c30c4c312d5175be8f1964a9ba08">o_flags</a>);
<a name="l02333"></a>02333         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#gae64278d2583eb9547a14eb915347ce22">OBD_MD_FLNLINK</a>)
<a name="l02334"></a>02334                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_nlink = %u\n&quot;</span>, oa-&gt;<a class="code" href="structobdo.html#af09447b7e89729811173025afaa90e05">o_nlink</a>);
<a name="l02335"></a>02335         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#gac9c4291663ad6019ca07d368e6d1637b">OBD_MD_FLCKSUM</a>)
<a name="l02336"></a>02336                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_checksum (o_nlink) = %u\n&quot;</span>,
<a name="l02337"></a>02337                        oa-&gt;<a class="code" href="structobdo.html#af09447b7e89729811173025afaa90e05">o_nlink</a>);
<a name="l02338"></a>02338         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga586968eb6f1213407a2e1552f1fa8e5e">OBD_MD_FLGENER</a>)
<a name="l02339"></a>02339                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_parent_oid = %x\n&quot;</span>,
<a name="l02340"></a>02340                        oa-&gt;<a class="code" href="structobdo.html#a3f352005b700bc38caecbced7882550f">o_parent_oid</a>);
<a name="l02341"></a>02341         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#ga18e4e2b1736b078b6b929ad4cc764e57">OBD_MD_FLEPOCH</a>)
<a name="l02342"></a>02342                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_ioepoch = &quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a414a71ca04d1db8d7875631cf51d45bf">LPD64</a><span class="stringliteral">&quot;\n&quot;</span>,
<a name="l02343"></a>02343                        oa-&gt;<a class="code" href="structobdo.html#a85c2eabb19225287e404c2b3b39c3163">o_ioepoch</a>);
<a name="l02344"></a>02344         <span class="keywordflow">if</span> (valid &amp; OBD_MD_FLFID) {
<a name="l02345"></a>02345                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_stripe_idx = %u\n&quot;</span>,
<a name="l02346"></a>02346                        oa-&gt;<a class="code" href="structobdo.html#a98c16dc63976028a2bf826dc12beb66c">o_stripe_idx</a>);
<a name="l02347"></a>02347                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_parent_ver = %x\n&quot;</span>,
<a name="l02348"></a>02348                        oa-&gt;<a class="code" href="structobdo.html#a7db267735d5a4c68a73723a1e3c90484">o_parent_ver</a>);
<a name="l02349"></a>02349         }
<a name="l02350"></a>02350         <span class="keywordflow">if</span> (valid &amp; <a class="code" href="group__lustreidl.html#gaf2a9ddc93e62b79d118dcb7cf2d40299">OBD_MD_FLHANDLE</a>)
<a name="l02351"></a>02351                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;obdo: o_handle = &quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a414a71ca04d1db8d7875631cf51d45bf">LPD64</a><span class="stringliteral">&quot;\n&quot;</span>,
<a name="l02352"></a>02352                        oa-&gt;<a class="code" href="structobdo.html#a3c26ccfc9f699c6c7ee324da726c39ca">o_handle</a>.<a class="code" href="structlustre__handle.html#a735d65d1a27d9cafdc17245e4574000a">cookie</a>);
<a name="l02353"></a>02353 }
<a name="l02354"></a>02354 
<a name="l02355"></a><a class="code" href="group__lustreidl.html#ga33b0e57346be881d96176f71c7b2b84f">02355</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#ae9f0e3182a388bc197c5a4d85777b696">dump_ost_body</a>(<span class="keyword">struct</span> <a class="code" href="structost__body.html">ost_body</a> *ob)
<a name="l02356"></a>02356 {
<a name="l02357"></a>02357         <a class="code" href="req-layout_8c.html#a71e10c68fc87fb53e26cc81c054c7796">dump_obdo</a>(&amp;ob-&gt;<a class="code" href="structost__body.html#a347fc2eca12ad6c8f029bcd0eac8ac64">oa</a>);
<a name="l02358"></a>02358 }
<a name="l02359"></a>02359 
<a name="l02360"></a><a class="code" href="group__lustreidl.html#ga5087bd7712a16329ec70794441261705">02360</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#aeed3357e382b86196bcf46311ddf80bc">dump_rcs</a>(__u32 *rc)
<a name="l02361"></a>02361 {
<a name="l02362"></a>02362         <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#aed4daa7096c3237824e93375e1473af7">D_RPCTRACE</a>, <span class="stringliteral">&quot;rmf_rcs: %d\n&quot;</span>, *rc);
<a name="l02363"></a>02363 }
<a name="l02364"></a>02364 
<a name="l02365"></a><a class="code" href="pack__generic_8c.html#a5e0886cd72be1edfeff35c67baa15f03">02365</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="pack__generic_8c.html#a5e0886cd72be1edfeff35c67baa15f03">req_ptlrpc_body_swabbed</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req)
<a name="l02366"></a>02366 {
<a name="l02367"></a>02367         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>);
<a name="l02368"></a>02368 
<a name="l02369"></a>02369         <span class="keywordflow">switch</span> (req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_magic) {
<a name="l02370"></a>02370         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l02371"></a>02371                 <span class="keywordflow">return</span> <a class="code" href="group__net.html#ga97210df2b7b859cbbab53473e6cfec93" title="Returns 1 if request buffer at offset index was already swabbed.">lustre_req_swabbed</a>(req, <a class="code" href="group__lustreidl.html#gad7ddfc6368a84f8cf442c0d4aabcbdc8">MSG_PTLRPC_BODY_OFF</a>);
<a name="l02372"></a>02372         <span class="keywordflow">default</span>:
<a name="l02373"></a>02373                 <a class="code" href="libcfs__debug_8h.html#ad06acc43c8c74fb94f76adde491a72ac">CERROR</a>(<span class="stringliteral">&quot;bad lustre msg magic: %#08X\n&quot;</span>,
<a name="l02374"></a>02374                        req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>-&gt;lm_magic);
<a name="l02375"></a>02375         }
<a name="l02376"></a>02376         <span class="keywordflow">return</span> 0;
<a name="l02377"></a>02377 }
<a name="l02378"></a>02378 
<a name="l02379"></a><a class="code" href="pack__generic_8c.html#ac6569a6b3e1401b961a974d18dc348ba">02379</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="pack__generic_8c.html#ac6569a6b3e1401b961a974d18dc348ba">rep_ptlrpc_body_swabbed</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req)
<a name="l02380"></a>02380 {
<a name="l02381"></a>02381         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a0c10a934ec07154a75ee696126876f3e" title="Reply message - server response.">rq_repmsg</a>);
<a name="l02382"></a>02382 
<a name="l02383"></a>02383         <span class="keywordflow">switch</span> (req-&gt;<a class="code" href="structptlrpc__request.html#a0c10a934ec07154a75ee696126876f3e" title="Reply message - server response.">rq_repmsg</a>-&gt;lm_magic) {
<a name="l02384"></a>02384         <span class="keywordflow">case</span> <a class="code" href="packet-lustre_8c.html#a745c3076b2fe6f786cd50e65d37fcf3d">LUSTRE_MSG_MAGIC_V2</a>:
<a name="l02385"></a>02385                 <span class="keywordflow">return</span> <a class="code" href="group__net.html#ga5f979a04012e6bbb25233e7580676f92" title="Returns 1 if request reply buffer at offset index was already swabbed.">lustre_rep_swabbed</a>(req, <a class="code" href="group__lustreidl.html#gad7ddfc6368a84f8cf442c0d4aabcbdc8">MSG_PTLRPC_BODY_OFF</a>);
<a name="l02386"></a>02386         <span class="keywordflow">default</span>:
<a name="l02387"></a>02387                 <span class="comment">/* uninitialized yet */</span>
<a name="l02388"></a>02388                 <span class="keywordflow">return</span> 0;
<a name="l02389"></a>02389         }
<a name="l02390"></a>02390 }
<a name="l02391"></a>02391 
<a name="l02392"></a><a class="code" href="pack__generic_8c.html#a24c29860fd6198e01438ca7844dea264">02392</a> <span class="keywordtype">void</span> <a class="code" href="group__net.html#gaa7acffec98d1468d2ef76654aaccade4">_debug_req</a>(<span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req,
<a name="l02393"></a>02393                 <span class="keyword">struct</span> <a class="code" href="structlibcfs__debug__msg__data.html">libcfs_debug_msg_data</a> *msgdata,
<a name="l02394"></a>02394                 <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ... )
<a name="l02395"></a>02395 {
<a name="l02396"></a>02396         <span class="keywordtype">int</span> req_ok = req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a> != NULL;
<a name="l02397"></a>02397         <span class="keywordtype">int</span> rep_ok = req-&gt;<a class="code" href="structptlrpc__request.html#a0c10a934ec07154a75ee696126876f3e" title="Reply message - server response.">rq_repmsg</a> != NULL;
<a name="l02398"></a>02398         <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> nid = <a class="code" href="group__lnet__addr.html#gaf07699e7475f5357f581c00afeaaa1d7" title="wildcard NID that matches any end-point address">LNET_NID_ANY</a>;
<a name="l02399"></a>02399         va_list args;
<a name="l02400"></a>02400 
<a name="l02401"></a>02401         <span class="keywordflow">if</span> (<a class="code" href="group__net.html#ga63e57d4ee82cc1841fd1206a8aa2c911" title="Returns 1 if request needs to be swabbed into local cpu byteorder.">ptlrpc_req_need_swab</a>(req)) {
<a name="l02402"></a>02402                 req_ok = req_ok &amp;&amp; <a class="code" href="pack__generic_8c.html#a5e0886cd72be1edfeff35c67baa15f03">req_ptlrpc_body_swabbed</a>(req);
<a name="l02403"></a>02403                 rep_ok = rep_ok &amp;&amp; <a class="code" href="pack__generic_8c.html#ac6569a6b3e1401b961a974d18dc348ba">rep_ptlrpc_body_swabbed</a>(req);
<a name="l02404"></a>02404         }
<a name="l02405"></a>02405 
<a name="l02406"></a>02406         <span class="keywordflow">if</span> (req-&gt;<a class="code" href="structptlrpc__request.html#abce7bb8e7fff373286d1f69a0175dba8" title="import where request is being sent">rq_import</a> &amp;&amp; req-&gt;<a class="code" href="structptlrpc__request.html#abce7bb8e7fff373286d1f69a0175dba8" title="import where request is being sent">rq_import</a>-&gt;<a class="code" href="structobd__import.html#af8d2d08c0e13cf532ff05d8fddccb16e" title="Currently active connection.">imp_connection</a>)
<a name="l02407"></a>02407                 nid = req-&gt;<a class="code" href="structptlrpc__request.html#abce7bb8e7fff373286d1f69a0175dba8" title="import where request is being sent">rq_import</a>-&gt;<a class="code" href="structobd__import.html#af8d2d08c0e13cf532ff05d8fddccb16e" title="Currently active connection.">imp_connection</a>-&gt;<a class="code" href="structptlrpc__connection.html#a71fe23e65708fa8d286db348d2bdf249" title="Remote side nid for this connection.">c_peer</a>.<a class="code" href="structlnet__process__id__t.html#ab0c421c9d4e55b3a45fa62100f20687d" title="node id">nid</a>;
<a name="l02408"></a>02408         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (req-&gt;<a class="code" href="structptlrpc__request.html#ac7af87194ec26c0e6646bdfaa943b17d" title="Server-side, export on which request was received.">rq_export</a> &amp;&amp; req-&gt;<a class="code" href="structptlrpc__request.html#ac7af87194ec26c0e6646bdfaa943b17d" title="Server-side, export on which request was received.">rq_export</a>-&gt;<a class="code" href="structobd__export.html#ae0ed47ab09f5904f1b740d33bd2f27ef" title="Active connetion.">exp_connection</a>)
<a name="l02409"></a>02409                 nid = req-&gt;<a class="code" href="structptlrpc__request.html#ac7af87194ec26c0e6646bdfaa943b17d" title="Server-side, export on which request was received.">rq_export</a>-&gt;<a class="code" href="structobd__export.html#ae0ed47ab09f5904f1b740d33bd2f27ef" title="Active connetion.">exp_connection</a>-&gt;<a class="code" href="structptlrpc__connection.html#a71fe23e65708fa8d286db348d2bdf249" title="Remote side nid for this connection.">c_peer</a>.<a class="code" href="structlnet__process__id__t.html#ab0c421c9d4e55b3a45fa62100f20687d" title="node id">nid</a>;
<a name="l02410"></a>02410 
<a name="l02411"></a>02411         va_start(args, fmt);
<a name="l02412"></a>02412         <a class="code" href="libcfs__debug_8h.html#a8877fb34a6211d9fb620a7a35d97468c">libcfs_debug_vmsg2</a>(msgdata, fmt, args,
<a name="l02413"></a>02413                            <span class="stringliteral">&quot; req@%p x&quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a5ef11521803262dc2f972061520e41f2">LPU64</a><span class="stringliteral">&quot;/t&quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a414a71ca04d1db8d7875631cf51d45bf">LPD64</a><span class="stringliteral">&quot;(&quot;</span><a class="code" href="libcfs_2include_2libcfs_2types_8h.html#a414a71ca04d1db8d7875631cf51d45bf">LPD64</a><span class="stringliteral">&quot;) o%d-&gt;%s@%s:%d/%d&quot;</span>
<a name="l02414"></a>02414                            <span class="stringliteral">&quot; lens %d/%d e %d to %d dl &quot;</span><a class="code" href="linux-time_8h.html#aa7b76e99c79db328bd5ca8f4e5f32d95">CFS_TIME_T</a><span class="stringliteral">&quot; ref %d &quot;</span>
<a name="l02415"></a>02415                            <span class="stringliteral">&quot;fl &quot;</span><a class="code" href="group__net.html#ga032f24555e4e11c57c079292ce89699a">REQ_FLAGS_FMT</a><span class="stringliteral">&quot;/%x/%x rc %d/%d\n&quot;</span>,
<a name="l02416"></a>02416                            req, req-&gt;<a class="code" href="structptlrpc__request.html#ab88b3c4dc962d237d5642e0808d323b2" title="xid">rq_xid</a>, req-&gt;<a class="code" href="structptlrpc__request.html#ab4228f142360486f518cebde2614dafd" title="Transaction number.">rq_transno</a>,
<a name="l02417"></a>02417                            req_ok ? <a class="code" href="group__net.html#ga9bedef213e170e969899bfab36bb8fb0">lustre_msg_get_transno</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>) : 0,
<a name="l02418"></a>02418                            req_ok ? <a class="code" href="group__net.html#ga5889b19f527897c102df244998c9de02">lustre_msg_get_opc</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>) : -1,
<a name="l02419"></a>02419                            req-&gt;<a class="code" href="structptlrpc__request.html#abce7bb8e7fff373286d1f69a0175dba8" title="import where request is being sent">rq_import</a> ?
<a name="l02420"></a>02420                                 req-&gt;<a class="code" href="structptlrpc__request.html#abce7bb8e7fff373286d1f69a0175dba8" title="import where request is being sent">rq_import</a>-&gt;<a class="code" href="structobd__import.html#a8f00f6e006a7f308a71654b3e067a4af" title="obd device for this import">imp_obd</a>-&gt;<a class="code" href="structobd__device.html#a47f3a5a4e3b9ce7d39282c2aa1058985">obd_name</a> :
<a name="l02421"></a>02421                                 req-&gt;<a class="code" href="structptlrpc__request.html#ac7af87194ec26c0e6646bdfaa943b17d" title="Server-side, export on which request was received.">rq_export</a> ?
<a name="l02422"></a>02422                                         req-&gt;<a class="code" href="structptlrpc__request.html#ac7af87194ec26c0e6646bdfaa943b17d" title="Server-side, export on which request was received.">rq_export</a>-&gt;<a class="code" href="structobd__export.html#add66633855471a2f937a811ce353b5ca" title="Lock references.">exp_client_uuid</a>.<a class="code" href="structobd__uuid.html#aa6cced3e76a3656e5152bb9ed249e7a1">uuid</a> :
<a name="l02423"></a>02423                                         <span class="stringliteral">&quot;&lt;?&gt;&quot;</span>,
<a name="l02424"></a>02424                            <a class="code" href="nidstr_8h.html#ada87bd30bf737eb0f07cd208ba08d73d">libcfs_nid2str</a>(nid),
<a name="l02425"></a>02425                            req-&gt;rq_request_portal, req-&gt;rq_reply_portal,
<a name="l02426"></a>02426                            req-&gt;<a class="code" href="structptlrpc__request.html#a9746010150c167d5b6e62786d61f18df" title="Request length.">rq_reqlen</a>, req-&gt;<a class="code" href="structptlrpc__request.html#aaa9ba7e7b71ad2057d1650469ab15076" title="Reply length.">rq_replen</a>,
<a name="l02427"></a>02427                            req-&gt;<a class="code" href="structptlrpc__request.html#a4107706ff91738c79e18c271469afe8d" title="how many early replies (for stats)">rq_early_count</a>, req-&gt;<a class="code" href="structptlrpc__request.html#a0833c1d319eaa92c6b38a81277e71df6">rq_timedout</a>,
<a name="l02428"></a>02428                            req-&gt;<a class="code" href="structptlrpc__request.html#ab29afa9e8660c959a61d6f4b86777844" title="when request must finish.">rq_deadline</a>,
<a name="l02429"></a>02429                            atomic_read(&amp;req-&gt;<a class="code" href="structptlrpc__request.html#a766b89c8d0bab9b1751bd3725ae605df" title="client-side refcount for SENT race, server-side refcounf for multiple replies">rq_refcount</a>),
<a name="l02430"></a>02430                            <a class="code" href="group__net.html#gaf155302427c8b1196ede7e7cd7e7d133" title="Convert bit flags into a string.">DEBUG_REQ_FLAGS</a>(req),
<a name="l02431"></a>02431                            req_ok ? <a class="code" href="group__net.html#ga7039633508af55679f204cff967f1879">lustre_msg_get_flags</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a98c2879f06b955c80000e8c1776373f7" title="Request message - what client sent.">rq_reqmsg</a>) : -1,
<a name="l02432"></a>02432                            rep_ok ? <a class="code" href="group__net.html#ga7039633508af55679f204cff967f1879">lustre_msg_get_flags</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a0c10a934ec07154a75ee696126876f3e" title="Reply message - server response.">rq_repmsg</a>) : -1,
<a name="l02433"></a>02433                            req-&gt;<a class="code" href="structptlrpc__request.html#a275fd3eef6c30a8d9d65379aa94b6b2d" title="Result of request processing.">rq_status</a>,
<a name="l02434"></a>02434                            rep_ok ? <a class="code" href="group__net.html#gaaa6ef42a52d75cf87cb0b7834606093b">lustre_msg_get_status</a>(req-&gt;<a class="code" href="structptlrpc__request.html#a0c10a934ec07154a75ee696126876f3e" title="Reply message - server response.">rq_repmsg</a>) : -1);
<a name="l02435"></a>02435         va_end(args);
<a name="l02436"></a>02436 }
<a name="l02437"></a>02437 EXPORT_SYMBOL(<a class="code" href="group__net.html#gaa7acffec98d1468d2ef76654aaccade4">_debug_req</a>);
<a name="l02438"></a>02438 
<a name="l02439"></a><a class="code" href="pack__generic_8c.html#a80bf76089dd805c709a3a7844d8c4cb3">02439</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#ad8d8652a7e3caf96fddbceadfadbca71">lustre_swab_lustre_capa</a>(<span class="keyword">struct</span> <a class="code" href="structlustre__capa.html">lustre_capa</a> *c)
<a name="l02440"></a>02440 {
<a name="l02441"></a>02441         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;c-&gt;<a class="code" href="structlustre__capa.html#a2c3654dfc95f15995512e0ac53c07fb1">lc_fid</a>);
<a name="l02442"></a>02442         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;c-&gt;<a class="code" href="structlustre__capa.html#a3c8a934723757fdff76cbdcf57e98081" title="fid">lc_opc</a>);
<a name="l02443"></a>02443         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;c-&gt;<a class="code" href="structlustre__capa.html#ad23343416034ff9d6c87470b735e885f" title="operations allowed">lc_uid</a>);
<a name="l02444"></a>02444         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;c-&gt;<a class="code" href="structlustre__capa.html#aab30292d592a4457f0265d835cb9947a" title="file owner">lc_gid</a>);
<a name="l02445"></a>02445         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;c-&gt;<a class="code" href="structlustre__capa.html#ae8ce626abaa10c91db7d97364cc4120c" title="file group">lc_flags</a>);
<a name="l02446"></a>02446         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;c-&gt;<a class="code" href="structlustre__capa.html#abdbc84a651e041754fb3d482b0454c46" title="HMAC algorithm &amp;amp; flags.">lc_keyid</a>);
<a name="l02447"></a>02447         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;c-&gt;<a class="code" href="structlustre__capa.html#aefe24f64adc6af336c8b5e1381d74893" title="key# used for the capability">lc_timeout</a>);
<a name="l02448"></a>02448         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;c-&gt;<a class="code" href="structlustre__capa.html#a4dbc96478c2d7bcc08f948540811e5c4" title="capa timeout value (sec)">lc_expiry</a>);
<a name="l02449"></a>02449 }
<a name="l02450"></a>02450 
<a name="l02451"></a><a class="code" href="pack__generic_8c.html#ab01c91a90e16e06e70ab8b7d5318d8fc">02451</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a70e0020da06babf62fc0012a1243b8cb">lustre_swab_lustre_capa_key</a>(<span class="keyword">struct</span> <a class="code" href="structlustre__capa__key.html">lustre_capa_key</a> *k)
<a name="l02452"></a>02452 {
<a name="l02453"></a>02453         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a> (&amp;k-&gt;<a class="code" href="structlustre__capa__key.html#a66b2a9f0deeb906d774b4fdc187cc75e" title="mds#">lk_seq</a>);
<a name="l02454"></a>02454         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a> (&amp;k-&gt;<a class="code" href="structlustre__capa__key.html#a5e0170a1da4e009e6962d65836f5ec53" title="key#">lk_keyid</a>);
<a name="l02455"></a>02455         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*k), lk_padding) != 0);
<a name="l02456"></a>02456 }
<a name="l02457"></a>02457 
<a name="l02458"></a><a class="code" href="pack__generic_8c.html#aafeb3dc681ecd3dbca151f59faa39d8f">02458</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#acbb150c4dbd942f6ad9ff58b83fd8063">lustre_swab_hsm_user_state</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__user__state.html" title="Current HSM states of a Lustre file.">hsm_user_state</a> *<a class="code" href="fsx_8c.html#a5797ba50831ee71f60588abd75d2992e">state</a>)
<a name="l02459"></a>02459 {
<a name="l02460"></a>02460         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;state-&gt;<a class="code" href="structhsm__user__state.html#af9ec50adb78815c43889187b1c0944d4" title="Current HSM states, from enum hsm_states.">hus_states</a>);
<a name="l02461"></a>02461         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;state-&gt;<a class="code" href="structhsm__user__state.html#a199a27793237977ea65c70dd0a8dbc4e">hus_archive_id</a>);
<a name="l02462"></a>02462 }
<a name="l02463"></a>02463 
<a name="l02464"></a><a class="code" href="pack__generic_8c.html#a2ef3475f0adc09e956bc0d14efae0472">02464</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#ae938417332fd2e5a1d4b594052b0b2b8">lustre_swab_hsm_state_set</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__state__set.html">hsm_state_set</a> *hss)
<a name="l02465"></a>02465 {
<a name="l02466"></a>02466         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;hss-&gt;<a class="code" href="structhsm__state__set.html#ad4cb9fa809ce8eaa400880e918367c45">hss_valid</a>);
<a name="l02467"></a>02467         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;hss-&gt;<a class="code" href="structhsm__state__set.html#aa90d5b674d42639f71b19ec49c61078d">hss_setmask</a>);
<a name="l02468"></a>02468         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;hss-&gt;<a class="code" href="structhsm__state__set.html#a494dd19881d8e68f8acc8999ecefa04d">hss_clearmask</a>);
<a name="l02469"></a>02469         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;hss-&gt;<a class="code" href="structhsm__state__set.html#a0442a3c49dc33809ab6c12a85a171dd1">hss_archive_id</a>);
<a name="l02470"></a>02470 }
<a name="l02471"></a>02471 
<a name="l02472"></a><a class="code" href="pack__generic_8c.html#a896d43b23fb1617f67cfb9c0f4387e0d">02472</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="pack__generic_8c.html#a896d43b23fb1617f67cfb9c0f4387e0d">lustre_swab_hsm_extent</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__extent.html">hsm_extent</a> *extent)
<a name="l02473"></a>02473 {
<a name="l02474"></a>02474         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;extent-&gt;<a class="code" href="structhsm__extent.html#adebe85f26db425af352eb3c867827dea">offset</a>);
<a name="l02475"></a>02475         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;extent-&gt;<a class="code" href="structhsm__extent.html#a54e7b129423205070d4be66656c5d788">length</a>);
<a name="l02476"></a>02476 }
<a name="l02477"></a>02477 
<a name="l02478"></a><a class="code" href="pack__generic_8c.html#a8110960bfe44606ed556bcb9bd9a7ef7">02478</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#aaa6d42561c68b3ac9e2db0e5c999bed3">lustre_swab_hsm_current_action</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__current__action.html">hsm_current_action</a> *action)
<a name="l02479"></a>02479 {
<a name="l02480"></a>02480         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;action-&gt;<a class="code" href="structhsm__current__action.html#a7636b757e79d461f77baae461611ffa6" title="The current undergoing action, if there is one.">hca_state</a>);
<a name="l02481"></a>02481         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;action-&gt;<a class="code" href="structhsm__current__action.html#a90dc168c0df58dea08d3101d07c52103">hca_action</a>);
<a name="l02482"></a>02482         <a class="code" href="pack__generic_8c.html#a896d43b23fb1617f67cfb9c0f4387e0d">lustre_swab_hsm_extent</a>(&amp;action-&gt;<a class="code" href="structhsm__current__action.html#a2f4a083269410e9919403cb07f4cd405">hca_location</a>);
<a name="l02483"></a>02483 }
<a name="l02484"></a>02484 
<a name="l02485"></a><a class="code" href="pack__generic_8c.html#ad20a08a30f0581040af56585fe2c6c98">02485</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a51ec1e7763a3b1ada72a7d30084d3edb">lustre_swab_hsm_user_item</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__user__item.html">hsm_user_item</a> *hui)
<a name="l02486"></a>02486 {
<a name="l02487"></a>02487         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;hui-&gt;<a class="code" href="structhsm__user__item.html#a2d396fe913229ba8e3c594823b7b94e5">hui_fid</a>);
<a name="l02488"></a>02488         <a class="code" href="pack__generic_8c.html#a896d43b23fb1617f67cfb9c0f4387e0d">lustre_swab_hsm_extent</a>(&amp;hui-&gt;<a class="code" href="structhsm__user__item.html#a8d740aa1cb4b4b8f996beb9848b85205">hui_extent</a>);
<a name="l02489"></a>02489 }
<a name="l02490"></a>02490 
<a name="l02491"></a><a class="code" href="pack__generic_8c.html#ae7451ff7466f434825ee1b8f5590a32e">02491</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a87d6fb7de1db049726610979f8f74c99">lustre_swab_layout_intent</a>(<span class="keyword">struct</span> <a class="code" href="structlayout__intent.html">layout_intent</a> *li)
<a name="l02492"></a>02492 {
<a name="l02493"></a>02493         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;li-&gt;<a class="code" href="structlayout__intent.html#a221cf08182a4068f948a668c066ddee1">li_opc</a>);
<a name="l02494"></a>02494         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;li-&gt;<a class="code" href="structlayout__intent.html#aa9225d27cc606add74019d810bb0c423">li_flags</a>);
<a name="l02495"></a>02495         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;li-&gt;<a class="code" href="structlayout__intent.html#a53fd67bfd82005992e06beb194e3f827">li_start</a>);
<a name="l02496"></a>02496         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;li-&gt;<a class="code" href="structlayout__intent.html#a595f428b33b60fa57b6fffdd51070e22">li_end</a>);
<a name="l02497"></a>02497 }
<a name="l02498"></a>02498 
<a name="l02499"></a><a class="code" href="pack__generic_8c.html#aac58f43c54790224e1d85019ab839658">02499</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#af3b31164789a4848849ccfd38be6463b">lustre_swab_hsm_progress_kernel</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__progress__kernel.html" title="On the wire version of hsm_progress structure.">hsm_progress_kernel</a> *hpk)
<a name="l02500"></a>02500 {
<a name="l02501"></a>02501         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;hpk-&gt;<a class="code" href="structhsm__progress__kernel.html#afd48dd63c07cd0a976a6f079f2c2ce2f">hpk_fid</a>);
<a name="l02502"></a>02502         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;hpk-&gt;<a class="code" href="structhsm__progress__kernel.html#acd69473a5dd7b801a58406b043c432b2">hpk_cookie</a>);
<a name="l02503"></a>02503         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;hpk-&gt;<a class="code" href="structhsm__progress__kernel.html#aeaabad7cd43d4742079541386f476755">hpk_extent</a>.<a class="code" href="structhsm__extent.html#adebe85f26db425af352eb3c867827dea">offset</a>);
<a name="l02504"></a>02504         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;hpk-&gt;<a class="code" href="structhsm__progress__kernel.html#aeaabad7cd43d4742079541386f476755">hpk_extent</a>.<a class="code" href="structhsm__extent.html#a54e7b129423205070d4be66656c5d788">length</a>);
<a name="l02505"></a>02505         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;hpk-&gt;<a class="code" href="structhsm__progress__kernel.html#ac88d3f8f793e9988b436c87980d45f9e">hpk_flags</a>);
<a name="l02506"></a>02506         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;hpk-&gt;<a class="code" href="structhsm__progress__kernel.html#a5948469996b462b1869dbbbe4a379df5">hpk_errval</a>);
<a name="l02507"></a>02507 }
<a name="l02508"></a>02508 
<a name="l02509"></a><a class="code" href="pack__generic_8c.html#aa91ff863026499c7cbf3a75c12b4b4ff">02509</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a049bb615f407a48fdf3ab11d8a2dd407">lustre_swab_hsm_request</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__request.html" title="Contains all the fixed part of struct hsm_user_request.">hsm_request</a> *hr)
<a name="l02510"></a>02510 {
<a name="l02511"></a>02511         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;hr-&gt;<a class="code" href="structhsm__request.html#aa4ddc0a69b855eefd2177f041b082c13">hr_action</a>);
<a name="l02512"></a>02512         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;hr-&gt;<a class="code" href="structhsm__request.html#a2bdaeed755a46244d03247a16f069701">hr_archive_id</a>);
<a name="l02513"></a>02513         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;hr-&gt;<a class="code" href="structhsm__request.html#a5a395950d465cf989073eb7fbfa32b3f">hr_flags</a>);
<a name="l02514"></a>02514         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;hr-&gt;<a class="code" href="structhsm__request.html#a467c984247c432b699ffc5926f6fa73e">hr_itemcount</a>);
<a name="l02515"></a>02515         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;hr-&gt;<a class="code" href="structhsm__request.html#a029be1d934a91b465fe970481cdebc95">hr_data_len</a>);
<a name="l02516"></a>02516 }
<a name="l02517"></a>02517 
<a name="l02518"></a><a class="code" href="pack__generic_8c.html#ac4f47d3c8289b7092d9bc3a9c90b0d33">02518</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a1cb3b09fcb3c9ea4e2c372669fbbe2c1">lustre_swab_object_update</a>(<span class="keyword">struct</span> <a class="code" href="structobject__update.html">object_update</a> *ou)
<a name="l02519"></a>02519 {
<a name="l02520"></a>02520         <span class="keyword">struct </span><a class="code" href="structobject__update__param.html">object_update_param</a> *param;
<a name="l02521"></a>02521         <span class="keywordtype">size_t</span>  i;
<a name="l02522"></a>02522 
<a name="l02523"></a>02523         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;ou-&gt;<a class="code" href="structobject__update.html#ab5d2b4b2a78274191e903ce2eee98dd4">ou_type</a>);
<a name="l02524"></a>02524         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;ou-&gt;<a class="code" href="structobject__update.html#ac8083368f10b3535a75fffd059926c1e">ou_params_count</a>);
<a name="l02525"></a>02525         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ou-&gt;<a class="code" href="structobject__update.html#a5c8e425beedc917770f55dfb865582bf">ou_result_size</a>);
<a name="l02526"></a>02526         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ou-&gt;<a class="code" href="structobject__update.html#a628d3e843d208af01bdf4495bfd42758">ou_flags</a>);
<a name="l02527"></a>02527         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ou-&gt;<a class="code" href="structobject__update.html#aa053ef5020acb7d44f0fedb917d358fd">ou_padding1</a>);
<a name="l02528"></a>02528         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ou-&gt;<a class="code" href="structobject__update.html#a184f90dade42b38e6b92b7a99ab8da3c">ou_batchid</a>);
<a name="l02529"></a>02529         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;ou-&gt;<a class="code" href="structobject__update.html#aa7baad863d195c8fc120aad847192341">ou_fid</a>);
<a name="l02530"></a>02530         param = &amp;ou-&gt;<a class="code" href="structobject__update.html#afdf0a16b17078c0fb49d33e05733949b">ou_params</a>[0];
<a name="l02531"></a>02531         <span class="keywordflow">for</span> (i = 0; i &lt; ou-&gt;<a class="code" href="structobject__update.html#ac8083368f10b3535a75fffd059926c1e">ou_params_count</a>; i++) {
<a name="l02532"></a>02532                 <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;param-&gt;<a class="code" href="structobject__update__param.html#aa13ecdd0d46b5e5065dccbf185300d30">oup_len</a>);
<a name="l02533"></a>02533                 <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;param-&gt;<a class="code" href="structobject__update__param.html#af4c2204aeaea264c9eb96ecddc10bf4a">oup_padding</a>);
<a name="l02534"></a>02534                 <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;param-&gt;<a class="code" href="structobject__update__param.html#a8d5fdca5459dd87351ca2c1229aaff25">oup_padding2</a>);
<a name="l02535"></a>02535                 param = (<span class="keyword">struct </span><a class="code" href="structobject__update__param.html">object_update_param</a> *)((<span class="keywordtype">char</span> *)param +
<a name="l02536"></a>02536                          <a class="code" href="group__lustreidl.html#ga309385e5a4a2c8f3b6a58ed702afb59a">object_update_param_size</a>(param));
<a name="l02537"></a>02537         }
<a name="l02538"></a>02538 }
<a name="l02539"></a>02539 
<a name="l02540"></a><a class="code" href="pack__generic_8c.html#aa7ede8a54903f0d390fd211742af4502">02540</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a5c7a455cdd61d130b39d1b96812e82cc">lustre_swab_object_update_request</a>(<span class="keyword">struct</span> <a class="code" href="structobject__update__request.html">object_update_request</a> *our)
<a name="l02541"></a>02541 {
<a name="l02542"></a>02542         <span class="keywordtype">size_t</span> i;
<a name="l02543"></a>02543         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;our-&gt;<a class="code" href="structobject__update__request.html#a3653cae8da87756f57b52b0878ca6d7d">ourq_magic</a>);
<a name="l02544"></a>02544         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;our-&gt;<a class="code" href="structobject__update__request.html#a1568d522033790abc0187af9bf40464f">ourq_count</a>);
<a name="l02545"></a>02545         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;our-&gt;<a class="code" href="structobject__update__request.html#a79fa6b96f1e315f363ad743613262674">ourq_padding</a>);
<a name="l02546"></a>02546         <span class="keywordflow">for</span> (i = 0; i &lt; our-&gt;<a class="code" href="structobject__update__request.html#a1568d522033790abc0187af9bf40464f">ourq_count</a>; i++) {
<a name="l02547"></a>02547                 <span class="keyword">struct </span><a class="code" href="structobject__update.html">object_update</a> *ou;
<a name="l02548"></a>02548 
<a name="l02549"></a>02549                 ou = <a class="code" href="group__lustreidl.html#gace78bf2d09c3e03c21a0a0540eb8d201">object_update_request_get</a>(our, i, NULL);
<a name="l02550"></a>02550                 <span class="keywordflow">if</span> (ou == NULL)
<a name="l02551"></a>02551                         <span class="keywordflow">return</span>;
<a name="l02552"></a>02552                 <a class="code" href="req-layout_8c.html#a1cb3b09fcb3c9ea4e2c372669fbbe2c1">lustre_swab_object_update</a>(ou);
<a name="l02553"></a>02553         }
<a name="l02554"></a>02554 }
<a name="l02555"></a>02555 
<a name="l02556"></a><a class="code" href="pack__generic_8c.html#a7dd508001d96eda90f19a25d707cdb5a">02556</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a424fb49cc5cab1d0cbf64279b6fe4738">lustre_swab_object_update_result</a>(<span class="keyword">struct</span> <a class="code" href="structobject__update__result.html">object_update_result</a> *our)
<a name="l02557"></a>02557 {
<a name="l02558"></a>02558         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;our-&gt;<a class="code" href="structobject__update__result.html#a6eed2b7bda7e2104c7aa6a232b0bc15c">our_rc</a>);
<a name="l02559"></a>02559         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;our-&gt;<a class="code" href="structobject__update__result.html#ad05893ccd5cf3b06ef72ac42d4fb7e58">our_datalen</a>);
<a name="l02560"></a>02560         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;our-&gt;<a class="code" href="structobject__update__result.html#a449f10c6d59118777571d392944da2f7">our_padding</a>);
<a name="l02561"></a>02561 }
<a name="l02562"></a>02562 
<a name="l02563"></a><a class="code" href="pack__generic_8c.html#a3410bccc817a8aef86afcfce7e2514ef">02563</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#ac0a3826fb2f736506bb4e67fdb557d33">lustre_swab_object_update_reply</a>(<span class="keyword">struct</span> <a class="code" href="structobject__update__reply.html">object_update_reply</a> *our)
<a name="l02564"></a>02564 {
<a name="l02565"></a>02565         <span class="keywordtype">size_t</span> i;
<a name="l02566"></a>02566 
<a name="l02567"></a>02567         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;our-&gt;<a class="code" href="structobject__update__reply.html#aa8a1f7c17bf78f3bb40d0c24a99b0be8">ourp_magic</a>);
<a name="l02568"></a>02568         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;our-&gt;<a class="code" href="structobject__update__reply.html#a7736ef2024153998583ab9d159c437da">ourp_count</a>);
<a name="l02569"></a>02569         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;our-&gt;<a class="code" href="structobject__update__reply.html#abca22ac31feddc7cd3dfd97a5fe90874">ourp_padding</a>);
<a name="l02570"></a>02570         <span class="keywordflow">for</span> (i = 0; i &lt; our-&gt;<a class="code" href="structobject__update__reply.html#a7736ef2024153998583ab9d159c437da">ourp_count</a>; i++) {
<a name="l02571"></a>02571                 <span class="keyword">struct </span><a class="code" href="structobject__update__result.html">object_update_result</a> *ourp;
<a name="l02572"></a>02572 
<a name="l02573"></a>02573                 <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;our-&gt;<a class="code" href="structobject__update__reply.html#ac4e2846ba51db4b28326818551cf670b">ourp_lens</a>[i]);
<a name="l02574"></a>02574                 ourp = <a class="code" href="group__lustreidl.html#ga5d0fb3beb24561037693c266f8ca3889">object_update_result_get</a>(our, i, NULL);
<a name="l02575"></a>02575                 <span class="keywordflow">if</span> (ourp == NULL)
<a name="l02576"></a>02576                         <span class="keywordflow">return</span>;
<a name="l02577"></a>02577                 <a class="code" href="req-layout_8c.html#a424fb49cc5cab1d0cbf64279b6fe4738">lustre_swab_object_update_result</a>(ourp);
<a name="l02578"></a>02578         }
<a name="l02579"></a>02579 }
<a name="l02580"></a>02580 
<a name="l02581"></a><a class="code" href="pack__generic_8c.html#adef5f0d2dbf62ce1bdd502e34ff3d2f7">02581</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#af8d10f681bebebba132979f30db41760">lustre_swab_out_update_header</a>(<span class="keyword">struct</span> <a class="code" href="structout__update__header.html">out_update_header</a> *ouh)
<a name="l02582"></a>02582 {
<a name="l02583"></a>02583         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ouh-&gt;<a class="code" href="structout__update__header.html#a6e7b246aae5488088eb26f89efc54ff9">ouh_magic</a>);
<a name="l02584"></a>02584         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ouh-&gt;<a class="code" href="structout__update__header.html#a4e443ed559b7c575927089b0779ce0c3">ouh_count</a>);
<a name="l02585"></a>02585         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ouh-&gt;<a class="code" href="structout__update__header.html#a2388aad72deb9d7c90c3cc3326e52c52">ouh_inline_length</a>);
<a name="l02586"></a>02586         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ouh-&gt;<a class="code" href="structout__update__header.html#a1c369d847ec44cdfa78f23a8912af98b">ouh_reply_size</a>);
<a name="l02587"></a>02587 }
<a name="l02588"></a>02588 EXPORT_SYMBOL(<a class="code" href="req-layout_8c.html#af8d10f681bebebba132979f30db41760">lustre_swab_out_update_header</a>);
<a name="l02589"></a>02589 
<a name="l02590"></a><a class="code" href="pack__generic_8c.html#ad68e3cecd395f37fe5fcfe08133d8a44">02590</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a7be06b6df605460c50946aa8540b4e05">lustre_swab_out_update_buffer</a>(<span class="keyword">struct</span> <a class="code" href="structout__update__buffer.html">out_update_buffer</a> *oub)
<a name="l02591"></a>02591 {
<a name="l02592"></a>02592         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;oub-&gt;<a class="code" href="structout__update__buffer.html#a9a7a236a1bc449b814dbbeddcb135836">oub_size</a>);
<a name="l02593"></a>02593         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;oub-&gt;<a class="code" href="structout__update__buffer.html#abd5c05818581929d95444a89230833f4">oub_padding</a>);
<a name="l02594"></a>02594 }
<a name="l02595"></a>02595 EXPORT_SYMBOL(<a class="code" href="req-layout_8c.html#a7be06b6df605460c50946aa8540b4e05">lustre_swab_out_update_buffer</a>);
<a name="l02596"></a>02596 
<a name="l02597"></a><a class="code" href="pack__generic_8c.html#a43f4d747778fecb644e0dde2bc76c738">02597</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a7b18b7da99d877dbf81c02fe743339c0">lustre_swab_swap_layouts</a>(<span class="keyword">struct</span> <a class="code" href="structmdc__swap__layouts.html" title="layout swap request structure fid1 and fid2 are in mdt_body">mdc_swap_layouts</a> *msl)
<a name="l02598"></a>02598 {
<a name="l02599"></a>02599         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;msl-&gt;<a class="code" href="structmdc__swap__layouts.html#ab782dd1581fffdfbfd24492b11e23ce1">msl_flags</a>);
<a name="l02600"></a>02600 }
<a name="l02601"></a>02601 
<a name="l02602"></a><a class="code" href="pack__generic_8c.html#ae11530ea4c116599d7e043b9f040f6ae">02602</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#ad777439cc383dd1c3b1812ff2b8ef3a5">lustre_swab_close_data</a>(<span class="keyword">struct</span> <a class="code" href="structclose__data.html">close_data</a> *cd)
<a name="l02603"></a>02603 {
<a name="l02604"></a>02604         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;cd-&gt;<a class="code" href="structclose__data.html#a29bb7cabb7a9742612563acd389ef289">cd_fid</a>);
<a name="l02605"></a>02605         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;cd-&gt;<a class="code" href="structclose__data.html#accabbd37b4a19826730f9f1021e0099b">cd_data_version</a>);
<a name="l02606"></a>02606 }
<a name="l02607"></a>02607 
<a name="l02608"></a><a class="code" href="pack__generic_8c.html#a5b18011679c872e6ecfa902d05fa1bf7">02608</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#acae1824eb96241bb5c01db1c0037e275">lustre_swab_lfsck_request</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__request.html">lfsck_request</a> *lr)
<a name="l02609"></a>02609 {
<a name="l02610"></a>02610         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#a2c5f665862e3dd311ee2f81332def97a">lr_event</a>);
<a name="l02611"></a>02611         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#a31ad159acb5753d143a64bd1d9fa5c95">lr_index</a>);
<a name="l02612"></a>02612         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#a302e2d4258a53839d4d2bc3987836048">lr_flags</a>);
<a name="l02613"></a>02613         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#afbe85ae08028586071be66c303f3bee4">lr_valid</a>);
<a name="l02614"></a>02614         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#ab2e36de61fec1936f211f47849b6f8f4">lr_speed</a>);
<a name="l02615"></a>02615         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#a37a59139e97f9281fc24e60f39ea9caf">lr_version</a>);
<a name="l02616"></a>02616         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#aa3533754346ba510cb1a002f4fee53e6">lr_active</a>);
<a name="l02617"></a>02617         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#a88848a5e829cb91126d5f01ad14ea18f">lr_param</a>);
<a name="l02618"></a>02618         <a class="code" href="byteorder_8h.html#a921c43a174aafeb42ce2b474dc1bf797">__swab16s</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#ab4f9d1cf8a46992887fc4088452f5eb1">lr_async_windows</a>);
<a name="l02619"></a>02619         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#a302e2d4258a53839d4d2bc3987836048">lr_flags</a>);
<a name="l02620"></a>02620         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#a66b1f3f909b3dc26261814cfeb2cdcca">lr_fid</a>);
<a name="l02621"></a>02621         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#a206f68391c2db7bc6ea5b32eed087080">lr_fid2</a>);
<a name="l02622"></a>02622         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;lr-&gt;<a class="code" href="structlfsck__request.html#ab93a18b8ac54f3dd5dce304bd4eb96e5">lr_fid3</a>);
<a name="l02623"></a>02623         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*lr), lr_padding_1) != 0);
<a name="l02624"></a>02624         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*lr), lr_padding_2) != 0);
<a name="l02625"></a>02625 }
<a name="l02626"></a>02626 
<a name="l02627"></a><a class="code" href="pack__generic_8c.html#adad4ec9ec14efefdb51f3808520ca1c7">02627</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a7de8a45a2e54edd59575c3105d140c30">lustre_swab_lfsck_reply</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__reply.html">lfsck_reply</a> *lr)
<a name="l02628"></a>02628 {
<a name="l02629"></a>02629         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;lr-&gt;<a class="code" href="structlfsck__reply.html#a69a5ad1346c29cceb830d4e00e51f36d">lr_status</a>);
<a name="l02630"></a>02630         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*lr), lr_padding_1) != 0);
<a name="l02631"></a>02631         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;lr-&gt;<a class="code" href="structlfsck__reply.html#a8a939be60d7c59490c3c7ce84984b1e3">lr_repaired</a>);
<a name="l02632"></a>02632 }
<a name="l02633"></a>02633 
<a name="l02634"></a><a class="code" href="pack__generic_8c.html#ae7ee1860d77e56e8f46a3fe17493f0a6">02634</a> <span class="keywordtype">void</span> <a class="code" href="lustre__swab_8h.html#ae7ee1860d77e56e8f46a3fe17493f0a6">lustre_swab_orphan_ent</a>(<span class="keyword">struct</span> <a class="code" href="structlu__orphan__ent.html">lu_orphan_ent</a> *ent)
<a name="l02635"></a>02635 {
<a name="l02636"></a>02636         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;ent-&gt;<a class="code" href="structlu__orphan__ent.html#a368371b7c73be04ee5409d865b43f9df">loe_key</a>);
<a name="l02637"></a>02637         <a class="code" href="req-layout_8c.html#aee852332fa4541abe7c1cccd97de2eca">lustre_swab_lu_fid</a>(&amp;ent-&gt;<a class="code" href="structlu__orphan__ent.html#a9455457d96bc3fa64ca7fe3a01bef07b">loe_rec</a>.<a class="code" href="structlu__orphan__rec.html#a32d6aa1329fb389162945a03772fbbcf">lor_fid</a>);
<a name="l02638"></a>02638         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ent-&gt;<a class="code" href="structlu__orphan__ent.html#a9455457d96bc3fa64ca7fe3a01bef07b">loe_rec</a>.<a class="code" href="structlu__orphan__rec.html#a6d6a8a12e4c5b6a59ca8efbe36e7fb9f">lor_uid</a>);
<a name="l02639"></a>02639         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ent-&gt;<a class="code" href="structlu__orphan__ent.html#a9455457d96bc3fa64ca7fe3a01bef07b">loe_rec</a>.<a class="code" href="structlu__orphan__rec.html#a7af949aef6d088c42d4eb904d750081e">lor_gid</a>);
<a name="l02640"></a>02640 }
<a name="l02641"></a>02641 EXPORT_SYMBOL(<a class="code" href="lustre__swab_8h.html#ae7ee1860d77e56e8f46a3fe17493f0a6">lustre_swab_orphan_ent</a>);
<a name="l02642"></a>02642 
<a name="l02643"></a><a class="code" href="pack__generic_8c.html#a0335c6c8a0d237c76c0d207e8400d0c4">02643</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#a5ce0a1ede90a1aabae761a71bb0279b2">lustre_swab_ladvise</a>(<span class="keyword">struct</span> <a class="code" href="structlu__ladvise.html">lu_ladvise</a> *ladvise)
<a name="l02644"></a>02644 {
<a name="l02645"></a>02645         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ladvise-&gt;<a class="code" href="structlu__ladvise.html#a1c5eef149bad57cfcf20d3c2c876ae6d">lla_start</a>);
<a name="l02646"></a>02646         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ladvise-&gt;<a class="code" href="structlu__ladvise.html#a6dc94c416f6b7b966fc6a420baaabe79">lla_end</a>);
<a name="l02647"></a>02647         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ladvise-&gt;<a class="code" href="structlu__ladvise.html#a17f21483ca052db32c8218c08f908e92">lla_advice</a>);
<a name="l02648"></a>02648         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ladvise), lla_padding) != 0);
<a name="l02649"></a>02649 }
<a name="l02650"></a>02650 EXPORT_SYMBOL(<a class="code" href="req-layout_8c.html#a5ce0a1ede90a1aabae761a71bb0279b2">lustre_swab_ladvise</a>);
<a name="l02651"></a>02651 
<a name="l02652"></a><a class="code" href="pack__generic_8c.html#a0ec53384d801a8c0504ed095698d1685">02652</a> <span class="keywordtype">void</span> <a class="code" href="req-layout_8c.html#abc6ba8d40b349cd278d6b5b2e1b36a6a">lustre_swab_ladvise_hdr</a>(<span class="keyword">struct</span> <a class="code" href="structladvise__hdr.html">ladvise_hdr</a> *<a class="code" href="structladvise__hdr.html">ladvise_hdr</a>)
<a name="l02653"></a>02653 {
<a name="l02654"></a>02654         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ladvise_hdr-&gt;<a class="code" href="structladvise__hdr.html#acbe9136dd47a305c8de1ea7a716e3b78">lah_magic</a>);
<a name="l02655"></a>02655         <a class="code" href="byteorder_8h.html#ab9cd632aa0194b301cae9e8dbc210718">__swab32s</a>(&amp;ladvise_hdr-&gt;<a class="code" href="structladvise__hdr.html#a8961a339c8782ea550ca99d4e05111e5">lah_count</a>);
<a name="l02656"></a>02656         <a class="code" href="byteorder_8h.html#a8eb48d492d4a496c21c628372e40902a">__swab64s</a>(&amp;ladvise_hdr-&gt;<a class="code" href="structladvise__hdr.html#aa67f7e0acb6dc63443b04034c69fa67a">lah_flags</a>);
<a name="l02657"></a>02657         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ladvise_hdr), lah_padding1) != 0);
<a name="l02658"></a>02658         <a class="code" href="osd__iam_8h.html#accba6d34cf012c360c3ad61f87373778">CLASSERT</a>(<a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(typeof(*ladvise_hdr), lah_padding2) != 0);
<a name="l02659"></a>02659 }
<a name="l02660"></a>02660 EXPORT_SYMBOL(<a class="code" href="req-layout_8c.html#abc6ba8d40b349cd278d6b5b2e1b36a6a">lustre_swab_ladvise_hdr</a>);
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:43 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
