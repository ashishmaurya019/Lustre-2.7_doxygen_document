<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/include/cl_object.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>lustre/include/cl_object.h</h1><a href="cl__object_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * GPL HEADER START</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> * it under the terms of the GNU General Public License version 2 only,</span>
<a name="l00008"></a>00008 <span class="comment"> * as published by the Free Software Foundation.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * This program is distributed in the hope that it will be useful, but</span>
<a name="l00011"></a>00011 <span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00013"></a>00013 <span class="comment"> * General Public License version 2 for more details (a copy is included</span>
<a name="l00014"></a>00014 <span class="comment"> * in the LICENSE file that accompanied this code).</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> * version 2 along with this program; If not, see</span>
<a name="l00018"></a>00018 <span class="comment"> * http://www.sun.com/software/products/lustre/docs/GPLv2.pdf</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * Please contact Sun Microsystems, Inc., 4150 Network Circle, Santa Clara,</span>
<a name="l00021"></a>00021 <span class="comment"> * CA 95054 USA or visit www.sun.com if you need additional information or</span>
<a name="l00022"></a>00022 <span class="comment"> * have any questions.</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * GPL HEADER END</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 <span class="comment">/*</span>
<a name="l00027"></a>00027 <span class="comment"> * Copyright (c) 2008, 2010, Oracle and/or its affiliates. All rights reserved.</span>
<a name="l00028"></a>00028 <span class="comment"> * Use is subject to license terms.</span>
<a name="l00029"></a>00029 <span class="comment"> *</span>
<a name="l00030"></a>00030 <span class="comment"> * Copyright (c) 2011, 2015, Intel Corporation.</span>
<a name="l00031"></a>00031 <span class="comment"> */</span>
<a name="l00032"></a>00032 <span class="comment">/*</span>
<a name="l00033"></a>00033 <span class="comment"> * This file is part of Lustre, http://www.lustre.org/</span>
<a name="l00034"></a>00034 <span class="comment"> * Lustre is a trademark of Sun Microsystems, Inc.</span>
<a name="l00035"></a>00035 <span class="comment"> */</span>
<a name="l00036"></a>00036 <span class="preprocessor">#ifndef _LUSTRE_CL_OBJECT_H</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span><span class="preprocessor">#define _LUSTRE_CL_OBJECT_H</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00092"></a>00092 <span class="comment">/*</span>
<a name="l00093"></a>00093 <span class="comment"> * super-class definitions.</span>
<a name="l00094"></a>00094 <span class="comment"> */</span>
<a name="l00095"></a>00095 <span class="preprocessor">#include &lt;<a class="code" href="libcfs_8h.html">libcfs/libcfs.h</a>&gt;</span>
<a name="l00096"></a>00096 <span class="preprocessor">#include &lt;<a class="code" href="lu__object_8h.html">lu_object.h</a>&gt;</span>
<a name="l00097"></a>00097 <span class="preprocessor">#include &lt;linux/atomic.h&gt;</span>
<a name="l00098"></a>00098 <span class="preprocessor">#include &lt;linux/mutex.h&gt;</span>
<a name="l00099"></a>00099 <span class="preprocessor">#include &lt;linux/radix-tree.h&gt;</span>
<a name="l00100"></a>00100 <span class="preprocessor">#include &lt;linux/spinlock.h&gt;</span>
<a name="l00101"></a>00101 <span class="preprocessor">#include &lt;linux/wait.h&gt;</span>
<a name="l00102"></a>00102 <span class="preprocessor">#include &lt;<a class="code" href="lustre__dlm_8h.html">lustre_dlm.h</a>&gt;</span>
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="keyword">struct </span><a class="code" href="structobd__info.html">obd_info</a>;
<a name="l00105"></a>00105 <span class="keyword">struct </span>inode;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 <span class="keyword">struct </span><a class="code" href="structcl__device.html" title="Device in the client stack.">cl_device</a>;
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a>;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a>;
<a name="l00112"></a>00112 <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a>;
<a name="l00113"></a>00113 <span class="keyword">struct </span><a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a>;
<a name="l00114"></a>00114 <span class="keyword">struct </span><a class="code" href="structcl__lock__slice.html" title="Per-layer part of cl_lock.">cl_lock_slice</a>;
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 <span class="keyword">struct </span><a class="code" href="structcl__lock__operations.html">cl_lock_operations</a>;
<a name="l00117"></a>00117 <span class="keyword">struct </span><a class="code" href="structcl__page__operations.html" title="Per-layer page operations.">cl_page_operations</a>;
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a>;
<a name="l00120"></a>00120 <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a>;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="keyword">struct </span><a class="code" href="structcl__req__attr.html" title="Per-transfer attributes.">cl_req_attr</a>;
<a name="l00123"></a>00123 
<a name="l00129"></a><a class="code" href="structcl__device.html">00129</a> <span class="keyword">struct </span><a class="code" href="structcl__device.html" title="Device in the client stack.">cl_device</a> {
<a name="l00131"></a><a class="code" href="structcl__device.html#a881ea223a07828242f8c3b02f65792db">00131</a>         <span class="keyword">struct </span><a class="code" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a>                   <a class="code" href="structcl__device.html#a881ea223a07828242f8c3b02f65792db" title="Super-class.">cd_lu_dev</a>;
<a name="l00132"></a>00132 };
<a name="l00133"></a>00133 
<a name="l00141"></a><a class="code" href="structcl__attr.html">00141</a> <span class="keyword">struct </span><a class="code" href="structcl__attr.html" title="&amp;quot;Data attributes&amp;quot; of cl_object.">cl_attr</a> {
<a name="l00143"></a><a class="code" href="structcl__attr.html#a301cbfa8e597852a6f7cf1b5a22d5269">00143</a>         loff_t <a class="code" href="structcl__attr.html#a301cbfa8e597852a6f7cf1b5a22d5269" title="Object size, in bytes.">cat_size</a>;
<a name="l00149"></a><a class="code" href="structcl__attr.html#a84e50a30068843ee9789b137b1e00aef">00149</a>         loff_t <a class="code" href="structcl__attr.html#a84e50a30068843ee9789b137b1e00aef" title="Known minimal size, in bytes.">cat_kms</a>;
<a name="l00151"></a><a class="code" href="structcl__attr.html#ac337ab4467993ed3c1ed8a74407e933b">00151</a>         time_t <a class="code" href="structcl__attr.html#ac337ab4467993ed3c1ed8a74407e933b" title="Modification time.">cat_mtime</a>;
<a name="l00153"></a><a class="code" href="structcl__attr.html#a703fa4a91dbf487ea43a491efbcbb26c">00153</a>         time_t <a class="code" href="structcl__attr.html#a703fa4a91dbf487ea43a491efbcbb26c" title="Access time.">cat_atime</a>;
<a name="l00155"></a><a class="code" href="structcl__attr.html#ad219a939eaf54b1de26b049f26d513e3">00155</a>         time_t <a class="code" href="structcl__attr.html#ad219a939eaf54b1de26b049f26d513e3" title="Change time.">cat_ctime</a>;
<a name="l00161"></a><a class="code" href="structcl__attr.html#aa5bce270584ece6d9511008c0d827821">00161</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>  <a class="code" href="structcl__attr.html#aa5bce270584ece6d9511008c0d827821" title="Blocks allocated to this cl_object on the server file system.">cat_blocks</a>;
<a name="l00165"></a><a class="code" href="structcl__attr.html#abbe29ea52fdc22a48eba9af020b28e20">00165</a>         uid_t  <a class="code" href="structcl__attr.html#abbe29ea52fdc22a48eba9af020b28e20" title="User identifier for quota purposes.">cat_uid</a>;
<a name="l00169"></a><a class="code" href="structcl__attr.html#acad9d7dd3e9f42506c7c1a44228fb485">00169</a>         gid_t  <a class="code" href="structcl__attr.html#acad9d7dd3e9f42506c7c1a44228fb485" title="Group identifier for quota purposes.">cat_gid</a>;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171         <span class="comment">/* nlink of the directory */</span>
<a name="l00172"></a><a class="code" href="structcl__attr.html#adb5d5843446f6e22035a41252821b558">00172</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>  <a class="code" href="structcl__attr.html#adb5d5843446f6e22035a41252821b558">cat_nlink</a>;
<a name="l00173"></a>00173 };
<a name="l00174"></a>00174 
<a name="l00178"></a><a class="code" href="group__cl__object.html#ga48fd4da7a215ef4bcc31582adceb8b83">00178</a> <span class="keyword">enum</span> <a class="code" href="group__cl__object.html#ga48fd4da7a215ef4bcc31582adceb8b83" title="Fields in cl_attr that are being set.">cl_attr_valid</a> {
<a name="l00179"></a><a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83a8ccb81e3f6a5cba7c8e9bd494874cd38">00179</a>         <a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83a8ccb81e3f6a5cba7c8e9bd494874cd38">CAT_SIZE</a>   = 1 &lt;&lt; 0,
<a name="l00180"></a><a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83aa410b24e55de9c6bf1fb8da2d36a5c8d">00180</a>         <a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83aa410b24e55de9c6bf1fb8da2d36a5c8d">CAT_KMS</a>    = 1 &lt;&lt; 1,
<a name="l00181"></a><a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83ac7e947d42c260c8df203b6d73da46f4c">00181</a>         <a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83ac7e947d42c260c8df203b6d73da46f4c">CAT_MTIME</a>  = 1 &lt;&lt; 3,
<a name="l00182"></a><a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83af1b07764255dd3f79878a040e7cb73b0">00182</a>         <a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83af1b07764255dd3f79878a040e7cb73b0">CAT_ATIME</a>  = 1 &lt;&lt; 4,
<a name="l00183"></a><a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83a3d90d16441447a6904e7932279f13cb3">00183</a>         <a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83a3d90d16441447a6904e7932279f13cb3">CAT_CTIME</a>  = 1 &lt;&lt; 5,
<a name="l00184"></a><a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83a0426f1a497ac52defd19a0f843de76dd">00184</a>         <a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83a0426f1a497ac52defd19a0f843de76dd">CAT_BLOCKS</a> = 1 &lt;&lt; 6,
<a name="l00185"></a><a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83a5b08cbafc7ea7a9a5bc7579fe8d1d7d4">00185</a>         <a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83a5b08cbafc7ea7a9a5bc7579fe8d1d7d4">CAT_UID</a>    = 1 &lt;&lt; 7,
<a name="l00186"></a><a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83aa0bf839b66fce54ab3eaf3744311f6f6">00186</a>         <a class="code" href="group__cl__object.html#gga48fd4da7a215ef4bcc31582adceb8b83aa0bf839b66fce54ab3eaf3744311f6f6">CAT_GID</a>    = 1 &lt;&lt; 8
<a name="l00187"></a>00187 };
<a name="l00188"></a>00188 
<a name="l00225"></a><a class="code" href="structcl__object.html">00225</a> <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> {
<a name="l00227"></a><a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d">00227</a>         <span class="keyword">struct </span><a class="code" href="structlu__object.html" title="Layer in the layered object.">lu_object</a>                   <a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>;
<a name="l00229"></a><a class="code" href="structcl__object.html#a84db2d531bbd895d49cc44b795778064">00229</a>         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__object__operations.html" title="Operations implemented for each cl object layer.">cl_object_operations</a> *<a class="code" href="structcl__object.html#a84db2d531bbd895d49cc44b795778064" title="per-object-layer operations">co_ops</a>;
<a name="l00231"></a><a class="code" href="structcl__object.html#abd601ddb054aaa4a5b1c998b8f502e7a">00231</a>         <span class="keywordtype">int</span>                                <a class="code" href="structcl__object.html#abd601ddb054aaa4a5b1c998b8f502e7a" title="offset of page slice in cl_page buffer">co_slice_off</a>;
<a name="l00232"></a>00232 };
<a name="l00233"></a>00233 
<a name="l00239"></a><a class="code" href="structcl__object__conf.html">00239</a> <span class="keyword">struct </span><a class="code" href="structcl__object__conf.html" title="Description of the client object configuration.">cl_object_conf</a> {
<a name="l00241"></a><a class="code" href="structcl__object__conf.html#a2dae6350547faf461529cfa61811385c">00241</a>         <span class="keyword">struct </span><a class="code" href="structlu__object__conf.html" title="Object configuration, describing particulars of object being created.">lu_object_conf</a>     <a class="code" href="structcl__object__conf.html#a2dae6350547faf461529cfa61811385c" title="Super-class.">coc_lu</a>;
<a name="l00242"></a>00242         <span class="keyword">union </span>{
<a name="l00246"></a><a class="code" href="structcl__object__conf.html#a3ec339f59ef4d1a259a02c80d760a814">00246</a>                 <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a>    <a class="code" href="structcl__object__conf.html#a3ec339f59ef4d1a259a02c80d760a814" title="Object layout.">coc_layout</a>;
<a name="l00251"></a><a class="code" href="structcl__object__conf.html#a87ab3ddbc02f4256dcebdfd52cb5f3ee">00251</a>                 <span class="keyword">struct </span><a class="code" href="structlov__oinfo.html">lov_oinfo</a> *<a class="code" href="structcl__object__conf.html#a87ab3ddbc02f4256dcebdfd52cb5f3ee" title="Description of particular stripe location in the cluster.">coc_oinfo</a>;
<a name="l00252"></a>00252         } <a class="code" href="structcl__object__conf.html#a8a5ff5a6bba630aa3d7852da7a221c7c">u</a>;
<a name="l00256"></a><a class="code" href="structcl__object__conf.html#a4b4c17da427838b3643cec7876583c66">00256</a>         <span class="keyword">struct </span>inode             *<a class="code" href="structcl__object__conf.html#a4b4c17da427838b3643cec7876583c66" title="VFS inode.">coc_inode</a>;
<a name="l00260"></a><a class="code" href="structcl__object__conf.html#a69b3a255df05a23ba42c9fe5623349f2">00260</a>         <span class="keyword">struct </span><a class="code" href="structldlm__lock.html" title="LDLM lock structure.">ldlm_lock</a>         *<a class="code" href="structcl__object__conf.html#a69b3a255df05a23ba42c9fe5623349f2" title="Layout lock handle.">coc_lock</a>;
<a name="l00264"></a><a class="code" href="structcl__object__conf.html#a2a446f25ea361181f94766c0db1031b7">00264</a>         <span class="keywordtype">int</span>                       <a class="code" href="structcl__object__conf.html#a2a446f25ea361181f94766c0db1031b7" title="Operation to handle layout, OBJECT_CONF_XYZ.">coc_opc</a>;
<a name="l00265"></a>00265 };
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="keyword">enum</span> {
<a name="l00270"></a><a class="code" href="group__cl__object.html#gga99fb83031ce9923c84392b4e92f956b5afbab2abc5d277403ef84e9bcd75ee7e5">00270</a>         <a class="code" href="group__cl__object.html#gga99fb83031ce9923c84392b4e92f956b5afbab2abc5d277403ef84e9bcd75ee7e5" title="configure layout, set up a new stripe, must be called while holding layout lock.">OBJECT_CONF_SET</a> = 0,
<a name="l00273"></a><a class="code" href="group__cl__object.html#gga99fb83031ce9923c84392b4e92f956b5a008009ec8f83b28274d90a650cca813b">00273</a>         <a class="code" href="group__cl__object.html#gga99fb83031ce9923c84392b4e92f956b5a008009ec8f83b28274d90a650cca813b" title="invalidate the current stripe configuration due to losing layout lock.">OBJECT_CONF_INVALIDATE</a> = 1,
<a name="l00276"></a><a class="code" href="group__cl__object.html#gga99fb83031ce9923c84392b4e92f956b5a916b610eabe05c138a1717820f9a0696">00276</a>         <a class="code" href="group__cl__object.html#gga99fb83031ce9923c84392b4e92f956b5a916b610eabe05c138a1717820f9a0696" title="wait for old layout to go away so that new layout can be set up.">OBJECT_CONF_WAIT</a> = 2
<a name="l00277"></a>00277 };
<a name="l00278"></a>00278 
<a name="l00279"></a>00279 <span class="keyword">enum</span> {
<a name="l00280"></a><a class="code" href="group__cl__object.html#ggabc6126af1d45847bc59afa0aa3216b04a1b72f9397d6476c49c2e8d29c77f7020">00280</a>         <a class="code" href="group__cl__object.html#ggabc6126af1d45847bc59afa0aa3216b04a1b72f9397d6476c49c2e8d29c77f7020">CL_LAYOUT_GEN_NONE</a>      = (u32)-2,      <span class="comment">/* layout lock was cancelled */</span>
<a name="l00281"></a><a class="code" href="group__cl__object.html#ggabc6126af1d45847bc59afa0aa3216b04a24c291bae1cc38e81fe6ec49d17db612">00281</a>         <a class="code" href="group__cl__object.html#ggabc6126af1d45847bc59afa0aa3216b04a24c291bae1cc38e81fe6ec49d17db612">CL_LAYOUT_GEN_EMPTY</a>     = (u32)-1,      <span class="comment">/* for empty layout */</span>
<a name="l00282"></a>00282 };
<a name="l00283"></a>00283 
<a name="l00284"></a><a class="code" href="structcl__layout.html">00284</a> <span class="keyword">struct </span><a class="code" href="structcl__layout.html">cl_layout</a> {
<a name="l00286"></a><a class="code" href="structcl__layout.html#a5b593f053691bbd720f5e05b42b7afce">00286</a>         <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a>   <a class="code" href="structcl__layout.html#a5b593f053691bbd720f5e05b42b7afce" title="the buffer to return the layout in lov_mds_md format.">cl_buf</a>;
<a name="l00288"></a><a class="code" href="structcl__layout.html#a6031da2d12e78091853e35b6938c62d4">00288</a>         <span class="keywordtype">size_t</span>          <a class="code" href="structcl__layout.html#a6031da2d12e78091853e35b6938c62d4" title="size of layout in lov_mds_md format.">cl_size</a>;
<a name="l00290"></a><a class="code" href="structcl__layout.html#ab0968d21c86a319b62cb40bdb9a60518">00290</a>         u32             <a class="code" href="structcl__layout.html#ab0968d21c86a319b62cb40bdb9a60518" title="Layout generation.">cl_layout_gen</a>;
<a name="l00291"></a>00291 };
<a name="l00292"></a>00292 
<a name="l00298"></a><a class="code" href="structcl__object__operations.html">00298</a> <span class="keyword">struct </span><a class="code" href="structcl__object__operations.html" title="Operations implemented for each cl object layer.">cl_object_operations</a> {
<a name="l00314"></a>00314         int  (*<a class="code" href="structcl__object__operations.html#a86e603bbbf4c6b1625b8dece6cbb5f32" title="Initialize page slice for this layer.">coo_page_init</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l00315"></a>00315                                 <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page, pgoff_t index);
<a name="l00323"></a>00323         int  (*<a class="code" href="structcl__object__operations.html#a636de14a3118ef9d708121f95a1330e4" title="Initialize lock slice for this layer.">coo_lock_init</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00324"></a>00324                               <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj, <span class="keyword">struct </span><a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a> *lock,
<a name="l00325"></a>00325                               <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l00335"></a>00335         int  (*<a class="code" href="structcl__object__operations.html#a8b8a7168fdc690b21120ab5d03ae67ce" title="Initialize io state for a given layer.">coo_io_init</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00336"></a>00336                             <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj, <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l00348"></a>00348         int (*<a class="code" href="structcl__object__operations.html#a63cabd646365a83d06c0e8eae0fe633f" title="Fill portion of attr that this layer controls.">coo_attr_get</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l00349"></a>00349                             <span class="keyword">struct </span><a class="code" href="structcl__attr.html" title="&amp;quot;Data attributes&amp;quot; of cl_object.">cl_attr</a> *attr);
<a name="l00361"></a>00361         int (*<a class="code" href="structcl__object__operations.html#add30d6bf56d89a425b3980a1184558ab" title="Update attributes.">coo_attr_update</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l00362"></a>00362                                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__attr.html" title="&amp;quot;Data attributes&amp;quot; of cl_object.">cl_attr</a> *attr, <span class="keywordtype">unsigned</span> valid);
<a name="l00369"></a>00369         int (*<a class="code" href="structcl__object__operations.html#a88bd54845a2e896ffd7cc9c057572923" title="Update object configuration.">coo_conf_set</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l00370"></a>00370                             <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__object__conf.html" title="Description of the client object configuration.">cl_object_conf</a> *conf);
<a name="l00379"></a>00379         int (*<a class="code" href="structcl__object__operations.html#a1cacda5692e51d04da73eed3fdbf37c6" title="Glimpse ast.">coo_glimpse</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00380"></a>00380                            <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj, <span class="keyword">struct </span><a class="code" href="structost__lvb.html">ost_lvb</a> *lvb);
<a name="l00386"></a>00386         int (*<a class="code" href="structcl__object__operations.html#ae9470df7237ccbd5dec57b38ceb67015" title="Object prune method.">coo_prune</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj);
<a name="l00390"></a>00390         int (*<a class="code" href="structcl__object__operations.html#a2b8dec58886703a63ae318cf4e34137f" title="Object getstripe method.">coo_getstripe</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l00391"></a>00391                              <span class="keyword">struct </span><a class="code" href="group__lustreuser.html#ga9c004c151be5b9c6f1886530cbd17136">lov_user_md</a> __user *lum);
<a name="l00395"></a>00395         int (*<a class="code" href="structcl__object__operations.html#ab2deed25a532503a0b8a2b5ba9e48479" title="Get FIEMAP mapping from the object.">coo_fiemap</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l00396"></a>00396                           <span class="keyword">struct </span><a class="code" href="structll__fiemap__info__key.html">ll_fiemap_info_key</a> *fmkey,
<a name="l00397"></a>00397                           <span class="keyword">struct </span>fiemap *fiemap, <span class="keywordtype">size_t</span> *buflen);
<a name="l00401"></a>00401         int (*<a class="code" href="structcl__object__operations.html#a4a286454405198270e0675386b806a10" title="Get layout and generation of the object.">coo_layout_get</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l00402"></a>00402                               <span class="keyword">struct </span><a class="code" href="structcl__layout.html">cl_layout</a> *layout);
<a name="l00406"></a>00406         loff_t (*<a class="code" href="structcl__object__operations.html#ab8023e91e539a9a2661fd0744df80997" title="Get maximum size of the object.">coo_maxbytes</a>)(<span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj);
<a name="l00410"></a>00410         void (*<a class="code" href="structcl__object__operations.html#ac4285e5c1c552110704ba50cce4d326c" title="Set request attributes.">coo_req_attr_set</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00411"></a>00411                                  <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l00412"></a>00412                                  <span class="keyword">struct </span><a class="code" href="structcl__req__attr.html" title="Per-transfer attributes.">cl_req_attr</a> *attr);
<a name="l00413"></a>00413 };
<a name="l00414"></a>00414 
<a name="l00418"></a><a class="code" href="structcl__object__header.html">00418</a> <span class="keyword">struct </span><a class="code" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a> {
<a name="l00421"></a><a class="code" href="structcl__object__header.html#ae1f6b59740d6bf9e0bbc6d8786fbc677">00421</a>         <span class="keyword">struct </span><a class="code" href="structlu__object__header.html" title="&amp;quot;Compound&amp;quot; object, consisting of multiple layers.">lu_object_header</a> <a class="code" href="structcl__object__header.html#ae1f6b59740d6bf9e0bbc6d8786fbc677" title="Standard lu_object_header.">coh_lu</a>;
<a name="l00422"></a>00422 
<a name="l00430"></a><a class="code" href="structcl__object__header.html#a8c0f69348f6ae0a74edf0411d7f69d37">00430</a>         <span class="keyword">struct </span><a class="code" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a> *<a class="code" href="structcl__object__header.html#a8c0f69348f6ae0a74edf0411d7f69d37" title="Parent object.">coh_parent</a>;
<a name="l00438"></a><a class="code" href="structcl__object__header.html#a1d5bd74f8a1c9232bd97a3e5a6ded72a">00438</a>         spinlock_t               <a class="code" href="structcl__object__header.html#a1d5bd74f8a1c9232bd97a3e5a6ded72a" title="Protects consistency between cl_attr of parent object and attributes of sub-objects...">coh_attr_guard</a>;
<a name="l00442"></a><a class="code" href="structcl__object__header.html#a96304c00b1664392845e45ee00d20c0e">00442</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           <a class="code" href="structcl__object__header.html#a96304c00b1664392845e45ee00d20c0e" title="Size of cl_page + page slices.">coh_page_bufsize</a>;
<a name="l00447"></a><a class="code" href="structcl__object__header.html#a95a12664d0264672d2a5d3a1952eb9b8">00447</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>            <a class="code" href="structcl__object__header.html#a95a12664d0264672d2a5d3a1952eb9b8" title="Number of objects above this one: 0 for a top-object, 1 for its sub-object, etc.">coh_nesting</a>;
<a name="l00448"></a>00448 };
<a name="l00449"></a>00449 
<a name="l00454"></a><a class="code" href="group__cl__object.html#ga6477841d5f3bd9c2a2ca05e2aa089ea9">00454</a> <span class="preprocessor">#define cl_object_for_each(slice, obj)                          \</span>
<a name="l00455"></a>00455 <span class="preprocessor">        list_for_each_entry((slice),                            \</span>
<a name="l00456"></a>00456 <span class="preprocessor">                            &amp;(obj)-&gt;co_lu.lo_header-&gt;loh_layers,\</span>
<a name="l00457"></a>00457 <span class="preprocessor">                            co_lu.lo_linkage)</span>
<a name="l00458"></a>00458 <span class="preprocessor"></span>
<a name="l00463"></a><a class="code" href="group__cl__object.html#gade758968f8d058a2849df2f8f3e70762">00463</a> <span class="preprocessor">#define cl_object_for_each_reverse(slice, obj)                          \</span>
<a name="l00464"></a>00464 <span class="preprocessor">        list_for_each_entry_reverse((slice),                            \</span>
<a name="l00465"></a>00465 <span class="preprocessor">                                    &amp;(obj)-&gt;co_lu.lo_header-&gt;loh_layers,\</span>
<a name="l00466"></a>00466 <span class="preprocessor">                                    co_lu.lo_linkage)</span>
<a name="l00467"></a>00467 <span class="preprocessor"></span>
<a name="l00470"></a><a class="code" href="group__clio.html#gafe652221af494d72225936c18562922f">00470</a> <span class="preprocessor">#define CL_PAGE_EOF ((pgoff_t)~0ull)</span>
<a name="l00471"></a>00471 <span class="preprocessor"></span>
<a name="l00594"></a><a class="code" href="group__cl__page.html#ga762f808d1d3ac30a12a132d0344f1f39">00594</a> <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga762f808d1d3ac30a12a132d0344f1f39" title="States of cl_page.">cl_page_state</a> {
<a name="l00611"></a><a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39a820b29d9f4041d5672898ba94a52a7ba">00611</a>         <a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39a820b29d9f4041d5672898ba94a52a7ba" title="Page is in the cache, un-owned.">CPS_CACHED</a>,
<a name="l00640"></a><a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39ac64ebd72495a45cc57902f32131deee9">00640</a>         <a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39ac64ebd72495a45cc57902f32131deee9" title="Page is exclusively owned by some cl_io.">CPS_OWNED</a>,
<a name="l00668"></a><a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39a5508b13b7d061f6806482dbb1c20d9e4">00668</a>         <a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39a5508b13b7d061f6806482dbb1c20d9e4" title="Page is being written out, as a part of a transfer.">CPS_PAGEOUT</a>,
<a name="l00680"></a><a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39a23d1b66d4877127e29434eb39ee1b998">00680</a>         <a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39a23d1b66d4877127e29434eb39ee1b998" title="Page is being read in, as a part of a transfer.">CPS_PAGEIN</a>,
<a name="l00690"></a><a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39a77531f34ed93e3ddd0ab7c013cdd87d8">00690</a>         <a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39a77531f34ed93e3ddd0ab7c013cdd87d8" title="Page is being destroyed.">CPS_FREEING</a>,
<a name="l00691"></a><a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39ae97a053a1e380f19d44c5c2f94e44f3c">00691</a>         <a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39ae97a053a1e380f19d44c5c2f94e44f3c">CPS_NR</a>
<a name="l00692"></a>00692 };
<a name="l00693"></a>00693 
<a name="l00694"></a><a class="code" href="group__cl__page.html#ga04ed60b0572c2fcfa6c2590aac97f92d">00694</a> <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga04ed60b0572c2fcfa6c2590aac97f92d">cl_page_type</a> {
<a name="l00697"></a><a class="code" href="group__cl__page.html#gga04ed60b0572c2fcfa6c2590aac97f92da241d19f60653ebad43a9cdd3eb5af936">00697</a>         <a class="code" href="group__cl__page.html#gga04ed60b0572c2fcfa6c2590aac97f92da241d19f60653ebad43a9cdd3eb5af936" title="Host page, the page is from the host inode which the cl_page belongs to.">CPT_CACHEABLE</a> = 1,
<a name="l00698"></a>00698 
<a name="l00702"></a><a class="code" href="group__cl__page.html#gga04ed60b0572c2fcfa6c2590aac97f92dacfb8e99cf8a8fdf6b00ffeb86a9cdb0d">00702</a>         <a class="code" href="group__cl__page.html#gga04ed60b0572c2fcfa6c2590aac97f92dacfb8e99cf8a8fdf6b00ffeb86a9cdb0d" title="Transient page, the transient cl_page is used to bind a cl_page to vmpage which is...">CPT_TRANSIENT</a>,
<a name="l00703"></a>00703 };
<a name="l00704"></a>00704 
<a name="l00714"></a><a class="code" href="structcl__page.html">00714</a> <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> {
<a name="l00716"></a><a class="code" href="structcl__page.html#a1dc94f624c3d567c7e870e75d0bd2954">00716</a>         atomic_t                 <a class="code" href="structcl__page.html#a1dc94f624c3d567c7e870e75d0bd2954" title="Reference counter.">cp_ref</a>;
<a name="l00718"></a><a class="code" href="structcl__page.html#aaf3ea4b65234c8ef58960233b82172b1">00718</a>         <span class="keywordtype">int</span>                      <a class="code" href="structcl__page.html#aaf3ea4b65234c8ef58960233b82172b1" title="Transfer error.">cp_error</a>;
<a name="l00720"></a><a class="code" href="structcl__page.html#aa26f7281959921dababe7892b869abb2">00720</a>         <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a>        *<a class="code" href="structcl__page.html#aa26f7281959921dababe7892b869abb2" title="An object this page is a part of.">cp_obj</a>;
<a name="l00722"></a><a class="code" href="structcl__page.html#a9a4e391a7b741652812a451580176c9a">00722</a>         <span class="keyword">struct </span>page             *<a class="code" href="structcl__page.html#a9a4e391a7b741652812a451580176c9a" title="vmpage">cp_vmpage</a>;
<a name="l00724"></a><a class="code" href="structcl__page.html#a728db31646edabc4ff8c8cfc3f30f10f">00724</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>         <a class="code" href="structcl__page.html#a728db31646edabc4ff8c8cfc3f30f10f" title="Linkage of pages within group.">cp_batch</a>;
<a name="l00726"></a><a class="code" href="structcl__page.html#a96b574e5021d9b6464adac298980e594">00726</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>         <a class="code" href="structcl__page.html#a96b574e5021d9b6464adac298980e594" title="List of slices.">cp_layers</a>;
<a name="l00731"></a><a class="code" href="structcl__page.html#a96e9addda3754eb5551faaa00f94e903">00731</a>         <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga762f808d1d3ac30a12a132d0344f1f39" title="States of cl_page.">cl_page_state</a> <a class="code" href="structcl__page.html#a96e9addda3754eb5551faaa00f94e903" title="Page state.">cp_state</a>;
<a name="l00736"></a><a class="code" href="structcl__page.html#a5b1df421c69f4dd003decae6bfa71467">00736</a>         <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga04ed60b0572c2fcfa6c2590aac97f92d">cl_page_type</a>        <a class="code" href="structcl__page.html#a5b1df421c69f4dd003decae6bfa71467" title="Page type.">cp_type</a>;
<a name="l00737"></a>00737 
<a name="l00742"></a><a class="code" href="structcl__page.html#aa9fa7162c90de9f32abb3aa306c2112a">00742</a>         <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a>            *<a class="code" href="structcl__page.html#aa9fa7162c90de9f32abb3aa306c2112a" title="Owning IO in cl_page_state::CPS_OWNED state.">cp_owner</a>;
<a name="l00744"></a><a class="code" href="structcl__page.html#a6df94d2c121a8372ded94e0bf00d8c45">00744</a>         <span class="keyword">struct </span><a class="code" href="structlu__ref.html">lu_ref</a>            <a class="code" href="structcl__page.html#a6df94d2c121a8372ded94e0bf00d8c45" title="List of references to this page, for debugging.">cp_reference</a>;
<a name="l00746"></a><a class="code" href="structcl__page.html#a35d94ccfb7dfb16b315370024fea00cf">00746</a>         <span class="keyword">struct </span><a class="code" href="structlu__ref__link.html">lu_ref_link</a>       <a class="code" href="structcl__page.html#a35d94ccfb7dfb16b315370024fea00cf" title="Link to an object, for debugging.">cp_obj_ref</a>;
<a name="l00748"></a><a class="code" href="structcl__page.html#abfe411a851a9881cc9aca12ac6fcaf94">00748</a>         <span class="keyword">struct </span><a class="code" href="structlu__ref__link.html">lu_ref_link</a>       <a class="code" href="structcl__page.html#abfe411a851a9881cc9aca12ac6fcaf94" title="Link to a queue, for debugging.">cp_queue_ref</a>;
<a name="l00750"></a><a class="code" href="structcl__page.html#a9fee0561b08bf01258f9824f0c2b62d2">00750</a>         <span class="keyword">struct </span><a class="code" href="structcl__sync__io.html" title="Anchor for synchronous transfer.">cl_sync_io</a>       *<a class="code" href="structcl__page.html#a9fee0561b08bf01258f9824f0c2b62d2" title="Assigned if doing a sync_io.">cp_sync_io</a>;
<a name="l00751"></a>00751 };
<a name="l00752"></a>00752 
<a name="l00758"></a><a class="code" href="structcl__page__slice.html">00758</a> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> {
<a name="l00759"></a><a class="code" href="structcl__page__slice.html#a1c0b833d3d55ed4aff2470f5ab287506">00759</a>         <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a>                  *<a class="code" href="structcl__page__slice.html#a1c0b833d3d55ed4aff2470f5ab287506">cpl_page</a>;
<a name="l00760"></a><a class="code" href="structcl__page__slice.html#a2e71986589b5bb2a8da21818f907b46c">00760</a>         pgoff_t                          <a class="code" href="structcl__page__slice.html#a2e71986589b5bb2a8da21818f907b46c">cpl_index</a>;
<a name="l00765"></a><a class="code" href="structcl__page__slice.html#a71c54d2bf9c69b3a66df261412d0ba78">00765</a>         <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a>                *<a class="code" href="structcl__page__slice.html#a71c54d2bf9c69b3a66df261412d0ba78" title="Object slice corresponding to this page slice.">cpl_obj</a>;
<a name="l00766"></a><a class="code" href="structcl__page__slice.html#ae7dd48d5fb31bab9d8d9d6cd2df8d537">00766</a>         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__operations.html" title="Per-layer page operations.">cl_page_operations</a> *<a class="code" href="structcl__page__slice.html#ae7dd48d5fb31bab9d8d9d6cd2df8d537">cpl_ops</a>;
<a name="l00768"></a><a class="code" href="structcl__page__slice.html#a175a12bef0d16b36991be092737a92d1">00768</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                 <a class="code" href="structcl__page__slice.html#a175a12bef0d16b36991be092737a92d1" title="Linkage into cl_page::cp_layers.">cpl_linkage</a>;
<a name="l00769"></a>00769 };
<a name="l00770"></a>00770 
<a name="l00776"></a><a class="code" href="group__cl__lock.html#ga85e741e93c4ba0b8fd87206425e347a1">00776</a> <span class="keyword">enum</span> <a class="code" href="group__cl__lock.html#ga85e741e93c4ba0b8fd87206425e347a1" title="Lock mode.">cl_lock_mode</a> {
<a name="l00777"></a><a class="code" href="group__cl__lock.html#gga85e741e93c4ba0b8fd87206425e347a1afaf0c2a08e023e6c4bafbf758093b1d4">00777</a>         <a class="code" href="group__cl__lock.html#gga85e741e93c4ba0b8fd87206425e347a1afaf0c2a08e023e6c4bafbf758093b1d4">CLM_READ</a>,
<a name="l00778"></a><a class="code" href="group__cl__lock.html#gga85e741e93c4ba0b8fd87206425e347a1acf7d9afdb41a33222d042680cd268179">00778</a>         <a class="code" href="group__cl__lock.html#gga85e741e93c4ba0b8fd87206425e347a1acf7d9afdb41a33222d042680cd268179">CLM_WRITE</a>,
<a name="l00779"></a><a class="code" href="group__cl__lock.html#gga85e741e93c4ba0b8fd87206425e347a1a9216706e47555f5dcf27d23513323e52">00779</a>         <a class="code" href="group__cl__lock.html#gga85e741e93c4ba0b8fd87206425e347a1a9216706e47555f5dcf27d23513323e52">CLM_GROUP</a>,
<a name="l00780"></a><a class="code" href="group__cl__lock.html#gga85e741e93c4ba0b8fd87206425e347a1a883af2aa9c32d858f479bd8e2fb36291">00780</a>         <a class="code" href="group__cl__lock.html#gga85e741e93c4ba0b8fd87206425e347a1a883af2aa9c32d858f479bd8e2fb36291">CLM_MAX</a>,
<a name="l00781"></a>00781 };
<a name="l00782"></a>00782 
<a name="l00786"></a><a class="code" href="group__cl__page.html#ga419215a2ca4eeab85983de8ca5a16a02">00786</a> <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga419215a2ca4eeab85983de8ca5a16a02" title="Requested transfer type.">cl_req_type</a> {
<a name="l00787"></a><a class="code" href="group__cl__page.html#gga419215a2ca4eeab85983de8ca5a16a02a58002573909284f81e9a573147c902f9">00787</a>         <a class="code" href="group__cl__page.html#gga419215a2ca4eeab85983de8ca5a16a02a58002573909284f81e9a573147c902f9">CRT_READ</a>,
<a name="l00788"></a><a class="code" href="group__cl__page.html#gga419215a2ca4eeab85983de8ca5a16a02a584acec1467164dff97b38ac9fd5829e">00788</a>         <a class="code" href="group__cl__page.html#gga419215a2ca4eeab85983de8ca5a16a02a584acec1467164dff97b38ac9fd5829e">CRT_WRITE</a>,
<a name="l00789"></a><a class="code" href="group__cl__page.html#gga419215a2ca4eeab85983de8ca5a16a02a521eb2b78ce2d57a85e84b1452597426">00789</a>         <a class="code" href="group__cl__page.html#gga419215a2ca4eeab85983de8ca5a16a02a521eb2b78ce2d57a85e84b1452597426">CRT_NR</a>
<a name="l00790"></a>00790 };
<a name="l00791"></a>00791 
<a name="l00801"></a><a class="code" href="structcl__page__operations.html">00801</a> <span class="keyword">struct </span><a class="code" href="structcl__page__operations.html" title="Per-layer page operations.">cl_page_operations</a> {
<a name="l00817"></a>00817         int  (*<a class="code" href="structcl__page__operations.html#afb6338fcddde30623c66ad280f8bff83" title="cl_page&amp;lt;-&amp;gt;struct page methods.">cpo_own</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00818"></a>00818                         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice,
<a name="l00819"></a>00819                         <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *<a class="code" href="structcl__page__operations.html#aefbdf5f91d4f9624e213bd8c1b9cf485" title="Request type dependent vector of operations.">io</a>, <span class="keywordtype">int</span> nonblock);
<a name="l00825"></a>00825         void (*<a class="code" href="structcl__page__operations.html#a4d11c1fa2d9422c18786f613c9221138" title="Called when ownership it yielded.">cpo_disown</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00826"></a>00826                            <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice, <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *<a class="code" href="structcl__page__operations.html#aefbdf5f91d4f9624e213bd8c1b9cf485" title="Request type dependent vector of operations.">io</a>);
<a name="l00834"></a>00834         void (*<a class="code" href="structcl__page__operations.html#a252f84a75b3822e0d7fb071f9b7bca85" title="Called for a page that is already &amp;quot;owned&amp;quot; by io from VM point of view.">cpo_assume</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00835"></a>00835                            <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice, <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *<a class="code" href="structcl__page__operations.html#aefbdf5f91d4f9624e213bd8c1b9cf485" title="Request type dependent vector of operations.">io</a>);
<a name="l00843"></a>00843         void (*<a class="code" href="structcl__page__operations.html#a0fa0c8be297c146cbcb8d57197f42505" title="Dual to cl_page_operations::cpo_assume().">cpo_unassume</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00844"></a>00844                              <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice,
<a name="l00845"></a>00845                              <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *<a class="code" href="structcl__page__operations.html#aefbdf5f91d4f9624e213bd8c1b9cf485" title="Request type dependent vector of operations.">io</a>);
<a name="l00852"></a>00852         void  (*<a class="code" href="structcl__page__operations.html#ad84c50cbd10e0aabbffd4c7d2fd15197" title="Announces whether the page contains valid data or not by uptodate.">cpo_export</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00853"></a>00853                             <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice, <span class="keywordtype">int</span> uptodate);
<a name="l00862"></a>00862         int (*<a class="code" href="structcl__page__operations.html#a25940fbc8d8db64c799404461f38dbaa" title="Checks whether underlying VM page is locked (in the suitable sense).">cpo_is_vmlocked</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00863"></a>00863                                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice);
<a name="l00874"></a>00874         void (*<a class="code" href="structcl__page__operations.html#a56791c4e1490f9df55b3e4f6fc83c845" title="Page destruction.">cpo_discard</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00875"></a>00875                             <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice,
<a name="l00876"></a>00876                             <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *<a class="code" href="structcl__page__operations.html#aefbdf5f91d4f9624e213bd8c1b9cf485" title="Request type dependent vector of operations.">io</a>);
<a name="l00884"></a>00884         void (*<a class="code" href="structcl__page__operations.html#a5c6692ed54cf2c677e7b8bd90b08a013" title="Called when page is removed from the cache, and is about to being destroyed.">cpo_delete</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00885"></a>00885                            <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice);
<a name="l00887"></a>00887         void (*<a class="code" href="structcl__page__operations.html#ac17fa4746c7d4698e944b3dc59514836" title="Destructor.">cpo_fini</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00888"></a>00888                          <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice);
<a name="l00894"></a>00894         int (*<a class="code" href="structcl__page__operations.html#a2ad2c255ac9556a954937b2dde91d8fe" title="Optional debugging helper.">cpo_print</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00895"></a>00895                          <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice,
<a name="l00896"></a>00896                          <span class="keywordtype">void</span> *cookie, <a class="code" href="group__lu.html#gac8ccca21472f6dc3ea91d73983740fdc" title="Type of &amp;quot;printer&amp;quot; function used by lu_object_operations::loo_object_print()...">lu_printer_t</a> p);
<a name="l00915"></a>00915         <span class="keyword">struct </span>{
<a name="l00926"></a>00926                 int  (*<a class="code" href="structcl__page__operations.html#a544c974f96094f81cfb62d875f26e492" title="Called when a page is submitted for a transfer as a part of cl_page_list.">cpo_prep</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00927"></a>00927                                  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice,
<a name="l00928"></a>00928                                  <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *<a class="code" href="structcl__page__operations.html#aefbdf5f91d4f9624e213bd8c1b9cf485" title="Request type dependent vector of operations.">io</a>);
<a name="l00941"></a>00941                 void (*<a class="code" href="structcl__page__operations.html#a10efe3c32edb23a4fb1f6b1af177bf95" title="Completion handler.">cpo_completion</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00942"></a>00942                                        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice,
<a name="l00943"></a>00943                                        <span class="keywordtype">int</span> ioret);
<a name="l00954"></a>00954                 int  (*<a class="code" href="structcl__page__operations.html#ac9f10051729d6cdc35868c30fcb81cea" title="Called when cached page is about to be added to the ptlrpc request as a part of req...">cpo_make_ready</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00955"></a>00955                                        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice);
<a name="l00956"></a>00956         } <a class="code" href="structcl__page__operations.html#aefbdf5f91d4f9624e213bd8c1b9cf485" title="Request type dependent vector of operations.">io</a>[<a class="code" href="group__cl__page.html#gga419215a2ca4eeab85983de8ca5a16a02a521eb2b78ce2d57a85e84b1452597426">CRT_NR</a>];
<a name="l00970"></a>00970         void (*<a class="code" href="structcl__page__operations.html#aece03986dfa3b574ef3cc06ce36a830b" title="Tell transfer engine that only [to, from] part of a page should be transmitted.">cpo_clip</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00971"></a>00971                          <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice,
<a name="l00972"></a>00972                          <span class="keywordtype">int</span> from, <span class="keywordtype">int</span> to);
<a name="l00988"></a>00988         int (*<a class="code" href="structcl__page__operations.html#a2158a4b2c70af878b457dcb790c924f3">cpo_cancel</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00989"></a>00989                           <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice);
<a name="l00996"></a>00996         int (*<a class="code" href="structcl__page__operations.html#a0056ad7a02f61f50cfa8dc6362b1be44" title="Write out a page by kernel.">cpo_flush</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00997"></a>00997                          <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice,
<a name="l00998"></a>00998                          <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *<a class="code" href="structcl__page__operations.html#aefbdf5f91d4f9624e213bd8c1b9cf485" title="Request type dependent vector of operations.">io</a>);
<a name="l01000"></a>01000 };
<a name="l01001"></a>01001 
<a name="l01005"></a><a class="code" href="group__cl__page.html#ga912e7c9c7d73f184c724593eb42f857a">01005</a> <span class="preprocessor">#define CL_PAGE_DEBUG(mask, env, page, format, ...)                     \</span>
<a name="l01006"></a>01006 <span class="preprocessor">do {                                                                    \</span>
<a name="l01007"></a>01007 <span class="preprocessor">        if (cfs_cdebug_show(mask, DEBUG_SUBSYSTEM)) {                   \</span>
<a name="l01008"></a>01008 <span class="preprocessor">                LIBCFS_DEBUG_MSG_DATA_DECL(msgdata, mask, NULL);        \</span>
<a name="l01009"></a>01009 <span class="preprocessor">                cl_page_print(env, &amp;msgdata, lu_cdebug_printer, page);  \</span>
<a name="l01010"></a>01010 <span class="preprocessor">                CDEBUG(mask, format , ## __VA_ARGS__);                  \</span>
<a name="l01011"></a>01011 <span class="preprocessor">        }                                                               \</span>
<a name="l01012"></a>01012 <span class="preprocessor">} while (0)</span>
<a name="l01013"></a>01013 <span class="preprocessor"></span>
<a name="l01017"></a><a class="code" href="group__cl__page.html#gaeeca225390e016ad5bb7ab7ab31e3ab4">01017</a> <span class="preprocessor">#define CL_PAGE_HEADER(mask, env, page, format, ...)                          \</span>
<a name="l01018"></a>01018 <span class="preprocessor">do {                                                                          \</span>
<a name="l01019"></a>01019 <span class="preprocessor">        if (cfs_cdebug_show(mask, DEBUG_SUBSYSTEM)) {                         \</span>
<a name="l01020"></a>01020 <span class="preprocessor">                LIBCFS_DEBUG_MSG_DATA_DECL(msgdata, mask, NULL);              \</span>
<a name="l01021"></a>01021 <span class="preprocessor">                cl_page_header_print(env, &amp;msgdata, lu_cdebug_printer, page); \</span>
<a name="l01022"></a>01022 <span class="preprocessor">                CDEBUG(mask, format , ## __VA_ARGS__);                        \</span>
<a name="l01023"></a>01023 <span class="preprocessor">        }                                                                     \</span>
<a name="l01024"></a>01024 <span class="preprocessor">} while (0)</span>
<a name="l01025"></a>01025 <span class="preprocessor"></span>
<a name="l01026"></a><a class="code" href="group__cl__page.html#ga643f9383053507790b9c5a43cdfdb5bf">01026</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span>page *<a class="code" href="group__cl__page.html#ga643f9383053507790b9c5a43cdfdb5bf">cl_page_vmpage</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page)
<a name="l01027"></a>01027 {
<a name="l01028"></a>01028         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(page-&gt;<a class="code" href="structcl__page.html#a9a4e391a7b741652812a451580176c9a" title="vmpage">cp_vmpage</a> != NULL);
<a name="l01029"></a>01029         <span class="keywordflow">return</span> page-&gt;<a class="code" href="structcl__page.html#a9a4e391a7b741652812a451580176c9a" title="vmpage">cp_vmpage</a>;
<a name="l01030"></a>01030 }
<a name="l01031"></a>01031 
<a name="l01038"></a><a class="code" href="group__cl__page.html#gaec4e53fca3e674f91259ef8dfec297a1">01038</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="group__cl__page.html#gaec4e53fca3e674f91259ef8dfec297a1" title="Check if a cl_page is in use.">__page_in_use</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page, <span class="keywordtype">int</span> refc)
<a name="l01039"></a>01039 {
<a name="l01040"></a>01040         <span class="keywordflow">return</span> (atomic_read(&amp;page-&gt;<a class="code" href="structcl__page.html#a1dc94f624c3d567c7e870e75d0bd2954" title="Reference counter.">cp_ref</a>) &gt; refc + 1);
<a name="l01041"></a>01041 }
<a name="l01042"></a>01042 
<a name="l01046"></a><a class="code" href="group__cl__page.html#ga3f36ee0c41000fd2b189406ddfc160f1">01046</a> <span class="preprocessor">#define cl_page_in_use(pg)       __page_in_use(pg, 1)</span>
<a name="l01047"></a>01047 <span class="preprocessor"></span>
<a name="l01050"></a><a class="code" href="group__cl__page.html#gad3d3c2d56b9ba8a228c82c097258b596">01050</a> <span class="preprocessor">#define cl_page_in_use_noref(pg) __page_in_use(pg, 0)</span>
<a name="l01051"></a>01051 <span class="preprocessor"></span>
<a name="l01161"></a><a class="code" href="structcl__lock__descr.html">01161</a> <span class="keyword">struct </span><a class="code" href="structcl__lock__descr.html" title="Lock description.">cl_lock_descr</a> {
<a name="l01163"></a><a class="code" href="structcl__lock__descr.html#a4364f7ff8f5675436ccb006540452752">01163</a>         <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *<a class="code" href="structcl__lock__descr.html#a4364f7ff8f5675436ccb006540452752" title="Object this lock is granted for.">cld_obj</a>;
<a name="l01165"></a><a class="code" href="structcl__lock__descr.html#aafdf4a5ff7082bf16fee443e1fb0ba23">01165</a>         pgoff_t           <a class="code" href="structcl__lock__descr.html#aafdf4a5ff7082bf16fee443e1fb0ba23" title="Index of the first page protected by this lock.">cld_start</a>;
<a name="l01167"></a><a class="code" href="structcl__lock__descr.html#a36fdfb9057af6617dcb7ce622059bcf3">01167</a>         pgoff_t           <a class="code" href="structcl__lock__descr.html#a36fdfb9057af6617dcb7ce622059bcf3" title="Index of the last page (inclusive) protected by this lock.">cld_end</a>;
<a name="l01169"></a><a class="code" href="structcl__lock__descr.html#a9946758cc4db9583f64f9f98decc2e5c">01169</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>             <a class="code" href="structcl__lock__descr.html#a9946758cc4db9583f64f9f98decc2e5c" title="Group ID, for group lock.">cld_gid</a>;
<a name="l01171"></a><a class="code" href="structcl__lock__descr.html#a38822af64d2e66354d0a1aeea10b260c">01171</a>         <span class="keyword">enum</span> <a class="code" href="group__cl__lock.html#ga85e741e93c4ba0b8fd87206425e347a1" title="Lock mode.">cl_lock_mode</a> <a class="code" href="structcl__lock__descr.html#a38822af64d2e66354d0a1aeea10b260c" title="Lock mode.">cld_mode</a>;
<a name="l01176"></a><a class="code" href="structcl__lock__descr.html#a7e923c851e4a58e9e561a3b4e2d85a2e">01176</a>         __u32             <a class="code" href="structcl__lock__descr.html#a7e923c851e4a58e9e561a3b4e2d85a2e" title="flags to enqueue lock.">cld_enq_flags</a>;
<a name="l01177"></a>01177 };
<a name="l01178"></a>01178 
<a name="l01179"></a><a class="code" href="group__cl__lock.html#gaa48eed39677054974791fe8eacf7db52">01179</a> <span class="preprocessor">#define DDESCR &quot;%s(%d):[%lu, %lu]:%x&quot;</span>
<a name="l01180"></a><a class="code" href="group__cl__lock.html#ga207d24f359de64af33fe97e97dc08843">01180</a> <span class="preprocessor"></span><span class="preprocessor">#define PDESCR(descr)                                                   \</span>
<a name="l01181"></a>01181 <span class="preprocessor">        cl_lock_mode_name((descr)-&gt;cld_mode), (descr)-&gt;cld_mode,        \</span>
<a name="l01182"></a>01182 <span class="preprocessor">        (descr)-&gt;cld_start, (descr)-&gt;cld_end, (descr)-&gt;cld_enq_flags</span>
<a name="l01183"></a>01183 <span class="preprocessor"></span>
<a name="l01184"></a>01184 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__cl__lock.html#gaef00eb170071c4836742562b90e49750">cl_lock_mode_name</a>(<span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="group__cl__lock.html#ga85e741e93c4ba0b8fd87206425e347a1" title="Lock mode.">cl_lock_mode</a> <a class="code" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>);
<a name="l01185"></a>01185 
<a name="l01189"></a><a class="code" href="structcl__lock.html">01189</a> <span class="keyword">struct </span><a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a> {
<a name="l01191"></a><a class="code" href="structcl__lock.html#a0b01a26d3cefbee85d1c803a490b34e8">01191</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>      <a class="code" href="structcl__lock.html#a0b01a26d3cefbee85d1c803a490b34e8" title="List of slices.">cll_layers</a>;
<a name="l01193"></a><a class="code" href="structcl__lock.html#aed90f033b2853b070b0fabad04764d79">01193</a>         <span class="keyword">struct </span><a class="code" href="structcl__lock__descr.html" title="Lock description.">cl_lock_descr</a>  <a class="code" href="structcl__lock.html#aed90f033b2853b070b0fabad04764d79" title="lock attribute, extent, cl_object, etc.">cll_descr</a>;
<a name="l01194"></a>01194 };
<a name="l01195"></a>01195 
<a name="l01201"></a><a class="code" href="structcl__lock__slice.html">01201</a> <span class="keyword">struct </span><a class="code" href="structcl__lock__slice.html" title="Per-layer part of cl_lock.">cl_lock_slice</a> {
<a name="l01202"></a><a class="code" href="structcl__lock__slice.html#abd152a13b7a1df918805b47ac43113b3">01202</a>         <span class="keyword">struct </span><a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a>                  *<a class="code" href="structcl__lock__slice.html#abd152a13b7a1df918805b47ac43113b3">cls_lock</a>;
<a name="l01205"></a><a class="code" href="structcl__lock__slice.html#a7b92d10a7e81059bb811ba196a438d56">01205</a>         <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a>                *<a class="code" href="structcl__lock__slice.html#a7b92d10a7e81059bb811ba196a438d56" title="Object slice corresponding to this lock slice.">cls_obj</a>;
<a name="l01206"></a><a class="code" href="structcl__lock__slice.html#acf8f055c895f746f50fe19c4189defad">01206</a>         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__lock__operations.html">cl_lock_operations</a> *<a class="code" href="structcl__lock__slice.html#acf8f055c895f746f50fe19c4189defad">cls_ops</a>;
<a name="l01208"></a><a class="code" href="structcl__lock__slice.html#ade7bcd39b007dcafd05e98434e3ee990">01208</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                 <a class="code" href="structcl__lock__slice.html#ade7bcd39b007dcafd05e98434e3ee990" title="Linkage into cl_lock::cll_layers.">cls_linkage</a>;
<a name="l01209"></a>01209 };
<a name="l01210"></a>01210 
<a name="l01215"></a><a class="code" href="structcl__lock__operations.html">01215</a> <span class="keyword">struct </span><a class="code" href="structcl__lock__operations.html">cl_lock_operations</a> {
<a name="l01228"></a>01228         int  (*<a class="code" href="structcl__lock__operations.html#ac662a1c9135cac8c084a7c95d6fc19d7" title="Attempts to enqueue the lock.">clo_enqueue</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01229"></a>01229                             <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__lock__slice.html" title="Per-layer part of cl_lock.">cl_lock_slice</a> *slice,
<a name="l01230"></a>01230                             <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct </span><a class="code" href="structcl__sync__io.html" title="Anchor for synchronous transfer.">cl_sync_io</a> *anchor);
<a name="l01235"></a>01235         void (*<a class="code" href="structcl__lock__operations.html#adac391a682e572a776b39e552fa6e931" title="Cancel a lock, release its DLM lock ref, while does not cancel the DLM lock.">clo_cancel</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01236"></a>01236                            <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__lock__slice.html" title="Per-layer part of cl_lock.">cl_lock_slice</a> *slice);
<a name="l01244"></a>01244         void (*<a class="code" href="structcl__lock__operations.html#a4b649544378d50bf50bcb9c65d49795a" title="Destructor.">clo_fini</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structcl__lock__slice.html" title="Per-layer part of cl_lock.">cl_lock_slice</a> *slice);
<a name="l01248"></a>01248         int (*<a class="code" href="structcl__lock__operations.html#a0fddd0bb9b01d44087eec935c0a355ec" title="Optional debugging helper.">clo_print</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01249"></a>01249                          <span class="keywordtype">void</span> *cookie, <a class="code" href="group__lu.html#gac8ccca21472f6dc3ea91d73983740fdc" title="Type of &amp;quot;printer&amp;quot; function used by lu_object_operations::loo_object_print()...">lu_printer_t</a> p,
<a name="l01250"></a>01250                          <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__lock__slice.html" title="Per-layer part of cl_lock.">cl_lock_slice</a> *slice);
<a name="l01251"></a>01251 };
<a name="l01252"></a>01252 
<a name="l01253"></a><a class="code" href="group__cl__lock.html#ga81d354408ca5abbfe26fcd44665e7e23">01253</a> <span class="preprocessor">#define CL_LOCK_DEBUG(mask, env, lock, format, ...)                     \</span>
<a name="l01254"></a>01254 <span class="preprocessor">do {                                                                    \</span>
<a name="l01255"></a>01255 <span class="preprocessor">        if (cfs_cdebug_show(mask, DEBUG_SUBSYSTEM)) {                   \</span>
<a name="l01256"></a>01256 <span class="preprocessor">                LIBCFS_DEBUG_MSG_DATA_DECL(msgdata, mask, NULL);        \</span>
<a name="l01257"></a>01257 <span class="preprocessor">                cl_lock_print(env, &amp;msgdata, lu_cdebug_printer, lock);  \</span>
<a name="l01258"></a>01258 <span class="preprocessor">                CDEBUG(mask, format , ## __VA_ARGS__);                  \</span>
<a name="l01259"></a>01259 <span class="preprocessor">        }                                                               \</span>
<a name="l01260"></a>01260 <span class="preprocessor">} while (0)</span>
<a name="l01261"></a>01261 <span class="preprocessor"></span>
<a name="l01262"></a><a class="code" href="group__cl__lock.html#ga141b4ac98e80211e16e7866b193053ef">01262</a> <span class="preprocessor">#define CL_LOCK_ASSERT(expr, env, lock) do {                            \</span>
<a name="l01263"></a>01263 <span class="preprocessor">        if (likely(expr))                                               \</span>
<a name="l01264"></a>01264 <span class="preprocessor">                break;                                                  \</span>
<a name="l01265"></a>01265 <span class="preprocessor">                                                                        \</span>
<a name="l01266"></a>01266 <span class="preprocessor">        CL_LOCK_DEBUG(D_ERROR, env, lock, &quot;failed at %s.\n&quot;, #expr);    \</span>
<a name="l01267"></a>01267 <span class="preprocessor">        LBUG();                                                         \</span>
<a name="l01268"></a>01268 <span class="preprocessor">} while (0)</span>
<a name="l01269"></a>01269 <span class="preprocessor"></span>
<a name="l01291"></a><a class="code" href="structcl__page__list.html">01291</a> <span class="keyword">struct </span><a class="code" href="structcl__page__list.html">cl_page_list</a> {
<a name="l01292"></a><a class="code" href="structcl__page__list.html#ad3e0452cebfd450907df6f38fa99329e">01292</a>         <span class="keywordtype">unsigned</span>                 <a class="code" href="structcl__page__list.html#ad3e0452cebfd450907df6f38fa99329e">pl_nr</a>;
<a name="l01293"></a><a class="code" href="structcl__page__list.html#af3074454b87b71142c2f85ed0455df41">01293</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>         <a class="code" href="structcl__page__list.html#af3074454b87b71142c2f85ed0455df41">pl_pages</a>;
<a name="l01294"></a><a class="code" href="structcl__page__list.html#acd5156d099688bb4f99c0e5c50626cb3">01294</a>         <span class="keyword">struct </span>task_struct      *<a class="code" href="structcl__page__list.html#acd5156d099688bb4f99c0e5c50626cb3">pl_owner</a>;
<a name="l01295"></a>01295 };
<a name="l01296"></a>01296 
<a name="l01301"></a><a class="code" href="structcl__2queue.html">01301</a> <span class="keyword">struct </span><a class="code" href="structcl__2queue.html" title="A 2-queue of pages.">cl_2queue</a> {
<a name="l01302"></a><a class="code" href="structcl__2queue.html#aebe47a4af2f2ea338472738613efd362">01302</a>         <span class="keyword">struct </span><a class="code" href="structcl__page__list.html">cl_page_list</a> <a class="code" href="structcl__2queue.html#aebe47a4af2f2ea338472738613efd362">c2_qin</a>;
<a name="l01303"></a><a class="code" href="structcl__2queue.html#aa4f87f367e6667d008f6bcd801e42d09">01303</a>         <span class="keyword">struct </span><a class="code" href="structcl__page__list.html">cl_page_list</a> <a class="code" href="structcl__2queue.html#aa4f87f367e6667d008f6bcd801e42d09">c2_qout</a>;
<a name="l01304"></a>01304 };
<a name="l01305"></a>01305 
<a name="l01360"></a><a class="code" href="group__cl__io.html#ga7ce44ceebcd945560fa661571e3a4378">01360</a> <span class="keyword">enum</span> <a class="code" href="group__cl__io.html#ga7ce44ceebcd945560fa661571e3a4378" title="IO types.">cl_io_type</a> {
<a name="l01362"></a><a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378a30c0e746c178fe52f3c6f3939df1b2cb">01362</a>         <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378a30c0e746c178fe52f3c6f3939df1b2cb" title="read system call">CIT_READ</a>,
<a name="l01364"></a><a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378aa9c9f93ccf31c58b09085a8460ed1475">01364</a>         <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378aa9c9f93ccf31c58b09085a8460ed1475" title="write system call">CIT_WRITE</a>,
<a name="l01366"></a><a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378a0a7b38271be1f7d7faac2bfc3f8ce3a6">01366</a>         <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378a0a7b38271be1f7d7faac2bfc3f8ce3a6" title="truncate, utime system calls">CIT_SETATTR</a>,
<a name="l01368"></a><a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378ae0e5d488dc0faa7eca8a7ab4a48cbc25">01368</a>         <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378ae0e5d488dc0faa7eca8a7ab4a48cbc25" title="get data version">CIT_DATA_VERSION</a>,
<a name="l01372"></a><a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378af6dd7f3f5e03ad52c7f5a42d5fd03322">01372</a>         <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378af6dd7f3f5e03ad52c7f5a42d5fd03322" title="page fault handling">CIT_FAULT</a>,
<a name="l01377"></a><a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378a5e5f57a7ae1e41cc45aa7ec77eacf4b3">01377</a>         <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378a5e5f57a7ae1e41cc45aa7ec77eacf4b3" title="fsync system call handling To write out a range of file">CIT_FSYNC</a>,
<a name="l01397"></a><a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378ab21ff138f79ef4d41a40950879bf1e3c">01397</a>         <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378ab21ff138f79ef4d41a40950879bf1e3c" title="Miscellaneous io.">CIT_MISC</a>,
<a name="l01402"></a><a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378ad49f27c1cdc5be6e64ea32bcb4f16e8d">01402</a>         <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378ad49f27c1cdc5be6e64ea32bcb4f16e8d" title="ladvise handling To give advice about access of a file">CIT_LADVISE</a>,
<a name="l01403"></a><a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378a0b99cf78607418a7e0d5a1ebf5599baa">01403</a>         <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378a0b99cf78607418a7e0d5a1ebf5599baa">CIT_OP_NR</a>
<a name="l01404"></a>01404 };
<a name="l01405"></a>01405 
<a name="l01409"></a><a class="code" href="group__cl__io.html#ga31cc6886dbe550ea8576111ded9814f3">01409</a> <span class="keyword">enum</span> <a class="code" href="group__cl__io.html#ga31cc6886dbe550ea8576111ded9814f3" title="States of cl_io state machine.">cl_io_state</a> {
<a name="l01411"></a><a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3a533479241f38018af1651a483ca85b91">01411</a>         <a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3a533479241f38018af1651a483ca85b91" title="Not initialized.">CIS_ZERO</a>,
<a name="l01413"></a><a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3a009e9e287aa930cf2a8aa288afbbe134">01413</a>         <a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3a009e9e287aa930cf2a8aa288afbbe134" title="Initialized.">CIS_INIT</a>,
<a name="l01415"></a><a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3ad8aa8993a7b31bf97b878e8ad84b9154">01415</a>         <a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3ad8aa8993a7b31bf97b878e8ad84b9154" title="IO iteration started.">CIS_IT_STARTED</a>,
<a name="l01417"></a><a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3a7aaaa8f4b4ceebebb8004c39f786d2ba">01417</a>         <a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3a7aaaa8f4b4ceebebb8004c39f786d2ba" title="Locks taken.">CIS_LOCKED</a>,
<a name="l01419"></a><a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3ae890b65a3f8bcb1142724628e71c247a">01419</a>         <a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3ae890b65a3f8bcb1142724628e71c247a" title="Actual IO is in progress.">CIS_IO_GOING</a>,
<a name="l01421"></a><a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3a4c41fb95967777c249bd9b835a1e4a8e">01421</a>         <a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3a4c41fb95967777c249bd9b835a1e4a8e" title="IO for the current iteration finished.">CIS_IO_FINISHED</a>,
<a name="l01423"></a><a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3a3d421a3505fbc9098add0227c3e978c5">01423</a>         <a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3a3d421a3505fbc9098add0227c3e978c5" title="Locks released.">CIS_UNLOCKED</a>,
<a name="l01425"></a><a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3a4a452e3aadf68f37073952f26f59ecbe">01425</a>         <a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3a4a452e3aadf68f37073952f26f59ecbe" title="Iteration completed.">CIS_IT_ENDED</a>,
<a name="l01427"></a><a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3aeb38a1f10d1e0e66044bbfe4f40a20c0">01427</a>         <a class="code" href="group__cl__io.html#gga31cc6886dbe550ea8576111ded9814f3aeb38a1f10d1e0e66044bbfe4f40a20c0" title="cl_io finalized.">CIS_FINI</a>
<a name="l01428"></a>01428 };
<a name="l01429"></a>01429 
<a name="l01438"></a><a class="code" href="structcl__io__slice.html">01438</a> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> {
<a name="l01439"></a><a class="code" href="structcl__io__slice.html#abc3f4df47b63dde53be1d7cdfd6d007c">01439</a>         <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a>                    *<a class="code" href="structcl__io__slice.html#abc3f4df47b63dde53be1d7cdfd6d007c">cis_io</a>;
<a name="l01441"></a><a class="code" href="structcl__io__slice.html#a9f4d53548c52d6d9639819fd62557008">01441</a>         <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a>                *<a class="code" href="structcl__io__slice.html#a9f4d53548c52d6d9639819fd62557008" title="corresponding object slice.">cis_obj</a>;
<a name="l01443"></a><a class="code" href="structcl__io__slice.html#a18ddc4d2d844be0a28d5303ca1e79964">01443</a>         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__operations.html" title="Per-layer io operations.">cl_io_operations</a>   *<a class="code" href="structcl__io__slice.html#a18ddc4d2d844be0a28d5303ca1e79964" title="io operations.">cis_iop</a>;
<a name="l01448"></a><a class="code" href="structcl__io__slice.html#a14f89af8e28c08c0c20c1a157e7ec9e9">01448</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                <a class="code" href="structcl__io__slice.html#a14f89af8e28c08c0c20c1a157e7ec9e9" title="linkage into a list of all slices for a given cl_io, hanging off cl_io::ci_layers...">cis_linkage</a>;
<a name="l01449"></a>01449 };
<a name="l01450"></a>01450 
<a name="l01451"></a><a class="code" href="group__cl__io.html#ga54c4de6c969138d0642ef59a1ff5e0b0">01451</a> <span class="keyword">typedef</span> void (*<a class="code" href="group__cl__io.html#ga54c4de6c969138d0642ef59a1ff5e0b0">cl_commit_cbt</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *, <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *,
<a name="l01452"></a>01452                               <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *);
<a name="l01453"></a>01453 
<a name="l01454"></a><a class="code" href="structcl__read__ahead.html">01454</a> <span class="keyword">struct </span><a class="code" href="structcl__read__ahead.html">cl_read_ahead</a> {
<a name="l01455"></a>01455         <span class="comment">/* Maximum page index the readahead window will end.</span>
<a name="l01456"></a>01456 <span class="comment">         * This is determined DLM lock coverage, RPC and stripe boundary.</span>
<a name="l01457"></a>01457 <span class="comment">         * cra_end is included. */</span>
<a name="l01458"></a><a class="code" href="structcl__read__ahead.html#a5798ddb064c3f741a41e37745957ad87">01458</a>         pgoff_t <a class="code" href="structcl__read__ahead.html#a5798ddb064c3f741a41e37745957ad87">cra_end</a>;
<a name="l01459"></a>01459         <span class="comment">/* optimal RPC size for this read, by pages */</span>
<a name="l01460"></a><a class="code" href="structcl__read__ahead.html#aec11685937a085b4ec40cd5ede195fe6">01460</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structcl__read__ahead.html#aec11685937a085b4ec40cd5ede195fe6">cra_rpc_size</a>;
<a name="l01461"></a>01461         <span class="comment">/* Release callback. If readahead holds resources underneath, this</span>
<a name="l01462"></a>01462 <span class="comment">         * function should be called to release it. */</span>
<a name="l01463"></a>01463         void    (*<a class="code" href="structcl__read__ahead.html#a34949cd100be7cc45879d71c293d0356">cra_release</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keywordtype">void</span> *cbdata);
<a name="l01464"></a>01464         <span class="comment">/* Callback data for cra_release routine */</span>
<a name="l01465"></a><a class="code" href="structcl__read__ahead.html#a2a840a35e504992dd78b01efded989eb">01465</a>         <span class="keywordtype">void</span>    *<a class="code" href="structcl__read__ahead.html#a2a840a35e504992dd78b01efded989eb">cra_cbdata</a>;
<a name="l01466"></a>01466 };
<a name="l01467"></a>01467 
<a name="l01468"></a><a class="code" href="group__cl__io.html#ga1baea8a3fa79436133fe8e9dd42c7893">01468</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__cl__io.html#ga1baea8a3fa79436133fe8e9dd42c7893">cl_read_ahead_release</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01469"></a>01469                                          <span class="keyword">struct</span> <a class="code" href="structcl__read__ahead.html">cl_read_ahead</a> *ra)
<a name="l01470"></a>01470 {
<a name="l01471"></a>01471         <span class="keywordflow">if</span> (ra-&gt;<a class="code" href="structcl__read__ahead.html#a34949cd100be7cc45879d71c293d0356">cra_release</a> != NULL)
<a name="l01472"></a>01472                 ra-&gt;<a class="code" href="structcl__read__ahead.html#a34949cd100be7cc45879d71c293d0356">cra_release</a>(env, ra-&gt;<a class="code" href="structcl__read__ahead.html#a2a840a35e504992dd78b01efded989eb">cra_cbdata</a>);
<a name="l01473"></a>01473         memset(ra, 0, <span class="keyword">sizeof</span>(*ra));
<a name="l01474"></a>01474 }
<a name="l01475"></a>01475 
<a name="l01476"></a>01476 
<a name="l01481"></a><a class="code" href="structcl__io__operations.html">01481</a> <span class="keyword">struct </span><a class="code" href="structcl__io__operations.html" title="Per-layer io operations.">cl_io_operations</a> {
<a name="l01487"></a>01487         <span class="keyword">struct </span>{
<a name="l01497"></a>01497                 int (*<a class="code" href="structcl__io__operations.html#aeedb0fcc4555583225020c012c5b84e1" title="Prepare io iteration at a given layer.">cio_iter_init</a>) (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01498"></a>01498                                       <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice);
<a name="l01508"></a>01508                 void (*<a class="code" href="structcl__io__operations.html#a2c6f9fa7cecb546bd2b46156d57b10dd" title="Finalize io iteration.">cio_iter_fini</a>) (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01509"></a>01509                                        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice);
<a name="l01519"></a>01519                 int  (*<a class="code" href="structcl__io__operations.html#a4211dc9e2bf48da829c2fffd4633b1cf" title="Collect locks for the current iteration of io.">cio_lock</a>) (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01520"></a>01520                                   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice);
<a name="l01528"></a>01528                 void  (*<a class="code" href="structcl__io__operations.html#a8f4e4c71f42b1acdc2b935826d2a6e90" title="Finalize unlocking.">cio_unlock</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01529"></a>01529                                     <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice);
<a name="l01539"></a>01539                 int  (*<a class="code" href="structcl__io__operations.html#a29bbb031f049b8a1a5e54d575fa88209" title="Start io iteration.">cio_start</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01540"></a>01540                                   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice);
<a name="l01545"></a>01545                 void (*<a class="code" href="structcl__io__operations.html#a4d3dfb49a0fbf1f90b3de60841183d0a" title="Called top-to-bottom at the end of io loop.">cio_end</a>)  (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01546"></a>01546                                   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice);
<a name="l01551"></a>01551                 void (*<a class="code" href="structcl__io__operations.html#a32c79a8ffbf81724ef4df5c2fd05e263" title="Called bottom-to-top to notify layers that read/write IO iteration finished, with...">cio_advance</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01552"></a>01552                                     <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice,
<a name="l01553"></a>01553                                     <span class="keywordtype">size_t</span> nob);
<a name="l01557"></a>01557                 void (*<a class="code" href="structcl__io__operations.html#a09ecbd759c7a3569d67a75e9f201d1ba" title="Called once per io, bottom-to-top to release io resources.">cio_fini</a>) (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01558"></a>01558                                   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice);
<a name="l01559"></a>01559         } <a class="code" href="iam__ut_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>[<a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378a0b99cf78607418a7e0d5a1ebf5599baa">CIT_OP_NR</a>];
<a name="l01560"></a>01560 
<a name="l01569"></a>01569         int  (*<a class="code" href="structcl__io__operations.html#a2aa87d92a0f183a26ae076afc9b8b74f" title="Submit pages from queue-&amp;gt;c2_qin for IO, and move successfully submitted pages...">cio_submit</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01570"></a>01570                         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice,
<a name="l01571"></a>01571                         <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga419215a2ca4eeab85983de8ca5a16a02" title="Requested transfer type.">cl_req_type</a> crt,
<a name="l01572"></a>01572                         <span class="keyword">struct </span><a class="code" href="structcl__2queue.html" title="A 2-queue of pages.">cl_2queue</a> *queue);
<a name="l01578"></a>01578         int  (*<a class="code" href="structcl__io__operations.html#a1c88c4ec4901b77c0a32b3951f217f8c" title="Queue async page for write.">cio_commit_async</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01579"></a>01579                         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice,
<a name="l01580"></a>01580                         <span class="keyword">struct </span><a class="code" href="structcl__page__list.html">cl_page_list</a> *queue, <span class="keywordtype">int</span> from, <span class="keywordtype">int</span> to,
<a name="l01581"></a>01581                         <a class="code" href="group__cl__io.html#ga54c4de6c969138d0642ef59a1ff5e0b0">cl_commit_cbt</a> <a class="code" href="it__test_8c.html#a3edc96db5310d665bb056d7adc554a8f">cb</a>);
<a name="l01587"></a>01587         int (*<a class="code" href="structcl__io__operations.html#a4a7f6334b0e726f9c7fc52b8064a2613" title="Decide maximum read ahead extent.">cio_read_ahead</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01588"></a>01588                               <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice,
<a name="l01589"></a>01589                               pgoff_t <a class="code" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <span class="keyword">struct </span><a class="code" href="structcl__read__ahead.html">cl_read_ahead</a> *ra);
<a name="l01593"></a>01593         int (*<a class="code" href="structcl__io__operations.html#a4f9f80a35b71985f258a226cb32c91cf" title="Optional debugging helper.">cio_print</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keywordtype">void</span> *cookie,
<a name="l01594"></a>01594                          <a class="code" href="group__lu.html#gac8ccca21472f6dc3ea91d73983740fdc" title="Type of &amp;quot;printer&amp;quot; function used by lu_object_operations::loo_object_print()...">lu_printer_t</a> p, <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice);
<a name="l01595"></a>01595 };
<a name="l01596"></a>01596 
<a name="l01601"></a><a class="code" href="group__cl__lock.html#ga37f72b37baaeba18d9e0fac4560ec902">01601</a> <span class="keyword">enum</span> <a class="code" href="group__cl__lock.html#ga37f72b37baaeba18d9e0fac4560ec902" title="Flags to lock enqueue procedure.">cl_enq_flags</a> {
<a name="l01606"></a><a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a1562800e334f5cb2c074f41cc5b0bf1c">01606</a>         <a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a1562800e334f5cb2c074f41cc5b0bf1c" title="instruct server to not block, if conflicting lock is found.">CEF_NONBLOCK</a>     = 0x00000001,
<a name="l01611"></a><a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a432de84a3a6c92d385d1455be6b0272b">01611</a>         <a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a432de84a3a6c92d385d1455be6b0272b" title="take lock asynchronously (out of order), as it cannot deadlock.">CEF_ASYNC</a>        = 0x00000002,
<a name="l01617"></a><a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a2b96e0457cbff9ba9a8aa854009cf8da">01617</a>         <a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a2b96e0457cbff9ba9a8aa854009cf8da" title="tell the server to instruct (though a flag in the blocking ast) an owner of the conflicting...">CEF_DISCARD_DATA</a> = 0x00000004,
<a name="l01625"></a><a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902acf6cb6d67732370185bebac31ca6ef29">01625</a>         <a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902acf6cb6d67732370185bebac31ca6ef29" title="tell the sub layers that it must be a `real&amp;#39; lock.">CEF_MUST</a>         = 0x00000008,
<a name="l01636"></a><a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a0a16d738d6f6b4a50693501adc8e310d">01636</a>         <a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a0a16d738d6f6b4a50693501adc8e310d" title="tell the sub layers that never request a `real&amp;#39; lock.">CEF_NEVER</a>        = 0x00000010,
<a name="l01640"></a><a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a143ec61f815da4099f40d16b5e1b13d2">01640</a>         <a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a143ec61f815da4099f40d16b5e1b13d2" title="for async glimpse lock.">CEF_AGL</a>          = 0x00000020,
<a name="l01644"></a><a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a469f38a944b34de3f51d2f2964202604">01644</a>         <a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a469f38a944b34de3f51d2f2964202604" title="enqueue a lock to test DLM lock existence.">CEF_PEEK</a>        = 0x00000040,
<a name="l01649"></a><a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a61dce4cb6cb397ffffaf1c6d5d8608db">01649</a>         <a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a61dce4cb6cb397ffffaf1c6d5d8608db" title="Lock match only.">CEF_LOCK_MATCH</a>  = 0x00000080,
<a name="l01653"></a><a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a1a094fe2f0162ab8a02816903d804d97">01653</a>         <a class="code" href="group__cl__lock.html#gga37f72b37baaeba18d9e0fac4560ec902a1a094fe2f0162ab8a02816903d804d97" title="mask of enq_flags.">CEF_MASK</a>         = 0x000000ff,
<a name="l01654"></a>01654 };
<a name="l01655"></a>01655 
<a name="l01660"></a><a class="code" href="structcl__io__lock__link.html">01660</a> <span class="keyword">struct </span><a class="code" href="structcl__io__lock__link.html" title="Link between lock and io.">cl_io_lock_link</a> {
<a name="l01662"></a><a class="code" href="structcl__io__lock__link.html#a3df88f5b5efcfe0b936f66774d5a6fed">01662</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structcl__io__lock__link.html#a3df88f5b5efcfe0b936f66774d5a6fed" title="linkage into one of cl_lockset lists.">cill_linkage</a>;
<a name="l01663"></a><a class="code" href="structcl__io__lock__link.html#acd6826d0d2bc61dc89d3a67754674eb5">01663</a>         <span class="keyword">struct </span><a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a>          <a class="code" href="structcl__io__lock__link.html#acd6826d0d2bc61dc89d3a67754674eb5">cill_lock</a>;
<a name="l01665"></a>01665         void                    (*<a class="code" href="structcl__io__lock__link.html#aab4fd92e8e398d878829036d409df66f" title="optional destructor">cill_fini</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01666"></a>01666                                              <span class="keyword">struct </span><a class="code" href="structcl__io__lock__link.html" title="Link between lock and io.">cl_io_lock_link</a> *link);
<a name="l01667"></a>01667 };
<a name="l01668"></a><a class="code" href="group__cl__io.html#gad8a155eb56429b6d2ad9515eb4c4c5b5">01668</a> <span class="preprocessor">#define cill_descr      cill_lock.cll_descr</span>
<a name="l01669"></a>01669 <span class="preprocessor"></span>
<a name="l01699"></a><a class="code" href="structcl__lockset.html">01699</a> <span class="keyword">struct </span><a class="code" href="structcl__lockset.html" title="Lock-set represents a collection of locks, that io needs at a time.">cl_lockset</a> {
<a name="l01701"></a><a class="code" href="structcl__lockset.html#a7d3dd407c134313ebbcd663d9befe670">01701</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>  <a class="code" href="structcl__lockset.html#a7d3dd407c134313ebbcd663d9befe670" title="locks to be acquired.">cls_todo</a>;
<a name="l01703"></a><a class="code" href="structcl__lockset.html#a837f8683638d3e7b3ef9f38ee514c828">01703</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>  <a class="code" href="structcl__lockset.html#a837f8683638d3e7b3ef9f38ee514c828" title="locks acquired.">cls_done</a>;
<a name="l01704"></a>01704 };
<a name="l01705"></a>01705 
<a name="l01710"></a><a class="code" href="group__cl__io.html#gac7ff31ceda4789c9101711379ffe824b">01710</a> <span class="keyword">enum</span> <a class="code" href="group__cl__io.html#gac7ff31ceda4789c9101711379ffe824b" title="Lock requirements(demand) for IO.">cl_io_lock_dmd</a> {
<a name="l01712"></a><a class="code" href="group__cl__io.html#ggac7ff31ceda4789c9101711379ffe824ba4e46f767dce68b1f061c35ec1edc0528">01712</a>         <a class="code" href="group__cl__io.html#ggac7ff31ceda4789c9101711379ffe824ba4e46f767dce68b1f061c35ec1edc0528" title="Always lock data (e.g., O_APPEND).">CILR_MANDATORY</a> = 0,
<a name="l01714"></a><a class="code" href="group__cl__io.html#ggac7ff31ceda4789c9101711379ffe824bafc402749f67a87f7c2508998b1caec47">01714</a>         <a class="code" href="group__cl__io.html#ggac7ff31ceda4789c9101711379ffe824bafc402749f67a87f7c2508998b1caec47" title="Layers are free to decide between local and global locking.">CILR_MAYBE</a>,
<a name="l01716"></a><a class="code" href="group__cl__io.html#ggac7ff31ceda4789c9101711379ffe824bacfd43489ba9d674ad77c4bdd51d3a7bc">01716</a>         <a class="code" href="group__cl__io.html#ggac7ff31ceda4789c9101711379ffe824bacfd43489ba9d674ad77c4bdd51d3a7bc" title="Never lock: there is no cache (e.g., liblustre).">CILR_NEVER</a>
<a name="l01717"></a>01717 };
<a name="l01718"></a>01718 
<a name="l01719"></a><a class="code" href="group__cl__io.html#gabb7d5d07a2e68b82b9b13cac60256a7d">01719</a> <span class="keyword">enum</span> <a class="code" href="group__cl__io.html#gabb7d5d07a2e68b82b9b13cac60256a7d">cl_fsync_mode</a> {
<a name="l01721"></a><a class="code" href="group__cl__io.html#ggabb7d5d07a2e68b82b9b13cac60256a7da2efbba1b7d141493ec27186a908dfd02">01721</a>         <a class="code" href="group__cl__io.html#ggabb7d5d07a2e68b82b9b13cac60256a7da2efbba1b7d141493ec27186a908dfd02" title="start writeback, do not wait for them to finish">CL_FSYNC_NONE</a>  = 0,
<a name="l01723"></a><a class="code" href="group__cl__io.html#ggabb7d5d07a2e68b82b9b13cac60256a7da7421020b0252ff0989fd86dc2b3c2620">01723</a>         <a class="code" href="group__cl__io.html#ggabb7d5d07a2e68b82b9b13cac60256a7da7421020b0252ff0989fd86dc2b3c2620" title="start writeback and wait for them to finish">CL_FSYNC_LOCAL</a> = 1,
<a name="l01725"></a><a class="code" href="group__cl__io.html#ggabb7d5d07a2e68b82b9b13cac60256a7da26eec0d9c8b5fb4114c7841d531cd07e">01725</a>         <a class="code" href="group__cl__io.html#ggabb7d5d07a2e68b82b9b13cac60256a7da26eec0d9c8b5fb4114c7841d531cd07e" title="discard all of dirty pages in a specific file range">CL_FSYNC_DISCARD</a> = 2,
<a name="l01728"></a><a class="code" href="group__cl__io.html#ggabb7d5d07a2e68b82b9b13cac60256a7da1289d6fd8294a72b7d758fd5d5c1aa2e">01728</a>         <a class="code" href="group__cl__io.html#ggabb7d5d07a2e68b82b9b13cac60256a7da1289d6fd8294a72b7d758fd5d5c1aa2e" title="start writeback and make sure they have reached storage before return.">CL_FSYNC_ALL</a>   = 3
<a name="l01729"></a>01729 };
<a name="l01730"></a>01730 
<a name="l01731"></a><a class="code" href="structcl__io__rw__common.html">01731</a> <span class="keyword">struct </span><a class="code" href="structcl__io__rw__common.html">cl_io_rw_common</a> {
<a name="l01732"></a><a class="code" href="structcl__io__rw__common.html#ab26f1075c6f3b543ce4d5dc150ddb3a1">01732</a>         loff_t      <a class="code" href="structcl__io__rw__common.html#ab26f1075c6f3b543ce4d5dc150ddb3a1">crw_pos</a>;
<a name="l01733"></a><a class="code" href="structcl__io__rw__common.html#af24378d4ab416fe6705cdf3b4db6da93">01733</a>         <span class="keywordtype">size_t</span>      <a class="code" href="structcl__io__rw__common.html#af24378d4ab416fe6705cdf3b4db6da93">crw_count</a>;
<a name="l01734"></a><a class="code" href="structcl__io__rw__common.html#aba7d6e27ced262b0a84b5cd541faef48">01734</a>         <span class="keywordtype">int</span>         <a class="code" href="structcl__io__rw__common.html#aba7d6e27ced262b0a84b5cd541faef48">crw_nonblock</a>;
<a name="l01735"></a>01735 };
<a name="l01736"></a>01736 
<a name="l01746"></a><a class="code" href="structcl__io.html">01746</a> <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> {
<a name="l01748"></a><a class="code" href="structcl__io.html#ac02cd7b5e65d1d20d00de68de64d8b50">01748</a>         <span class="keyword">enum</span> <a class="code" href="group__cl__io.html#ga7ce44ceebcd945560fa661571e3a4378" title="IO types.">cl_io_type</a>                <a class="code" href="structcl__io.html#ac02cd7b5e65d1d20d00de68de64d8b50" title="type of this IO.">ci_type</a>;
<a name="l01750"></a><a class="code" href="structcl__io.html#a2d9112d04e0c51b82eb5b31eee94e984">01750</a>         <span class="keyword">enum</span> <a class="code" href="group__cl__io.html#ga31cc6886dbe550ea8576111ded9814f3" title="States of cl_io state machine.">cl_io_state</a>               <a class="code" href="structcl__io.html#a2d9112d04e0c51b82eb5b31eee94e984" title="current state of cl_io state machine.">ci_state</a>;
<a name="l01752"></a><a class="code" href="structcl__io.html#ab2758184445778d1acf0282ac0e6687b">01752</a>         <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a>              *<a class="code" href="structcl__io.html#ab2758184445778d1acf0282ac0e6687b" title="main object this io is against.">ci_obj</a>;
<a name="l01757"></a><a class="code" href="structcl__io.html#a0848dbd9565e8113af8636a8182f9e1d">01757</a>         <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a>                  *<a class="code" href="structcl__io.html#a0848dbd9565e8113af8636a8182f9e1d" title="Upper layer io, of which this io is a part of.">ci_parent</a>;
<a name="l01759"></a><a class="code" href="structcl__io.html#ab5a63aa434fec58687af4e284ab2392b">01759</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                <a class="code" href="structcl__io.html#ab5a63aa434fec58687af4e284ab2392b" title="List of slices.">ci_layers</a>;
<a name="l01761"></a><a class="code" href="structcl__io.html#a5e4726f4ed7b0cc829ca85342b383875">01761</a>         <span class="keyword">struct </span><a class="code" href="structcl__lockset.html" title="Lock-set represents a collection of locks, that io needs at a time.">cl_lockset</a>              <a class="code" href="structcl__io.html#a5e4726f4ed7b0cc829ca85342b383875" title="list of locks (to be) acquired by this io.">ci_lockset</a>;
<a name="l01763"></a><a class="code" href="structcl__io.html#a245a0c27f43614baa43128f2e82867fa">01763</a>         <span class="keyword">enum</span> <a class="code" href="group__cl__io.html#gac7ff31ceda4789c9101711379ffe824b" title="Lock requirements(demand) for IO.">cl_io_lock_dmd</a>            <a class="code" href="structcl__io.html#a245a0c27f43614baa43128f2e82867fa" title="lock requirements, this is just a help info for sublayers.">ci_lockreq</a>;
<a name="l01764"></a>01764         <span class="keyword">union </span>{
<a name="l01765"></a>01765                 <span class="keyword">struct </span>cl_rd_io {
<a name="l01766"></a><a class="code" href="structcl__io.html#ade3137e42dbe94aadb13987d58e1645f">01766</a>                         <span class="keyword">struct </span><a class="code" href="structcl__io__rw__common.html">cl_io_rw_common</a> <a class="code" href="structcl__io.html#ade3137e42dbe94aadb13987d58e1645f">rd</a>;
<a name="l01767"></a>01767                 } <a class="code" href="structcl__io.html#ad32610b7c3063f76dd15fc2a6c46d12d">ci_rd</a>;
<a name="l01768"></a>01768                 <span class="keyword">struct </span>cl_wr_io {
<a name="l01769"></a><a class="code" href="structcl__io.html#a896d135189a4cd7d48e9654728d6f0b9">01769</a>                         <span class="keyword">struct </span><a class="code" href="structcl__io__rw__common.html">cl_io_rw_common</a> <a class="code" href="structcl__io.html#a896d135189a4cd7d48e9654728d6f0b9">wr</a>;
<a name="l01770"></a><a class="code" href="structcl__io.html#ae2da4aaaf83db28ec002f25e67885773">01770</a>                         <span class="keywordtype">int</span>                    <a class="code" href="structcl__io.html#ae2da4aaaf83db28ec002f25e67885773">wr_append</a>;
<a name="l01771"></a><a class="code" href="structcl__io.html#a550b0417a5e9756f2dece1a3765ec3af">01771</a>                         <span class="keywordtype">int</span>                    <a class="code" href="structcl__io.html#a550b0417a5e9756f2dece1a3765ec3af">wr_sync</a>;
<a name="l01772"></a>01772                 } <a class="code" href="structcl__io.html#a60575f788129abb9beff0cb40bc3eb36">ci_wr</a>;
<a name="l01773"></a><a class="code" href="structcl__io.html#af169d766a52d3a74b080f712b0ec062a">01773</a>                 <span class="keyword">struct </span><a class="code" href="structcl__io__rw__common.html">cl_io_rw_common</a> <a class="code" href="structcl__io.html#af169d766a52d3a74b080f712b0ec062a">ci_rw</a>;
<a name="l01774"></a>01774                 <span class="keyword">struct </span>cl_setattr_io {
<a name="l01775"></a><a class="code" href="structcl__io.html#a0d2249876c3f97fd978758baee8f892f">01775</a>                         <span class="keyword">struct </span><a class="code" href="structost__lvb.html">ost_lvb</a>           <a class="code" href="structcl__io.html#a0d2249876c3f97fd978758baee8f892f">sa_attr</a>;
<a name="l01776"></a><a class="code" href="structcl__io.html#ab0f4ce1733a8e9b9fc64d174fc301eb9">01776</a>                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>             <a class="code" href="structcl__io.html#ab0f4ce1733a8e9b9fc64d174fc301eb9">sa_attr_flags</a>;
<a name="l01777"></a><a class="code" href="structcl__io.html#a1d893d57682d9e4252d40d94ec714d73">01777</a>                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>             <a class="code" href="structcl__io.html#a1d893d57682d9e4252d40d94ec714d73">sa_valid</a>;
<a name="l01778"></a><a class="code" href="structcl__io.html#ae3b930715026c0efdab7645a410bafea">01778</a>                         <span class="keywordtype">int</span>                      <a class="code" href="structcl__io.html#ae3b930715026c0efdab7645a410bafea">sa_stripe_index</a>;
<a name="l01779"></a><a class="code" href="structcl__io.html#adff2115f67dc92d96279f0e26a1c8cb8">01779</a>                         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>     *<a class="code" href="structcl__io.html#adff2115f67dc92d96279f0e26a1c8cb8">sa_parent_fid</a>;
<a name="l01780"></a>01780                 } <a class="code" href="structcl__io.html#add969c0bdeb6aada0869a2e9c45b406a">ci_setattr</a>;
<a name="l01781"></a>01781                 <span class="keyword">struct </span>cl_data_version_io {
<a name="l01782"></a><a class="code" href="structcl__io.html#a692a367a6172b91c4af94daa7c9facd3">01782</a>                         u64 <a class="code" href="structcl__io.html#a692a367a6172b91c4af94daa7c9facd3">dv_data_version</a>;
<a name="l01783"></a><a class="code" href="structcl__io.html#ac6bdd63e84d6c0e3490bd4d37b27257b">01783</a>                         <span class="keywordtype">int</span> <a class="code" href="structcl__io.html#ac6bdd63e84d6c0e3490bd4d37b27257b">dv_flags</a>;
<a name="l01784"></a>01784                 } <a class="code" href="structcl__io.html#a10f9e99cde8891be535075974b4552f2">ci_data_version</a>;
<a name="l01785"></a>01785                 <span class="keyword">struct </span>cl_fault_io {
<a name="l01787"></a><a class="code" href="structcl__io.html#a6dad5b14bbe77f890d7d4210374cda50">01787</a>                         pgoff_t         <a class="code" href="structcl__io.html#a6dad5b14bbe77f890d7d4210374cda50" title="page index within file.">ft_index</a>;
<a name="l01789"></a><a class="code" href="structcl__io.html#ac03a89a0a99f8add03531b91539ccf7a">01789</a>                         <span class="keywordtype">size_t</span>          <a class="code" href="structcl__io.html#ac03a89a0a99f8add03531b91539ccf7a" title="bytes valid byte on a faulted page.">ft_nob</a>;
<a name="l01791"></a><a class="code" href="structcl__io.html#a61a50c5e51a34e75c4b1c368f30c08d6">01791</a>                         <span class="keywordtype">int</span>             <a class="code" href="structcl__io.html#a61a50c5e51a34e75c4b1c368f30c08d6" title="writable page? for nopage() only">ft_writable</a>;
<a name="l01793"></a><a class="code" href="structcl__io.html#ab9173b5cfbf86839bd387693460add83">01793</a>                         <span class="keywordtype">int</span>             <a class="code" href="structcl__io.html#ab9173b5cfbf86839bd387693460add83" title="page of an executable?">ft_executable</a>;
<a name="l01795"></a><a class="code" href="structcl__io.html#a82ed099d6e0b24f256567b88996d3226">01795</a>                         <span class="keywordtype">int</span>             <a class="code" href="structcl__io.html#a82ed099d6e0b24f256567b88996d3226" title="page_mkwrite()">ft_mkwrite</a>;
<a name="l01797"></a><a class="code" href="structcl__io.html#a99cc27b69b3be1cd7810a5677193b86d">01797</a>                         <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *<a class="code" href="structcl__io.html#a99cc27b69b3be1cd7810a5677193b86d" title="resulting page">ft_page</a>;
<a name="l01798"></a>01798                 } <a class="code" href="structcl__io.html#a1a7759183426a4d21ab676823e0a8a11">ci_fault</a>;
<a name="l01799"></a>01799                 <span class="keyword">struct </span>cl_fsync_io {
<a name="l01800"></a><a class="code" href="structcl__io.html#acff8a1d001067e5fa900e3ace7e69c41">01800</a>                         loff_t             <a class="code" href="structcl__io.html#acff8a1d001067e5fa900e3ace7e69c41">fi_start</a>;
<a name="l01801"></a><a class="code" href="structcl__io.html#a8a67adc176879f4b56cb98568ea5f807">01801</a>                         loff_t             <a class="code" href="structcl__io.html#a8a67adc176879f4b56cb98568ea5f807">fi_end</a>;
<a name="l01803"></a><a class="code" href="structcl__io.html#ab040646a84568983168f1a6286a86d30">01803</a>                         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>     *<a class="code" href="structcl__io.html#ab040646a84568983168f1a6286a86d30" title="file system level fid">fi_fid</a>;
<a name="l01804"></a><a class="code" href="structcl__io.html#a0222ffbd9d0d397068258a3455db331d">01804</a>                         <span class="keyword">enum</span> <a class="code" href="group__cl__io.html#gabb7d5d07a2e68b82b9b13cac60256a7d">cl_fsync_mode</a> <a class="code" href="structcl__io.html#a0222ffbd9d0d397068258a3455db331d">fi_mode</a>;
<a name="l01805"></a>01805                         <span class="comment">/* how many pages were written/discarded */</span>
<a name="l01806"></a><a class="code" href="structcl__io.html#aef085884640cb236456b825ad9cc42fa">01806</a>                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>       <a class="code" href="structcl__io.html#aef085884640cb236456b825ad9cc42fa">fi_nr_written</a>;
<a name="l01807"></a>01807                 } <a class="code" href="structcl__io.html#a2f7294640051b726b4ff0d1dbfb51298">ci_fsync</a>;
<a name="l01808"></a>01808                 <span class="keyword">struct </span>cl_ladvise_io {
<a name="l01809"></a><a class="code" href="structcl__io.html#a4e0652e863476c21e983b192cab0fbd5">01809</a>                         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                    <a class="code" href="structcl__io.html#a4e0652e863476c21e983b192cab0fbd5">li_start</a>;
<a name="l01810"></a><a class="code" href="structcl__io.html#a9621452a16bc96ec8448163dd186b6cf">01810</a>                         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                    <a class="code" href="structcl__io.html#a9621452a16bc96ec8448163dd186b6cf">li_end</a>;
<a name="l01812"></a><a class="code" href="structcl__io.html#ab832010f18633ae9b640d94f01111649">01812</a>                         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>           *<a class="code" href="structcl__io.html#ab832010f18633ae9b640d94f01111649" title="file system level fid">li_fid</a>;
<a name="l01813"></a><a class="code" href="structcl__io.html#a7733e20a4f3387c7116a24d599e50dad">01813</a>                         <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga6800d248c7e9177fa2705d90cb97c86f">lu_ladvise_type</a>     <a class="code" href="structcl__io.html#a7733e20a4f3387c7116a24d599e50dad">li_advice</a>;
<a name="l01814"></a><a class="code" href="structcl__io.html#aeaff93a5a517586c031bb0282566676c">01814</a>                         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                    <a class="code" href="structcl__io.html#aeaff93a5a517586c031bb0282566676c">li_flags</a>;
<a name="l01815"></a>01815                 } <a class="code" href="structcl__io.html#abbad06003311557a8f2d3c825ae274f3">ci_ladvise</a>;
<a name="l01816"></a>01816         } <a class="code" href="structcl__io.html#a8b561db29f0b79fba4d14b66b9882530">u</a>;
<a name="l01817"></a><a class="code" href="structcl__io.html#a7c8a3389efac1b57226cb034a8224abe">01817</a>         <span class="keyword">struct </span><a class="code" href="structcl__2queue.html" title="A 2-queue of pages.">cl_2queue</a>     <a class="code" href="structcl__io.html#a7c8a3389efac1b57226cb034a8224abe">ci_queue</a>;
<a name="l01818"></a><a class="code" href="structcl__io.html#a3140355ba778fab0264dcbb4baad1583">01818</a>         <span class="keywordtype">size_t</span>               <a class="code" href="structcl__io.html#a3140355ba778fab0264dcbb4baad1583">ci_nob</a>;
<a name="l01819"></a><a class="code" href="structcl__io.html#a341b1b5f80fdf2cc9183fa7f4cec4df6">01819</a>         <span class="keywordtype">int</span>                  <a class="code" href="structcl__io.html#a341b1b5f80fdf2cc9183fa7f4cec4df6">ci_result</a>;
<a name="l01820"></a><a class="code" href="structcl__io.html#ac902e3a2f27fed9590e95769bbf93e71">01820</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>         <a class="code" href="structcl__io.html#a312266d038e148a30ba93b5d0c261b70">ci_continue</a>:1,
<a name="l01825"></a>01825                              <a class="code" href="structcl__io.html#a435468f51ab9aab5145e46b36c669376" title="This io has held grouplock, to inform sublayers that don&amp;#39;t do lockless i/o.">ci_no_srvlock</a>:1,
<a name="l01829"></a>01829                              <a class="code" href="structcl__io.html#a425b5ecdec17c901b3c8d8e09327d902" title="The whole IO need to be restarted because layout has been changed.">ci_need_restart</a>:1,
<a name="l01835"></a>01835                              <a class="code" href="structcl__io.html#a5d6c1c346a6203b03bf6fb768c6799da" title="to not refresh layout - the IO issuer knows that the layout won&amp;#39;t change(page...">ci_ignore_layout</a>:1,
<a name="l01843"></a>01843                              <a class="code" href="structcl__io.html#ac902e3a2f27fed9590e95769bbf93e71" title="Check if layout changed after the IO finishes.">ci_verify_layout</a>:1,
<a name="l01847"></a>01847                              <a class="code" href="structcl__io.html#acc9a415667fd8975f4be9645e816c2e2" title="file is released, restore has to to be triggered by vvp layer">ci_restore_needed</a>:1,
<a name="l01851"></a>01851                              <a class="code" href="structcl__io.html#a74a86e6e753e3df915972b23ba399196" title="O_NOATIME.">ci_noatime</a>:1;
<a name="l01855"></a><a class="code" href="structcl__io.html#ae86c9bd21f8243d5f18f88a1c057909a">01855</a>         <span class="keywordtype">unsigned</span>             <a class="code" href="structcl__io.html#ae86c9bd21f8243d5f18f88a1c057909a" title="Number of pages owned by this IO.">ci_owned_nr</a>;
<a name="l01856"></a>01856 };
<a name="l01857"></a>01857 
<a name="l01863"></a><a class="code" href="structcl__req__attr.html">01863</a> <span class="keyword">struct </span><a class="code" href="structcl__req__attr.html" title="Per-transfer attributes.">cl_req_attr</a> {
<a name="l01864"></a><a class="code" href="structcl__req__attr.html#a252b82c37cace30ac034adf334b6ced7">01864</a>         <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga419215a2ca4eeab85983de8ca5a16a02" title="Requested transfer type.">cl_req_type</a> <a class="code" href="structcl__req__attr.html#a252b82c37cace30ac034adf334b6ced7">cra_type</a>;
<a name="l01865"></a><a class="code" href="structcl__req__attr.html#a45d94041510b79a5f2ed3c272857feff">01865</a>         u64              <a class="code" href="structcl__req__attr.html#a45d94041510b79a5f2ed3c272857feff">cra_flags</a>;
<a name="l01866"></a><a class="code" href="structcl__req__attr.html#a7c0dd634671f56ffcb74f166093e6fbd">01866</a>         <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a>  *<a class="code" href="structcl__req__attr.html#a7c0dd634671f56ffcb74f166093e6fbd">cra_page</a>;
<a name="l01868"></a><a class="code" href="structcl__req__attr.html#aa496798a9d7619f762c2c41dc976a90e">01868</a>         <span class="keyword">struct </span><a class="code" href="structobdo.html">obdo</a>     *<a class="code" href="structcl__req__attr.html#aa496798a9d7619f762c2c41dc976a90e" title="Generic attributes for the server consumption.">cra_oa</a>;
<a name="l01870"></a><a class="code" href="structcl__req__attr.html#a93d5c51e8cf19ffc777828be441e708a">01870</a>         <span class="keywordtype">char</span>             <a class="code" href="structcl__req__attr.html#a93d5c51e8cf19ffc777828be441e708a" title="Jobid.">cra_jobid</a>[<a class="code" href="group__lustreuser.html#ga0c0d05b1c505aa119e08771fbc1f0f72">LUSTRE_JOBID_SIZE</a>];
<a name="l01871"></a>01871 };
<a name="l01872"></a>01872 
<a name="l01873"></a><a class="code" href="group__clio.html#gae65e5f5fa59d73bc289f6c6f6e566e52">01873</a> <span class="keyword">enum</span> <a class="code" href="group__clio.html#gae65e5f5fa59d73bc289f6c6f6e566e52">cache_stats_item</a> {
<a name="l01875"></a><a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52aa453d6bdec4a9c94fa728d9ece3a682e">01875</a>         <a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52aa453d6bdec4a9c94fa728d9ece3a682e" title="how many cache lookups were performed">CS_lookup</a> = 0,
<a name="l01877"></a><a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52af5a2cda59cd742b3182d202b1895f8d7">01877</a>         <a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52af5a2cda59cd742b3182d202b1895f8d7" title="how many times cache lookup resulted in a hit">CS_hit</a>,
<a name="l01879"></a><a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52a232ade650d55eb6e9554284682464b0b">01879</a>         <a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52a232ade650d55eb6e9554284682464b0b" title="how many entities are in the cache right now">CS_total</a>,
<a name="l01882"></a><a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52a344d449ca6a9a6d812f7019929fd8a03">01882</a>         <a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52a344d449ca6a9a6d812f7019929fd8a03" title="how many entities in the cache are actively used (and cannot be evicted) right now...">CS_busy</a>,
<a name="l01884"></a><a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52ae628f58c8c153c29328b6b5185bdff5a">01884</a>         <a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52ae628f58c8c153c29328b6b5185bdff5a" title="how many entities were created at all">CS_create</a>,
<a name="l01885"></a><a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52a89fe91d03a1aea7ea6e972f9fe42d849">01885</a>         <a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52a89fe91d03a1aea7ea6e972f9fe42d849">CS_NR</a>
<a name="l01886"></a>01886 };
<a name="l01887"></a>01887 
<a name="l01888"></a><a class="code" href="group__clio.html#gab615588a450704f3b1c875ccfd9361de">01888</a> <span class="preprocessor">#define CS_NAMES { &quot;lookup&quot;, &quot;hit&quot;, &quot;total&quot;, &quot;busy&quot;, &quot;create&quot; }</span>
<a name="l01889"></a>01889 <span class="preprocessor"></span>
<a name="l01893"></a><a class="code" href="structcache__stats.html">01893</a> <span class="keyword">struct </span><a class="code" href="structcache__stats.html" title="Stats for a generic cache (similar to inode, lu_object, etc.">cache_stats</a> {
<a name="l01894"></a><a class="code" href="structcache__stats.html#a2e12fe08b6f29d5252640474fd8149ea">01894</a>         <span class="keyword">const</span> <span class="keywordtype">char</span>      *<a class="code" href="structcache__stats.html#a2e12fe08b6f29d5252640474fd8149ea">cs_name</a>;
<a name="l01895"></a><a class="code" href="structcache__stats.html#accb56ece05c639532135976f00046144">01895</a>         atomic_t        <a class="code" href="structcache__stats.html#accb56ece05c639532135976f00046144">cs_stats</a>[<a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52a89fe91d03a1aea7ea6e972f9fe42d849">CS_NR</a>];
<a name="l01896"></a>01896 };
<a name="l01897"></a>01897 
<a name="l01899"></a>01899 <span class="keywordtype">void</span> <a class="code" href="group__clio.html#ga1e4ceb0e1ebe73971d4b3e7f5efaad02" title="These are not exported so far.">cache_stats_init</a> (<span class="keyword">struct</span> <a class="code" href="structcache__stats.html" title="Stats for a generic cache (similar to inode, lu_object, etc.">cache_stats</a> *cs, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l01900"></a>01900 
<a name="l01906"></a><a class="code" href="structcl__site.html">01906</a> <span class="keyword">struct </span><a class="code" href="structcl__site.html" title="Client-side site.">cl_site</a> {
<a name="l01907"></a><a class="code" href="structcl__site.html#aa1ba932c6b5b208cd1ba1e1e07cf3125">01907</a>         <span class="keyword">struct </span><a class="code" href="structlu__site.html" title="lu_site is a &amp;quot;compartment&amp;quot; within which objects are unique, and LRU discipline...">lu_site</a>          <a class="code" href="structcl__site.html#aa1ba932c6b5b208cd1ba1e1e07cf3125">cs_lu</a>;
<a name="l01917"></a><a class="code" href="structcl__site.html#a2fb2d9347902b0a4662669665229e795">01917</a>         <span class="keyword">struct </span><a class="code" href="structcache__stats.html" title="Stats for a generic cache (similar to inode, lu_object, etc.">cache_stats</a>      <a class="code" href="structcl__site.html#a2fb2d9347902b0a4662669665229e795" title="Statistical counters.">cs_pages</a>;
<a name="l01918"></a><a class="code" href="structcl__site.html#af72b50bbf7aa76b8f71e6003e14aeb41">01918</a>         atomic_t                <a class="code" href="structcl__site.html#af72b50bbf7aa76b8f71e6003e14aeb41">cs_pages_state</a>[<a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39ae97a053a1e380f19d44c5c2f94e44f3c">CPS_NR</a>];
<a name="l01919"></a>01919 };
<a name="l01920"></a>01920 
<a name="l01921"></a>01921 <span class="keywordtype">int</span>  <a class="code" href="group__clio.html#ga57611e1e5715dc94dd0eb503a72a8b33" title="Initialize client site.">cl_site_init</a>(<span class="keyword">struct</span> <a class="code" href="structcl__site.html" title="Client-side site.">cl_site</a> *s, <span class="keyword">struct</span> <a class="code" href="structcl__device.html" title="Device in the client stack.">cl_device</a> *top);
<a name="l01922"></a>01922 <span class="keywordtype">void</span> <a class="code" href="group__clio.html#ga5384082c04872b0c11252ead509cdd7a" title="Finalize client site.">cl_site_fini</a>(<span class="keyword">struct</span> <a class="code" href="structcl__site.html" title="Client-side site.">cl_site</a> *s);
<a name="l01923"></a>01923 <span class="keywordtype">void</span> <a class="code" href="group__clio.html#ga0f3ca66265a771105086ea8d48cd814d" title="Finalize device stack by calling lu_stack_fini().">cl_stack_fini</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__device.html" title="Device in the client stack.">cl_device</a> *cl);
<a name="l01924"></a>01924 
<a name="l01929"></a>01929 <span class="keywordtype">int</span> <a class="code" href="group__clio.html#ga5898f38acc8064feb8aecae6b0cbffd4" title="Output client site statistical counters into a buffer.">cl_site_stats_print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__site.html" title="Client-side site.">cl_site</a> *site, <span class="keyword">struct</span> seq_file *m);
<a name="l01930"></a>01930 
<a name="l01938"></a><a class="code" href="group__clio.html#gab612cda4d5357f6688eb90f6d3eb3f9c">01938</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structcl__site.html" title="Client-side site.">cl_site</a> *<a class="code" href="group__clio.html#gab612cda4d5357f6688eb90f6d3eb3f9c">lu2cl_site</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__site.html" title="lu_site is a &amp;quot;compartment&amp;quot; within which objects are unique, and LRU discipline...">lu_site</a> *site)
<a name="l01939"></a>01939 {
<a name="l01940"></a>01940         <span class="keywordflow">return</span> container_of(site, <span class="keyword">struct</span> <a class="code" href="structcl__site.html" title="Client-side site.">cl_site</a>, <a class="code" href="structcl__site.html#aa1ba932c6b5b208cd1ba1e1e07cf3125">cs_lu</a>);
<a name="l01941"></a>01941 }
<a name="l01942"></a>01942 
<a name="l01943"></a><a class="code" href="group__clio.html#ga0bc86ec0f6618825413c723e59cb5fb9">01943</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structcl__device.html" title="Device in the client stack.">cl_device</a> *<a class="code" href="group__clio.html#ga0bc86ec0f6618825413c723e59cb5fb9">lu2cl_dev</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a> *d)
<a name="l01944"></a>01944 {
<a name="l01945"></a>01945         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d == NULL || IS_ERR(d) || <a class="code" href="group__lu.html#ga549516fd3e3c1594d2acc57b13fd0126">lu_device_is_cl</a>(d));
<a name="l01946"></a>01946         <span class="keywordflow">return</span> container_of0(d, <span class="keyword">struct</span> <a class="code" href="structcl__device.html" title="Device in the client stack.">cl_device</a>, <a class="code" href="structcl__device.html#a881ea223a07828242f8c3b02f65792db" title="Super-class.">cd_lu_dev</a>);
<a name="l01947"></a>01947 }
<a name="l01948"></a>01948 
<a name="l01949"></a><a class="code" href="group__clio.html#ga6d0133d233b70dc158000a523dce686c">01949</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a> *<a class="code" href="group__clio.html#ga6d0133d233b70dc158000a523dce686c">cl2lu_dev</a>(<span class="keyword">struct</span> <a class="code" href="structcl__device.html" title="Device in the client stack.">cl_device</a> *d)
<a name="l01950"></a>01950 {
<a name="l01951"></a>01951         <span class="keywordflow">return</span> &amp;d-&gt;<a class="code" href="structcl__device.html#a881ea223a07828242f8c3b02f65792db" title="Super-class.">cd_lu_dev</a>;
<a name="l01952"></a>01952 }
<a name="l01953"></a>01953 
<a name="l01954"></a><a class="code" href="group__clio.html#ga1ae4d5000c0a29753ade60344f1a540e">01954</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *<a class="code" href="group__clio.html#ga1ae4d5000c0a29753ade60344f1a540e">lu2cl</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__object.html" title="Layer in the layered object.">lu_object</a> *o)
<a name="l01955"></a>01955 {
<a name="l01956"></a>01956         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(o == NULL || IS_ERR(o) || <a class="code" href="group__lu.html#ga549516fd3e3c1594d2acc57b13fd0126">lu_device_is_cl</a>(o-&gt;<a class="code" href="structlu__object.html#a5b9108a283d9901c95bdf32833f70601" title="Device for this layer.">lo_dev</a>));
<a name="l01957"></a>01957         <span class="keywordflow">return</span> container_of0(o, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a>, <a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>);
<a name="l01958"></a>01958 }
<a name="l01959"></a>01959 
<a name="l01960"></a>01960 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__object__conf.html" title="Description of the client object configuration.">cl_object_conf</a> *
<a name="l01961"></a><a class="code" href="group__clio.html#gaf4a9986b1c729e89e3506d13224661e7">01961</a> <a class="code" href="group__clio.html#gaf4a9986b1c729e89e3506d13224661e7">lu2cl_conf</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__object__conf.html" title="Object configuration, describing particulars of object being created.">lu_object_conf</a> *conf)
<a name="l01962"></a>01962 {
<a name="l01963"></a>01963         <span class="keywordflow">return</span> container_of0(conf, <span class="keyword">struct</span> <a class="code" href="structcl__object__conf.html" title="Description of the client object configuration.">cl_object_conf</a>, <a class="code" href="structcl__object__conf.html#a2dae6350547faf461529cfa61811385c" title="Super-class.">coc_lu</a>);
<a name="l01964"></a>01964 }
<a name="l01965"></a>01965 
<a name="l01966"></a><a class="code" href="group__clio.html#gab66ce6af7ff216c484f3b18981f5132e">01966</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *<a class="code" href="group__clio.html#gab66ce6af7ff216c484f3b18981f5132e">cl_object_next</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj)
<a name="l01967"></a>01967 {
<a name="l01968"></a>01968         <span class="keywordflow">return</span> obj ? <a class="code" href="group__clio.html#ga1ae4d5000c0a29753ade60344f1a540e">lu2cl</a>(<a class="code" href="group__lu.html#ga3e5cbde8881c8850b934b9c9af1d92ba" title="Next sub-object in the layering.">lu_object_next</a>(&amp;obj-&gt;<a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>)) : NULL;
<a name="l01969"></a>01969 }
<a name="l01970"></a>01970 
<a name="l01971"></a><a class="code" href="group__clio.html#gaf75b5461b478252267f126d01ad2c9d5">01971</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a> *<a class="code" href="group__clio.html#gaf75b5461b478252267f126d01ad2c9d5">luh2coh</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__object__header.html" title="&amp;quot;Compound&amp;quot; object, consisting of multiple layers.">lu_object_header</a> *h)
<a name="l01972"></a>01972 {
<a name="l01973"></a>01973         <span class="keywordflow">return</span> container_of0(h, <span class="keyword">struct</span> <a class="code" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a>, <a class="code" href="structcl__object__header.html#ae1f6b59740d6bf9e0bbc6d8786fbc677" title="Standard lu_object_header.">coh_lu</a>);
<a name="l01974"></a>01974 }
<a name="l01975"></a>01975 
<a name="l01976"></a><a class="code" href="group__clio.html#ga025ca53eaf1b4af418db0706d71b5db5">01976</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structcl__site.html" title="Client-side site.">cl_site</a> *<a class="code" href="group__clio.html#ga025ca53eaf1b4af418db0706d71b5db5">cl_object_site</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj)
<a name="l01977"></a>01977 {
<a name="l01978"></a>01978         <span class="keywordflow">return</span> <a class="code" href="group__clio.html#gab612cda4d5357f6688eb90f6d3eb3f9c">lu2cl_site</a>(obj-&gt;<a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>.<a class="code" href="structlu__object.html#a5b9108a283d9901c95bdf32833f70601" title="Device for this layer.">lo_dev</a>-&gt;<a class="code" href="structlu__device.html#aaa1ef1e1a330f307a9baf6e59fc9c39b" title="Stack this device belongs to.">ld_site</a>);
<a name="l01979"></a>01979 }
<a name="l01980"></a>01980 
<a name="l01981"></a>01981 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l01982"></a><a class="code" href="group__clio.html#gad17616130821a452cbc77936980c2170">01982</a> <span class="keyword">struct </span><a class="code" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a> *<a class="code" href="group__clio.html#gad17616130821a452cbc77936980c2170">cl_object_header</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj)
<a name="l01983"></a>01983 {
<a name="l01984"></a>01984         <span class="keywordflow">return</span> <a class="code" href="group__clio.html#gaf75b5461b478252267f126d01ad2c9d5">luh2coh</a>(obj-&gt;<a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>.<a class="code" href="structlu__object.html#ab55ad0889ad4d306d0a5aad7ed0aa398" title="Header for this object.">lo_header</a>);
<a name="l01985"></a>01985 }
<a name="l01986"></a>01986 
<a name="l01987"></a><a class="code" href="group__clio.html#ga6652d15262c9439bdab9802f6d4eefa8">01987</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__clio.html#ga6652d15262c9439bdab9802f6d4eefa8">cl_device_init</a>(<span class="keyword">struct</span> <a class="code" href="structcl__device.html" title="Device in the client stack.">cl_device</a> *d, <span class="keyword">struct</span> <a class="code" href="structlu__device__type.html" title="Type of device.">lu_device_type</a> *t)
<a name="l01988"></a>01988 {
<a name="l01989"></a>01989         <span class="keywordflow">return</span> <a class="code" href="group__lu.html#gae86081b11fb167137740f999abf11b2c" title="Initialize device d of type t.">lu_device_init</a>(&amp;d-&gt;<a class="code" href="structcl__device.html#a881ea223a07828242f8c3b02f65792db" title="Super-class.">cd_lu_dev</a>, t);
<a name="l01990"></a>01990 }
<a name="l01991"></a>01991 
<a name="l01992"></a><a class="code" href="group__clio.html#ga4ebf1f9e155daf82c914f39a85d48851">01992</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__clio.html#ga4ebf1f9e155daf82c914f39a85d48851">cl_device_fini</a>(<span class="keyword">struct</span> <a class="code" href="structcl__device.html" title="Device in the client stack.">cl_device</a> *d)
<a name="l01993"></a>01993 {
<a name="l01994"></a>01994         <a class="code" href="group__lu.html#ga7ed7dca0b6932c93db6be738aea16dff" title="Finalize device d.">lu_device_fini</a>(&amp;d-&gt;<a class="code" href="structcl__device.html#a881ea223a07828242f8c3b02f65792db" title="Super-class.">cd_lu_dev</a>);
<a name="l01995"></a>01995 }
<a name="l01996"></a>01996 
<a name="l01997"></a>01997 <span class="keywordtype">void</span> <a class="code" href="group__clio.html#gaf9c2b2723494e52efc66d52fe2d0b93f" title="Adds page slice to the compound page.">cl_page_slice_add</a>(<span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page, <span class="keyword">struct</span> <a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *slice,
<a name="l01998"></a>01998                        <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj, pgoff_t index,
<a name="l01999"></a>01999                        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__page__operations.html" title="Per-layer page operations.">cl_page_operations</a> *ops);
<a name="l02000"></a>02000 <span class="keywordtype">void</span> <a class="code" href="group__clio.html#ga9c2fdf8ae73a6f36bc8df4249459da93" title="Adds lock slice to the compound lock.">cl_lock_slice_add</a>(<span class="keyword">struct</span> <a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a> *lock, <span class="keyword">struct</span> <a class="code" href="structcl__lock__slice.html" title="Per-layer part of cl_lock.">cl_lock_slice</a> *slice,
<a name="l02001"></a>02001                        <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l02002"></a>02002                        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__lock__operations.html">cl_lock_operations</a> *ops);
<a name="l02003"></a>02003 <span class="keywordtype">void</span> <a class="code" href="group__clio.html#ga7f11d31070279077648197650a60f10e" title="Adds io slice to the cl_io.">cl_io_slice_add</a>(<span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__io__slice.html" title="IO state private for a layer.">cl_io_slice</a> *slice,
<a name="l02004"></a>02004                      <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__io__operations.html" title="Per-layer io operations.">cl_io_operations</a> *ops);
<a name="l02009"></a>02009 <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *<a class="code" href="group__cl__object.html#ga00ef0f7240b9a7d773a49a77c667f03a" title="Returns the top-object for a given o.">cl_object_top</a> (<span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *o);
<a name="l02010"></a>02010 <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *<a class="code" href="group__cl__object.html#gacc02a64c0c65d5fab9a6fafc83771acd" title="Returns a cl_object with a given fid.">cl_object_find</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__device.html" title="Device in the client stack.">cl_device</a> *cd,
<a name="l02011"></a>02011                                  <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid,
<a name="l02012"></a>02012                                  <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__object__conf.html" title="Description of the client object configuration.">cl_object_conf</a> *c);
<a name="l02013"></a>02013 
<a name="l02014"></a>02014 <span class="keywordtype">int</span>  <a class="code" href="group__cl__object.html#ga0e1e8f1e195acfd9ad600b33e8f183e7" title="Initialize cl_object_header.">cl_object_header_init</a>(<span class="keyword">struct</span> <a class="code" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a> *h);
<a name="l02015"></a>02015 <span class="keywordtype">void</span> <a class="code" href="group__cl__object.html#ga76b88e11955bc3109371ae6194189d25" title="Finalize cl_object_header.">cl_object_header_fini</a>(<span class="keyword">struct</span> <a class="code" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a> *h);
<a name="l02016"></a>02016 <span class="keywordtype">void</span> <a class="code" href="group__cl__object.html#ga61a377b8d6ccf182357c959cfdbbcf16" title="Releases a reference on o.">cl_object_put</a>        (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *o);
<a name="l02017"></a>02017 <span class="keywordtype">void</span> <a class="code" href="group__cl__object.html#gae84de86afc6e9dbf1f9e1a7219bd202b" title="Acquire an additional reference to the object o.">cl_object_get</a>        (<span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *o);
<a name="l02018"></a>02018 <span class="keywordtype">void</span> <a class="code" href="group__cl__object.html#ga0ab97a8a879d5a81b4b5d60367e0ff0a" title="Locks data-attributes.">cl_object_attr_lock</a>  (<span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *o);
<a name="l02019"></a>02019 <span class="keywordtype">void</span> <a class="code" href="group__cl__object.html#ga2fc69699a9214cda8ac2e8264b709dac" title="Releases data-attributes lock, acquired by cl_object_attr_lock().">cl_object_attr_unlock</a>(<span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *o);
<a name="l02020"></a>02020 <span class="keywordtype">int</span>  <a class="code" href="group__cl__object.html#gadfa2c03f781edcc53976843d94c18b48" title="Returns data-attributes of an object obj.">cl_object_attr_get</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l02021"></a>02021                         <span class="keyword">struct</span> <a class="code" href="structcl__attr.html" title="&amp;quot;Data attributes&amp;quot; of cl_object.">cl_attr</a> *attr);
<a name="l02022"></a>02022 <span class="keywordtype">int</span>  <a class="code" href="group__cl__object.html#gaaa4c4e2f092946a662c321e1aa7a4aab" title="Updates data-attributes of an object obj.">cl_object_attr_update</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l02023"></a>02023                            <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__attr.html" title="&amp;quot;Data attributes&amp;quot; of cl_object.">cl_attr</a> *attr, <span class="keywordtype">unsigned</span> valid);
<a name="l02024"></a>02024 <span class="keywordtype">int</span>  <a class="code" href="group__cl__object.html#gaeed557c8f4926f9d6492df7026fd4b13" title="Notifies layers (bottom-to-top) that glimpse AST was received.">cl_object_glimpse</a>    (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l02025"></a>02025                            <span class="keyword">struct</span> <a class="code" href="structost__lvb.html">ost_lvb</a> *lvb);
<a name="l02026"></a>02026 <span class="keywordtype">int</span>  <a class="code" href="group__cl__object.html#ga2e572a2e5a92e017e5d45187657e3f94" title="Updates a configuration of an object obj.">cl_conf_set</a>          (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l02027"></a>02027                            <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__object__conf.html" title="Description of the client object configuration.">cl_object_conf</a> *conf);
<a name="l02028"></a>02028 <span class="keywordtype">int</span>  <a class="code" href="group__cl__object.html#gacbefea6c611d782bb7ccfac4be7f3ec9" title="Prunes caches of pages and locks for this object.">cl_object_prune</a>      (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj);
<a name="l02029"></a>02029 <span class="keywordtype">void</span> <a class="code" href="group__cl__object.html#ga2969ac9d2e4cce406eb1bfa24838964f" title="Helper function removing all object locks, and marking object for deletion.">cl_object_kill</a>       (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj);
<a name="l02030"></a>02030 <span class="keywordtype">int</span> <a class="code" href="group__cl__object.html#ga746cc5d7737450ca64ba6997f3e9afd8" title="Get stripe information of this object.">cl_object_getstripe</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l02031"></a>02031                         <span class="keyword">struct</span> <a class="code" href="group__lustreuser.html#ga9c004c151be5b9c6f1886530cbd17136">lov_user_md</a> <a class="code" href="ioctl_8h.html#ace6f17999da4ea3b93c4227beafcab95">__user</a> *lum);
<a name="l02032"></a>02032 <span class="keywordtype">int</span> <a class="code" href="group__cl__object.html#gae661d62a9c4af07425119b1308c3ff61" title="Get fiemap extents from file object.">cl_object_fiemap</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l02033"></a>02033                      <span class="keyword">struct</span> <a class="code" href="structll__fiemap__info__key.html">ll_fiemap_info_key</a> *fmkey, <span class="keyword">struct</span> fiemap *fiemap,
<a name="l02034"></a>02034                      <span class="keywordtype">size_t</span> *buflen);
<a name="l02035"></a>02035 <span class="keywordtype">int</span> <a class="code" href="group__cl__object.html#gaed35f941df7b7d63305b33783313b235">cl_object_layout_get</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l02036"></a>02036                          <span class="keyword">struct</span> <a class="code" href="structcl__layout.html">cl_layout</a> *cl);
<a name="l02037"></a>02037 loff_t <a class="code" href="group__cl__object.html#gaa30ca80e8a50712e8ccf910be0bf0845">cl_object_maxbytes</a>(<span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj);
<a name="l02038"></a>02038 
<a name="l02042"></a><a class="code" href="group__cl__object.html#ga49a29b0baac53b37e4a7e7334c081c21">02042</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__cl__object.html#ga49a29b0baac53b37e4a7e7334c081c21" title="Returns true, iff o0 and o1 are slices of the same object.">cl_object_same</a>(<span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *o0, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *o1)
<a name="l02043"></a>02043 {
<a name="l02044"></a>02044         <span class="keywordflow">return</span> <a class="code" href="group__clio.html#gad17616130821a452cbc77936980c2170">cl_object_header</a>(o0) == <a class="code" href="group__clio.html#gad17616130821a452cbc77936980c2170">cl_object_header</a>(o1);
<a name="l02045"></a>02045 }
<a name="l02046"></a>02046 
<a name="l02047"></a><a class="code" href="group__cl__object.html#ga90d038bc9bf28000122750aa79e393b2">02047</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__cl__object.html#ga90d038bc9bf28000122750aa79e393b2">cl_object_page_init</a>(<span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *clob, <span class="keywordtype">int</span> <a class="code" href="lp__utils_8h.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)
<a name="l02048"></a>02048 {
<a name="l02049"></a>02049         clob-&gt;<a class="code" href="structcl__object.html#abd601ddb054aaa4a5b1c998b8f502e7a" title="offset of page slice in cl_page buffer">co_slice_off</a> = <a class="code" href="group__clio.html#gad17616130821a452cbc77936980c2170">cl_object_header</a>(clob)-&gt;<a class="code" href="structcl__object__header.html#a96304c00b1664392845e45ee00d20c0e" title="Size of cl_page + page slices.">coh_page_bufsize</a>;
<a name="l02050"></a>02050         <a class="code" href="group__clio.html#gad17616130821a452cbc77936980c2170">cl_object_header</a>(clob)-&gt;<a class="code" href="structcl__object__header.html#a96304c00b1664392845e45ee00d20c0e" title="Size of cl_page + page slices.">coh_page_bufsize</a> += <a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">cfs_size_round</a>(size);
<a name="l02051"></a>02051         WARN_ON(<a class="code" href="group__clio.html#gad17616130821a452cbc77936980c2170">cl_object_header</a>(clob)-&gt;coh_page_bufsize &gt; 512);
<a name="l02052"></a>02052 }
<a name="l02053"></a>02053 
<a name="l02054"></a><a class="code" href="group__cl__object.html#ga22b6cf3a62d106fcfb7bee291d22ff70">02054</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> *<a class="code" href="group__cl__object.html#ga22b6cf3a62d106fcfb7bee291d22ff70">cl_object_page_slice</a>(<span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *clob,
<a name="l02055"></a>02055                                          <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page)
<a name="l02056"></a>02056 {
<a name="l02057"></a>02057         <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)((<span class="keywordtype">char</span> *)page + clob-&gt;<a class="code" href="structcl__object.html#abd601ddb054aaa4a5b1c998b8f502e7a" title="offset of page slice in cl_page buffer">co_slice_off</a>);
<a name="l02058"></a>02058 }
<a name="l02059"></a>02059 
<a name="l02063"></a><a class="code" href="group__cl__object.html#ga6468845263bc804e0badfe153da12081">02063</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__cl__object.html#ga6468845263bc804e0badfe153da12081" title="Return refcount of cl_object.">cl_object_refc</a>(<span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *clob)
<a name="l02064"></a>02064 {
<a name="l02065"></a>02065         <span class="keyword">struct </span><a class="code" href="structlu__object__header.html" title="&amp;quot;Compound&amp;quot; object, consisting of multiple layers.">lu_object_header</a> *<a class="code" href="it__test_8c.html#a65579ed4f1bdcc045f97e6ccee22e9a9">header</a> = clob-&gt;<a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>.<a class="code" href="structlu__object.html#ab55ad0889ad4d306d0a5aad7ed0aa398" title="Header for this object.">lo_header</a>;
<a name="l02066"></a>02066         <span class="keywordflow">return</span> atomic_read(&amp;header-&gt;<a class="code" href="structlu__object__header.html#ab0171f571d26d9b358edfdda51b5fb90" title="Object reference count.">loh_ref</a>);
<a name="l02067"></a>02067 }
<a name="l02068"></a>02068 
<a name="l02073"></a>02073 <span class="keyword">enum</span> {
<a name="l02074"></a><a class="code" href="group__cl__page.html#ggadc29c2ff13d900c2f185ee95427fb06ca1a8b155b6d6a78a95318775eb54c08b5">02074</a>         <a class="code" href="group__cl__page.html#ggadc29c2ff13d900c2f185ee95427fb06ca1a8b155b6d6a78a95318775eb54c08b5">CLP_GANG_OKAY</a> = 0,
<a name="l02075"></a><a class="code" href="group__cl__page.html#ggadc29c2ff13d900c2f185ee95427fb06ca1279507e1987988d99116da1f362faaa">02075</a>         <a class="code" href="group__cl__page.html#ggadc29c2ff13d900c2f185ee95427fb06ca1279507e1987988d99116da1f362faaa">CLP_GANG_RESCHED</a>,
<a name="l02076"></a><a class="code" href="group__cl__page.html#ggadc29c2ff13d900c2f185ee95427fb06ca7a07cd260bc2685503d74371b7af3fa5">02076</a>         <a class="code" href="group__cl__page.html#ggadc29c2ff13d900c2f185ee95427fb06ca7a07cd260bc2685503d74371b7af3fa5">CLP_GANG_AGAIN</a>,
<a name="l02077"></a><a class="code" href="group__cl__page.html#ggadc29c2ff13d900c2f185ee95427fb06cacad5f5792a95672ac7258f707217afa7">02077</a>         <a class="code" href="group__cl__page.html#ggadc29c2ff13d900c2f185ee95427fb06cacad5f5792a95672ac7258f707217afa7">CLP_GANG_ABORT</a>
<a name="l02078"></a>02078 };
<a name="l02079"></a>02079 <span class="comment">/* callback of cl_page_gang_lookup() */</span>
<a name="l02080"></a>02080 
<a name="l02081"></a>02081 <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *<a class="code" href="group__cl__page.html#ga448fbdaea940886c756e4a2d659982ba" title="Returns a cl_page with index idx at the object o, and associated with the VM page...">cl_page_find</a>        (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02082"></a>02082                                      <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l02083"></a>02083                                      pgoff_t idx, <span class="keyword">struct</span> page *vmpage,
<a name="l02084"></a>02084                                      <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga04ed60b0572c2fcfa6c2590aac97f92d">cl_page_type</a> type);
<a name="l02085"></a>02085 <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *<a class="code" href="group__cl__page.html#ga630af4228e1e42063ce55e844dfc8c30">cl_page_alloc</a>       (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02086"></a>02086                                      <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *o, pgoff_t ind,
<a name="l02087"></a>02087                                      <span class="keyword">struct</span> page *vmpage,
<a name="l02088"></a>02088                                      <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga04ed60b0572c2fcfa6c2590aac97f92d">cl_page_type</a> type);
<a name="l02089"></a>02089 <span class="keywordtype">void</span>            <a class="code" href="group__cl__page.html#gafc2fc785c3daf1db46bb250244dfde13" title="Acquires an additional reference to a page.">cl_page_get</a>         (<span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02090"></a>02090 <span class="keywordtype">void</span>            <a class="code" href="group__cl__page.html#ga1dc4205fd892e559c96ce97aad4eebf1" title="Releases a reference to a page.">cl_page_put</a>         (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02091"></a>02091                                      <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02092"></a>02092 <span class="keywordtype">void</span>            <a class="code" href="group__cl__page.html#ga8c8a48c83e51dbc9dd7a79933c1133d2" title="Prints human readable representation of pg to the f.">cl_page_print</a>       (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keywordtype">void</span> *cookie,
<a name="l02093"></a>02093                                      <a class="code" href="group__lu.html#gac8ccca21472f6dc3ea91d73983740fdc" title="Type of &amp;quot;printer&amp;quot; function used by lu_object_operations::loo_object_print()...">lu_printer_t</a> printer,
<a name="l02094"></a>02094                                      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg);
<a name="l02095"></a>02095 <span class="keywordtype">void</span>            <a class="code" href="group__cl__page.html#ga410da950184d24fa1232acf2470c9bab" title="Prints human readable representation of pg to the f.">cl_page_header_print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keywordtype">void</span> *cookie,
<a name="l02096"></a>02096                                      <a class="code" href="group__lu.html#gac8ccca21472f6dc3ea91d73983740fdc" title="Type of &amp;quot;printer&amp;quot; function used by lu_object_operations::loo_object_print()...">lu_printer_t</a> printer,
<a name="l02097"></a>02097                                      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg);
<a name="l02098"></a>02098 <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *<a class="code" href="group__cl__page.html#gac3255abeeef8f9d9f3a4c80f553a75ed" title="Returns a cl_page associated with a VM page, and given cl_object.">cl_vmpage_page</a>      (<span class="keyword">struct</span> page *vmpage, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj);
<a name="l02099"></a>02099 <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *<a class="code" href="group__cl__page.html#ga5751d9274f61529ae1ec5a2b03b20db2">cl_page_top</a>         (<span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02100"></a>02100 
<a name="l02101"></a>02101 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__page__slice.html" title="Per-layer part of cl_page.">cl_page_slice</a> *<a class="code" href="group__cl__page.html#gab700fa091971e5f4dd53b2e7ec47334d">cl_page_at</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page,
<a name="l02102"></a>02102                                        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__device__type.html" title="Type of device.">lu_device_type</a> *dtype);
<a name="l02103"></a>02103 
<a name="l02111"></a>02111 <span class="keywordtype">int</span>  <a class="code" href="group__cl__page.html#ga2f91322039a4254d13f6e0a668e5746a" title="Own a page, might be blocked.">cl_page_own</a>        (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02112"></a>02112                          <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02113"></a>02113 <span class="keywordtype">int</span>  <a class="code" href="group__cl__page.html#ga105c7ed0e326d75ffc75980986186bb7" title="Nonblock version of cl_page_own().">cl_page_own_try</a>    (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02114"></a>02114                          <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02115"></a>02115 <span class="keywordtype">void</span> <a class="code" href="group__cl__page.html#ga77a2e8592e58cc9c514cb4ac38a9d2f4" title="Assume page ownership.">cl_page_assume</a>     (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02116"></a>02116                          <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02117"></a>02117 <span class="keywordtype">void</span> <a class="code" href="group__cl__page.html#ga4e7db1845b76bea8277b4e3d2a482f61" title="Releases page ownership without unlocking the page.">cl_page_unassume</a>   (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02118"></a>02118                          <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg);
<a name="l02119"></a>02119 <span class="keywordtype">void</span> <a class="code" href="group__cl__page.html#gae41a4c98faae723b2566a721b6e4b7fb" title="Releases page ownership.">cl_page_disown</a>     (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02120"></a>02120                          <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02121"></a>02121 <span class="keywordtype">int</span>  <a class="code" href="group__cl__page.html#gabf5979233c47e0913f8d438d01051ebf" title="returns true, iff page is owned by the given io.">cl_page_is_owned</a>   (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l02122"></a>02122 
<a name="l02132"></a>02132 <span class="keywordtype">int</span>  <a class="code" href="group__cl__page.html#ga8216a843e48aa6d45d049b6aacb13744" title="Prepares page for immediate transfer.">cl_page_prep</a>       (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02133"></a>02133                          <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg, <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga419215a2ca4eeab85983de8ca5a16a02" title="Requested transfer type.">cl_req_type</a> crt);
<a name="l02134"></a>02134 <span class="keywordtype">void</span> <a class="code" href="group__cl__page.html#ga778ad6a1a849ef9701db714913c879ec" title="Notify layers about transfer completion.">cl_page_completion</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02135"></a>02135                          <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg, <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga419215a2ca4eeab85983de8ca5a16a02" title="Requested transfer type.">cl_req_type</a> crt, <span class="keywordtype">int</span> ioret);
<a name="l02136"></a>02136 <span class="keywordtype">int</span>  <a class="code" href="group__cl__page.html#ga864bcec4bff9dd1f988f928348c08796" title="Notify layers that transfer formation engine decided to yank this page from the cache...">cl_page_make_ready</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg,
<a name="l02137"></a>02137                          <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga419215a2ca4eeab85983de8ca5a16a02" title="Requested transfer type.">cl_req_type</a> crt);
<a name="l02138"></a>02138 <span class="keywordtype">int</span>  <a class="code" href="group__cl__page.html#ga9022b1fa30e82cf1e69bd534022ffb8f">cl_page_cache_add</a>  (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02139"></a>02139                          <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg, <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga419215a2ca4eeab85983de8ca5a16a02" title="Requested transfer type.">cl_req_type</a> crt);
<a name="l02140"></a>02140 <span class="keywordtype">void</span> <a class="code" href="group__cl__page.html#ga2218cff8efc343a14d1c312f64e15e1f" title="Tells transfer engine that only part of a page is to be transmitted.">cl_page_clip</a>       (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg,
<a name="l02141"></a>02141                          <span class="keywordtype">int</span> from, <span class="keywordtype">int</span> to);
<a name="l02142"></a>02142 <span class="keywordtype">int</span>  <a class="code" href="group__cl__page.html#ga2b98b954f28349bd90316fec9ebaec83" title="Cancel a page which is still in a transfer.">cl_page_cancel</a>     (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02143"></a>02143 <span class="keywordtype">int</span>  <a class="code" href="group__cl__page.html#ga0616bcd8605ed9a75e799f64bcdd5a2d" title="Called if a pge is being written back by kernel&amp;#39;s intention.">cl_page_flush</a>      (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02144"></a>02144                          <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg);
<a name="l02145"></a>02145 
<a name="l02154"></a>02154 <span class="keywordtype">void</span>    <a class="code" href="group__cl__page.html#ga775efaa18bd22d404f7588fd35f6cd03" title="Called when page is to be removed from the object, e.g., as a result of truncate...">cl_page_discard</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02155"></a>02155                         <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg);
<a name="l02156"></a>02156 <span class="keywordtype">void</span>    <a class="code" href="group__cl__page.html#ga55a51f6efaa6effc3b5b3d045d4ee432" title="Called when a decision is made to throw page out of memory.">cl_page_delete</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg);
<a name="l02157"></a>02157 <span class="keywordtype">int</span>     <a class="code" href="group__cl__page.html#gaff21e5139bb0af2f15e2cfb9cfb587f3" title="Returns true, iff pg is VM locked in a suitable sense by the calling thread.">cl_page_is_vmlocked</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02158"></a>02158                             <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg);
<a name="l02159"></a>02159 <span class="keywordtype">void</span>    <a class="code" href="group__cl__page.html#gafacf1187afd6e200c6f8d59539baf50c" title="Marks page up-to-date.">cl_page_export</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02160"></a>02160                        <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *pg, <span class="keywordtype">int</span> uptodate);
<a name="l02161"></a>02161 loff_t  <a class="code" href="group__cl__page.html#gace31c47f7197adaedc4124bcddbca515" title="Converts a byte offset within object obj into a page index.">cl_offset</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj, pgoff_t idx);
<a name="l02162"></a>02162 pgoff_t <a class="code" href="group__cl__page.html#gaa04da32f8652bb1f20f7017d8ed387e4" title="Converts a page index into a byte offset within object obj.">cl_index</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj, loff_t offset);
<a name="l02163"></a>02163 <span class="keywordtype">size_t</span>  <a class="code" href="group__cl__page.html#ga43006a6bc8ca6f3de9ce4af48d944cc7">cl_page_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj);
<a name="l02164"></a>02164 
<a name="l02165"></a>02165 <span class="keywordtype">void</span> <a class="code" href="group__cl__page.html#gae62cdffcc2ad419c1efe15d3f7e2b7be" title="Prints human readable representation of lock to the f.">cl_lock_print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keywordtype">void</span> *cookie,
<a name="l02166"></a>02166                    <a class="code" href="group__lu.html#gac8ccca21472f6dc3ea91d73983740fdc" title="Type of &amp;quot;printer&amp;quot; function used by lu_object_operations::loo_object_print()...">lu_printer_t</a> printer, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a> *lock);
<a name="l02167"></a>02167 <span class="keywordtype">void</span> <a class="code" href="group__cl__page.html#gad2a636ba7685701e15adf1818874fd50" title="Prints human readable representation of a lock description.">cl_lock_descr_print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keywordtype">void</span> *cookie,
<a name="l02168"></a>02168                          <a class="code" href="group__lu.html#gac8ccca21472f6dc3ea91d73983740fdc" title="Type of &amp;quot;printer&amp;quot; function used by lu_object_operations::loo_object_print()...">lu_printer_t</a> printer,
<a name="l02169"></a>02169                          <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__lock__descr.html" title="Lock description.">cl_lock_descr</a> *descr);
<a name="l02170"></a>02170 <span class="comment">/* @} helper */</span>
<a name="l02171"></a>02171 
<a name="l02178"></a><a class="code" href="structcl__client__cache.html">02178</a> <span class="keyword">struct </span><a class="code" href="structcl__client__cache.html" title="Data structure managing a client&amp;#39;s cached pages.">cl_client_cache</a> {
<a name="l02183"></a><a class="code" href="structcl__client__cache.html#a57c96eb85dc16678ffc511f4d8ace7f2">02183</a>         atomic_t                <a class="code" href="structcl__client__cache.html#a57c96eb85dc16678ffc511f4d8ace7f2" title="# of client cache refcount # of users (OSCs) + 2 (held by llite and lov)">ccc_users</a>;
<a name="l02187"></a><a class="code" href="structcl__client__cache.html#afed9a92205cc1f05850efa47db8df4ba">02187</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            <a class="code" href="structcl__client__cache.html#afed9a92205cc1f05850efa47db8df4ba" title="# of threads are doing shrinking">ccc_lru_shrinkers</a>;
<a name="l02191"></a><a class="code" href="structcl__client__cache.html#a4f9c3d3253b779ccbfa9376d5709ff47">02191</a>         atomic_long_t           <a class="code" href="structcl__client__cache.html#a4f9c3d3253b779ccbfa9376d5709ff47" title="# of LRU entries available">ccc_lru_left</a>;
<a name="l02195"></a><a class="code" href="structcl__client__cache.html#af8be7dabe3327ff90cb54e4d97ca0742">02195</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structcl__client__cache.html#af8be7dabe3327ff90cb54e4d97ca0742" title="List of entities(OSCs) for this LRU cache.">ccc_lru</a>;
<a name="l02199"></a><a class="code" href="structcl__client__cache.html#a6533ffde6bee6a5e60c0db19b5966a71">02199</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>           <a class="code" href="structcl__client__cache.html#a6533ffde6bee6a5e60c0db19b5966a71" title="Max # of LRU entries.">ccc_lru_max</a>;
<a name="l02203"></a><a class="code" href="structcl__client__cache.html#a593bc6dca5cf6310fd71b840156d2099">02203</a>         spinlock_t              <a class="code" href="structcl__client__cache.html#a593bc6dca5cf6310fd71b840156d2099" title="Lock to protect ccc_lru list.">ccc_lru_lock</a>;
<a name="l02207"></a><a class="code" href="structcl__client__cache.html#af3635fd3633a4dbcbb2a37b5de0a2a3f">02207</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            <a class="code" href="structcl__client__cache.html#af3635fd3633a4dbcbb2a37b5de0a2a3f" title="Set if unstable check is enabled.">ccc_unstable_check</a>:1;
<a name="l02211"></a><a class="code" href="structcl__client__cache.html#a2f819a992c85af943adf3120cf2d509d">02211</a>         atomic_long_t           <a class="code" href="structcl__client__cache.html#a2f819a992c85af943adf3120cf2d509d" title="# of unstable pages for this mount point">ccc_unstable_nr</a>;
<a name="l02216"></a><a class="code" href="structcl__client__cache.html#a2522ffba520c532065c98791724fc521">02216</a>         wait_queue_head_t       <a class="code" href="structcl__client__cache.html#a2522ffba520c532065c98791724fc521" title="Waitq for awaiting unstable pages to reach zero.">ccc_unstable_waitq</a>;
<a name="l02217"></a>02217 };
<a name="l02221"></a>02221 <span class="keyword">struct </span><a class="code" href="structcl__client__cache.html" title="Data structure managing a client&amp;#39;s cached pages.">cl_client_cache</a> *<a class="code" href="group__cl__page.html#gaa9cb2d06a33d48e9c15d7e311fb3c2be" title="cl_cache functions">cl_cache_init</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lru_page_max);
<a name="l02222"></a>02222 <span class="keywordtype">void</span> <a class="code" href="group__cl__page.html#ga81d50c8e80031f53132c1e66c54ee2c6" title="Increase cl_cache refcount.">cl_cache_incref</a>(<span class="keyword">struct</span> <a class="code" href="structcl__client__cache.html" title="Data structure managing a client&amp;#39;s cached pages.">cl_client_cache</a> *cache);
<a name="l02223"></a>02223 <span class="keywordtype">void</span> <a class="code" href="group__cl__page.html#gaaabf78f7ae327b269ded9a824d9ccebf" title="Decrease cl_cache refcount and free the cache if refcount=0.">cl_cache_decref</a>(<span class="keyword">struct</span> <a class="code" href="structcl__client__cache.html" title="Data structure managing a client&amp;#39;s cached pages.">cl_client_cache</a> *cache);
<a name="l02224"></a>02224 
<a name="l02229"></a>02229 <span class="keywordtype">int</span> <a class="code" href="group__cl__lock.html#ga4afe671873f4a7343d9c50c574557fd6" title="Main high-level entry point of cl_lock interface that finds existing or enqueues...">cl_lock_request</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02230"></a>02230                     <span class="keyword">struct</span> <a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a> *lock);
<a name="l02231"></a>02231 <span class="keywordtype">int</span> <a class="code" href="group__cl__lock.html#ga936be055d2a7449907656154d8970dc0">cl_lock_init</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a> *lock,
<a name="l02232"></a>02232                  <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l02233"></a>02233 <span class="keywordtype">void</span> <a class="code" href="group__cl__lock.html#ga61a295e97704c2509c99d3f7d8711a95">cl_lock_fini</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a> *lock);
<a name="l02234"></a>02234 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcl__lock__slice.html" title="Per-layer part of cl_lock.">cl_lock_slice</a> *<a class="code" href="group__cl__lock.html#ga9b59ad7624c11fcecf6eadb1a58f6f8b" title="Returns a slice with a lock, corresponding to the given layer in the device stack...">cl_lock_at</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a> *lock,
<a name="l02235"></a>02235                                        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__device__type.html" title="Type of device.">lu_device_type</a> *dtype);
<a name="l02236"></a>02236 <span class="keywordtype">void</span> <a class="code" href="group__cl__lock.html#ga4e8069a400c6a75342649a6fc04fa2c3" title="Releases a hold and a reference on a lock, obtained by cl_lock_hold().">cl_lock_release</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a> *lock);
<a name="l02237"></a>02237 
<a name="l02238"></a>02238 <span class="keywordtype">int</span> <a class="code" href="group__cl__lock.html#gab9d3d1e316773c71555cbb8e29ca0403" title="Enqueue a lock.">cl_lock_enqueue</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02239"></a>02239                     <span class="keyword">struct</span> <a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a> *lock, <span class="keyword">struct</span> <a class="code" href="structcl__sync__io.html" title="Anchor for synchronous transfer.">cl_sync_io</a> *anchor);
<a name="l02240"></a>02240 <span class="keywordtype">void</span> <a class="code" href="group__cl__lock.html#gaab3c1781a296023121c2641a117a57b1">cl_lock_cancel</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__lock.html" title="Layered client lock.">cl_lock</a> *lock);
<a name="l02241"></a>02241 
<a name="l02247"></a>02247 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#ga2a75c8a7a83eb31d6c899da9dc5143b1" title="Initialize io, by calling cl_io_operations::cio_init() top-to-bottom.">cl_io_init</a>         (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02248"></a>02248                           <span class="keyword">enum</span> <a class="code" href="group__cl__io.html#ga7ce44ceebcd945560fa661571e3a4378" title="IO types.">cl_io_type</a> iot, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj);
<a name="l02249"></a>02249 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#ga485aa4a9e93475523519f07aca310bac" title="Initialize sub-io, by calling cl_io_operations::cio_init() top-to-bottom.">cl_io_sub_init</a>     (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02250"></a>02250                           <span class="keyword">enum</span> <a class="code" href="group__cl__io.html#ga7ce44ceebcd945560fa661571e3a4378" title="IO types.">cl_io_type</a> iot, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj);
<a name="l02251"></a>02251 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#gacff72463468f75b6af811bf709aefa9d" title="Initialize read or write io.">cl_io_rw_init</a>      (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02252"></a>02252                           <span class="keyword">enum</span> <a class="code" href="group__cl__io.html#ga7ce44ceebcd945560fa661571e3a4378" title="IO types.">cl_io_type</a> iot, loff_t pos, <span class="keywordtype">size_t</span> count);
<a name="l02253"></a>02253 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#ga2b13e91188661c45925b56e88b000c6e" title="Main io loop.">cl_io_loop</a>         (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l02254"></a>02254 
<a name="l02255"></a>02255 <span class="keywordtype">void</span>  <a class="code" href="group__cl__io.html#gacde22a6b2da553556081b6f93e8e0f7f" title="Finalize io, by calling cl_io_operations::cio_fini() bottom-to-top.">cl_io_fini</a>         (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l02256"></a>02256 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#gac1a8e0e9d4277fcde8a56794f6f41003" title="Prepares next iteration of io.">cl_io_iter_init</a>    (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l02257"></a>02257 <span class="keywordtype">void</span>  <a class="code" href="group__cl__io.html#gad8b5d08373d6d963c67c2682e41999ac" title="Finalizes io iteration.">cl_io_iter_fini</a>    (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l02258"></a>02258 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#ga2229beaa77461f453fa4e1f1e129cbe6" title="Takes locks necessary for the current iteration of io.">cl_io_lock</a>         (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l02259"></a>02259 <span class="keywordtype">void</span>  <a class="code" href="group__cl__io.html#ga0de2f26e31233ef3bf8c7315b412e681" title="Release locks takes by io.">cl_io_unlock</a>       (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l02260"></a>02260 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#gacf4c2a55f31d42191ff49b8685163008" title="Starts io by calling cl_io_operations::cio_start() top-to-bottom.">cl_io_start</a>        (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l02261"></a>02261 <span class="keywordtype">void</span>  <a class="code" href="group__cl__io.html#gaffebdf9278fa11f9dbecfeb3f5852fb5" title="Wait until current io iteration is finished by calling cl_io_operations::cio_end()...">cl_io_end</a>          (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l02262"></a>02262 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#ga80fe084e78e83a4a66fceb0e2c605b6e" title="Adds a lock to a lockset.">cl_io_lock_add</a>     (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02263"></a>02263                           <span class="keyword">struct</span> <a class="code" href="structcl__io__lock__link.html" title="Link between lock and io.">cl_io_lock_link</a> *link);
<a name="l02264"></a>02264 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#ga3ce86bab1ea06d8d2d7ac15f3a0be3f6" title="Allocates new lock link, and uses it to add a lock to a lockset.">cl_io_lock_alloc_add</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02265"></a>02265                            <span class="keyword">struct</span> <a class="code" href="structcl__lock__descr.html" title="Lock description.">cl_lock_descr</a> *descr);
<a name="l02266"></a>02266 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#gae609957e435aaa7c3044b45cada6b96c" title="Submits a list of pages for immediate io.">cl_io_submit_rw</a>    (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02267"></a>02267                           <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga419215a2ca4eeab85983de8ca5a16a02" title="Requested transfer type.">cl_req_type</a> iot, <span class="keyword">struct</span> <a class="code" href="structcl__2queue.html" title="A 2-queue of pages.">cl_2queue</a> *queue);
<a name="l02268"></a>02268 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#ga575a43e2ec65ba4aa6c926cf5e49fe70" title="Submit a sync_io and wait for the IO to be finished, or error happens.">cl_io_submit_sync</a>  (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02269"></a>02269                           <span class="keyword">enum</span> <a class="code" href="group__cl__page.html#ga419215a2ca4eeab85983de8ca5a16a02" title="Requested transfer type.">cl_req_type</a> iot, <span class="keyword">struct</span> <a class="code" href="structcl__2queue.html" title="A 2-queue of pages.">cl_2queue</a> *queue,
<a name="l02270"></a>02270                           <span class="keywordtype">long</span> <a class="code" href="gnilnd__modparams_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>);
<a name="l02271"></a>02271 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#gac830ac176054e906a54a4db48fbf45bb" title="Commit a list of contiguous pages into writeback cache.">cl_io_commit_async</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02272"></a>02272                           <span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *queue, <span class="keywordtype">int</span> from, <span class="keywordtype">int</span> to,
<a name="l02273"></a>02273                           <a class="code" href="group__cl__io.html#ga54c4de6c969138d0642ef59a1ff5e0b0">cl_commit_cbt</a> <a class="code" href="it__test_8c.html#a3edc96db5310d665bb056d7adc554a8f">cb</a>);
<a name="l02274"></a>02274 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#gad5b4d2971764744ec2f5d30fe56d9781" title="Called by read io, to decide the readahead extent.">cl_io_read_ahead</a>   (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02275"></a>02275                           pgoff_t <a class="code" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <span class="keyword">struct</span> <a class="code" href="structcl__read__ahead.html">cl_read_ahead</a> *ra);
<a name="l02276"></a>02276 <span class="keywordtype">void</span>  <a class="code" href="group__cl__io.html#ga0e67009a999662295be41a4532bf6f37" title="Records that read or write io progressed nob bytes forward.">cl_io_rw_advance</a>   (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02277"></a>02277                           <span class="keywordtype">size_t</span> nob);
<a name="l02278"></a>02278 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#ga9e1b49d71ec98da5a7f4bd1fba415ad5" title="Cancel an IO which has been submitted by cl_io_submit_rw.">cl_io_cancel</a>       (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io,
<a name="l02279"></a>02279                           <span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *queue);
<a name="l02280"></a>02280 <span class="keywordtype">int</span>   <a class="code" href="group__cl__io.html#ga2ae08af9fbe1af93e2d82049e7ae7e3c" title="Returns true iff there is an IO ongoing in the given environment.">cl_io_is_going</a>     (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env);
<a name="l02281"></a>02281 
<a name="l02285"></a><a class="code" href="group__cl__io.html#ga81a17e84380b3479ecbe1e4a0a868801">02285</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__cl__io.html#ga81a17e84380b3479ecbe1e4a0a868801" title="True, iff io is an O_APPEND write(2).">cl_io_is_append</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io)
<a name="l02286"></a>02286 {
<a name="l02287"></a>02287         <span class="keywordflow">return</span> io-&gt;<a class="code" href="structcl__io.html#ac02cd7b5e65d1d20d00de68de64d8b50" title="type of this IO.">ci_type</a> == <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378aa9c9f93ccf31c58b09085a8460ed1475" title="write system call">CIT_WRITE</a> &amp;&amp; io-&gt;<a class="code" href="structcl__io.html#a8b561db29f0b79fba4d14b66b9882530">u</a>.<a class="code" href="structcl__io.html#a60575f788129abb9beff0cb40bc3eb36">ci_wr</a>.wr_append;
<a name="l02288"></a>02288 }
<a name="l02289"></a>02289 
<a name="l02290"></a><a class="code" href="group__cl__io.html#ga48f4979293404667c5c1e8eb8e080dc7">02290</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__cl__io.html#ga48f4979293404667c5c1e8eb8e080dc7">cl_io_is_sync_write</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io)
<a name="l02291"></a>02291 {
<a name="l02292"></a>02292         <span class="keywordflow">return</span> io-&gt;<a class="code" href="structcl__io.html#ac02cd7b5e65d1d20d00de68de64d8b50" title="type of this IO.">ci_type</a> == <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378aa9c9f93ccf31c58b09085a8460ed1475" title="write system call">CIT_WRITE</a> &amp;&amp; io-&gt;<a class="code" href="structcl__io.html#a8b561db29f0b79fba4d14b66b9882530">u</a>.<a class="code" href="structcl__io.html#a60575f788129abb9beff0cb40bc3eb36">ci_wr</a>.wr_sync;
<a name="l02293"></a>02293 }
<a name="l02294"></a>02294 
<a name="l02295"></a><a class="code" href="group__cl__io.html#gabb552842f09a0899378f5a04410f4dc7">02295</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__cl__io.html#gabb552842f09a0899378f5a04410f4dc7">cl_io_is_mkwrite</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io)
<a name="l02296"></a>02296 {
<a name="l02297"></a>02297         <span class="keywordflow">return</span> io-&gt;<a class="code" href="structcl__io.html#ac02cd7b5e65d1d20d00de68de64d8b50" title="type of this IO.">ci_type</a> == <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378af6dd7f3f5e03ad52c7f5a42d5fd03322" title="page fault handling">CIT_FAULT</a> &amp;&amp; io-&gt;<a class="code" href="structcl__io.html#a8b561db29f0b79fba4d14b66b9882530">u</a>.<a class="code" href="structcl__io.html#a1a7759183426a4d21ab676823e0a8a11">ci_fault</a>.ft_mkwrite;
<a name="l02298"></a>02298 }
<a name="l02299"></a>02299 
<a name="l02303"></a><a class="code" href="group__cl__io.html#gafc95427f78408eaab2a0857e92d1004a">02303</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__cl__io.html#gafc95427f78408eaab2a0857e92d1004a" title="True, iff io is a truncate(2).">cl_io_is_trunc</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io)
<a name="l02304"></a>02304 {
<a name="l02305"></a>02305         <span class="keywordflow">return</span> io-&gt;<a class="code" href="structcl__io.html#ac02cd7b5e65d1d20d00de68de64d8b50" title="type of this IO.">ci_type</a> == <a class="code" href="group__cl__io.html#gga7ce44ceebcd945560fa661571e3a4378a0a7b38271be1f7d7faac2bfc3f8ce3a6" title="truncate, utime system calls">CIT_SETATTR</a> &amp;&amp;
<a name="l02306"></a>02306                 (io-&gt;<a class="code" href="structcl__io.html#a8b561db29f0b79fba4d14b66b9882530">u</a>.<a class="code" href="structcl__io.html#add969c0bdeb6aada0869a2e9c45b406a">ci_setattr</a>.sa_valid &amp; ATTR_SIZE);
<a name="l02307"></a>02307 }
<a name="l02308"></a>02308 
<a name="l02309"></a>02309 <span class="keyword">struct </span><a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *<a class="code" href="group__cl__io.html#ga4bb065eb52291173dbda9a0721b1ea2c" title="Returns top-level io.">cl_io_top</a>(<span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l02310"></a>02310 
<a name="l02311"></a>02311 <span class="keywordtype">void</span> <a class="code" href="group__cl__io.html#ga56de1ca2cd018d724e180da7eabbcad9" title="Prints human readable representation of io to the f.">cl_io_print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keywordtype">void</span> *cookie,
<a name="l02312"></a>02312                  <a class="code" href="group__lu.html#gac8ccca21472f6dc3ea91d73983740fdc" title="Type of &amp;quot;printer&amp;quot; function used by lu_object_operations::loo_object_print()...">lu_printer_t</a> printer, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io);
<a name="l02313"></a>02313 
<a name="l02314"></a><a class="code" href="group__cl__io.html#gac166b29f4371ce1ec6adb1d26633c4fa">02314</a> <span class="preprocessor">#define CL_IO_SLICE_CLEAN(foo_io, base)                                 \</span>
<a name="l02315"></a>02315 <span class="preprocessor">do {                                                                    \</span>
<a name="l02316"></a>02316 <span class="preprocessor">        typeof(foo_io) __foo_io = (foo_io);                             \</span>
<a name="l02317"></a>02317 <span class="preprocessor">                                                                        \</span>
<a name="l02318"></a>02318 <span class="preprocessor">        CLASSERT(offsetof(typeof(*__foo_io), base) == 0);               \</span>
<a name="l02319"></a>02319 <span class="preprocessor">        memset(&amp;__foo_io-&gt;base + 1, 0,                                  \</span>
<a name="l02320"></a>02320 <span class="preprocessor">               (sizeof *__foo_io) - sizeof __foo_io-&gt;base);             \</span>
<a name="l02321"></a>02321 <span class="preprocessor">} while (0)</span>
<a name="l02322"></a>02322 <span class="preprocessor"></span>
<a name="l02331"></a><a class="code" href="group__cl__page__list.html#ga934c63a7507d4e7379ec48f01468de6b">02331</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *<a class="code" href="group__cl__page__list.html#ga934c63a7507d4e7379ec48f01468de6b" title="Last page in the page list.">cl_page_list_last</a>(<span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *plist)
<a name="l02332"></a>02332 {
<a name="l02333"></a>02333         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(plist-&gt;<a class="code" href="structcl__page__list.html#ad3e0452cebfd450907df6f38fa99329e">pl_nr</a> &gt; 0);
<a name="l02334"></a>02334         <span class="keywordflow">return</span> <a class="code" href="list_8h.html#a26c976b7f654e70df318c1843e5094de" title="Get the container of a list.">list_entry</a>(plist-&gt;<a class="code" href="structcl__page__list.html#af3074454b87b71142c2f85ed0455df41">pl_pages</a>.<a class="code" href="structlist__head.html#aaa0eabda8877e1d6de73a33f223ad004">prev</a>, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a>, <a class="code" href="structcl__page.html#a728db31646edabc4ff8c8cfc3f30f10f" title="Linkage of pages within group.">cp_batch</a>);
<a name="l02335"></a>02335 }
<a name="l02336"></a>02336 
<a name="l02337"></a><a class="code" href="group__cl__page__list.html#ga1fa83a01d78b01e4b47a1aef2d63cec7">02337</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *<a class="code" href="group__cl__page__list.html#ga1fa83a01d78b01e4b47a1aef2d63cec7">cl_page_list_first</a>(<span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *plist)
<a name="l02338"></a>02338 {
<a name="l02339"></a>02339         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(plist-&gt;<a class="code" href="structcl__page__list.html#ad3e0452cebfd450907df6f38fa99329e">pl_nr</a> &gt; 0);
<a name="l02340"></a>02340         <span class="keywordflow">return</span> <a class="code" href="list_8h.html#a26c976b7f654e70df318c1843e5094de" title="Get the container of a list.">list_entry</a>(plist-&gt;<a class="code" href="structcl__page__list.html#af3074454b87b71142c2f85ed0455df41">pl_pages</a>.<a class="code" href="structlist__head.html#ac3b0ff0dfb978a0cfbdad6b9d19cdcfe">next</a>, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a>, <a class="code" href="structcl__page.html#a728db31646edabc4ff8c8cfc3f30f10f" title="Linkage of pages within group.">cp_batch</a>);
<a name="l02341"></a>02341 }
<a name="l02342"></a>02342 
<a name="l02346"></a><a class="code" href="group__cl__page__list.html#ga31a6630a381a5667594d699aa7269794">02346</a> <span class="preprocessor">#define cl_page_list_for_each(page, list)                               \</span>
<a name="l02347"></a>02347 <span class="preprocessor">        list_for_each_entry((page), &amp;(list)-&gt;pl_pages, cp_batch)</span>
<a name="l02348"></a>02348 <span class="preprocessor"></span>
<a name="l02352"></a><a class="code" href="group__cl__page__list.html#gae1b447b26c7ca703b2ef0fdfa82ca575">02352</a> <span class="preprocessor">#define cl_page_list_for_each_safe(page, temp, list)                    \</span>
<a name="l02353"></a>02353 <span class="preprocessor">        list_for_each_entry_safe((page), (temp), &amp;(list)-&gt;pl_pages, cp_batch)</span>
<a name="l02354"></a>02354 <span class="preprocessor"></span>
<a name="l02355"></a>02355 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#ga90ce1bc2aafa623ad024e213a05e00f0" title="Initializes page list.">cl_page_list_init</a>   (<span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *plist);
<a name="l02356"></a>02356 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#ga78d782095ec6f5d72e432d0ef0b35b3a" title="Adds a page to a page list.">cl_page_list_add</a>    (<span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *plist, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02357"></a>02357 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#gac81a19417ea58bb1b38001636f07cf8c" title="Moves a page from one page list to another.">cl_page_list_move</a>   (<span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *dst, <span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *src,
<a name="l02358"></a>02358                           <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02359"></a>02359 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#ga06da834a47d10c42fdd688c728213d8c" title="Moves a page from one page list to the head of another list.">cl_page_list_move_head</a>(<span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *dst, <span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *src,
<a name="l02360"></a>02360                           <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02361"></a>02361 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#gac4c762cc3608863a8e5a766def8bf1c8" title="splice the cl_page_list, just as list head does">cl_page_list_splice</a> (<span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *<a class="code" href="lnetctl_8c.html#ac75dee5cf9c8f0128e744b7d95db6767">list</a>,
<a name="l02362"></a>02362                           <span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *<a class="code" href="writemany_8c.html#af39400667a953a7c5c34e3964aa1ce9f">head</a>);
<a name="l02363"></a>02363 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#ga365b60118b6d1e7cf4ce21d58babf5b9" title="Removes a page from a page list.">cl_page_list_del</a>    (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02364"></a>02364                           <span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *plist, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02365"></a>02365 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#ga6775317c52f6e2540b62563f559cfab6" title="Disowns pages in a queue.">cl_page_list_disown</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02366"></a>02366                           <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *plist);
<a name="l02367"></a>02367 <span class="keywordtype">int</span>  <a class="code" href="group__cl__page__list.html#gaddbba15e99055d90aba88ec1b282455a" title="Owns all pages in a queue.">cl_page_list_own</a>    (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02368"></a>02368                           <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *plist);
<a name="l02369"></a>02369 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#ga321527c28a251fead1c4d8e7967da693" title="Assumes all pages in a queue.">cl_page_list_assume</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02370"></a>02370                           <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *plist);
<a name="l02371"></a>02371 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#gabe8fbe4bdda923be3d8ee245549230f8" title="Discards all pages in a queue.">cl_page_list_discard</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02372"></a>02372                           <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *plist);
<a name="l02373"></a>02373 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#gaf77c34a166e78fa83a75ec296dc0d3fe" title="Releases pages from queue.">cl_page_list_fini</a>   (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__page__list.html">cl_page_list</a> *plist);
<a name="l02374"></a>02374 
<a name="l02375"></a>02375 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#ga395aaa5cb5dec21f83d8b07101b2aef0" title="Initialize dual page queue.">cl_2queue_init</a>     (<span class="keyword">struct</span> <a class="code" href="structcl__2queue.html" title="A 2-queue of pages.">cl_2queue</a> *queue);
<a name="l02376"></a>02376 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#ga55b5a5a4118185f0a7212299f2a65fac" title="Add a page to the incoming page list of 2-queue.">cl_2queue_add</a>      (<span class="keyword">struct</span> <a class="code" href="structcl__2queue.html" title="A 2-queue of pages.">cl_2queue</a> *queue, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02377"></a>02377 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#ga70c6911b231ec808fedc50b9e27e2699" title="Disown pages in both lists of a 2-queue.">cl_2queue_disown</a>   (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02378"></a>02378                          <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__2queue.html" title="A 2-queue of pages.">cl_2queue</a> *queue);
<a name="l02379"></a>02379 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#gaf1c12344f300cfdabbaabba9544db1da" title="Assume to own the pages in cl_2queue.">cl_2queue_assume</a>   (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02380"></a>02380                          <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__2queue.html" title="A 2-queue of pages.">cl_2queue</a> *queue);
<a name="l02381"></a>02381 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#gab47261ab07f2e439b306dccb18a0980e" title="Discard (truncate) pages in both lists of a 2-queue.">cl_2queue_discard</a>  (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02382"></a>02382                          <span class="keyword">struct</span> <a class="code" href="structcl__io.html" title="State for io.">cl_io</a> *io, <span class="keyword">struct</span> <a class="code" href="structcl__2queue.html" title="A 2-queue of pages.">cl_2queue</a> *queue);
<a name="l02383"></a>02383 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#gafce330d7c8aa93047c5716cba8f4f379" title="Finalize both page lists of a 2-queue.">cl_2queue_fini</a>     (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__2queue.html" title="A 2-queue of pages.">cl_2queue</a> *queue);
<a name="l02384"></a>02384 <span class="keywordtype">void</span> <a class="code" href="group__cl__page__list.html#gac54e35928bc036fca6e31c480285924c" title="Initialize a 2-queue to contain page in its incoming page list.">cl_2queue_init_page</a>(<span class="keyword">struct</span> <a class="code" href="structcl__2queue.html" title="A 2-queue of pages.">cl_2queue</a> *queue, <span class="keyword">struct</span> <a class="code" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a> *page);
<a name="l02385"></a>02385 
<a name="l02388"></a>02388 <span class="keywordtype">void</span> <a class="code" href="group__clio.html#ga596455746e16e88acee9318d8d95339d" title="Fills in attributes that are passed to server together with transfer.">cl_req_attr_set</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *obj,
<a name="l02389"></a>02389                      <span class="keyword">struct</span> <a class="code" href="structcl__req__attr.html" title="Per-transfer attributes.">cl_req_attr</a> *attr);
<a name="l02390"></a>02390 
<a name="l02400"></a><a class="code" href="structcl__sync__io.html">02400</a> <span class="keyword">struct </span><a class="code" href="structcl__sync__io.html" title="Anchor for synchronous transfer.">cl_sync_io</a> {
<a name="l02402"></a><a class="code" href="structcl__sync__io.html#aaf7f7fe203e365e9074f83bb8d5e2298">02402</a>         atomic_t                <a class="code" href="structcl__sync__io.html#aaf7f7fe203e365e9074f83bb8d5e2298" title="number of pages yet to be transferred.">csi_sync_nr</a>;
<a name="l02404"></a><a class="code" href="structcl__sync__io.html#ae23f621796520d3fa33f577b790cbca6">02404</a>         <span class="keywordtype">int</span>                     <a class="code" href="structcl__sync__io.html#ae23f621796520d3fa33f577b790cbca6" title="error code.">csi_sync_rc</a>;
<a name="l02406"></a><a class="code" href="structcl__sync__io.html#a12cc89b6e0da8764344db9b5d50ec3b3">02406</a>         atomic_t                <a class="code" href="structcl__sync__io.html#a12cc89b6e0da8764344db9b5d50ec3b3" title="barrier of destroy this structure">csi_barrier</a>;
<a name="l02408"></a><a class="code" href="structcl__sync__io.html#a591752c0080fbe74e3766b250bb226ef">02408</a>         wait_queue_head_t       <a class="code" href="structcl__sync__io.html#a591752c0080fbe74e3766b250bb226ef" title="completion to be signaled when transfer is complete.">csi_waitq</a>;
<a name="l02410"></a>02410         void                    (*<a class="code" href="structcl__sync__io.html#a41e99d40913076c4800d1332ec926474" title="callback to invoke when this IO is finished">csi_end_io</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *,
<a name="l02411"></a>02411                                               <span class="keyword">struct </span><a class="code" href="structcl__sync__io.html" title="Anchor for synchronous transfer.">cl_sync_io</a> *);
<a name="l02412"></a>02412 };
<a name="l02413"></a>02413 
<a name="l02414"></a>02414 <span class="keywordtype">void</span> <a class="code" href="group__cl__sync__io.html#ga9e4705c43e9207a09c6cd8c9fac1c3e5" title="Initialize synchronous io wait anchor.">cl_sync_io_init</a>(<span class="keyword">struct</span> <a class="code" href="structcl__sync__io.html" title="Anchor for synchronous transfer.">cl_sync_io</a> *anchor, <span class="keywordtype">int</span> nr,
<a name="l02415"></a>02415                      <span class="keywordtype">void</span> (*<a class="code" href="mdsrate_8c.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>)(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *, <span class="keyword">struct</span> <a class="code" href="structcl__sync__io.html" title="Anchor for synchronous transfer.">cl_sync_io</a> *));
<a name="l02416"></a>02416 <span class="keywordtype">int</span>  <a class="code" href="group__cl__sync__io.html#ga92057d29f315080be03e18c0262a1871" title="Wait until all IO completes.">cl_sync_io_wait</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__sync__io.html" title="Anchor for synchronous transfer.">cl_sync_io</a> *anchor,
<a name="l02417"></a>02417                      <span class="keywordtype">long</span> <a class="code" href="gnilnd__modparams_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>);
<a name="l02418"></a>02418 <span class="keywordtype">void</span> <a class="code" href="group__cl__sync__io.html#gadb134aa2c1fb3f510bb8fe2a6da02bb9" title="Indicate that transfer of a single page completed.">cl_sync_io_note</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__sync__io.html" title="Anchor for synchronous transfer.">cl_sync_io</a> *anchor,
<a name="l02419"></a>02419                      <span class="keywordtype">int</span> ioret);
<a name="l02420"></a>02420 <span class="keywordtype">void</span> <a class="code" href="group__cl__sync__io.html#ga068e3a27f8967f8656fe3407c898d1d6">cl_sync_io_end</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structcl__sync__io.html" title="Anchor for synchronous transfer.">cl_sync_io</a> *anchor);
<a name="l02421"></a>02421 
<a name="l02461"></a><a class="code" href="structcl__env__nest.html">02461</a> <span class="keyword">struct </span><a class="code" href="structcl__env__nest.html">cl_env_nest</a> {
<a name="l02462"></a><a class="code" href="structcl__env__nest.html#a304a5fa79aabac8693427f4f536d7594">02462</a>         __u16   <a class="code" href="structcl__env__nest.html#a304a5fa79aabac8693427f4f536d7594">cen_refcheck</a>;
<a name="l02463"></a><a class="code" href="structcl__env__nest.html#aeb5a43a21f317f797834dc8bb68d1897">02463</a>         <span class="keywordtype">void</span> *<a class="code" href="structcl__env__nest.html#aeb5a43a21f317f797834dc8bb68d1897">cen_cookie</a>;
<a name="l02464"></a>02464 };
<a name="l02465"></a>02465 
<a name="l02466"></a>02466 <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *<a class="code" href="group__cl__env.html#gad6cae9e9e53d78c25ee1deae1ae3b8f4">cl_env_peek</a>(__u16 *refcheck);
<a name="l02467"></a>02467 <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *<a class="code" href="group__cl__env.html#ga17240d2c6cef5226d4ec8c0b4046afa1" title="Returns lu_env: if there already is an environment associated with the current thread...">cl_env_get</a>(__u16 *refcheck);
<a name="l02468"></a>02468 <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *<a class="code" href="group__cl__env.html#ga2d91b169de0380c5f5be4c1118c7af8e" title="Forces an allocation of a fresh environment with given tags.">cl_env_alloc</a>(__u16 *refcheck, __u32 tags);
<a name="l02469"></a>02469 <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *<a class="code" href="group__cl__env.html#ga6ed10b419dd63d9fa101c7e14e75f965">cl_env_nested_get</a>(<span class="keyword">struct</span> <a class="code" href="structcl__env__nest.html">cl_env_nest</a> *nest);
<a name="l02470"></a>02470 <span class="keywordtype">void</span> <a class="code" href="group__cl__env.html#ga9cf31d221b7596143ff46bd799f19cf2" title="Release an environment.">cl_env_put</a>(<span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, __u16 *refcheck);
<a name="l02471"></a>02471 <span class="keywordtype">void</span> <a class="code" href="group__cl__env.html#gad0152e8236bb22b70e9066509070fded">cl_env_nested_put</a>(<span class="keyword">struct</span> <a class="code" href="structcl__env__nest.html">cl_env_nest</a> *nest, <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env);
<a name="l02472"></a>02472 <span class="keywordtype">void</span> *<a class="code" href="group__cl__env.html#ga2c3cf05baa558c0e2888b5c82d0039a2" title="Declares a point of re-entrancy.">cl_env_reenter</a>(<span class="keywordtype">void</span>);
<a name="l02473"></a>02473 <span class="keywordtype">void</span> <a class="code" href="group__cl__env.html#ga6a2f0ccf8118ede1c1f191a545937eac" title="Exits re-entrancy.">cl_env_reexit</a>(<span class="keywordtype">void</span> *cookie);
<a name="l02474"></a>02474 <span class="keywordtype">void</span> <a class="code" href="group__cl__env.html#gad07c2a6339d36f40375805d9ae5e02cc" title="Setup user-supplied env as a current environment.">cl_env_implant</a>(<span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, __u16 *refcheck);
<a name="l02475"></a>02475 <span class="keywordtype">void</span> <a class="code" href="group__cl__env.html#gace30ddb0f3834c7dad1c4d5315dd63ba" title="Detach environment installed earlier by cl_env_implant().">cl_env_unplant</a>(<span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, __u16 *refcheck);
<a name="l02476"></a>02476 <span class="keywordtype">unsigned</span> <a class="code" href="group__cl__env.html#ga865dfbdba69721fb16c551ec6ce996d1" title="Finalizes and frees a given number of cached environments.">cl_env_cache_purge</a>(<span class="keywordtype">unsigned</span> nr);
<a name="l02477"></a>02477 <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *<a class="code" href="group__cl__env.html#ga8d7bb468153f7ccc6259ecef4dfa91bf">cl_env_percpu_get</a>(<span class="keywordtype">void</span>);
<a name="l02478"></a>02478 <span class="keywordtype">void</span> <a class="code" href="group__cl__env.html#gabbd19d47d20a5e5787bb6e61acaf1461">cl_env_percpu_put</a>(<span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env);
<a name="l02479"></a>02479 
<a name="l02482"></a>02482 <span class="comment">/*</span>
<a name="l02483"></a>02483 <span class="comment"> * Misc</span>
<a name="l02484"></a>02484 <span class="comment"> */</span>
<a name="l02485"></a>02485 <span class="keywordtype">void</span> <a class="code" href="group__clio.html#ga5a05126b8b0aeb6f733aa358791aeed2" title="Converts struct cl_attr to struct ost_lvb.">cl_attr2lvb</a>(<span class="keyword">struct</span> <a class="code" href="structost__lvb.html">ost_lvb</a> *lvb, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcl__attr.html" title="&amp;quot;Data attributes&amp;quot; of cl_object.">cl_attr</a> *attr);
<a name="l02486"></a>02486 <span class="keywordtype">void</span> <a class="code" href="group__clio.html#gad69ffcfdd3d835937721abdc10dd1098" title="Converts struct ost_lvb to struct cl_attr.">cl_lvb2attr</a>(<span class="keyword">struct</span> <a class="code" href="structcl__attr.html" title="&amp;quot;Data attributes&amp;quot; of cl_object.">cl_attr</a> *attr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structost__lvb.html">ost_lvb</a> *lvb);
<a name="l02487"></a>02487 
<a name="l02488"></a>02488 <span class="keyword">struct </span><a class="code" href="structcl__device.html" title="Device in the client stack.">cl_device</a> *<a class="code" href="group__clio.html#ga673ce59def375f145c75249200d9dd53">cl_type_setup</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlu__site.html" title="lu_site is a &amp;quot;compartment&amp;quot; within which objects are unique, and LRU discipline...">lu_site</a> *site,
<a name="l02489"></a>02489                                 <span class="keyword">struct</span> <a class="code" href="structlu__device__type.html" title="Type of device.">lu_device_type</a> *ldt,
<a name="l02490"></a>02490                                 <span class="keyword">struct</span> <a class="code" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a> *next);
<a name="l02493"></a>02493 <span class="keywordtype">int</span> <a class="code" href="cl__object_8h.html#a20177ecada73cc1cd7e366cde320ba33" title="Global initialization of cl-data.">cl_global_init</a>(<span class="keywordtype">void</span>);
<a name="l02494"></a>02494 <span class="keywordtype">void</span> <a class="code" href="cl__object_8h.html#aa126f7175676348b3f0e009121808cec" title="Finalization of global cl-data.">cl_global_fini</a>(<span class="keywordtype">void</span>);
<a name="l02495"></a>02495 
<a name="l02496"></a>02496 <span class="preprocessor">#endif </span><span class="comment">/* _LINUX_CL_OBJECT_H */</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:35 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
