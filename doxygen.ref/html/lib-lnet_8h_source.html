<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lnet/include/lnet/lib-lnet.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>lnet/include/lnet/lib-lnet.h</h1><a href="lib-lnet_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * GPL HEADER START</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> * it under the terms of the GNU General Public License version 2 only,</span>
<a name="l00008"></a>00008 <span class="comment"> * as published by the Free Software Foundation.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * This program is distributed in the hope that it will be useful, but</span>
<a name="l00011"></a>00011 <span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00013"></a>00013 <span class="comment"> * General Public License version 2 for more details (a copy is included</span>
<a name="l00014"></a>00014 <span class="comment"> * in the LICENSE file that accompanied this code).</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> * version 2 along with this program; If not, see</span>
<a name="l00018"></a>00018 <span class="comment"> * http://www.sun.com/software/products/lustre/docs/GPLv2.pdf</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * Please contact Sun Microsystems, Inc., 4150 Network Circle, Santa Clara,</span>
<a name="l00021"></a>00021 <span class="comment"> * CA 95054 USA or visit www.sun.com if you need additional information or</span>
<a name="l00022"></a>00022 <span class="comment"> * have any questions.</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * GPL HEADER END</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 <span class="comment">/*</span>
<a name="l00027"></a>00027 <span class="comment"> * Copyright (c) 2003, 2010, Oracle and/or its affiliates. All rights reserved.</span>
<a name="l00028"></a>00028 <span class="comment"> * Use is subject to license terms.</span>
<a name="l00029"></a>00029 <span class="comment"> *</span>
<a name="l00030"></a>00030 <span class="comment"> * Copyright (c) 2012, 2015, Intel Corporation.</span>
<a name="l00031"></a>00031 <span class="comment"> */</span>
<a name="l00032"></a>00032 <span class="comment">/*</span>
<a name="l00033"></a>00033 <span class="comment"> * This file is part of Lustre, http://www.lustre.org/</span>
<a name="l00034"></a>00034 <span class="comment"> * Lustre is a trademark of Sun Microsystems, Inc.</span>
<a name="l00035"></a>00035 <span class="comment"> *</span>
<a name="l00036"></a>00036 <span class="comment"> * lnet/include/lnet/lib-lnet.h</span>
<a name="l00037"></a>00037 <span class="comment"> *</span>
<a name="l00038"></a>00038 <span class="comment"> * Top level include for library side routines</span>
<a name="l00039"></a>00039 <span class="comment"> */</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="preprocessor">#ifndef __LNET_LIB_LNET_H__</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="preprocessor">#define __LNET_LIB_LNET_H__</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00044"></a>00044 <span class="preprocessor">#ifndef __KERNEL__</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span><span class="preprocessor"># error This include is only for kernel use.</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;<a class="code" href="libcfs_8h.html">libcfs/libcfs.h</a>&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;<a class="code" href="api_8h.html">lnet/api.h</a>&gt;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;<a class="code" href="lnet_8h.html">lnet/lnet.h</a>&gt;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;<a class="code" href="lib-types_8h.html">lnet/lib-types.h</a>&gt;</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="keyword">extern</span> <a class="code" href="structlnet__t.html">lnet_t</a>  <a class="code" href="lib-lnet_8h.html#a2ebb049dac8141476abb8bc313bf2869">the_lnet</a>;                        <span class="comment">/* THE network */</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#if (BITS_PER_LONG == 32)</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="comment">/* 2 CPTs, allowing more CPTs might make us under memory pressure */</span>
<a name="l00057"></a>00057 <span class="preprocessor"># define LNET_CPT_MAX_BITS     1</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span>
<a name="l00059"></a>00059 <span class="preprocessor">#else </span><span class="comment">/* 64-bit system */</span>
<a name="l00060"></a>00060 <span class="comment">/*</span>
<a name="l00061"></a>00061 <span class="comment"> * 256 CPTs for thousands of CPUs, allowing more CPTs might make us</span>
<a name="l00062"></a>00062 <span class="comment"> * under risk of consuming all lh_cookie.</span>
<a name="l00063"></a>00063 <span class="comment"> */</span>
<a name="l00064"></a><a class="code" href="lib-lnet_8h.html#ac77d2f1516abbdef0112dc545b797f6a">00064</a> <span class="preprocessor"># define LNET_CPT_MAX_BITS     8</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* BITS_PER_LONG == 32 */</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="comment">/* max allowed CPT number */</span>
<a name="l00068"></a><a class="code" href="lib-lnet_8h.html#aeb2905f11bfed17e829636fe6bf84b73">00068</a> <span class="preprocessor">#define LNET_CPT_MAX            (1 &lt;&lt; LNET_CPT_MAX_BITS)</span>
<a name="l00069"></a>00069 <span class="preprocessor"></span>
<a name="l00070"></a><a class="code" href="lib-lnet_8h.html#a4f3fe032324f884480559fd678535998">00070</a> <span class="preprocessor">#define LNET_CPT_NUMBER         (the_lnet.ln_cpt_number)</span>
<a name="l00071"></a><a class="code" href="lib-lnet_8h.html#a275831a50d682616f24658c1a192891d">00071</a> <span class="preprocessor"></span><span class="preprocessor">#define LNET_CPT_BITS           (the_lnet.ln_cpt_bits)</span>
<a name="l00072"></a><a class="code" href="lib-lnet_8h.html#a3ac99a72c5122dbf27e60eda92ab8dd6">00072</a> <span class="preprocessor"></span><span class="preprocessor">#define LNET_CPT_MASK           ((1ULL &lt;&lt; LNET_CPT_BITS) - 1)</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span>
<a name="l00075"></a><a class="code" href="lib-lnet_8h.html#accb18308536eb89497e3d85b660986d4">00075</a> <span class="preprocessor">#define LNET_LOCK_EX            CFS_PERCPT_LOCK_EX</span>
<a name="l00076"></a>00076 <span class="preprocessor"></span>
<a name="l00077"></a><a class="code" href="lib-lnet_8h.html#aca50a6027e256f9d4780c32deb10aff4">00077</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#aca50a6027e256f9d4780c32deb10aff4">lnet_is_route_alive</a>(<a class="code" href="structlnet__route__t.html">lnet_route_t</a> *route)
<a name="l00078"></a>00078 {
<a name="l00079"></a>00079         <span class="keywordflow">if</span> (!route-&gt;<a class="code" href="structlnet__route__t.html#a4acb3e5a1115b91a57b9a2fbb10486de">lr_gateway</a>-&gt;<a class="code" href="structlnet__peer.html#a93b08b2e2755d5ba314e5671614fffc4">lp_alive</a>)
<a name="l00080"></a>00080                 <span class="keywordflow">return</span> 0; <span class="comment">/* gateway is down */</span>
<a name="l00081"></a>00081         <span class="keywordflow">if</span> ((route-&gt;<a class="code" href="structlnet__route__t.html#a4acb3e5a1115b91a57b9a2fbb10486de">lr_gateway</a>-&gt;<a class="code" href="structlnet__peer.html#a537cc824665c1fc15591483cd5e5f1e8">lp_ping_feats</a> &amp;
<a name="l00082"></a>00082              <a class="code" href="lib-types_8h.html#a5986e87c9dab88b3dcf10aec66bba4aa">LNET_PING_FEAT_NI_STATUS</a>) == 0)
<a name="l00083"></a>00083                 <span class="keywordflow">return</span> 1; <span class="comment">/* no NI status, assume it&apos;s alive */</span>
<a name="l00084"></a>00084         <span class="comment">/* has NI status, check # down NIs */</span>
<a name="l00085"></a>00085         <span class="keywordflow">return</span> route-&gt;<a class="code" href="structlnet__route__t.html#af051f41159dfbd5002598ca41412d1e1">lr_downis</a> == 0;
<a name="l00086"></a>00086 }
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="lib-lnet_8h.html#a169a5fb62a46068040419ada4f236df5">00088</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a169a5fb62a46068040419ada4f236df5">lnet_is_wire_handle_none</a> (lnet_handle_wire_t *wh)
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090         <span class="keywordflow">return</span> (wh-&gt;wh_interface_cookie == <a class="code" href="group__lnet__addr.html#gae9f9091866aa1abbba5218deab5c8d85">LNET_WIRE_HANDLE_COOKIE_NONE</a> &amp;&amp;
<a name="l00091"></a>00091                 wh-&gt;wh_object_cookie == <a class="code" href="group__lnet__addr.html#gae9f9091866aa1abbba5218deab5c8d85">LNET_WIRE_HANDLE_COOKIE_NONE</a>);
<a name="l00092"></a>00092 }
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="lib-lnet_8h.html#aced0f8d6679e71f12651a7d81b0b7582">00094</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#aced0f8d6679e71f12651a7d81b0b7582">lnet_md_exhausted</a> (<a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *md)
<a name="l00095"></a>00095 {
<a name="l00096"></a>00096         <span class="keywordflow">return</span> (md-&gt;<a class="code" href="structlnet__libmd.html#ab9b726f426a7d3e7e88a44f2d7558e57">md_threshold</a> == 0 ||
<a name="l00097"></a>00097                 ((md-&gt;<a class="code" href="structlnet__libmd.html#aa09a904a9db90a4a47acc06d108827c1">md_options</a> &amp; <a class="code" href="group__lnet__md.html#ga05bfd5b03abc8ded1b209b51bf65973f" title="See lnet_md_t::options.">LNET_MD_MAX_SIZE</a>) != 0 &amp;&amp;
<a name="l00098"></a>00098                  md-&gt;<a class="code" href="structlnet__libmd.html#adb24e275d106265021b78e759ecbeaf7">md_offset</a> + md-&gt;<a class="code" href="structlnet__libmd.html#af8ba863e9da6cad6d871aa3676126d9e">md_max_size</a> &gt; md-&gt;<a class="code" href="structlnet__libmd.html#af69c046f9f1bc2ed36aba12c45af33d5">md_length</a>));
<a name="l00099"></a>00099 }
<a name="l00100"></a>00100 
<a name="l00101"></a><a class="code" href="lib-lnet_8h.html#ae298d1d5aad09bfe6b9d33985d28b9e8">00101</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#ae298d1d5aad09bfe6b9d33985d28b9e8">lnet_md_unlinkable</a> (<a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *md)
<a name="l00102"></a>00102 {
<a name="l00103"></a>00103         <span class="comment">/* Should unlink md when its refcount is 0 and either:</span>
<a name="l00104"></a>00104 <span class="comment">         *  - md has been flagged for deletion (by auto unlink or LNetM[DE]Unlink,</span>
<a name="l00105"></a>00105 <span class="comment">         *    in the latter case md may not be exhausted).</span>
<a name="l00106"></a>00106 <span class="comment">         *  - auto unlink is on and md is exhausted.</span>
<a name="l00107"></a>00107 <span class="comment">         */</span>
<a name="l00108"></a>00108         <span class="keywordflow">if</span> (md-&gt;<a class="code" href="structlnet__libmd.html#adf9a3416433fbb85d990dd49dc794c6c">md_refcount</a> != 0)
<a name="l00109"></a>00109                 <span class="keywordflow">return</span> 0;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111         <span class="keywordflow">if</span> ((md-&gt;<a class="code" href="structlnet__libmd.html#a4aa4f6002ac5a4a2d195872c02942473">md_flags</a> &amp; <a class="code" href="lib-types_8h.html#a2c5b7452e731f04cf4a39518fb5aa084">LNET_MD_FLAG_ZOMBIE</a>) != 0)
<a name="l00112"></a>00112                 <span class="keywordflow">return</span> 1;
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         <span class="keywordflow">return</span> ((md-&gt;<a class="code" href="structlnet__libmd.html#a4aa4f6002ac5a4a2d195872c02942473">md_flags</a> &amp; <a class="code" href="lib-types_8h.html#a539da9394199673b9037c55288dabde1">LNET_MD_FLAG_AUTO_UNLINK</a>) != 0 &amp;&amp;
<a name="l00115"></a>00115                 <a class="code" href="lib-lnet_8h.html#aced0f8d6679e71f12651a7d81b0b7582">lnet_md_exhausted</a>(md));
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 
<a name="l00118"></a><a class="code" href="lib-lnet_8h.html#ab896d9090e78ac2c20a14dc983b329ae">00118</a> <span class="preprocessor">#define lnet_cpt_table()        (the_lnet.ln_cpt_table)</span>
<a name="l00119"></a><a class="code" href="lib-lnet_8h.html#a57cc495a66d3bb996a71cd1078b79dd5">00119</a> <span class="preprocessor"></span><span class="preprocessor">#define lnet_cpt_current()      cfs_cpt_current(the_lnet.ln_cpt_table, 1)</span>
<a name="l00120"></a>00120 <span class="preprocessor"></span>
<a name="l00121"></a>00121 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00122"></a><a class="code" href="lib-lnet_8h.html#af0b1cda844363ede670a5cf6902b3067">00122</a> <a class="code" href="lib-lnet_8h.html#af0b1cda844363ede670a5cf6902b3067">lnet_cpt_of_cookie</a>(<a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> cookie)
<a name="l00123"></a>00123 {
<a name="l00124"></a>00124         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cpt = (cookie &gt;&gt; <a class="code" href="lib-types_8h.html#a7296a5cddaf2b8383561621e6c4da8dc">LNET_COOKIE_TYPE_BITS</a>) &amp; <a class="code" href="lib-lnet_8h.html#a3ac99a72c5122dbf27e60eda92ab8dd6">LNET_CPT_MASK</a>;
<a name="l00125"></a>00125 
<a name="l00126"></a>00126         <span class="comment">/* LNET_CPT_NUMBER doesn&apos;t have to be power2, which means we can</span>
<a name="l00127"></a>00127 <span class="comment">         * get illegal cpt from it&apos;s invalid cookie */</span>
<a name="l00128"></a>00128         <span class="keywordflow">return</span> cpt &lt; <a class="code" href="lib-lnet_8h.html#a4f3fe032324f884480559fd678535998">LNET_CPT_NUMBER</a> ? cpt : cpt % <a class="code" href="lib-lnet_8h.html#a4f3fe032324f884480559fd678535998">LNET_CPT_NUMBER</a>;
<a name="l00129"></a>00129 }
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00132"></a><a class="code" href="lib-lnet_8h.html#afef15cc47086d14faed4918ef2fe3172">00132</a> <a class="code" href="lib-lnet_8h.html#afef15cc47086d14faed4918ef2fe3172">lnet_res_lock</a>(<span class="keywordtype">int</span> cpt)
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134         <a class="code" href="libcfs__cpu_8h.html#a4437ef1809f39048a4b89654aa4d83a2" title="lock a CPU partition">cfs_percpt_lock</a>(the_lnet.<a class="code" href="structlnet__t.html#a27b9cc1604d420562c55c6db5cbe05dc">ln_res_lock</a>, cpt);
<a name="l00135"></a>00135 }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00138"></a><a class="code" href="lib-lnet_8h.html#aaaee882f257cf6fa8b40afe2aac52c47">00138</a> <a class="code" href="lib-lnet_8h.html#aaaee882f257cf6fa8b40afe2aac52c47">lnet_res_unlock</a>(<span class="keywordtype">int</span> cpt)
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140         <a class="code" href="libcfs__cpu_8h.html#af53b174c4b89f74dd90773500b656389" title="unlock a CPU partition">cfs_percpt_unlock</a>(the_lnet.<a class="code" href="structlnet__t.html#a27b9cc1604d420562c55c6db5cbe05dc">ln_res_lock</a>, cpt);
<a name="l00141"></a>00141 }
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00144"></a><a class="code" href="lib-lnet_8h.html#af8c2f56968fac81a0b39dbf019c22a20">00144</a> <a class="code" href="lib-lnet_8h.html#af8c2f56968fac81a0b39dbf019c22a20">lnet_res_lock_current</a>(<span class="keywordtype">void</span>)
<a name="l00145"></a>00145 {
<a name="l00146"></a>00146         <span class="keywordtype">int</span> cpt = <a class="code" href="lib-lnet_8h.html#a57cc495a66d3bb996a71cd1078b79dd5">lnet_cpt_current</a>();
<a name="l00147"></a>00147 
<a name="l00148"></a>00148         <a class="code" href="lib-lnet_8h.html#afef15cc47086d14faed4918ef2fe3172">lnet_res_lock</a>(cpt);
<a name="l00149"></a>00149         <span class="keywordflow">return</span> cpt;
<a name="l00150"></a>00150 }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00153"></a><a class="code" href="lib-lnet_8h.html#a7fc206b00833a673f27a8390127f89f2">00153</a> <a class="code" href="lib-lnet_8h.html#a7fc206b00833a673f27a8390127f89f2">lnet_net_lock</a>(<span class="keywordtype">int</span> cpt)
<a name="l00154"></a>00154 {
<a name="l00155"></a>00155         <a class="code" href="libcfs__cpu_8h.html#a4437ef1809f39048a4b89654aa4d83a2" title="lock a CPU partition">cfs_percpt_lock</a>(the_lnet.<a class="code" href="structlnet__t.html#a2317da329d4d077a2a160d11a9e5eeb9">ln_net_lock</a>, cpt);
<a name="l00156"></a>00156 }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00159"></a><a class="code" href="lib-lnet_8h.html#aed3dedee4b0b16ad19eb739f6b91ea7d">00159</a> <a class="code" href="lib-lnet_8h.html#aed3dedee4b0b16ad19eb739f6b91ea7d">lnet_net_unlock</a>(<span class="keywordtype">int</span> cpt)
<a name="l00160"></a>00160 {
<a name="l00161"></a>00161         <a class="code" href="libcfs__cpu_8h.html#af53b174c4b89f74dd90773500b656389" title="unlock a CPU partition">cfs_percpt_unlock</a>(the_lnet.<a class="code" href="structlnet__t.html#a2317da329d4d077a2a160d11a9e5eeb9">ln_net_lock</a>, cpt);
<a name="l00162"></a>00162 }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00165"></a><a class="code" href="lib-lnet_8h.html#a5b3481075a896e44a34493b243d82eb7">00165</a> <a class="code" href="lib-lnet_8h.html#a5b3481075a896e44a34493b243d82eb7">lnet_net_lock_current</a>(<span class="keywordtype">void</span>)
<a name="l00166"></a>00166 {
<a name="l00167"></a>00167         <span class="keywordtype">int</span> cpt = <a class="code" href="lib-lnet_8h.html#a57cc495a66d3bb996a71cd1078b79dd5">lnet_cpt_current</a>();
<a name="l00168"></a>00168 
<a name="l00169"></a>00169         <a class="code" href="lib-lnet_8h.html#a7fc206b00833a673f27a8390127f89f2">lnet_net_lock</a>(cpt);
<a name="l00170"></a>00170         <span class="keywordflow">return</span> cpt;
<a name="l00171"></a>00171 }
<a name="l00172"></a>00172 
<a name="l00173"></a><a class="code" href="lib-lnet_8h.html#aa5c534dcdcae35050527c5a74d3739ed">00173</a> <span class="preprocessor">#define LNET_LOCK()             lnet_net_lock(LNET_LOCK_EX)</span>
<a name="l00174"></a><a class="code" href="lib-lnet_8h.html#a01030b695b85461d45e11b7e724dd163">00174</a> <span class="preprocessor"></span><span class="preprocessor">#define LNET_UNLOCK()           lnet_net_unlock(LNET_LOCK_EX)</span>
<a name="l00175"></a>00175 <span class="preprocessor"></span>
<a name="l00176"></a><a class="code" href="lib-lnet_8h.html#adc4110db6da2ee9065336a15c77da7cf">00176</a> <span class="preprocessor">#define lnet_ptl_lock(ptl)      spin_lock(&amp;(ptl)-&gt;ptl_lock)</span>
<a name="l00177"></a><a class="code" href="lib-lnet_8h.html#a91709d4fce5b06472b7d751af20aee8d">00177</a> <span class="preprocessor"></span><span class="preprocessor">#define lnet_ptl_unlock(ptl)    spin_unlock(&amp;(ptl)-&gt;ptl_lock)</span>
<a name="l00178"></a><a class="code" href="lib-lnet_8h.html#a065b9dd435e0a811de48adef04a2576b">00178</a> <span class="preprocessor"></span><span class="preprocessor">#define lnet_eq_wait_lock()     spin_lock(&amp;the_lnet.ln_eq_wait_lock)</span>
<a name="l00179"></a><a class="code" href="lib-lnet_8h.html#a2a41f6e4abda5a1b3b847090cc9eabaa">00179</a> <span class="preprocessor"></span><span class="preprocessor">#define lnet_eq_wait_unlock()   spin_unlock(&amp;the_lnet.ln_eq_wait_lock)</span>
<a name="l00180"></a><a class="code" href="lib-lnet_8h.html#a9ec9cdb7649cadb2ccd72d4f304ce19e">00180</a> <span class="preprocessor"></span><span class="preprocessor">#define lnet_ni_lock(ni)        spin_lock(&amp;(ni)-&gt;ni_lock)</span>
<a name="l00181"></a><a class="code" href="lib-lnet_8h.html#ae98bce60b970033c5e81d2329d36e250">00181</a> <span class="preprocessor"></span><span class="preprocessor">#define lnet_ni_unlock(ni)      spin_unlock(&amp;(ni)-&gt;ni_lock)</span>
<a name="l00182"></a>00182 <span class="preprocessor"></span>
<a name="l00183"></a><a class="code" href="lib-lnet_8h.html#a1a21103ff7897e443ce6d9f4e8c75867">00183</a> <span class="preprocessor">#define MAX_PORTALS     64</span>
<a name="l00184"></a>00184 <span class="preprocessor"></span>
<a name="l00185"></a>00185 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="structlnet__eq.html">lnet_eq_t</a> *
<a name="l00186"></a><a class="code" href="lib-lnet_8h.html#a71ad96627a526f59b4e13af4d117504e">00186</a> <a class="code" href="lib-lnet_8h.html#a71ad96627a526f59b4e13af4d117504e">lnet_eq_alloc</a> (<span class="keywordtype">void</span>)
<a name="l00187"></a>00187 {
<a name="l00188"></a>00188         <a class="code" href="structlnet__eq.html">lnet_eq_t</a> *eq;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190         <a class="code" href="libcfs__private_8h.html#a87a8b94124ee7f73a969859a2fd83294">LIBCFS_ALLOC</a>(eq, <span class="keyword">sizeof</span>(*eq));
<a name="l00191"></a>00191         <span class="keywordflow">return</span> (eq);
<a name="l00192"></a>00192 }
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00195"></a><a class="code" href="lib-lnet_8h.html#a514e428941883ba46eb7ab345ee05191">00195</a> <a class="code" href="lib-lnet_8h.html#a514e428941883ba46eb7ab345ee05191">lnet_eq_free</a>(<a class="code" href="structlnet__eq.html">lnet_eq_t</a> *eq)
<a name="l00196"></a>00196 {
<a name="l00197"></a>00197         <a class="code" href="libcfs__private_8h.html#a41386bf0bd3a9596cd7161910902f4e7">LIBCFS_FREE</a>(eq, <span class="keyword">sizeof</span>(*eq));
<a name="l00198"></a>00198 }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *
<a name="l00201"></a><a class="code" href="lib-lnet_8h.html#a89855889fbb0e8b29e563540c57fc5e6">00201</a> <a class="code" href="lib-lnet_8h.html#a89855889fbb0e8b29e563540c57fc5e6">lnet_md_alloc</a> (<a class="code" href="structlnet__md__t.html" title="Defines the visible parts of a memory descriptor.">lnet_md_t</a> *umd)
<a name="l00202"></a>00202 {
<a name="l00203"></a>00203         <a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *md;
<a name="l00204"></a>00204         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  <a class="code" href="lp__utils_8h.html#a439227feff9d7f55384e8780cfc2eb82">size</a>;
<a name="l00205"></a>00205         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  niov;
<a name="l00206"></a>00206 
<a name="l00207"></a>00207         <span class="keywordflow">if</span> ((umd-&gt;<a class="code" href="structlnet__md__t.html#af37df46d5729b86dd662a2bcecb2fe13" title="Specifies the behavior of the memory descriptor.">options</a> &amp; <a class="code" href="group__lnet__md.html#gad9555865426bac84ce57b5ed4a0059a2" title="See lnet_md_t::options.">LNET_MD_KIOV</a>) != 0) {
<a name="l00208"></a>00208                 niov = umd-&gt;<a class="code" href="structlnet__md__t.html#a693d7e99378bc53774ee5d96c980fe7b">length</a>;
<a name="l00209"></a>00209                 size = <a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(<a class="code" href="structlnet__libmd.html">lnet_libmd_t</a>, md_iov.kiov[niov]);
<a name="l00210"></a>00210         } <span class="keywordflow">else</span> {
<a name="l00211"></a>00211                 niov = ((umd-&gt;<a class="code" href="structlnet__md__t.html#af37df46d5729b86dd662a2bcecb2fe13" title="Specifies the behavior of the memory descriptor.">options</a> &amp; <a class="code" href="group__lnet__md.html#gacd7ecdcabac21b089dc8e101048bffc1" title="See lnet_md_t::options.">LNET_MD_IOVEC</a>) != 0) ?
<a name="l00212"></a>00212                        umd-&gt;<a class="code" href="structlnet__md__t.html#a693d7e99378bc53774ee5d96c980fe7b">length</a> : 1;
<a name="l00213"></a>00213                 size = <a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(<a class="code" href="structlnet__libmd.html">lnet_libmd_t</a>, md_iov.iov[niov]);
<a name="l00214"></a>00214         }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216         <a class="code" href="libcfs__private_8h.html#a87a8b94124ee7f73a969859a2fd83294">LIBCFS_ALLOC</a>(md, size);
<a name="l00217"></a>00217 
<a name="l00218"></a>00218         <span class="keywordflow">if</span> (md != NULL) {
<a name="l00219"></a>00219                 <span class="comment">/* Set here in case of early free */</span>
<a name="l00220"></a>00220                 md-&gt;<a class="code" href="structlnet__libmd.html#aa09a904a9db90a4a47acc06d108827c1">md_options</a> = umd-&gt;<a class="code" href="structlnet__md__t.html#af37df46d5729b86dd662a2bcecb2fe13" title="Specifies the behavior of the memory descriptor.">options</a>;
<a name="l00221"></a>00221                 md-&gt;<a class="code" href="structlnet__libmd.html#aafac482671fdf9f30797855b8256cc2c">md_niov</a> = niov;
<a name="l00222"></a>00222                 <a class="code" href="list_8h.html#a0ffe9d28c36d7b018a9cfae33bae45c0">INIT_LIST_HEAD</a>(&amp;md-&gt;<a class="code" href="structlnet__libmd.html#a4b416688f76cad018d05d9c114efadde">md_list</a>);
<a name="l00223"></a>00223         }
<a name="l00224"></a>00224 
<a name="l00225"></a>00225         <span class="keywordflow">return</span> md;
<a name="l00226"></a>00226 }
<a name="l00227"></a>00227 
<a name="l00228"></a>00228 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00229"></a><a class="code" href="lib-lnet_8h.html#a1d9747a59ef63794aea036830ed53f77">00229</a> <a class="code" href="lib-lnet_8h.html#a1d9747a59ef63794aea036830ed53f77">lnet_md_free</a>(<a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *md)
<a name="l00230"></a>00230 {
<a name="l00231"></a>00231         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  <a class="code" href="lp__utils_8h.html#a439227feff9d7f55384e8780cfc2eb82">size</a>;
<a name="l00232"></a>00232 
<a name="l00233"></a>00233         <span class="keywordflow">if</span> ((md-&gt;<a class="code" href="structlnet__libmd.html#aa09a904a9db90a4a47acc06d108827c1">md_options</a> &amp; <a class="code" href="group__lnet__md.html#gad9555865426bac84ce57b5ed4a0059a2" title="See lnet_md_t::options.">LNET_MD_KIOV</a>) != 0)
<a name="l00234"></a>00234                 size = <a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(<a class="code" href="structlnet__libmd.html">lnet_libmd_t</a>, md_iov.kiov[md-&gt;<a class="code" href="structlnet__libmd.html#aafac482671fdf9f30797855b8256cc2c">md_niov</a>]);
<a name="l00235"></a>00235         <span class="keywordflow">else</span>
<a name="l00236"></a>00236                 size = <a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(<a class="code" href="structlnet__libmd.html">lnet_libmd_t</a>, md_iov.iov[md-&gt;<a class="code" href="structlnet__libmd.html#aafac482671fdf9f30797855b8256cc2c">md_niov</a>]);
<a name="l00237"></a>00237 
<a name="l00238"></a>00238         <a class="code" href="libcfs__private_8h.html#a41386bf0bd3a9596cd7161910902f4e7">LIBCFS_FREE</a>(md, size);
<a name="l00239"></a>00239 }
<a name="l00240"></a>00240 
<a name="l00241"></a>00241 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="structlnet__me.html">lnet_me_t</a> *
<a name="l00242"></a><a class="code" href="lib-lnet_8h.html#ac8490318c93294ca0c267f3f620b0f4b">00242</a> <a class="code" href="lib-lnet_8h.html#ac8490318c93294ca0c267f3f620b0f4b">lnet_me_alloc</a> (<span class="keywordtype">void</span>)
<a name="l00243"></a>00243 {
<a name="l00244"></a>00244         <a class="code" href="structlnet__me.html">lnet_me_t</a> *me;
<a name="l00245"></a>00245 
<a name="l00246"></a>00246         <a class="code" href="libcfs__private_8h.html#a87a8b94124ee7f73a969859a2fd83294">LIBCFS_ALLOC</a>(me, <span class="keyword">sizeof</span>(*me));
<a name="l00247"></a>00247         <span class="keywordflow">return</span> (me);
<a name="l00248"></a>00248 }
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00251"></a><a class="code" href="lib-lnet_8h.html#adf4135afb6fe9340880ce3fff8a21fd2">00251</a> <a class="code" href="lib-lnet_8h.html#adf4135afb6fe9340880ce3fff8a21fd2">lnet_me_free</a>(<a class="code" href="structlnet__me.html">lnet_me_t</a> *me)
<a name="l00252"></a>00252 {
<a name="l00253"></a>00253         <a class="code" href="libcfs__private_8h.html#a41386bf0bd3a9596cd7161910902f4e7">LIBCFS_FREE</a>(me, <span class="keyword">sizeof</span>(*me));
<a name="l00254"></a>00254 }
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="structlnet__msg.html">lnet_msg_t</a> *
<a name="l00257"></a><a class="code" href="lib-lnet_8h.html#a8d64051bcf43d20a43f733ac0b765d3b">00257</a> <a class="code" href="lib-lnet_8h.html#a8d64051bcf43d20a43f733ac0b765d3b">lnet_msg_alloc</a>(<span class="keywordtype">void</span>)
<a name="l00258"></a>00258 {
<a name="l00259"></a>00259         <a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>;
<a name="l00260"></a>00260 
<a name="l00261"></a>00261         <a class="code" href="libcfs__private_8h.html#a87a8b94124ee7f73a969859a2fd83294">LIBCFS_ALLOC</a>(msg, <span class="keyword">sizeof</span>(*msg));
<a name="l00262"></a>00262 
<a name="l00263"></a>00263         <span class="comment">/* no need to zero, LIBCFS_ALLOC does for us */</span>
<a name="l00264"></a>00264         <span class="keywordflow">return</span> (msg);
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00268"></a><a class="code" href="lib-lnet_8h.html#a2a02fb083c5e2595493e7bc3b806f78b">00268</a> <a class="code" href="lib-lnet_8h.html#a2a02fb083c5e2595493e7bc3b806f78b">lnet_msg_free</a>(<a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)
<a name="l00269"></a>00269 {
<a name="l00270"></a>00270         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(!msg-&gt;<a class="code" href="structlnet__msg.html#a91dc999a8d001c652512c813f961f9d4">msg_onactivelist</a>);
<a name="l00271"></a>00271         <a class="code" href="libcfs__private_8h.html#a41386bf0bd3a9596cd7161910902f4e7">LIBCFS_FREE</a>(msg, <span class="keyword">sizeof</span>(*msg));
<a name="l00272"></a>00272 }
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 <a class="code" href="structlnet__libhandle.html">lnet_libhandle_t</a> *<a class="code" href="lib-lnet_8h.html#a40bfec4f531e5db297338a7a3d5cce8c">lnet_res_lh_lookup</a>(<span class="keyword">struct</span> <a class="code" href="structlnet__res__container.html">lnet_res_container</a> *rec,
<a name="l00275"></a>00275                                      <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> cookie);
<a name="l00276"></a>00276 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a4c2cc7d7fb0445ab2f13c602e18292a5">lnet_res_lh_initialize</a>(<span class="keyword">struct</span> <a class="code" href="structlnet__res__container.html">lnet_res_container</a> *rec,
<a name="l00277"></a>00277                             <a class="code" href="structlnet__libhandle.html">lnet_libhandle_t</a> *lh);
<a name="l00278"></a>00278 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00279"></a><a class="code" href="lib-lnet_8h.html#a3f576e8190d6085a6a57c9792761c7f7">00279</a> <a class="code" href="lib-lnet_8h.html#a3f576e8190d6085a6a57c9792761c7f7">lnet_res_lh_invalidate</a>(<a class="code" href="structlnet__libhandle.html">lnet_libhandle_t</a> *lh)
<a name="l00280"></a>00280 {
<a name="l00281"></a>00281         <span class="comment">/* ALWAYS called with resource lock held */</span>
<a name="l00282"></a>00282         <span class="comment">/* NB: cookie is still useful, don&apos;t reset it */</span>
<a name="l00283"></a>00283         <a class="code" href="list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title="Remove an entry from the list it is currently in.">list_del</a>(&amp;lh-&gt;<a class="code" href="structlnet__libhandle.html#a32799022375291467c1a98fe0751b0ea">lh_hash_chain</a>);
<a name="l00284"></a>00284 }
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00287"></a><a class="code" href="lib-lnet_8h.html#a95f7bcb63f1a038370da05088cedb0ce">00287</a> <a class="code" href="lib-lnet_8h.html#a95f7bcb63f1a038370da05088cedb0ce">lnet_eq2handle</a> (<a class="code" href="structlnet__handle__any__t.html" title="Objects maintained by the LNet are accessed through handles.">lnet_handle_eq_t</a> *handle, <a class="code" href="structlnet__eq.html">lnet_eq_t</a> *eq)
<a name="l00288"></a>00288 {
<a name="l00289"></a>00289         <span class="keywordflow">if</span> (eq == NULL) {
<a name="l00290"></a>00290                 <a class="code" href="group__lnet__addr.html#gab3d30e46ea269d8b39d4851c3a7c8052" title="Invalidate handle h.">LNetInvalidateHandle</a>(handle);
<a name="l00291"></a>00291                 <span class="keywordflow">return</span>;
<a name="l00292"></a>00292         }
<a name="l00293"></a>00293 
<a name="l00294"></a>00294         handle-&gt;<a class="code" href="structlnet__handle__any__t.html#a71f7bb7cb3df3cb456075393dc2261c4">cookie</a> = eq-&gt;<a class="code" href="structlnet__eq.html#ac54e3d4df0572e9617f7c806091be0f8">eq_lh</a>.<a class="code" href="structlnet__libhandle.html#a6100b66a5a6404b9112c2d186ab63cf8">lh_cookie</a>;
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="structlnet__eq.html">lnet_eq_t</a> *
<a name="l00298"></a><a class="code" href="lib-lnet_8h.html#a48b880cd6857bbd2b2401e09895f9459">00298</a> <a class="code" href="lib-lnet_8h.html#a48b880cd6857bbd2b2401e09895f9459">lnet_handle2eq</a>(<a class="code" href="structlnet__handle__any__t.html" title="Objects maintained by the LNet are accessed through handles.">lnet_handle_eq_t</a> *handle)
<a name="l00299"></a>00299 {
<a name="l00300"></a>00300         <span class="comment">/* ALWAYS called with resource lock held */</span>
<a name="l00301"></a>00301         <a class="code" href="structlnet__libhandle.html">lnet_libhandle_t</a> *lh;
<a name="l00302"></a>00302 
<a name="l00303"></a>00303         lh = <a class="code" href="lib-lnet_8h.html#a40bfec4f531e5db297338a7a3d5cce8c">lnet_res_lh_lookup</a>(&amp;the_lnet.<a class="code" href="structlnet__t.html#a9437fca8da9d40aca12e9bd5b85582ed">ln_eq_container</a>, handle-&gt;<a class="code" href="structlnet__handle__any__t.html#a71f7bb7cb3df3cb456075393dc2261c4">cookie</a>);
<a name="l00304"></a>00304         <span class="keywordflow">if</span> (lh == NULL)
<a name="l00305"></a>00305                 <span class="keywordflow">return</span> NULL;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307         <span class="keywordflow">return</span> <a class="code" href="lib-types_8h.html#a2ed4466401e1844b887817d2bdd4e602">lh_entry</a>(lh, <a class="code" href="structlnet__eq.html">lnet_eq_t</a>, eq_lh);
<a name="l00308"></a>00308 }
<a name="l00309"></a>00309 
<a name="l00310"></a>00310 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00311"></a><a class="code" href="lib-lnet_8h.html#ab58c064af4e1aad0ca03b49c7ea4891d">00311</a> <a class="code" href="lib-lnet_8h.html#ab58c064af4e1aad0ca03b49c7ea4891d">lnet_md2handle</a> (<a class="code" href="structlnet__handle__any__t.html" title="Objects maintained by the LNet are accessed through handles.">lnet_handle_md_t</a> *handle, <a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *md)
<a name="l00312"></a>00312 {
<a name="l00313"></a>00313         handle-&gt;<a class="code" href="structlnet__handle__any__t.html#a71f7bb7cb3df3cb456075393dc2261c4">cookie</a> = md-&gt;<a class="code" href="structlnet__libmd.html#a798ab2f4e58cf8105143c3f6f0d0c63d">md_lh</a>.<a class="code" href="structlnet__libhandle.html#a6100b66a5a6404b9112c2d186ab63cf8">lh_cookie</a>;
<a name="l00314"></a>00314 }
<a name="l00315"></a>00315 
<a name="l00316"></a>00316 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *
<a name="l00317"></a><a class="code" href="lib-lnet_8h.html#a0d66207ee8896d3b777b7c9c42cc23e3">00317</a> <a class="code" href="lib-lnet_8h.html#a0d66207ee8896d3b777b7c9c42cc23e3">lnet_handle2md</a>(<a class="code" href="structlnet__handle__any__t.html" title="Objects maintained by the LNet are accessed through handles.">lnet_handle_md_t</a> *handle)
<a name="l00318"></a>00318 {
<a name="l00319"></a>00319         <span class="comment">/* ALWAYS called with resource lock held */</span>
<a name="l00320"></a>00320         <a class="code" href="structlnet__libhandle.html">lnet_libhandle_t</a> *lh;
<a name="l00321"></a>00321         <span class="keywordtype">int</span>              cpt;
<a name="l00322"></a>00322 
<a name="l00323"></a>00323         cpt = <a class="code" href="lib-lnet_8h.html#af0b1cda844363ede670a5cf6902b3067">lnet_cpt_of_cookie</a>(handle-&gt;<a class="code" href="structlnet__handle__any__t.html#a71f7bb7cb3df3cb456075393dc2261c4">cookie</a>);
<a name="l00324"></a>00324         lh = <a class="code" href="lib-lnet_8h.html#a40bfec4f531e5db297338a7a3d5cce8c">lnet_res_lh_lookup</a>(the_lnet.<a class="code" href="structlnet__t.html#a152cba71824a29d15d1e62afd9623edb">ln_md_containers</a>[cpt],
<a name="l00325"></a>00325                                 handle-&gt;<a class="code" href="structlnet__handle__any__t.html#a71f7bb7cb3df3cb456075393dc2261c4">cookie</a>);
<a name="l00326"></a>00326         <span class="keywordflow">if</span> (lh == NULL)
<a name="l00327"></a>00327                 <span class="keywordflow">return</span> NULL;
<a name="l00328"></a>00328 
<a name="l00329"></a>00329         <span class="keywordflow">return</span> <a class="code" href="lib-types_8h.html#a2ed4466401e1844b887817d2bdd4e602">lh_entry</a>(lh, <a class="code" href="structlnet__libmd.html">lnet_libmd_t</a>, md_lh);
<a name="l00330"></a>00330 }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *
<a name="l00333"></a><a class="code" href="lib-lnet_8h.html#a6b7dc64649c831ca5c761aaacbeb292d">00333</a> <a class="code" href="lib-lnet_8h.html#a6b7dc64649c831ca5c761aaacbeb292d">lnet_wire_handle2md</a>(lnet_handle_wire_t *wh)
<a name="l00334"></a>00334 {
<a name="l00335"></a>00335         <span class="comment">/* ALWAYS called with resource lock held */</span>
<a name="l00336"></a>00336         <a class="code" href="structlnet__libhandle.html">lnet_libhandle_t</a> *lh;
<a name="l00337"></a>00337         <span class="keywordtype">int</span>              cpt;
<a name="l00338"></a>00338 
<a name="l00339"></a>00339         <span class="keywordflow">if</span> (wh-&gt;wh_interface_cookie != the_lnet.<a class="code" href="structlnet__t.html#a439064815a6639de1d683f2a43468b4a">ln_interface_cookie</a>)
<a name="l00340"></a>00340                 <span class="keywordflow">return</span> NULL;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342         cpt = <a class="code" href="lib-lnet_8h.html#af0b1cda844363ede670a5cf6902b3067">lnet_cpt_of_cookie</a>(wh-&gt;wh_object_cookie);
<a name="l00343"></a>00343         lh = <a class="code" href="lib-lnet_8h.html#a40bfec4f531e5db297338a7a3d5cce8c">lnet_res_lh_lookup</a>(the_lnet.<a class="code" href="structlnet__t.html#a152cba71824a29d15d1e62afd9623edb">ln_md_containers</a>[cpt],
<a name="l00344"></a>00344                                 wh-&gt;wh_object_cookie);
<a name="l00345"></a>00345         <span class="keywordflow">if</span> (lh == NULL)
<a name="l00346"></a>00346                 <span class="keywordflow">return</span> NULL;
<a name="l00347"></a>00347 
<a name="l00348"></a>00348         <span class="keywordflow">return</span> <a class="code" href="lib-types_8h.html#a2ed4466401e1844b887817d2bdd4e602">lh_entry</a>(lh, <a class="code" href="structlnet__libmd.html">lnet_libmd_t</a>, md_lh);
<a name="l00349"></a>00349 }
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00352"></a><a class="code" href="lib-lnet_8h.html#a798a0f4502923592bb6cec3fa3ff0b13">00352</a> <a class="code" href="lib-lnet_8h.html#a798a0f4502923592bb6cec3fa3ff0b13">lnet_me2handle</a> (<a class="code" href="structlnet__handle__any__t.html" title="Objects maintained by the LNet are accessed through handles.">lnet_handle_me_t</a> *handle, <a class="code" href="structlnet__me.html">lnet_me_t</a> *me)
<a name="l00353"></a>00353 {
<a name="l00354"></a>00354         handle-&gt;<a class="code" href="structlnet__handle__any__t.html#a71f7bb7cb3df3cb456075393dc2261c4">cookie</a> = me-&gt;<a class="code" href="structlnet__me.html#aced5499a649234e2e155192162eb4f0f">me_lh</a>.<a class="code" href="structlnet__libhandle.html#a6100b66a5a6404b9112c2d186ab63cf8">lh_cookie</a>;
<a name="l00355"></a>00355 }
<a name="l00356"></a>00356 
<a name="l00357"></a>00357 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="structlnet__me.html">lnet_me_t</a> *
<a name="l00358"></a><a class="code" href="lib-lnet_8h.html#ab361c31b97dd36fde272d2de8d705f5a">00358</a> <a class="code" href="lib-lnet_8h.html#ab361c31b97dd36fde272d2de8d705f5a">lnet_handle2me</a>(<a class="code" href="structlnet__handle__any__t.html" title="Objects maintained by the LNet are accessed through handles.">lnet_handle_me_t</a> *handle)
<a name="l00359"></a>00359 {
<a name="l00360"></a>00360         <span class="comment">/* ALWAYS called with resource lock held */</span>
<a name="l00361"></a>00361         <a class="code" href="structlnet__libhandle.html">lnet_libhandle_t</a> *lh;
<a name="l00362"></a>00362         <span class="keywordtype">int</span>              cpt;
<a name="l00363"></a>00363 
<a name="l00364"></a>00364         cpt = <a class="code" href="lib-lnet_8h.html#af0b1cda844363ede670a5cf6902b3067">lnet_cpt_of_cookie</a>(handle-&gt;<a class="code" href="structlnet__handle__any__t.html#a71f7bb7cb3df3cb456075393dc2261c4">cookie</a>);
<a name="l00365"></a>00365         lh = <a class="code" href="lib-lnet_8h.html#a40bfec4f531e5db297338a7a3d5cce8c">lnet_res_lh_lookup</a>(the_lnet.<a class="code" href="structlnet__t.html#a452678ffdbb511647ef4f699fcdde2e2">ln_me_containers</a>[cpt],
<a name="l00366"></a>00366                                 handle-&gt;<a class="code" href="structlnet__handle__any__t.html#a71f7bb7cb3df3cb456075393dc2261c4">cookie</a>);
<a name="l00367"></a>00367         <span class="keywordflow">if</span> (lh == NULL)
<a name="l00368"></a>00368                 <span class="keywordflow">return</span> NULL;
<a name="l00369"></a>00369 
<a name="l00370"></a>00370         <span class="keywordflow">return</span> <a class="code" href="lib-types_8h.html#a2ed4466401e1844b887817d2bdd4e602">lh_entry</a>(lh, <a class="code" href="structlnet__me.html">lnet_me_t</a>, me_lh);
<a name="l00371"></a>00371 }
<a name="l00372"></a>00372 
<a name="l00373"></a>00373 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00374"></a><a class="code" href="lib-lnet_8h.html#adb9c80e98c2852a9830d8e4dd570ae93">00374</a> <a class="code" href="lib-lnet_8h.html#adb9c80e98c2852a9830d8e4dd570ae93">lnet_peer_addref_locked</a>(<a class="code" href="structlnet__peer.html">lnet_peer_t</a> *lp)
<a name="l00375"></a>00375 {
<a name="l00376"></a>00376         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a> (lp-&gt;<a class="code" href="structlnet__peer.html#acdbe378e30971a1f139a63a573277f8c">lp_refcount</a> &gt; 0);
<a name="l00377"></a>00377         lp-&gt;<a class="code" href="structlnet__peer.html#acdbe378e30971a1f139a63a573277f8c">lp_refcount</a>++;
<a name="l00378"></a>00378 }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a5edf5a56ac7e91cc9146186e12047874">lnet_destroy_peer_locked</a>(<a class="code" href="structlnet__peer.html">lnet_peer_t</a> *lp);
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00383"></a><a class="code" href="lib-lnet_8h.html#a1f92fdf4a837b0c03570a6813021dc3e">00383</a> <a class="code" href="lib-lnet_8h.html#a1f92fdf4a837b0c03570a6813021dc3e">lnet_peer_decref_locked</a>(<a class="code" href="structlnet__peer.html">lnet_peer_t</a> *lp)
<a name="l00384"></a>00384 {
<a name="l00385"></a>00385         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a> (lp-&gt;<a class="code" href="structlnet__peer.html#acdbe378e30971a1f139a63a573277f8c">lp_refcount</a> &gt; 0);
<a name="l00386"></a>00386         lp-&gt;<a class="code" href="structlnet__peer.html#acdbe378e30971a1f139a63a573277f8c">lp_refcount</a>--;
<a name="l00387"></a>00387         <span class="keywordflow">if</span> (lp-&gt;<a class="code" href="structlnet__peer.html#acdbe378e30971a1f139a63a573277f8c">lp_refcount</a> == 0)
<a name="l00388"></a>00388                 <a class="code" href="lib-lnet_8h.html#a5edf5a56ac7e91cc9146186e12047874">lnet_destroy_peer_locked</a>(lp);
<a name="l00389"></a>00389 }
<a name="l00390"></a>00390 
<a name="l00391"></a>00391 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00392"></a><a class="code" href="lib-lnet_8h.html#a38e42379190b6aefe323e688d7301252">00392</a> <a class="code" href="lib-lnet_8h.html#a38e42379190b6aefe323e688d7301252">lnet_isrouter</a>(<a class="code" href="structlnet__peer.html">lnet_peer_t</a> *lp)
<a name="l00393"></a>00393 {
<a name="l00394"></a>00394         <span class="keywordflow">return</span> lp-&gt;<a class="code" href="structlnet__peer.html#aeea10375e4ab231a0389c1eceb6c9ae5">lp_rtr_refcount</a> != 0;
<a name="l00395"></a>00395 }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00398"></a><a class="code" href="lib-lnet_8h.html#adbfbd07f650fb6df85b7aa465444285d">00398</a> <a class="code" href="lib-lnet_8h.html#adbfbd07f650fb6df85b7aa465444285d">lnet_ni_addref_locked</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni, <span class="keywordtype">int</span> cpt)
<a name="l00399"></a>00399 {
<a name="l00400"></a>00400         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(cpt &gt;= 0 &amp;&amp; cpt &lt; <a class="code" href="lib-lnet_8h.html#a4f3fe032324f884480559fd678535998">LNET_CPT_NUMBER</a>);
<a name="l00401"></a>00401         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(*ni-&gt;<a class="code" href="structlnet__ni.html#acfefe18957f9e21b57d732888a57fc79">ni_refs</a>[cpt] &gt;= 0);
<a name="l00402"></a>00402 
<a name="l00403"></a>00403         (*ni-&gt;<a class="code" href="structlnet__ni.html#acfefe18957f9e21b57d732888a57fc79">ni_refs</a>[cpt])++;
<a name="l00404"></a>00404 }
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00407"></a><a class="code" href="lib-lnet_8h.html#aaf8d77f738cc8700e8bf012a56a8c460">00407</a> <a class="code" href="lib-lnet_8h.html#aaf8d77f738cc8700e8bf012a56a8c460">lnet_ni_addref</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni)
<a name="l00408"></a>00408 {
<a name="l00409"></a>00409         <a class="code" href="lib-lnet_8h.html#a7fc206b00833a673f27a8390127f89f2">lnet_net_lock</a>(0);
<a name="l00410"></a>00410         <a class="code" href="lib-lnet_8h.html#adbfbd07f650fb6df85b7aa465444285d">lnet_ni_addref_locked</a>(ni, 0);
<a name="l00411"></a>00411         <a class="code" href="lib-lnet_8h.html#aed3dedee4b0b16ad19eb739f6b91ea7d">lnet_net_unlock</a>(0);
<a name="l00412"></a>00412 }
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00415"></a><a class="code" href="lib-lnet_8h.html#a8fed57845b01f232da9643e669cf76cd">00415</a> <a class="code" href="lib-lnet_8h.html#a8fed57845b01f232da9643e669cf76cd">lnet_ni_decref_locked</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni, <span class="keywordtype">int</span> cpt)
<a name="l00416"></a>00416 {
<a name="l00417"></a>00417         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(cpt &gt;= 0 &amp;&amp; cpt &lt; <a class="code" href="lib-lnet_8h.html#a4f3fe032324f884480559fd678535998">LNET_CPT_NUMBER</a>);
<a name="l00418"></a>00418         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(*ni-&gt;<a class="code" href="structlnet__ni.html#acfefe18957f9e21b57d732888a57fc79">ni_refs</a>[cpt] &gt; 0);
<a name="l00419"></a>00419 
<a name="l00420"></a>00420         (*ni-&gt;<a class="code" href="structlnet__ni.html#acfefe18957f9e21b57d732888a57fc79">ni_refs</a>[cpt])--;
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00424"></a><a class="code" href="lib-lnet_8h.html#a721cae4760500ad1a8e55d1d1d917eca">00424</a> <a class="code" href="lib-lnet_8h.html#a721cae4760500ad1a8e55d1d1d917eca">lnet_ni_decref</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni)
<a name="l00425"></a>00425 {
<a name="l00426"></a>00426         <a class="code" href="lib-lnet_8h.html#a7fc206b00833a673f27a8390127f89f2">lnet_net_lock</a>(0);
<a name="l00427"></a>00427         <a class="code" href="lib-lnet_8h.html#a8fed57845b01f232da9643e669cf76cd">lnet_ni_decref_locked</a>(ni, 0);
<a name="l00428"></a>00428         <a class="code" href="lib-lnet_8h.html#aed3dedee4b0b16ad19eb739f6b91ea7d">lnet_net_unlock</a>(0);
<a name="l00429"></a>00429 }
<a name="l00430"></a>00430 
<a name="l00431"></a>00431 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a22e9a38bf6334dc5c64472cf2f10fadb">lnet_ni_free</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni);
<a name="l00432"></a>00432 <a class="code" href="structlnet__ni.html">lnet_ni_t</a> *
<a name="l00433"></a>00433 <a class="code" href="lib-lnet_8h.html#a9a90f8156e69a2566bce2f613d653e3b">lnet_ni_alloc</a>(__u32 net, <span class="keyword">struct</span> <a class="code" href="structcfs__expr__list.html">cfs_expr_list</a> *el, <span class="keyword">struct</span> <a class="code" href="structlist__head.html">list_head</a> *nilist);
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00436"></a><a class="code" href="lib-lnet_8h.html#aef53f86f6f065d7c954573eb856db261">00436</a> <a class="code" href="lib-lnet_8h.html#aef53f86f6f065d7c954573eb856db261">lnet_nid2peerhash</a>(<a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> nid)
<a name="l00437"></a>00437 {
<a name="l00438"></a>00438         <span class="keywordflow">return</span> hash_long(nid, <a class="code" href="lib-types_8h.html#a304e5ce00ae200d3806b41b8c0859e60">LNET_PEER_HASH_BITS</a>);
<a name="l00439"></a>00439 }
<a name="l00440"></a>00440 
<a name="l00441"></a>00441 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a> *
<a name="l00442"></a><a class="code" href="lib-lnet_8h.html#af2b8713c8206090e3b801e7c664b400c">00442</a> <a class="code" href="lib-lnet_8h.html#af2b8713c8206090e3b801e7c664b400c">lnet_net2rnethash</a>(__u32 net)
<a name="l00443"></a>00443 {
<a name="l00444"></a>00444         <span class="keywordflow">return</span> &amp;the_lnet.<a class="code" href="structlnet__t.html#ab3e96f6e5fd899a5c8d85fc42fa582db">ln_remote_nets_hash</a>[(<a class="code" href="group__lnet__addr.html#gaa5b1f70b0f73fff4e4d2ceb7b95965b1">LNET_NETNUM</a>(net) +
<a name="l00445"></a>00445                 <a class="code" href="group__lnet__addr.html#gad907b8fc6e2f50ca5ddcde69d8fbaa37">LNET_NETTYP</a>(net)) &amp;
<a name="l00446"></a>00446                 ((1U &lt;&lt; the_lnet.<a class="code" href="structlnet__t.html#a3bef8e34509cc7fdb5eecaa366f2c44e">ln_remote_nets_hbits</a>) - 1)];
<a name="l00447"></a>00447 }
<a name="l00448"></a>00448 
<a name="l00449"></a>00449 <span class="keyword">extern</span> <a class="code" href="structlnet__lnd.html">lnd_t</a> <a class="code" href="lib-lnet_8h.html#a7adbff77cb0aabb09bbbd3713bcca9db">the_lolnd</a>;
<a name="l00450"></a>00450 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#aa3d55d8e0b27b2e1964f5ff64e50adb3">avoid_asym_router_failure</a>;
<a name="l00451"></a>00451 
<a name="l00452"></a>00452 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a69d78c528fcca0d96c7d1b470eccbaf4">lnet_cpt_of_nid_locked</a>(<a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> nid);
<a name="l00453"></a>00453 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a1beb7aca3785eea0587bc0db4ab7052e">lnet_cpt_of_nid</a>(<a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> nid);
<a name="l00454"></a>00454 <span class="keyword">extern</span> <a class="code" href="structlnet__ni.html">lnet_ni_t</a> *<a class="code" href="lib-lnet_8h.html#a361fb1fbddb1bc1719fa3f7bdea7f9af">lnet_nid2ni_locked</a>(<a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> nid, <span class="keywordtype">int</span> cpt);
<a name="l00455"></a>00455 <span class="keyword">extern</span> <a class="code" href="structlnet__ni.html">lnet_ni_t</a> *<a class="code" href="lib-lnet_8h.html#ab0edcb533059bdff8bb2a3ff954798e8">lnet_net2ni_locked</a>(__u32 net, <span class="keywordtype">int</span> cpt);
<a name="l00456"></a>00456 <span class="keyword">extern</span> <a class="code" href="structlnet__ni.html">lnet_ni_t</a> *<a class="code" href="lib-lnet_8h.html#a5125af6ed9b10e30f23bf2459e84e702">lnet_net2ni</a>(__u32 net);
<a name="l00457"></a>00457 
<a name="l00458"></a>00458 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#aa0245bd4b79e364fec50a60c11499b34" title="Initialize LNet library.">lnet_lib_init</a>(<span class="keywordtype">void</span>);
<a name="l00459"></a>00459 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#ac2a470c48a1c6f55f29aa0a41a8e7c1f" title="Finalize LNet library.">lnet_lib_exit</a>(<span class="keywordtype">void</span>);
<a name="l00460"></a>00460 
<a name="l00461"></a>00461 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a4f6654045cbe15c3a7e570e33a447914">portal_rotor</a>;
<a name="l00462"></a>00462 
<a name="l00463"></a>00463 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#aabeaf1606b15ff28ecf3508955d64253">lnet_notify</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni, <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> peer, <span class="keywordtype">int</span> alive, <a class="code" href="linux-time_8h.html#a0e81d053bc8d925f6574c760bbea5ac4">cfs_time_t</a> when);
<a name="l00464"></a>00464 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#ae93afae01538e838ac249ad20167547d">lnet_notify_locked</a>(<a class="code" href="structlnet__peer.html">lnet_peer_t</a> *lp, <span class="keywordtype">int</span> notifylnd, <span class="keywordtype">int</span> alive, <a class="code" href="linux-time_8h.html#a0e81d053bc8d925f6574c760bbea5ac4">cfs_time_t</a> when);
<a name="l00465"></a>00465 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#ac7464221877813e21e20a131b1f418a9">lnet_add_route</a>(__u32 net, __u32 hops, <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> gateway_nid,
<a name="l00466"></a>00466                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> priority);
<a name="l00467"></a>00467 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a9568c760ed18137279f794834484beca">lnet_check_routes</a>(<span class="keywordtype">void</span>);
<a name="l00468"></a>00468 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a866083631aaceb2489ee39a19fdbf0f4">lnet_del_route</a>(__u32 net, <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> gw_nid);
<a name="l00469"></a>00469 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#ad0da28f0539af074637e61cfc55bad17">lnet_destroy_routes</a>(<span class="keywordtype">void</span>);
<a name="l00470"></a>00470 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#ae53dae7e4a49b874b905d11ebfdfede6">lnet_get_route</a>(<span class="keywordtype">int</span> idx, __u32 *net, __u32 *hops,
<a name="l00471"></a>00471                    <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> *gateway, __u32 *alive, __u32 *priority);
<a name="l00472"></a>00472 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a921f6ec912f5323702070564a55b8756">lnet_get_rtr_pool_cfg</a>(<span class="keywordtype">int</span> idx, <span class="keyword">struct</span> <a class="code" href="structlnet__ioctl__pool__cfg.html">lnet_ioctl_pool_cfg</a> *pool_cfg);
<a name="l00473"></a>00473 
<a name="l00474"></a><a class="code" href="structlibcfs__ioctl__handler.html">00474</a> <span class="keyword">struct </span><a class="code" href="structlibcfs__ioctl__handler.html">libcfs_ioctl_handler</a> {
<a name="l00475"></a><a class="code" href="structlibcfs__ioctl__handler.html#a2c3f06382868c9652ba225db2e70d7ce">00475</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a> <a class="code" href="structlibcfs__ioctl__handler.html#a2c3f06382868c9652ba225db2e70d7ce">item</a>;
<a name="l00476"></a>00476         int (*<a class="code" href="structlibcfs__ioctl__handler.html#ad61cbac1812aefa8f27ae4fa2ec516af">handle_ioctl</a>)(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mdsrate_8c.html#a7353cae57e2530c316ddacb27ef14932">cmd</a>, <span class="keyword">struct </span><a class="code" href="structlibcfs__ioctl__hdr.html">libcfs_ioctl_hdr</a> *hdr);
<a name="l00477"></a>00477 };
<a name="l00478"></a>00478 
<a name="l00479"></a><a class="code" href="lib-lnet_8h.html#ae0aec6a142dd2bf24849ef4ee4907e35">00479</a> <span class="preprocessor">#define DECLARE_IOCTL_HANDLER(ident, func)                      \</span>
<a name="l00480"></a>00480 <span class="preprocessor">        static struct libcfs_ioctl_handler ident = {            \</span>
<a name="l00481"></a>00481 <span class="preprocessor">                </span><span class="comment">/* .item = */</span> LIST_HEAD_INIT(ident.item),       \
<a name="l00482"></a>00482                 <span class="comment">/* .handle_ioctl = */</span> func                      \
<a name="l00483"></a>00483         }
<a name="l00484"></a>00484 
<a name="l00485"></a>00485 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a1147ceb03af31ae3ab024433df78c2b2">libcfs_register_ioctl</a>(<span class="keyword">struct</span> <a class="code" href="structlibcfs__ioctl__handler.html">libcfs_ioctl_handler</a> *hand);
<a name="l00486"></a>00486 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a62c630a9d4ae9a0ddb76d0371caa349d">libcfs_deregister_ioctl</a>(<span class="keyword">struct</span> <a class="code" href="structlibcfs__ioctl__handler.html">libcfs_ioctl_handler</a> *hand);
<a name="l00487"></a>00487 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a3ac1eafafa17ad1e65670bc5b9f78088">libcfs_ioctl_getdata</a>(<span class="keyword">struct</span> <a class="code" href="structlibcfs__ioctl__hdr.html">libcfs_ioctl_hdr</a> **hdr_pp,
<a name="l00488"></a>00488                                 <span class="keyword">struct</span> <a class="code" href="structlibcfs__ioctl__hdr.html">libcfs_ioctl_hdr</a> <a class="code" href="ioctl_8h.html#ace6f17999da4ea3b93c4227beafcab95">__user</a> *uparam);
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#afca1fb6af0d4ca020c60e4d9c1e0923f">lnet_proc_init</a>(<span class="keywordtype">void</span>);
<a name="l00491"></a>00491 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a1b32448631b2c2f5478046742f0cb1ce">lnet_proc_fini</a>(<span class="keywordtype">void</span>);
<a name="l00492"></a>00492 <span class="keywordtype">int</span>  <a class="code" href="lib-lnet_8h.html#adc3b861923903ca7230540c6d0cd8127">lnet_rtrpools_alloc</a>(<span class="keywordtype">int</span> im_a_router);
<a name="l00493"></a>00493 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#ab58935a4ab0f9fc5aa72b6e643a30dee">lnet_destroy_rtrbuf</a>(<a class="code" href="structlnet__rtrbuf__t.html">lnet_rtrbuf_t</a> *rb, <span class="keywordtype">int</span> npages);
<a name="l00494"></a>00494 <span class="keywordtype">int</span>  <a class="code" href="lib-lnet_8h.html#a49b9d97e1afd7ce34533d2e828d2526e">lnet_rtrpools_adjust</a>(<span class="keywordtype">int</span> tiny, <span class="keywordtype">int</span> small, <span class="keywordtype">int</span> large);
<a name="l00495"></a>00495 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#ab59e3bad51d6d3a5f8128195bc0e6440">lnet_rtrpools_enable</a>(<span class="keywordtype">void</span>);
<a name="l00496"></a>00496 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#af3719f2910ee820202b19d341b813182">lnet_rtrpools_disable</a>(<span class="keywordtype">void</span>);
<a name="l00497"></a>00497 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#ac0a74ac29641a86eaec40b9d5d7d278b">lnet_rtrpools_free</a>(<span class="keywordtype">int</span> keep_pools);
<a name="l00498"></a>00498 <a class="code" href="structlnet__remotenet__t.html">lnet_remotenet_t</a> *<a class="code" href="lib-lnet_8h.html#a7370346fbe4646b89f84847820f81091">lnet_find_net_locked</a> (__u32 net);
<a name="l00499"></a>00499 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a42508e0ad5dbfdbdfecfc9cbc636dd5f">lnet_dyn_add_ni</a>(<a class="code" href="group__lnet__addr.html#gafa13bf627f3dbcdec22141de051a61cd" title="ID of a process in a node.">lnet_pid_t</a> requested_pid,
<a name="l00500"></a>00500                     <span class="keyword">struct</span> <a class="code" href="structlnet__ioctl__config__data.html">lnet_ioctl_config_data</a> *conf);
<a name="l00501"></a>00501 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a023102a44160349341202426cba6d9a2">lnet_dyn_del_ni</a>(__u32 net);
<a name="l00502"></a>00502 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a38f9077f086118365133690f7cf397f9">lnet_clear_lazy_portal</a>(<span class="keyword">struct</span> <a class="code" href="structlnet__ni.html">lnet_ni</a> *ni, <span class="keywordtype">int</span> portal, <span class="keywordtype">char</span> *reason);
<a name="l00503"></a>00503 
<a name="l00504"></a>00504 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a442f7c0e9afc9c1d903c53236631b983">lnet_islocalnid</a>(<a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> nid);
<a name="l00505"></a>00505 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a8e7f223f80efb2f063b207c081ba7381">lnet_islocalnet</a>(__u32 net);
<a name="l00506"></a>00506 
<a name="l00507"></a>00507 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a27b693a1aac3818117fac58fe6b7a2ad">lnet_msg_attach_md</a>(<a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *md,
<a name="l00508"></a>00508                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> offset, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mlen);
<a name="l00509"></a>00509 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#afc44a25066e8c98a6ce6c436ae97bedc">lnet_msg_detach_md</a>(<a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <span class="keywordtype">int</span> <a class="code" href="lustre__rsync_8c.html#a55591f17a60f597b63f070969c54fd6c">status</a>);
<a name="l00510"></a>00510 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a48ee66188163afc1a953a7bf992c4782">lnet_build_unlink_event</a>(<a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *md, <a class="code" href="structlnet__event__t.html" title="Information about an event on a MD.">lnet_event_t</a> *ev);
<a name="l00511"></a>00511 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#add8440a2b3f47e116ac5b254aecb96e2">lnet_build_msg_event</a>(<a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <a class="code" href="group__lnet__eq.html#ga03bee040520d7fabad1b3b661bd7228a" title="Six types of events can be logged in an event queue.">lnet_event_kind_t</a> ev_type);
<a name="l00512"></a>00512 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a3568bd76698b4657ccc94e99962dfeaf">lnet_msg_commit</a>(<a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <span class="keywordtype">int</span> cpt);
<a name="l00513"></a>00513 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#ae0b13e45932b28963ed6b77c71da8027">lnet_msg_decommit</a>(<a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <span class="keywordtype">int</span> cpt, <span class="keywordtype">int</span> <a class="code" href="lustre__rsync_8c.html#a55591f17a60f597b63f070969c54fd6c">status</a>);
<a name="l00514"></a>00514 
<a name="l00515"></a>00515 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a0e275f966c0a133e1e338479a037aa6e">lnet_eq_enqueue_event</a>(<a class="code" href="structlnet__eq.html">lnet_eq_t</a> *eq, <a class="code" href="structlnet__event__t.html" title="Information about an event on a MD.">lnet_event_t</a> *ev);
<a name="l00516"></a>00516 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#ad221fe0f5c0112957c3e81eeeb31d5e9">lnet_prep_send</a>(<a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <span class="keywordtype">int</span> type, <a class="code" href="structlnet__process__id__t.html" title="Global process ID.">lnet_process_id_t</a> target,
<a name="l00517"></a>00517                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> offset, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len);
<a name="l00518"></a>00518 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a2fe22a172b95bbfd517a0fa36895073c">lnet_send</a>(<a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> nid, <a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> rtr_nid);
<a name="l00519"></a>00519 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a56e66c105a8fe7d81a31021396f400c3">lnet_return_tx_credits_locked</a>(<a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>);
<a name="l00520"></a>00520 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#add82425e77dafe3dfb8c91b803c20424">lnet_return_rx_credits_locked</a>(<a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>);
<a name="l00521"></a>00521 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#afb96ca305e5502fd4d04c017ff57e304">lnet_schedule_blocked_locked</a>(<a class="code" href="structlnet__rtrbufpool__t.html">lnet_rtrbufpool_t</a> *rbp);
<a name="l00522"></a>00522 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#acec1e4bdcde6a9e21e6c1293f1ce6b85">lnet_drop_routed_msgs_locked</a>(<span class="keyword">struct</span> <a class="code" href="structlist__head.html">list_head</a> *<a class="code" href="lnetctl_8c.html#ac75dee5cf9c8f0128e744b7d95db6767">list</a>, <span class="keywordtype">int</span> cpt);
<a name="l00523"></a>00523 
<a name="l00524"></a>00524 <span class="comment">/* portals functions */</span>
<a name="l00525"></a>00525 <span class="comment">/* portals attributes */</span>
<a name="l00526"></a>00526 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00527"></a><a class="code" href="lib-lnet_8h.html#a602b39e37446a252746dd5d2894e368d">00527</a> <a class="code" href="lib-lnet_8h.html#a602b39e37446a252746dd5d2894e368d">lnet_ptl_is_lazy</a>(<a class="code" href="structlnet__portal.html">lnet_portal_t</a> *ptl)
<a name="l00528"></a>00528 {
<a name="l00529"></a>00529         <span class="keywordflow">return</span> !!(ptl-&gt;<a class="code" href="structlnet__portal.html#afc09dd4ac1c412bc22a91b5bd46cbaa4">ptl_options</a> &amp; <a class="code" href="lib-types_8h.html#ab0d90f7ae1a62f116f2c89e7922541e6">LNET_PTL_LAZY</a>);
<a name="l00530"></a>00530 }
<a name="l00531"></a>00531 
<a name="l00532"></a>00532 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00533"></a><a class="code" href="lib-lnet_8h.html#a9a81459843fbea96e2a46525ea84a3ba">00533</a> <a class="code" href="lib-lnet_8h.html#a9a81459843fbea96e2a46525ea84a3ba">lnet_ptl_is_unique</a>(<a class="code" href="structlnet__portal.html">lnet_portal_t</a> *ptl)
<a name="l00534"></a>00534 {
<a name="l00535"></a>00535         <span class="keywordflow">return</span> !!(ptl-&gt;<a class="code" href="structlnet__portal.html#afc09dd4ac1c412bc22a91b5bd46cbaa4">ptl_options</a> &amp; <a class="code" href="lib-types_8h.html#a61b09683f12d68d9f5e05a3d96c09a87">LNET_PTL_MATCH_UNIQUE</a>);
<a name="l00536"></a>00536 }
<a name="l00537"></a>00537 
<a name="l00538"></a>00538 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00539"></a><a class="code" href="lib-lnet_8h.html#a06dd00830bdf29fd6e4330e1a91da463">00539</a> <a class="code" href="lib-lnet_8h.html#a06dd00830bdf29fd6e4330e1a91da463">lnet_ptl_is_wildcard</a>(<a class="code" href="structlnet__portal.html">lnet_portal_t</a> *ptl)
<a name="l00540"></a>00540 {
<a name="l00541"></a>00541         <span class="keywordflow">return</span> !!(ptl-&gt;<a class="code" href="structlnet__portal.html#afc09dd4ac1c412bc22a91b5bd46cbaa4">ptl_options</a> &amp; <a class="code" href="lib-types_8h.html#ab2e7b06e749e9b4351627acc600bc185">LNET_PTL_MATCH_WILDCARD</a>);
<a name="l00542"></a>00542 }
<a name="l00543"></a>00543 
<a name="l00544"></a>00544 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00545"></a><a class="code" href="lib-lnet_8h.html#a1c5302eaab70f841b9770554af0c781d">00545</a> <a class="code" href="lib-lnet_8h.html#a1c5302eaab70f841b9770554af0c781d">lnet_ptl_setopt</a>(<a class="code" href="structlnet__portal.html">lnet_portal_t</a> *ptl, <span class="keywordtype">int</span> <a class="code" href="lhsmtool__posix_8c.html#acccb472724f310e3c072ccc533af3b80">opt</a>)
<a name="l00546"></a>00546 {
<a name="l00547"></a>00547         ptl-&gt;<a class="code" href="structlnet__portal.html#afc09dd4ac1c412bc22a91b5bd46cbaa4">ptl_options</a> |= opt;
<a name="l00548"></a>00548 }
<a name="l00549"></a>00549 
<a name="l00550"></a>00550 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00551"></a><a class="code" href="lib-lnet_8h.html#a9116dfadac07ce96bce18dac9c402dc8">00551</a> <a class="code" href="lib-lnet_8h.html#a9116dfadac07ce96bce18dac9c402dc8">lnet_ptl_unsetopt</a>(<a class="code" href="structlnet__portal.html">lnet_portal_t</a> *ptl, <span class="keywordtype">int</span> <a class="code" href="lhsmtool__posix_8c.html#acccb472724f310e3c072ccc533af3b80">opt</a>)
<a name="l00552"></a>00552 {
<a name="l00553"></a>00553         ptl-&gt;<a class="code" href="structlnet__portal.html#afc09dd4ac1c412bc22a91b5bd46cbaa4">ptl_options</a> &amp;= ~opt;
<a name="l00554"></a>00554 }
<a name="l00555"></a>00555 
<a name="l00556"></a>00556 <span class="comment">/* match-table functions */</span>
<a name="l00557"></a>00557 <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a> *<a class="code" href="lib-lnet_8h.html#a6b2c06cd652cc04c25905e1ad62a4b23">lnet_mt_match_head</a>(<span class="keyword">struct</span> <a class="code" href="structlnet__match__table.html">lnet_match_table</a> *mtable,
<a name="l00558"></a>00558                                <a class="code" href="structlnet__process__id__t.html" title="Global process ID.">lnet_process_id_t</a> <span class="keywordtype">id</span>, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> mbits);
<a name="l00559"></a>00559 <span class="keyword">struct </span><a class="code" href="structlnet__match__table.html">lnet_match_table</a> *<a class="code" href="lib-lnet_8h.html#ab9293f9fdefd1e629583e86162fee220">lnet_mt_of_attach</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index,
<a name="l00560"></a>00560                                            <a class="code" href="structlnet__process__id__t.html" title="Global process ID.">lnet_process_id_t</a> <span class="keywordtype">id</span>, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> mbits,
<a name="l00561"></a>00561                                            <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> ignore_bits,
<a name="l00562"></a>00562                                            <a class="code" href="group__lnet__me.html#ga292319c5a5ed0c5718ce4edfd3aa1fb4" title="Values of the type lnet_ins_pos_t are used to control where a new match entry is...">lnet_ins_pos_t</a> pos);
<a name="l00563"></a>00563 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#ae739656ab0ad2a8833f83af8abeae2db">lnet_mt_match_md</a>(<span class="keyword">struct</span> <a class="code" href="structlnet__match__table.html">lnet_match_table</a> *mtable,
<a name="l00564"></a>00564                      <span class="keyword">struct</span> <a class="code" href="structlnet__match__info.html">lnet_match_info</a> *info, <span class="keyword">struct</span> <a class="code" href="structlnet__msg.html">lnet_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>);
<a name="l00565"></a>00565 
<a name="l00566"></a>00566 <span class="comment">/* portals match/attach functions */</span>
<a name="l00567"></a>00567 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a554ccfbae8a1bd06f904b62aac98bef4">lnet_ptl_attach_md</a>(<a class="code" href="structlnet__me.html">lnet_me_t</a> *me, <a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *md,
<a name="l00568"></a>00568                         <span class="keyword">struct</span> <a class="code" href="structlist__head.html">list_head</a> *matches, <span class="keyword">struct</span> <a class="code" href="structlist__head.html">list_head</a> *drops);
<a name="l00569"></a>00569 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#acb38a08353fe46cb306ca0b4611bce1f">lnet_ptl_detach_md</a>(<a class="code" href="structlnet__me.html">lnet_me_t</a> *me, <a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *md);
<a name="l00570"></a>00570 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#aee812df5fab9e92c20351fea36039cf0">lnet_ptl_match_md</a>(<span class="keyword">struct</span> <a class="code" href="structlnet__match__info.html">lnet_match_info</a> *info, <span class="keyword">struct</span> <a class="code" href="structlnet__msg.html">lnet_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>);
<a name="l00571"></a>00571 
<a name="l00572"></a>00572 <span class="comment">/* initialized and finalize portals */</span>
<a name="l00573"></a>00573 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#ae002e29b6cb95630fa21b888a35eb904">lnet_portals_create</a>(<span class="keywordtype">void</span>);
<a name="l00574"></a>00574 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a1c4c3b61091c2e1ac562d76940e87e08">lnet_portals_destroy</a>(<span class="keywordtype">void</span>);
<a name="l00575"></a>00575 
<a name="l00576"></a>00576 <span class="comment">/* message functions */</span>
<a name="l00577"></a>00577 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a690f78b9b4f06481fbf29ae5fbb60a9a">lnet_parse</a> (<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni, lnet_hdr_t *hdr,
<a name="l00578"></a>00578                 <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> fromnid, <span class="keywordtype">void</span> *<span class="keyword">private</span>, <span class="keywordtype">int</span> rdma_req);
<a name="l00579"></a>00579 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#aa1a67a12be6d8e491ef88062476398b5">lnet_parse_local</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni, <a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>);
<a name="l00580"></a>00580 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a7f8448b927f03221e8988c6f95e552d7">lnet_parse_forward_locked</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni, <a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>);
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a1689ca76c1f6f386a605be0c39178d6a">lnet_recv</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni, <span class="keywordtype">void</span> *<span class="keyword">private</span>, <a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <span class="keywordtype">int</span> delayed,
<a name="l00583"></a>00583                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> offset, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mlen, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rlen);
<a name="l00584"></a>00584 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#abdb539d2adf1a9abbdcea805676129b9">lnet_ni_recv</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni, <span class="keywordtype">void</span> *<span class="keyword">private</span>, <a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>,
<a name="l00585"></a>00585                   <span class="keywordtype">int</span> delayed, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> offset,
<a name="l00586"></a>00586                   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mlen, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rlen);
<a name="l00587"></a>00587 
<a name="l00588"></a>00588 <a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="lib-lnet_8h.html#a74f3a3cc7fe8e676d6742df7c3def07c">lnet_create_reply_msg</a> (<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni, <a class="code" href="structlnet__msg.html">lnet_msg_t</a> *get_msg);
<a name="l00589"></a>00589 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#ac14a0e6bbc599eafdfc8e0ab638c22e6">lnet_set_reply_msg_len</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni, <a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len);
<a name="l00590"></a>00590 
<a name="l00591"></a>00591 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a676dc59e4f17b2d2de08e3c7b59fa2b2">lnet_finalize</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni, <a class="code" href="structlnet__msg.html">lnet_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, <span class="keywordtype">int</span> rc);
<a name="l00592"></a>00592 
<a name="l00593"></a>00593 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a094dab4a4a6de3b861639fa4490cdedb">lnet_drop_message</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni, <span class="keywordtype">int</span> cpt, <span class="keywordtype">void</span> *<span class="keyword">private</span>,
<a name="l00594"></a>00594                        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nob);
<a name="l00595"></a>00595 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#ad7d1d6abdc32eee5e6d8fef83126cba3">lnet_drop_delayed_msg_list</a>(<span class="keyword">struct</span> <a class="code" href="structlist__head.html">list_head</a> *<a class="code" href="writemany_8c.html#af39400667a953a7c5c34e3964aa1ce9f">head</a>, <span class="keywordtype">char</span> *reason);
<a name="l00596"></a>00596 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a4edcf5737f1f22dcf7962a64be0fc54a">lnet_recv_delayed_msg_list</a>(<span class="keyword">struct</span> <a class="code" href="structlist__head.html">list_head</a> *<a class="code" href="writemany_8c.html#af39400667a953a7c5c34e3964aa1ce9f">head</a>);
<a name="l00597"></a>00597 
<a name="l00598"></a>00598 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a4c14c6726448aed166c4da8a5ecfe7b2">lnet_msg_container_setup</a>(<span class="keyword">struct</span> <a class="code" href="structlnet__msg__container.html">lnet_msg_container</a> *container, <span class="keywordtype">int</span> cpt);
<a name="l00599"></a>00599 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a7978e66e71c18b2f7a74d620ba19b8e5">lnet_msg_container_cleanup</a>(<span class="keyword">struct</span> <a class="code" href="structlnet__msg__container.html">lnet_msg_container</a> *container);
<a name="l00600"></a>00600 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#aa9255a41c8252da0b78444596afd3bdc">lnet_msg_containers_destroy</a>(<span class="keywordtype">void</span>);
<a name="l00601"></a>00601 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a0187ca8cf4f0190b6c2dacaa7b8550c8">lnet_msg_containers_create</a>(<span class="keywordtype">void</span>);
<a name="l00602"></a>00602 
<a name="l00603"></a>00603 <span class="keywordtype">char</span> *<a class="code" href="lib-lnet_8h.html#a23210445e98cdc261a30dbc823047ab8">lnet_msgtyp2str</a> (<span class="keywordtype">int</span> type);
<a name="l00604"></a>00604 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#af3a18b4299849ef89c652f9ea722f449">lnet_print_hdr</a> (lnet_hdr_t * hdr);
<a name="l00605"></a>00605 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a486995e1375a25ac900afa204bea3367">lnet_fail_nid</a>(<a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> nid, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> threshold);
<a name="l00606"></a>00606 
<a name="l00609"></a>00609 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a76f41f66968b9d8f8ff7efe21603bd0e">lnet_fault_ctl</a>(<span class="keywordtype">int</span> <a class="code" href="mdsrate_8c.html#a7353cae57e2530c316ddacb27ef14932">cmd</a>, <span class="keyword">struct</span> <a class="code" href="structlibcfs__ioctl__data.html">libcfs_ioctl_data</a> *data);
<a name="l00610"></a>00610 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a5622523e14791417b8f7d8acd87eb723">lnet_fault_init</a>(<span class="keywordtype">void</span>);
<a name="l00611"></a>00611 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a8375e1fcac37d18a1a095e3788be53ed">lnet_fault_fini</a>(<span class="keywordtype">void</span>);
<a name="l00612"></a>00612 
<a name="l00613"></a>00613 <span class="keywordtype">bool</span> <a class="code" href="lib-lnet_8h.html#a7c0d119d578e1bd95ff500ee3443e569" title="Check if message from src to dst can match any existed drop rule.">lnet_drop_rule_match</a>(lnet_hdr_t *hdr);
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#ade253484add34fe60ae621cf7c7bf3bd" title="Add a new delay rule to LNet There is no check for duplicated delay rule, all rules...">lnet_delay_rule_add</a>(<span class="keyword">struct</span> <a class="code" href="structlnet__fault__attr.html" title="ioctl parameter for LNet fault simulation">lnet_fault_attr</a> *attr);
<a name="l00616"></a>00616 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#aa9ee697979a8ea61fdca711940362581" title="Remove matched Delay Rules from lnet, if shutdown is true or both src and dst are...">lnet_delay_rule_del</a>(<a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> src, <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> dst, <span class="keywordtype">bool</span> shutdown);
<a name="l00617"></a>00617 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a37ee915fb5d0c650afc6662d5daeb8e1" title="List Delay Rule at position of pos.">lnet_delay_rule_list</a>(<span class="keywordtype">int</span> pos, <span class="keyword">struct</span> <a class="code" href="structlnet__fault__attr.html" title="ioctl parameter for LNet fault simulation">lnet_fault_attr</a> *attr,
<a name="l00618"></a>00618                          <span class="keyword">struct</span> <a class="code" href="structlnet__fault__stat.html" title="fault simluation stats">lnet_fault_stat</a> *stat);
<a name="l00619"></a>00619 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a6e4398ec3952021fe73e3a5ded726724" title="reset counters for all Delay Rules">lnet_delay_rule_reset</a>(<span class="keywordtype">void</span>);
<a name="l00620"></a>00620 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a463d019543fb77ce7901046605baf496" title="Process delayed messages for scheduled rules This function can either be called by...">lnet_delay_rule_check</a>(<span class="keywordtype">void</span>);
<a name="l00621"></a>00621 <span class="keywordtype">bool</span> <a class="code" href="lib-lnet_8h.html#af55bf0fb4d99f03cb784dc02a3fce4b8" title="check if msg can match any Delay Rule, receiving of this message will be delayed...">lnet_delay_rule_match_locked</a>(lnet_hdr_t *hdr, <span class="keyword">struct</span> <a class="code" href="structlnet__msg.html">lnet_msg</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>);
<a name="l00622"></a>00622 
<a name="l00625"></a>00625 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a0a0cfe8cab935890bc018bd8816880f5">lnet_counters_get</a>(<a class="code" href="structlnet__counters.html">lnet_counters_t</a> *counters);
<a name="l00626"></a>00626 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#ae23d030dfd8ea88e3b70a54280f6d2c8">lnet_counters_reset</a>(<span class="keywordtype">void</span>);
<a name="l00627"></a>00627 
<a name="l00628"></a>00628 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a0e3cdce366dbf4c8f287d165535401fe">lnet_iov_nob</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> niov, <span class="keyword">struct</span> kvec *iov);
<a name="l00629"></a>00629 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a4df1f3c91c8bb7f811a7f024658195ee">lnet_extract_iov</a>(<span class="keywordtype">int</span> dst_niov, <span class="keyword">struct</span> kvec *dst,
<a name="l00630"></a>00630                       <span class="keywordtype">int</span> src_niov, <span class="keyword">struct</span> kvec *src,
<a name="l00631"></a>00631                       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> offset, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len);
<a name="l00632"></a>00632 
<a name="l00633"></a>00633 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a369133af01bf9432c718ba4da49c354a">lnet_kiov_nob</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> niov, <a class="code" href="structlnet__kiov__t.html" title="A page-based fragment of a MD.">lnet_kiov_t</a> *iov);
<a name="l00634"></a>00634 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a30594d2280f9334bd65b50e0db45158e">lnet_extract_kiov</a>(<span class="keywordtype">int</span> dst_niov, <a class="code" href="structlnet__kiov__t.html" title="A page-based fragment of a MD.">lnet_kiov_t</a> *dst,
<a name="l00635"></a>00635                      <span class="keywordtype">int</span> src_niov, <a class="code" href="structlnet__kiov__t.html" title="A page-based fragment of a MD.">lnet_kiov_t</a> *src,
<a name="l00636"></a>00636                      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> offset, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len);
<a name="l00637"></a>00637 
<a name="l00638"></a>00638 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a508ca7860e56249ba0c520e9149ca9d3">lnet_copy_iov2iov</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ndiov, <span class="keyword">struct</span> kvec *diov,
<a name="l00639"></a>00639                        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> doffset,
<a name="l00640"></a>00640                        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nsiov, <span class="keyword">struct</span> kvec *siov,
<a name="l00641"></a>00641                        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> soffset, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nob);
<a name="l00642"></a>00642 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#afca3872259b837d7c21da9a494ea33fc">lnet_copy_kiov2iov</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> niov, <span class="keyword">struct</span> kvec *iov,
<a name="l00643"></a>00643                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iovoffset,
<a name="l00644"></a>00644                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nkiov, <a class="code" href="structlnet__kiov__t.html" title="A page-based fragment of a MD.">lnet_kiov_t</a> *kiov,
<a name="l00645"></a>00645                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kiovoffset, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nob);
<a name="l00646"></a>00646 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#aed700c91fb3ac4028e1d9e590a619db2">lnet_copy_iov2kiov</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nkiov, <a class="code" href="structlnet__kiov__t.html" title="A page-based fragment of a MD.">lnet_kiov_t</a> *kiov,
<a name="l00647"></a>00647                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kiovoffset,
<a name="l00648"></a>00648                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> niov, <span class="keyword">struct</span> kvec *iov,
<a name="l00649"></a>00649                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iovoffset, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nob);
<a name="l00650"></a>00650 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#aada06565204f222539acdf923a997bcd">lnet_copy_kiov2kiov</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ndkiov, <a class="code" href="structlnet__kiov__t.html" title="A page-based fragment of a MD.">lnet_kiov_t</a> *dkiov,
<a name="l00651"></a>00651                          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> doffset,
<a name="l00652"></a>00652                          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nskiov, <a class="code" href="structlnet__kiov__t.html" title="A page-based fragment of a MD.">lnet_kiov_t</a> *skiov,
<a name="l00653"></a>00653                          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> soffset, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nob);
<a name="l00654"></a>00654 
<a name="l00655"></a>00655 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00656"></a><a class="code" href="lib-lnet_8h.html#ac83a28dfaf3e6f3f50790f0b7a747e85">00656</a> <a class="code" href="lib-lnet_8h.html#ac83a28dfaf3e6f3f50790f0b7a747e85">lnet_copy_iov2flat</a>(<span class="keywordtype">int</span> dlen, <span class="keywordtype">void</span> *dest, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> doffset,
<a name="l00657"></a>00657                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nsiov, <span class="keyword">struct</span> kvec *siov, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> soffset,
<a name="l00658"></a>00658                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nob)
<a name="l00659"></a>00659 {
<a name="l00660"></a>00660         <span class="keyword">struct </span>kvec diov = {<span class="comment">/*.iov_base = */</span> dest, <span class="comment">/*.iov_len = */</span> dlen};
<a name="l00661"></a>00661 
<a name="l00662"></a>00662         <a class="code" href="lib-lnet_8h.html#a508ca7860e56249ba0c520e9149ca9d3">lnet_copy_iov2iov</a>(1, &amp;diov, doffset,
<a name="l00663"></a>00663                           nsiov, siov, soffset, nob);
<a name="l00664"></a>00664 }
<a name="l00665"></a>00665 
<a name="l00666"></a>00666 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00667"></a><a class="code" href="lib-lnet_8h.html#ad3ed47dd04ff0ea93cbd06cac6052cef">00667</a> <a class="code" href="lib-lnet_8h.html#ad3ed47dd04ff0ea93cbd06cac6052cef">lnet_copy_kiov2flat</a>(<span class="keywordtype">int</span> dlen, <span class="keywordtype">void</span> *dest, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> doffset,
<a name="l00668"></a>00668                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nsiov, <a class="code" href="structlnet__kiov__t.html" title="A page-based fragment of a MD.">lnet_kiov_t</a> *skiov,
<a name="l00669"></a>00669                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> soffset, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nob)
<a name="l00670"></a>00670 {
<a name="l00671"></a>00671         <span class="keyword">struct </span>kvec diov = {<span class="comment">/* .iov_base = */</span> dest, <span class="comment">/* .iov_len = */</span> dlen};
<a name="l00672"></a>00672 
<a name="l00673"></a>00673         <a class="code" href="lib-lnet_8h.html#afca3872259b837d7c21da9a494ea33fc">lnet_copy_kiov2iov</a>(1, &amp;diov, doffset,
<a name="l00674"></a>00674                            nsiov, skiov, soffset, nob);
<a name="l00675"></a>00675 }
<a name="l00676"></a>00676 
<a name="l00677"></a>00677 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00678"></a><a class="code" href="lib-lnet_8h.html#a79416c0137a241142e3e7fe58571bc71">00678</a> <a class="code" href="lib-lnet_8h.html#a79416c0137a241142e3e7fe58571bc71">lnet_copy_flat2iov</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ndiov, <span class="keyword">struct</span> kvec *diov, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> doffset,
<a name="l00679"></a>00679                    <span class="keywordtype">int</span> slen, <span class="keywordtype">void</span> *src, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> soffset,
<a name="l00680"></a>00680                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nob)
<a name="l00681"></a>00681 {
<a name="l00682"></a>00682         <span class="keyword">struct </span>kvec siov = {<span class="comment">/*.iov_base = */</span> src, <span class="comment">/*.iov_len = */</span>slen};
<a name="l00683"></a>00683         <a class="code" href="lib-lnet_8h.html#a508ca7860e56249ba0c520e9149ca9d3">lnet_copy_iov2iov</a>(ndiov, diov, doffset,
<a name="l00684"></a>00684                           1, &amp;siov, soffset, nob);
<a name="l00685"></a>00685 }
<a name="l00686"></a>00686 
<a name="l00687"></a>00687 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00688"></a><a class="code" href="lib-lnet_8h.html#a0219bf879a48e5b4f8d4fb8f1f6b3b9d">00688</a> <a class="code" href="lib-lnet_8h.html#a0219bf879a48e5b4f8d4fb8f1f6b3b9d">lnet_copy_flat2kiov</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ndiov, <a class="code" href="structlnet__kiov__t.html" title="A page-based fragment of a MD.">lnet_kiov_t</a> *dkiov,
<a name="l00689"></a>00689                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> doffset, <span class="keywordtype">int</span> slen, <span class="keywordtype">void</span> *src,
<a name="l00690"></a>00690                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> soffset, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nob)
<a name="l00691"></a>00691 {
<a name="l00692"></a>00692         <span class="keyword">struct </span>kvec siov = {<span class="comment">/* .iov_base = */</span> src, <span class="comment">/* .iov_len = */</span> slen};
<a name="l00693"></a>00693         <a class="code" href="lib-lnet_8h.html#aed700c91fb3ac4028e1d9e590a619db2">lnet_copy_iov2kiov</a>(ndiov, dkiov, doffset,
<a name="l00694"></a>00694                            1, &amp;siov, soffset, nob);
<a name="l00695"></a>00695 }
<a name="l00696"></a>00696 
<a name="l00697"></a>00697 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#af1464e9db9b13615bba71d0074e4d7a9">lnet_me_unlink</a>(<a class="code" href="structlnet__me.html">lnet_me_t</a> *me);
<a name="l00698"></a>00698 
<a name="l00699"></a>00699 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a34a8f8e394c3e4e4e5d8ecb8eb6f5c2d">lnet_md_unlink</a>(<a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *md);
<a name="l00700"></a>00700 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a9df85cbeb4487060156f347376f0844e">lnet_md_deconstruct</a>(<a class="code" href="structlnet__libmd.html">lnet_libmd_t</a> *lmd, <a class="code" href="structlnet__md__t.html" title="Defines the visible parts of a memory descriptor.">lnet_md_t</a> *umd);
<a name="l00701"></a>00701 
<a name="l00702"></a>00702 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a5e762adad947c234c9bc36f7d73a6bca">lnet_register_lnd</a>(<a class="code" href="structlnet__lnd.html">lnd_t</a> *lnd);
<a name="l00703"></a>00703 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a2fca05b374cbf76e030e000befde7e22">lnet_unregister_lnd</a>(<a class="code" href="structlnet__lnd.html">lnd_t</a> *lnd);
<a name="l00704"></a>00704 
<a name="l00705"></a>00705 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#ab012b0627607c05bc5fef68583e91cb7">lnet_connect</a>(<span class="keyword">struct</span> socket **sockp, <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> peer_nid,
<a name="l00706"></a>00706                  __u32 local_ip, __u32 peer_ip, <span class="keywordtype">int</span> peer_port);
<a name="l00707"></a>00707 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a09c11ddac64b02ae91d92b79f823021f">lnet_connect_console_error</a>(<span class="keywordtype">int</span> rc, <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> peer_nid,
<a name="l00708"></a>00708                                 __u32 peer_ip, <span class="keywordtype">int</span> port);
<a name="l00709"></a>00709 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a013ef8d9c463133d7c5c10f980b27f61">lnet_count_acceptor_nis</a>(<span class="keywordtype">void</span>);
<a name="l00710"></a>00710 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a674a4134fbc600087abff3a0e9e7de40">lnet_acceptor_timeout</a>(<span class="keywordtype">void</span>);
<a name="l00711"></a>00711 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a3070c0f724980baf43bdb1ea353bcb94">lnet_acceptor_port</a>(<span class="keywordtype">void</span>);
<a name="l00712"></a>00712 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a3c4cf070ab155ee508b0c37a157232de">lnet_acceptor_start</a>(<span class="keywordtype">void</span>);
<a name="l00713"></a>00713 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a5fbeeb9c8ff93937a5bc6d2ff41d4caf">lnet_acceptor_stop</a>(<span class="keywordtype">void</span>);
<a name="l00714"></a>00714 
<a name="l00715"></a>00715 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#af9cc06af5fb213c312969f6b6eac0370">lnet_ipif_query</a>(<span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="keywordtype">int</span> *up, __u32 *ip, __u32 *mask);
<a name="l00716"></a>00716 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a1f755bf5e369b57b578e5853dd0d7204">lnet_ipif_enumerate</a>(<span class="keywordtype">char</span> ***<a class="code" href="structnames.html">names</a>);
<a name="l00717"></a>00717 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#ae238efe8d2ee461589000fc35e8191a8">lnet_ipif_free_enumeration</a>(<span class="keywordtype">char</span> **<a class="code" href="structnames.html">names</a>, <span class="keywordtype">int</span> n);
<a name="l00718"></a>00718 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a2ba82bc946e4ada798b98ea0a3534690">lnet_sock_setbuf</a>(<span class="keyword">struct</span> socket *socket, <span class="keywordtype">int</span> txbufsize, <span class="keywordtype">int</span> rxbufsize);
<a name="l00719"></a>00719 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a016d207ab015ba8e192c55e2c959b6b9">lnet_sock_getbuf</a>(<span class="keyword">struct</span> socket *socket, <span class="keywordtype">int</span> *txbufsize, <span class="keywordtype">int</span> *rxbufsize);
<a name="l00720"></a>00720 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#ab659da604fa41f0cb00c4e184b10615e">lnet_sock_getaddr</a>(<span class="keyword">struct</span> socket *socket, <span class="keywordtype">bool</span> remote, __u32 *ip, <span class="keywordtype">int</span> *port);
<a name="l00721"></a>00721 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a0ec292d8cf87aaded013b9db93f5f134">lnet_sock_write</a>(<span class="keyword">struct</span> socket *sock, <span class="keywordtype">void</span> *buffer, <span class="keywordtype">int</span> nob, <span class="keywordtype">int</span> <a class="code" href="gnilnd__modparams_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>);
<a name="l00722"></a>00722 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#aced47784dc050ccc7496d74f7b230e1d">lnet_sock_read</a>(<span class="keyword">struct</span> socket *sock, <span class="keywordtype">void</span> *buffer, <span class="keywordtype">int</span> nob, <span class="keywordtype">int</span> <a class="code" href="gnilnd__modparams_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>);
<a name="l00723"></a>00723 
<a name="l00724"></a>00724 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a184d1f1aef6701cc9f72344719459b70">lnet_sock_listen</a>(<span class="keyword">struct</span> socket **sockp, __u32 ip, <span class="keywordtype">int</span> port, <span class="keywordtype">int</span> backlog);
<a name="l00725"></a>00725 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a9d6ea6a9bff0858b22d0939881837bc0">lnet_sock_accept</a>(<span class="keyword">struct</span> socket **newsockp, <span class="keyword">struct</span> socket *sock);
<a name="l00726"></a>00726 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a95208ee002c717b64595ea1f2bb45112">lnet_sock_connect</a>(<span class="keyword">struct</span> socket **sockp, <span class="keywordtype">int</span> *<a class="code" href="mdsrate_8c.html#a02582659c3f7cd1bc10bb67c66faca77">fatal</a>,
<a name="l00727"></a>00727                         __u32 local_ip, <span class="keywordtype">int</span> local_port,
<a name="l00728"></a>00728                         __u32 peer_ip, <span class="keywordtype">int</span> peer_port);
<a name="l00729"></a>00729 
<a name="l00730"></a>00730 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a673379cfb86cd3be09f61b640d045b67">lnet_peers_start_down</a>(<span class="keywordtype">void</span>);
<a name="l00731"></a>00731 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a2147023211f5c6c1a1affe16d13b970c">lnet_peer_buffer_credits</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni);
<a name="l00732"></a>00732 
<a name="l00733"></a>00733 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a85223b333c94826e6c2ef1af87324f34">lnet_router_checker_start</a>(<span class="keywordtype">void</span>);
<a name="l00734"></a>00734 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#aa375c6f715dd06ad561da71beb701201">lnet_router_checker_stop</a>(<span class="keywordtype">void</span>);
<a name="l00735"></a>00735 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a1b3e7c3e48aca657e204a3a6d34c19d1">lnet_router_ni_update_locked</a>(<a class="code" href="structlnet__peer.html">lnet_peer_t</a> *gw, __u32 net);
<a name="l00736"></a>00736 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a150da8c6c08a31c8f5cb58f664487c9e">lnet_swap_pinginfo</a>(lnet_ping_info_t *info);
<a name="l00737"></a>00737 
<a name="l00738"></a>00738 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a7a595e99c2041b1b4132e483206f92bc">lnet_parse_ip2nets</a>(<span class="keywordtype">char</span> **networksp, <span class="keywordtype">char</span> *<a class="code" href="api-ni_8c.html#a29ad678cbaad83debf80f4c98318f774">ip2nets</a>);
<a name="l00739"></a>00739 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#abd6486b686cc13e3c00baa6781f7adee">lnet_parse_routes</a>(<span class="keywordtype">char</span> *route_str, <span class="keywordtype">int</span> *im_a_router);
<a name="l00740"></a>00740 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#a4803abf7b59a4c6a282dbf23eb9ea5a9">lnet_parse_networks</a>(<span class="keyword">struct</span> <a class="code" href="structlist__head.html">list_head</a> *nilist, <span class="keywordtype">char</span> *<a class="code" href="api-ni_8c.html#ae0d82171f945eecd88c46b0e701129a7">networks</a>);
<a name="l00741"></a>00741 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#ae9395e70de0c4fc05834b91467d2b9bf">lnet_net_unique</a>(__u32 net, <span class="keyword">struct</span> <a class="code" href="structlist__head.html">list_head</a> *nilist);
<a name="l00742"></a>00742 
<a name="l00743"></a>00743 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#aa064a952fa406bfc2228a554e7075f39">lnet_nid2peer_locked</a>(<a class="code" href="structlnet__peer.html">lnet_peer_t</a> **lpp, <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> nid, <span class="keywordtype">int</span> cpt);
<a name="l00744"></a>00744 <a class="code" href="structlnet__peer.html">lnet_peer_t</a> *<a class="code" href="lib-lnet_8h.html#a2b3c95b4a0baf532df72ced66e088f15">lnet_find_peer_locked</a>(<span class="keyword">struct</span> <a class="code" href="structlnet__peer__table.html">lnet_peer_table</a> *ptable,
<a name="l00745"></a>00745                                    <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> nid);
<a name="l00746"></a>00746 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a4ecbf39701e825dedc66ad20e7523656">lnet_peer_tables_cleanup</a>(<a class="code" href="structlnet__ni.html">lnet_ni_t</a> *ni);
<a name="l00747"></a>00747 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a5b56159a8a712dab099ce0deb651712f">lnet_peer_tables_destroy</a>(<span class="keywordtype">void</span>);
<a name="l00748"></a>00748 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#ae2077b70cad6c20dd2f980de02d6cb4b">lnet_peer_tables_create</a>(<span class="keywordtype">void</span>);
<a name="l00749"></a>00749 <span class="keywordtype">void</span> <a class="code" href="lib-lnet_8h.html#a1358dd1f85100bd823be3b82d3b446d1">lnet_debug_peer</a>(<a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a> nid);
<a name="l00750"></a>00750 <span class="keywordtype">int</span> <a class="code" href="lib-lnet_8h.html#ab18dd9ae2f5a3c153b2bf04a013d9011">lnet_get_peer_info</a>(__u32 peer_index, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *nid,
<a name="l00751"></a>00751                        <span class="keywordtype">char</span> alivness[<a class="code" href="lib-dlc_8h.html#ac11ea352ca46476c5b873dcc2a1af68d">LNET_MAX_STR_LEN</a>],
<a name="l00752"></a>00752                        __u32 *cpt_iter, __u32 *refcount,
<a name="l00753"></a>00753                        __u32 *ni_peer_tx_credits, __u32 *peer_tx_credits,
<a name="l00754"></a>00754                        __u32 *peer_rtr_credits, __u32 *peer_min_rtr_credtis,
<a name="l00755"></a>00755                        __u32 *peer_tx_qnob);
<a name="l00756"></a>00756 
<a name="l00757"></a>00757 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00758"></a><a class="code" href="lib-lnet_8h.html#af5f84e178653285e98448efee6d8930d">00758</a> <a class="code" href="lib-lnet_8h.html#af5f84e178653285e98448efee6d8930d">lnet_peer_set_alive</a>(<a class="code" href="structlnet__peer.html">lnet_peer_t</a> *lp)
<a name="l00759"></a>00759 {
<a name="l00760"></a>00760         lp-&gt;<a class="code" href="structlnet__peer.html#a9c6c59cf8dc61f01d0577922040f6092">lp_last_alive</a> = lp-&gt;<a class="code" href="structlnet__peer.html#a803acb8f36c560cf4bdcad307639f484">lp_last_query</a> = <a class="code" href="linux-time_8h.html#adc63a7977338536b551ccc795e5a9148">cfs_time_current</a>();
<a name="l00761"></a>00761         <span class="keywordflow">if</span> (!lp-&gt;<a class="code" href="structlnet__peer.html#a93b08b2e2755d5ba314e5671614fffc4">lp_alive</a>)
<a name="l00762"></a>00762                 <a class="code" href="lib-lnet_8h.html#ae93afae01538e838ac249ad20167547d">lnet_notify_locked</a>(lp, 0, 1, lp-&gt;<a class="code" href="structlnet__peer.html#a9c6c59cf8dc61f01d0577922040f6092">lp_last_alive</a>);
<a name="l00763"></a>00763 }
<a name="l00764"></a>00764 
<a name="l00765"></a>00765 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:33 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
