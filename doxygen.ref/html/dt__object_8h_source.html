<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/include/dt_object.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>lustre/include/dt_object.h</h1><a href="dt__object_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * GPL HEADER START</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> * it under the terms of the GNU General Public License version 2 only,</span>
<a name="l00008"></a>00008 <span class="comment"> * as published by the Free Software Foundation.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * This program is distributed in the hope that it will be useful, but</span>
<a name="l00011"></a>00011 <span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00013"></a>00013 <span class="comment"> * General Public License version 2 for more details (a copy is included</span>
<a name="l00014"></a>00014 <span class="comment"> * in the LICENSE file that accompanied this code).</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> * version 2 along with this program; If not, see</span>
<a name="l00018"></a>00018 <span class="comment"> * http://www.sun.com/software/products/lustre/docs/GPLv2.pdf</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * Please contact Sun Microsystems, Inc., 4150 Network Circle, Santa Clara,</span>
<a name="l00021"></a>00021 <span class="comment"> * CA 95054 USA or visit www.sun.com if you need additional information or</span>
<a name="l00022"></a>00022 <span class="comment"> * have any questions.</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * GPL HEADER END</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 <span class="comment">/*</span>
<a name="l00027"></a>00027 <span class="comment"> * Copyright (c) 2007, 2010, Oracle and/or its affiliates. All rights reserved.</span>
<a name="l00028"></a>00028 <span class="comment"> * Use is subject to license terms.</span>
<a name="l00029"></a>00029 <span class="comment"> *</span>
<a name="l00030"></a>00030 <span class="comment"> * Copyright (c) 2011, 2015, Intel Corporation.</span>
<a name="l00031"></a>00031 <span class="comment"> */</span>
<a name="l00032"></a>00032 <span class="comment">/*</span>
<a name="l00033"></a>00033 <span class="comment"> * This file is part of Lustre, http://www.lustre.org/</span>
<a name="l00034"></a>00034 <span class="comment"> * Lustre is a trademark of Sun Microsystems, Inc.</span>
<a name="l00035"></a>00035 <span class="comment"> */</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="preprocessor">#ifndef __LUSTRE_DT_OBJECT_H</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span><span class="preprocessor">#define __LUSTRE_DT_OBJECT_H</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;<a class="code" href="obd__support_8h.html">obd_support.h</a>&gt;</span>
<a name="l00053"></a>00053 <span class="comment">/*</span>
<a name="l00054"></a>00054 <span class="comment"> * super-class definitions.</span>
<a name="l00055"></a>00055 <span class="comment"> */</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &lt;<a class="code" href="lu__object_8h.html">lu_object.h</a>&gt;</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#include &lt;<a class="code" href="libcfs_8h.html">libcfs/libcfs.h</a>&gt;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="keyword">struct </span>seq_file;
<a name="l00061"></a>00061 <span class="keyword">struct </span>proc_dir_entry;
<a name="l00062"></a>00062 <span class="keyword">struct </span><a class="code" href="structlustre__cfg.html">lustre_cfg</a>;
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a>;
<a name="l00065"></a>00065 <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a>;
<a name="l00066"></a>00066 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>;
<a name="l00067"></a>00067 <span class="keyword">struct </span><a class="code" href="structdt__index__features.html">dt_index_features</a>;
<a name="l00068"></a>00068 <span class="keyword">struct </span><a class="code" href="structniobuf__local.html">niobuf_local</a>;
<a name="l00069"></a>00069 <span class="keyword">struct </span><a class="code" href="structniobuf__remote.html">niobuf_remote</a>;
<a name="l00070"></a>00070 <span class="keyword">struct </span><a class="code" href="structldlm__enqueue__info.html" title="Common ldlm_enqueue parameters.">ldlm_enqueue_info</a>;
<a name="l00071"></a>00071 
<a name="l00072"></a><a class="code" href="group__dt.html#ga702d713d6b7050d3d63e778e92d15356">00072</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00073"></a><a class="code" href="group__dt.html#gga702d713d6b7050d3d63e778e92d15356ac7f56d5342504cb87e80f08068dd437e">00073</a>         <a class="code" href="group__dt.html#gga702d713d6b7050d3d63e778e92d15356ac7f56d5342504cb87e80f08068dd437e">MNTOPT_USERXATTR</a>        = 0x00000001,
<a name="l00074"></a><a class="code" href="group__dt.html#gga702d713d6b7050d3d63e778e92d15356ac9071fc7065895dfcdeb605ce068ed8b">00074</a>         <a class="code" href="group__dt.html#gga702d713d6b7050d3d63e778e92d15356ac9071fc7065895dfcdeb605ce068ed8b">MNTOPT_ACL</a>              = 0x00000002,
<a name="l00075"></a>00075 } <a class="code" href="group__dt.html#ga702d713d6b7050d3d63e778e92d15356">mntopt_t</a>;
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="structdt__device__param.html">00077</a> <span class="keyword">struct </span><a class="code" href="structdt__device__param.html">dt_device_param</a> {
<a name="l00078"></a><a class="code" href="structdt__device__param.html#af8316f31862fa8b18840b3514b182332">00078</a>         <span class="keywordtype">unsigned</span>           <a class="code" href="structdt__device__param.html#af8316f31862fa8b18840b3514b182332">ddp_max_name_len</a>;
<a name="l00079"></a><a class="code" href="structdt__device__param.html#afa03d8318289ddd8632da0d981295bb9">00079</a>         <span class="keywordtype">unsigned</span>           <a class="code" href="structdt__device__param.html#afa03d8318289ddd8632da0d981295bb9">ddp_max_nlink</a>;
<a name="l00080"></a><a class="code" href="structdt__device__param.html#aed4e705b0540cdec897d4b814e0047c5">00080</a>         <span class="keywordtype">unsigned</span>           <a class="code" href="structdt__device__param.html#aed4e705b0540cdec897d4b814e0047c5">ddp_symlink_max</a>;
<a name="l00081"></a><a class="code" href="structdt__device__param.html#adda8327d3cbd9166a5fe9c5a9252e918">00081</a>         <a class="code" href="group__dt.html#ga702d713d6b7050d3d63e778e92d15356">mntopt_t</a>           <a class="code" href="structdt__device__param.html#adda8327d3cbd9166a5fe9c5a9252e918">ddp_mntopts</a>;
<a name="l00082"></a><a class="code" href="structdt__device__param.html#a3c0a0efc92c77c2d61de89a98f66f4ba">00082</a>         <span class="keywordtype">unsigned</span>           <a class="code" href="structdt__device__param.html#a3c0a0efc92c77c2d61de89a98f66f4ba">ddp_max_ea_size</a>;
<a name="l00083"></a><a class="code" href="structdt__device__param.html#a48d6c49abd68cfbdf3ec1db797779595">00083</a>         <span class="keywordtype">unsigned</span>           <a class="code" href="structdt__device__param.html#a48d6c49abd68cfbdf3ec1db797779595">ddp_mount_type</a>;
<a name="l00084"></a><a class="code" href="structdt__device__param.html#a1ab92dc07b60ea69f057140dca93baf6">00084</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="structdt__device__param.html#a1ab92dc07b60ea69f057140dca93baf6">ddp_maxbytes</a>;
<a name="l00085"></a>00085         <span class="comment">/* per-inode space consumption */</span>
<a name="l00086"></a><a class="code" href="structdt__device__param.html#ad2ce7f6a5822e5cc4f33112458436b8d">00086</a>         <span class="keywordtype">short</span>              <a class="code" href="structdt__device__param.html#ad2ce7f6a5822e5cc4f33112458436b8d">ddp_inodespace</a>;
<a name="l00087"></a>00087         <span class="comment">/* maximum number of blocks in an extent */</span>
<a name="l00088"></a><a class="code" href="structdt__device__param.html#ac49b1f9dacc5f74a120f079829259d74">00088</a>         <span class="keywordtype">unsigned</span>           <a class="code" href="structdt__device__param.html#ac49b1f9dacc5f74a120f079829259d74">ddp_max_extent_blks</a>;
<a name="l00089"></a>00089         <span class="comment">/* per-extent insertion overhead to be used by client for grant</span>
<a name="l00090"></a>00090 <span class="comment">         * calculation */</span>
<a name="l00091"></a><a class="code" href="structdt__device__param.html#a5c4f0e2e675086d2d9309e8fb30f15a1">00091</a>         <span class="keywordtype">unsigned</span>           <a class="code" href="structdt__device__param.html#a5c4f0e2e675086d2d9309e8fb30f15a1">ddp_extent_tax</a>;
<a name="l00092"></a>00092 };
<a name="l00093"></a>00093 
<a name="l00097"></a>00097 <span class="keyword">struct </span><a class="code" href="structdt__txn__commit__cb.html">dt_txn_commit_cb</a>;
<a name="l00098"></a><a class="code" href="group__dt.html#gaba396c991d563511fe88d54364f2dcdd">00098</a> <span class="keyword">typedef</span> void (*<a class="code" href="group__dt.html#gaba396c991d563511fe88d54364f2dcdd">dt_cb_t</a>)(<span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th,
<a name="l00099"></a>00099                         <span class="keyword">struct </span><a class="code" href="structdt__txn__commit__cb.html">dt_txn_commit_cb</a> *<a class="code" href="it__test_8c.html#a3edc96db5310d665bb056d7adc554a8f">cb</a>, <span class="keywordtype">int</span> err);
<a name="l00104"></a><a class="code" href="group__dt.html#ga89459f49f808512a60eea34fdcd5e43f">00104</a> <span class="preprocessor">#define TRANS_COMMIT_CB_MAGIC   0xa0a00a0a</span>
<a name="l00105"></a><a class="code" href="group__dt.html#ga716afbe942a3175836889d7de4f4ded0">00105</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_COMMIT_CB_STR_LEN   32</span>
<a name="l00106"></a>00106 <span class="preprocessor"></span>
<a name="l00107"></a><a class="code" href="group__dt.html#gabe394c0aa5524a71fed15e79c362c90c">00107</a> <span class="preprocessor">#define DCB_TRANS_STOP          0x1</span>
<a name="l00108"></a><a class="code" href="structdt__txn__commit__cb.html">00108</a> <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="structdt__txn__commit__cb.html">dt_txn_commit_cb</a> {
<a name="l00109"></a><a class="code" href="structdt__txn__commit__cb.html#a9c4a7e3b0d51f0c1b41cb7caee08caa8">00109</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structdt__txn__commit__cb.html#a9c4a7e3b0d51f0c1b41cb7caee08caa8">dcb_linkage</a>;
<a name="l00110"></a><a class="code" href="structdt__txn__commit__cb.html#a083632339beee3613b7bb5a3c2efcdbc">00110</a>         <a class="code" href="group__dt.html#gaba396c991d563511fe88d54364f2dcdd">dt_cb_t</a>                 <a class="code" href="structdt__txn__commit__cb.html#a083632339beee3613b7bb5a3c2efcdbc">dcb_func</a>;
<a name="l00111"></a><a class="code" href="structdt__txn__commit__cb.html#a9846a1d9198413e72b8154d8f9c55146">00111</a>         <span class="keywordtype">void</span>                    *<a class="code" href="structdt__txn__commit__cb.html#a9846a1d9198413e72b8154d8f9c55146">dcb_data</a>;
<a name="l00112"></a><a class="code" href="structdt__txn__commit__cb.html#ae34349e1d25fe1d884fa709f957c0111">00112</a>         __u32                   <a class="code" href="structdt__txn__commit__cb.html#ae34349e1d25fe1d884fa709f957c0111">dcb_magic</a>;
<a name="l00113"></a><a class="code" href="structdt__txn__commit__cb.html#a3fd5344bfc0c57b2436a07c37546d1e9">00113</a>         __u32                   <a class="code" href="structdt__txn__commit__cb.html#a3fd5344bfc0c57b2436a07c37546d1e9">dcb_flags</a>;
<a name="l00114"></a><a class="code" href="structdt__txn__commit__cb.html#a6de857ce08a80358ea07759ef70dd2d6">00114</a>         <span class="keywordtype">char</span>                    <a class="code" href="structdt__txn__commit__cb.html#a6de857ce08a80358ea07759ef70dd2d6">dcb_name</a>[<a class="code" href="group__dt.html#ga716afbe942a3175836889d7de4f4ded0">MAX_COMMIT_CB_STR_LEN</a>];
<a name="l00115"></a>00115 };
<a name="l00116"></a>00116 
<a name="l00120"></a><a class="code" href="structdt__device__operations.html">00120</a> <span class="keyword">struct </span><a class="code" href="structdt__device__operations.html" title="Operations on dt device.">dt_device_operations</a> {
<a name="l00135"></a>00135         int   (*<a class="code" href="structdt__device__operations.html#a5551db7b0deb0d6c07fc738552f445f7" title="Return device-wide statistics.">dt_statfs</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00136"></a>00136                            <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l00137"></a>00137                            <span class="keyword">struct </span><a class="code" href="structobd__statfs.html">obd_statfs</a> *osfs);
<a name="l00138"></a>00138 
<a name="l00155"></a>00155         <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *(*dt_trans_create)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00156"></a>00156                                            <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *dev);
<a name="l00157"></a>00157 
<a name="l00176"></a>00176         int   (*<a class="code" href="structdt__device__operations.html#a9f4532e51dbeefa61d9c0f6a9670ef5b" title="Start transaction.">dt_trans_start</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00177"></a>00177                                 <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l00178"></a>00178                                 <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00179"></a>00179 
<a name="l00196"></a>00196         int   (*<a class="code" href="structdt__device__operations.html#a1a48e37999c62e8d1d2ad6e84572393b" title="Stop transaction.">dt_trans_stop</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00197"></a>00197                                <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l00198"></a>00198                                <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00199"></a>00199 
<a name="l00220"></a>00220         int   (*<a class="code" href="structdt__device__operations.html#a977a253aad1d585cf9c316c3f87d801d" title="Add commit callback to the transaction.">dt_trans_cb_add</a>)(<span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th,
<a name="l00221"></a>00221                                  <span class="keyword">struct </span><a class="code" href="structdt__txn__commit__cb.html">dt_txn_commit_cb</a> *dcb);
<a name="l00222"></a>00222 
<a name="l00238"></a>00238         int   (*<a class="code" href="structdt__device__operations.html#ad2a831d38be0be73f8a5498112e13b56" title="Return FID of root index object.">dt_root_get</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00239"></a>00239                              <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l00240"></a>00240                              <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *f);
<a name="l00241"></a>00241 
<a name="l00253"></a>00253         void  (*<a class="code" href="structdt__device__operations.html#a652ff54fee6fbc7f4a5dda78befe5489" title="Return device configuration data.">dt_conf_get</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00254"></a>00254                              <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l00255"></a>00255                              <span class="keyword">struct </span><a class="code" href="structdt__device__param.html">dt_device_param</a> *param);
<a name="l00256"></a>00256 
<a name="l00272"></a>00272         int   (*<a class="code" href="structdt__device__operations.html#aff03760ef16c08ef22ecfcace4a7afb9" title="Sync the device.">dt_sync</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00273"></a>00273                          <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *dev);
<a name="l00274"></a>00274 
<a name="l00289"></a>00289         int   (*<a class="code" href="structdt__device__operations.html#a03deb463a9aebe843829c31bbab1c34d" title="Make device read-only.">dt_ro</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00290"></a>00290                        <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *dev);
<a name="l00291"></a>00291 
<a name="l00308"></a>00308          int   (*<a class="code" href="structdt__device__operations.html#ab811b4bbba68f4edcab228e8d9f52d3c" title="Start transaction commit asynchronously.">dt_commit_async</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00309"></a>00309                                   <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *dev);
<a name="l00310"></a>00310 };
<a name="l00311"></a>00311 
<a name="l00312"></a><a class="code" href="structdt__index__features.html">00312</a> <span class="keyword">struct </span><a class="code" href="structdt__index__features.html">dt_index_features</a> {
<a name="l00314"></a><a class="code" href="structdt__index__features.html#a6e28f4490776ccf640ebe0cf484fd399">00314</a>         __u32 <a class="code" href="structdt__index__features.html#a6e28f4490776ccf640ebe0cf484fd399" title="required feature flags from enum dt_index_flags">dif_flags</a>;
<a name="l00316"></a><a class="code" href="structdt__index__features.html#ac7aa410827e498d147110abf38558568">00316</a>         <span class="keywordtype">size_t</span> <a class="code" href="structdt__index__features.html#ac7aa410827e498d147110abf38558568" title="minimal required key size">dif_keysize_min</a>;
<a name="l00318"></a><a class="code" href="structdt__index__features.html#a77a9d510b54a3321beab43f9fd27f72b">00318</a>         <span class="keywordtype">size_t</span> <a class="code" href="structdt__index__features.html#a77a9d510b54a3321beab43f9fd27f72b" title="maximal required key size, 0 if no limit">dif_keysize_max</a>;
<a name="l00320"></a><a class="code" href="structdt__index__features.html#a88a7d8aa4fc396ad2086af7de8b937f2">00320</a>         <span class="keywordtype">size_t</span> <a class="code" href="structdt__index__features.html#a88a7d8aa4fc396ad2086af7de8b937f2" title="minimal required record size">dif_recsize_min</a>;
<a name="l00322"></a><a class="code" href="structdt__index__features.html#af2fc6bfffa47d0412407d9290d32655d">00322</a>         <span class="keywordtype">size_t</span> <a class="code" href="structdt__index__features.html#af2fc6bfffa47d0412407d9290d32655d" title="maximal required record size, 0 if no limit">dif_recsize_max</a>;
<a name="l00324"></a><a class="code" href="structdt__index__features.html#a19644a422581281ac914664e8c44a66e">00324</a>         <span class="keywordtype">size_t</span> <a class="code" href="structdt__index__features.html#a19644a422581281ac914664e8c44a66e" title="pointer size for record">dif_ptrsize</a>;
<a name="l00325"></a>00325 };
<a name="l00326"></a>00326 
<a name="l00327"></a><a class="code" href="group__dt.html#gaea9a8b2931d0590dac0d8265121fd073">00327</a> <span class="keyword">enum</span> <a class="code" href="group__dt.html#gaea9a8b2931d0590dac0d8265121fd073">dt_index_flags</a> {
<a name="l00329"></a><a class="code" href="group__dt.html#ggaea9a8b2931d0590dac0d8265121fd073aef32729c6e8d2121075e256eabb309dc">00329</a>         <a class="code" href="group__dt.html#ggaea9a8b2931d0590dac0d8265121fd073aef32729c6e8d2121075e256eabb309dc" title="index supports variable sized keys">DT_IND_VARKEY</a> = 1 &lt;&lt; 0,
<a name="l00331"></a><a class="code" href="group__dt.html#ggaea9a8b2931d0590dac0d8265121fd073a665c80fdf583c3b6fad49b7b2a59a97b">00331</a>         <a class="code" href="group__dt.html#ggaea9a8b2931d0590dac0d8265121fd073a665c80fdf583c3b6fad49b7b2a59a97b" title="index supports variable sized records">DT_IND_VARREC</a> = 1 &lt;&lt; 1,
<a name="l00333"></a><a class="code" href="group__dt.html#ggaea9a8b2931d0590dac0d8265121fd073a6528f1359f7a4f7626b6e1aa3b0d0eef">00333</a>         <a class="code" href="group__dt.html#ggaea9a8b2931d0590dac0d8265121fd073a6528f1359f7a4f7626b6e1aa3b0d0eef" title="index can be modified">DT_IND_UPDATE</a> = 1 &lt;&lt; 2,
<a name="l00335"></a><a class="code" href="group__dt.html#ggaea9a8b2931d0590dac0d8265121fd073a044b89f60c36ae2452a89148297b5494">00335</a>         <a class="code" href="group__dt.html#ggaea9a8b2931d0590dac0d8265121fd073a044b89f60c36ae2452a89148297b5494" title="index supports records with non-unique (duplicate) keys">DT_IND_NONUNQ</a> = 1 &lt;&lt; 3,
<a name="l00340"></a><a class="code" href="group__dt.html#ggaea9a8b2931d0590dac0d8265121fd073ae8406895b47a49eecdc3a0bae248d20e">00340</a>         <a class="code" href="group__dt.html#ggaea9a8b2931d0590dac0d8265121fd073ae8406895b47a49eecdc3a0bae248d20e" title="index support fixed-size keys sorted with natural numerical way and is able to return...">DT_IND_RANGE</a> = 1 &lt;&lt; 4,
<a name="l00341"></a>00341 };
<a name="l00342"></a>00342 
<a name="l00347"></a>00347 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__index__features.html">dt_index_features</a> <a class="code" href="group__dt.html#ga7c4fc0f51c05675af9609faa67c6cdea" title="Features, required from index to support file system directories (mapping names to...">dt_directory_features</a>;
<a name="l00348"></a>00348 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__index__features.html">dt_index_features</a> <a class="code" href="group__dt.html#ga955be97567cd4f10ba705a48e4819630">dt_otable_features</a>;
<a name="l00349"></a>00349 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__index__features.html">dt_index_features</a> <a class="code" href="group__dt.html#gae13ff083e120116d3a395c63dd819926">dt_lfsck_orphan_features</a>;
<a name="l00350"></a>00350 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__index__features.html">dt_index_features</a> <a class="code" href="group__dt.html#ga061e888f6487d5b0d8d257d2281a13bc">dt_lfsck_features</a>;
<a name="l00351"></a>00351 
<a name="l00352"></a>00352 <span class="comment">/* index features supported by the accounting objects */</span>
<a name="l00353"></a>00353 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__index__features.html">dt_index_features</a> <a class="code" href="group__dt.html#gad270c9ad2af37e53181636318069fb66">dt_acct_features</a>;
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 <span class="comment">/* index features supported by the quota global indexes */</span>
<a name="l00356"></a>00356 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__index__features.html">dt_index_features</a> <a class="code" href="group__dt.html#gacf4fe33d2b03960e2f36e43a44672110">dt_quota_glb_features</a>;
<a name="l00357"></a>00357 
<a name="l00358"></a>00358 <span class="comment">/* index features supported by the quota slave indexes */</span>
<a name="l00359"></a>00359 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__index__features.html">dt_index_features</a> <a class="code" href="group__dt.html#ga3dea828e72a4601418f4ab9e4a4f6daa">dt_quota_slv_features</a>;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361 <span class="comment">/* index features supported by the nodemap index */</span>
<a name="l00362"></a>00362 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__index__features.html">dt_index_features</a> <a class="code" href="group__dt.html#ga68904eda04a363ab89709b9a56337f76">dt_nodemap_features</a>;
<a name="l00363"></a>00363 
<a name="l00369"></a><a class="code" href="structdt__allocation__hint.html">00369</a> <span class="keyword">struct </span><a class="code" href="structdt__allocation__hint.html" title="This is a general purpose dt allocation hint.">dt_allocation_hint</a> {
<a name="l00370"></a><a class="code" href="structdt__allocation__hint.html#a1a5f086e9baef8016e95fcd7f751dbee">00370</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>        *<a class="code" href="structdt__allocation__hint.html#a1a5f086e9baef8016e95fcd7f751dbee">dah_parent</a>;
<a name="l00371"></a><a class="code" href="structdt__allocation__hint.html#adce9044310ecc1c5767b28548a82f1fe">00371</a>         <span class="keyword">const</span> <span class="keywordtype">void</span>              *<a class="code" href="structdt__allocation__hint.html#adce9044310ecc1c5767b28548a82f1fe">dah_eadata</a>;
<a name="l00372"></a><a class="code" href="structdt__allocation__hint.html#ac212a3147f4c893fb4c96787b71649cc">00372</a>         <span class="keywordtype">int</span>                     <a class="code" href="structdt__allocation__hint.html#ac212a3147f4c893fb4c96787b71649cc">dah_eadata_len</a>;
<a name="l00373"></a><a class="code" href="structdt__allocation__hint.html#ae7b6e34f95f5abd4e40f555787e733d8">00373</a>         __u32                   <a class="code" href="structdt__allocation__hint.html#ae7b6e34f95f5abd4e40f555787e733d8">dah_mode</a>;
<a name="l00374"></a>00374 };
<a name="l00375"></a>00375 
<a name="l00380"></a><a class="code" href="group__dt.html#ga51d4c45efee77175aa61574dbc46b53e">00380</a> <span class="keyword">enum</span> <a class="code" href="group__dt.html#ga51d4c45efee77175aa61574dbc46b53e" title="object type specifier.">dt_format_type</a> {
<a name="l00381"></a><a class="code" href="group__dt.html#gga51d4c45efee77175aa61574dbc46b53ea0c4eaf54ac45780b249e48c438ac44b9">00381</a>         <a class="code" href="group__dt.html#gga51d4c45efee77175aa61574dbc46b53ea0c4eaf54ac45780b249e48c438ac44b9">DFT_REGULAR</a>,
<a name="l00382"></a><a class="code" href="group__dt.html#gga51d4c45efee77175aa61574dbc46b53ea90d493b70c14b53cdd678277d13913fa">00382</a>         <a class="code" href="group__dt.html#gga51d4c45efee77175aa61574dbc46b53ea90d493b70c14b53cdd678277d13913fa">DFT_DIR</a>,
<a name="l00384"></a><a class="code" href="group__dt.html#gga51d4c45efee77175aa61574dbc46b53ea5ffd82c5e6e58403e141f5ab4867a310">00384</a>         <a class="code" href="group__dt.html#gga51d4c45efee77175aa61574dbc46b53ea5ffd82c5e6e58403e141f5ab4867a310" title="for mknod">DFT_NODE</a>,
<a name="l00386"></a><a class="code" href="group__dt.html#gga51d4c45efee77175aa61574dbc46b53ead93af9542695653a7e07004064dcfea4">00386</a>         <a class="code" href="group__dt.html#gga51d4c45efee77175aa61574dbc46b53ead93af9542695653a7e07004064dcfea4" title="for special index">DFT_INDEX</a>,
<a name="l00388"></a><a class="code" href="group__dt.html#gga51d4c45efee77175aa61574dbc46b53ea3ff5f1672deeb66303f63fc82b49fd11">00388</a>         <a class="code" href="group__dt.html#gga51d4c45efee77175aa61574dbc46b53ea3ff5f1672deeb66303f63fc82b49fd11" title="for symbolic link">DFT_SYM</a>,
<a name="l00389"></a>00389 };
<a name="l00390"></a>00390 
<a name="l00394"></a><a class="code" href="structdt__object__format.html">00394</a> <span class="keyword">struct </span><a class="code" href="structdt__object__format.html" title="object format specifier.">dt_object_format</a> {
<a name="l00396"></a><a class="code" href="structdt__object__format.html#a7522bce1087145d78c749b182e10357c">00396</a>         <span class="keyword">enum</span> <a class="code" href="group__dt.html#ga51d4c45efee77175aa61574dbc46b53e" title="object type specifier.">dt_format_type</a> <a class="code" href="structdt__object__format.html#a7522bce1087145d78c749b182e10357c" title="type for dt object">dof_type</a>;
<a name="l00397"></a>00397         <span class="keyword">union </span>{
<a name="l00398"></a>00398                 <span class="keyword">struct </span>dof_regular {
<a name="l00399"></a><a class="code" href="structdt__object__format.html#aa3501c9982a765e69ab919776a650adb">00399</a>                         <span class="keywordtype">int</span> <a class="code" href="structdt__object__format.html#aa3501c9982a765e69ab919776a650adb">striped</a>;
<a name="l00400"></a>00400                 } <a class="code" href="structdt__object__format.html#a1360e65937447b79d2cf8985faf12984">dof_reg</a>;
<a name="l00401"></a>00401                 <span class="keyword">struct </span><a class="code" href="structdt__object__format.html#af27db72f3e224a2ab9db1f3a1cde558d">dof_dir</a> {
<a name="l00402"></a>00402                 } <a class="code" href="structdt__object__format.html#af27db72f3e224a2ab9db1f3a1cde558d">dof_dir</a>;
<a name="l00403"></a>00403                 <span class="keyword">struct </span><a class="code" href="structdt__object__format.html#a599d5fba1d8ac375bbdf24fcca8045a9">dof_node</a> {
<a name="l00404"></a>00404                 } <a class="code" href="structdt__object__format.html#a599d5fba1d8ac375bbdf24fcca8045a9">dof_node</a>;
<a name="l00409"></a>00409                 <span class="keyword">struct </span>dof_index {
<a name="l00410"></a><a class="code" href="structdt__object__format.html#a217f404e10cbe1d7e98cec908d9edd69">00410</a>                         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__index__features.html">dt_index_features</a> *<a class="code" href="structdt__object__format.html#a217f404e10cbe1d7e98cec908d9edd69">di_feat</a>;
<a name="l00411"></a>00411                 } <a class="code" href="structdt__object__format.html#a2570277a076882708ae6b6d1419bfa13" title="special index need feature as parameter to create special idx">dof_idx</a>;
<a name="l00412"></a>00412         } <a class="code" href="structdt__object__format.html#ab53de8222a0a448faf6fe773746a36ed">u</a>;
<a name="l00413"></a>00413 };
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 <span class="keyword">enum</span> <a class="code" href="group__dt.html#ga51d4c45efee77175aa61574dbc46b53e" title="object type specifier.">dt_format_type</a> <a class="code" href="group__dt.html#gad6af79a79c8597e18dc8f25db599c70b">dt_mode_to_dft</a>(__u32 <a class="code" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>);
<a name="l00416"></a>00416 
<a name="l00417"></a><a class="code" href="group__dt.html#gad589f42840c693e67e09774b46036250">00417</a> <span class="keyword">typedef</span> <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="group__dt.html#gad589f42840c693e67e09774b46036250">dt_obj_version_t</a>;
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 <span class="keyword">union </span><a class="code" href="unionldlm__policy__data.html">ldlm_policy_data</a>;
<a name="l00420"></a>00420 
<a name="l00425"></a><a class="code" href="structdt__object__operations.html">00425</a> <span class="keyword">struct </span><a class="code" href="structdt__object__operations.html" title="A dt_object provides common operations to create and destroy objects and to manage...">dt_object_operations</a> {
<a name="l00437"></a>00437         void  (*<a class="code" href="structdt__object__operations.html#a32a37f3abca0903ec9fa5c70b2b7a423" title="Get read lock on object.">do_read_lock</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00438"></a>00438                               <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00439"></a>00439                               <span class="keywordtype">unsigned</span> role);
<a name="l00440"></a>00440 
<a name="l00441"></a>00441         <span class="comment">/*</span>
<a name="l00442"></a>00442 <span class="comment">         * Get write lock on object.</span>
<a name="l00443"></a>00443 <span class="comment">         *</span>
<a name="l00444"></a>00444 <span class="comment">         * Write lock is exclusive and cannot be shared. The lock is blocking</span>
<a name="l00445"></a>00445 <span class="comment">         * and can&apos;t be used from an interrupt context.</span>
<a name="l00446"></a>00446 <span class="comment">         *</span>
<a name="l00447"></a>00447 <span class="comment">         * \param[in] env       execution environment for this thread</span>
<a name="l00448"></a>00448 <span class="comment">         * \param[in] dt        object to lock for writing</span>
<a name="l00449"></a>00449 <span class="comment">         * \param[in] role      a hint to debug locks (see kernel&apos;s mutexes)</span>
<a name="l00450"></a>00450 <span class="comment">         *</span>
<a name="l00451"></a>00451 <span class="comment">         */</span>
<a name="l00452"></a>00452         void  (*<a class="code" href="structdt__object__operations.html#a5bf582901eb4dcb781f03f02621535a2">do_write_lock</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00453"></a>00453                                <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00454"></a>00454                                <span class="keywordtype">unsigned</span> role);
<a name="l00455"></a>00455 
<a name="l00462"></a>00462         void  (*<a class="code" href="structdt__object__operations.html#a5d68d191697e7964615a090f9896f7f5" title="Release read lock.">do_read_unlock</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00463"></a>00463                                 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt);
<a name="l00464"></a>00464 
<a name="l00471"></a>00471         void  (*<a class="code" href="structdt__object__operations.html#ad5346269fb80455252849f4fd7403720" title="Release write lock.">do_write_unlock</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00472"></a>00472                                  <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt);
<a name="l00473"></a>00473 
<a name="l00485"></a>00485         int  (*<a class="code" href="structdt__object__operations.html#a9072566fd18a198a7323439603b6fbdf" title="Check whether write lock is held.">do_write_locked</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00486"></a>00486                                 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt);
<a name="l00487"></a>00487 
<a name="l00504"></a>00504         int   (*<a class="code" href="structdt__object__operations.html#adc1fb34feaf57d9448beaab7f04302bd" title="Declare intention to request reqular attributes.">do_declare_attr_get</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00505"></a>00505                                      <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt);
<a name="l00506"></a>00506 
<a name="l00523"></a>00523         int   (*<a class="code" href="structdt__object__operations.html#a1d2ff17287fa229d0325cccf0aac5beb" title="Return regular attributes.">do_attr_get</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00524"></a>00524                              <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00525"></a>00525                              <span class="keyword">struct </span><a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *attr);
<a name="l00526"></a>00526 
<a name="l00545"></a>00545         int   (*<a class="code" href="structdt__object__operations.html#a44eb5df458974e0568eba9863c439362" title="Declare intention to change regular object&amp;#39;s attributes.">do_declare_attr_set</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00546"></a>00546                                      <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00547"></a>00547                                      <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *attr,
<a name="l00548"></a>00548                                      <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00549"></a>00549 
<a name="l00567"></a>00567         int   (*<a class="code" href="structdt__object__operations.html#aa9a55847088d77aa8bbc16c693344ddb" title="Change regular attributes.">do_attr_set</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00568"></a>00568                              <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00569"></a>00569                              <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *attr,
<a name="l00570"></a>00570                              <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00571"></a>00571 
<a name="l00590"></a>00590         int   (*<a class="code" href="structdt__object__operations.html#a2032c927c95147729dd7a7247c5c12aa" title="Declare intention to request extented attribute.">do_declare_xattr_get</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00591"></a>00591                                       <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00592"></a>00592                                       <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l00593"></a>00593                                       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00594"></a>00594 
<a name="l00611"></a>00611         int   (*<a class="code" href="structdt__object__operations.html#af4c8c504e52a5571dbd0557980c3818a" title="Return a value of an extended attribute.">do_xattr_get</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00612"></a>00612                               <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00613"></a>00613                               <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l00614"></a>00614                               <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00615"></a>00615 
<a name="l00636"></a>00636         int   (*<a class="code" href="structdt__object__operations.html#ad5d602fce101080720544cbdb0de96e8" title="Declare intention to change an extended attribute.">do_declare_xattr_set</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00637"></a>00637                                       <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00638"></a>00638                                       <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l00639"></a>00639                                       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,
<a name="l00640"></a>00640                                       <span class="keywordtype">int</span> fl,
<a name="l00641"></a>00641                                       <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00642"></a>00642 
<a name="l00663"></a>00663         int   (*<a class="code" href="structdt__object__operations.html#a231db7d512a5786b8ad887e9fc47190b" title="Set an extended attribute.">do_xattr_set</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00664"></a>00664                               <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00665"></a>00665                               <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l00666"></a>00666                               <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,
<a name="l00667"></a>00667                               <span class="keywordtype">int</span> fl,
<a name="l00668"></a>00668                               <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00669"></a>00669 
<a name="l00687"></a>00687         int   (*<a class="code" href="structdt__object__operations.html#a7b2e57f4c0bdb5108e9d1920242e813e" title="Declare intention to delete an extended attribute.">do_declare_xattr_del</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00688"></a>00688                                       <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00689"></a>00689                                       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,
<a name="l00690"></a>00690                                       <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00691"></a>00691 
<a name="l00706"></a>00706         int   (*<a class="code" href="structdt__object__operations.html#a19762fb1d9e75136521019d51759b6ec" title="Delete an extended attribute.">do_xattr_del</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00707"></a>00707                               <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00708"></a>00708                               <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,
<a name="l00709"></a>00709                               <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00710"></a>00710 
<a name="l00725"></a>00725         int   (*<a class="code" href="structdt__object__operations.html#a0ace7a9f2e3ae94bb5d5b7434917f0f1" title="Return a list of the extended attributes.">do_xattr_list</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00726"></a>00726                                <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00727"></a>00727                                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>);
<a name="l00728"></a>00728 
<a name="l00743"></a>00743         void  (*<a class="code" href="structdt__object__operations.html#a00fed99bee94890d3e36719af00d5595" title="Prepare allocation hint for a new object.">do_ah_init</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00744"></a>00744                             <span class="keyword">struct </span><a class="code" href="structdt__allocation__hint.html" title="This is a general purpose dt allocation hint.">dt_allocation_hint</a> *ah,
<a name="l00745"></a>00745                             <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *parent,
<a name="l00746"></a>00746                             <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *child,
<a name="l00747"></a>00747                             umode_t <a class="code" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>);
<a name="l00748"></a>00748 
<a name="l00773"></a>00773         int   (*<a class="code" href="structdt__object__operations.html#ab16b75516dfd3d619fbffbc96f2b9d24" title="Declare intention to create a new object.">do_declare_create</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00774"></a>00774                                    <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00775"></a>00775                                    <span class="keyword">struct </span><a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *attr,
<a name="l00776"></a>00776                                    <span class="keyword">struct </span><a class="code" href="structdt__allocation__hint.html" title="This is a general purpose dt allocation hint.">dt_allocation_hint</a> *hint,
<a name="l00777"></a>00777                                    <span class="keyword">struct </span><a class="code" href="structdt__object__format.html" title="object format specifier.">dt_object_format</a> *dof,
<a name="l00778"></a>00778                                    <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00779"></a>00779 
<a name="l00804"></a>00804         int   (*<a class="code" href="structdt__object__operations.html#ac1ca5a81cd3d00bd821fbfead64022c3" title="Create new object.">do_create</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00805"></a>00805                            <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00806"></a>00806                            <span class="keyword">struct </span><a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *attr,
<a name="l00807"></a>00807                            <span class="keyword">struct </span><a class="code" href="structdt__allocation__hint.html" title="This is a general purpose dt allocation hint.">dt_allocation_hint</a> *hint,
<a name="l00808"></a>00808                            <span class="keyword">struct </span><a class="code" href="structdt__object__format.html" title="object format specifier.">dt_object_format</a> *dof,
<a name="l00809"></a>00809                            <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00810"></a>00810 
<a name="l00827"></a>00827         int   (*<a class="code" href="structdt__object__operations.html#af211c9cc7a0203979cd8cf0f0b81b293" title="Declare intention to destroy an object.">do_declare_destroy</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00828"></a>00828                                     <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00829"></a>00829                                     <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00830"></a>00830 
<a name="l00852"></a>00852         int   (*<a class="code" href="structdt__object__operations.html#a19ddd277003c24371f8c5771a2ba77bb" title="Destroy an object.">do_destroy</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00853"></a>00853                             <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00854"></a>00854                             <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00855"></a>00855 
<a name="l00873"></a>00873         int   (*<a class="code" href="structdt__object__operations.html#ac317771bd9f0827b4d8fcec4d51a63c2" title="Try object as an index.">do_index_try</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00874"></a>00874                               <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00875"></a>00875                               <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__index__features.html">dt_index_features</a> *feat);
<a name="l00876"></a>00876 
<a name="l00893"></a>00893         int   (*<a class="code" href="structdt__object__operations.html#a53431a1038b787ca15950b5a0495408b" title="Declare intention to increment nlink count.">do_declare_ref_add</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00894"></a>00894                                     <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00895"></a>00895                                     <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00896"></a>00896 
<a name="l00911"></a>00911         int   (*<a class="code" href="structdt__object__operations.html#a3ea43d6a7abb742fb238acc711b3bd2b" title="Increment nlink.">do_ref_add</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00912"></a>00912                             <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt, <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00913"></a>00913 
<a name="l00930"></a>00930         int   (*<a class="code" href="structdt__object__operations.html#ae33177c8da269d507a9b22b8066ae5f4" title="Declare intention to decrement nlink count.">do_declare_ref_del</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00931"></a>00931                                     <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00932"></a>00932                                     <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00933"></a>00933 
<a name="l00947"></a>00947         int   (*<a class="code" href="structdt__object__operations.html#a8d0abf79c5dace1f0839aefe251bfc1f" title="Decrement nlink.">do_ref_del</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00948"></a>00948                             <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00949"></a>00949                             <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00950"></a>00950 
<a name="l00972"></a>00972         int (*<a class="code" href="structdt__object__operations.html#a2e3f3539d6ce344b27712d4b2f39d7b2" title="Sync obect.">do_object_sync</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00973"></a>00973                               <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *obj,
<a name="l00974"></a>00974                               <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>,
<a name="l00975"></a>00975                               <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="mdsrate_8c.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>);
<a name="l00976"></a>00976 
<a name="l00996"></a>00996         int (*<a class="code" href="structdt__object__operations.html#a1f63b46e6b64b5c8ba9e81492e0c2f19" title="Lock object.">do_object_lock</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l00997"></a>00997                               <span class="keyword">struct </span><a class="code" href="structlustre__handle.html">lustre_handle</a> *lh,
<a name="l00998"></a>00998                               <span class="keyword">struct </span><a class="code" href="structldlm__enqueue__info.html" title="Common ldlm_enqueue parameters.">ldlm_enqueue_info</a> *einfo,
<a name="l00999"></a>00999                               <span class="keyword">union </span><a class="code" href="unionldlm__policy__data.html">ldlm_policy_data</a> *policy);
<a name="l01000"></a>01000 
<a name="l01014"></a>01014         int (*<a class="code" href="structdt__object__operations.html#a0cc597f75bd319af28376e8a280a6ae3" title="Unlock object.">do_object_unlock</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01015"></a>01015                                 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01016"></a>01016                                 <span class="keyword">struct </span><a class="code" href="structldlm__enqueue__info.html" title="Common ldlm_enqueue parameters.">ldlm_enqueue_info</a> *einfo,
<a name="l01017"></a>01017                                 <span class="keyword">union </span><a class="code" href="unionldlm__policy__data.html">ldlm_policy_data</a> *policy);
<a name="l01018"></a>01018 };
<a name="l01019"></a>01019 
<a name="l01023"></a><a class="code" href="structdt__body__operations.html">01023</a> <span class="keyword">struct </span><a class="code" href="structdt__body__operations.html" title="Per-dt-object operations on &amp;quot;file body&amp;quot; - unstructure raw data.">dt_body_operations</a> {
<a name="l01039"></a>01039         ssize_t (*<a class="code" href="structdt__body__operations.html#a6d7a363128fd4899b709b2ff18afd54c" title="Read data.">dbo_read</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01040"></a>01040                             <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01041"></a>01041                             <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l01042"></a>01042                             loff_t *pos);
<a name="l01043"></a>01043 
<a name="l01066"></a>01066         ssize_t (*<a class="code" href="structdt__body__operations.html#aa4d64d407e2b442c1e418fa9ca46ab44" title="Declare intention to write data to object.">dbo_declare_write</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01067"></a>01067                                      <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01068"></a>01068                                      <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l01069"></a>01069                                      loff_t pos,
<a name="l01070"></a>01070                                      <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l01071"></a>01071 
<a name="l01093"></a>01093         ssize_t (*<a class="code" href="structdt__body__operations.html#a1d14bb3445892ab680cd8885645334bb" title="Write unstructured data to regular existing object.">dbo_write</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01094"></a>01094                              <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01095"></a>01095                              <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l01096"></a>01096                              loff_t *pos,
<a name="l01097"></a>01097                              <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th,
<a name="l01098"></a>01098                              <span class="keywordtype">int</span> <a class="code" href="mdsrate_8c.html#a28a2a20ee60bdfbd168e4f4bf20d8c82">ignore</a>);
<a name="l01099"></a>01099 
<a name="l01132"></a>01132         int (*<a class="code" href="structdt__body__operations.html#afe9f070ccbf102ca7d366a0d902216a7" title="Return buffers for data.">dbo_bufs_get</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01133"></a>01133                             <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01134"></a>01134                             loff_t pos,
<a name="l01135"></a>01135                             ssize_t len,
<a name="l01136"></a>01136                             <span class="keyword">struct </span><a class="code" href="structniobuf__local.html">niobuf_local</a> *lb,
<a name="l01137"></a>01137                             <span class="keywordtype">int</span> rw);
<a name="l01138"></a>01138 
<a name="l01153"></a>01153         int (*<a class="code" href="structdt__body__operations.html#aaa0f2da7b7271a358b9c1e3bfa4326e3" title="Release reference granted by -&amp;gt;dbo_bufs_get().">dbo_bufs_put</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01154"></a>01154                             <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01155"></a>01155                             <span class="keyword">struct </span><a class="code" href="structniobuf__local.html">niobuf_local</a> *lb,
<a name="l01156"></a>01156                             <span class="keywordtype">int</span> nr);
<a name="l01157"></a>01157 
<a name="l01178"></a>01178         int (*<a class="code" href="structdt__body__operations.html#a064a13169a793907c32faa01a657810a" title="Prepare buffers for reading.">dbo_read_prep</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01179"></a>01179                              <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01180"></a>01180                              <span class="keyword">struct </span><a class="code" href="structniobuf__local.html">niobuf_local</a> *lnb,
<a name="l01181"></a>01181                              <span class="keywordtype">int</span> nr);
<a name="l01182"></a>01182 
<a name="l01198"></a>01198         int (*<a class="code" href="structdt__body__operations.html#ab941af8487086f964f8721de634b86b8" title="Prepare buffers for write.">dbo_write_prep</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01199"></a>01199                               <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01200"></a>01200                               <span class="keyword">struct </span><a class="code" href="structniobuf__local.html">niobuf_local</a> *lb,
<a name="l01201"></a>01201                               <span class="keywordtype">int</span> nr);
<a name="l01202"></a>01202 
<a name="l01226"></a>01226         int (*<a class="code" href="structdt__body__operations.html#aaa2ba33b84fa7bdb6413e6f8347a1482" title="Declare intention to write data stored in the buffers.">dbo_declare_write_commit</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01227"></a>01227                                         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01228"></a>01228                                         <span class="keyword">struct </span><a class="code" href="structniobuf__local.html">niobuf_local</a> *lb,
<a name="l01229"></a>01229                                         <span class="keywordtype">int</span> nr,
<a name="l01230"></a>01230                                         <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l01231"></a>01231 
<a name="l01255"></a>01255         int (*<a class="code" href="structdt__body__operations.html#ac44e84fe7124d965c379a6817e4dc8bc" title="Write to existing object.">dbo_write_commit</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01256"></a>01256                                 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01257"></a>01257                                 <span class="keyword">struct </span><a class="code" href="structniobuf__local.html">niobuf_local</a> *lb,
<a name="l01258"></a>01258                                 <span class="keywordtype">int</span> nr,
<a name="l01259"></a>01259                                 <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l01260"></a>01260 
<a name="l01272"></a>01272         int (*<a class="code" href="structdt__body__operations.html#afde6790a70f30800664044f1c627cb63" title="Return logical to physical block mapping for a given extent.">dbo_fiemap_get</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01273"></a>01273                               <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01274"></a>01274                               <span class="keyword">struct </span>fiemap *fm);
<a name="l01275"></a>01275 
<a name="l01293"></a>01293         int   (*<a class="code" href="structdt__body__operations.html#a814e0570b29ea97a47f9851e0f6bfc0c" title="Declare intention to deallocate space from an object.">dbo_declare_punch</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01294"></a>01294                                    <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01295"></a>01295                                    <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>,
<a name="l01296"></a>01296                                    <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="mdsrate_8c.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>,
<a name="l01297"></a>01297                                    <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l01298"></a>01298 
<a name="l01316"></a>01316         int   (*<a class="code" href="structdt__body__operations.html#a3ee6232f042892134c6f2fead05ed2c4" title="Deallocate specified region in an object.">dbo_punch</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01317"></a>01317                            <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01318"></a>01318                            <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>,
<a name="l01319"></a>01319                            <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="mdsrate_8c.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>,
<a name="l01320"></a>01320                            <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l01337"></a>01337         int   (*<a class="code" href="structdt__body__operations.html#a5b1cd9fc446d73843de8c4e57475765e" title="Give advices on specified region in an object.">dbo_ladvise</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01338"></a>01338                              <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01339"></a>01339                              <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>,
<a name="l01340"></a>01340                              <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="mdsrate_8c.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>,
<a name="l01341"></a>01341                              <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga6800d248c7e9177fa2705d90cb97c86f">lu_ladvise_type</a> advice);
<a name="l01342"></a>01342 };
<a name="l01343"></a>01343 
<a name="l01347"></a>01347 <span class="keyword">struct </span>dt_rec;
<a name="l01348"></a>01348 
<a name="l01352"></a>01352 <span class="keyword">struct </span><a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a>;
<a name="l01353"></a>01353 
<a name="l01357"></a>01357 <span class="keyword">struct </span>dt_it;
<a name="l01358"></a>01358 
<a name="l01366"></a><a class="code" href="structdt__index__operations.html">01366</a> <span class="keyword">struct </span><a class="code" href="structdt__index__operations.html" title="Per-dt-object operations on object as index.">dt_index_operations</a> {
<a name="l01387"></a>01387         int (*<a class="code" href="structdt__index__operations.html#aab6a7632adfce2297c022b12f0d61791" title="Lookup in an index by key.">dio_lookup</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01388"></a>01388                           <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01389"></a>01389                           <span class="keyword">struct </span>dt_rec *rec,
<a name="l01390"></a>01390                           <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key);
<a name="l01391"></a>01391 
<a name="l01410"></a>01410         int (*<a class="code" href="structdt__index__operations.html#af077ea7c9f156cb161f9c361109e1f68" title="Declare intention to insert a key/value into an index.">dio_declare_insert</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01411"></a>01411                                   <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01412"></a>01412                                   <span class="keyword">const</span> <span class="keyword">struct </span>dt_rec *rec,
<a name="l01413"></a>01413                                   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key,
<a name="l01414"></a>01414                                   <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l01415"></a>01415 
<a name="l01436"></a>01436         int (*<a class="code" href="structdt__index__operations.html#af1e0507f0ca4df0ed3f486bab027dbda" title="Insert a new key/value pair into an index.">dio_insert</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01437"></a>01437                           <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01438"></a>01438                           <span class="keyword">const</span> <span class="keyword">struct </span>dt_rec *rec,
<a name="l01439"></a>01439                           <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key,
<a name="l01440"></a>01440                           <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th,
<a name="l01441"></a>01441                           <span class="keywordtype">int</span> <a class="code" href="mdsrate_8c.html#a28a2a20ee60bdfbd168e4f4bf20d8c82">ignore</a>);
<a name="l01442"></a>01442 
<a name="l01460"></a>01460         int (*<a class="code" href="structdt__index__operations.html#aa25f7e5f60a5b9055e3f9b0898b2888b" title="Declare intention to delete a key/value from an index.">dio_declare_delete</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01461"></a>01461                                   <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01462"></a>01462                                   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key,
<a name="l01463"></a>01463                                   <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l01464"></a>01464 
<a name="l01482"></a>01482         int (*<a class="code" href="structdt__index__operations.html#abe3c3c85ed6a910700306482ba8fcd0d" title="Delete key/value pair from an index.">dio_delete</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01483"></a>01483                           <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01484"></a>01484                           <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key,
<a name="l01485"></a>01485                           <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l01486"></a>01486 
<a name="l01493"></a><a class="code" href="structdt__index__operations_1_1dt__it__ops.html">01493</a>         <span class="keyword">struct </span><a class="code" href="structdt__index__operations_1_1dt__it__ops.html" title="Iterator interface.">dt_it_ops</a> {
<a name="l01510"></a>01510                 <span class="keyword">struct </span>dt_it *(*init)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01511"></a>01511                                       <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l01512"></a>01512                                       __u32 attr);
<a name="l01513"></a>01513 
<a name="l01523"></a>01523                 void          (*<a class="code" href="structdt__index__operations_1_1dt__it__ops.html#a9bde98040f4ba4fd69f69aa73c606cdd" title="Release iterator.">fini</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01524"></a>01524                                       <span class="keyword">struct </span>dt_it *di);
<a name="l01525"></a>01525 
<a name="l01541"></a>01541                 int            (*<span class="keyword">get</span>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01542"></a>01542                                       <span class="keyword">struct </span>dt_it *di,
<a name="l01543"></a>01543                                       <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *<a class="code" href="structdt__index__operations_1_1dt__it__ops.html#a426dff3fc53f2cfed2fe22713d990ddc" title="Return key.">key</a>);
<a name="l01544"></a>01544 
<a name="l01556"></a>01556                 void           (*<a class="code" href="structdt__index__operations_1_1dt__it__ops.html#a0a49bc42af0733f3a82dd0e8c6cbe1e5" title="Release position.">put</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01557"></a>01557                                       <span class="keyword">struct </span>dt_it *di);
<a name="l01558"></a>01558 
<a name="l01571"></a>01571                 int           (*<a class="code" href="structdt__index__operations_1_1dt__it__ops.html#aa41e28336a93af94d1c5e629d9394631" title="Move to next record.">next</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01572"></a>01572                                       <span class="keyword">struct </span>dt_it *di);
<a name="l01573"></a>01573 
<a name="l01588"></a>01588                 <span class="keyword">struct </span><a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *(*key)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01589"></a>01589                                       <span class="keyword">const</span> <span class="keyword">struct </span>dt_it *di);
<a name="l01590"></a>01590 
<a name="l01602"></a>01602                 int       (*<a class="code" href="structdt__index__operations_1_1dt__it__ops.html#a0e2180d888668bf163ebf81fd27dc857" title="Return key size.">key_size</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01603"></a>01603                                       <span class="keyword">const</span> <span class="keyword">struct </span>dt_it *di);
<a name="l01604"></a>01604 
<a name="l01622"></a>01622                 int            (*<a class="code" href="structdt__index__operations_1_1dt__it__ops.html#a1b24018fcd837461771bb59a4d0c0d05" title="Return record.">rec</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01623"></a>01623                                       <span class="keyword">const</span> <span class="keyword">struct </span>dt_it *di,
<a name="l01624"></a>01624                                       <span class="keyword">struct </span>dt_rec *<a class="code" href="structdt__index__operations_1_1dt__it__ops.html#a1b24018fcd837461771bb59a4d0c0d05" title="Return record.">rec</a>,
<a name="l01625"></a>01625                                       __u32 attr);
<a name="l01626"></a>01626 
<a name="l01642"></a>01642                 int        (*<a class="code" href="structdt__index__operations_1_1dt__it__ops.html#a5a85dfb5e79d606a1abba1c1fd9986cc" title="Return record size.">rec_size</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01643"></a>01643                                        <span class="keyword">const</span> <span class="keyword">struct </span>dt_it *di,
<a name="l01644"></a>01644                                       __u32 attr);
<a name="l01645"></a>01645 
<a name="l01659"></a>01659                 <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>        (*<a class="code" href="structdt__index__operations_1_1dt__it__ops.html#a2966e2ef5ccc21df92b6a31b7c4a56f5" title="Return a cookie (hash).">store</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01660"></a>01660                                       <span class="keyword">const</span> <span class="keyword">struct </span>dt_it *di);
<a name="l01661"></a>01661 
<a name="l01679"></a>01679                 int           (*<a class="code" href="structdt__index__operations_1_1dt__it__ops.html#a3ca6f6284e09ac4853574a011d4bd649" title="Initialize position using cookie/hash.">load</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01680"></a>01680                                       <span class="keyword">const</span> <span class="keyword">struct </span>dt_it *di,
<a name="l01681"></a>01681                                       <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> hash);
<a name="l01682"></a>01682 
<a name="l01686"></a>01686                 int        (*<a class="code" href="structdt__index__operations_1_1dt__it__ops.html#a26fde1d3c4f5e818827e667418f6f4ba" title="Not used.">key_rec</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01687"></a>01687                                       <span class="keyword">const</span> <span class="keyword">struct </span>dt_it *di,
<a name="l01688"></a>01688                                       <span class="keywordtype">void</span> *<a class="code" href="structdt__index__operations_1_1dt__it__ops.html#a26fde1d3c4f5e818827e667418f6f4ba" title="Not used.">key_rec</a>);
<a name="l01689"></a>01689         } <a class="code" href="structdt__index__operations.html#a16b19879e71b5cb1aaa459d731d580cb" title="Iterator interface.">dio_it</a>;
<a name="l01690"></a>01690 };
<a name="l01691"></a>01691 
<a name="l01692"></a><a class="code" href="group__dt.html#ga88a4360057738212ff1ae0888a47696d">01692</a> <span class="keyword">enum</span> <a class="code" href="group__dt.html#ga88a4360057738212ff1ae0888a47696d">dt_otable_it_valid</a> {
<a name="l01693"></a><a class="code" href="group__dt.html#gga88a4360057738212ff1ae0888a47696da7d30661134cc2fc530320daf04b8fab2">01693</a>         <a class="code" href="group__dt.html#gga88a4360057738212ff1ae0888a47696da7d30661134cc2fc530320daf04b8fab2">DOIV_ERROR_HANDLE</a>       = 0x0001,
<a name="l01694"></a><a class="code" href="group__dt.html#gga88a4360057738212ff1ae0888a47696dabf5d8d6142a9eb84de4da29d70475ea0">01694</a>         <a class="code" href="group__dt.html#gga88a4360057738212ff1ae0888a47696dabf5d8d6142a9eb84de4da29d70475ea0">DOIV_DRYRUN</a>             = 0x0002,
<a name="l01695"></a>01695 };
<a name="l01696"></a>01696 
<a name="l01697"></a><a class="code" href="group__dt.html#gafc11e1b049a7ef807061f3dbdf28af74">01697</a> <span class="keyword">enum</span> <a class="code" href="group__dt.html#gafc11e1b049a7ef807061f3dbdf28af74">dt_otable_it_flags</a> {
<a name="l01698"></a>01698         <span class="comment">/* Exit when fail. */</span>
<a name="l01699"></a><a class="code" href="group__dt.html#ggafc11e1b049a7ef807061f3dbdf28af74ac6788efcf76a34bcab321dc7a7500f87">01699</a>         <a class="code" href="group__dt.html#ggafc11e1b049a7ef807061f3dbdf28af74ac6788efcf76a34bcab321dc7a7500f87">DOIF_FAILOUT</a>    = 0x0001,
<a name="l01700"></a>01700 
<a name="l01701"></a>01701         <span class="comment">/* Reset iteration position to the device beginning. */</span>
<a name="l01702"></a><a class="code" href="group__dt.html#ggafc11e1b049a7ef807061f3dbdf28af74aa8d88b0fffbe8dc1a716b52eb774278d">01702</a>         <a class="code" href="group__dt.html#ggafc11e1b049a7ef807061f3dbdf28af74aa8d88b0fffbe8dc1a716b52eb774278d">DOIF_RESET</a>      = 0x0002,
<a name="l01703"></a>01703 
<a name="l01704"></a>01704         <span class="comment">/* There is up layer component uses the iteration. */</span>
<a name="l01705"></a><a class="code" href="group__dt.html#ggafc11e1b049a7ef807061f3dbdf28af74a8219b53993ccf500a5f787c189bbc683">01705</a>         <a class="code" href="group__dt.html#ggafc11e1b049a7ef807061f3dbdf28af74a8219b53993ccf500a5f787c189bbc683">DOIF_OUTUSED</a>    = 0x0004,
<a name="l01706"></a>01706 
<a name="l01707"></a>01707         <span class="comment">/* Check only without repairing. */</span>
<a name="l01708"></a><a class="code" href="group__dt.html#ggafc11e1b049a7ef807061f3dbdf28af74a62eacc794a7841a30321e741f3681183">01708</a>         <a class="code" href="group__dt.html#ggafc11e1b049a7ef807061f3dbdf28af74a62eacc794a7841a30321e741f3681183">DOIF_DRYRUN</a>     = 0x0008,
<a name="l01709"></a>01709 };
<a name="l01710"></a>01710 
<a name="l01711"></a>01711 <span class="comment">/* otable based iteration needs to use the common DT iteration APIs.</span>
<a name="l01712"></a>01712 <span class="comment"> * To initialize the iteration, it needs call dio_it::init() firstly.</span>
<a name="l01713"></a>01713 <span class="comment"> * Here is how the otable based iteration should prepare arguments to</span>
<a name="l01714"></a>01714 <span class="comment"> * call dt_it_ops::init().</span>
<a name="l01715"></a>01715 <span class="comment"> *</span>
<a name="l01716"></a>01716 <span class="comment"> * For otable based iteration, the 32-bits &apos;attr&apos; for dt_it_ops::init()</span>
<a name="l01717"></a>01717 <span class="comment"> * is composed of two parts:</span>
<a name="l01718"></a>01718 <span class="comment"> * low 16-bits is for valid bits, high 16-bits is for flags bits. */</span>
<a name="l01719"></a><a class="code" href="group__dt.html#gaec8ff01f4e420e9382c70c26413fc647">01719</a> <span class="preprocessor">#define DT_OTABLE_IT_FLAGS_SHIFT        16</span>
<a name="l01720"></a><a class="code" href="group__dt.html#ga6cc78eed330fdd86906b6469acc4342e">01720</a> <span class="preprocessor"></span><span class="preprocessor">#define DT_OTABLE_IT_FLAGS_MASK         0xffff0000</span>
<a name="l01721"></a>01721 <span class="preprocessor"></span>
<a name="l01722"></a><a class="code" href="structdt__device.html">01722</a> <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> {
<a name="l01723"></a><a class="code" href="structdt__device.html#a54e8912d9668696ec00395a14ca44fd3">01723</a>         <span class="keyword">struct </span><a class="code" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a>                   <a class="code" href="structdt__device.html#a54e8912d9668696ec00395a14ca44fd3">dd_lu_dev</a>;
<a name="l01724"></a><a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">01724</a>         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__device__operations.html" title="Operations on dt device.">dt_device_operations</a> *<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>;
<a name="l01725"></a>01725 
<a name="l01731"></a><a class="code" href="structdt__device.html#a9a61196891613c643168283b37371893">01731</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                   <a class="code" href="structdt__device.html#a9a61196891613c643168283b37371893" title="List of dt_txn_callback (see below).">dd_txn_callbacks</a>;
<a name="l01732"></a><a class="code" href="structdt__device.html#a460506d1b1246271b91e219d4d800ede">01732</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                       <a class="code" href="structdt__device.html#a460506d1b1246271b91e219d4d800ede">dd_record_fid_accessed</a>:1;
<a name="l01733"></a>01733 };
<a name="l01734"></a>01734 
<a name="l01735"></a>01735 <span class="keywordtype">int</span>  <a class="code" href="group__dt.html#gad1d2b630b21a38187b5eecb9b4d29b89">dt_device_init</a>(<span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev, <span class="keyword">struct</span> <a class="code" href="structlu__device__type.html" title="Type of device.">lu_device_type</a> *t);
<a name="l01736"></a>01736 <span class="keywordtype">void</span> <a class="code" href="group__dt.html#gaf9f67f064e70f68da4ec7f5cec036e3d">dt_device_fini</a>(<span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev);
<a name="l01737"></a>01737 
<a name="l01738"></a><a class="code" href="group__dt.html#ga979a199f590c77d14dd74ac93a1534f8">01738</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga979a199f590c77d14dd74ac93a1534f8">lu_device_is_dt</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a> *d)
<a name="l01739"></a>01739 {
<a name="l01740"></a>01740         <span class="keywordflow">return</span> <a class="code" href="osd__iam_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a>(d != NULL, d-&gt;<a class="code" href="structlu__device.html#ad5886c6b5e9a91f07f22d33bbcdb5718" title="Pointer to device type.">ld_type</a>-&gt;<a class="code" href="structlu__device__type.html#a80155fcf424540e70733a04e2a099c0c" title="Tag bits.">ldt_tags</a> &amp; <a class="code" href="group__lu.html#ggaa318f5b20c40de1d564f59dd72726345a5b8da75da353b465f5ddc30d87c931d9" title="this is data device">LU_DEVICE_DT</a>);
<a name="l01741"></a>01741 }
<a name="l01742"></a>01742 
<a name="l01743"></a><a class="code" href="group__dt.html#ga194153652787b274d44d8e2ed6ad8a23">01743</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> * <a class="code" href="group__dt.html#ga194153652787b274d44d8e2ed6ad8a23">lu2dt_dev</a>(<span class="keyword">struct</span> <a class="code" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a> *l)
<a name="l01744"></a>01744 {
<a name="l01745"></a>01745         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(<a class="code" href="group__dt.html#ga979a199f590c77d14dd74ac93a1534f8">lu_device_is_dt</a>(l));
<a name="l01746"></a>01746         <span class="keywordflow">return</span> container_of0(l, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a>, <a class="code" href="structdt__device.html#a54e8912d9668696ec00395a14ca44fd3">dd_lu_dev</a>);
<a name="l01747"></a>01747 }
<a name="l01748"></a>01748 
<a name="l01749"></a><a class="code" href="structdt__object.html">01749</a> <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> {
<a name="l01750"></a><a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">01750</a>         <span class="keyword">struct </span><a class="code" href="structlu__object.html" title="Layer in the layered object.">lu_object</a>                   <a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>;
<a name="l01751"></a><a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">01751</a>         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__object__operations.html" title="A dt_object provides common operations to create and destroy objects and to manage...">dt_object_operations</a> *<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>;
<a name="l01752"></a><a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">01752</a>         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__body__operations.html" title="Per-dt-object operations on &amp;quot;file body&amp;quot; - unstructure raw data.">dt_body_operations</a>   *<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>;
<a name="l01753"></a><a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">01753</a>         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdt__index__operations.html" title="Per-dt-object operations on object as index.">dt_index_operations</a>  *<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>;
<a name="l01754"></a>01754 };
<a name="l01755"></a>01755 
<a name="l01756"></a>01756 <span class="comment">/*</span>
<a name="l01757"></a>01757 <span class="comment"> * In-core representation of per-device local object OID storage</span>
<a name="l01758"></a>01758 <span class="comment"> */</span>
<a name="l01759"></a><a class="code" href="structlocal__oid__storage.html">01759</a> <span class="keyword">struct </span><a class="code" href="structlocal__oid__storage.html">local_oid_storage</a> {
<a name="l01760"></a>01760         <span class="comment">/* all initialized llog systems on this node linked by this */</span>
<a name="l01761"></a><a class="code" href="structlocal__oid__storage.html#ac6218057fd763024397edd27bc2ac87c">01761</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>  <a class="code" href="structlocal__oid__storage.html#ac6218057fd763024397edd27bc2ac87c">los_list</a>;
<a name="l01762"></a>01762 
<a name="l01763"></a>01763         <span class="comment">/* how many handle&apos;s reference this los has */</span>
<a name="l01764"></a><a class="code" href="structlocal__oid__storage.html#aa3e686a2361663f35a762d5efac10db5">01764</a>         atomic_t          <a class="code" href="structlocal__oid__storage.html#aa3e686a2361663f35a762d5efac10db5">los_refcount</a>;
<a name="l01765"></a><a class="code" href="structlocal__oid__storage.html#a17568367a6bdbd04dae22ff1f83fea82">01765</a>         <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *<a class="code" href="structlocal__oid__storage.html#a17568367a6bdbd04dae22ff1f83fea82">los_dev</a>;
<a name="l01766"></a><a class="code" href="structlocal__oid__storage.html#a1026f73e11fcb898e3234e43ee75ac60">01766</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="structlocal__oid__storage.html#a1026f73e11fcb898e3234e43ee75ac60">los_obj</a>;
<a name="l01767"></a>01767 
<a name="l01768"></a>01768         <span class="comment">/* data used to generate new fids */</span>
<a name="l01769"></a><a class="code" href="structlocal__oid__storage.html#a5b52082c2d9183942db252c84d2bb604">01769</a>         <span class="keyword">struct </span>mutex      <a class="code" href="structlocal__oid__storage.html#a5b52082c2d9183942db252c84d2bb604">los_id_lock</a>;
<a name="l01770"></a><a class="code" href="structlocal__oid__storage.html#a241085834fae4bafbe821f58ece5250a">01770</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>             <a class="code" href="structlocal__oid__storage.html#a241085834fae4bafbe821f58ece5250a">los_seq</a>;
<a name="l01771"></a><a class="code" href="structlocal__oid__storage.html#af790fb9c37d9858fe6a64d624e84071d">01771</a>         __u32             <a class="code" href="structlocal__oid__storage.html#af790fb9c37d9858fe6a64d624e84071d">los_last_oid</a>;
<a name="l01772"></a>01772 };
<a name="l01773"></a>01773 
<a name="l01774"></a><a class="code" href="group__dt.html#gae6d1816825dca57aa1f86374bbc8b637">01774</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a> *<a class="code" href="group__dt.html#gae6d1816825dca57aa1f86374bbc8b637">dt2lu_dev</a>(<span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *d)
<a name="l01775"></a>01775 {
<a name="l01776"></a>01776         <span class="keywordflow">return</span> &amp;d-&gt;<a class="code" href="structdt__device.html#a54e8912d9668696ec00395a14ca44fd3">dd_lu_dev</a>;
<a name="l01777"></a>01777 }
<a name="l01778"></a>01778 
<a name="l01779"></a><a class="code" href="group__dt.html#gaadfb7a922df20e32acb36ba8c2686905">01779</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="group__dt.html#gaadfb7a922df20e32acb36ba8c2686905">lu2dt</a>(<span class="keyword">struct</span> <a class="code" href="structlu__object.html" title="Layer in the layered object.">lu_object</a> *l)
<a name="l01780"></a>01780 {
<a name="l01781"></a>01781         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(l == NULL || IS_ERR(l) || <a class="code" href="group__dt.html#ga979a199f590c77d14dd74ac93a1534f8">lu_device_is_dt</a>(l-&gt;<a class="code" href="structlu__object.html#a5b9108a283d9901c95bdf32833f70601" title="Device for this layer.">lo_dev</a>));
<a name="l01782"></a>01782         <span class="keywordflow">return</span> container_of0(l, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a>, <a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>);
<a name="l01783"></a>01783 }
<a name="l01784"></a>01784 
<a name="l01785"></a>01785 <span class="keywordtype">int</span>  <a class="code" href="group__dt.html#gab437254471f6d77be12dae01799211b5">dt_object_init</a>(<span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj,
<a name="l01786"></a>01786                     <span class="keyword">struct</span> <a class="code" href="structlu__object__header.html" title="&amp;quot;Compound&amp;quot; object, consisting of multiple layers.">lu_object_header</a> *h, <span class="keyword">struct</span> <a class="code" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a> *d);
<a name="l01787"></a>01787 
<a name="l01788"></a>01788 <span class="keywordtype">void</span> <a class="code" href="group__dt.html#gac04cc2235f432634df8442ad735aece3">dt_object_fini</a>(<span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj);
<a name="l01789"></a>01789 
<a name="l01790"></a><a class="code" href="group__dt.html#ga5e0e64b326cce8eea978a82514f06799">01790</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga5e0e64b326cce8eea978a82514f06799">dt_object_exists</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt)
<a name="l01791"></a>01791 {
<a name="l01792"></a>01792         <span class="keywordflow">return</span> <a class="code" href="group__lu.html#gacef4aec6c28892e386a8d3cca26aeb28" title="Check whether object exists, no matter on local or remote storage.">lu_object_exists</a>(&amp;dt-&gt;<a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>);
<a name="l01793"></a>01793 }
<a name="l01794"></a>01794 
<a name="l01795"></a><a class="code" href="group__dt.html#ga05bf8b28c64f19745cc7c892f1783b8c">01795</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga05bf8b28c64f19745cc7c892f1783b8c">dt_object_remote</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt)
<a name="l01796"></a>01796 {
<a name="l01797"></a>01797         <span class="keywordflow">return</span> <a class="code" href="group__lu.html#ga3f1244491405504cc9adcc3b6ce78a91" title="Check whether object on the remote storage.">lu_object_remote</a>(&amp;dt-&gt;<a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>);
<a name="l01798"></a>01798 }
<a name="l01799"></a>01799 
<a name="l01800"></a><a class="code" href="group__dt.html#gaf9d0fde990845807f71027b1c28d1660">01800</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="group__dt.html#gaf9d0fde990845807f71027b1c28d1660">lu2dt_obj</a>(<span class="keyword">struct</span> <a class="code" href="structlu__object.html" title="Layer in the layered object.">lu_object</a> *o)
<a name="l01801"></a>01801 {
<a name="l01802"></a>01802         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(<a class="code" href="osd__iam_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a>(o != NULL, <a class="code" href="group__dt.html#ga979a199f590c77d14dd74ac93a1534f8">lu_device_is_dt</a>(o-&gt;<a class="code" href="structlu__object.html#a5b9108a283d9901c95bdf32833f70601" title="Device for this layer.">lo_dev</a>)));
<a name="l01803"></a>01803         <span class="keywordflow">return</span> container_of0(o, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a>, <a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>);
<a name="l01804"></a>01804 }
<a name="l01805"></a>01805 
<a name="l01806"></a><a class="code" href="group__dt.html#ga001f0314fb6d95b0a8c8fe463ed810b1">01806</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="group__dt.html#ga001f0314fb6d95b0a8c8fe463ed810b1">dt_object_child</a>(<span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *o)
<a name="l01807"></a>01807 {
<a name="l01808"></a>01808         <span class="keywordflow">return</span> container_of0(<a class="code" href="group__lu.html#ga3e5cbde8881c8850b934b9c9af1d92ba" title="Next sub-object in the layering.">lu_object_next</a>(&amp;(o)-&gt;<a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>),
<a name="l01809"></a>01809                              <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a>, <a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>);
<a name="l01810"></a>01810 }
<a name="l01811"></a>01811 
<a name="l01826"></a><a class="code" href="structthandle.html">01826</a> <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> {
<a name="l01828"></a><a class="code" href="structthandle.html#ade585afae0d30b274a8259d402e918b6">01828</a>         <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *<a class="code" href="structthandle.html#ade585afae0d30b274a8259d402e918b6" title="the dt device on which the transactions are executed">th_dev</a>;
<a name="l01829"></a>01829 
<a name="l01830"></a>01830         <span class="comment">/* point to the top thandle, XXX this is a bit hacky right now,</span>
<a name="l01831"></a>01831 <span class="comment">         * but normal device trans callback triggered by the bottom</span>
<a name="l01832"></a>01832 <span class="comment">         * device (OSP/OSD == sub thandle layer) needs to get the</span>
<a name="l01833"></a>01833 <span class="comment">         * top_thandle (see dt_txn_hook_start/stop()), so we put the</span>
<a name="l01834"></a>01834 <span class="comment">         * top thandle here for now, will fix it when we have better</span>
<a name="l01835"></a>01835 <span class="comment">         * callback mechanism */</span>
<a name="l01836"></a><a class="code" href="structthandle.html#af73037330aee2d2a4fce492b06d4d069">01836</a>         <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a>  *<a class="code" href="structthandle.html#af73037330aee2d2a4fce492b06d4d069">th_top</a>;
<a name="l01838"></a><a class="code" href="structthandle.html#af5b62e871bd953fa67e6f943a038e4eb">01838</a>         <span class="keyword">struct </span><a class="code" href="structlu__context.html" title="lu_context.">lu_context</a> <a class="code" href="structthandle.html#af5b62e871bd953fa67e6f943a038e4eb" title="context for this transaction, tag is LCT_TX_HANDLE">th_ctx</a>;
<a name="l01839"></a>01839 
<a name="l01841"></a><a class="code" href="structthandle.html#a63d4ca7d24cf228d73ec7770d7cea6b0">01841</a>         __u32             <a class="code" href="structthandle.html#a63d4ca7d24cf228d73ec7770d7cea6b0" title="additional tags (layers can add in declare)">th_tags</a>;
<a name="l01842"></a>01842 
<a name="l01845"></a><a class="code" href="structthandle.html#a768f192711e7d5c5280da153173cb463">01845</a>         __s32             <a class="code" href="structthandle.html#a768f192711e7d5c5280da153173cb463" title="the last operation result in this transaction.">th_result</a>;
<a name="l01846"></a>01846 
<a name="l01848"></a><a class="code" href="structthandle.html#ac9e6b3e5dc1efd29172c0f4ce214094c">01848</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            <a class="code" href="structthandle.html#a4ebd1192a1e6fd4868826aee3ad1ec05" title="whether we need sync commit">th_sync</a>:1,
<a name="l01849"></a>01849         <span class="comment">/* local transation, no need to inform other layers */</span>
<a name="l01850"></a>01850                                 <a class="code" href="structthandle.html#a22a1765f54dd48454a86468ba8fa6513">th_local</a>:1,
<a name="l01851"></a>01851         <span class="comment">/* Whether we need wait the transaction to be submitted */</span>
<a name="l01852"></a>01852                                 <a class="code" href="structthandle.html#ac9e6b3e5dc1efd29172c0f4ce214094c">th_wait_submit</a>:1,
<a name="l01853"></a>01853         <span class="comment">/* complex transaction which will track updates on all targets */</span>
<a name="l01854"></a>01854                                 <a class="code" href="structthandle.html#a4ed2217a89ec17d3fc8d6112b8fe96b4">th_complex</a>:1;
<a name="l01855"></a>01855 };
<a name="l01856"></a>01856 
<a name="l01868"></a><a class="code" href="structdt__txn__callback.html">01868</a> <span class="keyword">struct </span><a class="code" href="structdt__txn__callback.html" title="Transaction call-backs.">dt_txn_callback</a> {
<a name="l01869"></a>01869         int (*<a class="code" href="structdt__txn__callback.html#aec86ca83a3f203ea417bb87cb01c4e2d">dtc_txn_start</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01870"></a>01870                              <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *txn, <span class="keywordtype">void</span> *cookie);
<a name="l01871"></a>01871         int (*<a class="code" href="structdt__txn__callback.html#afc5e0d5ffab80118a6a9d976ef50e3ad">dtc_txn_stop</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01872"></a>01872                             <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *txn, <span class="keywordtype">void</span> *cookie);
<a name="l01873"></a>01873         void (*<a class="code" href="structdt__txn__callback.html#ac794bcdc1945fadee56a4afd2199487a">dtc_txn_commit</a>)(<span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *txn, <span class="keywordtype">void</span> *cookie);
<a name="l01874"></a><a class="code" href="structdt__txn__callback.html#a1ab09090e95a7a870d26b2ac8f2f4fe4">01874</a>         <span class="keywordtype">void</span>                    *<a class="code" href="structdt__txn__callback.html#a1ab09090e95a7a870d26b2ac8f2f4fe4">dtc_cookie</a>;
<a name="l01875"></a><a class="code" href="structdt__txn__callback.html#aa802cbbe28f02a881cc99b0e384725b7">01875</a>         __u32                   <a class="code" href="structdt__txn__callback.html#aa802cbbe28f02a881cc99b0e384725b7">dtc_tag</a>;
<a name="l01876"></a><a class="code" href="structdt__txn__callback.html#a683068e0045c67aa486f111335524b73">01876</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structdt__txn__callback.html#a683068e0045c67aa486f111335524b73">dtc_linkage</a>;
<a name="l01877"></a>01877 };
<a name="l01878"></a>01878 
<a name="l01879"></a>01879 <span class="keywordtype">void</span> <a class="code" href="group__dt.html#ga76707fa4baf06abc78c090c380a8ddeb">dt_txn_callback_add</a>(<span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev, <span class="keyword">struct</span> <a class="code" href="structdt__txn__callback.html" title="Transaction call-backs.">dt_txn_callback</a> *cb);
<a name="l01880"></a>01880 <span class="keywordtype">void</span> <a class="code" href="group__dt.html#gabc5447f062335db101f52e0d49b3fcfc">dt_txn_callback_del</a>(<span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev, <span class="keyword">struct</span> <a class="code" href="structdt__txn__callback.html" title="Transaction call-backs.">dt_txn_callback</a> *cb);
<a name="l01881"></a>01881 
<a name="l01882"></a>01882 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga18e7bc758948ecb19fcdcfd520ba847c">dt_txn_hook_start</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01883"></a>01883                       <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *txn);
<a name="l01884"></a>01884 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#gab9e95903a047ba895b93af4c87eb86d5">dt_txn_hook_stop</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *txn);
<a name="l01885"></a>01885 <span class="keywordtype">void</span> <a class="code" href="group__dt.html#ga85e22f6184cd57fcb54c388eb64617d4">dt_txn_hook_commit</a>(<span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *txn);
<a name="l01886"></a>01886 
<a name="l01887"></a>01887 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#gaa687b02c4c10d70a9764c4932ecb6232">dt_try_as_dir</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj);
<a name="l01888"></a>01888 
<a name="l01893"></a><a class="code" href="group__dt.html#gaac0ca3702789825e928e3b059d727679">01893</a> <span class="keyword">typedef</span> int (*<a class="code" href="group__dt.html#gaac0ca3702789825e928e3b059d727679" title="Callback function used for parsing path.">dt_entry_func_t</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01894"></a>01894                             <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,
<a name="l01895"></a>01895                             <span class="keywordtype">void</span> *pvt);
<a name="l01896"></a>01896 
<a name="l01897"></a><a class="code" href="group__dt.html#ga60515ba68b99bab0f304687ea2fc45f5">01897</a> <span class="preprocessor">#define DT_MAX_PATH 1024</span>
<a name="l01898"></a>01898 <span class="preprocessor"></span>
<a name="l01899"></a>01899 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#gae3f4b97c61841d149a6fa3a10d824494" title="Abstract function which parses path name.">dt_path_parser</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01900"></a>01900                    <span class="keywordtype">char</span> *local, <a class="code" href="group__dt.html#gaac0ca3702789825e928e3b059d727679" title="Callback function used for parsing path.">dt_entry_func_t</a> entry_func,
<a name="l01901"></a>01901                    <span class="keywordtype">void</span> *data);
<a name="l01902"></a>01902 
<a name="l01903"></a>01903 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *
<a name="l01904"></a>01904 <a class="code" href="group__dt.html#ga470747542773d71588e0917bb8114745">dt_store_resolve</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dt,
<a name="l01905"></a>01905                  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdsrate_8c.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>, <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid);
<a name="l01906"></a>01906 
<a name="l01907"></a>01907 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="group__dt.html#ga589d233b6276fc177086429e37221e36" title="Open dt object named filename from dirname directory.">dt_store_open</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01908"></a>01908                                 <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dt,
<a name="l01909"></a>01909                                 <span class="keyword">const</span> <span class="keywordtype">char</span> *dirname,
<a name="l01910"></a>01910                                 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdsrate_8c.html#ab49244970ed5ca30989c2dab2129de34">filename</a>,
<a name="l01911"></a>01911                                 <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid);
<a name="l01912"></a>01912 
<a name="l01913"></a>01913 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="group__dt.html#ga4de85f171c1a2ff28eb385480d9298af">dt_find_or_create</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01914"></a>01914                                     <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dt,
<a name="l01915"></a>01915                                     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid,
<a name="l01916"></a>01916                                     <span class="keyword">struct</span> <a class="code" href="structdt__object__format.html" title="object format specifier.">dt_object_format</a> *dof,
<a name="l01917"></a>01917                                     <span class="keyword">struct</span> <a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *attr);
<a name="l01918"></a>01918 
<a name="l01919"></a>01919 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="group__dt.html#ga3389f36463d849430a4f959b7d04f75b">dt_locate_at</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01920"></a>01920                                <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l01921"></a>01921                                <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid,
<a name="l01922"></a>01922                                <span class="keyword">struct</span> <a class="code" href="structlu__device.html" title="Device: a layer in the server side abstraction stacking.">lu_device</a> *top_dev,
<a name="l01923"></a>01923                                <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__object__conf.html" title="Object configuration, describing particulars of object being created.">lu_object_conf</a> *conf);
<a name="l01924"></a>01924 
<a name="l01925"></a>01925 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *
<a name="l01926"></a><a class="code" href="group__dt.html#gac653806b6ed3e5b8616d14fa74cecd72">01926</a> <a class="code" href="group__dt.html#gac653806b6ed3e5b8616d14fa74cecd72">dt_locate</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l01927"></a>01927           <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid)
<a name="l01928"></a>01928 {
<a name="l01929"></a>01929         <span class="keywordflow">return</span> <a class="code" href="group__dt.html#ga3389f36463d849430a4f959b7d04f75b">dt_locate_at</a>(env, dev, fid,
<a name="l01930"></a>01930                             dev-&gt;<a class="code" href="structdt__device.html#a54e8912d9668696ec00395a14ca44fd3">dd_lu_dev</a>.<a class="code" href="structlu__device.html#aaa1ef1e1a330f307a9baf6e59fc9c39b" title="Stack this device belongs to.">ld_site</a>-&gt;<a class="code" href="structlu__site.html#a371ff1de170feccd1c80e3d7a0202965" title="Top-level device for this stack.">ls_top_dev</a>, NULL);
<a name="l01931"></a>01931 }
<a name="l01932"></a>01932 
<a name="l01933"></a>01933 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *
<a name="l01934"></a><a class="code" href="group__dt.html#gacaec0c850493b1e3a584d73ac6364142">01934</a> <a class="code" href="group__dt.html#gacaec0c850493b1e3a584d73ac6364142">dt_object_locate</a>(<span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dto, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dt_dev)
<a name="l01935"></a>01935 {
<a name="l01936"></a>01936         <span class="keyword">struct </span><a class="code" href="structlu__object.html" title="Layer in the layered object.">lu_object</a> *lo;
<a name="l01937"></a>01937 
<a name="l01938"></a>01938         <a class="code" href="list_8h.html#a9b782fefb5ab71ce9762182e45a615e1" title="Iterate over a list of given type.">list_for_each_entry</a>(lo, &amp;dto-&gt;<a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>.<a class="code" href="structlu__object.html#ab55ad0889ad4d306d0a5aad7ed0aa398" title="Header for this object.">lo_header</a>-&gt;<a class="code" href="structlu__object__header.html#a1a4f1dbeb2aadfe34d9d11ed0ede12ec" title="Linkage into list of layers.">loh_layers</a>, <a class="code" href="structlu__object.html#a40275d310eb13538f41291f1cf7cba77" title="Linkage into list of all layers.">lo_linkage</a>) {
<a name="l01939"></a>01939                 <span class="keywordflow">if</span> (lo-&gt;<a class="code" href="structlu__object.html#a5b9108a283d9901c95bdf32833f70601" title="Device for this layer.">lo_dev</a> == &amp;dt_dev-&gt;<a class="code" href="structdt__device.html#a54e8912d9668696ec00395a14ca44fd3">dd_lu_dev</a>)
<a name="l01940"></a>01940                         <span class="keywordflow">return</span> container_of(lo, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a>, do_lu);
<a name="l01941"></a>01941         }
<a name="l01942"></a>01942         <span class="keywordflow">return</span> NULL;
<a name="l01943"></a>01943 }
<a name="l01944"></a>01944 
<a name="l01945"></a>01945 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#gacddd08c8c9a92143811432373ca8a057" title="Initialize local OID storage for required sequence.">local_oid_storage_init</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l01946"></a>01946                            <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *first_fid,
<a name="l01947"></a>01947                            <span class="keyword">struct</span> <a class="code" href="structlocal__oid__storage.html">local_oid_storage</a> **los);
<a name="l01948"></a>01948 <span class="keywordtype">void</span> <a class="code" href="group__dt.html#gafc7d279bad6c3cfbef855fcce89af0e2">local_oid_storage_fini</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01949"></a>01949                             <span class="keyword">struct</span> <a class="code" href="structlocal__oid__storage.html">local_oid_storage</a> *los);
<a name="l01950"></a>01950 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#gaecff6d908b2936e4f9c804611204f98f" title="local file fid generation">local_object_fid_generate</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01951"></a>01951                               <span class="keyword">struct</span> <a class="code" href="structlocal__oid__storage.html">local_oid_storage</a> *los,
<a name="l01952"></a>01952                               <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid);
<a name="l01953"></a>01953 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#gad041ecb776afdf707f6e829a043e7cc2">local_object_declare_create</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01954"></a>01954                                 <span class="keyword">struct</span> <a class="code" href="structlocal__oid__storage.html">local_oid_storage</a> *los,
<a name="l01955"></a>01955                                 <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *o,
<a name="l01956"></a>01956                                 <span class="keyword">struct</span> <a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *attr,
<a name="l01957"></a>01957                                 <span class="keyword">struct</span> <a class="code" href="structdt__object__format.html" title="object format specifier.">dt_object_format</a> *dof,
<a name="l01958"></a>01958                                 <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l01959"></a>01959 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#gaa288349ab34fbd660c1382182b57808b">local_object_create</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01960"></a>01960                         <span class="keyword">struct</span> <a class="code" href="structlocal__oid__storage.html">local_oid_storage</a> *los,
<a name="l01961"></a>01961                         <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *o,
<a name="l01962"></a>01962                         <span class="keyword">struct</span> <a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *attr, <span class="keyword">struct</span> <a class="code" href="structdt__object__format.html" title="object format specifier.">dt_object_format</a> *dof,
<a name="l01963"></a>01963                         <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l01964"></a>01964 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="group__dt.html#ga682bce02955a11f484a63b86a7a84732">local_file_find_or_create</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01965"></a>01965                                             <span class="keyword">struct</span> <a class="code" href="structlocal__oid__storage.html">local_oid_storage</a> *los,
<a name="l01966"></a>01966                                             <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *parent,
<a name="l01967"></a>01967                                             <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, __u32 <a class="code" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>);
<a name="l01968"></a>01968 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="group__dt.html#ga70effd2e3f0a0a777bce34020915c1ac">local_file_find_or_create_with_fid</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01969"></a>01969                                                      <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dt,
<a name="l01970"></a>01970                                                      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid,
<a name="l01971"></a>01971                                                      <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *parent,
<a name="l01972"></a>01972                                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,
<a name="l01973"></a>01973                                                      __u32 <a class="code" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>);
<a name="l01974"></a>01974 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *
<a name="l01975"></a>01975 <a class="code" href="group__dt.html#gabb72c7a30f9f16095f213dd4241913fd">local_index_find_or_create</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01976"></a>01976                            <span class="keyword">struct</span> <a class="code" href="structlocal__oid__storage.html">local_oid_storage</a> *los,
<a name="l01977"></a>01977                            <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *parent,
<a name="l01978"></a>01978                            <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, __u32 <a class="code" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>,
<a name="l01979"></a>01979                            <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structdt__index__features.html">dt_index_features</a> *ft);
<a name="l01980"></a>01980 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *
<a name="l01981"></a>01981 <a class="code" href="group__dt.html#ga8a424741dd5edb9d58fb11f0a3cd697c">local_index_find_or_create_with_fid</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01982"></a>01982                                     <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dt,
<a name="l01983"></a>01983                                     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid,
<a name="l01984"></a>01984                                     <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *parent,
<a name="l01985"></a>01985                                     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, __u32 <a class="code" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>,
<a name="l01986"></a>01986                                     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structdt__index__features.html">dt_index_features</a> *ft);
<a name="l01987"></a>01987 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga53a967f20c05c94ccf6139d1b2122db8">local_object_unlink</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dt,
<a name="l01988"></a>01988                         <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l01989"></a>01989 
<a name="l01990"></a><a class="code" href="group__dt.html#ga8e8d9dfa91d8ae4cd0a59f132e9dc968">01990</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga8e8d9dfa91d8ae4cd0a59f132e9dc968">dt_object_lock</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01991"></a>01991                                  <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *o, <span class="keyword">struct</span> <a class="code" href="structlustre__handle.html">lustre_handle</a> *lh,
<a name="l01992"></a>01992                                  <span class="keyword">struct</span> <a class="code" href="structldlm__enqueue__info.html" title="Common ldlm_enqueue parameters.">ldlm_enqueue_info</a> *einfo,
<a name="l01993"></a>01993                                  <span class="keyword">union</span> <a class="code" href="unionldlm__policy__data.html">ldlm_policy_data</a> *policy)
<a name="l01994"></a>01994 {
<a name="l01995"></a>01995         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(o != NULL);
<a name="l01996"></a>01996         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(o-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a> != NULL);
<a name="l01997"></a>01997         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(o-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a1f63b46e6b64b5c8ba9e81492e0c2f19" title="Lock object.">do_object_lock</a> != NULL);
<a name="l01998"></a>01998         <span class="keywordflow">return</span> o-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a1f63b46e6b64b5c8ba9e81492e0c2f19" title="Lock object.">do_object_lock</a>(env, o, lh, einfo, policy);
<a name="l01999"></a>01999 }
<a name="l02000"></a>02000 
<a name="l02001"></a><a class="code" href="group__dt.html#ga28bdfbbbad95dd5d60f51439569e618d">02001</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga28bdfbbbad95dd5d60f51439569e618d">dt_object_unlock</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02002"></a>02002                                    <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *o,
<a name="l02003"></a>02003                                    <span class="keyword">struct</span> <a class="code" href="structldlm__enqueue__info.html" title="Common ldlm_enqueue parameters.">ldlm_enqueue_info</a> *einfo,
<a name="l02004"></a>02004                                    <span class="keyword">union</span> <a class="code" href="unionldlm__policy__data.html">ldlm_policy_data</a> *policy)
<a name="l02005"></a>02005 {
<a name="l02006"></a>02006         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(o != NULL);
<a name="l02007"></a>02007         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(o-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a> != NULL);
<a name="l02008"></a>02008         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(o-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a0cc597f75bd319af28376e8a280a6ae3" title="Unlock object.">do_object_unlock</a> != NULL);
<a name="l02009"></a>02009         <span class="keywordflow">return</span> o-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a0cc597f75bd319af28376e8a280a6ae3" title="Unlock object.">do_object_unlock</a>(env, o, einfo, policy);
<a name="l02010"></a>02010 }
<a name="l02011"></a>02011 
<a name="l02012"></a>02012 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga4c9bbe53e3209cc074409cbfdcb84ef6" title="lookup fid for object named name in directory dir.">dt_lookup_dir</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="mmap__sanity_8c.html#a73da71b9c136e698a3ccaa1366e455a8">dir</a>,
<a name="l02013"></a>02013                   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid);
<a name="l02014"></a>02014 
<a name="l02015"></a><a class="code" href="group__dt.html#gae136985e597fc35def7172bc262b2672">02015</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__dt.html#gae136985e597fc35def7172bc262b2672">dt_object_sync</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *o,
<a name="l02016"></a>02016                                  <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="mdsrate_8c.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>)
<a name="l02017"></a>02017 {
<a name="l02018"></a>02018         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(o);
<a name="l02019"></a>02019         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(o-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02020"></a>02020         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(o-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a2e3f3539d6ce344b27712d4b2f39d7b2" title="Sync obect.">do_object_sync</a>);
<a name="l02021"></a>02021         <span class="keywordflow">return</span> o-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a2e3f3539d6ce344b27712d4b2f39d7b2" title="Sync obect.">do_object_sync</a>(env, o, start, end);
<a name="l02022"></a>02022 }
<a name="l02023"></a>02023 
<a name="l02024"></a>02024 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga37e50073474b1f546edc3ca29f3f8255">dt_declare_version_set</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *o,
<a name="l02025"></a>02025                            <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l02026"></a>02026 <span class="keywordtype">void</span> <a class="code" href="group__dt.html#gaa5b07b45f6605ea88bfe89d439234504">dt_version_set</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *o,
<a name="l02027"></a>02027                     <a class="code" href="group__dt.html#gad589f42840c693e67e09774b46036250">dt_obj_version_t</a> <a class="code" href="packet-lnet_8c.html#a0a5c5891c90b30e72f5cfca80915338e">version</a>, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l02028"></a>02028 <a class="code" href="group__dt.html#gad589f42840c693e67e09774b46036250">dt_obj_version_t</a> <a class="code" href="group__dt.html#gac34ed7d5122ae9cfbc5dbe32326e40a0">dt_version_get</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *o);
<a name="l02029"></a>02029 
<a name="l02030"></a>02030 
<a name="l02031"></a>02031 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga43c7a1d7a094f43523d594505c481095" title="Generic read helper.">dt_read</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02032"></a>02032             <span class="keyword">struct</span> <a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>, loff_t *pos);
<a name="l02033"></a>02033 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga82d909c9a0d09d6c21420825acb9e40e" title="Read structures of fixed size from storage.">dt_record_read</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02034"></a>02034                    <span class="keyword">struct</span> <a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>, loff_t *pos);
<a name="l02035"></a>02035 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga1360ed5c302396b9d5bac50fbfd8ae89">dt_record_write</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02036"></a>02036                     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>, loff_t *pos, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l02037"></a><a class="code" href="group__dt.html#gac5b222f899fba9030ea3dbee259e4c97">02037</a> <span class="keyword">typedef</span> int (*<a class="code" href="group__dt.html#gac5b222f899fba9030ea3dbee259e4c97">dt_index_page_build_t</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02038"></a>02038                                      <span class="keyword">union </span><a class="code" href="unionlu__page.html">lu_page</a> *lp, <span class="keywordtype">size_t</span> nob,
<a name="l02039"></a>02039                                      <span class="keyword">const</span> <span class="keyword">struct </span>dt_it_ops *iops,
<a name="l02040"></a>02040                                      <span class="keyword">struct </span>dt_it *it, __u32 attr, <span class="keywordtype">void</span> *arg);
<a name="l02041"></a>02041 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga9f5929118cadd58fb765ab3619c41db9">dt_index_walk</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj,
<a name="l02042"></a>02042                   <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__rdpg.html" title="input params, should be filled out by mdt">lu_rdpg</a> *rdpg, <a class="code" href="group__dt.html#gac5b222f899fba9030ea3dbee259e4c97">dt_index_page_build_t</a> filler,
<a name="l02043"></a>02043                   <span class="keywordtype">void</span> *arg);
<a name="l02044"></a>02044 <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga311aa8b791e51a13353036585b1236a4" title="Walk key/record pairs of an index and copy them into 4KB containers to be transferred...">dt_index_read</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l02045"></a>02045                   <span class="keyword">struct</span> <a class="code" href="structidx__info.html">idx_info</a> *ii, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__rdpg.html" title="input params, should be filled out by mdt">lu_rdpg</a> *rdpg);
<a name="l02046"></a>02046 
<a name="l02047"></a><a class="code" href="group__dt.html#ga689a89697bff3936cf4d60bd2651dc8a">02047</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *<a class="code" href="group__dt.html#ga689a89697bff3936cf4d60bd2651dc8a">dt_trans_create</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02048"></a>02048                                               <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *d)
<a name="l02049"></a>02049 {
<a name="l02050"></a>02050         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a06f026899bb291ac5bb915a17dcadb7f" title="Create transaction.">dt_trans_create</a>);
<a name="l02051"></a>02051         <span class="keywordflow">return</span> d-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a06f026899bb291ac5bb915a17dcadb7f" title="Create transaction.">dt_trans_create</a>(env, d);
<a name="l02052"></a>02052 }
<a name="l02053"></a>02053 
<a name="l02054"></a><a class="code" href="group__dt.html#ga93ebb43b2740f8628a781a8dcfd23f6b">02054</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga93ebb43b2740f8628a781a8dcfd23f6b">dt_trans_start</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02055"></a>02055                                  <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *d, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02056"></a>02056 {
<a name="l02057"></a>02057         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a9f4532e51dbeefa61d9c0f6a9670ef5b" title="Start transaction.">dt_trans_start</a>);
<a name="l02058"></a>02058         <span class="keywordflow">return</span> d-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a9f4532e51dbeefa61d9c0f6a9670ef5b" title="Start transaction.">dt_trans_start</a>(env, d, th);
<a name="l02059"></a>02059 }
<a name="l02060"></a>02060 
<a name="l02061"></a>02061 <span class="comment">/* for this transaction hooks shouldn&apos;t be called */</span>
<a name="l02062"></a><a class="code" href="group__dt.html#gaec633f618ffdd701fa5f233dd4c1d161">02062</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__dt.html#gaec633f618ffdd701fa5f233dd4c1d161">dt_trans_start_local</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02063"></a>02063                                        <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *d, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02064"></a>02064 {
<a name="l02065"></a>02065         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a9f4532e51dbeefa61d9c0f6a9670ef5b" title="Start transaction.">dt_trans_start</a>);
<a name="l02066"></a>02066         th-&gt;<a class="code" href="structthandle.html#a22a1765f54dd48454a86468ba8fa6513">th_local</a> = 1;
<a name="l02067"></a>02067         <span class="keywordflow">return</span> d-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a9f4532e51dbeefa61d9c0f6a9670ef5b" title="Start transaction.">dt_trans_start</a>(env, d, th);
<a name="l02068"></a>02068 }
<a name="l02069"></a>02069 
<a name="l02070"></a><a class="code" href="group__dt.html#gac5cb16311e5767ec9068c9aac417628a">02070</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__dt.html#gac5cb16311e5767ec9068c9aac417628a">dt_trans_stop</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02071"></a>02071                                 <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *d, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02072"></a>02072 {
<a name="l02073"></a>02073         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a1a48e37999c62e8d1d2ad6e84572393b" title="Stop transaction.">dt_trans_stop</a>);
<a name="l02074"></a>02074         <span class="keywordflow">return</span> d-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a1a48e37999c62e8d1d2ad6e84572393b" title="Stop transaction.">dt_trans_stop</a>(env, d, th);
<a name="l02075"></a>02075 }
<a name="l02076"></a>02076 
<a name="l02077"></a><a class="code" href="group__dt.html#ga183db692d6c759a6b8cc88c4e5ee069f">02077</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__dt.html#ga183db692d6c759a6b8cc88c4e5ee069f">dt_trans_cb_add</a>(<span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th,
<a name="l02078"></a>02078                                   <span class="keyword">struct</span> <a class="code" href="structdt__txn__commit__cb.html">dt_txn_commit_cb</a> *dcb)
<a name="l02079"></a>02079 {
<a name="l02080"></a>02080         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(th-&gt;<a class="code" href="structthandle.html#ade585afae0d30b274a8259d402e918b6" title="the dt device on which the transactions are executed">th_dev</a>-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a977a253aad1d585cf9c316c3f87d801d" title="Add commit callback to the transaction.">dt_trans_cb_add</a>);
<a name="l02081"></a>02081         dcb-&gt;<a class="code" href="structdt__txn__commit__cb.html#ae34349e1d25fe1d884fa709f957c0111">dcb_magic</a> = <a class="code" href="group__dt.html#ga89459f49f808512a60eea34fdcd5e43f" title="Special per-transaction callback for cases when just commit callback is needed and...">TRANS_COMMIT_CB_MAGIC</a>;
<a name="l02082"></a>02082         <span class="keywordflow">return</span> th-&gt;<a class="code" href="structthandle.html#ade585afae0d30b274a8259d402e918b6" title="the dt device on which the transactions are executed">th_dev</a>-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a977a253aad1d585cf9c316c3f87d801d" title="Add commit callback to the transaction.">dt_trans_cb_add</a>(th, dcb);
<a name="l02083"></a>02083 }
<a name="l02087"></a><a class="code" href="dt__object_8h.html#abce616285763a761d1331299f8e4dafc">02087</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#abce616285763a761d1331299f8e4dafc">dt_declare_record_write</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02088"></a>02088                                           <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02089"></a>02089                                           <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l02090"></a>02090                                           loff_t pos,
<a name="l02091"></a>02091                                           <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02092"></a>02092 {
<a name="l02093"></a>02093         <span class="keywordtype">int</span> rc;
<a name="l02094"></a>02094 
<a name="l02095"></a>02095         <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(dt != NULL, <span class="stringliteral">&quot;dt is NULL when we want to write record\n&quot;</span>);
<a name="l02096"></a>02096         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(th != NULL);
<a name="l02097"></a>02097         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>);
<a name="l02098"></a>02098         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#aa4d64d407e2b442c1e418fa9ca46ab44" title="Declare intention to write data to object.">dbo_declare_write</a>);
<a name="l02099"></a>02099         rc = dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#aa4d64d407e2b442c1e418fa9ca46ab44" title="Declare intention to write data to object.">dbo_declare_write</a>(env, dt, buf, pos, th);
<a name="l02100"></a>02100         <span class="keywordflow">return</span> rc;
<a name="l02101"></a>02101 }
<a name="l02102"></a>02102 
<a name="l02103"></a><a class="code" href="dt__object_8h.html#a42848e00d321307e71d0243b2bbd3a1c">02103</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a42848e00d321307e71d0243b2bbd3a1c">dt_declare_create</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02104"></a>02104                                     <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02105"></a>02105                                     <span class="keyword">struct</span> <a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *attr,
<a name="l02106"></a>02106                                     <span class="keyword">struct</span> <a class="code" href="structdt__allocation__hint.html" title="This is a general purpose dt allocation hint.">dt_allocation_hint</a> *hint,
<a name="l02107"></a>02107                                     <span class="keyword">struct</span> <a class="code" href="structdt__object__format.html" title="object format specifier.">dt_object_format</a> *dof,
<a name="l02108"></a>02108                                     <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02109"></a>02109 {
<a name="l02110"></a>02110         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02111"></a>02111         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02112"></a>02112         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#ab16b75516dfd3d619fbffbc96f2b9d24" title="Declare intention to create a new object.">do_declare_create</a>);
<a name="l02113"></a>02113 
<a name="l02114"></a>02114         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#aaa3f7ea8af4eac6f2433bc0f46574d15">OBD_FAIL_DT_DECLARE_CREATE</a>))
<a name="l02115"></a>02115                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02116"></a>02116 
<a name="l02117"></a>02117         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#ab16b75516dfd3d619fbffbc96f2b9d24" title="Declare intention to create a new object.">do_declare_create</a>(env, dt, attr, hint, dof, th);
<a name="l02118"></a>02118 }
<a name="l02119"></a>02119 
<a name="l02120"></a><a class="code" href="dt__object_8h.html#a2290c7902d1d0ae6a8083866f102d393">02120</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a2290c7902d1d0ae6a8083866f102d393">dt_create</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02121"></a>02121                                     <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02122"></a>02122                                     <span class="keyword">struct</span> <a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *attr,
<a name="l02123"></a>02123                                     <span class="keyword">struct</span> <a class="code" href="structdt__allocation__hint.html" title="This is a general purpose dt allocation hint.">dt_allocation_hint</a> *hint,
<a name="l02124"></a>02124                                     <span class="keyword">struct</span> <a class="code" href="structdt__object__format.html" title="object format specifier.">dt_object_format</a> *dof,
<a name="l02125"></a>02125                                     <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02126"></a>02126 {
<a name="l02127"></a>02127         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02128"></a>02128         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02129"></a>02129         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#ac1ca5a81cd3d00bd821fbfead64022c3" title="Create new object.">do_create</a>);
<a name="l02130"></a>02130 
<a name="l02131"></a>02131         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a57634d01a892ff4dc4a7f21a3c0f7e1a">OBD_FAIL_DT_CREATE</a>))
<a name="l02132"></a>02132                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02133"></a>02133 
<a name="l02134"></a>02134         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#ac1ca5a81cd3d00bd821fbfead64022c3" title="Create new object.">do_create</a>(env, dt, attr, hint, dof, th);
<a name="l02135"></a>02135 }
<a name="l02136"></a>02136 
<a name="l02137"></a><a class="code" href="dt__object_8h.html#a822f4c08cdfc7fd82d4d1c1d4108ecdb">02137</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a822f4c08cdfc7fd82d4d1c1d4108ecdb">dt_declare_destroy</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02138"></a>02138                                      <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02139"></a>02139                                      <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02140"></a>02140 {
<a name="l02141"></a>02141         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02142"></a>02142         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02143"></a>02143         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#af211c9cc7a0203979cd8cf0f0b81b293" title="Declare intention to destroy an object.">do_declare_destroy</a>);
<a name="l02144"></a>02144 
<a name="l02145"></a>02145         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#aa3c162052b7254cd7ec0886ed780a805">OBD_FAIL_DT_DECLARE_DESTROY</a>))
<a name="l02146"></a>02146                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02147"></a>02147 
<a name="l02148"></a>02148         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#af211c9cc7a0203979cd8cf0f0b81b293" title="Declare intention to destroy an object.">do_declare_destroy</a>(env, dt, th);
<a name="l02149"></a>02149 }
<a name="l02150"></a>02150 
<a name="l02151"></a><a class="code" href="dt__object_8h.html#ac558a9c967148f1fddc6c228525aa2a8">02151</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#ac558a9c967148f1fddc6c228525aa2a8">dt_destroy</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02152"></a>02152                              <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02153"></a>02153                              <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02154"></a>02154 {
<a name="l02155"></a>02155         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02156"></a>02156         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02157"></a>02157         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a19ddd277003c24371f8c5771a2ba77bb" title="Destroy an object.">do_destroy</a>);
<a name="l02158"></a>02158 
<a name="l02159"></a>02159         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#afc67b6dc13f531bc11730119c8ef89da">OBD_FAIL_DT_DESTROY</a>))
<a name="l02160"></a>02160                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02161"></a>02161 
<a name="l02162"></a>02162         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a19ddd277003c24371f8c5771a2ba77bb" title="Destroy an object.">do_destroy</a>(env, dt, th);
<a name="l02163"></a>02163 }
<a name="l02164"></a>02164 
<a name="l02165"></a><a class="code" href="dt__object_8h.html#ac0dae128f4a5bc05901c01de2395b15f">02165</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="dt__object_8h.html#ac0dae128f4a5bc05901c01de2395b15f">dt_read_lock</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02166"></a>02166                                 <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02167"></a>02167                                 <span class="keywordtype">unsigned</span> role)
<a name="l02168"></a>02168 {
<a name="l02169"></a>02169         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02170"></a>02170         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02171"></a>02171         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a32a37f3abca0903ec9fa5c70b2b7a423" title="Get read lock on object.">do_read_lock</a>);
<a name="l02172"></a>02172         dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a32a37f3abca0903ec9fa5c70b2b7a423" title="Get read lock on object.">do_read_lock</a>(env, dt, role);
<a name="l02173"></a>02173 }
<a name="l02174"></a>02174 
<a name="l02175"></a><a class="code" href="dt__object_8h.html#ae8cb5937aeaa4964666508e12b910847">02175</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="dt__object_8h.html#ae8cb5937aeaa4964666508e12b910847">dt_write_lock</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02176"></a>02176                                 <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02177"></a>02177                                 <span class="keywordtype">unsigned</span> role)
<a name="l02178"></a>02178 {
<a name="l02179"></a>02179         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02180"></a>02180         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02181"></a>02181         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a5bf582901eb4dcb781f03f02621535a2">do_write_lock</a>);
<a name="l02182"></a>02182         dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a5bf582901eb4dcb781f03f02621535a2">do_write_lock</a>(env, dt, role);
<a name="l02183"></a>02183 }
<a name="l02184"></a>02184 
<a name="l02185"></a><a class="code" href="dt__object_8h.html#aa80d7ed485597d6b8089358d525ea7e5">02185</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="dt__object_8h.html#aa80d7ed485597d6b8089358d525ea7e5">dt_read_unlock</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02186"></a>02186                                 <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt)
<a name="l02187"></a>02187 {
<a name="l02188"></a>02188         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02189"></a>02189         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02190"></a>02190         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a5d68d191697e7964615a090f9896f7f5" title="Release read lock.">do_read_unlock</a>);
<a name="l02191"></a>02191         dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a5d68d191697e7964615a090f9896f7f5" title="Release read lock.">do_read_unlock</a>(env, dt);
<a name="l02192"></a>02192 }
<a name="l02193"></a>02193 
<a name="l02194"></a><a class="code" href="dt__object_8h.html#a1f572186466c01829d6651a6ce19ab35">02194</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="dt__object_8h.html#a1f572186466c01829d6651a6ce19ab35">dt_write_unlock</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02195"></a>02195                                 <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt)
<a name="l02196"></a>02196 {
<a name="l02197"></a>02197         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02198"></a>02198         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02199"></a>02199         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#ad5346269fb80455252849f4fd7403720" title="Release write lock.">do_write_unlock</a>);
<a name="l02200"></a>02200         dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#ad5346269fb80455252849f4fd7403720" title="Release write lock.">do_write_unlock</a>(env, dt);
<a name="l02201"></a>02201 }
<a name="l02202"></a>02202 
<a name="l02203"></a><a class="code" href="dt__object_8h.html#ac76d9c8a5791df467aee9396c9bcef94">02203</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#ac76d9c8a5791df467aee9396c9bcef94">dt_write_locked</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02204"></a>02204                                   <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt)
<a name="l02205"></a>02205 {
<a name="l02206"></a>02206         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02207"></a>02207         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02208"></a>02208         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a9072566fd18a198a7323439603b6fbdf" title="Check whether write lock is held.">do_write_locked</a>);
<a name="l02209"></a>02209         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a9072566fd18a198a7323439603b6fbdf" title="Check whether write lock is held.">do_write_locked</a>(env, dt);
<a name="l02210"></a>02210 }
<a name="l02211"></a>02211 
<a name="l02212"></a><a class="code" href="dt__object_8h.html#a1a186ba3c83fae2c8233d6a94fd33f8b">02212</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a1a186ba3c83fae2c8233d6a94fd33f8b">dt_declare_attr_get</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02213"></a>02213                                       <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt)
<a name="l02214"></a>02214 {
<a name="l02215"></a>02215         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02216"></a>02216         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02217"></a>02217         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#adc1fb34feaf57d9448beaab7f04302bd" title="Declare intention to request reqular attributes.">do_declare_attr_get</a>);
<a name="l02218"></a>02218 
<a name="l02219"></a>02219         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#aab683d29a8a0effff7d3d2ef358d939b">OBD_FAIL_DT_DECLARE_ATTR_GET</a>))
<a name="l02220"></a>02220                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02221"></a>02221 
<a name="l02222"></a>02222         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#adc1fb34feaf57d9448beaab7f04302bd" title="Declare intention to request reqular attributes.">do_declare_attr_get</a>(env, dt);
<a name="l02223"></a>02223 }
<a name="l02224"></a>02224 
<a name="l02225"></a><a class="code" href="dt__object_8h.html#a54e17b0020bc4d4c6be00e0fc689622a">02225</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a54e17b0020bc4d4c6be00e0fc689622a">dt_attr_get</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02226"></a>02226                               <span class="keyword">struct</span> <a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *la)
<a name="l02227"></a>02227 {
<a name="l02228"></a>02228         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02229"></a>02229         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02230"></a>02230         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a1d2ff17287fa229d0325cccf0aac5beb" title="Return regular attributes.">do_attr_get</a>);
<a name="l02231"></a>02231 
<a name="l02232"></a>02232         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a0e910baf9ebd1abd24e4f43c63f0ba3b">OBD_FAIL_DT_ATTR_GET</a>))
<a name="l02233"></a>02233                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02234"></a>02234 
<a name="l02235"></a>02235         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a1d2ff17287fa229d0325cccf0aac5beb" title="Return regular attributes.">do_attr_get</a>(env, dt, la);
<a name="l02236"></a>02236 }
<a name="l02237"></a>02237 
<a name="l02238"></a><a class="code" href="dt__object_8h.html#aefd6ac2847b72d189da00d32b740d91f">02238</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#aefd6ac2847b72d189da00d32b740d91f">dt_declare_attr_set</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02239"></a>02239                                       <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02240"></a>02240                                       <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *la,
<a name="l02241"></a>02241                                       <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02242"></a>02242 {
<a name="l02243"></a>02243         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02244"></a>02244         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02245"></a>02245         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a44eb5df458974e0568eba9863c439362" title="Declare intention to change regular object&amp;#39;s attributes.">do_declare_attr_set</a>);
<a name="l02246"></a>02246 
<a name="l02247"></a>02247         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a17d0ca3b474af8140fed8b2689877d49">OBD_FAIL_DT_DECLARE_ATTR_SET</a>))
<a name="l02248"></a>02248                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02249"></a>02249 
<a name="l02250"></a>02250         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a44eb5df458974e0568eba9863c439362" title="Declare intention to change regular object&amp;#39;s attributes.">do_declare_attr_set</a>(env, dt, la, th);
<a name="l02251"></a>02251 }
<a name="l02252"></a>02252 
<a name="l02253"></a><a class="code" href="dt__object_8h.html#a73c5f29d48fb9563afacf3b3c016356b">02253</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a73c5f29d48fb9563afacf3b3c016356b">dt_attr_set</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02254"></a>02254                               <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *la, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02255"></a>02255 {
<a name="l02256"></a>02256         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02257"></a>02257         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02258"></a>02258         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#aa9a55847088d77aa8bbc16c693344ddb" title="Change regular attributes.">do_attr_set</a>);
<a name="l02259"></a>02259 
<a name="l02260"></a>02260         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a9e761297a8de28cb29097524a949f4f5">OBD_FAIL_DT_ATTR_SET</a>))
<a name="l02261"></a>02261                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02262"></a>02262 
<a name="l02263"></a>02263         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#aa9a55847088d77aa8bbc16c693344ddb" title="Change regular attributes.">do_attr_set</a>(env, dt, la, th);
<a name="l02264"></a>02264 }
<a name="l02265"></a>02265 
<a name="l02266"></a><a class="code" href="dt__object_8h.html#a34380baa784185a08efbb55e0100a73a">02266</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a34380baa784185a08efbb55e0100a73a">dt_declare_ref_add</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02267"></a>02267                                      <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02268"></a>02268 {
<a name="l02269"></a>02269         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02270"></a>02270         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02271"></a>02271         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a53431a1038b787ca15950b5a0495408b" title="Declare intention to increment nlink count.">do_declare_ref_add</a>);
<a name="l02272"></a>02272 
<a name="l02273"></a>02273         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a08ca66130d4a31fc3e45b35ad4963639">OBD_FAIL_DT_DECLARE_REF_ADD</a>))
<a name="l02274"></a>02274                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02275"></a>02275 
<a name="l02276"></a>02276         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a53431a1038b787ca15950b5a0495408b" title="Declare intention to increment nlink count.">do_declare_ref_add</a>(env, dt, th);
<a name="l02277"></a>02277 }
<a name="l02278"></a>02278 
<a name="l02279"></a><a class="code" href="dt__object_8h.html#ab65c7365c34e31e2574ca1d45ca23944">02279</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#ab65c7365c34e31e2574ca1d45ca23944">dt_ref_add</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02280"></a>02280                              <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02281"></a>02281 {
<a name="l02282"></a>02282         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02283"></a>02283         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02284"></a>02284         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a3ea43d6a7abb742fb238acc711b3bd2b" title="Increment nlink.">do_ref_add</a>);
<a name="l02285"></a>02285 
<a name="l02286"></a>02286         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a9ee869fea9f47cc3189a3a3242d11173">OBD_FAIL_DT_REF_ADD</a>))
<a name="l02287"></a>02287                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02288"></a>02288 
<a name="l02289"></a>02289         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a3ea43d6a7abb742fb238acc711b3bd2b" title="Increment nlink.">do_ref_add</a>(env, dt, th);
<a name="l02290"></a>02290 }
<a name="l02291"></a>02291 
<a name="l02292"></a><a class="code" href="dt__object_8h.html#a5e13fd713bdd532d2b6c1b56ade24b94">02292</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a5e13fd713bdd532d2b6c1b56ade24b94">dt_declare_ref_del</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02293"></a>02293                                      <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02294"></a>02294 {
<a name="l02295"></a>02295         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02296"></a>02296         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02297"></a>02297         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#ae33177c8da269d507a9b22b8066ae5f4" title="Declare intention to decrement nlink count.">do_declare_ref_del</a>);
<a name="l02298"></a>02298 
<a name="l02299"></a>02299         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a64023384248aa0a8fbaea4aba699385e">OBD_FAIL_DT_DECLARE_REF_DEL</a>))
<a name="l02300"></a>02300                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02301"></a>02301 
<a name="l02302"></a>02302         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#ae33177c8da269d507a9b22b8066ae5f4" title="Declare intention to decrement nlink count.">do_declare_ref_del</a>(env, dt, th);
<a name="l02303"></a>02303 }
<a name="l02304"></a>02304 
<a name="l02305"></a><a class="code" href="dt__object_8h.html#ada7db12649ed9e614a346ca193eb1078">02305</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#ada7db12649ed9e614a346ca193eb1078">dt_ref_del</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02306"></a>02306                              <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02307"></a>02307 {
<a name="l02308"></a>02308         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02309"></a>02309         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02310"></a>02310         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a8d0abf79c5dace1f0839aefe251bfc1f" title="Decrement nlink.">do_ref_del</a>);
<a name="l02311"></a>02311 
<a name="l02312"></a>02312         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a5c114c3841d5a14dc6dff44ba399d127">OBD_FAIL_DT_REF_DEL</a>))
<a name="l02313"></a>02313                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02314"></a>02314 
<a name="l02315"></a>02315         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a8d0abf79c5dace1f0839aefe251bfc1f" title="Decrement nlink.">do_ref_del</a>(env, dt, th);
<a name="l02316"></a>02316 }
<a name="l02317"></a>02317 
<a name="l02318"></a><a class="code" href="dt__object_8h.html#affee60e23ca22a258ef057c16504e046">02318</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#affee60e23ca22a258ef057c16504e046">dt_bufs_get</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *d,
<a name="l02319"></a>02319                               <span class="keyword">struct</span> <a class="code" href="structniobuf__remote.html">niobuf_remote</a> *rnb,
<a name="l02320"></a>02320                               <span class="keyword">struct</span> <a class="code" href="structniobuf__local.html">niobuf_local</a> *lnb, <span class="keywordtype">int</span> rw)
<a name="l02321"></a>02321 {
<a name="l02322"></a>02322         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d);
<a name="l02323"></a>02323         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>);
<a name="l02324"></a>02324         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#afe9f070ccbf102ca7d366a0d902216a7" title="Return buffers for data.">dbo_bufs_get</a>);
<a name="l02325"></a>02325         <span class="keywordflow">return</span> d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#afe9f070ccbf102ca7d366a0d902216a7" title="Return buffers for data.">dbo_bufs_get</a>(env, d, rnb-&gt;<a class="code" href="structniobuf__remote.html#af3d2780ccf8895eab786247d4f69418f">rnb_offset</a>,
<a name="l02326"></a>02326                                             rnb-&gt;<a class="code" href="structniobuf__remote.html#aa99016bb10a3ca18e16121bd181770fe">rnb_len</a>, lnb, rw);
<a name="l02327"></a>02327 }
<a name="l02328"></a>02328 
<a name="l02329"></a><a class="code" href="dt__object_8h.html#a34d928835818b2fcb7433080f1840c49">02329</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a34d928835818b2fcb7433080f1840c49">dt_bufs_put</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *d,
<a name="l02330"></a>02330                               <span class="keyword">struct</span> <a class="code" href="structniobuf__local.html">niobuf_local</a> *lnb, <span class="keywordtype">int</span> n)
<a name="l02331"></a>02331 {
<a name="l02332"></a>02332         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d);
<a name="l02333"></a>02333         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>);
<a name="l02334"></a>02334         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#aaa0f2da7b7271a358b9c1e3bfa4326e3" title="Release reference granted by -&amp;gt;dbo_bufs_get().">dbo_bufs_put</a>);
<a name="l02335"></a>02335         <span class="keywordflow">return</span> d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#aaa0f2da7b7271a358b9c1e3bfa4326e3" title="Release reference granted by -&amp;gt;dbo_bufs_get().">dbo_bufs_put</a>(env, d, lnb, n);
<a name="l02336"></a>02336 }
<a name="l02337"></a>02337 
<a name="l02338"></a><a class="code" href="dt__object_8h.html#ae4b2fef1453166b7c7ac8fc17c125836">02338</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#ae4b2fef1453166b7c7ac8fc17c125836">dt_write_prep</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *d,
<a name="l02339"></a>02339                                 <span class="keyword">struct</span> <a class="code" href="structniobuf__local.html">niobuf_local</a> *lnb, <span class="keywordtype">int</span> n)
<a name="l02340"></a>02340 {
<a name="l02341"></a>02341         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d);
<a name="l02342"></a>02342         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>);
<a name="l02343"></a>02343         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#ab941af8487086f964f8721de634b86b8" title="Prepare buffers for write.">dbo_write_prep</a>);
<a name="l02344"></a>02344         <span class="keywordflow">return</span> d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#ab941af8487086f964f8721de634b86b8" title="Prepare buffers for write.">dbo_write_prep</a>(env, d, lnb, n);
<a name="l02345"></a>02345 }
<a name="l02346"></a>02346 
<a name="l02347"></a><a class="code" href="dt__object_8h.html#ac9159e496701825788d1bddb77a8ce6a">02347</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#ac9159e496701825788d1bddb77a8ce6a">dt_declare_write_commit</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02348"></a>02348                                           <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *d,
<a name="l02349"></a>02349                                           <span class="keyword">struct</span> <a class="code" href="structniobuf__local.html">niobuf_local</a> *lnb,
<a name="l02350"></a>02350                                           <span class="keywordtype">int</span> n, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02351"></a>02351 {
<a name="l02352"></a>02352         <a class="code" href="utils_2wirehdr_8c.html#a2e063b87e63a187e8b2302ef6628b842">LASSERTF</a>(d != NULL, <span class="stringliteral">&quot;dt is NULL when we want to declare write\n&quot;</span>);
<a name="l02353"></a>02353         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(th != NULL);
<a name="l02354"></a>02354         <span class="keywordflow">return</span> d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#aaa2ba33b84fa7bdb6413e6f8347a1482" title="Declare intention to write data stored in the buffers.">dbo_declare_write_commit</a>(env, d, lnb, n, th);
<a name="l02355"></a>02355 }
<a name="l02356"></a>02356 
<a name="l02357"></a>02357 
<a name="l02358"></a><a class="code" href="dt__object_8h.html#af69b5d2929e1fa03190d6e40909ec355">02358</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#af69b5d2929e1fa03190d6e40909ec355">dt_write_commit</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02359"></a>02359                                   <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *d, <span class="keyword">struct</span> <a class="code" href="structniobuf__local.html">niobuf_local</a> *lnb,
<a name="l02360"></a>02360                                   <span class="keywordtype">int</span> n, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02361"></a>02361 {
<a name="l02362"></a>02362         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d);
<a name="l02363"></a>02363         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>);
<a name="l02364"></a>02364         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#ac44e84fe7124d965c379a6817e4dc8bc" title="Write to existing object.">dbo_write_commit</a>);
<a name="l02365"></a>02365         <span class="keywordflow">return</span> d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#ac44e84fe7124d965c379a6817e4dc8bc" title="Write to existing object.">dbo_write_commit</a>(env, d, lnb, n, th);
<a name="l02366"></a>02366 }
<a name="l02367"></a>02367 
<a name="l02368"></a><a class="code" href="dt__object_8h.html#a8c34dc02f28c80b4cb45c133f2cfd3ac">02368</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a8c34dc02f28c80b4cb45c133f2cfd3ac">dt_read_prep</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *d,
<a name="l02369"></a>02369                                <span class="keyword">struct</span> <a class="code" href="structniobuf__local.html">niobuf_local</a> *lnb, <span class="keywordtype">int</span> n)
<a name="l02370"></a>02370 {
<a name="l02371"></a>02371         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d);
<a name="l02372"></a>02372         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>);
<a name="l02373"></a>02373         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#a064a13169a793907c32faa01a657810a" title="Prepare buffers for reading.">dbo_read_prep</a>);
<a name="l02374"></a>02374         <span class="keywordflow">return</span> d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#a064a13169a793907c32faa01a657810a" title="Prepare buffers for reading.">dbo_read_prep</a>(env, d, lnb, n);
<a name="l02375"></a>02375 }
<a name="l02376"></a>02376 
<a name="l02377"></a><a class="code" href="dt__object_8h.html#ad05522dade5bddc2b2a9f71eb835c27f">02377</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#ad05522dade5bddc2b2a9f71eb835c27f">dt_declare_write</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02378"></a>02378                                    <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02379"></a>02379                                    <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>, loff_t pos,
<a name="l02380"></a>02380                                    <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02381"></a>02381 {
<a name="l02382"></a>02382         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02383"></a>02383         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>);
<a name="l02384"></a>02384         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#aa4d64d407e2b442c1e418fa9ca46ab44" title="Declare intention to write data to object.">dbo_declare_write</a>);
<a name="l02385"></a>02385         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#aa4d64d407e2b442c1e418fa9ca46ab44" title="Declare intention to write data to object.">dbo_declare_write</a>(env, dt, buf, pos, th);
<a name="l02386"></a>02386 }
<a name="l02387"></a>02387 
<a name="l02388"></a><a class="code" href="dt__object_8h.html#a58faef3cd7c829989defda992277e1f9">02388</a> <span class="keyword">static</span> <span class="keyword">inline</span> ssize_t <a class="code" href="dt__object_8h.html#a58faef3cd7c829989defda992277e1f9">dt_write</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02389"></a>02389                                <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>, loff_t *pos,
<a name="l02390"></a>02390                                <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th, <span class="keywordtype">int</span> rq)
<a name="l02391"></a>02391 {
<a name="l02392"></a>02392         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02393"></a>02393         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>);
<a name="l02394"></a>02394         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#a1d14bb3445892ab680cd8885645334bb" title="Write unstructured data to regular existing object.">dbo_write</a>);
<a name="l02395"></a>02395         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#a1d14bb3445892ab680cd8885645334bb" title="Write unstructured data to regular existing object.">dbo_write</a>(env, dt, buf, pos, th, rq);
<a name="l02396"></a>02396 }
<a name="l02397"></a>02397 
<a name="l02398"></a><a class="code" href="dt__object_8h.html#a4ec4a12adf1a3664c0e62954700ee705">02398</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a4ec4a12adf1a3664c0e62954700ee705">dt_declare_punch</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02399"></a>02399                                    <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>,
<a name="l02400"></a>02400                                    <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="mdsrate_8c.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02401"></a>02401 {
<a name="l02402"></a>02402         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02403"></a>02403         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>);
<a name="l02404"></a>02404         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#a814e0570b29ea97a47f9851e0f6bfc0c" title="Declare intention to deallocate space from an object.">dbo_declare_punch</a>);
<a name="l02405"></a>02405         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#a814e0570b29ea97a47f9851e0f6bfc0c" title="Declare intention to deallocate space from an object.">dbo_declare_punch</a>(env, dt, start, end, th);
<a name="l02406"></a>02406 }
<a name="l02407"></a>02407 
<a name="l02408"></a><a class="code" href="dt__object_8h.html#ab27f1d67a6786dc6cdcb782b2987ef6e">02408</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#ab27f1d67a6786dc6cdcb782b2987ef6e">dt_punch</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02409"></a>02409                            <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="mdsrate_8c.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02410"></a>02410 {
<a name="l02411"></a>02411         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02412"></a>02412         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>);
<a name="l02413"></a>02413         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#a3ee6232f042892134c6f2fead05ed2c4" title="Deallocate specified region in an object.">dbo_punch</a>);
<a name="l02414"></a>02414         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#a3ee6232f042892134c6f2fead05ed2c4" title="Deallocate specified region in an object.">dbo_punch</a>(env, dt, start, end, th);
<a name="l02415"></a>02415 }
<a name="l02416"></a>02416 
<a name="l02417"></a><a class="code" href="dt__object_8h.html#abb456cd35c2d6adf84506efd398a2e9e">02417</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#abb456cd35c2d6adf84506efd398a2e9e">dt_ladvise</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02418"></a>02418                              <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="mdsrate_8c.html#abce9f5dc9c83f2639b72024fdee5d388">end</a>, <span class="keywordtype">int</span> advice)
<a name="l02419"></a>02419 {
<a name="l02420"></a>02420         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02421"></a>02421         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>);
<a name="l02422"></a>02422         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#a5b1cd9fc446d73843de8c4e57475765e" title="Give advices on specified region in an object.">dbo_ladvise</a>);
<a name="l02423"></a>02423         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#a5b1cd9fc446d73843de8c4e57475765e" title="Give advices on specified region in an object.">dbo_ladvise</a>(env, dt, start, end, advice);
<a name="l02424"></a>02424 }
<a name="l02425"></a>02425 
<a name="l02426"></a><a class="code" href="dt__object_8h.html#a79f73d2ceaf4cd616efcd2b50f574c4b">02426</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a79f73d2ceaf4cd616efcd2b50f574c4b">dt_fiemap_get</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *d,
<a name="l02427"></a>02427                                 <span class="keyword">struct</span> fiemap *fm)
<a name="l02428"></a>02428 {
<a name="l02429"></a>02429         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(d);
<a name="l02430"></a>02430         <span class="keywordflow">if</span> (d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a> == NULL)
<a name="l02431"></a>02431                 <span class="keywordflow">return</span> -EPROTO;
<a name="l02432"></a>02432         <span class="keywordflow">if</span> (d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#afde6790a70f30800664044f1c627cb63" title="Return logical to physical block mapping for a given extent.">dbo_fiemap_get</a> == NULL)
<a name="l02433"></a>02433                 <span class="keywordflow">return</span> -EOPNOTSUPP;
<a name="l02434"></a>02434         <span class="keywordflow">return</span> d-&gt;<a class="code" href="structdt__object.html#aca6ad1a0115d20edb432a9f65e7efc9d">do_body_ops</a>-&gt;<a class="code" href="structdt__body__operations.html#afde6790a70f30800664044f1c627cb63" title="Return logical to physical block mapping for a given extent.">dbo_fiemap_get</a>(env, d, fm);
<a name="l02435"></a>02435 }
<a name="l02436"></a>02436 
<a name="l02437"></a><a class="code" href="dt__object_8h.html#aec3418b452f6c07238b56e17f2543c74">02437</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#aec3418b452f6c07238b56e17f2543c74">dt_statfs</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l02438"></a>02438                             <span class="keyword">struct</span> <a class="code" href="structobd__statfs.html">obd_statfs</a> *osfs)
<a name="l02439"></a>02439 {
<a name="l02440"></a>02440         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev);
<a name="l02441"></a>02441         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>);
<a name="l02442"></a>02442         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a5551db7b0deb0d6c07fc738552f445f7" title="Return device-wide statistics.">dt_statfs</a>);
<a name="l02443"></a>02443         <span class="keywordflow">return</span> dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a5551db7b0deb0d6c07fc738552f445f7" title="Return device-wide statistics.">dt_statfs</a>(env, dev, osfs);
<a name="l02444"></a>02444 }
<a name="l02445"></a>02445 
<a name="l02446"></a><a class="code" href="dt__object_8h.html#a1bc81474e559a2de8e124dad7980f2e0">02446</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a1bc81474e559a2de8e124dad7980f2e0">dt_root_get</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l02447"></a>02447                               <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *f)
<a name="l02448"></a>02448 {
<a name="l02449"></a>02449         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev);
<a name="l02450"></a>02450         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>);
<a name="l02451"></a>02451         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#ad2a831d38be0be73f8a5498112e13b56" title="Return FID of root index object.">dt_root_get</a>);
<a name="l02452"></a>02452         <span class="keywordflow">return</span> dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#ad2a831d38be0be73f8a5498112e13b56" title="Return FID of root index object.">dt_root_get</a>(env, dev, f);
<a name="l02453"></a>02453 }
<a name="l02454"></a>02454 
<a name="l02455"></a><a class="code" href="dt__object_8h.html#ad2be9d7337b25c5f874b5c25c2d344f2">02455</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="dt__object_8h.html#ad2be9d7337b25c5f874b5c25c2d344f2">dt_conf_get</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02456"></a>02456                                <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l02457"></a>02457                                <span class="keyword">struct</span> <a class="code" href="structdt__device__param.html">dt_device_param</a> *param)
<a name="l02458"></a>02458 {
<a name="l02459"></a>02459         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev);
<a name="l02460"></a>02460         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>);
<a name="l02461"></a>02461         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a652ff54fee6fbc7f4a5dda78befe5489" title="Return device configuration data.">dt_conf_get</a>);
<a name="l02462"></a>02462         <span class="keywordflow">return</span> dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a652ff54fee6fbc7f4a5dda78befe5489" title="Return device configuration data.">dt_conf_get</a>(env, dev, param);
<a name="l02463"></a>02463 }
<a name="l02464"></a>02464 
<a name="l02465"></a><a class="code" href="dt__object_8h.html#a801c2c4e9b160319fafa7d9ca6ff9151">02465</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a801c2c4e9b160319fafa7d9ca6ff9151">dt_sync</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev)
<a name="l02466"></a>02466 {
<a name="l02467"></a>02467         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev);
<a name="l02468"></a>02468         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>);
<a name="l02469"></a>02469         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#aff03760ef16c08ef22ecfcace4a7afb9" title="Sync the device.">dt_sync</a>);
<a name="l02470"></a>02470         <span class="keywordflow">return</span> dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#aff03760ef16c08ef22ecfcace4a7afb9" title="Sync the device.">dt_sync</a>(env, dev);
<a name="l02471"></a>02471 }
<a name="l02472"></a>02472 
<a name="l02473"></a><a class="code" href="dt__object_8h.html#a7b00e4275296052473174099380bf331">02473</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a7b00e4275296052473174099380bf331">dt_ro</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev)
<a name="l02474"></a>02474 {
<a name="l02475"></a>02475         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev);
<a name="l02476"></a>02476         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>);
<a name="l02477"></a>02477         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a03deb463a9aebe843829c31bbab1c34d" title="Make device read-only.">dt_ro</a>);
<a name="l02478"></a>02478         <span class="keywordflow">return</span> dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#a03deb463a9aebe843829c31bbab1c34d" title="Make device read-only.">dt_ro</a>(env, dev);
<a name="l02479"></a>02479 }
<a name="l02480"></a>02480 
<a name="l02481"></a><a class="code" href="dt__object_8h.html#aad613ebb9137c51eb3eb0db80392016b">02481</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#aad613ebb9137c51eb3eb0db80392016b">dt_declare_insert</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02482"></a>02482                                     <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02483"></a>02483                                     <span class="keyword">const</span> <span class="keyword">struct</span> dt_rec *rec,
<a name="l02484"></a>02484                                     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key,
<a name="l02485"></a>02485                                     <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02486"></a>02486 {
<a name="l02487"></a>02487         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02488"></a>02488         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>);
<a name="l02489"></a>02489         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>-&gt;<a class="code" href="structdt__index__operations.html#af077ea7c9f156cb161f9c361109e1f68" title="Declare intention to insert a key/value into an index.">dio_declare_insert</a>);
<a name="l02490"></a>02490 
<a name="l02491"></a>02491         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a4f052ad77c4a568b8a519826639c3995">OBD_FAIL_DT_DECLARE_INSERT</a>))
<a name="l02492"></a>02492                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02493"></a>02493 
<a name="l02494"></a>02494         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>-&gt;<a class="code" href="structdt__index__operations.html#af077ea7c9f156cb161f9c361109e1f68" title="Declare intention to insert a key/value into an index.">dio_declare_insert</a>(env, dt, rec, key, th);
<a name="l02495"></a>02495 }
<a name="l02496"></a>02496 
<a name="l02497"></a><a class="code" href="dt__object_8h.html#a898927faf127559ae0424269497dcec3">02497</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a898927faf127559ae0424269497dcec3">dt_insert</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02498"></a>02498                                     <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02499"></a>02499                                     <span class="keyword">const</span> <span class="keyword">struct</span> dt_rec *rec,
<a name="l02500"></a>02500                                     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key,
<a name="l02501"></a>02501                                     <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th,
<a name="l02502"></a>02502                                     <span class="keywordtype">int</span> noquota)
<a name="l02503"></a>02503 {
<a name="l02504"></a>02504         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02505"></a>02505         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>);
<a name="l02506"></a>02506         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>-&gt;<a class="code" href="structdt__index__operations.html#af1e0507f0ca4df0ed3f486bab027dbda" title="Insert a new key/value pair into an index.">dio_insert</a>);
<a name="l02507"></a>02507 
<a name="l02508"></a>02508         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a8fdf85f39ea8696b6c2e726a7306d721">OBD_FAIL_DT_INSERT</a>))
<a name="l02509"></a>02509                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02510"></a>02510 
<a name="l02511"></a>02511         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>-&gt;<a class="code" href="structdt__index__operations.html#af1e0507f0ca4df0ed3f486bab027dbda" title="Insert a new key/value pair into an index.">dio_insert</a>(env, dt, rec, key, th, noquota);
<a name="l02512"></a>02512 }
<a name="l02513"></a>02513 
<a name="l02514"></a><a class="code" href="dt__object_8h.html#a7f4e76ae4034e8c0dc779fbb0a25cfdc">02514</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a7f4e76ae4034e8c0dc779fbb0a25cfdc">dt_declare_xattr_del</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02515"></a>02515                                        <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02516"></a>02516                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,
<a name="l02517"></a>02517                                        <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02518"></a>02518 {
<a name="l02519"></a>02519         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02520"></a>02520         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02521"></a>02521         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a7b2e57f4c0bdb5108e9d1920242e813e" title="Declare intention to delete an extended attribute.">do_declare_xattr_del</a>);
<a name="l02522"></a>02522 
<a name="l02523"></a>02523         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#ad46aaecb533a3c3a8ce1bdf2dd561b40">OBD_FAIL_DT_DECLARE_XATTR_DEL</a>))
<a name="l02524"></a>02524                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02525"></a>02525 
<a name="l02526"></a>02526         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a7b2e57f4c0bdb5108e9d1920242e813e" title="Declare intention to delete an extended attribute.">do_declare_xattr_del</a>(env, dt, name, th);
<a name="l02527"></a>02527 }
<a name="l02528"></a>02528 
<a name="l02529"></a><a class="code" href="dt__object_8h.html#a340e7a1f66bb180a5e77efb4ee51fc77">02529</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a340e7a1f66bb180a5e77efb4ee51fc77">dt_xattr_del</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02530"></a>02530                                <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,
<a name="l02531"></a>02531                                <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02532"></a>02532 {
<a name="l02533"></a>02533         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02534"></a>02534         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02535"></a>02535         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a19762fb1d9e75136521019d51759b6ec" title="Delete an extended attribute.">do_xattr_del</a>);
<a name="l02536"></a>02536 
<a name="l02537"></a>02537         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#adc9373074fd597f7638e802fa30be7e8">OBD_FAIL_DT_XATTR_DEL</a>))
<a name="l02538"></a>02538                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02539"></a>02539 
<a name="l02540"></a>02540         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a19762fb1d9e75136521019d51759b6ec" title="Delete an extended attribute.">do_xattr_del</a>(env, dt, name, th);
<a name="l02541"></a>02541 }
<a name="l02542"></a>02542 
<a name="l02543"></a><a class="code" href="dt__object_8h.html#aa3e830f46507a33a5bd2b4da4cae897e">02543</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#aa3e830f46507a33a5bd2b4da4cae897e">dt_declare_xattr_set</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02544"></a>02544                                       <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02545"></a>02545                                       <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l02546"></a>02546                                       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="keywordtype">int</span> fl,
<a name="l02547"></a>02547                                       <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02548"></a>02548 {
<a name="l02549"></a>02549         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02550"></a>02550         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02551"></a>02551         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#ad5d602fce101080720544cbdb0de96e8" title="Declare intention to change an extended attribute.">do_declare_xattr_set</a>);
<a name="l02552"></a>02552 
<a name="l02553"></a>02553         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a12fd5f4889dc6a121fe1d140f5f649ca">OBD_FAIL_DT_DECLARE_XATTR_SET</a>))
<a name="l02554"></a>02554                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02555"></a>02555 
<a name="l02556"></a>02556         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#ad5d602fce101080720544cbdb0de96e8" title="Declare intention to change an extended attribute.">do_declare_xattr_set</a>(env, dt, buf, name, fl, th);
<a name="l02557"></a>02557 }
<a name="l02558"></a>02558 
<a name="l02559"></a><a class="code" href="dt__object_8h.html#a785cbfe4260ad618bc774c809cc80d93">02559</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a785cbfe4260ad618bc774c809cc80d93">dt_xattr_set</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02560"></a>02560                                <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l02561"></a>02561                                <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="keywordtype">int</span> fl, <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02562"></a>02562 {
<a name="l02563"></a>02563         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02564"></a>02564         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02565"></a>02565         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a231db7d512a5786b8ad887e9fc47190b" title="Set an extended attribute.">do_xattr_set</a>);
<a name="l02566"></a>02566 
<a name="l02567"></a>02567         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a37414cc0a1e9037deb795d42cb128e98">OBD_FAIL_DT_XATTR_SET</a>))
<a name="l02568"></a>02568                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02569"></a>02569 
<a name="l02570"></a>02570         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a231db7d512a5786b8ad887e9fc47190b" title="Set an extended attribute.">do_xattr_set</a>(env, dt, buf, name, fl, th);
<a name="l02571"></a>02571 }
<a name="l02572"></a>02572 
<a name="l02573"></a><a class="code" href="dt__object_8h.html#aeb3272e31bc33b33956583e813dcae52">02573</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#aeb3272e31bc33b33956583e813dcae52">dt_declare_xattr_get</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02574"></a>02574                                        <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02575"></a>02575                                        <span class="keyword">struct</span> <a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l02576"></a>02576                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)
<a name="l02577"></a>02577 {
<a name="l02578"></a>02578         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02579"></a>02579         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02580"></a>02580         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a2032c927c95147729dd7a7247c5c12aa" title="Declare intention to request extented attribute.">do_declare_xattr_get</a>);
<a name="l02581"></a>02581 
<a name="l02582"></a>02582         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a72c651621dffd22709b6a0303406ad8b">OBD_FAIL_DT_DECLARE_XATTR_GET</a>))
<a name="l02583"></a>02583                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02584"></a>02584 
<a name="l02585"></a>02585         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a2032c927c95147729dd7a7247c5c12aa" title="Declare intention to request extented attribute.">do_declare_xattr_get</a>(env, dt, buf, name);
<a name="l02586"></a>02586 }
<a name="l02587"></a>02587 
<a name="l02588"></a><a class="code" href="dt__object_8h.html#a5337413bbd4d9e484225c6ba1491d1b1">02588</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a5337413bbd4d9e484225c6ba1491d1b1">dt_xattr_get</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02589"></a>02589                                <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt, <span class="keyword">struct</span> <a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>,
<a name="l02590"></a>02590                                <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)
<a name="l02591"></a>02591 {
<a name="l02592"></a>02592         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02593"></a>02593         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02594"></a>02594         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#af4c8c504e52a5571dbd0557980c3818a" title="Return a value of an extended attribute.">do_xattr_get</a>);
<a name="l02595"></a>02595 
<a name="l02596"></a>02596         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a4e24a0f6e0debbe59dc474a62ac2ea17">OBD_FAIL_DT_XATTR_GET</a>))
<a name="l02597"></a>02597                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02598"></a>02598 
<a name="l02599"></a>02599         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#af4c8c504e52a5571dbd0557980c3818a" title="Return a value of an extended attribute.">do_xattr_get</a>(env, dt, buf, name);
<a name="l02600"></a>02600 }
<a name="l02601"></a>02601 
<a name="l02602"></a><a class="code" href="dt__object_8h.html#a89898fc79849c86a04d899dfe83645ad">02602</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a89898fc79849c86a04d899dfe83645ad">dt_xattr_list</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02603"></a>02603                                 <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>)
<a name="l02604"></a>02604 {
<a name="l02605"></a>02605         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02606"></a>02606         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>);
<a name="l02607"></a>02607         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a0ace7a9f2e3ae94bb5d5b7434917f0f1" title="Return a list of the extended attributes.">do_xattr_list</a>);
<a name="l02608"></a>02608 
<a name="l02609"></a>02609         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a73d1321d4a6922666feea429599b1e72">OBD_FAIL_DT_XATTR_LIST</a>))
<a name="l02610"></a>02610                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02611"></a>02611 
<a name="l02612"></a>02612         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#af3bc1791ee2f212794bf7fafccc66d1c">do_ops</a>-&gt;<a class="code" href="structdt__object__operations.html#a0ace7a9f2e3ae94bb5d5b7434917f0f1" title="Return a list of the extended attributes.">do_xattr_list</a>(env, dt, buf);
<a name="l02613"></a>02613 }
<a name="l02614"></a>02614 
<a name="l02615"></a><a class="code" href="dt__object_8h.html#afdd965022a0454ff1bc05aefef18ffe1">02615</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#afdd965022a0454ff1bc05aefef18ffe1">dt_declare_delete</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02616"></a>02616                                     <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02617"></a>02617                                     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key,
<a name="l02618"></a>02618                                     <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02619"></a>02619 {
<a name="l02620"></a>02620         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02621"></a>02621         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>);
<a name="l02622"></a>02622         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>-&gt;<a class="code" href="structdt__index__operations.html#aa25f7e5f60a5b9055e3f9b0898b2888b" title="Declare intention to delete a key/value from an index.">dio_declare_delete</a>);
<a name="l02623"></a>02623 
<a name="l02624"></a>02624         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#acb8026da4445d03ed975364af052d23b">OBD_FAIL_DT_DECLARE_DELETE</a>))
<a name="l02625"></a>02625                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02626"></a>02626 
<a name="l02627"></a>02627         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>-&gt;<a class="code" href="structdt__index__operations.html#aa25f7e5f60a5b9055e3f9b0898b2888b" title="Declare intention to delete a key/value from an index.">dio_declare_delete</a>(env, dt, key, th);
<a name="l02628"></a>02628 }
<a name="l02629"></a>02629 
<a name="l02630"></a><a class="code" href="dt__object_8h.html#a66f11a38ecd740607e9bbc142800ba75">02630</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a66f11a38ecd740607e9bbc142800ba75">dt_delete</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02631"></a>02631                             <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02632"></a>02632                             <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key,
<a name="l02633"></a>02633                             <span class="keyword">struct</span> <a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th)
<a name="l02634"></a>02634 {
<a name="l02635"></a>02635         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02636"></a>02636         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>);
<a name="l02637"></a>02637         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>-&gt;<a class="code" href="structdt__index__operations.html#abe3c3c85ed6a910700306482ba8fcd0d" title="Delete key/value pair from an index.">dio_delete</a>);
<a name="l02638"></a>02638 
<a name="l02639"></a>02639         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a89f24892ffd19b8a3498f02f054db067">OBD_FAIL_DT_DELETE</a>))
<a name="l02640"></a>02640                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02641"></a>02641 
<a name="l02642"></a>02642         <span class="keywordflow">return</span> dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>-&gt;<a class="code" href="structdt__index__operations.html#abe3c3c85ed6a910700306482ba8fcd0d" title="Delete key/value pair from an index.">dio_delete</a>(env, dt, key, th);
<a name="l02643"></a>02643 }
<a name="l02644"></a>02644 
<a name="l02645"></a><a class="code" href="dt__object_8h.html#a3e734f78d4e8c857ff4b2223d94f6dfb">02645</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a3e734f78d4e8c857ff4b2223d94f6dfb">dt_commit_async</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02646"></a>02646                                   <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev)
<a name="l02647"></a>02647 {
<a name="l02648"></a>02648         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev);
<a name="l02649"></a>02649         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>);
<a name="l02650"></a>02650         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#ab811b4bbba68f4edcab228e8d9f52d3c" title="Start transaction commit asynchronously.">dt_commit_async</a>);
<a name="l02651"></a>02651         <span class="keywordflow">return</span> dev-&gt;<a class="code" href="structdt__device.html#a8ad1ad1f53426c3b80d39207588b403a">dd_ops</a>-&gt;<a class="code" href="structdt__device__operations.html#ab811b4bbba68f4edcab228e8d9f52d3c" title="Start transaction commit asynchronously.">dt_commit_async</a>(env, dev);
<a name="l02652"></a>02652 }
<a name="l02653"></a>02653 
<a name="l02654"></a><a class="code" href="dt__object_8h.html#a9e343f3b5c4451c22a3793a7a12266a9">02654</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a9e343f3b5c4451c22a3793a7a12266a9">dt_lookup</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l02655"></a>02655                             <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *dt,
<a name="l02656"></a>02656                             <span class="keyword">struct</span> dt_rec *rec,
<a name="l02657"></a>02657                             <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key)
<a name="l02658"></a>02658 {
<a name="l02659"></a>02659         <span class="keywordtype">int</span> <a class="code" href="utils_2wirehdr_8c.html#a6baa346e44f4c2158d2be4f9b77b8203">ret</a>;
<a name="l02660"></a>02660 
<a name="l02661"></a>02661         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt);
<a name="l02662"></a>02662         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>);
<a name="l02663"></a>02663         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>-&gt;<a class="code" href="structdt__index__operations.html#aab6a7632adfce2297c022b12f0d61791" title="Lookup in an index by key.">dio_lookup</a>);
<a name="l02664"></a>02664 
<a name="l02665"></a>02665         <span class="keywordflow">if</span> (<a class="code" href="libcfs__fail_8h.html#a610578abc23b2b295dcb21e2fa5885d5">CFS_FAULT_CHECK</a>(<a class="code" href="obd__support_8h.html#a249080ba896f8309bd94bb88537d5334">OBD_FAIL_DT_LOOKUP</a>))
<a name="l02666"></a>02666                 <span class="keywordflow">return</span> <a class="code" href="libcfs__fail_8h.html#a59a269d102c99f2e70a0832fd941d417">cfs_fail_err</a>;
<a name="l02667"></a>02667 
<a name="l02668"></a>02668         ret = dt-&gt;<a class="code" href="structdt__object.html#a21906ed22430634d75c0037dac1d47a1">do_index_ops</a>-&gt;<a class="code" href="structdt__index__operations.html#aab6a7632adfce2297c022b12f0d61791" title="Lookup in an index by key.">dio_lookup</a>(env, dt, rec, key);
<a name="l02669"></a>02669         <span class="keywordflow">if</span> (ret &gt; 0)
<a name="l02670"></a>02670                 ret = 0;
<a name="l02671"></a>02671         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == 0)
<a name="l02672"></a>02672                 ret = -ENOENT;
<a name="l02673"></a>02673         <span class="keywordflow">return</span> ret;
<a name="l02674"></a>02674 }
<a name="l02675"></a>02675 
<a name="l02676"></a><a class="code" href="structdt__find__hint.html">02676</a> <span class="keyword">struct </span><a class="code" href="structdt__find__hint.html">dt_find_hint</a> {
<a name="l02677"></a><a class="code" href="structdt__find__hint.html#a3e275cb246a7e2f46f0ac0dbeadbf4ad">02677</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>        *<a class="code" href="structdt__find__hint.html#a3e275cb246a7e2f46f0ac0dbeadbf4ad">dfh_fid</a>;
<a name="l02678"></a><a class="code" href="structdt__find__hint.html#af79bab4a0686ee6aec0034af92c4b79a">02678</a>         <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a>     *<a class="code" href="structdt__find__hint.html#af79bab4a0686ee6aec0034af92c4b79a">dfh_dt</a>;
<a name="l02679"></a><a class="code" href="structdt__find__hint.html#af6d8d5802d4003b2b91598301c83369e">02679</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>     *<a class="code" href="structdt__find__hint.html#af6d8d5802d4003b2b91598301c83369e">dfh_o</a>;
<a name="l02680"></a>02680 };
<a name="l02681"></a>02681 
<a name="l02682"></a><a class="code" href="structdt__insert__rec.html">02682</a> <span class="keyword">struct </span><a class="code" href="structdt__insert__rec.html">dt_insert_rec</a> {
<a name="l02683"></a>02683         <span class="keyword">union </span>{
<a name="l02684"></a><a class="code" href="structdt__insert__rec.html#a248b6f944adb19db965a8107130bc120">02684</a>                 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>     *<a class="code" href="structdt__insert__rec.html#a248b6f944adb19db965a8107130bc120">rec_fid</a>;
<a name="l02685"></a><a class="code" href="structdt__insert__rec.html#a6d7555afa52a22ee1356487ce71a265e">02685</a>                 <span class="keywordtype">void</span>                    *<a class="code" href="structdt__insert__rec.html#a6d7555afa52a22ee1356487ce71a265e">rec_data</a>;
<a name="l02686"></a>02686         };
<a name="l02687"></a>02687         <span class="keyword">union </span>{
<a name="l02688"></a>02688                 <span class="keyword">struct </span>{
<a name="l02689"></a><a class="code" href="structdt__insert__rec.html#a97c41340c3d91b4b6b2e85dd143d41b7">02689</a>                         __u32            <a class="code" href="structdt__insert__rec.html#a97c41340c3d91b4b6b2e85dd143d41b7">rec_type</a>;
<a name="l02690"></a><a class="code" href="structdt__insert__rec.html#add73ee74e5249b6f245d01dbd6009d28">02690</a>                         __u32            <a class="code" href="structdt__insert__rec.html#add73ee74e5249b6f245d01dbd6009d28">rec_padding</a>;
<a name="l02691"></a>02691                 };
<a name="l02692"></a><a class="code" href="structdt__insert__rec.html#ab07a1c454cd628e0fadef613c91ce787">02692</a>                 <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                    <a class="code" href="structdt__insert__rec.html#ab07a1c454cd628e0fadef613c91ce787">rec_misc</a>;
<a name="l02693"></a>02693         };
<a name="l02694"></a>02694 };
<a name="l02695"></a>02695 
<a name="l02696"></a><a class="code" href="structdt__thread__info.html">02696</a> <span class="keyword">struct </span><a class="code" href="structdt__thread__info.html">dt_thread_info</a> {
<a name="l02697"></a><a class="code" href="structdt__thread__info.html#a732b6c97c09cde11bd96f3f252ca5640">02697</a>         <span class="keywordtype">char</span>                     <a class="code" href="structdt__thread__info.html#a732b6c97c09cde11bd96f3f252ca5640">dti_buf</a>[<a class="code" href="group__dt.html#ga60515ba68b99bab0f304687ea2fc45f5">DT_MAX_PATH</a>];
<a name="l02698"></a><a class="code" href="structdt__thread__info.html#ad667393f1db32e24d19b855841d9d55c">02698</a>         <span class="keyword">struct </span><a class="code" href="structdt__find__hint.html">dt_find_hint</a>      <a class="code" href="structdt__thread__info.html#ad667393f1db32e24d19b855841d9d55c">dti_dfh</a>;
<a name="l02699"></a><a class="code" href="structdt__thread__info.html#a06a06e4a94ac73cf1e4cfcf0f3eaf644">02699</a>         <span class="keyword">struct </span><a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a>           <a class="code" href="structdt__thread__info.html#a06a06e4a94ac73cf1e4cfcf0f3eaf644">dti_attr</a>;
<a name="l02700"></a><a class="code" href="structdt__thread__info.html#a26eec3b757b667a27835b57aab87f5f2">02700</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>            <a class="code" href="structdt__thread__info.html#a26eec3b757b667a27835b57aab87f5f2">dti_fid</a>;
<a name="l02701"></a><a class="code" href="structdt__thread__info.html#adf53f7656f019b0231bd354af6093a99">02701</a>         <span class="keyword">struct </span><a class="code" href="structdt__object__format.html" title="object format specifier.">dt_object_format</a>  <a class="code" href="structdt__thread__info.html#adf53f7656f019b0231bd354af6093a99">dti_dof</a>;
<a name="l02702"></a><a class="code" href="structdt__thread__info.html#af9c13fba6a64127c42723fe08aabe999">02702</a>         <span class="keyword">struct </span><a class="code" href="structlustre__mdt__attrs.html" title="Following struct for object attributes, that will be kept inode&amp;#39;s EA.">lustre_mdt_attrs</a>  <a class="code" href="structdt__thread__info.html#af9c13fba6a64127c42723fe08aabe999">dti_lma</a>;
<a name="l02703"></a><a class="code" href="structdt__thread__info.html#aa823b7b356487380f30bbef20a4a57a9">02703</a>         <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a>            <a class="code" href="structdt__thread__info.html#aa823b7b356487380f30bbef20a4a57a9">dti_lb</a>;
<a name="l02704"></a><a class="code" href="structdt__thread__info.html#a51359b12a08fff6128a4cb7ff55ab2a4">02704</a>         <span class="keyword">struct </span><a class="code" href="structlu__object__conf.html" title="Object configuration, describing particulars of object being created.">lu_object_conf</a>    <a class="code" href="structdt__thread__info.html#a51359b12a08fff6128a4cb7ff55ab2a4">dti_conf</a>;
<a name="l02705"></a><a class="code" href="structdt__thread__info.html#a626883379f3c77e3d1ad2a07ac8984c4">02705</a>         loff_t                   <a class="code" href="structdt__thread__info.html#a626883379f3c77e3d1ad2a07ac8984c4">dti_off</a>;
<a name="l02706"></a><a class="code" href="structdt__thread__info.html#ab21dd927ad151a22db546f47b023ff99">02706</a>         <span class="keyword">struct </span><a class="code" href="structdt__insert__rec.html">dt_insert_rec</a>     <a class="code" href="structdt__thread__info.html#ab21dd927ad151a22db546f47b023ff99">dti_dt_rec</a>;
<a name="l02707"></a>02707 };
<a name="l02708"></a>02708 
<a name="l02709"></a>02709 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structlu__context__key.html" title="Key.">lu_context_key</a> <a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a>;
<a name="l02710"></a>02710 
<a name="l02711"></a><a class="code" href="dt__object_8h.html#aa1acd4d49eddf7103b6345cab44e1419">02711</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__thread__info.html">dt_thread_info</a> *<a class="code" href="dt__object_8h.html#aa1acd4d49eddf7103b6345cab44e1419">dt_info</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env)
<a name="l02712"></a>02712 {
<a name="l02713"></a>02713         <span class="keyword">struct </span><a class="code" href="structdt__thread__info.html">dt_thread_info</a> *dti;
<a name="l02714"></a>02714 
<a name="l02715"></a>02715         dti = <a class="code" href="group__lu.html#ga8fcebe57d8fb288a73a39144693074af" title="Return value associated with key key in context ctx.">lu_context_key_get</a>(&amp;env-&gt;<a class="code" href="structlu__env.html#a8c3e54a599d9514dce7868eab34e411d" title="&amp;quot;Local&amp;quot; context, used to store data instead of stack.">le_ctx</a>, &amp;<a class="code" href="dt__object_8h.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a>);
<a name="l02716"></a>02716         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(dti);
<a name="l02717"></a>02717         <span class="keywordflow">return</span> dti;
<a name="l02718"></a>02718 }
<a name="l02719"></a>02719 
<a name="l02720"></a>02720 <span class="keywordtype">int</span> <a class="code" href="dt__object_8h.html#a175e0911b2c1e6fe83230c797b6b515c">dt_global_init</a>(<span class="keywordtype">void</span>);
<a name="l02721"></a>02721 <span class="keywordtype">void</span> <a class="code" href="dt__object_8h.html#abe9d41bc56ed121508656982e7d0ff97">dt_global_fini</a>(<span class="keywordtype">void</span>);
<a name="l02722"></a>02722 
<a name="l02723"></a>02723 <span class="preprocessor"># ifdef CONFIG_PROC_FS</span>
<a name="l02724"></a>02724 <span class="preprocessor"></span><span class="keywordtype">int</span> lprocfs_dt_blksize_seq_show(<span class="keyword">struct</span> seq_file *m, <span class="keywordtype">void</span> *v);
<a name="l02725"></a>02725 <span class="keywordtype">int</span> lprocfs_dt_kbytestotal_seq_show(<span class="keyword">struct</span> seq_file *m, <span class="keywordtype">void</span> *v);
<a name="l02726"></a>02726 <span class="keywordtype">int</span> lprocfs_dt_kbytesfree_seq_show(<span class="keyword">struct</span> seq_file *m, <span class="keywordtype">void</span> *v);
<a name="l02727"></a>02727 <span class="keywordtype">int</span> lprocfs_dt_kbytesavail_seq_show(<span class="keyword">struct</span> seq_file *m, <span class="keywordtype">void</span> *v);
<a name="l02728"></a>02728 <span class="keywordtype">int</span> lprocfs_dt_filestotal_seq_show(<span class="keyword">struct</span> seq_file *m, <span class="keywordtype">void</span> *v);
<a name="l02729"></a>02729 <span class="keywordtype">int</span> lprocfs_dt_filesfree_seq_show(<span class="keyword">struct</span> seq_file *m, <span class="keywordtype">void</span> *v);
<a name="l02730"></a>02730 <span class="preprocessor"># endif </span><span class="comment">/* CONFIG_PROC_FS */</span>
<a name="l02731"></a>02731 
<a name="l02732"></a>02732 <span class="preprocessor">#endif </span><span class="comment">/* __LUSTRE_DT_OBJECT_H */</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:35 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
