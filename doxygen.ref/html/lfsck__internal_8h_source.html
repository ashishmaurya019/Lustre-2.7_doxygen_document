<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/lfsck/lfsck_internal.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>lustre/lfsck/lfsck_internal.h</h1><a href="lfsck__internal_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * GPL HEADER START</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> * it under the terms of the GNU General Public License version 2 only,</span>
<a name="l00008"></a>00008 <span class="comment"> * as published by the Free Software Foundation.</span>
<a name="l00009"></a>00009 <span class="comment"></span>
<a name="l00010"></a>00010 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00013"></a>00013 <span class="comment"> * GNU General Public License version 2 for more details.  A copy is</span>
<a name="l00014"></a>00014 <span class="comment"> * included in the COPYING file that accompanied this code.</span>
<a name="l00015"></a>00015 <span class="comment"></span>
<a name="l00016"></a>00016 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> * along with this program; if not, write to the Free Software</span>
<a name="l00018"></a>00018 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * GPL HEADER END</span>
<a name="l00021"></a>00021 <span class="comment"> */</span>
<a name="l00022"></a>00022 <span class="comment">/*</span>
<a name="l00023"></a>00023 <span class="comment"> * Copyright (c) 2013, 2015, Intel Corporation.</span>
<a name="l00024"></a>00024 <span class="comment"> */</span>
<a name="l00025"></a>00025 <span class="comment">/*</span>
<a name="l00026"></a>00026 <span class="comment"> * lustre/lfsck/lfsck_internal.h</span>
<a name="l00027"></a>00027 <span class="comment"> *</span>
<a name="l00028"></a>00028 <span class="comment"> * Shared definitions and declarations for the LFSCK.</span>
<a name="l00029"></a>00029 <span class="comment"> *</span>
<a name="l00030"></a>00030 <span class="comment"> * Author: Fan, Yong &lt;fan.yong@intel.com&gt;</span>
<a name="l00031"></a>00031 <span class="comment"> */</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="preprocessor">#ifndef _LFSCK_INTERNAL_H</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span><span class="preprocessor"># define _LFSCK_INTERNAL_H</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="lustre__lfsck__user_8h.html">lustre/lustre_lfsck_user.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="lustre__user_8h.html">lustre/lustre_user.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="lustre__idl_8h.html">lustre/lustre_idl.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="lustre__lfsck_8h.html">lustre_lfsck.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="obd_8h.html">obd.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="lu__object_8h.html">lu_object.h</a>&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;<a class="code" href="dt__object_8h.html">dt_object.h</a>&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="md__object_8h.html">md_object.h</a>&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;<a class="code" href="lustre__net_8h.html">lustre_net.h</a>&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;<a class="code" href="lustre__dlm_8h.html">lustre_dlm.h</a>&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;<a class="code" href="lustre__fid_8h.html">lustre_fid.h</a>&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;<a class="code" href="md__object_8h.html">md_object.h</a>&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;<a class="code" href="lustre__linkea_8h.html">lustre_linkea.h</a>&gt;</span>
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="lfsck__internal_8h.html#a605192d3013ba4d5780ab2667429d973">00050</a> <span class="preprocessor">#define HALF_SEC                        msecs_to_jiffies(MSEC_PER_SEC &gt;&gt; 1)</span>
<a name="l00051"></a><a class="code" href="lfsck__internal_8h.html#a50380623f4d7d0d30f1b61b2e71ee2fc">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define LFSCK_CHECKPOINT_INTERVAL       60</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span>
<a name="l00053"></a><a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861">00053</a> <span class="keyword">enum</span> <a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861">lfsck_flags</a> {
<a name="l00054"></a>00054         <span class="comment">/* Finish the first cycle scanning. */</span>
<a name="l00055"></a><a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861a0ee0038a37509ab7cc245875f4e9d177">00055</a>         <a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861a0ee0038a37509ab7cc245875f4e9d177">LF_SCANNED_ONCE</a>         = 0x00000001ULL,
<a name="l00056"></a>00056 
<a name="l00057"></a>00057         <span class="comment">/* There is some namespace inconsistency. */</span>
<a name="l00058"></a><a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861a8ecf74bf87e893a2b338bc5cf22db252">00058</a>         <a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861a8ecf74bf87e893a2b338bc5cf22db252">LF_INCONSISTENT</a>         = 0x00000002ULL,
<a name="l00059"></a>00059 
<a name="l00060"></a>00060         <span class="comment">/* The device is upgraded from 1.8 format. */</span>
<a name="l00061"></a><a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861a3c3b07f5a6924934a0fd8e086b061878">00061</a>         <a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861a3c3b07f5a6924934a0fd8e086b061878">LF_UPGRADE</a>              = 0x00000004ULL,
<a name="l00062"></a>00062 
<a name="l00063"></a>00063         <span class="comment">/* The server ever restarted during the LFSCK, and may miss to process</span>
<a name="l00064"></a>00064 <span class="comment">         * some objects check/repair. */</span>
<a name="l00065"></a><a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861ae11da1b86ed6b9769a9903a393d0a22d">00065</a>         <a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861ae11da1b86ed6b9769a9903a393d0a22d">LF_INCOMPLETE</a>           = 0x00000008ULL,
<a name="l00066"></a>00066 
<a name="l00067"></a>00067         <span class="comment">/* The LAST_ID (file) crashed. */</span>
<a name="l00068"></a><a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861ae8f41f5d1bee4e29af859304b0b0ffc4">00068</a>         <a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861ae8f41f5d1bee4e29af859304b0b0ffc4">LF_CRASHED_LASTID</a>       = 0x00000010ULL,
<a name="l00069"></a>00069 };
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="structlfsck__position.html">00071</a> <span class="keyword">struct </span><a class="code" href="structlfsck__position.html">lfsck_position</a> {
<a name="l00072"></a>00072         <span class="comment">/* low layer object table-based iteration position. */</span>
<a name="l00073"></a><a class="code" href="structlfsck__position.html#ae6b914c8af295fe0812dd0cd39b2a458">00073</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__position.html#ae6b914c8af295fe0812dd0cd39b2a458">lp_oit_cookie</a>;
<a name="l00074"></a>00074 
<a name="l00075"></a>00075         <span class="comment">/* parent FID for directory traversal. */</span>
<a name="l00076"></a><a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">00076</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> <a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>;
<a name="l00077"></a>00077 
<a name="l00078"></a>00078         <span class="comment">/* namespace-based directory traversal position. */</span>
<a name="l00079"></a><a class="code" href="structlfsck__position.html#acd2bb99422eff4ef3d3c794e27be51ed">00079</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__position.html#acd2bb99422eff4ef3d3c794e27be51ed">lp_dir_cookie</a>;
<a name="l00080"></a>00080 };
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="structlfsck__bookmark.html">00082</a> <span class="keyword">struct </span><a class="code" href="structlfsck__bookmark.html">lfsck_bookmark</a> {
<a name="l00083"></a>00083         <span class="comment">/* Magic number to detect that this struct contains valid data. */</span>
<a name="l00084"></a><a class="code" href="structlfsck__bookmark.html#a663fa2c872906aecb4ff39dbffd0e8b0">00084</a>         __u32   <a class="code" href="structlfsck__bookmark.html#a663fa2c872906aecb4ff39dbffd0e8b0">lb_magic</a>;
<a name="l00085"></a>00085 
<a name="l00086"></a>00086         <span class="comment">/* For compatible with old versions. */</span>
<a name="l00087"></a><a class="code" href="structlfsck__bookmark.html#a63d0db289443abdfdb715f0fb1c8fc00">00087</a>         __u16   <a class="code" href="structlfsck__bookmark.html#a63d0db289443abdfdb715f0fb1c8fc00">lb_version</a>;
<a name="l00088"></a>00088 
<a name="l00089"></a>00089         <span class="comment">/* See &apos;enum lfsck_param_flags&apos; */</span>
<a name="l00090"></a><a class="code" href="structlfsck__bookmark.html#a799266f76cf6efb04a0b0977ee9d961d">00090</a>         __u16   <a class="code" href="structlfsck__bookmark.html#a799266f76cf6efb04a0b0977ee9d961d">lb_param</a>;
<a name="l00091"></a>00091 
<a name="l00092"></a>00092         <span class="comment">/* How many items can be scanned at most per second. */</span>
<a name="l00093"></a><a class="code" href="structlfsck__bookmark.html#a871ba57b68af48ab359230fd654b54ad">00093</a>         __u32   <a class="code" href="structlfsck__bookmark.html#a871ba57b68af48ab359230fd654b54ad">lb_speed_limit</a>;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095         <span class="comment">/* The windows size for async requests pipeline. */</span>
<a name="l00096"></a><a class="code" href="structlfsck__bookmark.html#ab51815777dcc1670a052c4c7ece92449">00096</a>         __u16   <a class="code" href="structlfsck__bookmark.html#ab51815777dcc1670a052c4c7ece92449">lb_async_windows</a>;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098         <span class="comment">/* For 64-bits aligned. */</span>
<a name="l00099"></a><a class="code" href="structlfsck__bookmark.html#a460eddb738cef51bc0f0023fce63d093">00099</a>         __u16   <a class="code" href="structlfsck__bookmark.html#a460eddb738cef51bc0f0023fce63d093">lb_padding</a>;
<a name="l00100"></a>00100 
<a name="l00101"></a>00101         <span class="comment">/* The FID for .lustre/lost+found/MDTxxxx */</span>
<a name="l00102"></a><a class="code" href="structlfsck__bookmark.html#a120bfdce56a8c5c8976ccb3f2ec8b0ce">00102</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>   <a class="code" href="structlfsck__bookmark.html#a120bfdce56a8c5c8976ccb3f2ec8b0ce">lb_lpf_fid</a>;
<a name="l00103"></a>00103 
<a name="l00104"></a>00104         <span class="comment">/* The FID for the last MDT-object created by the LFSCK repairing. */</span>
<a name="l00105"></a><a class="code" href="structlfsck__bookmark.html#a102e1470b1950e9d5cfc26f0d4f9a2bd">00105</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>   <a class="code" href="structlfsck__bookmark.html#a102e1470b1950e9d5cfc26f0d4f9a2bd">lb_last_fid</a>;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107         <span class="comment">/* For future using. */</span>
<a name="l00108"></a><a class="code" href="structlfsck__bookmark.html#a47a5adb3c9c21032494613535beefdd8">00108</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__bookmark.html#a47a5adb3c9c21032494613535beefdd8">lb_reserved</a>[2];
<a name="l00109"></a>00109 };
<a name="l00110"></a>00110 
<a name="l00111"></a><a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3">00111</a> <span class="keyword">enum</span> <a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3">lfsck_namespace_trace_flags</a> {
<a name="l00112"></a><a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3a191b56c3df67572c8d052456866d6fb7">00112</a>         <a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3a191b56c3df67572c8d052456866d6fb7">LNTF_CHECK_LINKEA</a>       = 0x01,
<a name="l00113"></a><a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3a39589a019789c5f199221b9775506944">00113</a>         <a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3a39589a019789c5f199221b9775506944">LNTF_CHECK_PARENT</a>       = 0x02,
<a name="l00114"></a><a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3a3a927f274cc9bb2c93ff34e2672c3603">00114</a>         <a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3a3a927f274cc9bb2c93ff34e2672c3603">LNTF_SKIP_NLINK</a>         = 0x04,
<a name="l00115"></a><a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3a8329bb34aea189cd6a111aef0468e485">00115</a>         <a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3a8329bb34aea189cd6a111aef0468e485">LNTF_CHECK_ORPHAN</a>       = 0x08,
<a name="l00116"></a><a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3aa0ed1417ba4b57a54a8ce598a22be234">00116</a>         <a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3aa0ed1417ba4b57a54a8ce598a22be234">LNTF_UNCERTAIN_LMV</a>      = 0x10,
<a name="l00117"></a><a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3a90f28fa690daf3b328c530f181f50291">00117</a>         <a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3a90f28fa690daf3b328c530f181f50291">LNTF_RECHECK_NAME_HASH</a>  = 0x20,
<a name="l00118"></a><a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3ae45dedf9f566566f2492bdf7d5171be6">00118</a>         <a class="code" href="lfsck__internal_8h.html#a98262cb18f4b83f09f139618b21d80c3ae45dedf9f566566f2492bdf7d5171be6">LNTF_ALL</a>                = 0xff
<a name="l00119"></a>00119 };
<a name="l00120"></a>00120 
<a name="l00121"></a><a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73">00121</a> <span class="keyword">enum</span> <a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73">lfsck_namespace_inconsistency_type</a> {
<a name="l00122"></a><a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73a40a056ef76d0d0e9b6a6e36c5c620eea">00122</a>         <a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73a40a056ef76d0d0e9b6a6e36c5c620eea">LNIT_NONE</a>               = 0,
<a name="l00123"></a><a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73ace5dedf3ef6ec55a636d58087282da93">00123</a>         <a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73ace5dedf3ef6ec55a636d58087282da93">LNIT_BAD_LINKEA</a>         = 1,
<a name="l00124"></a><a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73a5a2dcc82b4f2fb31dcf2a86c0e7f80dd">00124</a>         <a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73a5a2dcc82b4f2fb31dcf2a86c0e7f80dd">LNIT_UNMATCHED_PAIRS</a>    = 2,
<a name="l00125"></a><a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73ace6344584e9a391ec5a532fea993cc1e">00125</a>         <a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73ace6344584e9a391ec5a532fea993cc1e">LNIT_DANGLING</a>           = 3,
<a name="l00126"></a><a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73a183b304fdc1b5024e8eae9ddcceac828">00126</a>         <a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73a183b304fdc1b5024e8eae9ddcceac828">LNIT_MUL_REF</a>            = 4,
<a name="l00127"></a><a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73af5737cb59892fc40e026f6af0f70d58f">00127</a>         <a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73af5737cb59892fc40e026f6af0f70d58f">LNIT_BAD_TYPE</a>           = 5,
<a name="l00128"></a><a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73a0b39fde38ed5ff30da44ca1dd147337e">00128</a>         <a class="code" href="lfsck__internal_8h.html#af23e062ce2b323adb6d73b5694a10e73a0b39fde38ed5ff30da44ca1dd147337e">LNIT_BAD_DIRENT</a>         = 6,
<a name="l00129"></a>00129 };
<a name="l00130"></a>00130 
<a name="l00131"></a><a class="code" href="structlfsck__namespace.html">00131</a> <span class="keyword">struct </span><a class="code" href="structlfsck__namespace.html">lfsck_namespace</a> {
<a name="l00132"></a>00132         <span class="comment">/* Magic number to detect that this struct contains valid data. */</span>
<a name="l00133"></a><a class="code" href="structlfsck__namespace.html#a00a719cf986d77c4f857030429272b83">00133</a>         __u32   <a class="code" href="structlfsck__namespace.html#a00a719cf986d77c4f857030429272b83">ln_magic</a>;
<a name="l00134"></a>00134 
<a name="l00135"></a>00135         <span class="comment">/* See &apos;enum lfsck_status&apos;. */</span>
<a name="l00136"></a><a class="code" href="structlfsck__namespace.html#a770c9fdd72cf3e656bec318d09f5425d">00136</a>         __u32   <a class="code" href="structlfsck__namespace.html#a770c9fdd72cf3e656bec318d09f5425d">ln_status</a>;
<a name="l00137"></a>00137 
<a name="l00138"></a>00138         <span class="comment">/* See &apos;enum lfsck_flags&apos;. */</span>
<a name="l00139"></a><a class="code" href="structlfsck__namespace.html#a8ba3bfe8df3914371ec4e399d8636d2d">00139</a>         __u32   <a class="code" href="structlfsck__namespace.html#a8ba3bfe8df3914371ec4e399d8636d2d">ln_flags</a>;
<a name="l00140"></a>00140 
<a name="l00141"></a>00141         <span class="comment">/* How many completed LFSCK runs on the device. */</span>
<a name="l00142"></a><a class="code" href="structlfsck__namespace.html#a148d8d2497f04b513964ad8c2953d721">00142</a>         __u32   <a class="code" href="structlfsck__namespace.html#a148d8d2497f04b513964ad8c2953d721">ln_success_count</a>;
<a name="l00143"></a>00143 
<a name="l00144"></a>00144         <span class="comment">/*  How long the LFSCK phase1 has run in seconds. */</span>
<a name="l00145"></a><a class="code" href="structlfsck__namespace.html#ac25c3fa966669e24a94fe2fa4c8e0d8a">00145</a>         __u32   <a class="code" href="structlfsck__namespace.html#ac25c3fa966669e24a94fe2fa4c8e0d8a">ln_run_time_phase1</a>;
<a name="l00146"></a>00146 
<a name="l00147"></a>00147         <span class="comment">/*  How long the LFSCK phase2 has run in seconds. */</span>
<a name="l00148"></a><a class="code" href="structlfsck__namespace.html#a8cc98d9037a6c1357204470ddd9931a7">00148</a>         __u32   <a class="code" href="structlfsck__namespace.html#a8cc98d9037a6c1357204470ddd9931a7">ln_run_time_phase2</a>;
<a name="l00149"></a>00149 
<a name="l00150"></a>00150         <span class="comment">/* Time for the last LFSCK completed in seconds since epoch. */</span>
<a name="l00151"></a><a class="code" href="structlfsck__namespace.html#a8653935b93b8fdd05ebcc65550b80b1d">00151</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a8653935b93b8fdd05ebcc65550b80b1d">ln_time_last_complete</a>;
<a name="l00152"></a>00152 
<a name="l00153"></a>00153         <span class="comment">/* Time for the latest LFSCK ran in seconds since epoch. */</span>
<a name="l00154"></a><a class="code" href="structlfsck__namespace.html#a82017a65e0197b1c92251fb737cfbecf">00154</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a82017a65e0197b1c92251fb737cfbecf">ln_time_latest_start</a>;
<a name="l00155"></a>00155 
<a name="l00156"></a>00156         <span class="comment">/* Time for the last LFSCK checkpoint in seconds since epoch. */</span>
<a name="l00157"></a><a class="code" href="structlfsck__namespace.html#a5ffb33f2d007bd7346858513540e986b">00157</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a5ffb33f2d007bd7346858513540e986b">ln_time_last_checkpoint</a>;
<a name="l00158"></a>00158 
<a name="l00159"></a>00159         <span class="comment">/* Position for the latest LFSCK started from. */</span>
<a name="l00160"></a><a class="code" href="structlfsck__namespace.html#a2d313d28965d94cdd803ebe0c2d2f5b8">00160</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__position.html">lfsck_position</a>   <a class="code" href="structlfsck__namespace.html#a2d313d28965d94cdd803ebe0c2d2f5b8">ln_pos_latest_start</a>;
<a name="l00161"></a>00161 
<a name="l00162"></a>00162         <span class="comment">/* Position for the last LFSCK checkpoint. */</span>
<a name="l00163"></a><a class="code" href="structlfsck__namespace.html#a271e4e2cf97d58877d70209a16d86268">00163</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__position.html">lfsck_position</a>   <a class="code" href="structlfsck__namespace.html#a271e4e2cf97d58877d70209a16d86268">ln_pos_last_checkpoint</a>;
<a name="l00164"></a>00164 
<a name="l00165"></a>00165         <span class="comment">/* Position for the first should be updated object. */</span>
<a name="l00166"></a><a class="code" href="structlfsck__namespace.html#aa616435f6d7f9f787b219f05364b78ea">00166</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__position.html">lfsck_position</a>   <a class="code" href="structlfsck__namespace.html#aa616435f6d7f9f787b219f05364b78ea">ln_pos_first_inconsistent</a>;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168         <span class="comment">/* How many items (including dir) have been checked. */</span>
<a name="l00169"></a><a class="code" href="structlfsck__namespace.html#a1c7a66447a879d94acb5d1bbd71bca70">00169</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a1c7a66447a879d94acb5d1bbd71bca70">ln_items_checked</a>;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171         <span class="comment">/* How many items have been repaired. */</span>
<a name="l00172"></a><a class="code" href="structlfsck__namespace.html#a88fbae234cd1c8eaf7f6724ea3ed01ef">00172</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a88fbae234cd1c8eaf7f6724ea3ed01ef">ln_items_repaired</a>;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174         <span class="comment">/* How many items failed to be processed. */</span>
<a name="l00175"></a><a class="code" href="structlfsck__namespace.html#ab802e6c8cb1f9ba8b8ceee935176fa11">00175</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#ab802e6c8cb1f9ba8b8ceee935176fa11">ln_items_failed</a>;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177         <span class="comment">/* How many directories have been traversed. */</span>
<a name="l00178"></a><a class="code" href="structlfsck__namespace.html#aedc2223b46d799f584cf17bdbe007ee6">00178</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#aedc2223b46d799f584cf17bdbe007ee6">ln_dirs_checked</a>;
<a name="l00179"></a>00179 
<a name="l00180"></a>00180         <span class="comment">/* How many objects have been double scanned. */</span>
<a name="l00181"></a><a class="code" href="structlfsck__namespace.html#a627ca358232ad13355a8f894a4f9d860">00181</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a627ca358232ad13355a8f894a4f9d860">ln_objs_checked_phase2</a>;
<a name="l00182"></a>00182 
<a name="l00183"></a>00183         <span class="comment">/* How many objects have been reparied during double scan. */</span>
<a name="l00184"></a><a class="code" href="structlfsck__namespace.html#a88a9d3236e2569ad4c58fc2f46972abb">00184</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a88a9d3236e2569ad4c58fc2f46972abb">ln_objs_repaired_phase2</a>;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186         <span class="comment">/* How many objects failed to be processed during double scan. */</span>
<a name="l00187"></a><a class="code" href="structlfsck__namespace.html#a26904dd2493697ba99de741343729b7a">00187</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a26904dd2493697ba99de741343729b7a">ln_objs_failed_phase2</a>;
<a name="l00188"></a>00188 
<a name="l00189"></a>00189         <span class="comment">/* How many objects with nlink fixed. */</span>
<a name="l00190"></a><a class="code" href="structlfsck__namespace.html#ad0f7a1f0500f0915cce06a151d86826c">00190</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#ad0f7a1f0500f0915cce06a151d86826c">ln_objs_nlink_repaired</a>;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192         <span class="comment">/* The latest object has been processed (failed) during double scan. */</span>
<a name="l00193"></a><a class="code" href="structlfsck__namespace.html#a76e64843cb0f37bb2098e066fc6246a8">00193</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>   <a class="code" href="structlfsck__namespace.html#a76e64843cb0f37bb2098e066fc6246a8">ln_fid_latest_scanned_phase2</a>;
<a name="l00194"></a>00194 
<a name="l00195"></a>00195         <span class="comment">/* How many FID-in-dirent entries have been repaired. */</span>
<a name="l00196"></a><a class="code" href="structlfsck__namespace.html#a124e472b76258c049a72512c19833eb7">00196</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a124e472b76258c049a72512c19833eb7">ln_dirent_repaired</a>;
<a name="l00197"></a>00197 
<a name="l00198"></a>00198         <span class="comment">/* How many linkEA entries have been repaired. */</span>
<a name="l00199"></a><a class="code" href="structlfsck__namespace.html#ad3c5ae0b5faf00a3b1bbecf7a6afab56">00199</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#ad3c5ae0b5faf00a3b1bbecf7a6afab56">ln_linkea_repaired</a>;
<a name="l00200"></a>00200 
<a name="l00201"></a>00201         <span class="comment">/* How many multiple-linked objects have been checked. */</span>
<a name="l00202"></a><a class="code" href="structlfsck__namespace.html#a33ef209b43cc1260ec30c397f5fb86d4">00202</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a33ef209b43cc1260ec30c397f5fb86d4">ln_mul_linked_checked</a>;
<a name="l00203"></a>00203 
<a name="l00204"></a>00204         <span class="comment">/* How many multiple-linked objects have been repaired. */</span>
<a name="l00205"></a><a class="code" href="structlfsck__namespace.html#a4dccce4c74369c00e32df61e08ecf60e">00205</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a4dccce4c74369c00e32df61e08ecf60e">ln_mul_linked_repaired</a>;
<a name="l00206"></a>00206 
<a name="l00207"></a>00207         <span class="comment">/* How many undefined inconsistency found in phase2. */</span>
<a name="l00208"></a><a class="code" href="structlfsck__namespace.html#a8c95b8ec4d5912443abb0f960d1a4556">00208</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a8c95b8ec4d5912443abb0f960d1a4556">ln_unknown_inconsistency</a>;
<a name="l00209"></a>00209 
<a name="l00210"></a>00210         <span class="comment">/* How many unmatched pairs have been repaired. */</span>
<a name="l00211"></a><a class="code" href="structlfsck__namespace.html#a36d2d44820835ae0841a3337065ed98f">00211</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a36d2d44820835ae0841a3337065ed98f">ln_unmatched_pairs_repaired</a>;
<a name="l00212"></a>00212 
<a name="l00213"></a>00213         <span class="comment">/* How many dangling name entries have been found/repaired. */</span>
<a name="l00214"></a><a class="code" href="structlfsck__namespace.html#a30029d8b354efcc2516178ecd284770f">00214</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a30029d8b354efcc2516178ecd284770f">ln_dangling_repaired</a>;
<a name="l00215"></a>00215 
<a name="l00216"></a>00216         <span class="comment">/* How many multiple referenced name entries have been</span>
<a name="l00217"></a>00217 <span class="comment">         * found/repaired. */</span>
<a name="l00218"></a><a class="code" href="structlfsck__namespace.html#afdfbab787537b4640f91181ead808f28">00218</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#afdfbab787537b4640f91181ead808f28">ln_mul_ref_repaired</a>;
<a name="l00219"></a>00219 
<a name="l00220"></a>00220         <span class="comment">/* How many name entries with bad file type have been repaired. */</span>
<a name="l00221"></a><a class="code" href="structlfsck__namespace.html#a57437f98fcba5e384632b6a61736de6f">00221</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a57437f98fcba5e384632b6a61736de6f">ln_bad_type_repaired</a>;
<a name="l00222"></a>00222 
<a name="l00223"></a>00223         <span class="comment">/* How many lost name entries have been re-inserted. */</span>
<a name="l00224"></a><a class="code" href="structlfsck__namespace.html#ac48a3a1ffaa6c9c60f761b6e6e6d06ae">00224</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#ac48a3a1ffaa6c9c60f761b6e6e6d06ae">ln_lost_dirent_repaired</a>;
<a name="l00225"></a>00225 
<a name="l00226"></a>00226         <span class="comment">/* How many objects under /lost+found have been scanned. */</span>
<a name="l00227"></a><a class="code" href="structlfsck__namespace.html#a5cdcba6839c5128f037cfe47c79fba31">00227</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a5cdcba6839c5128f037cfe47c79fba31">ln_local_lpf_scanned</a>;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229         <span class="comment">/* How many objects under /lost+found have been moved to</span>
<a name="l00230"></a>00230 <span class="comment">         * namespace visible directory. */</span>
<a name="l00231"></a><a class="code" href="structlfsck__namespace.html#a0e78a39d41720b42f088b57d1c3390e4">00231</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a0e78a39d41720b42f088b57d1c3390e4">ln_local_lpf_moved</a>;
<a name="l00232"></a>00232 
<a name="l00233"></a>00233         <span class="comment">/* How many objects under /lost+found have been skipped. */</span>
<a name="l00234"></a><a class="code" href="structlfsck__namespace.html#a09a344b640574af4f3bc33f8a81a38b2">00234</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a09a344b640574af4f3bc33f8a81a38b2">ln_local_lpf_skipped</a>;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236         <span class="comment">/* How many objects under /lost+found failed to be processed. */</span>
<a name="l00237"></a><a class="code" href="structlfsck__namespace.html#abb8c65860371ac2a582e088f34eb34ca">00237</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#abb8c65860371ac2a582e088f34eb34ca">ln_local_lpf_failed</a>;
<a name="l00238"></a>00238 
<a name="l00239"></a>00239         <span class="comment">/* How many striped directories (master) have been scanned. */</span>
<a name="l00240"></a><a class="code" href="structlfsck__namespace.html#aab59203836937767e7a62709ad07509b">00240</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#aab59203836937767e7a62709ad07509b">ln_striped_dirs_scanned</a>;
<a name="l00241"></a>00241 
<a name="l00242"></a>00242         <span class="comment">/* How many striped directories (master) have been repaired. */</span>
<a name="l00243"></a><a class="code" href="structlfsck__namespace.html#aa39e127d08d3fc91ae8d40c3d77d9ff7">00243</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#aa39e127d08d3fc91ae8d40c3d77d9ff7">ln_striped_dirs_repaired</a>;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245         <span class="comment">/* How many striped directories (master) failed verification. */</span>
<a name="l00246"></a><a class="code" href="structlfsck__namespace.html#a2ab72dec618fac1f743e12a3ae3b1301">00246</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a2ab72dec618fac1f743e12a3ae3b1301">ln_striped_dirs_failed</a>;
<a name="l00247"></a>00247 
<a name="l00248"></a>00248         <span class="comment">/* How many striped directories (master) has been disabled. */</span>
<a name="l00249"></a><a class="code" href="structlfsck__namespace.html#af256d49641d9f166d35c539cfc430f13">00249</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#af256d49641d9f166d35c539cfc430f13">ln_striped_dirs_disabled</a>;
<a name="l00250"></a>00250 
<a name="l00251"></a>00251         <span class="comment">/* How many striped directory&apos;s (master) have been skipped</span>
<a name="l00252"></a>00252 <span class="comment">         * (for shards verification) because of lost master LMV EA. */</span>
<a name="l00253"></a><a class="code" href="structlfsck__namespace.html#a05af2b1ebe8c46b8838674a8dce086e8">00253</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a05af2b1ebe8c46b8838674a8dce086e8">ln_striped_dirs_skipped</a>;
<a name="l00254"></a>00254 
<a name="l00255"></a>00255         <span class="comment">/* How many striped directory&apos;s shards (slave) have been scanned. */</span>
<a name="l00256"></a><a class="code" href="structlfsck__namespace.html#a59e187fd09f843421673f6996fe0bc21">00256</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a59e187fd09f843421673f6996fe0bc21">ln_striped_shards_scanned</a>;
<a name="l00257"></a>00257 
<a name="l00258"></a>00258         <span class="comment">/* How many striped directory&apos;s shards (slave) have been repaired. */</span>
<a name="l00259"></a><a class="code" href="structlfsck__namespace.html#a85bc69762d70324d3c4d7440d7b8fa7b">00259</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a85bc69762d70324d3c4d7440d7b8fa7b">ln_striped_shards_repaired</a>;
<a name="l00260"></a>00260 
<a name="l00261"></a>00261         <span class="comment">/* How many striped directory&apos;s shards (slave) failed verification. */</span>
<a name="l00262"></a><a class="code" href="structlfsck__namespace.html#a1a51b87f0d7cfce0f3e5f6f1dc3dbeb6">00262</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a1a51b87f0d7cfce0f3e5f6f1dc3dbeb6">ln_striped_shards_failed</a>;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264         <span class="comment">/* How many striped directory&apos;s shards (slave) have been skipped</span>
<a name="l00265"></a>00265 <span class="comment">         * (for name hash verification) because do not know whether the slave</span>
<a name="l00266"></a>00266 <span class="comment">         * LMV EA is valid or not. */</span>
<a name="l00267"></a><a class="code" href="structlfsck__namespace.html#a4c48b9d7cca764f65a0217539ab10c0e">00267</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a4c48b9d7cca764f65a0217539ab10c0e">ln_striped_shards_skipped</a>;
<a name="l00268"></a>00268 
<a name="l00269"></a>00269         <span class="comment">/* How many name entries under striped directory with bad name</span>
<a name="l00270"></a>00270 <span class="comment">         * hash have been repaired. */</span>
<a name="l00271"></a><a class="code" href="structlfsck__namespace.html#aafeefd4521ea2b8c213629c1a9300f42">00271</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#aafeefd4521ea2b8c213629c1a9300f42">ln_name_hash_repaired</a>;
<a name="l00272"></a>00272 
<a name="l00273"></a>00273         <span class="comment">/* The size of MDT targets bitmap with nbits. Such bitmap records</span>
<a name="l00274"></a>00274 <span class="comment">         * the MDTs that contain non-verified MDT-objects. */</span>
<a name="l00275"></a><a class="code" href="structlfsck__namespace.html#aa5fc60bb3b24f271489b206e57f74ae0">00275</a>         __u32   <a class="code" href="structlfsck__namespace.html#aa5fc60bb3b24f271489b206e57f74ae0">ln_bitmap_size</a>;
<a name="l00276"></a>00276 
<a name="l00277"></a><a class="code" href="structlfsck__namespace.html#a97c1ba04068d6a37eae191e9c0b2dbff">00277</a>         __u32   <a class="code" href="structlfsck__namespace.html#a97c1ba04068d6a37eae191e9c0b2dbff">ln_reserved_1</a>;
<a name="l00278"></a>00278         <span class="comment">/* For further using. 256-bytes aligned now. */</span>
<a name="l00279"></a><a class="code" href="structlfsck__namespace.html#a48642e58a91b4ae8dc77b7d6b908b632">00279</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__namespace.html#a48642e58a91b4ae8dc77b7d6b908b632">ln_reserved</a>[15];
<a name="l00280"></a>00280 };
<a name="l00281"></a>00281 
<a name="l00282"></a><a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6">00282</a> <span class="keyword">enum</span> <a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6">lfsck_layout_inconsistency_type</a> {
<a name="l00283"></a><a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a5d1bc01e329983358c4c2ab184e8768f">00283</a>         <a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a5d1bc01e329983358c4c2ab184e8768f">LLIT_NONE</a>                       = 0,
<a name="l00284"></a><a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a0327bf06d9a2d295de1c2d33fceeb2cc">00284</a>         <a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a0327bf06d9a2d295de1c2d33fceeb2cc">LLIT_DANGLING</a>                   = 1,
<a name="l00285"></a><a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a5c705034e55669316fd94399fedc1ec4">00285</a>         <a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a5c705034e55669316fd94399fedc1ec4">LLIT_UNMATCHED_PAIR</a>             = 2,
<a name="l00286"></a><a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6aa8ea827be3fbe01e253fc900c9a03ad8">00286</a>         <a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6aa8ea827be3fbe01e253fc900c9a03ad8">LLIT_MULTIPLE_REFERENCED</a>        = 3,
<a name="l00287"></a><a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a393625499d83f8ad5c7d479ebee9e42e">00287</a>         <a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a393625499d83f8ad5c7d479ebee9e42e">LLIT_ORPHAN</a>                     = 4,
<a name="l00288"></a><a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a2320a7ead868961e01a9c577d38342c5">00288</a>         <a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a2320a7ead868961e01a9c577d38342c5">LLIT_INCONSISTENT_OWNER</a>         = 5,
<a name="l00289"></a><a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a8707d8904974558ec4824c601a6d13d8">00289</a>         <a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a8707d8904974558ec4824c601a6d13d8">LLIT_OTHERS</a>                     = 6,
<a name="l00290"></a><a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6aae7264dad2898ea487256a20d5bd9705">00290</a>         <a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6aae7264dad2898ea487256a20d5bd9705">LLIT_MAX</a>                        = <a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6a8707d8904974558ec4824c601a6d13d8">LLIT_OTHERS</a>
<a name="l00291"></a>00291 };
<a name="l00292"></a>00292 
<a name="l00293"></a><a class="code" href="structlfsck__layout.html">00293</a> <span class="keyword">struct </span><a class="code" href="structlfsck__layout.html">lfsck_layout</a> {
<a name="l00294"></a>00294         <span class="comment">/* Magic number to detect that this struct contains valid data. */</span>
<a name="l00295"></a><a class="code" href="structlfsck__layout.html#a3fb2ddc8c4609a538c6400419eaeb46a">00295</a>         __u32   <a class="code" href="structlfsck__layout.html#a3fb2ddc8c4609a538c6400419eaeb46a">ll_magic</a>;
<a name="l00296"></a>00296 
<a name="l00297"></a>00297         <span class="comment">/* See &apos;enum lfsck_status&apos;. */</span>
<a name="l00298"></a><a class="code" href="structlfsck__layout.html#a6b9266eafb353a1237907a54a37daa35">00298</a>         __u32   <a class="code" href="structlfsck__layout.html#a6b9266eafb353a1237907a54a37daa35">ll_status</a>;
<a name="l00299"></a>00299 
<a name="l00300"></a>00300         <span class="comment">/* See &apos;enum lfsck_flags&apos;. */</span>
<a name="l00301"></a><a class="code" href="structlfsck__layout.html#af7db3dd845fddf04a33d0c4e6e739bbb">00301</a>         __u32   <a class="code" href="structlfsck__layout.html#af7db3dd845fddf04a33d0c4e6e739bbb">ll_flags</a>;
<a name="l00302"></a>00302 
<a name="l00303"></a>00303         <span class="comment">/* How many completed LFSCK runs on the device. */</span>
<a name="l00304"></a><a class="code" href="structlfsck__layout.html#a4631bc179c69b1a07fbd0d73f612fb1f">00304</a>         __u32   <a class="code" href="structlfsck__layout.html#a4631bc179c69b1a07fbd0d73f612fb1f">ll_success_count</a>;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306         <span class="comment">/*  How long the LFSCK phase1 has run in seconds. */</span>
<a name="l00307"></a><a class="code" href="structlfsck__layout.html#ac7f97807f5752fe5aaf831cfbed95fc6">00307</a>         __u32   <a class="code" href="structlfsck__layout.html#ac7f97807f5752fe5aaf831cfbed95fc6">ll_run_time_phase1</a>;
<a name="l00308"></a>00308 
<a name="l00309"></a>00309         <span class="comment">/*  How long the LFSCK phase2 has run in seconds. */</span>
<a name="l00310"></a><a class="code" href="structlfsck__layout.html#a8c4c65ccfccee584da2870b1aec6118d">00310</a>         __u32   <a class="code" href="structlfsck__layout.html#a8c4c65ccfccee584da2870b1aec6118d">ll_run_time_phase2</a>;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312         <span class="comment">/* Time for the last LFSCK completed in seconds since epoch. */</span>
<a name="l00313"></a><a class="code" href="structlfsck__layout.html#ad43d173a136dc8b5be468456b90bb1d9">00313</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#ad43d173a136dc8b5be468456b90bb1d9">ll_time_last_complete</a>;
<a name="l00314"></a>00314 
<a name="l00315"></a>00315         <span class="comment">/* Time for the latest LFSCK ran in seconds since epoch. */</span>
<a name="l00316"></a><a class="code" href="structlfsck__layout.html#a2f6b2bec2a982c30b9ce97581c66b72a">00316</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#a2f6b2bec2a982c30b9ce97581c66b72a">ll_time_latest_start</a>;
<a name="l00317"></a>00317 
<a name="l00318"></a>00318         <span class="comment">/* Time for the last LFSCK checkpoint in seconds since epoch. */</span>
<a name="l00319"></a><a class="code" href="structlfsck__layout.html#ab4e4110fa546467d1627a20603c2140b">00319</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#ab4e4110fa546467d1627a20603c2140b">ll_time_last_checkpoint</a>;
<a name="l00320"></a>00320 
<a name="l00321"></a>00321         <span class="comment">/* Position for the latest LFSCK started from. */</span>
<a name="l00322"></a><a class="code" href="structlfsck__layout.html#a9e9aba79f770c18e8801e20f277f3415">00322</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#a9e9aba79f770c18e8801e20f277f3415">ll_pos_latest_start</a>;
<a name="l00323"></a>00323 
<a name="l00324"></a>00324         <span class="comment">/* Position for the last LFSCK checkpoint. */</span>
<a name="l00325"></a><a class="code" href="structlfsck__layout.html#afb4a7f98b8be6fe7193d45c7e9747a68">00325</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#afb4a7f98b8be6fe7193d45c7e9747a68">ll_pos_last_checkpoint</a>;
<a name="l00326"></a>00326 
<a name="l00327"></a>00327         <span class="comment">/* Position for the first object to be fixed or</span>
<a name="l00328"></a>00328 <span class="comment">         * failed to be checked in the phase1. */</span>
<a name="l00329"></a><a class="code" href="structlfsck__layout.html#a32fe68ecc4d3a25ca091bf271a89f85c">00329</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#a32fe68ecc4d3a25ca091bf271a89f85c">ll_pos_first_inconsistent</a>;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331         <span class="comment">/* How many objects have been checked. */</span>
<a name="l00332"></a><a class="code" href="structlfsck__layout.html#a5a4fa5c91244d761f48e8d54680a983e">00332</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#a5a4fa5c91244d761f48e8d54680a983e">ll_objs_checked_phase1</a>;
<a name="l00333"></a>00333 
<a name="l00334"></a>00334         <span class="comment">/* How many objects failed to be processed. */</span>
<a name="l00335"></a><a class="code" href="structlfsck__layout.html#a0e39c128f314df661c0d62cf47c8c45b">00335</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#a0e39c128f314df661c0d62cf47c8c45b">ll_objs_failed_phase1</a>;
<a name="l00336"></a>00336 
<a name="l00337"></a>00337         <span class="comment">/* How many objects have been double scanned. */</span>
<a name="l00338"></a><a class="code" href="structlfsck__layout.html#a553dd945f8471e6fb147ee467410ae22">00338</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#a553dd945f8471e6fb147ee467410ae22">ll_objs_checked_phase2</a>;
<a name="l00339"></a>00339 
<a name="l00340"></a>00340         <span class="comment">/* How many objects failed to be processed during double scan. */</span>
<a name="l00341"></a><a class="code" href="structlfsck__layout.html#aab74ebeda18bd37fb8771801b0d353ad">00341</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#aab74ebeda18bd37fb8771801b0d353ad">ll_objs_failed_phase2</a>;
<a name="l00342"></a>00342 
<a name="l00343"></a>00343         <span class="comment">/* kinds of inconsistency have been or to be repaired.</span>
<a name="l00344"></a>00344 <span class="comment">         * ll_objs_repaired[type - 1] is the count for the given @type. */</span>
<a name="l00345"></a><a class="code" href="structlfsck__layout.html#aad0eae69e51a2fb8ca29c407fbb50416">00345</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#aad0eae69e51a2fb8ca29c407fbb50416">ll_objs_repaired</a>[<a class="code" href="lfsck__internal_8h.html#a593d25af9e72552c046dd9ca2d44e4f6aae7264dad2898ea487256a20d5bd9705">LLIT_MAX</a>];
<a name="l00346"></a>00346 
<a name="l00347"></a>00347         <span class="comment">/* How many objects have been skipped because of related</span>
<a name="l00348"></a>00348 <span class="comment">         * MDT(s)/OST(s) do not participate in the LFSCK */</span>
<a name="l00349"></a><a class="code" href="structlfsck__layout.html#a18441dabba71fed23356578a9a28b655">00349</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#a18441dabba71fed23356578a9a28b655">ll_objs_skipped</a>;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351         <span class="comment">/* The size of ll_ost_bitmap with nbits. */</span>
<a name="l00352"></a><a class="code" href="structlfsck__layout.html#aed6b7b6b9c83de7042d32ae4b0f30e9c">00352</a>         __u32   <a class="code" href="structlfsck__layout.html#aed6b7b6b9c83de7042d32ae4b0f30e9c">ll_bitmap_size</a>;
<a name="l00353"></a>00353 
<a name="l00354"></a>00354         <span class="comment">/* For further using. 256-bytes aligned now. */</span>
<a name="l00355"></a><a class="code" href="structlfsck__layout.html#ae1a292130e745679166f612ba50775d8">00355</a>         __u32   <a class="code" href="structlfsck__layout.html#ae1a292130e745679166f612ba50775d8">ll_reserved_1</a>;
<a name="l00356"></a><a class="code" href="structlfsck__layout.html#a8ad3a6d916ed181e08d786dacfd0a881">00356</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlfsck__layout.html#a8ad3a6d916ed181e08d786dacfd0a881">ll_reserved_2</a>[11];
<a name="l00357"></a>00357 
<a name="l00358"></a>00358         <span class="comment">/* The OST targets bitmap to record the OSTs that contain</span>
<a name="l00359"></a>00359 <span class="comment">         * non-verified OST-objects. */</span>
<a name="l00360"></a><a class="code" href="structlfsck__layout.html#ab26db633a2c9947a765a51c2a08a535a">00360</a>         __u8    <a class="code" href="structlfsck__layout.html#ab26db633a2c9947a765a51c2a08a535a">ll_ost_bitmap</a>[0];
<a name="l00361"></a>00361 };
<a name="l00362"></a>00362 
<a name="l00363"></a><a class="code" href="structlfsck__assistant__object.html">00363</a> <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__object.html">lfsck_assistant_object</a> {
<a name="l00364"></a><a class="code" href="structlfsck__assistant__object.html#ac6143e4de1fa8aef78841b2513dd8c2b">00364</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>           <a class="code" href="structlfsck__assistant__object.html#ac6143e4de1fa8aef78841b2513dd8c2b">lso_fid</a>;
<a name="l00365"></a><a class="code" href="structlfsck__assistant__object.html#a87a9ef5502aaf3e222175d76f8945d69">00365</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                   <a class="code" href="structlfsck__assistant__object.html#a87a9ef5502aaf3e222175d76f8945d69">lso_oit_cookie</a>;
<a name="l00366"></a><a class="code" href="structlfsck__assistant__object.html#ae60089e6db55b85af6cebd823239038d">00366</a>         <span class="keyword">struct </span><a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a>          <a class="code" href="structlfsck__assistant__object.html#ae60089e6db55b85af6cebd823239038d">lso_attr</a>;
<a name="l00367"></a><a class="code" href="structlfsck__assistant__object.html#a4577d04984eb418aad89b51da8a1b207">00367</a>         atomic_t                <a class="code" href="structlfsck__assistant__object.html#a4577d04984eb418aad89b51da8a1b207">lso_ref</a>;
<a name="l00368"></a><a class="code" href="structlfsck__assistant__object.html#a17b9547ca64c3dda75794ee2ffdac9b1">00368</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            <a class="code" href="structlfsck__assistant__object.html#ae168caa8700fdb48659420122b720fb5">lso_dead</a>:1,
<a name="l00369"></a>00369                                 <a class="code" href="structlfsck__assistant__object.html#a17b9547ca64c3dda75794ee2ffdac9b1">lso_is_dir</a>:1;
<a name="l00370"></a>00370 };
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a>;
<a name="l00373"></a>00373 <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__descs.html">lfsck_tgt_descs</a>;
<a name="l00374"></a>00374 <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__desc.html">lfsck_tgt_desc</a>;
<a name="l00375"></a>00375 
<a name="l00376"></a><a class="code" href="structlfsck__operations.html">00376</a> <span class="keyword">struct </span><a class="code" href="structlfsck__operations.html">lfsck_operations</a> {
<a name="l00377"></a>00377         int (*<a class="code" href="structlfsck__operations.html#a999dd1050bec2f0b2d8507fa92c9f57e">lfsck_reset</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00378"></a>00378                            <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00379"></a>00379                            <span class="keywordtype">bool</span> init);
<a name="l00380"></a>00380 
<a name="l00381"></a>00381         void (*<a class="code" href="structlfsck__operations.html#a8e7181930fa9d20e1e670d6442195881">lfsck_fail</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00382"></a>00382                            <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00383"></a>00383                            <span class="keywordtype">bool</span> new_checked);
<a name="l00384"></a>00384 
<a name="l00385"></a>00385         void (*<a class="code" href="structlfsck__operations.html#a6d6512749b0f55779af0c7d4fb46ac74">lfsck_close_dir</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00386"></a>00386                                 <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com);
<a name="l00387"></a>00387 
<a name="l00388"></a>00388         int (*<a class="code" href="structlfsck__operations.html#a0f17b6351c430903278a1ee3b87457a3">lfsck_open_dir</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00389"></a>00389                               <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com);
<a name="l00390"></a>00390 
<a name="l00391"></a>00391         int (*<a class="code" href="structlfsck__operations.html#ac6189eae9f69e48777e033d18821845b">lfsck_checkpoint</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00392"></a>00392                                 <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00393"></a>00393                                 <span class="keywordtype">bool</span> init);
<a name="l00394"></a>00394 
<a name="l00395"></a>00395         int (*<a class="code" href="structlfsck__operations.html#a1ae6b87d5b50acd8b92f4611874240c0">lfsck_prep</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00396"></a>00396                           <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00397"></a>00397                           <span class="keyword">struct </span><a class="code" href="structlfsck__start__param.html">lfsck_start_param</a> *lsp);
<a name="l00398"></a>00398 
<a name="l00399"></a>00399         int (*<a class="code" href="structlfsck__operations.html#a2b2f088f98d964eb6a55524a0c1bac42">lfsck_exec_oit</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00400"></a>00400                               <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00401"></a>00401                               <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *obj);
<a name="l00402"></a>00402 
<a name="l00403"></a>00403         int (*<a class="code" href="structlfsck__operations.html#ad1709f30571861cedea2eba88099b2da">lfsck_exec_dir</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00404"></a>00404                               <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00405"></a>00405                               <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__object.html">lfsck_assistant_object</a> *lso,
<a name="l00406"></a>00406                               <span class="keyword">struct </span><a class="code" href="structlu__dirent.html" title="Layout of readdir pages, as transmitted on wire.">lu_dirent</a> *ent,
<a name="l00407"></a>00407                               __u16 type);
<a name="l00408"></a>00408 
<a name="l00409"></a>00409         int (*<a class="code" href="structlfsck__operations.html#a4d42dc8439e56bb809344bf67cbabbe5">lfsck_post</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00410"></a>00410                           <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00411"></a>00411                           <span class="keywordtype">int</span> result,
<a name="l00412"></a>00412                           <span class="keywordtype">bool</span> init);
<a name="l00413"></a>00413 
<a name="l00414"></a>00414         void (*<a class="code" href="structlfsck__operations.html#a8fe2d3acc7b9dbafaac508ed092e689f">lfsck_dump</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00415"></a>00415                            <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00416"></a>00416                            <span class="keyword">struct </span>seq_file *m);
<a name="l00417"></a>00417 
<a name="l00418"></a>00418         int (*<a class="code" href="structlfsck__operations.html#a58e7c046382c1ed8c788cd9f2c8fe619">lfsck_double_scan</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00419"></a>00419                                  <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com);
<a name="l00420"></a>00420 
<a name="l00421"></a>00421         void (*<a class="code" href="structlfsck__operations.html#ad7a107262d05e75c5b11266147c76a3b">lfsck_data_release</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00422"></a>00422                                    <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com);
<a name="l00423"></a>00423 
<a name="l00424"></a>00424         void (*<a class="code" href="structlfsck__operations.html#a1a5b2eb731f570c6a19cff0bc98ec786">lfsck_quit</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00425"></a>00425                            <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com);
<a name="l00426"></a>00426 
<a name="l00427"></a>00427         int (*<a class="code" href="structlfsck__operations.html#a168bc6424a32d7c13aea5061c0fa98f8">lfsck_in_notify</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00428"></a>00428                                <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00429"></a>00429                                <span class="keyword">struct </span><a class="code" href="structlfsck__request.html">lfsck_request</a> *lr,
<a name="l00430"></a>00430                                <span class="keyword">struct </span><a class="code" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> *th);
<a name="l00431"></a>00431 
<a name="l00432"></a>00432         int (*<a class="code" href="structlfsck__query.html">lfsck_query</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00433"></a>00433                            <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00434"></a>00434                            <span class="keyword">struct </span><a class="code" href="structlfsck__request.html">lfsck_request</a> *req,
<a name="l00435"></a>00435                            <span class="keyword">struct </span><a class="code" href="structlfsck__reply.html">lfsck_reply</a> *rep,
<a name="l00436"></a>00436                            <span class="keyword">struct </span><a class="code" href="structlfsck__query.html">lfsck_query</a> *que, <span class="keywordtype">int</span> idx);
<a name="l00437"></a>00437 
<a name="l00438"></a>00438         int (*<a class="code" href="structlfsck__operations.html#a48dc71d87efbb80a6ca8459310d3fd96">lfsck_join</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00439"></a>00439                           <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00440"></a>00440                           <span class="keyword">struct </span><a class="code" href="structlfsck__start__param.html">lfsck_start_param</a> *lsp);
<a name="l00441"></a>00441 };
<a name="l00442"></a>00442 
<a name="l00443"></a><a class="code" href="lfsck__internal_8h.html#a117afde0fc9f7138bf657a5f3e70f00f">00443</a> <span class="preprocessor">#define TGT_PTRS                256     </span><span class="comment">/* number of pointers at 1st level */</span>
<a name="l00444"></a><a class="code" href="lfsck__internal_8h.html#a6f54ff6e890afe3f22f8feb22f7ce69a">00444</a> <span class="preprocessor">#define TGT_PTRS_PER_BLOCK      256     </span><span class="comment">/* number of pointers at 2nd level */</span>
<a name="l00445"></a>00445 
<a name="l00446"></a><a class="code" href="structlfsck__tgt__desc.html">00446</a> <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__desc.html">lfsck_tgt_desc</a> {
<a name="l00447"></a><a class="code" href="structlfsck__tgt__desc.html#aaaaa2bbcfa683dc314927587b827214a">00447</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>   <a class="code" href="structlfsck__tgt__desc.html#aaaaa2bbcfa683dc314927587b827214a">ltd_orphan_list</a>;
<a name="l00448"></a><a class="code" href="structlfsck__tgt__desc.html#a0ce2e735d5ed2af4457e1892f7613952">00448</a>         <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a>  *<a class="code" href="structlfsck__tgt__desc.html#a0ce2e735d5ed2af4457e1892f7613952">ltd_tgt</a>;
<a name="l00449"></a><a class="code" href="structlfsck__tgt__desc.html#a336b9d9f792528602780477e0a5c6844">00449</a>         <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a>  *<a class="code" href="structlfsck__tgt__desc.html#a336b9d9f792528602780477e0a5c6844">ltd_key</a>;
<a name="l00450"></a><a class="code" href="structlfsck__tgt__desc.html#a349d64a7663c75f982878f38c64d0322">00450</a>         <span class="keyword">struct </span><a class="code" href="structobd__export.html" title="Export structure.">obd_export</a> *<a class="code" href="structlfsck__tgt__desc.html#a349d64a7663c75f982878f38c64d0322">ltd_exp</a>;
<a name="l00451"></a><a class="code" href="structlfsck__tgt__desc.html#a787bc8be8e749767a9748cd0c1d19bd3">00451</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>   <a class="code" href="structlfsck__tgt__desc.html#a787bc8be8e749767a9748cd0c1d19bd3">ltd_layout_list</a>;
<a name="l00452"></a><a class="code" href="structlfsck__tgt__desc.html#afc6a86162d6f6b772823ea7b8d73df45">00452</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>   <a class="code" href="structlfsck__tgt__desc.html#afc6a86162d6f6b772823ea7b8d73df45">ltd_layout_phase_list</a>;
<a name="l00453"></a><a class="code" href="structlfsck__tgt__desc.html#a4a7fa99dd2ee87c9b8c4f1d73b653261">00453</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>   <a class="code" href="structlfsck__tgt__desc.html#a4a7fa99dd2ee87c9b8c4f1d73b653261">ltd_namespace_list</a>;
<a name="l00454"></a><a class="code" href="structlfsck__tgt__desc.html#a23f29e00d549a0648b9015749e9a020b">00454</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>   <a class="code" href="structlfsck__tgt__desc.html#a23f29e00d549a0648b9015749e9a020b">ltd_namespace_phase_list</a>;
<a name="l00455"></a><a class="code" href="structlfsck__tgt__desc.html#a7bc440fb044aa4bea4d7a3be3d9e07c1">00455</a>         __u32              <a class="code" href="structlfsck__tgt__desc.html#a7bc440fb044aa4bea4d7a3be3d9e07c1">ltd_layout_status</a>;
<a name="l00456"></a><a class="code" href="structlfsck__tgt__desc.html#ada9324be2351d7b97858fe8455d3189a">00456</a>         __u32              <a class="code" href="structlfsck__tgt__desc.html#ada9324be2351d7b97858fe8455d3189a">ltd_namespace_status</a>;
<a name="l00457"></a><a class="code" href="structlfsck__tgt__desc.html#a4c453a34a3ea4b1df2dac26303f32d04">00457</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>              <a class="code" href="structlfsck__tgt__desc.html#a4c453a34a3ea4b1df2dac26303f32d04">ltd_layout_repaired</a>;
<a name="l00458"></a><a class="code" href="structlfsck__tgt__desc.html#a207cbf186d16be08597327ba6b8eb006">00458</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>              <a class="code" href="structlfsck__tgt__desc.html#a207cbf186d16be08597327ba6b8eb006">ltd_namespace_repaired</a>;
<a name="l00459"></a><a class="code" href="structlfsck__tgt__desc.html#a3f86069b9d2aa7ba29d841f4fd8eb986">00459</a>         atomic_t           <a class="code" href="structlfsck__tgt__desc.html#a3f86069b9d2aa7ba29d841f4fd8eb986">ltd_ref</a>;
<a name="l00460"></a><a class="code" href="structlfsck__tgt__desc.html#a1cdb970d5fcc63c41472bc6e35a958d7">00460</a>         __u32              <a class="code" href="structlfsck__tgt__desc.html#a1cdb970d5fcc63c41472bc6e35a958d7">ltd_index</a>;
<a name="l00461"></a><a class="code" href="structlfsck__tgt__desc.html#a1f6b9dc53b5699b731e85b49fa5f4316">00461</a>         __u32              <a class="code" href="structlfsck__tgt__desc.html#a1f6b9dc53b5699b731e85b49fa5f4316">ltd_layout_gen</a>;
<a name="l00462"></a><a class="code" href="structlfsck__tgt__desc.html#a11413df2334235c4517d8abe856e540f">00462</a>         __u32              <a class="code" href="structlfsck__tgt__desc.html#a11413df2334235c4517d8abe856e540f">ltd_namespace_gen</a>;
<a name="l00463"></a><a class="code" href="structlfsck__tgt__desc.html#af2f5c1fd890a13695790526bc9e6796f">00463</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>       <a class="code" href="structlfsck__tgt__desc.html#a1dee5bbdba4c75935b36dcaaa9eacc76">ltd_dead</a>:1,
<a name="l00464"></a>00464                            <a class="code" href="structlfsck__tgt__desc.html#ab7d9c2acae36791be55fa14b20f23a0c">ltd_layout_done</a>:1,
<a name="l00465"></a>00465                            <a class="code" href="structlfsck__tgt__desc.html#a215e30627760bbfef2b74065fea49fdd">ltd_namespace_done</a>:1,
<a name="l00466"></a>00466                            <a class="code" href="structlfsck__tgt__desc.html#af2f5c1fd890a13695790526bc9e6796f">ltd_synced_failures</a>:1;
<a name="l00467"></a>00467 };
<a name="l00468"></a>00468 
<a name="l00469"></a><a class="code" href="structlfsck__tgt__desc__idx.html">00469</a> <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__desc__idx.html">lfsck_tgt_desc_idx</a> {
<a name="l00470"></a><a class="code" href="structlfsck__tgt__desc__idx.html#aa97a729f9e1e62a1ab573d61fb36866a">00470</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__desc.html">lfsck_tgt_desc</a> *<a class="code" href="structlfsck__tgt__desc__idx.html#aa97a729f9e1e62a1ab573d61fb36866a">ldi_tgts</a>[<a class="code" href="lfsck__internal_8h.html#a6f54ff6e890afe3f22f8feb22f7ce69a">TGT_PTRS_PER_BLOCK</a>];
<a name="l00471"></a>00471 };
<a name="l00472"></a>00472 
<a name="l00473"></a><a class="code" href="structlfsck__tgt__descs.html">00473</a> <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__descs.html">lfsck_tgt_descs</a> {
<a name="l00474"></a>00474         <span class="comment">/* list of known TGTs */</span>
<a name="l00475"></a><a class="code" href="structlfsck__tgt__descs.html#a1f1f57af2b5e0d054d79e7c5c22ec4d2">00475</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__desc__idx.html">lfsck_tgt_desc_idx</a>       *<a class="code" href="structlfsck__tgt__descs.html#a1f1f57af2b5e0d054d79e7c5c22ec4d2">ltd_tgts_idx</a>[<a class="code" href="lfsck__internal_8h.html#a117afde0fc9f7138bf657a5f3e70f00f">TGT_PTRS</a>];
<a name="l00476"></a>00476 
<a name="l00477"></a>00477         <span class="comment">/* bitmap of TGTs available */</span>
<a name="l00478"></a><a class="code" href="structlfsck__tgt__descs.html#aeeb3ae95bbbd52192e944fd413c9ac20">00478</a>         <span class="keyword">struct </span><a class="code" href="structcfs__bitmap.html">cfs_bitmap</a>                       *<a class="code" href="structlfsck__tgt__descs.html#aeeb3ae95bbbd52192e944fd413c9ac20">ltd_tgts_bitmap</a>;
<a name="l00479"></a>00479 
<a name="l00480"></a>00480         <span class="comment">/* for lfsck_tgt_desc::ltd_xxx_list */</span>
<a name="l00481"></a><a class="code" href="structlfsck__tgt__descs.html#a8264f868248f19ec1f6d1996ad57f3a3">00481</a>         spinlock_t                       <a class="code" href="structlfsck__tgt__descs.html#a8264f868248f19ec1f6d1996ad57f3a3">ltd_lock</a>;
<a name="l00482"></a>00482 
<a name="l00483"></a>00483         <span class="comment">/* for tgts table accessing and changes */</span>
<a name="l00484"></a><a class="code" href="structlfsck__tgt__descs.html#a3c6ba316722cbeac27d6c263262b196e">00484</a>         <span class="keyword">struct </span>rw_semaphore              <a class="code" href="structlfsck__tgt__descs.html#a3c6ba316722cbeac27d6c263262b196e">ltd_rw_sem</a>;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486         <span class="comment">/* Temporary list for orphan targets. */</span>
<a name="l00487"></a><a class="code" href="structlfsck__tgt__descs.html#abc4fb368848fa853c45e403d729ac902">00487</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                 <a class="code" href="structlfsck__tgt__descs.html#abc4fb368848fa853c45e403d729ac902">ltd_orphan</a>;
<a name="l00488"></a>00488 
<a name="l00489"></a>00489         <span class="comment">/* number of registered TGTs */</span>
<a name="l00490"></a><a class="code" href="structlfsck__tgt__descs.html#aeba08e030be5eeb7bc18c28711427051">00490</a>         __u32                            <a class="code" href="structlfsck__tgt__descs.html#aeba08e030be5eeb7bc18c28711427051">ltd_tgtnr</a>;
<a name="l00491"></a>00491 };
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__desc.html">lfsck_tgt_desc</a> *
<a name="l00494"></a><a class="code" href="lfsck__internal_8h.html#a2193f42020089643af5541bd7aad7738">00494</a> <a class="code" href="lfsck__internal_8h.html#a2193f42020089643af5541bd7aad7738">lfsck_ltd2tgt</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__tgt__descs.html">lfsck_tgt_descs</a> *ltd, __u32 index)
<a name="l00495"></a>00495 {
<a name="l00496"></a>00496         __u32 idx1 = index / <a class="code" href="lfsck__internal_8h.html#a6f54ff6e890afe3f22f8feb22f7ce69a">TGT_PTRS_PER_BLOCK</a>;
<a name="l00497"></a>00497         __u32 idx2 = index % <a class="code" href="lfsck__internal_8h.html#a6f54ff6e890afe3f22f8feb22f7ce69a">TGT_PTRS_PER_BLOCK</a>;
<a name="l00498"></a>00498         <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__desc.html">lfsck_tgt_desc</a> *__tgt = NULL;
<a name="l00499"></a>00499 
<a name="l00500"></a>00500         <span class="keywordflow">if</span> (<a class="code" href="libcfs__private_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(idx1 &gt;= <a class="code" href="lfsck__internal_8h.html#a117afde0fc9f7138bf657a5f3e70f00f">TGT_PTRS</a>))
<a name="l00501"></a>00501                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(<a class="code" href="libcfs__debug_8h.html#ad5cb9b95c0d24258bd7ed224ed03e367">D_LFSCK</a>, <span class="stringliteral">&quot;The target idx %u is invalid.\n&quot;</span>, index);
<a name="l00502"></a>00502         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="libcfs__private_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a>(ltd-&gt;<a class="code" href="structlfsck__tgt__descs.html#a1f1f57af2b5e0d054d79e7c5c22ec4d2">ltd_tgts_idx</a>[idx1] != NULL))
<a name="l00503"></a>00503                 __tgt = ltd-&gt;<a class="code" href="structlfsck__tgt__descs.html#a1f1f57af2b5e0d054d79e7c5c22ec4d2">ltd_tgts_idx</a>[idx1]-&gt;<a class="code" href="structlfsck__tgt__desc__idx.html#aa97a729f9e1e62a1ab573d61fb36866a">ldi_tgts</a>[idx2];
<a name="l00504"></a>00504 
<a name="l00505"></a>00505         <span class="keywordflow">return</span> __tgt;
<a name="l00506"></a>00506 }
<a name="l00507"></a>00507 
<a name="l00508"></a><a class="code" href="lfsck__internal_8h.html#a25d116de291305e5db73db09daa87e2c">00508</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a25d116de291305e5db73db09daa87e2c">lfsck_assign_tgt</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__tgt__descs.html">lfsck_tgt_descs</a> *ltd,
<a name="l00509"></a>00509                                     <span class="keyword">struct</span> <a class="code" href="structlfsck__tgt__desc.html">lfsck_tgt_desc</a> *tgt, __u32 index)
<a name="l00510"></a>00510 {
<a name="l00511"></a>00511         __u32 idx1 = index / <a class="code" href="lfsck__internal_8h.html#a6f54ff6e890afe3f22f8feb22f7ce69a">TGT_PTRS_PER_BLOCK</a>;
<a name="l00512"></a>00512         __u32 idx2 = index % <a class="code" href="lfsck__internal_8h.html#a6f54ff6e890afe3f22f8feb22f7ce69a">TGT_PTRS_PER_BLOCK</a>;
<a name="l00513"></a>00513 
<a name="l00514"></a>00514         <span class="keywordflow">if</span> (<a class="code" href="libcfs__private_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a>(idx1 &lt; TGT_PTRS &amp;&amp; ltd-&gt;ltd_tgts_idx[idx1] != NULL))
<a name="l00515"></a>00515                 ltd-&gt;<a class="code" href="structlfsck__tgt__descs.html#a1f1f57af2b5e0d054d79e7c5c22ec4d2">ltd_tgts_idx</a>[idx1]-&gt;<a class="code" href="structlfsck__tgt__desc__idx.html#aa97a729f9e1e62a1ab573d61fb36866a">ldi_tgts</a>[idx2] = tgt;
<a name="l00516"></a>00516 }
<a name="l00517"></a>00517 
<a name="l00518"></a><a class="code" href="lfsck__internal_8h.html#a0a12258c4a75fc77951320eeb2c167a8">00518</a> <span class="preprocessor">#define LFSCK_STF_BITS  4</span>
<a name="l00519"></a>00519 <span class="preprocessor"></span><span class="comment">/* If want to adjust the LFSCK_STF_COUNT, please change LFSCK_STF_BITS. */</span>
<a name="l00520"></a><a class="code" href="lfsck__internal_8h.html#a001e112f96436345749574e4f755aeb5">00520</a> <span class="preprocessor">#define LFSCK_STF_COUNT (1 &lt;&lt; LFSCK_STF_BITS)</span>
<a name="l00521"></a>00521 <span class="preprocessor"></span>
<a name="l00522"></a><a class="code" href="structlfsck__sub__trace__obj.html">00522</a> <span class="keyword">struct </span><a class="code" href="structlfsck__sub__trace__obj.html">lfsck_sub_trace_obj</a> {
<a name="l00523"></a><a class="code" href="structlfsck__sub__trace__obj.html#aedbae78c5ff557647edfff8d01dcfcde">00523</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>        *<a class="code" href="structlfsck__sub__trace__obj.html#aedbae78c5ff557647edfff8d01dcfcde">lsto_obj</a>;
<a name="l00524"></a><a class="code" href="structlfsck__sub__trace__obj.html#ad1204ab3074ecfe1e6deb920d4d65fe7">00524</a>         <span class="keyword">struct </span>mutex             <a class="code" href="structlfsck__sub__trace__obj.html#ad1204ab3074ecfe1e6deb920d4d65fe7">lsto_mutex</a>;
<a name="l00525"></a>00525 };
<a name="l00526"></a>00526 
<a name="l00527"></a><a class="code" href="structlfsck__component.html">00527</a> <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> {
<a name="l00528"></a>00528         <span class="comment">/* into lfsck_instance::li_list_(scan,double_scan,idle} */</span>
<a name="l00529"></a><a class="code" href="structlfsck__component.html#ab41f9cfcb4d3f5b75b072fff8f3f7d21">00529</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>         <a class="code" href="structlfsck__component.html#ab41f9cfcb4d3f5b75b072fff8f3f7d21">lc_link</a>;
<a name="l00530"></a>00530 
<a name="l00531"></a>00531         <span class="comment">/* into lfsck_instance::li_list_dir */</span>
<a name="l00532"></a><a class="code" href="structlfsck__component.html#a80ef60317fe6db62ffa20aac45bfd581">00532</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>         <a class="code" href="structlfsck__component.html#a80ef60317fe6db62ffa20aac45bfd581">lc_link_dir</a>;
<a name="l00533"></a>00533 
<a name="l00534"></a><a class="code" href="structlfsck__component.html#ad184a5b716f70553595989d0302e1518">00534</a>         <span class="keyword">struct </span>rw_semaphore      <a class="code" href="structlfsck__component.html#ad184a5b716f70553595989d0302e1518">lc_sem</a>;
<a name="l00535"></a><a class="code" href="structlfsck__component.html#a25ae67201755b306a9068033ff77831d">00535</a>         atomic_t                 <a class="code" href="structlfsck__component.html#a25ae67201755b306a9068033ff77831d">lc_ref</a>;
<a name="l00536"></a>00536 
<a name="l00537"></a><a class="code" href="structlfsck__component.html#a2551759bc5deb5ed85ddefaecb6daaa5">00537</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__position.html">lfsck_position</a>    <a class="code" href="structlfsck__component.html#a2551759bc5deb5ed85ddefaecb6daaa5">lc_pos_start</a>;
<a name="l00538"></a><a class="code" href="structlfsck__component.html#a791bae30ccfab307e3b5aa7829c18eca">00538</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__instance.html">lfsck_instance</a>   *<a class="code" href="structlfsck__component.html#a791bae30ccfab307e3b5aa7829c18eca">lc_lfsck</a>;
<a name="l00539"></a><a class="code" href="structlfsck__component.html#ad0ec2d5887ad39911f807525e54a5d82">00539</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>        *<a class="code" href="structlfsck__component.html#ad0ec2d5887ad39911f807525e54a5d82">lc_obj</a>;
<a name="l00540"></a><a class="code" href="structlfsck__component.html#a594f2261fe6ca3acf78d7ea9b264c7fc">00540</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__sub__trace__obj.html">lfsck_sub_trace_obj</a> <a class="code" href="structlfsck__component.html#a594f2261fe6ca3acf78d7ea9b264c7fc">lc_sub_trace_objs</a>[<a class="code" href="lfsck__internal_8h.html#a001e112f96436345749574e4f755aeb5">LFSCK_STF_COUNT</a>];
<a name="l00541"></a><a class="code" href="structlfsck__component.html#ad99aeeedf3999b43dda660248af44d14">00541</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__operations.html">lfsck_operations</a> *<a class="code" href="structlfsck__component.html#ad99aeeedf3999b43dda660248af44d14">lc_ops</a>;
<a name="l00542"></a><a class="code" href="structlfsck__component.html#a2deb51c3b27862404fdb6f59a79ec571">00542</a>         <span class="keywordtype">void</span>                    *<a class="code" href="structlfsck__component.html#a2deb51c3b27862404fdb6f59a79ec571">lc_file_ram</a>;
<a name="l00543"></a><a class="code" href="structlfsck__component.html#a000814292d24b2ba90bc8f6c24a58c36">00543</a>         <span class="keywordtype">void</span>                    *<a class="code" href="structlfsck__component.html#a000814292d24b2ba90bc8f6c24a58c36">lc_file_disk</a>;
<a name="l00544"></a><a class="code" href="structlfsck__component.html#ac4a031ef8d2120c57936508c6a77f21e">00544</a>         <span class="keywordtype">void</span>                    *<a class="code" href="structlfsck__component.html#ac4a031ef8d2120c57936508c6a77f21e">lc_data</a>;
<a name="l00545"></a><a class="code" href="structlfsck__component.html#a5c395bebf333285a545232bde2af3896">00545</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>            <a class="code" href="structlfsck__component.html#a5c395bebf333285a545232bde2af3896">lc_fid_latest_scanned_phase2</a>;
<a name="l00546"></a>00546 
<a name="l00547"></a>00547         <span class="comment">/* The time for last checkpoint, jiffies */</span>
<a name="l00548"></a><a class="code" href="structlfsck__component.html#adb7176b2160d5c239988f7fc05df8a11">00548</a>         <a class="code" href="linux-time_8h.html#a0e81d053bc8d925f6574c760bbea5ac4">cfs_time_t</a>               <a class="code" href="structlfsck__component.html#adb7176b2160d5c239988f7fc05df8a11">lc_time_last_checkpoint</a>;
<a name="l00549"></a>00549 
<a name="l00550"></a>00550         <span class="comment">/* The time for next checkpoint, jiffies */</span>
<a name="l00551"></a><a class="code" href="structlfsck__component.html#aa3f728253ed5d2090ecb2d7f0ce2f8e6">00551</a>         <a class="code" href="linux-time_8h.html#a0e81d053bc8d925f6574c760bbea5ac4">cfs_time_t</a>               <a class="code" href="structlfsck__component.html#aa3f728253ed5d2090ecb2d7f0ce2f8e6">lc_time_next_checkpoint</a>;
<a name="l00552"></a>00552 
<a name="l00553"></a><a class="code" href="structlfsck__component.html#a552c6f201f27dd9d14d8f41b4ba6cf31">00553</a>         __u32                    <a class="code" href="structlfsck__component.html#a552c6f201f27dd9d14d8f41b4ba6cf31">lc_file_size</a>;
<a name="l00554"></a>00554 
<a name="l00555"></a>00555         <span class="comment">/* How many objects have been checked since last checkpoint. */</span>
<a name="l00556"></a><a class="code" href="structlfsck__component.html#ac2d29442179e4e1f92e17da63ed53526">00556</a>         __u32                    <a class="code" href="structlfsck__component.html#ac2d29442179e4e1f92e17da63ed53526">lc_new_checked</a>;
<a name="l00557"></a>00557 
<a name="l00558"></a>00558         <span class="comment">/* How many objects have been scanned since last sleep. */</span>
<a name="l00559"></a><a class="code" href="structlfsck__component.html#a39ea39f2a7751ca44bc4a19d386b306c">00559</a>         __u32                    <a class="code" href="structlfsck__component.html#a39ea39f2a7751ca44bc4a19d386b306c">lc_new_scanned</a>;
<a name="l00560"></a>00560 
<a name="l00561"></a><a class="code" href="structlfsck__component.html#a03bf4c72d2f986904d5e352696850f77">00561</a>         __u16                    <a class="code" href="structlfsck__component.html#a03bf4c72d2f986904d5e352696850f77">lc_type</a>;
<a name="l00562"></a>00562 };
<a name="l00563"></a>00563 
<a name="l00564"></a><a class="code" href="lfsck__internal_8h.html#a3cd5671d85b056e93ad42c7163dcbefb">00564</a> <span class="preprocessor">#define LFSCK_LMV_MAX_STRIPES   LMV_MAX_STRIPE_COUNT</span>
<a name="l00565"></a><a class="code" href="lfsck__internal_8h.html#abf766b65319f11e27aec9860097ca167">00565</a> <span class="preprocessor"></span><span class="preprocessor">#define LFSCK_LMV_DEF_STRIPES   4</span>
<a name="l00566"></a>00566 <span class="preprocessor"></span>
<a name="l00567"></a>00567 <span class="comment">/* Warning: NOT change the lfsck_slave_lmv_flags members order,</span>
<a name="l00568"></a>00568 <span class="comment"> *          otherwise the lfsck_record_lmv() may be wrong. */</span>
<a name="l00569"></a><a class="code" href="lfsck__internal_8h.html#a86361247977ad8ba066c73786ef924a8">00569</a> <span class="keyword">enum</span> <a class="code" href="lfsck__internal_8h.html#a86361247977ad8ba066c73786ef924a8">lfsck_slave_lmv_flags</a> {
<a name="l00570"></a><a class="code" href="lfsck__internal_8h.html#a86361247977ad8ba066c73786ef924a8a6729067b506e2c74c06e6a2eb24ebaac">00570</a>         <a class="code" href="lfsck__internal_8h.html#a86361247977ad8ba066c73786ef924a8a6729067b506e2c74c06e6a2eb24ebaac">LSLF_NONE</a>       = 0,
<a name="l00571"></a><a class="code" href="lfsck__internal_8h.html#a86361247977ad8ba066c73786ef924a8a6f9fb93416e81f23daa0e48b08fef9ac">00571</a>         <a class="code" href="lfsck__internal_8h.html#a86361247977ad8ba066c73786ef924a8a6f9fb93416e81f23daa0e48b08fef9ac">LSLF_BAD_INDEX2</a> = 1,
<a name="l00572"></a><a class="code" href="lfsck__internal_8h.html#a86361247977ad8ba066c73786ef924a8ab2edd2dee6d7c7fa6a37e2bc45cfeef7">00572</a>         <a class="code" href="lfsck__internal_8h.html#a86361247977ad8ba066c73786ef924a8ab2edd2dee6d7c7fa6a37e2bc45cfeef7">LSLF_NO_LMVEA</a>   = 2,
<a name="l00573"></a><a class="code" href="lfsck__internal_8h.html#a86361247977ad8ba066c73786ef924a8a9018c3c4e64be45180636b753f08952a">00573</a>         <a class="code" href="lfsck__internal_8h.html#a86361247977ad8ba066c73786ef924a8a9018c3c4e64be45180636b753f08952a">LSLF_DANGLING</a>   = 3,
<a name="l00574"></a><a class="code" href="lfsck__internal_8h.html#a86361247977ad8ba066c73786ef924a8a32d3aff2097666b34cd86f22e8df1045">00574</a>         <a class="code" href="lfsck__internal_8h.html#a86361247977ad8ba066c73786ef924a8a32d3aff2097666b34cd86f22e8df1045">LSLF_BAD_INDEX1</a> = 4,
<a name="l00575"></a>00575 };
<a name="l00576"></a>00576 
<a name="l00577"></a>00577 <span class="comment">/* When the namespace LFSCK scans a striped directory, it will record all</span>
<a name="l00578"></a>00578 <span class="comment"> * the known shards&apos; information in the structure &quot;lfsck_slave_lmv_rec&quot;,</span>
<a name="l00579"></a>00579 <span class="comment"> * including the shard&apos;s FID, index, slave LMV EA, and so on. Each shard</span>
<a name="l00580"></a>00580 <span class="comment"> * will take one lfsck_slave_lmv_rec slot. After the 1st cycle scanning</span>
<a name="l00581"></a>00581 <span class="comment"> * the striped directory, the LFSCK will get all the information about</span>
<a name="l00582"></a>00582 <span class="comment"> * whether there are some inconsistency, and then it can repair them in</span>
<a name="l00583"></a>00583 <span class="comment"> * the 2nd cycle scanning. */</span>
<a name="l00584"></a><a class="code" href="structlfsck__slave__lmv__rec.html">00584</a> <span class="keyword">struct </span><a class="code" href="structlfsck__slave__lmv__rec.html">lfsck_slave_lmv_rec</a> {
<a name="l00585"></a><a class="code" href="structlfsck__slave__lmv__rec.html#a3edc6bb1d8dbd3d33a6cf05d766a4797">00585</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>   <a class="code" href="structlfsck__slave__lmv__rec.html#a3edc6bb1d8dbd3d33a6cf05d766a4797">lslr_fid</a>;
<a name="l00586"></a><a class="code" href="structlfsck__slave__lmv__rec.html#a77421b00d048064df1b1d366d57c3708">00586</a>         __u32           <a class="code" href="structlfsck__slave__lmv__rec.html#a77421b00d048064df1b1d366d57c3708">lslr_stripe_count</a>;
<a name="l00587"></a><a class="code" href="structlfsck__slave__lmv__rec.html#af1469d70135ee4241129f7d98f7b525d">00587</a>         __u32           <a class="code" href="structlfsck__slave__lmv__rec.html#af1469d70135ee4241129f7d98f7b525d">lslr_index</a>; <span class="comment">/* the index in name or in slave lmv */</span>
<a name="l00588"></a><a class="code" href="structlfsck__slave__lmv__rec.html#ad480f57f070f4cf4aff94b105372af8c">00588</a>         __u32           <a class="code" href="structlfsck__slave__lmv__rec.html#ad480f57f070f4cf4aff94b105372af8c">lslr_hash_type</a>;
<a name="l00589"></a><a class="code" href="structlfsck__slave__lmv__rec.html#a27681de64d007e9c48007113b8886ff1">00589</a>         __u32           <a class="code" href="structlfsck__slave__lmv__rec.html#a27681de64d007e9c48007113b8886ff1">lslr_flags</a>;
<a name="l00590"></a>00590 };
<a name="l00591"></a>00591 
<a name="l00592"></a><a class="code" href="structlfsck__lmv.html">00592</a> <span class="keyword">struct </span><a class="code" href="structlfsck__lmv.html">lfsck_lmv</a> {
<a name="l00593"></a><a class="code" href="structlfsck__lmv.html#a09a20abf430f7a0fba0aa5b625222074">00593</a>         <span class="keyword">struct </span><a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a>             <a class="code" href="structlfsck__lmv.html#a09a20abf430f7a0fba0aa5b625222074">ll_lmv</a>;
<a name="l00594"></a><a class="code" href="structlfsck__lmv.html#a39df509b0e56628a8eae462537aca505">00594</a>         atomic_t                         <a class="code" href="structlfsck__lmv.html#a39df509b0e56628a8eae462537aca505">ll_ref</a>;
<a name="l00595"></a><a class="code" href="structlfsck__lmv.html#a0b8287884de2d06e7b42f865c262f0a2">00595</a>         <span class="keywordtype">int</span>                              <a class="code" href="structlfsck__lmv.html#a0b8287884de2d06e7b42f865c262f0a2">ll_stripes_allocated</a>;
<a name="l00596"></a><a class="code" href="structlfsck__lmv.html#aa496dae7aa0aac78b1b534bc418fde54">00596</a>         <span class="keywordtype">int</span>                              <a class="code" href="structlfsck__lmv.html#aa496dae7aa0aac78b1b534bc418fde54">ll_stripes_filled</a>;
<a name="l00597"></a><a class="code" href="structlfsck__lmv.html#af0a07861cff48ede000bdd658908fb92">00597</a>         <span class="keywordtype">int</span>                              <a class="code" href="structlfsck__lmv.html#af0a07861cff48ede000bdd658908fb92">ll_exit_value</a>;
<a name="l00598"></a><a class="code" href="structlfsck__lmv.html#a3bd1a603e4aef89035ea8040984b38ba">00598</a>         __u32                            <a class="code" href="structlfsck__lmv.html#a3bd1a603e4aef89035ea8040984b38ba">ll_max_stripe_count</a>;
<a name="l00599"></a><a class="code" href="structlfsck__lmv.html#a911f8b2bcbfe29d0cd803628cb2d70c0">00599</a>         __u32                            <a class="code" href="structlfsck__lmv.html#a911f8b2bcbfe29d0cd803628cb2d70c0">ll_max_filled_off</a>;
<a name="l00600"></a><a class="code" href="structlfsck__lmv.html#a4ab34db6296493861dff09c608ea6530">00600</a>         __u32                            <a class="code" href="structlfsck__lmv.html#a4ab34db6296493861dff09c608ea6530">ll_hash_type</a>;
<a name="l00601"></a><a class="code" href="structlfsck__lmv.html#a1ce0b8fd0dcb52796f3cef793bbc1675">00601</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                     <a class="code" href="structlfsck__lmv.html#ab11551ce7b1d029d022f950c8b112d0a">ll_lmv_master</a>:1,
<a name="l00602"></a>00602                                          <a class="code" href="structlfsck__lmv.html#a622834a8132dc23dab2043587ab42989">ll_lmv_slave</a>:1,
<a name="l00603"></a>00603                                          <a class="code" href="structlfsck__lmv.html#a1ce0b8fd0dcb52796f3cef793bbc1675">ll_lmv_verified</a>:1,
<a name="l00604"></a>00604                                          <a class="code" href="structlfsck__lmv.html#abfc30145ac4c9eda47cfeda33eb2d41d">ll_lmv_updated</a>:1,
<a name="l00605"></a>00605                                          <a class="code" href="structlfsck__lmv.html#a530c74005f2517ff6f59e77ea9f97d09">ll_inline</a>:1,
<a name="l00606"></a>00606                                          <a class="code" href="structlfsck__lmv.html#a38f1659d0d7b8dc5d3f987fbb0960cb5">ll_failed</a>:1,
<a name="l00607"></a>00607                                          <a class="code" href="structlfsck__lmv.html#af244425cc2fdaf3dbae2dcdb11094346">ll_ignore</a>:1;
<a name="l00608"></a><a class="code" href="structlfsck__lmv.html#a336362d57069fe85f44c450ad1c52a44">00608</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__slave__lmv__rec.html">lfsck_slave_lmv_rec</a>      *<a class="code" href="structlfsck__lmv.html#a336362d57069fe85f44c450ad1c52a44">ll_lslr</a>; <span class="comment">/* may be vmalloc&apos;d */</span>
<a name="l00609"></a>00609 };
<a name="l00610"></a>00610 
<a name="l00611"></a>00611 <span class="comment">/* If the namespace LFSCK finds that the master MDT-object of a striped</span>
<a name="l00612"></a>00612 <span class="comment"> * directory lost its master LMV EA, it will re-generate the master LMV</span>
<a name="l00613"></a>00613 <span class="comment"> * EA and notify the LFSCK instance on the MDT on which the striped dir</span>
<a name="l00614"></a>00614 <span class="comment"> * master MDT-object resides to rescan the striped directory. To do that,</span>
<a name="l00615"></a>00615 <span class="comment"> * the notify handler will insert a &quot;lfsck_lmv_unit&quot; structure into the</span>
<a name="l00616"></a>00616 <span class="comment"> * lfsck::li_list_lmv. The LFSCK instance will scan such list from time</span>
<a name="l00617"></a>00617 <span class="comment"> * to time to check whether needs to rescan some stirped directories. */</span>
<a name="l00618"></a><a class="code" href="structlfsck__lmv__unit.html">00618</a> <span class="keyword">struct </span><a class="code" href="structlfsck__lmv__unit.html">lfsck_lmv_unit</a> {
<a name="l00619"></a><a class="code" href="structlfsck__lmv__unit.html#af2ebb1922e7a38edc1ff050129a0194c">00619</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>         <a class="code" href="structlfsck__lmv__unit.html#af2ebb1922e7a38edc1ff050129a0194c">llu_link</a>;
<a name="l00620"></a><a class="code" href="structlfsck__lmv__unit.html#a03e13c05c45710c36a6acb1e8159f405">00620</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__lmv.html">lfsck_lmv</a>         <a class="code" href="structlfsck__lmv__unit.html#a03e13c05c45710c36a6acb1e8159f405">llu_lmv</a>;
<a name="l00621"></a><a class="code" href="structlfsck__lmv__unit.html#a19b316bc3cf7f2565452f64f9b85690e">00621</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>        *<a class="code" href="structlfsck__lmv__unit.html#a19b316bc3cf7f2565452f64f9b85690e">llu_obj</a>;
<a name="l00622"></a><a class="code" href="structlfsck__lmv__unit.html#a9cf930147292399de5220376fd275375">00622</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__instance.html">lfsck_instance</a>   *<a class="code" href="structlfsck__lmv__unit.html#a9cf930147292399de5220376fd275375">llu_lfsck</a>;
<a name="l00623"></a>00623 };
<a name="l00624"></a>00624 
<a name="l00625"></a><a class="code" href="structlfsck__rec__lmv__save.html">00625</a> <span class="keyword">struct </span><a class="code" href="structlfsck__rec__lmv__save.html">lfsck_rec_lmv_save</a> {
<a name="l00626"></a><a class="code" href="structlfsck__rec__lmv__save.html#a7439ad5662a45cc9b60c1b4fb60ee6d6">00626</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>           <a class="code" href="structlfsck__rec__lmv__save.html#a7439ad5662a45cc9b60c1b4fb60ee6d6">lrls_fid</a>;
<a name="l00627"></a><a class="code" href="structlfsck__rec__lmv__save.html#ab758b30515be52fd580457e837c0b9fb">00627</a>         <span class="keyword">struct </span><a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a>    <a class="code" href="structlfsck__rec__lmv__save.html#ab758b30515be52fd580457e837c0b9fb">lrls_lmv</a>;
<a name="l00628"></a>00628 };
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 <span class="comment">/* Allow lfsck_record_lmv() to be called recursively at most three times. */</span>
<a name="l00631"></a><a class="code" href="lfsck__internal_8h.html#ab8d20f766ded5e6401745bb798562869">00631</a> <span class="preprocessor">#define LFSCK_REC_LMV_MAX_DEPTH 3</span>
<a name="l00632"></a>00632 <span class="preprocessor"></span>
<a name="l00633"></a><a class="code" href="structlfsck__instance.html">00633</a> <span class="keyword">struct </span><a class="code" href="structlfsck__instance.html">lfsck_instance</a> {
<a name="l00634"></a><a class="code" href="structlfsck__instance.html#a3d413e2482aa39e91d6ce119cd808406">00634</a>         <span class="keyword">struct </span>mutex              <a class="code" href="structlfsck__instance.html#a3d413e2482aa39e91d6ce119cd808406">li_mutex</a>;
<a name="l00635"></a><a class="code" href="structlfsck__instance.html#a58016959e30f0a22ea7aa7062b069463">00635</a>         spinlock_t                <a class="code" href="structlfsck__instance.html#a58016959e30f0a22ea7aa7062b069463">li_lock</a>;
<a name="l00636"></a>00636 
<a name="l00637"></a>00637         <span class="comment">/* Link into the lfsck_instance_list. */</span>
<a name="l00638"></a><a class="code" href="structlfsck__instance.html#a5a5c48379717d82c7e39957b42f161a8">00638</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>          <a class="code" href="structlfsck__instance.html#a5a5c48379717d82c7e39957b42f161a8">li_link</a>;
<a name="l00639"></a>00639 
<a name="l00640"></a>00640         <span class="comment">/* For the components in (first) scanning via otable-based iteration. */</span>
<a name="l00641"></a><a class="code" href="structlfsck__instance.html#a6d413686d78ab7ee5fa31624dbc37737">00641</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>          <a class="code" href="structlfsck__instance.html#a6d413686d78ab7ee5fa31624dbc37737">li_list_scan</a>;
<a name="l00642"></a>00642 
<a name="l00643"></a>00643         <span class="comment">/* For the components in scanning via directory traversal. Because</span>
<a name="l00644"></a>00644 <span class="comment">         * directory traversal cannot guarantee all the object be scanned,</span>
<a name="l00645"></a>00645 <span class="comment">         * so the component in the li_list_dir must be in li_list_scan. */</span>
<a name="l00646"></a><a class="code" href="structlfsck__instance.html#a9be28bd40061a8f5cac677a79d0e80ac">00646</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>          <a class="code" href="structlfsck__instance.html#a9be28bd40061a8f5cac677a79d0e80ac">li_list_dir</a>;
<a name="l00647"></a>00647 
<a name="l00648"></a>00648         <span class="comment">/* For the components in double scanning. */</span>
<a name="l00649"></a><a class="code" href="structlfsck__instance.html#a6d2e51b5efc2cfe82057014e67f85ef2">00649</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>          <a class="code" href="structlfsck__instance.html#a6d2e51b5efc2cfe82057014e67f85ef2">li_list_double_scan</a>;
<a name="l00650"></a>00650 
<a name="l00651"></a>00651         <span class="comment">/* For the components those are not scanning now. */</span>
<a name="l00652"></a><a class="code" href="structlfsck__instance.html#ae5c19ea0cf62a867414327027e043d3e">00652</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>          <a class="code" href="structlfsck__instance.html#ae5c19ea0cf62a867414327027e043d3e">li_list_idle</a>;
<a name="l00653"></a>00653 
<a name="l00654"></a>00654         <span class="comment">/* For the lfsck_lmv_unit to be handled. */</span>
<a name="l00655"></a><a class="code" href="structlfsck__instance.html#a15aa9426826488518bff9f3145040481">00655</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>          <a class="code" href="structlfsck__instance.html#a15aa9426826488518bff9f3145040481">li_list_lmv</a>;
<a name="l00656"></a>00656 
<a name="l00657"></a><a class="code" href="structlfsck__instance.html#afdb7189ee2d8c1d794744c378bc4d1b3">00657</a>         atomic_t                  <a class="code" href="structlfsck__instance.html#afdb7189ee2d8c1d794744c378bc4d1b3">li_ref</a>;
<a name="l00658"></a><a class="code" href="structlfsck__instance.html#a3639fe21fc9c63aceeb3e18048e1b7c3">00658</a>         atomic_t                  <a class="code" href="structlfsck__instance.html#a3639fe21fc9c63aceeb3e18048e1b7c3">li_double_scan_count</a>;
<a name="l00659"></a><a class="code" href="structlfsck__instance.html#a57abaf77027daf86e148863789dd7e1b">00659</a>         <span class="keyword">struct </span><a class="code" href="structptlrpc__thread.html" title="Definition of server service thread structure.">ptlrpc_thread</a>      <a class="code" href="structlfsck__instance.html#a57abaf77027daf86e148863789dd7e1b">li_thread</a>;
<a name="l00660"></a>00660 
<a name="l00661"></a>00661         <span class="comment">/* The time for last checkpoint, jiffies */</span>
<a name="l00662"></a><a class="code" href="structlfsck__instance.html#a715dd7ab86d39e12fbdb5d91a7e02a4f">00662</a>         <a class="code" href="linux-time_8h.html#a0e81d053bc8d925f6574c760bbea5ac4">cfs_time_t</a>                <a class="code" href="structlfsck__instance.html#a715dd7ab86d39e12fbdb5d91a7e02a4f">li_time_last_checkpoint</a>;
<a name="l00663"></a>00663 
<a name="l00664"></a>00664         <span class="comment">/* The time for next checkpoint, jiffies */</span>
<a name="l00665"></a><a class="code" href="structlfsck__instance.html#a79414ff5c013d08c20c763802b9cd738">00665</a>         <a class="code" href="linux-time_8h.html#a0e81d053bc8d925f6574c760bbea5ac4">cfs_time_t</a>                <a class="code" href="structlfsck__instance.html#a79414ff5c013d08c20c763802b9cd738">li_time_next_checkpoint</a>;
<a name="l00666"></a>00666 
<a name="l00667"></a><a class="code" href="structlfsck__instance.html#ad033520d328050b563b6427bb167e796">00667</a>         <a class="code" href="lustre__lfsck_8h.html#a8f4ffaaacb423380a1d802f1ca7a92dc">lfsck_out_notify</a>          <a class="code" href="structlfsck__instance.html#ad033520d328050b563b6427bb167e796">li_out_notify</a>;
<a name="l00668"></a><a class="code" href="structlfsck__instance.html#a514257a215cbf815c83c0e91f7a1fb75">00668</a>         <span class="keywordtype">void</span>                     *<a class="code" href="structlfsck__instance.html#a514257a215cbf815c83c0e91f7a1fb75">li_out_notify_data</a>;
<a name="l00669"></a><a class="code" href="structlfsck__instance.html#a1f398b1f14c3b9c63d9abf5de4bfacb2">00669</a>         <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a>         *<a class="code" href="structlfsck__instance.html#a1f398b1f14c3b9c63d9abf5de4bfacb2">li_next</a>;
<a name="l00670"></a><a class="code" href="structlfsck__instance.html#ab01f0f90dc2df61195fee7dc3ed8cb70">00670</a>         <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a>         *<a class="code" href="structlfsck__instance.html#ab01f0f90dc2df61195fee7dc3ed8cb70">li_bottom</a>;
<a name="l00671"></a><a class="code" href="structlfsck__instance.html#a7e7122372388df35a299267f616b12c4">00671</a>         <span class="keyword">struct </span><a class="code" href="structobd__device.html">obd_device</a>        *<a class="code" href="structlfsck__instance.html#a7e7122372388df35a299267f616b12c4">li_obd</a>;
<a name="l00672"></a><a class="code" href="structlfsck__instance.html#ac9e69020c8f945f41de3bd1c32ce9f8d">00672</a>         <span class="keyword">struct </span><a class="code" href="structldlm__namespace.html" title="LDLM Namespace.">ldlm_namespace</a>    *<a class="code" href="structlfsck__instance.html#ac9e69020c8f945f41de3bd1c32ce9f8d">li_namespace</a>;
<a name="l00673"></a><a class="code" href="structlfsck__instance.html#abee2c73cf8bb85a1dc2f100b89144c5b">00673</a>         <span class="keyword">struct </span><a class="code" href="structlocal__oid__storage.html">local_oid_storage</a> *<a class="code" href="structlfsck__instance.html#abee2c73cf8bb85a1dc2f100b89144c5b">li_los</a>;
<a name="l00674"></a><a class="code" href="structlfsck__instance.html#aa6367b8a59aae71d6c199d34bc2415c6">00674</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>             <a class="code" href="structlfsck__instance.html#aa6367b8a59aae71d6c199d34bc2415c6">li_local_root_fid</a>;  <span class="comment">/* backend root &quot;/&quot; */</span>
<a name="l00675"></a><a class="code" href="structlfsck__instance.html#ac09eb45967ab54d3397e1b7daa608018">00675</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>             <a class="code" href="structlfsck__instance.html#ac09eb45967ab54d3397e1b7daa608018">li_global_root_fid</a>; <span class="comment">/* /ROOT */</span>
<a name="l00676"></a><a class="code" href="structlfsck__instance.html#acb1393cc2c437369dac869eda24fbed8">00676</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>         *<a class="code" href="structlfsck__instance.html#acb1393cc2c437369dac869eda24fbed8">li_lfsck_dir</a>;
<a name="l00677"></a><a class="code" href="structlfsck__instance.html#a59c2014acb1e2e5cb75d857870d81db6">00677</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>         *<a class="code" href="structlfsck__instance.html#a59c2014acb1e2e5cb75d857870d81db6">li_bookmark_obj</a>;
<a name="l00678"></a><a class="code" href="structlfsck__instance.html#af630c7151235ceeec6f6e170e691ec58">00678</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>         *<a class="code" href="structlfsck__instance.html#af630c7151235ceeec6f6e170e691ec58">li_lpf_obj</a>;
<a name="l00679"></a><a class="code" href="structlfsck__instance.html#a6fa03b45a9d83e6a7c73cc1caed8144f">00679</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>         *<a class="code" href="structlfsck__instance.html#a6fa03b45a9d83e6a7c73cc1caed8144f">li_lpf_root_obj</a>;
<a name="l00680"></a><a class="code" href="structlfsck__instance.html#a222c8deb6f0fe6033d649e11cbe0ddb5">00680</a>         <span class="keyword">struct </span><a class="code" href="structlu__client__seq.html">lu_client_seq</a>     *<a class="code" href="structlfsck__instance.html#a222c8deb6f0fe6033d649e11cbe0ddb5">li_seq</a>;
<a name="l00681"></a><a class="code" href="structlfsck__instance.html#a3bd0f734a3b2e9c13aae7878e26f086c">00681</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__bookmark.html">lfsck_bookmark</a>     <a class="code" href="structlfsck__instance.html#a3bd0f734a3b2e9c13aae7878e26f086c">li_bookmark_ram</a>;
<a name="l00682"></a><a class="code" href="structlfsck__instance.html#a33975c56677153e41bf12008c4277234">00682</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__bookmark.html">lfsck_bookmark</a>     <a class="code" href="structlfsck__instance.html#a33975c56677153e41bf12008c4277234">li_bookmark_disk</a>;
<a name="l00683"></a><a class="code" href="structlfsck__instance.html#aa73a7b25f9692748b6a71ec6a02d9253">00683</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__position.html">lfsck_position</a>     <a class="code" href="structlfsck__instance.html#aa73a7b25f9692748b6a71ec6a02d9253">li_pos_current</a>;
<a name="l00684"></a><a class="code" href="structlfsck__instance.html#abae05e92cfd5191409b5b04395df1acb">00684</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__position.html">lfsck_position</a>     <a class="code" href="structlfsck__instance.html#abae05e92cfd5191409b5b04395df1acb">li_pos_checkpoint</a>;
<a name="l00685"></a>00685 
<a name="l00686"></a><a class="code" href="structlfsck__instance.html#a4efbd4e74f68746ee3602b1b05b41e72">00686</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__lmv.html">lfsck_lmv</a>         *<a class="code" href="structlfsck__instance.html#a4efbd4e74f68746ee3602b1b05b41e72">li_lmv</a>;
<a name="l00687"></a>00687 
<a name="l00688"></a>00688         <span class="comment">/* Obj for otable-based iteration */</span>
<a name="l00689"></a><a class="code" href="structlfsck__instance.html#a681f9cf12c5cdef26815f44327ff3a06">00689</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>         *<a class="code" href="structlfsck__instance.html#a681f9cf12c5cdef26815f44327ff3a06">li_obj_oit</a>;
<a name="l00690"></a>00690 
<a name="l00691"></a>00691         <span class="comment">/* Obj for directory traversal */</span>
<a name="l00692"></a><a class="code" href="structlfsck__instance.html#aa0af50721299e83e43f049dd0c10e140">00692</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>         *<a class="code" href="structlfsck__instance.html#aa0af50721299e83e43f049dd0c10e140">li_obj_dir</a>;
<a name="l00693"></a>00693 
<a name="l00694"></a>00694         <span class="comment">/* It for otable-based iteration */</span>
<a name="l00695"></a><a class="code" href="structlfsck__instance.html#a1d20f31927232f9367e0b412d0b85bb0">00695</a>         <span class="keyword">struct </span>dt_it             *<a class="code" href="structlfsck__instance.html#a1d20f31927232f9367e0b412d0b85bb0">li_di_oit</a>;
<a name="l00696"></a>00696 
<a name="l00697"></a>00697         <span class="comment">/* It for directory traversal */</span>
<a name="l00698"></a><a class="code" href="structlfsck__instance.html#ae67a264bcd34d4b5f40bfcb7ce2b88ea">00698</a>         <span class="keyword">struct </span>dt_it             *<a class="code" href="structlfsck__instance.html#ae67a264bcd34d4b5f40bfcb7ce2b88ea">li_di_dir</a>;
<a name="l00699"></a>00699 
<a name="l00700"></a>00700         <span class="comment">/* Description of OST */</span>
<a name="l00701"></a><a class="code" href="structlfsck__instance.html#a1d46b456d7470c718256582b1f831aef">00701</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__descs.html">lfsck_tgt_descs</a>    <a class="code" href="structlfsck__instance.html#a1d46b456d7470c718256582b1f831aef">li_ost_descs</a>;
<a name="l00702"></a>00702 
<a name="l00703"></a>00703         <span class="comment">/* Description of MDT */</span>
<a name="l00704"></a><a class="code" href="structlfsck__instance.html#afaa6d0ab393910e52080541251e20643">00704</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__descs.html">lfsck_tgt_descs</a>    <a class="code" href="structlfsck__instance.html#afaa6d0ab393910e52080541251e20643">li_mdt_descs</a>;
<a name="l00705"></a>00705 
<a name="l00706"></a>00706         <span class="comment">/* namespace-based directory traversal position. */</span>
<a name="l00707"></a><a class="code" href="structlfsck__instance.html#a6a955e7f578cc603550bd1fd4904b97d">00707</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                     <a class="code" href="structlfsck__instance.html#a6a955e7f578cc603550bd1fd4904b97d">li_cookie_dir</a>;
<a name="l00708"></a>00708 
<a name="l00709"></a>00709         <span class="comment">/* Arguments for low layer otable-based iteration. */</span>
<a name="l00710"></a><a class="code" href="structlfsck__instance.html#a818ab4eaa73b01c2b331b09b29cdecb2">00710</a>         __u32                     <a class="code" href="structlfsck__instance.html#a818ab4eaa73b01c2b331b09b29cdecb2">li_args_oit</a>;
<a name="l00711"></a>00711 
<a name="l00712"></a>00712         <span class="comment">/* Arugments for namespace-based directory traversal. */</span>
<a name="l00713"></a><a class="code" href="structlfsck__instance.html#abd7820e4b0e778d466e4b65f1bc50ec2">00713</a>         __u32                     <a class="code" href="structlfsck__instance.html#abd7820e4b0e778d466e4b65f1bc50ec2">li_args_dir</a>;
<a name="l00714"></a>00714 
<a name="l00715"></a>00715         <span class="comment">/* Schedule for every N objects. */</span>
<a name="l00716"></a><a class="code" href="structlfsck__instance.html#a49179bbc64c0c3aa3320bdf340b0f752">00716</a>         __u32                     <a class="code" href="structlfsck__instance.html#a49179bbc64c0c3aa3320bdf340b0f752">li_sleep_rate</a>;
<a name="l00717"></a>00717 
<a name="l00718"></a>00718         <span class="comment">/* Sleep N jiffies for each schedule. */</span>
<a name="l00719"></a><a class="code" href="structlfsck__instance.html#a7d454fbd0139890992542440dadd64e9">00719</a>         __u32                     <a class="code" href="structlfsck__instance.html#a7d454fbd0139890992542440dadd64e9">li_sleep_jif</a>;
<a name="l00720"></a>00720 
<a name="l00721"></a>00721         <span class="comment">/* How many objects have been scanned since last sleep. */</span>
<a name="l00722"></a><a class="code" href="structlfsck__instance.html#abbe7a555bfcf88403fa583aa996473ea">00722</a>         __u32                     <a class="code" href="structlfsck__instance.html#abbe7a555bfcf88403fa583aa996473ea">li_new_scanned</a>;
<a name="l00723"></a>00723 
<a name="l00724"></a>00724         <span class="comment">/* The status when the LFSCK stopped or paused. */</span>
<a name="l00725"></a><a class="code" href="structlfsck__instance.html#a019653fe7dddde06c0bfbbd4b25ac1e0">00725</a>         __u32                     <a class="code" href="structlfsck__instance.html#a019653fe7dddde06c0bfbbd4b25ac1e0">li_status</a>;
<a name="l00726"></a>00726 
<a name="l00727"></a>00727         <span class="comment">/* The flags when the lFSCK stopped or paused. */</span>
<a name="l00728"></a><a class="code" href="structlfsck__instance.html#a3b229a2b62eb93a648752522972b0844">00728</a>         __u32                     <a class="code" href="structlfsck__instance.html#a3b229a2b62eb93a648752522972b0844">li_flags</a>;
<a name="l00729"></a>00729 
<a name="l00730"></a><a class="code" href="structlfsck__instance.html#a88108df9e89a2a220cca2ff851f3bf18">00730</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>              <a class="code" href="structlfsck__instance.html#a92f2c62be3da559d1f6ae753644f65f9">li_oit_over</a>:1, <span class="comment">/* oit is finished. */</span>
<a name="l00731"></a>00731                                   <a class="code" href="structlfsck__instance.html#aab9c90ed9017f808584ba6820bcd7624">li_drop_dryrun</a>:1, <span class="comment">/* Ever dryrun, not now. */</span>
<a name="l00732"></a>00732                                   <a class="code" href="structlfsck__instance.html#ab40e5646cf4f396073f4008c276ac8a0">li_master</a>:1, <span class="comment">/* Master instance or not. */</span>
<a name="l00733"></a>00733                                   <a class="code" href="structlfsck__instance.html#a9cf7e52d93e7946b4f652b365964112e">li_current_oit_processed</a>:1,
<a name="l00734"></a>00734                                   <a class="code" href="structlfsck__instance.html#a88108df9e89a2a220cca2ff851f3bf18">li_start_unplug</a>:1;
<a name="l00735"></a><a class="code" href="structlfsck__instance.html#a393909d23652b63d5a6070cb4c03cbbd">00735</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__rec__lmv__save.html">lfsck_rec_lmv_save</a> <a class="code" href="structlfsck__instance.html#a393909d23652b63d5a6070cb4c03cbbd">li_rec_lmv_save</a>[<a class="code" href="lfsck__internal_8h.html#ab8d20f766ded5e6401745bb798562869">LFSCK_REC_LMV_MAX_DEPTH</a>];
<a name="l00736"></a>00736 };
<a name="l00737"></a>00737 
<a name="l00738"></a><a class="code" href="structlfsck__async__interpret__args.html">00738</a> <span class="keyword">struct </span><a class="code" href="structlfsck__async__interpret__args.html">lfsck_async_interpret_args</a> {
<a name="l00739"></a><a class="code" href="structlfsck__async__interpret__args.html#af1d2dbbc9face722e36e20a1a495771c">00739</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a>          *<a class="code" href="structlfsck__async__interpret__args.html#af1d2dbbc9face722e36e20a1a495771c">laia_com</a>;
<a name="l00740"></a><a class="code" href="structlfsck__async__interpret__args.html#a1a146c5e5ea84cfed1f11aa0591e7ef3">00740</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__descs.html">lfsck_tgt_descs</a>          *<a class="code" href="structlfsck__async__interpret__args.html#a1a146c5e5ea84cfed1f11aa0591e7ef3">laia_ltds</a>;
<a name="l00741"></a><a class="code" href="structlfsck__async__interpret__args.html#ae21c9195d44e6283d0c884cd9ce60219">00741</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__desc.html">lfsck_tgt_desc</a>           *<a class="code" href="structlfsck__async__interpret__args.html#ae21c9195d44e6283d0c884cd9ce60219">laia_ltd</a>;
<a name="l00742"></a><a class="code" href="structlfsck__async__interpret__args.html#aa67059d6005652ba152a8ff82181bf81">00742</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__request.html">lfsck_request</a>            *<a class="code" href="structlfsck__async__interpret__args.html#aa67059d6005652ba152a8ff82181bf81">laia_lr</a>;
<a name="l00743"></a><a class="code" href="structlfsck__async__interpret__args.html#a51e82a4c2de3759e65450bb60ab569d9">00743</a>         atomic_t                        *<a class="code" href="structlfsck__async__interpret__args.html#a51e82a4c2de3759e65450bb60ab569d9">laia_count</a>;
<a name="l00744"></a><a class="code" href="structlfsck__async__interpret__args.html#ab3dd703bad00528305181b2c7c0215cb">00744</a>         <span class="keywordtype">int</span>                              <a class="code" href="structlfsck__async__interpret__args.html#ab3dd703bad00528305181b2c7c0215cb">laia_result</a>;
<a name="l00745"></a><a class="code" href="structlfsck__async__interpret__args.html#a54f6b3729f197985e18e33c829a4be10">00745</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                     <a class="code" href="structlfsck__async__interpret__args.html#a54f6b3729f197985e18e33c829a4be10">laia_shared</a>:1;
<a name="l00746"></a>00746 };
<a name="l00747"></a>00747 
<a name="l00748"></a><a class="code" href="structlfsck__thread__args.html">00748</a> <span class="keyword">struct </span><a class="code" href="structlfsck__thread__args.html">lfsck_thread_args</a> {
<a name="l00749"></a><a class="code" href="structlfsck__thread__args.html#a9f254d7f55e230fc9d0f7e45acaf69ea">00749</a>         <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a>                    <a class="code" href="structlfsck__thread__args.html#a9f254d7f55e230fc9d0f7e45acaf69ea">lta_env</a>;
<a name="l00750"></a><a class="code" href="structlfsck__thread__args.html#ac7ec09cefda0ce034de7ade483805951">00750</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__instance.html">lfsck_instance</a>           *<a class="code" href="structlfsck__thread__args.html#ac7ec09cefda0ce034de7ade483805951">lta_lfsck</a>;
<a name="l00751"></a><a class="code" href="structlfsck__thread__args.html#ae8dc768df81b9d09a11b0ad67799cd8e">00751</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a>          *<a class="code" href="structlfsck__thread__args.html#ae8dc768df81b9d09a11b0ad67799cd8e">lta_com</a>;
<a name="l00752"></a><a class="code" href="structlfsck__thread__args.html#a5b7de860d7fb6ccd073d760f9ed8dcf1">00752</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__start__param.html">lfsck_start_param</a>        *<a class="code" href="structlfsck__thread__args.html#a5b7de860d7fb6ccd073d760f9ed8dcf1">lta_lsp</a>;
<a name="l00753"></a>00753 };
<a name="l00754"></a>00754 
<a name="l00755"></a><a class="code" href="structlfsck__assistant__req.html">00755</a> <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__req.html">lfsck_assistant_req</a> {
<a name="l00756"></a><a class="code" href="structlfsck__assistant__req.html#a61d7fe22d235a248336e078b03221036">00756</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                 <a class="code" href="structlfsck__assistant__req.html#a61d7fe22d235a248336e078b03221036">lar_list</a>;
<a name="l00757"></a><a class="code" href="structlfsck__assistant__req.html#a6d2f9e2bd96b444db360604b7c63937c">00757</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__object.html">lfsck_assistant_object</a>   *<a class="code" href="structlfsck__assistant__req.html#a6d2f9e2bd96b444db360604b7c63937c">lar_parent</a>;
<a name="l00758"></a>00758 };
<a name="l00759"></a>00759 
<a name="l00760"></a><a class="code" href="structlfsck__namespace__req.html">00760</a> <span class="keyword">struct </span><a class="code" href="structlfsck__namespace__req.html">lfsck_namespace_req</a> {
<a name="l00761"></a><a class="code" href="structlfsck__namespace__req.html#a242b19053a82df0e27d813eda94002ae">00761</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__req.html">lfsck_assistant_req</a>       <a class="code" href="structlfsck__namespace__req.html#a242b19053a82df0e27d813eda94002ae">lnr_lar</a>;
<a name="l00762"></a><a class="code" href="structlfsck__namespace__req.html#a79a016c1d8f8d164605e9ece0ffe9ef5">00762</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__lmv.html">lfsck_lmv</a>                *<a class="code" href="structlfsck__namespace__req.html#a79a016c1d8f8d164605e9ece0ffe9ef5">lnr_lmv</a>;
<a name="l00763"></a><a class="code" href="structlfsck__namespace__req.html#a125392d6b958c6a594668464772bda20">00763</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>                    <a class="code" href="structlfsck__namespace__req.html#a125392d6b958c6a594668464772bda20">lnr_fid</a>;
<a name="l00764"></a><a class="code" href="structlfsck__namespace__req.html#ac7c8d18f2974325739fd3a378ef0586b">00764</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                            <a class="code" href="structlfsck__namespace__req.html#ac7c8d18f2974325739fd3a378ef0586b">lnr_dir_cookie</a>;
<a name="l00765"></a><a class="code" href="structlfsck__namespace__req.html#a2532fa6234d8e01a0d80d5dcd86b776b">00765</a>         __u32                            <a class="code" href="structlfsck__namespace__req.html#a2532fa6234d8e01a0d80d5dcd86b776b">lnr_attr</a>;
<a name="l00766"></a><a class="code" href="structlfsck__namespace__req.html#a540d4dc9a9259a8254922344bc544897">00766</a>         __u32                            <a class="code" href="structlfsck__namespace__req.html#a540d4dc9a9259a8254922344bc544897">lnr_size</a>;
<a name="l00767"></a><a class="code" href="structlfsck__namespace__req.html#a45489d84e73be27e51a34d14eecf5b68">00767</a>         __u16                            <a class="code" href="structlfsck__namespace__req.html#a45489d84e73be27e51a34d14eecf5b68">lnr_type</a>;
<a name="l00768"></a><a class="code" href="structlfsck__namespace__req.html#a45a8f2712d6d484fd1f191c6967233c6">00768</a>         __u16                            <a class="code" href="structlfsck__namespace__req.html#a45a8f2712d6d484fd1f191c6967233c6">lnr_namelen</a>;
<a name="l00769"></a><a class="code" href="structlfsck__namespace__req.html#aab29283f2e847462f8c024c884512eec">00769</a>         <span class="keywordtype">char</span>                             <a class="code" href="structlfsck__namespace__req.html#aab29283f2e847462f8c024c884512eec">lnr_name</a>[0];
<a name="l00770"></a>00770 };
<a name="l00771"></a>00771 
<a name="l00772"></a><a class="code" href="structlfsck__layout__req.html">00772</a> <span class="keyword">struct </span><a class="code" href="structlfsck__layout__req.html">lfsck_layout_req</a> {
<a name="l00773"></a><a class="code" href="structlfsck__layout__req.html#af9f4b858d443c5b677b7b5aa03c5a402">00773</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__req.html">lfsck_assistant_req</a>       <a class="code" href="structlfsck__layout__req.html#af9f4b858d443c5b677b7b5aa03c5a402">llr_lar</a>;
<a name="l00774"></a><a class="code" href="structlfsck__layout__req.html#a33a0b1786f02dc89ec7005b6245276b7">00774</a>         <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a>                *<a class="code" href="structlfsck__layout__req.html#a33a0b1786f02dc89ec7005b6245276b7">llr_child</a>;
<a name="l00775"></a><a class="code" href="structlfsck__layout__req.html#ab8377fd48d2ccc7a94fe166795a68fbe">00775</a>         __u32                            <a class="code" href="structlfsck__layout__req.html#ab8377fd48d2ccc7a94fe166795a68fbe">llr_ost_idx</a>;
<a name="l00776"></a><a class="code" href="structlfsck__layout__req.html#add2cc8ddec6f36727635ba5307f98a30">00776</a>         __u32                            <a class="code" href="structlfsck__layout__req.html#add2cc8ddec6f36727635ba5307f98a30">llr_lov_idx</a>; <span class="comment">/* offset in LOV EA */</span>
<a name="l00777"></a>00777 };
<a name="l00778"></a>00778 
<a name="l00779"></a><a class="code" href="structlfsck__assistant__operations.html">00779</a> <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__operations.html">lfsck_assistant_operations</a> {
<a name="l00780"></a>00780         int (*<a class="code" href="structlfsck__assistant__operations.html#ac72b81752b3e68d507135580e7d1312e">la_handler_p1</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00781"></a>00781                              <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00782"></a>00782                              <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__req.html">lfsck_assistant_req</a> *lar);
<a name="l00783"></a>00783 
<a name="l00784"></a>00784         int (*<a class="code" href="structlfsck__assistant__operations.html#a0595011e4f5f571f5fec77e77bdebfbd">la_handler_p2</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00785"></a>00785                              <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com);
<a name="l00786"></a>00786 
<a name="l00787"></a>00787         void (*<a class="code" href="structlfsck__assistant__operations.html#af96714cea710e972beb127ff305fd55f">la_fill_pos</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00788"></a>00788                             <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00789"></a>00789                             <span class="keyword">struct </span><a class="code" href="structlfsck__position.html">lfsck_position</a> *pos);
<a name="l00790"></a>00790 
<a name="l00791"></a>00791         int (*<a class="code" href="structlfsck__assistant__operations.html#a4685cd01fa262cb4103be7c925cd8738">la_double_scan_result</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00792"></a>00792                                      <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00793"></a>00793                                      <span class="keywordtype">int</span> rc);
<a name="l00794"></a>00794 
<a name="l00795"></a>00795         void (*<a class="code" href="structlfsck__assistant__operations.html#a5bf116339a7158c05aa075cbbde2133d">la_req_fini</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00796"></a>00796                             <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__req.html">lfsck_assistant_req</a> *lar);
<a name="l00797"></a>00797 
<a name="l00798"></a>00798         void (*<a class="code" href="structlfsck__assistant__operations.html#a866b7666c49b25f5dfa2518f0b26c051">la_sync_failures</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00799"></a>00799                                  <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00800"></a>00800                                  <span class="keyword">struct </span><a class="code" href="structlfsck__request.html">lfsck_request</a> *lr);
<a name="l00801"></a>00801 };
<a name="l00802"></a>00802 
<a name="l00803"></a><a class="code" href="structlfsck__assistant__data.html">00803</a> <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__data.html">lfsck_assistant_data</a> {
<a name="l00804"></a><a class="code" href="structlfsck__assistant__data.html#ab0e8ae734a50b3f9760795ed76a0a6bc">00804</a>         spinlock_t                               <a class="code" href="structlfsck__assistant__data.html#ab0e8ae734a50b3f9760795ed76a0a6bc">lad_lock</a>;
<a name="l00805"></a><a class="code" href="structlfsck__assistant__data.html#a2bd45e08614dd25b81068451c3317a2e">00805</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                         <a class="code" href="structlfsck__assistant__data.html#a2bd45e08614dd25b81068451c3317a2e">lad_req_list</a>;
<a name="l00806"></a>00806 
<a name="l00807"></a>00807         <span class="comment">/* list for the ost targets involve LFSCK. */</span>
<a name="l00808"></a><a class="code" href="structlfsck__assistant__data.html#a20cf34b92a39b9ac29ab2f48c2ea6fea">00808</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                         <a class="code" href="structlfsck__assistant__data.html#a20cf34b92a39b9ac29ab2f48c2ea6fea">lad_ost_list</a>;
<a name="l00809"></a>00809 
<a name="l00810"></a>00810         <span class="comment">/* list for the ost targets in phase1 scanning. */</span>
<a name="l00811"></a><a class="code" href="structlfsck__assistant__data.html#a322d2d110f1faf06d5c1f1e17719dfd1">00811</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                         <a class="code" href="structlfsck__assistant__data.html#a322d2d110f1faf06d5c1f1e17719dfd1">lad_ost_phase1_list</a>;
<a name="l00812"></a>00812 
<a name="l00813"></a>00813         <span class="comment">/* list for the ost targets in phase2 scanning. */</span>
<a name="l00814"></a><a class="code" href="structlfsck__assistant__data.html#ad87542de9120386cb4b916cd0c591b27">00814</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                         <a class="code" href="structlfsck__assistant__data.html#ad87542de9120386cb4b916cd0c591b27">lad_ost_phase2_list</a>;
<a name="l00815"></a>00815 
<a name="l00816"></a>00816         <span class="comment">/* list for the mdt targets involve LFSCK. */</span>
<a name="l00817"></a><a class="code" href="structlfsck__assistant__data.html#a8a7b23d608b4f97641a138312c73334e">00817</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                         <a class="code" href="structlfsck__assistant__data.html#a8a7b23d608b4f97641a138312c73334e">lad_mdt_list</a>;
<a name="l00818"></a>00818 
<a name="l00819"></a>00819         <span class="comment">/* list for the mdt targets in phase1 scanning. */</span>
<a name="l00820"></a><a class="code" href="structlfsck__assistant__data.html#a4a8a745291816a7a44c77fafd1f0a9eb">00820</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                         <a class="code" href="structlfsck__assistant__data.html#a4a8a745291816a7a44c77fafd1f0a9eb">lad_mdt_phase1_list</a>;
<a name="l00821"></a>00821 
<a name="l00822"></a>00822         <span class="comment">/* list for the mdt targets in phase2 scanning. */</span>
<a name="l00823"></a><a class="code" href="structlfsck__assistant__data.html#a9da01cf0368200b76148def22aa02014">00823</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>                         <a class="code" href="structlfsck__assistant__data.html#a9da01cf0368200b76148def22aa02014">lad_mdt_phase2_list</a>;
<a name="l00824"></a>00824 
<a name="l00825"></a><a class="code" href="structlfsck__assistant__data.html#a9946438d66bb2be0d70783f3c48df52c">00825</a>         <span class="keyword">const</span> <span class="keywordtype">char</span>                              *<a class="code" href="structlfsck__assistant__data.html#a9946438d66bb2be0d70783f3c48df52c">lad_name</a>;
<a name="l00826"></a><a class="code" href="structlfsck__assistant__data.html#abf841b52ec678bc6eccca5b3f1e2414f">00826</a>         <span class="keyword">struct </span><a class="code" href="structptlrpc__thread.html" title="Definition of server service thread structure.">ptlrpc_thread</a>                     <a class="code" href="structlfsck__assistant__data.html#abf841b52ec678bc6eccca5b3f1e2414f">lad_thread</a>;
<a name="l00827"></a><a class="code" href="structlfsck__assistant__data.html#aee2f59e994cb9928dd7480d49ce469bb">00827</a>         <span class="keyword">struct </span>task_struct                      *<a class="code" href="structlfsck__assistant__data.html#aee2f59e994cb9928dd7480d49ce469bb">lad_task</a>;
<a name="l00828"></a>00828 
<a name="l00829"></a><a class="code" href="structlfsck__assistant__data.html#a414c5f2f78b1a19026633c14590e94ff">00829</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__operations.html">lfsck_assistant_operations</a>       *<a class="code" href="structlfsck__assistant__data.html#a414c5f2f78b1a19026633c14590e94ff">lad_ops</a>;
<a name="l00830"></a>00830 
<a name="l00831"></a><a class="code" href="structlfsck__assistant__data.html#a277c7b8f2e0ab1a1505a6ebb49a55854">00831</a>         <span class="keyword">struct </span><a class="code" href="structcfs__bitmap.html">cfs_bitmap</a>                               *<a class="code" href="structlfsck__assistant__data.html#a277c7b8f2e0ab1a1505a6ebb49a55854">lad_bitmap</a>;
<a name="l00832"></a>00832 
<a name="l00833"></a><a class="code" href="structlfsck__assistant__data.html#a13c547fbb1ed941a42b2b7bf55a40569">00833</a>         __u32                                    <a class="code" href="structlfsck__assistant__data.html#a13c547fbb1ed941a42b2b7bf55a40569">lad_touch_gen</a>;
<a name="l00834"></a><a class="code" href="structlfsck__assistant__data.html#a3c6ee9a3a668e6caa5e3848576b955f8">00834</a>         <span class="keywordtype">int</span>                                      <a class="code" href="structlfsck__assistant__data.html#a3c6ee9a3a668e6caa5e3848576b955f8">lad_prefetched</a>;
<a name="l00835"></a><a class="code" href="structlfsck__assistant__data.html#abe287e49b37aeaa28f7ff931f2fb9833">00835</a>         <span class="keywordtype">int</span>                                      <a class="code" href="structlfsck__assistant__data.html#abe287e49b37aeaa28f7ff931f2fb9833">lad_assistant_status</a>;
<a name="l00836"></a><a class="code" href="structlfsck__assistant__data.html#a18ed4683883abe2cd0d2ec44299aa262">00836</a>         <span class="keywordtype">int</span>                                      <a class="code" href="structlfsck__assistant__data.html#a18ed4683883abe2cd0d2ec44299aa262">lad_post_result</a>;
<a name="l00837"></a><a class="code" href="structlfsck__assistant__data.html#a683338eaa755f47acaa111df47054f6a">00837</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                             <a class="code" href="structlfsck__assistant__data.html#a683338eaa755f47acaa111df47054f6a">lad_to_post</a>:1,
<a name="l00838"></a>00838                                                  <a class="code" href="structlfsck__assistant__data.html#a663b443a566a4dabd91abf32f0a6855d">lad_to_double_scan</a>:1,
<a name="l00839"></a>00839                                                  <a class="code" href="structlfsck__assistant__data.html#a4a8c374df9906303ac792af3b6a46713">lad_in_double_scan</a>:1,
<a name="l00840"></a>00840                                                  <a class="code" href="structlfsck__assistant__data.html#a3b31a04b53fe955e1755f3e930f60395">lad_exit</a>:1,
<a name="l00841"></a>00841                                                  <a class="code" href="structlfsck__assistant__data.html#a519b2c5b5995e838842330855c4948d0">lad_incomplete</a>:1;
<a name="l00842"></a><a class="code" href="structlfsck__assistant__data.html#a7c83df5a318a1b156bb623eb99dcce5a">00842</a>         <span class="keywordtype">bool</span>                                     <a class="code" href="structlfsck__assistant__data.html#a7c83df5a318a1b156bb623eb99dcce5a">lad_advance_lock</a>;
<a name="l00843"></a>00843 };
<a name="l00844"></a>00844 
<a name="l00845"></a><a class="code" href="lfsck__internal_8h.html#a36ecf822caad5be9e2d8c92bb0f527da">00845</a> <span class="preprocessor">#define LFSCK_TMPBUF_LEN        64</span>
<a name="l00846"></a>00846 <span class="preprocessor"></span>
<a name="l00847"></a><a class="code" href="structlfsck__lock__handle.html">00847</a> <span class="keyword">struct </span><a class="code" href="structlfsck__lock__handle.html">lfsck_lock_handle</a> {
<a name="l00848"></a><a class="code" href="structlfsck__lock__handle.html#a4a9f369880dfc9ed84fc78f9f26586da">00848</a>         <span class="keyword">struct </span><a class="code" href="structlustre__handle.html">lustre_handle</a>    <a class="code" href="structlfsck__lock__handle.html#a4a9f369880dfc9ed84fc78f9f26586da">llh_pdo_lh</a>;
<a name="l00849"></a><a class="code" href="structlfsck__lock__handle.html#a160bddb45ae49c9fe9f90cc5f43261cd">00849</a>         <span class="keyword">struct </span><a class="code" href="structlustre__handle.html">lustre_handle</a>    <a class="code" href="structlfsck__lock__handle.html#a160bddb45ae49c9fe9f90cc5f43261cd">llh_reg_lh</a>;
<a name="l00850"></a><a class="code" href="structlfsck__lock__handle.html#a2bcc982b2bfdff72696d90dbcbc36fc4">00850</a>         <span class="keyword">enum</span> <a class="code" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a>          <a class="code" href="structlfsck__lock__handle.html#a2bcc982b2bfdff72696d90dbcbc36fc4">llh_pdo_mode</a>;
<a name="l00851"></a><a class="code" href="structlfsck__lock__handle.html#a55a7310254fb4b4fe3a565ba5853bff0">00851</a>         <span class="keyword">enum</span> <a class="code" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a>          <a class="code" href="structlfsck__lock__handle.html#a55a7310254fb4b4fe3a565ba5853bff0">llh_reg_mode</a>;
<a name="l00852"></a>00852 };
<a name="l00853"></a>00853 
<a name="l00854"></a><a class="code" href="structlfsck__thread__info.html">00854</a> <span class="keyword">struct </span><a class="code" href="structlfsck__thread__info.html">lfsck_thread_info</a> {
<a name="l00855"></a><a class="code" href="structlfsck__thread__info.html#a72f552261e6eb553a33726f931fc9f25">00855</a>         <span class="keyword">struct </span><a class="code" href="structlu__name.html" title="Common name structure to be passed around for various name related methods.">lu_name</a>          <a class="code" href="structlfsck__thread__info.html#a72f552261e6eb553a33726f931fc9f25">lti_name_const</a>;
<a name="l00856"></a><a class="code" href="structlfsck__thread__info.html#a6eb1e292e880577efdcb65a23f44cac6">00856</a>         <span class="keyword">struct </span><a class="code" href="structlu__name.html" title="Common name structure to be passed around for various name related methods.">lu_name</a>          <a class="code" href="structlfsck__thread__info.html#a6eb1e292e880577efdcb65a23f44cac6">lti_name</a>;
<a name="l00857"></a><a class="code" href="structlfsck__thread__info.html#abd86d70a33d0ade1cf6b5b75d6e37f90">00857</a>         <span class="keyword">struct </span><a class="code" href="structlu__name.html" title="Common name structure to be passed around for various name related methods.">lu_name</a>          <a class="code" href="structlfsck__thread__info.html#abd86d70a33d0ade1cf6b5b75d6e37f90">lti_name2</a>;
<a name="l00858"></a><a class="code" href="structlfsck__thread__info.html#aeeb510eaef0383432cb06630fdb3b346">00858</a>         <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a>           <a class="code" href="structlfsck__thread__info.html#aeeb510eaef0383432cb06630fdb3b346">lti_buf</a>;
<a name="l00859"></a><a class="code" href="structlfsck__thread__info.html#af252d0b0f7a4fb1341db72180a14f711">00859</a>         <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a>           <a class="code" href="structlfsck__thread__info.html#af252d0b0f7a4fb1341db72180a14f711">lti_linkea_buf</a>;
<a name="l00860"></a><a class="code" href="structlfsck__thread__info.html#acbb785349f1c023a9c2df352fa1e2f8f">00860</a>         <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a>           <a class="code" href="structlfsck__thread__info.html#acbb785349f1c023a9c2df352fa1e2f8f">lti_linkea_buf2</a>;
<a name="l00861"></a><a class="code" href="structlfsck__thread__info.html#adb922dfad620cd71432a01d0018a59c2">00861</a>         <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a>           <a class="code" href="structlfsck__thread__info.html#adb922dfad620cd71432a01d0018a59c2">lti_big_buf</a>;
<a name="l00862"></a><a class="code" href="structlfsck__thread__info.html#a09a34dcf5b9749f3d7ff8d72cd8cec34">00862</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>           <a class="code" href="structlfsck__thread__info.html#a09a34dcf5b9749f3d7ff8d72cd8cec34">lti_fid</a>;
<a name="l00863"></a><a class="code" href="structlfsck__thread__info.html#a0c8459200a8059670aa27dd22c831c7d">00863</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>           <a class="code" href="structlfsck__thread__info.html#a0c8459200a8059670aa27dd22c831c7d">lti_fid2</a>;
<a name="l00864"></a><a class="code" href="structlfsck__thread__info.html#ae28883d65c53bd4bb764939c725a8d06">00864</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>           <a class="code" href="structlfsck__thread__info.html#ae28883d65c53bd4bb764939c725a8d06">lti_fid3</a>;
<a name="l00865"></a><a class="code" href="structlfsck__thread__info.html#aa861798e41cee75fa8e81fdad43fb284">00865</a>         <span class="keyword">struct </span><a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a>          <a class="code" href="structlfsck__thread__info.html#aa861798e41cee75fa8e81fdad43fb284">lti_la</a>;
<a name="l00866"></a><a class="code" href="structlfsck__thread__info.html#a346e305876403ab216aaf57d148c2d52">00866</a>         <span class="keyword">struct </span><a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a>          <a class="code" href="structlfsck__thread__info.html#a346e305876403ab216aaf57d148c2d52">lti_la2</a>;
<a name="l00867"></a><a class="code" href="structlfsck__thread__info.html#a208bd5eb5651041ab5ae1663c27d4f48">00867</a>         <span class="keyword">struct </span><a class="code" href="structost__id.html" title="OST object IDentifier.">ost_id</a>           <a class="code" href="structlfsck__thread__info.html#a208bd5eb5651041ab5ae1663c27d4f48">lti_oi</a>;
<a name="l00868"></a>00868         <span class="keyword">union </span>{
<a name="l00869"></a><a class="code" href="structlfsck__thread__info.html#a5b21e950927da52974bdb2f5970a6fa7">00869</a>                 <span class="keyword">struct </span><a class="code" href="structlustre__mdt__attrs.html" title="Following struct for object attributes, that will be kept inode&amp;#39;s EA.">lustre_mdt_attrs</a> <a class="code" href="structlfsck__thread__info.html#a5b21e950927da52974bdb2f5970a6fa7">lti_lma</a>;
<a name="l00870"></a>00870                 <span class="comment">/* old LMA for compatibility */</span>
<a name="l00871"></a><a class="code" href="structlfsck__thread__info.html#aa0e9a78aace00d4d423d96032d0156e1">00871</a>                 <span class="keywordtype">char</span>                    <a class="code" href="structlfsck__thread__info.html#aa0e9a78aace00d4d423d96032d0156e1">lti_lma_old</a>[<a class="code" href="group__lustreuser.html#gaae2dd0d15d4ca9d9d9c3980978ba03df" title="Prior to 2.4, the LMA structure also included SOM attributes which has since been...">LMA_OLD_SIZE</a>];
<a name="l00872"></a>00872         };
<a name="l00873"></a><a class="code" href="structlfsck__thread__info.html#a86622efbf0e93bb350fd7097e12cbe09">00873</a>         <span class="keyword">struct </span><a class="code" href="structdt__object__format.html" title="object format specifier.">dt_object_format</a> <a class="code" href="structlfsck__thread__info.html#a86622efbf0e93bb350fd7097e12cbe09">lti_dof</a>;
<a name="l00874"></a>00874         <span class="comment">/* There will be &apos;\0&apos; at the end of the name. */</span>
<a name="l00875"></a><a class="code" href="structlfsck__thread__info.html#a992830652e68128815f350c7576ec0c9">00875</a>         <span class="keywordtype">char</span>            <a class="code" href="structlfsck__thread__info.html#a992830652e68128815f350c7576ec0c9">lti_key</a>[<span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structlu__dirent.html" title="Layout of readdir pages, as transmitted on wire.">lu_dirent</a>) + NAME_MAX + 1];
<a name="l00876"></a><a class="code" href="structlfsck__thread__info.html#a52a301acbd4bba591a2b1e2178aecddf">00876</a>         <span class="keywordtype">char</span>                    <a class="code" href="structlfsck__thread__info.html#a52a301acbd4bba591a2b1e2178aecddf">lti_tmpbuf</a>[<a class="code" href="lfsck__internal_8h.html#a36ecf822caad5be9e2d8c92bb0f527da">LFSCK_TMPBUF_LEN</a>];
<a name="l00877"></a><a class="code" href="structlfsck__thread__info.html#a8ce64a460bb4fd6c6d1e217735f25aca">00877</a>         <span class="keywordtype">char</span>                    <a class="code" href="structlfsck__thread__info.html#a8ce64a460bb4fd6c6d1e217735f25aca">lti_tmpbuf2</a>[<a class="code" href="lfsck__internal_8h.html#a36ecf822caad5be9e2d8c92bb0f527da">LFSCK_TMPBUF_LEN</a>];
<a name="l00878"></a><a class="code" href="structlfsck__thread__info.html#a2d932905df035a03a3df0c79ce3fba49">00878</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__request.html">lfsck_request</a>    <a class="code" href="structlfsck__thread__info.html#a2d932905df035a03a3df0c79ce3fba49">lti_lr</a>;
<a name="l00879"></a><a class="code" href="structlfsck__thread__info.html#ad3a1c55f58f944d8d5b1d886da477192">00879</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__async__interpret__args.html">lfsck_async_interpret_args</a> <a class="code" href="structlfsck__thread__info.html#ad3a1c55f58f944d8d5b1d886da477192">lti_laia</a>;
<a name="l00880"></a><a class="code" href="structlfsck__thread__info.html#af377822d1f1407dca10ff75d081ea99f">00880</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__async__interpret__args.html">lfsck_async_interpret_args</a> <a class="code" href="structlfsck__thread__info.html#af377822d1f1407dca10ff75d081ea99f">lti_laia2</a>;
<a name="l00881"></a><a class="code" href="structlfsck__thread__info.html#afe08b59884a193867f08b9384f5a5294">00881</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__start.html">lfsck_start</a>      <a class="code" href="structlfsck__thread__info.html#afe08b59884a193867f08b9384f5a5294">lti_start</a>;
<a name="l00882"></a><a class="code" href="structlfsck__thread__info.html#a3289b8826ecd8953c63f8d0a6d85d04b">00882</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__stop.html">lfsck_stop</a>       <a class="code" href="structlfsck__thread__info.html#a3289b8826ecd8953c63f8d0a6d85d04b">lti_stop</a>;
<a name="l00883"></a><a class="code" href="structlfsck__thread__info.html#ae2c9a286f2319817070700133414ad69">00883</a>         <span class="keyword">union </span><a class="code" href="unionldlm__policy__data.html">ldlm_policy_data</a>  <a class="code" href="structlfsck__thread__info.html#ae2c9a286f2319817070700133414ad69">lti_policy</a>;
<a name="l00884"></a><a class="code" href="structlfsck__thread__info.html#a3eb59bdb24cea36e2c0e63c99e9129dc">00884</a>         <span class="keyword">struct </span><a class="code" href="structldlm__enqueue__info.html" title="Common ldlm_enqueue parameters.">ldlm_enqueue_info</a> <a class="code" href="structlfsck__thread__info.html#a3eb59bdb24cea36e2c0e63c99e9129dc">lti_einfo</a>;
<a name="l00885"></a><a class="code" href="structlfsck__thread__info.html#a8e7e67bee9f6068148e1b27d390d1641">00885</a>         <span class="keyword">struct </span><a class="code" href="structldlm__res__id.html">ldlm_res_id</a>      <a class="code" href="structlfsck__thread__info.html#a8e7e67bee9f6068148e1b27d390d1641">lti_resid</a>;
<a name="l00886"></a>00886         <span class="keyword">union </span>{
<a name="l00887"></a><a class="code" href="structlfsck__thread__info.html#ae561a22e3d4066f7348e7cd031845fd3">00887</a>                 <span class="keyword">struct </span><a class="code" href="structfilter__fid__old.html">filter_fid_old</a>   <a class="code" href="structlfsck__thread__info.html#ae561a22e3d4066f7348e7cd031845fd3">lti_old_pfid</a>;
<a name="l00888"></a><a class="code" href="structlfsck__thread__info.html#aaaf9cf72e7a3b913202b9ee1d5ff1e08">00888</a>                 <span class="keyword">struct </span><a class="code" href="structfilter__fid.html">filter_fid</a>       <a class="code" href="structlfsck__thread__info.html#aaaf9cf72e7a3b913202b9ee1d5ff1e08">lti_new_pfid</a>;
<a name="l00889"></a>00889         };
<a name="l00890"></a><a class="code" href="structlfsck__thread__info.html#a1f06b6b49f72052f72c2cdf837df36dc">00890</a>         <span class="keyword">struct </span><a class="code" href="structdt__allocation__hint.html" title="This is a general purpose dt allocation hint.">dt_allocation_hint</a> <a class="code" href="structlfsck__thread__info.html#a1f06b6b49f72052f72c2cdf837df36dc">lti_hint</a>;
<a name="l00891"></a><a class="code" href="structlfsck__thread__info.html#a3632b3639ff39f1350084d5ba88235cb">00891</a>         <span class="keyword">struct </span><a class="code" href="structlu__orphan__rec.html">lu_orphan_rec</a>    <a class="code" href="structlfsck__thread__info.html#a3632b3639ff39f1350084d5ba88235cb">lti_rec</a>;
<a name="l00892"></a><a class="code" href="structlfsck__thread__info.html#a96a9c9b4fc08c497727d3072554f4a11">00892</a>         <span class="keyword">struct </span><a class="code" href="group__lustreuser.html#ga9c004c151be5b9c6f1886530cbd17136">lov_user_md</a>      <a class="code" href="structlfsck__thread__info.html#a96a9c9b4fc08c497727d3072554f4a11">lti_lum</a>;
<a name="l00893"></a><a class="code" href="structlfsck__thread__info.html#af81d23474372960479aac93780dda16b">00893</a>         <span class="keyword">struct </span><a class="code" href="structdt__insert__rec.html">dt_insert_rec</a>    <a class="code" href="structlfsck__thread__info.html#af81d23474372960479aac93780dda16b">lti_dt_rec</a>;
<a name="l00894"></a><a class="code" href="structlfsck__thread__info.html#a7b31446e7a49752b8d28e29a4aa0dc8f">00894</a>         <span class="keyword">struct </span><a class="code" href="structlu__object__conf.html" title="Object configuration, describing particulars of object being created.">lu_object_conf</a>   <a class="code" href="structlfsck__thread__info.html#a7b31446e7a49752b8d28e29a4aa0dc8f">lti_conf</a>;
<a name="l00895"></a><a class="code" href="structlfsck__thread__info.html#af01b98376cc7007d6fa9737a4b970503">00895</a>         <span class="keyword">struct </span><a class="code" href="structlu__seq__range.html" title="Describes a range of sequence, lsr_start is included but lsr_end is not in the range...">lu_seq_range</a>     <a class="code" href="structlfsck__thread__info.html#af01b98376cc7007d6fa9737a4b970503">lti_range</a>;
<a name="l00896"></a><a class="code" href="structlfsck__thread__info.html#af90043d460fd3dccf53555666daee3ec">00896</a>         <span class="keyword">struct </span><a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a>    <a class="code" href="structlfsck__thread__info.html#af90043d460fd3dccf53555666daee3ec">lti_lmv</a>;
<a name="l00897"></a><a class="code" href="structlfsck__thread__info.html#a31ef559f92e7e0002dd98ac17af1bb93">00897</a>         <span class="keyword">struct </span><a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a>    <a class="code" href="structlfsck__thread__info.html#a31ef559f92e7e0002dd98ac17af1bb93">lti_lmv2</a>;
<a name="l00898"></a><a class="code" href="structlfsck__thread__info.html#ab86ad6b443bdf79023c8034acd8f7958">00898</a>         <span class="keyword">struct </span><a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a>    <a class="code" href="structlfsck__thread__info.html#ab86ad6b443bdf79023c8034acd8f7958">lti_lmv3</a>;
<a name="l00899"></a><a class="code" href="structlfsck__thread__info.html#ab878fc5fafd36d6a01ceb554eb50db28">00899</a>         <span class="keyword">struct </span><a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a>    <a class="code" href="structlfsck__thread__info.html#ab878fc5fafd36d6a01ceb554eb50db28">lti_lmv4</a>;
<a name="l00900"></a><a class="code" href="structlfsck__thread__info.html#a29d64191be59128ceef23a1ad2f02ccf">00900</a>         <span class="keyword">struct </span><a class="code" href="structlfsck__lock__handle.html">lfsck_lock_handle</a> <a class="code" href="structlfsck__thread__info.html#a29d64191be59128ceef23a1ad2f02ccf">lti_llh</a>;
<a name="l00901"></a>00901 };
<a name="l00902"></a>00902 
<a name="l00903"></a>00903 <span class="comment">/* lfsck_lib.c */</span>
<a name="l00904"></a>00904 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#af50cdbcf1743b1d7dee64e0a62df834d">lfsck_fid_alloc</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck,
<a name="l00905"></a>00905                     <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid, <span class="keywordtype">bool</span> locked);
<a name="l00906"></a>00906 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a78fb1ef9b282636ee28936fe69c56bec" title="Request the specified ibits lock for the given object.">lfsck_ibits_lock</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck,
<a name="l00907"></a>00907                      <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj, <span class="keyword">struct</span> <a class="code" href="structlustre__handle.html">lustre_handle</a> *lh,
<a name="l00908"></a>00908                      <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> bits, <span class="keyword">enum</span> <a class="code" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="code" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>);
<a name="l00909"></a>00909 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a5641b50be030cde48d9b7ce69a8935a6" title="Release the the specified ibits lock.">lfsck_ibits_unlock</a>(<span class="keyword">struct</span> <a class="code" href="structlustre__handle.html">lustre_handle</a> *lh, <span class="keyword">enum</span> <a class="code" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="code" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>);
<a name="l00910"></a>00910 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a7ffad8457ec83d8c3b1fc036d5de0ed1" title="Request compound ibits locks for the given &amp;lt;obj, name&amp;gt; pairs.">lfsck_lock</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck,
<a name="l00911"></a>00911                <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,
<a name="l00912"></a>00912                <span class="keyword">struct</span> <a class="code" href="structlfsck__lock__handle.html">lfsck_lock_handle</a> *llh, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> bits, <span class="keyword">enum</span> <a class="code" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="code" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>);
<a name="l00913"></a>00913 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a3b430a41ada3bb7bfa164b3e6763e090" title="Release the the compound ibits locks.">lfsck_unlock</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__lock__handle.html">lfsck_lock_handle</a> *llh);
<a name="l00914"></a>00914 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#aa7c1dbcdae1c09a1496699e6024f1d94">lfsck_find_mdt_idx_by_fid</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00915"></a>00915                               <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck,
<a name="l00916"></a>00916                               <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid);
<a name="l00917"></a>00917 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a235b73ea0f2bfe50f7488ff8e3bf672a" title="Verify the /ROOT/.lustre/lost+found/ directory.">lfsck_verify_lpf</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck);
<a name="l00918"></a>00918 <span class="keyword">struct </span><a class="code" href="structlfsck__instance.html">lfsck_instance</a> *<a class="code" href="lfsck__internal_8h.html#aa672e5f8f93c88210e5beaecff3eb945">lfsck_instance_find</a>(<span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *key, <span class="keywordtype">bool</span> ref,
<a name="l00919"></a>00919                                            <span class="keywordtype">bool</span> unlink);
<a name="l00920"></a>00920 <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *<a class="code" href="lfsck__internal_8h.html#a7ec34b9d3099402caeb31a697da5156a">lfsck_component_find</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck,
<a name="l00921"></a>00921                                              __u16 type);
<a name="l00922"></a>00922 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#ae724d778f2abcb4b28962980190eb8a6">lfsck_component_cleanup</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00923"></a>00923                              <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com);
<a name="l00924"></a>00924 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a474e8af1234983aaac508e097a6591b1">lfsck_instance_cleanup</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00925"></a>00925                             <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck);
<a name="l00926"></a>00926 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#abe516a41304b585c949041d0950aa73b">lfsck_bits_dump</a>(<span class="keyword">struct</span> seq_file *m, <span class="keywordtype">int</span> bits, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structnames.html">names</a>[],
<a name="l00927"></a>00927                      <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix);
<a name="l00928"></a>00928 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a20d93b09f0f3c750a8906c1d08a97e9e">lfsck_time_dump</a>(<span class="keyword">struct</span> seq_file *m, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> time, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00929"></a>00929 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a64065c8a338ab8c1c8a96b02a81af111">lfsck_pos_dump</a>(<span class="keyword">struct</span> seq_file *m, <span class="keyword">struct</span> <a class="code" href="structlfsck__position.html">lfsck_position</a> *pos,
<a name="l00930"></a>00930                     <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix);
<a name="l00931"></a>00931 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a3e65e3b2aaca23ac9b822723a0ea82c4">lfsck_pos_fill</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck,
<a name="l00932"></a>00932                     <span class="keyword">struct</span> <a class="code" href="structlfsck__position.html">lfsck_position</a> *pos, <span class="keywordtype">bool</span> init);
<a name="l00933"></a>00933 <span class="keywordtype">bool</span> <a class="code" href="lfsck__internal_8h.html#a457d2c0d47464aedb4b8f6573b3ef0bc">__lfsck_set_speed</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck, __u32 limit);
<a name="l00934"></a>00934 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#ac409556d9d200cda4725c66911141f9e">lfsck_control_speed</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck);
<a name="l00935"></a>00935 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a499f6bef84e17d8ad4f2b394087d2088">lfsck_control_speed_by_self</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com);
<a name="l00936"></a>00936 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a46d16afd1ac6190eea05603982199cc7">lfsck_thread_args_fini</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__thread__args.html">lfsck_thread_args</a> *lta);
<a name="l00937"></a>00937 <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__data.html">lfsck_assistant_data</a> *
<a name="l00938"></a>00938 <a class="code" href="lfsck__internal_8h.html#a91ba202cb28f813deab0f88595a3fd81">lfsck_assistant_data_init</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__assistant__operations.html">lfsck_assistant_operations</a> *lao,
<a name="l00939"></a>00939                           <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00940"></a>00940 <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__object.html">lfsck_assistant_object</a> *
<a name="l00941"></a>00941 <a class="code" href="lfsck__internal_8h.html#aef355d12cbdcf3070cf8e4308fd4ce97">lfsck_assistant_object_init</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid,
<a name="l00942"></a>00942                             <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__attr.html" title="Common object attributes.">lu_attr</a> *attr, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> cookie,
<a name="l00943"></a>00943                             <span class="keywordtype">bool</span> is_dir);
<a name="l00944"></a>00944 <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *
<a name="l00945"></a>00945 <a class="code" href="lfsck__internal_8h.html#af0c9fabc156cfdcbb55004cb41f82fbe">lfsck_assistant_object_load</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00946"></a>00946                             <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck,
<a name="l00947"></a>00947                             <span class="keyword">struct</span> <a class="code" href="structlfsck__assistant__object.html">lfsck_assistant_object</a> *lso);
<a name="l00948"></a>00948 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#adb8936a0e8a677bf08ec493bae27ee2b" title="Generic LFSCK asynchronous communication interpretor function.">lfsck_async_interpret_common</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00949"></a>00949                                  <span class="keyword">struct</span> <a class="code" href="structptlrpc__request.html" title="Represents remote procedure call.">ptlrpc_request</a> *req,
<a name="l00950"></a>00950                                  <span class="keywordtype">void</span> *args, <span class="keywordtype">int</span> rc);
<a name="l00951"></a>00951 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a59e07dbd52e13234ae4b8e6aca81ce71">lfsck_async_request</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structobd__export.html" title="Export structure.">obd_export</a> *exp,
<a name="l00952"></a>00952                         <span class="keyword">struct</span> <a class="code" href="structlfsck__request.html">lfsck_request</a> *lr,
<a name="l00953"></a>00953                         <span class="keyword">struct</span> <a class="code" href="structptlrpc__request__set.html" title="Definition of request set structure.">ptlrpc_request_set</a> *<span class="keyword">set</span>,
<a name="l00954"></a>00954                         <a class="code" href="group__net.html#ga80bef25da5dad7e788b4427e8c5e7df6" title="Type of request interpreter call-back.">ptlrpc_interpterer_t</a> interpterer,
<a name="l00955"></a>00955                         <span class="keywordtype">void</span> *args, <span class="keywordtype">int</span> request);
<a name="l00956"></a>00956 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#ad74ecfc36f73d5b86c4e04bd55cb368d">lfsck_query_all</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com);
<a name="l00957"></a>00957 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a9b1abf8fc2b212540452dffbcf53f5e2">lfsck_start_assistant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00958"></a>00958                           <span class="keyword">struct</span> <a class="code" href="structlfsck__start__param.html">lfsck_start_param</a> *lsp);
<a name="l00959"></a>00959 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a0f9811a3a6a0834e9db6e31711b15b0f">lfsck_checkpoint_generic</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00960"></a>00960                              <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com);
<a name="l00961"></a>00961 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a6313d77f10125f9ac63084e00f94ec26">lfsck_post_generic</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00962"></a>00962                         <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com, <span class="keywordtype">int</span> *result);
<a name="l00963"></a>00963 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#aa484cbbcab8be42ead2a8c9fddedc29c">lfsck_double_scan_generic</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00964"></a>00964                               <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com, <span class="keywordtype">int</span> <a class="code" href="lustre__rsync_8c.html#a55591f17a60f597b63f070969c54fd6c">status</a>);
<a name="l00965"></a>00965 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#aa6b8e589e419e7ecddba665d1ab21a53">lfsck_quit_generic</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00966"></a>00966                         <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com);
<a name="l00967"></a>00967 
<a name="l00968"></a>00968 <span class="comment">/* lfsck_engine.c */</span>
<a name="l00969"></a>00969 <span class="keywordtype">int</span> <a class="code" href="lfsck__engine_8c.html#a6d82da3d39b3f8ece030b7ebe9c795d8">lfsck_unpack_ent</a>(<span class="keyword">struct</span> <a class="code" href="structlu__dirent.html" title="Layout of readdir pages, as transmitted on wire.">lu_dirent</a> *ent, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *cookie, __u16 *type);
<a name="l00970"></a>00970 <span class="keywordtype">void</span> <a class="code" href="lfsck__engine_8c.html#ace551cca750b4f93d390e7cfe358f872">lfsck_close_dir</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00971"></a>00971                      <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck, <span class="keywordtype">int</span> result);
<a name="l00972"></a>00972 <span class="keywordtype">int</span> <a class="code" href="lfsck__engine_8c.html#ae12b9de56925df21d23623b31717bb38">lfsck_open_dir</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00973"></a>00973                    <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck, <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> cookie);
<a name="l00974"></a>00974 <span class="keywordtype">int</span> <a class="code" href="lfsck__engine_8c.html#a0cfcafda3509ba234d752164ac56754f">lfsck_master_engine</a>(<span class="keywordtype">void</span> *args);
<a name="l00975"></a>00975 <span class="keywordtype">int</span> <a class="code" href="lfsck__engine_8c.html#aef963a42c4d33910f66d304fb29a101e" title="The LFSCK assistant thread is triggered by the LFSCK main engine.">lfsck_assistant_engine</a>(<span class="keywordtype">void</span> *args);
<a name="l00976"></a>00976 
<a name="l00977"></a>00977 <span class="comment">/* lfsck_bookmark.c */</span>
<a name="l00978"></a>00978 <span class="keywordtype">void</span> <a class="code" href="lfsck__bookmark_8c.html#ac0d6d50da53e07cb34bdf34b0f77b80c">lfsck_bookmark_cpu_to_le</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__bookmark.html">lfsck_bookmark</a> *des,
<a name="l00979"></a>00979                               <span class="keyword">struct</span> <a class="code" href="structlfsck__bookmark.html">lfsck_bookmark</a> *src);
<a name="l00980"></a>00980 <span class="keywordtype">int</span> <a class="code" href="lfsck__bookmark_8c.html#a3d7eecf40465035dc6f7025a4a9047ee">lfsck_bookmark_store</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00981"></a>00981                          <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck);
<a name="l00982"></a>00982 <span class="keywordtype">int</span> <a class="code" href="lfsck__bookmark_8c.html#af586081c2c66b40de85eafdbf2e74bc4">lfsck_bookmark_setup</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00983"></a>00983                          <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck);
<a name="l00984"></a>00984 <span class="keywordtype">int</span> <a class="code" href="lfsck__bookmark_8c.html#a3207c9708a433b4dbf655915841b8b4b">lfsck_set_param</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck,
<a name="l00985"></a>00985                     <span class="keyword">struct</span> <a class="code" href="structlfsck__start.html">lfsck_start</a> *<a class="code" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <span class="keywordtype">bool</span> reset);
<a name="l00986"></a>00986 
<a name="l00987"></a>00987 <span class="comment">/* lfsck_namespace.c */</span>
<a name="l00988"></a>00988 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#ad9e1b6d4d1e59c15c70f27ee5e2aa804" title="Update the namespace LFSCK trace file for the given .">lfsck_namespace_trace_update</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00989"></a>00989                                  <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00990"></a>00990                                  <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid,
<a name="l00991"></a>00991                                  <span class="keyword">const</span> __u8 flags, <span class="keywordtype">bool</span> add);
<a name="l00992"></a>00992 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a85e6979b2c419199ab5aff81fe89fcd9">lfsck_namespace_check_exist</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00993"></a>00993                                 <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="mmap__sanity_8c.html#a73da71b9c136e698a3ccaa1366e455a8">dir</a>,
<a name="l00994"></a>00994                                 <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00995"></a>00995 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#ae813731a3c21ac557857ceb6a94d2e2e">__lfsck_links_read</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj,
<a name="l00996"></a>00996                        <span class="keyword">struct</span> <a class="code" href="structlinkea__data.html">linkea_data</a> *ldata);
<a name="l00997"></a>00997 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a5e5221a7fc1e062d8b163cd4bb1789c5" title="Overwrite the linkEA for the object with the given ldata.">lfsck_namespace_rebuild_linkea</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l00998"></a>00998                                    <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l00999"></a>00999                                    <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj,
<a name="l01000"></a>01000                                    <span class="keyword">struct</span> <a class="code" href="structlinkea__data.html">linkea_data</a> *ldata);
<a name="l01001"></a>01001 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a499639286c429a090c0ba2f745b31363" title="Repair dangling name entry.">lfsck_namespace_repair_dangling</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01002"></a>01002                                     <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l01003"></a>01003                                     <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *parent,
<a name="l01004"></a>01004                                     <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *child,
<a name="l01005"></a>01005                                     <span class="keyword">struct</span> <a class="code" href="structlfsck__namespace__req.html">lfsck_namespace_req</a> *lnr);
<a name="l01006"></a>01006 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a7802d2fdae444eb243bebb9b92a8238a" title="Repair invalid name entry.">lfsck_namespace_repair_dirent</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01007"></a>01007                                   <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l01008"></a>01008                                   <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *parent,
<a name="l01009"></a>01009                                   <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *child,
<a name="l01010"></a>01010                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *name2,
<a name="l01011"></a>01011                                   __u16 type, <span class="keywordtype">bool</span> update, <span class="keywordtype">bool</span> dec);
<a name="l01012"></a>01012 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a10e7572a512be6782d27190bbe4f52cf" title="Verify the specified linkEA entry for the given directory object.">lfsck_verify_linkea</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj,
<a name="l01013"></a>01013                         <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__name.html" title="Common name structure to be passed around for various name related methods.">lu_name</a> *cname, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *pfid);
<a name="l01014"></a>01014 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a153a7a6d32e606e697c11f4054eedf1b" title="Get the name and parent directory&amp;#39;s FID from the first linkEA entry.">lfsck_links_get_first</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj,
<a name="l01015"></a>01015                           <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *pfid);
<a name="l01016"></a>01016 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a3ab12cffcdd69732db02236b292c3e57" title="Update the object&amp;#39;s name entry with the given FID.">lfsck_update_name_entry</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01017"></a>01017                             <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck,
<a name="l01018"></a>01018                             <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="mmap__sanity_8c.html#a73da71b9c136e698a3ccaa1366e455a8">dir</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,
<a name="l01019"></a>01019                             <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid, __u32 type);
<a name="l01020"></a>01020 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a12be37000161af347ac970c78a35db56">lfsck_namespace_setup</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01021"></a>01021                           <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck);
<a name="l01022"></a>01022 
<a name="l01023"></a>01023 <span class="comment">/* lfsck_striped_dir.c */</span>
<a name="l01024"></a>01024 <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a16bf9373cf85c4c057eade31b469ef09">lfsck_lmv_put</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlfsck__lmv.html">lfsck_lmv</a> *llmv);
<a name="l01025"></a>01025 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a248445b5a863838c6de16febb9ff50b0">lfsck_read_stripe_lmv</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj,
<a name="l01026"></a>01026                           <span class="keyword">struct</span> <a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a> *lmv);
<a name="l01027"></a>01027 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a85d16d415e427fa3c8d7aa008453644b" title="Parse the shard&amp;#39;s index from the given shard name.">lfsck_shard_name_to_index</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,
<a name="l01028"></a>01028                               <span class="keywordtype">int</span> namelen, __u16 type,
<a name="l01029"></a>01029                               <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid);
<a name="l01030"></a>01030 <span class="keywordtype">bool</span> <a class="code" href="lfsck__internal_8h.html#ae4fe510053a9ba9be1fb937afbe31315">lfsck_is_valid_slave_name_entry</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01031"></a>01031                                      <span class="keyword">struct</span> <a class="code" href="structlfsck__lmv.html">lfsck_lmv</a> *llmv,
<a name="l01032"></a>01032                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="keywordtype">int</span> namelen);
<a name="l01033"></a>01033 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a7eee69b6a91e0241801bd0911409913e" title="Check whether the given name is a valid entry under the .">lfsck_namespace_check_name</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01034"></a>01034                                <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *parent,
<a name="l01035"></a>01035                                <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *child,
<a name="l01036"></a>01036                                <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__name.html" title="Common name structure to be passed around for various name related methods.">lu_name</a> *cname);
<a name="l01037"></a>01037 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a12465f080d74c44e795ab94ce3b12f29" title="Update the object&amp;#39;s LMV EA with the given .">lfsck_namespace_update_lmv</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01038"></a>01038                                <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l01039"></a>01039                                <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj,
<a name="l01040"></a>01040                                <span class="keyword">struct</span> <a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a> *lmv, <span class="keywordtype">bool</span> locked);
<a name="l01041"></a>01041 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#acc843dd85fecd4c3fdd9a05361412a9f" title="Verify the slave object&amp;#39;s (of striped directory) LMV EA.">lfsck_namespace_verify_stripe_slave</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01042"></a>01042                                         <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l01043"></a>01043                                         <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj,
<a name="l01044"></a>01044                                         <span class="keyword">struct</span> <a class="code" href="structlfsck__lmv.html">lfsck_lmv</a> *llmv);
<a name="l01045"></a>01045 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#abfc4c3f7a5a20c98a99c5bd1b963042e" title="Scan the shard of a striped directory for name hash verification.">lfsck_namespace_scan_shard</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01046"></a>01046                                <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l01047"></a>01047                                <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *child);
<a name="l01048"></a>01048 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#afb643704151cecb5c2a54a638f15366b" title="Generate request for local LFSCK instance to rescan the striped directory.">lfsck_namespace_notify_lmv_master_local</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01049"></a>01049                                             <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l01050"></a>01050                                             <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj);
<a name="l01051"></a>01051 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#ab795dfd20bcc40d70ccc7e1a3f8b4ea3" title="Repair the bad name hash.">lfsck_namespace_repair_bad_name_hash</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01052"></a>01052                                          <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l01053"></a>01053                                          <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *shard,
<a name="l01054"></a>01054                                          <span class="keyword">struct</span> <a class="code" href="structlfsck__lmv.html">lfsck_lmv</a> *llmv,
<a name="l01055"></a>01055                                          <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l01056"></a>01056 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a386b5a0ea946859c7ed3d9f2e7175af5" title="Double scan the striped directory or the shard.">lfsck_namespace_striped_dir_rescan</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01057"></a>01057                                        <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l01058"></a>01058                                        <span class="keyword">struct</span> <a class="code" href="structlfsck__namespace__req.html">lfsck_namespace_req</a> *lnr);
<a name="l01059"></a>01059 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a58127449240233d6dc445e92a938a7cb" title="Verify the shard&amp;#39;s name entry under the striped directory.">lfsck_namespace_handle_striped_master</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01060"></a>01060                                           <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l01061"></a>01061                                           <span class="keyword">struct</span> <a class="code" href="structlfsck__namespace__req.html">lfsck_namespace_req</a> *lnr);
<a name="l01062"></a>01062 
<a name="l01063"></a>01063 <span class="comment">/* lfsck_layout.c */</span>
<a name="l01064"></a>01064 <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a45153a26a55e704921bcc3292e79df9f">lfsck_layout_setup</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck);
<a name="l01065"></a>01065 
<a name="l01066"></a>01066 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="lfsck__internal_8h.html#abe6cafa537717678814801ed8d6cb180">dot</a>[];
<a name="l01067"></a>01067 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="lfsck__internal_8h.html#a7914eee395b20d62ae6bc4a189f3a468">dotdot</a>[];
<a name="l01068"></a>01068 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="lfsck__internal_8h.html#aaa144f60df2565e5cce1b0d967597320">lfsck_flags_names</a>[];
<a name="l01069"></a>01069 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="lfsck__internal_8h.html#ad1157db3beb29bc193fce02f85b07981">lfsck_param_names</a>[];
<a name="l01070"></a>01070 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structlu__context__key.html" title="Key.">lu_context_key</a> <a class="code" href="lfsck__internal_8h.html#aeff576b7c084908278912545672aa6d0">lfsck_thread_key</a>;
<a name="l01071"></a>01071 
<a name="l01072"></a><a class="code" href="lfsck__internal_8h.html#ac71353e14cda7a003d491ffbb5f8a82c">01072</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="lfsck__internal_8h.html#ac71353e14cda7a003d491ffbb5f8a82c">name_is_dot_or_dotdot</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="keywordtype">int</span> namelen)
<a name="l01073"></a>01073 {
<a name="l01074"></a>01074         <span class="keywordflow">return</span> name[0] == <span class="charliteral">&apos;.&apos;</span> &amp;&amp;
<a name="l01075"></a>01075                (namelen == 1 || (namelen == 2 &amp;&amp; name[1] == <span class="charliteral">&apos;.&apos;</span>));
<a name="l01076"></a>01076 }
<a name="l01077"></a>01077 
<a name="l01078"></a><a class="code" href="lfsck__internal_8h.html#a34bbe61a915878b2496b4571468f0170">01078</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *<a class="code" href="lfsck__internal_8h.html#a34bbe61a915878b2496b4571468f0170">lfsck_obj2dev</a>(<span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj)
<a name="l01079"></a>01079 {
<a name="l01080"></a>01080         <span class="keywordflow">return</span> container_of0(obj-&gt;<a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>.<a class="code" href="structlu__object.html#a5b9108a283d9901c95bdf32833f70601" title="Device for this layer.">lo_dev</a>, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a>, <a class="code" href="structdt__device.html#a54e8912d9668696ec00395a14ca44fd3">dd_lu_dev</a>);
<a name="l01081"></a>01081 }
<a name="l01082"></a>01082 
<a name="l01083"></a>01083 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structlfsck__thread__info.html">lfsck_thread_info</a> *
<a name="l01084"></a><a class="code" href="lfsck__internal_8h.html#abb9457be30c659d70ff99694ad4fe480">01084</a> <a class="code" href="lfsck__internal_8h.html#abb9457be30c659d70ff99694ad4fe480">lfsck_env_info</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env)
<a name="l01085"></a>01085 {
<a name="l01086"></a>01086         <span class="keyword">struct </span><a class="code" href="structlfsck__thread__info.html">lfsck_thread_info</a> *info;
<a name="l01087"></a>01087 
<a name="l01088"></a>01088         info = <a class="code" href="group__lu.html#ga8fcebe57d8fb288a73a39144693074af" title="Return value associated with key key in context ctx.">lu_context_key_get</a>(&amp;env-&gt;<a class="code" href="structlu__env.html#a8c3e54a599d9514dce7868eab34e411d" title="&amp;quot;Local&amp;quot; context, used to store data instead of stack.">le_ctx</a>, &amp;<a class="code" href="lfsck__internal_8h.html#aeff576b7c084908278912545672aa6d0">lfsck_thread_key</a>);
<a name="l01089"></a>01089         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(info != NULL);
<a name="l01090"></a>01090         <span class="keywordflow">return</span> info;
<a name="l01091"></a>01091 }
<a name="l01092"></a>01092 
<a name="l01093"></a>01093 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__name.html" title="Common name structure to be passed around for various name related methods.">lu_name</a> *
<a name="l01094"></a><a class="code" href="lfsck__internal_8h.html#a3c71cb235d8b239b216cab76c3828ba6">01094</a> <a class="code" href="lfsck__internal_8h.html#a3c71cb235d8b239b216cab76c3828ba6">lfsck_name_get_const</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">const</span> <span class="keywordtype">void</span> *area, ssize_t len)
<a name="l01095"></a>01095 {
<a name="l01096"></a>01096         <span class="keyword">struct </span><a class="code" href="structlu__name.html" title="Common name structure to be passed around for various name related methods.">lu_name</a> *lname;
<a name="l01097"></a>01097 
<a name="l01098"></a>01098         lname = &amp;<a class="code" href="lfsck__internal_8h.html#abb9457be30c659d70ff99694ad4fe480">lfsck_env_info</a>(env)-&gt;<a class="code" href="structlfsck__thread__info.html#a72f552261e6eb553a33726f931fc9f25">lti_name_const</a>;
<a name="l01099"></a>01099         lname-&gt;<a class="code" href="structlu__name.html#a38f9da2b26af88f2cd0a7970ab69685c">ln_name</a> = area;
<a name="l01100"></a>01100         lname-&gt;<a class="code" href="structlu__name.html#aeb1c7b5e8902415913cdac9608059866">ln_namelen</a> = len;
<a name="l01101"></a>01101         <span class="keywordflow">return</span> lname;
<a name="l01102"></a>01102 }
<a name="l01103"></a>01103 
<a name="l01104"></a>01104 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l01105"></a><a class="code" href="lfsck__internal_8h.html#a985320d06e3b2d949b8a2d2783261112">01105</a> <a class="code" href="lfsck__internal_8h.html#a985320d06e3b2d949b8a2d2783261112">lfsck_buf_init</a>(<span class="keyword">struct</span> <a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>, <span class="keywordtype">void</span> *area, ssize_t len)
<a name="l01106"></a>01106 {
<a name="l01107"></a>01107         buf-&gt;<a class="code" href="structlu__buf.html#a91128fd207a48747473072790fd3ad84">lb_buf</a> = area;
<a name="l01108"></a>01108         buf-&gt;<a class="code" href="structlu__buf.html#a99a05a4a568085620bc4e62265a6fc9b">lb_len</a> = len;
<a name="l01109"></a>01109 }
<a name="l01110"></a>01110 
<a name="l01111"></a>01111 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *
<a name="l01112"></a><a class="code" href="lfsck__internal_8h.html#af8eec8ad32707cdb4c403212177c3d25">01112</a> <a class="code" href="lfsck__internal_8h.html#af8eec8ad32707cdb4c403212177c3d25">lfsck_buf_get</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keywordtype">void</span> *area, ssize_t len)
<a name="l01113"></a>01113 {
<a name="l01114"></a>01114         <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>;
<a name="l01115"></a>01115 
<a name="l01116"></a>01116         buf = &amp;<a class="code" href="lfsck__internal_8h.html#abb9457be30c659d70ff99694ad4fe480">lfsck_env_info</a>(env)-&gt;<a class="code" href="structlfsck__thread__info.html#aeeb510eaef0383432cb06630fdb3b346">lti_buf</a>;
<a name="l01117"></a>01117         buf-&gt;<a class="code" href="structlu__buf.html#a91128fd207a48747473072790fd3ad84">lb_buf</a> = area;
<a name="l01118"></a>01118         buf-&gt;<a class="code" href="structlu__buf.html#a99a05a4a568085620bc4e62265a6fc9b">lb_len</a> = len;
<a name="l01119"></a>01119         <span class="keywordflow">return</span> buf;
<a name="l01120"></a>01120 }
<a name="l01121"></a>01121 
<a name="l01122"></a>01122 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *
<a name="l01123"></a><a class="code" href="lfsck__internal_8h.html#ad70629c60e1f76feb699e6feb14dae4d">01123</a> <a class="code" href="lfsck__internal_8h.html#ad70629c60e1f76feb699e6feb14dae4d">lfsck_buf_get_const</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">const</span> <span class="keywordtype">void</span> *area, ssize_t len)
<a name="l01124"></a>01124 {
<a name="l01125"></a>01125         <span class="keyword">struct </span><a class="code" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>;
<a name="l01126"></a>01126 
<a name="l01127"></a>01127         buf = &amp;<a class="code" href="lfsck__internal_8h.html#abb9457be30c659d70ff99694ad4fe480">lfsck_env_info</a>(env)-&gt;<a class="code" href="structlfsck__thread__info.html#aeeb510eaef0383432cb06630fdb3b346">lti_buf</a>;
<a name="l01128"></a>01128         buf-&gt;<a class="code" href="structlu__buf.html#a91128fd207a48747473072790fd3ad84">lb_buf</a> = (<span class="keywordtype">void</span> *)area;
<a name="l01129"></a>01129         buf-&gt;<a class="code" href="structlu__buf.html#a99a05a4a568085620bc4e62265a6fc9b">lb_len</a> = len;
<a name="l01130"></a>01130         <span class="keywordflow">return</span> buf;
<a name="l01131"></a>01131 }
<a name="l01132"></a>01132 
<a name="l01133"></a><a class="code" href="lfsck__internal_8h.html#a0831bfac60acb71557806a7943785cd3">01133</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">char</span> *<a class="code" href="lfsck__internal_8h.html#a0831bfac60acb71557806a7943785cd3">lfsck_lfsck2name</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck)
<a name="l01134"></a>01134 {
<a name="l01135"></a>01135         <span class="keywordflow">return</span> lfsck-&gt;<a class="code" href="structlfsck__instance.html#ab01f0f90dc2df61195fee7dc3ed8cb70">li_bottom</a>-&gt;<a class="code" href="structdt__device.html#a54e8912d9668696ec00395a14ca44fd3">dd_lu_dev</a>.<a class="code" href="structlu__device.html#af35351bd6a533fa48c8a0f0eda83172a">ld_obd</a>-&gt;<a class="code" href="structobd__device.html#a47f3a5a4e3b9ce7d39282c2aa1058985">obd_name</a>;
<a name="l01136"></a>01136 }
<a name="l01137"></a>01137 
<a name="l01138"></a><a class="code" href="lfsck__internal_8h.html#a0835d03ca8154d89267d733058026c0a">01138</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *<a class="code" href="lfsck__internal_8h.html#a0835d03ca8154d89267d733058026c0a">lfsck_dto2fid</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj)
<a name="l01139"></a>01139 {
<a name="l01140"></a>01140         <span class="keywordflow">return</span> <a class="code" href="group__lu.html#gab5b77e911368f64cb01c054ccabf51f3" title="Pointer to the fid of this object.">lu_object_fid</a>(&amp;obj-&gt;<a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>);
<a name="l01141"></a>01141 }
<a name="l01142"></a>01142 
<a name="l01143"></a><a class="code" href="lfsck__internal_8h.html#ad85b99e001d4f19c2c3a1bee02254cba">01143</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#ad85b99e001d4f19c2c3a1bee02254cba">lfsck_pos_set_zero</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__position.html">lfsck_position</a> *pos)
<a name="l01144"></a>01144 {
<a name="l01145"></a>01145         memset(pos, 0, <span class="keyword">sizeof</span>(*pos));
<a name="l01146"></a>01146 }
<a name="l01147"></a>01147 
<a name="l01148"></a><a class="code" href="lfsck__internal_8h.html#a54c73eedbd176af3251cd7ca60b3de43">01148</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a54c73eedbd176af3251cd7ca60b3de43">lfsck_pos_is_zero</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlfsck__position.html">lfsck_position</a> *pos)
<a name="l01149"></a>01149 {
<a name="l01150"></a>01150         <span class="keywordflow">return</span> pos-&gt;<a class="code" href="structlfsck__position.html#ae6b914c8af295fe0812dd0cd39b2a458">lp_oit_cookie</a> == 0 &amp;&amp; <a class="code" href="group__lustreuser.html#ga2c265e188b56db802b9a4ca3b1deb9a9">fid_is_zero</a>(&amp;pos-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>);
<a name="l01151"></a>01151 }
<a name="l01152"></a>01152 
<a name="l01153"></a><a class="code" href="lfsck__internal_8h.html#ad88f5d82295cfd4bf98f4692b53dc51a">01153</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#ad88f5d82295cfd4bf98f4692b53dc51a">lfsck_pos_is_eq</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlfsck__position.html">lfsck_position</a> *pos1,
<a name="l01154"></a>01154                                   <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlfsck__position.html">lfsck_position</a> *pos2)
<a name="l01155"></a>01155 {
<a name="l01156"></a>01156         <span class="keywordflow">if</span> (pos1-&gt;<a class="code" href="structlfsck__position.html#ae6b914c8af295fe0812dd0cd39b2a458">lp_oit_cookie</a> &lt; pos2-&gt;<a class="code" href="structlfsck__position.html#ae6b914c8af295fe0812dd0cd39b2a458">lp_oit_cookie</a>)
<a name="l01157"></a>01157                 <span class="keywordflow">return</span> -1;
<a name="l01158"></a>01158 
<a name="l01159"></a>01159         <span class="keywordflow">if</span> (pos1-&gt;<a class="code" href="structlfsck__position.html#ae6b914c8af295fe0812dd0cd39b2a458">lp_oit_cookie</a> &gt; pos2-&gt;<a class="code" href="structlfsck__position.html#ae6b914c8af295fe0812dd0cd39b2a458">lp_oit_cookie</a>)
<a name="l01160"></a>01160                 <span class="keywordflow">return</span> 1;
<a name="l01161"></a>01161 
<a name="l01162"></a>01162         <span class="keywordflow">if</span> (<a class="code" href="group__lustreuser.html#ga2c265e188b56db802b9a4ca3b1deb9a9">fid_is_zero</a>(&amp;pos1-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>) &amp;&amp;
<a name="l01163"></a>01163             !<a class="code" href="group__lustreuser.html#ga2c265e188b56db802b9a4ca3b1deb9a9">fid_is_zero</a>(&amp;pos2-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>))
<a name="l01164"></a>01164                 <span class="keywordflow">return</span> -1;
<a name="l01165"></a>01165 
<a name="l01166"></a>01166         <span class="keywordflow">if</span> (!<a class="code" href="group__lustreuser.html#ga2c265e188b56db802b9a4ca3b1deb9a9">fid_is_zero</a>(&amp;pos1-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>) &amp;&amp;
<a name="l01167"></a>01167             <a class="code" href="group__lustreuser.html#ga2c265e188b56db802b9a4ca3b1deb9a9">fid_is_zero</a>(&amp;pos2-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>))
<a name="l01168"></a>01168                 <span class="keywordflow">return</span> 1;
<a name="l01169"></a>01169 
<a name="l01170"></a>01170         <span class="keywordflow">if</span> (<a class="code" href="group__lustreuser.html#ga2c265e188b56db802b9a4ca3b1deb9a9">fid_is_zero</a>(&amp;pos1-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>) &amp;&amp;
<a name="l01171"></a>01171             <a class="code" href="group__lustreuser.html#ga2c265e188b56db802b9a4ca3b1deb9a9">fid_is_zero</a>(&amp;pos2-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>))
<a name="l01172"></a>01172                 <span class="keywordflow">return</span> 0;
<a name="l01173"></a>01173 
<a name="l01174"></a>01174         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(<a class="code" href="group__lu__fid.html#ga7d05f4f2cdf8da0d1221216426313c13">lu_fid_eq</a>(&amp;pos1-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>, &amp;pos2-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>));
<a name="l01175"></a>01175 
<a name="l01176"></a>01176         <span class="keywordflow">if</span> (pos1-&gt;<a class="code" href="structlfsck__position.html#acd2bb99422eff4ef3d3c794e27be51ed">lp_dir_cookie</a> &lt; pos2-&gt;<a class="code" href="structlfsck__position.html#acd2bb99422eff4ef3d3c794e27be51ed">lp_dir_cookie</a>)
<a name="l01177"></a>01177                 <span class="keywordflow">return</span> -1;
<a name="l01178"></a>01178 
<a name="l01179"></a>01179         <span class="keywordflow">if</span> (pos1-&gt;<a class="code" href="structlfsck__position.html#acd2bb99422eff4ef3d3c794e27be51ed">lp_dir_cookie</a> &gt; pos2-&gt;<a class="code" href="structlfsck__position.html#acd2bb99422eff4ef3d3c794e27be51ed">lp_dir_cookie</a>)
<a name="l01180"></a>01180                 <span class="keywordflow">return</span> 1;
<a name="l01181"></a>01181 
<a name="l01182"></a>01182         <span class="keywordflow">return</span> 0;
<a name="l01183"></a>01183 }
<a name="l01184"></a>01184 
<a name="l01185"></a><a class="code" href="lfsck__internal_8h.html#a60b0b56361fb0605f39ac0b2dcccdea4">01185</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <span class="keyword">inline</span> <a class="code" href="lfsck__internal_8h.html#a60b0b56361fb0605f39ac0b2dcccdea4">lfsck_position_le_to_cpu</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__position.html">lfsck_position</a> *des,
<a name="l01186"></a>01186                                             <span class="keyword">struct</span> <a class="code" href="structlfsck__position.html">lfsck_position</a> *src)
<a name="l01187"></a>01187 {
<a name="l01188"></a>01188         des-&gt;<a class="code" href="structlfsck__position.html#ae6b914c8af295fe0812dd0cd39b2a458">lp_oit_cookie</a> = <a class="code" href="byteorder_8h.html#a0987d88a4fac98f0b1d6355ef7aa77e2">le64_to_cpu</a>(src-&gt;<a class="code" href="structlfsck__position.html#ae6b914c8af295fe0812dd0cd39b2a458">lp_oit_cookie</a>);
<a name="l01189"></a>01189         <a class="code" href="group__lu__fid.html#ga4ec200cce2c251b81f3c49154ab9198e">fid_le_to_cpu</a>(&amp;des-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>, &amp;src-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>);
<a name="l01190"></a>01190         des-&gt;<a class="code" href="structlfsck__position.html#acd2bb99422eff4ef3d3c794e27be51ed">lp_dir_cookie</a> = <a class="code" href="byteorder_8h.html#a0987d88a4fac98f0b1d6355ef7aa77e2">le64_to_cpu</a>(src-&gt;<a class="code" href="structlfsck__position.html#acd2bb99422eff4ef3d3c794e27be51ed">lp_dir_cookie</a>);
<a name="l01191"></a>01191 }
<a name="l01192"></a>01192 
<a name="l01193"></a><a class="code" href="lfsck__internal_8h.html#aa53b7f7188c062313cd33afb8d157988">01193</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <span class="keyword">inline</span> <a class="code" href="lfsck__internal_8h.html#aa53b7f7188c062313cd33afb8d157988">lfsck_position_cpu_to_le</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__position.html">lfsck_position</a> *des,
<a name="l01194"></a>01194                                             <span class="keyword">struct</span> <a class="code" href="structlfsck__position.html">lfsck_position</a> *src)
<a name="l01195"></a>01195 {
<a name="l01196"></a>01196         des-&gt;<a class="code" href="structlfsck__position.html#ae6b914c8af295fe0812dd0cd39b2a458">lp_oit_cookie</a> = <a class="code" href="byteorder_8h.html#aa170dc4b2dae5b00bdec3a307427240f">cpu_to_le64</a>(src-&gt;<a class="code" href="structlfsck__position.html#ae6b914c8af295fe0812dd0cd39b2a458">lp_oit_cookie</a>);
<a name="l01197"></a>01197         <a class="code" href="group__lu__fid.html#ga67ad15a9c2e4676b57dd84272d2e6849">fid_cpu_to_le</a>(&amp;des-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>, &amp;src-&gt;<a class="code" href="structlfsck__position.html#ad7c9a20f99014250c6d24e7299eb366a">lp_dir_parent</a>);
<a name="l01198"></a>01198         des-&gt;<a class="code" href="structlfsck__position.html#acd2bb99422eff4ef3d3c794e27be51ed">lp_dir_cookie</a> = <a class="code" href="byteorder_8h.html#aa170dc4b2dae5b00bdec3a307427240f">cpu_to_le64</a>(src-&gt;<a class="code" href="structlfsck__position.html#acd2bb99422eff4ef3d3c794e27be51ed">lp_dir_cookie</a>);
<a name="l01199"></a>01199 }
<a name="l01200"></a>01200 
<a name="l01201"></a><a class="code" href="lfsck__internal_8h.html#a5cd3909a5fad1d7d7b7eb60efa6771c2">01201</a> <span class="keyword">static</span> <span class="keyword">inline</span> umode_t <a class="code" href="lfsck__internal_8h.html#a5cd3909a5fad1d7d7b7eb60efa6771c2">lfsck_object_type</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj)
<a name="l01202"></a>01202 {
<a name="l01203"></a>01203         <span class="keywordflow">return</span> <a class="code" href="group__lu.html#ga540796c86b6573ecb504d816070da73c" title="Attr of this object.">lu_object_attr</a>(&amp;obj-&gt;<a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>);
<a name="l01204"></a>01204 }
<a name="l01205"></a>01205 
<a name="l01206"></a><a class="code" href="lfsck__internal_8h.html#af23f68396835a9567c498d615438155c">01206</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#af23f68396835a9567c498d615438155c">lfsck_is_dead_obj</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj)
<a name="l01207"></a>01207 {
<a name="l01208"></a>01208         <span class="keyword">struct </span><a class="code" href="structlu__object__header.html" title="&amp;quot;Compound&amp;quot; object, consisting of multiple layers.">lu_object_header</a> *loh = obj-&gt;<a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>.<a class="code" href="structlu__object.html#ab55ad0889ad4d306d0a5aad7ed0aa398" title="Header for this object.">lo_header</a>;
<a name="l01209"></a>01209 
<a name="l01210"></a>01210         <span class="keywordflow">return</span> !!test_bit(<a class="code" href="group__lu.html#gga519a2e6103ae639c8df1777d311cc985aca9a04f530d5436e7996a1ff142d01d0" title="Don&amp;#39;t keep this object in cache.">LU_OBJECT_HEARD_BANSHEE</a>, &amp;loh-&gt;<a class="code" href="structlu__object__header.html#a85952a1c723e48ffa0bb7024438ac08f" title="Object flags from enum lu_object_header_flags.">loh_flags</a>);
<a name="l01211"></a>01211 }
<a name="l01212"></a>01212 
<a name="l01213"></a><a class="code" href="lfsck__internal_8h.html#abd2599948f7713e824a60303245df1f2">01213</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *<a class="code" href="lfsck__internal_8h.html#abd2599948f7713e824a60303245df1f2">lfsck_object_get</a>(<span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj)
<a name="l01214"></a>01214 {
<a name="l01215"></a>01215         <a class="code" href="group__lu.html#ga5f97a27427f7e3fa188dbe706dce54ce" title="Acquire additional reference to the given object.">lu_object_get</a>(&amp;obj-&gt;<a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>);
<a name="l01216"></a>01216         <span class="keywordflow">return</span> obj;
<a name="l01217"></a>01217 }
<a name="l01218"></a>01218 
<a name="l01219"></a><a class="code" href="lfsck__internal_8h.html#ac0be804c9127f9c877d7af9a6d1b4d1a">01219</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#ac0be804c9127f9c877d7af9a6d1b4d1a">lfsck_object_put</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01220"></a>01220                                     <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj)
<a name="l01221"></a>01221 {
<a name="l01222"></a>01222         <a class="code" href="group__lu.html#ga0d53e3777af7b81492a1178c75b872ea" title="Decrease reference counter on object.">lu_object_put</a>(env, &amp;obj-&gt;<a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>);
<a name="l01223"></a>01223 }
<a name="l01224"></a>01224 
<a name="l01225"></a>01225 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structseq__server__site.html">seq_server_site</a>
<a name="l01226"></a><a class="code" href="lfsck__internal_8h.html#a7c681b8477093d202e3cd99847fc973d">01226</a> *<a class="code" href="lfsck__internal_8h.html#a7c681b8477093d202e3cd99847fc973d">lfsck_dev_site</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck)
<a name="l01227"></a>01227 {
<a name="l01228"></a>01228         <span class="keywordflow">return</span> <a class="code" href="group__lu.html#ga5fc6a083124319b2b8043efb69e4e5cf">lu_site2seq</a>(lfsck-&gt;<a class="code" href="structlfsck__instance.html#ab01f0f90dc2df61195fee7dc3ed8cb70">li_bottom</a>-&gt;<a class="code" href="structdt__device.html#a54e8912d9668696ec00395a14ca44fd3">dd_lu_dev</a>.<a class="code" href="structlu__device.html#aaa1ef1e1a330f307a9baf6e59fc9c39b" title="Stack this device belongs to.">ld_site</a>);
<a name="l01229"></a>01229 }
<a name="l01230"></a>01230 
<a name="l01231"></a><a class="code" href="lfsck__internal_8h.html#a8c12679b2d7674a1b3283cbb618fe682">01231</a> <span class="keyword">static</span> <span class="keyword">inline</span> u32 <a class="code" href="lfsck__internal_8h.html#a8c12679b2d7674a1b3283cbb618fe682">lfsck_dev_idx</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck)
<a name="l01232"></a>01232 {
<a name="l01233"></a>01233         <span class="keywordflow">return</span> <a class="code" href="lfsck__internal_8h.html#a7c681b8477093d202e3cd99847fc973d">lfsck_dev_site</a>(lfsck)-&gt;<a class="code" href="structseq__server__site.html#ac6ed0968d534f1eda5c11d36b6b9539f" title="mds number of this site.">ss_node_id</a>;
<a name="l01234"></a>01234 }
<a name="l01235"></a>01235 
<a name="l01236"></a>01236 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *
<a name="l01237"></a><a class="code" href="lfsck__internal_8h.html#a872a96eba836a4991b1b5b6e621228ae">01237</a> <a class="code" href="lfsck__internal_8h.html#a872a96eba836a4991b1b5b6e621228ae">lfsck_object_find_by_dev_nowait</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l01238"></a>01238                                 <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid)
<a name="l01239"></a>01239 {
<a name="l01240"></a>01240         <span class="keyword">struct </span><a class="code" href="structlu__object__conf.html" title="Object configuration, describing particulars of object being created.">lu_object_conf</a>   *conf = &amp;<a class="code" href="lfsck__internal_8h.html#abb9457be30c659d70ff99694ad4fe480">lfsck_env_info</a>(env)-&gt;<a class="code" href="structlfsck__thread__info.html#a7b31446e7a49752b8d28e29a4aa0dc8f">lti_conf</a>;
<a name="l01241"></a>01241 
<a name="l01242"></a>01242         conf-&gt;<a class="code" href="structlu__object__conf.html#ac9e27ea1ac308a8d3b2e8e9813056b93" title="Some hints for obj find and alloc.">loc_flags</a> = <a class="code" href="group__lu.html#gga58f82afcd61f0bd5c9e35ad9940514b7a1f74a17989ada2d1d4626193dcc9c33a">LOC_F_NOWAIT</a>;
<a name="l01243"></a>01243         <span class="keywordflow">return</span> <a class="code" href="group__dt.html#gaadfb7a922df20e32acb36ba8c2686905">lu2dt</a>(<a class="code" href="group__lu.html#ga54cb269068bb3767dde66b0bb58afb70" title="Find object with given fid, and return its slice belonging to given device.">lu_object_find_slice</a>(env, <a class="code" href="group__dt.html#gae6d1816825dca57aa1f86374bbc8b637">dt2lu_dev</a>(dev), fid, conf));
<a name="l01244"></a>01244 }
<a name="l01245"></a>01245 
<a name="l01246"></a>01246 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *
<a name="l01247"></a><a class="code" href="lfsck__internal_8h.html#a1d3ee0baebb2ac9ddf27235090be1e37">01247</a> <a class="code" href="lfsck__internal_8h.html#a1d3ee0baebb2ac9ddf27235090be1e37">lfsck_object_find_by_dev</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev,
<a name="l01248"></a>01248                          <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid)
<a name="l01249"></a>01249 {
<a name="l01250"></a>01250         <span class="keywordflow">return</span> <a class="code" href="group__dt.html#gaadfb7a922df20e32acb36ba8c2686905">lu2dt</a>(<a class="code" href="group__lu.html#ga54cb269068bb3767dde66b0bb58afb70" title="Find object with given fid, and return its slice belonging to given device.">lu_object_find_slice</a>(env, <a class="code" href="group__dt.html#gae6d1816825dca57aa1f86374bbc8b637">dt2lu_dev</a>(dev), fid, NULL));
<a name="l01251"></a>01251 }
<a name="l01252"></a>01252 
<a name="l01253"></a>01253 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *
<a name="l01254"></a><a class="code" href="lfsck__internal_8h.html#a68644127bb0e0d87ba7a9fa87cbe5271">01254</a> <a class="code" href="lfsck__internal_8h.html#a68644127bb0e0d87ba7a9fa87cbe5271">lfsck_find_dev_by_fid</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck,
<a name="l01255"></a>01255                       <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid)
<a name="l01256"></a>01256 {
<a name="l01257"></a>01257         <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *dev;
<a name="l01258"></a>01258         <span class="keywordtype">int</span>               idx;
<a name="l01259"></a>01259 
<a name="l01260"></a>01260         <span class="keywordflow">if</span> (!lfsck-&gt;<a class="code" href="structlfsck__instance.html#ab40e5646cf4f396073f4008c276ac8a0">li_master</a>)
<a name="l01261"></a>01261                 <span class="keywordflow">return</span> lfsck-&gt;<a class="code" href="structlfsck__instance.html#ab01f0f90dc2df61195fee7dc3ed8cb70">li_bottom</a>;
<a name="l01262"></a>01262 
<a name="l01263"></a>01263         idx = <a class="code" href="lfsck__internal_8h.html#aa7c1dbcdae1c09a1496699e6024f1d94">lfsck_find_mdt_idx_by_fid</a>(env, lfsck, fid);
<a name="l01264"></a>01264         <span class="keywordflow">if</span> (idx &lt; 0)
<a name="l01265"></a>01265                 <span class="keywordflow">return</span> ERR_PTR(idx);
<a name="l01266"></a>01266 
<a name="l01267"></a>01267         <span class="keywordflow">if</span> (idx == <a class="code" href="lfsck__internal_8h.html#a8c12679b2d7674a1b3283cbb618fe682">lfsck_dev_idx</a>(lfsck)) {
<a name="l01268"></a>01268                 dev = lfsck-&gt;<a class="code" href="structlfsck__instance.html#ab01f0f90dc2df61195fee7dc3ed8cb70">li_bottom</a>;
<a name="l01269"></a>01269         } <span class="keywordflow">else</span> {
<a name="l01270"></a>01270                 <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__desc.html">lfsck_tgt_desc</a> *ltd;
<a name="l01271"></a>01271 
<a name="l01272"></a>01272                 ltd = <a class="code" href="lfsck__internal_8h.html#a2193f42020089643af5541bd7aad7738">lfsck_ltd2tgt</a>(&amp;lfsck-&gt;<a class="code" href="structlfsck__instance.html#afaa6d0ab393910e52080541251e20643">li_mdt_descs</a>, idx);
<a name="l01273"></a>01273                 <span class="keywordflow">if</span> (<a class="code" href="libcfs__private_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(ltd == NULL))
<a name="l01274"></a>01274                         <span class="keywordflow">return</span> ERR_PTR(-ENODEV);
<a name="l01275"></a>01275 
<a name="l01276"></a>01276                 dev = ltd-&gt;<a class="code" href="structlfsck__tgt__desc.html#a0ce2e735d5ed2af4457e1892f7613952">ltd_tgt</a>;
<a name="l01277"></a>01277         }
<a name="l01278"></a>01278 
<a name="l01279"></a>01279         <span class="keywordflow">return</span> dev;
<a name="l01280"></a>01280 }
<a name="l01281"></a>01281 
<a name="l01282"></a>01282 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *
<a name="l01283"></a><a class="code" href="lfsck__internal_8h.html#aeaef5d2115f85ec66a66efadc2a49d63">01283</a> <a class="code" href="lfsck__internal_8h.html#aeaef5d2115f85ec66a66efadc2a49d63">lfsck_object_find_bottom</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env, <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck,
<a name="l01284"></a>01284                          <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid)
<a name="l01285"></a>01285 {
<a name="l01286"></a>01286         <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *dev;
<a name="l01287"></a>01287 
<a name="l01288"></a>01288         dev = <a class="code" href="lfsck__internal_8h.html#a68644127bb0e0d87ba7a9fa87cbe5271">lfsck_find_dev_by_fid</a>(env, lfsck, fid);
<a name="l01289"></a>01289         <span class="keywordflow">if</span> (IS_ERR(dev))
<a name="l01290"></a>01290                 <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *)dev;
<a name="l01291"></a>01291 
<a name="l01292"></a>01292         <span class="keywordflow">return</span> <a class="code" href="lfsck__internal_8h.html#a1d3ee0baebb2ac9ddf27235090be1e37">lfsck_object_find_by_dev</a>(env, dev, fid);
<a name="l01293"></a>01293 }
<a name="l01294"></a>01294 
<a name="l01295"></a>01295 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *
<a name="l01296"></a><a class="code" href="lfsck__internal_8h.html#a438e8c3a8e6ddb4b96abb4f3e8b7724f">01296</a> <a class="code" href="lfsck__internal_8h.html#a438e8c3a8e6ddb4b96abb4f3e8b7724f">lfsck_object_find_bottom_nowait</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01297"></a>01297                                 <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck,
<a name="l01298"></a>01298                                 <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid)
<a name="l01299"></a>01299 {
<a name="l01300"></a>01300         <span class="keyword">struct </span><a class="code" href="structdt__device.html">dt_device</a> *dev;
<a name="l01301"></a>01301 
<a name="l01302"></a>01302         dev = <a class="code" href="lfsck__internal_8h.html#a68644127bb0e0d87ba7a9fa87cbe5271">lfsck_find_dev_by_fid</a>(env, lfsck, fid);
<a name="l01303"></a>01303         <span class="keywordflow">if</span> (IS_ERR(dev))
<a name="l01304"></a>01304                 <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *)dev;
<a name="l01305"></a>01305 
<a name="l01306"></a>01306         <span class="keywordflow">return</span> <a class="code" href="lfsck__internal_8h.html#a872a96eba836a4991b1b5b6e621228ae">lfsck_object_find_by_dev_nowait</a>(env, dev, fid);
<a name="l01307"></a>01307 }
<a name="l01308"></a>01308 
<a name="l01309"></a>01309 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structdt__object.html">dt_object</a> *
<a name="l01310"></a><a class="code" href="lfsck__internal_8h.html#ab87e385c443875b600b4e1a966b5d9a0">01310</a> <a class="code" href="lfsck__internal_8h.html#ab87e385c443875b600b4e1a966b5d9a0">lfsck_object_locate</a>(<span class="keyword">struct</span> <a class="code" href="structdt__device.html">dt_device</a> *dev, <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj)
<a name="l01311"></a>01311 {
<a name="l01312"></a>01312         <span class="keywordflow">if</span> (<a class="code" href="lfsck__internal_8h.html#a34bbe61a915878b2496b4571468f0170">lfsck_obj2dev</a>(obj) == dev) {
<a name="l01313"></a>01313                 <span class="keywordflow">return</span> obj;
<a name="l01314"></a>01314         } <span class="keywordflow">else</span> {
<a name="l01315"></a>01315                 <span class="keyword">struct </span><a class="code" href="structlu__object.html" title="Layer in the layered object.">lu_object</a> *lo;
<a name="l01316"></a>01316 
<a name="l01317"></a>01317                 lo = <a class="code" href="group__lu.html#gaee34b6396491c109bd66e4c055dd7189" title="Given a compound object, find its slice, corresponding to the device type dtype.">lu_object_locate</a>(obj-&gt;<a class="code" href="structdt__object.html#af646d1f1afe6acdc83ad0778a29163d7">do_lu</a>.<a class="code" href="structlu__object.html#ab55ad0889ad4d306d0a5aad7ed0aa398" title="Header for this object.">lo_header</a>,
<a name="l01318"></a>01318                                       dev-&gt;<a class="code" href="structdt__device.html#a54e8912d9668696ec00395a14ca44fd3">dd_lu_dev</a>.<a class="code" href="structlu__device.html#ad5886c6b5e9a91f07f22d33bbcdb5718" title="Pointer to device type.">ld_type</a>);
<a name="l01319"></a>01319                 <span class="keywordflow">if</span> (<a class="code" href="libcfs__private_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(lo == NULL))
<a name="l01320"></a>01320                         <span class="keywordflow">return</span> ERR_PTR(-ENOENT);
<a name="l01321"></a>01321 
<a name="l01322"></a>01322                 <span class="keywordflow">return</span> <a class="code" href="group__dt.html#gaadfb7a922df20e32acb36ba8c2686905">lu2dt</a>(lo);
<a name="l01323"></a>01323         }
<a name="l01324"></a>01324 }
<a name="l01325"></a>01325 
<a name="l01326"></a><a class="code" href="lfsck__internal_8h.html#afc488a07d39217283f875a850e9d81b2">01326</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__desc.html">lfsck_tgt_desc</a> *<a class="code" href="lfsck__internal_8h.html#afc488a07d39217283f875a850e9d81b2">lfsck_tgt_get</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__tgt__descs.html">lfsck_tgt_descs</a> *ltds,
<a name="l01327"></a>01327                                                    __u32 index)
<a name="l01328"></a>01328 {
<a name="l01329"></a>01329         <span class="keyword">struct </span><a class="code" href="structlfsck__tgt__desc.html">lfsck_tgt_desc</a> *ltd;
<a name="l01330"></a>01330 
<a name="l01331"></a>01331         ltd = <a class="code" href="lfsck__internal_8h.html#a2193f42020089643af5541bd7aad7738">lfsck_ltd2tgt</a>(ltds, index);
<a name="l01332"></a>01332         <span class="keywordflow">if</span> (ltd != NULL)
<a name="l01333"></a>01333                 atomic_inc(&amp;ltd-&gt;<a class="code" href="structlfsck__tgt__desc.html#a3f86069b9d2aa7ba29d841f4fd8eb986">ltd_ref</a>);
<a name="l01334"></a>01334 
<a name="l01335"></a>01335         <span class="keywordflow">return</span> ltd;
<a name="l01336"></a>01336 }
<a name="l01337"></a>01337 
<a name="l01338"></a><a class="code" href="lfsck__internal_8h.html#a6b98305b4735183505e40791dc33c88f">01338</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a6b98305b4735183505e40791dc33c88f">lfsck_tgt_put</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__tgt__desc.html">lfsck_tgt_desc</a> *ltd)
<a name="l01339"></a>01339 {
<a name="l01340"></a>01340         <span class="keywordflow">if</span> (atomic_dec_and_test(&amp;ltd-&gt;<a class="code" href="structlfsck__tgt__desc.html#a3f86069b9d2aa7ba29d841f4fd8eb986">ltd_ref</a>))
<a name="l01341"></a>01341                 <a class="code" href="obd__support_8h.html#a56214d823e92375ad47cd06a7daeae7a">OBD_FREE_PTR</a>(ltd);
<a name="l01342"></a>01342 }
<a name="l01343"></a>01343 
<a name="l01344"></a>01344 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structlfsck__component.html">lfsck_component</a> *
<a name="l01345"></a><a class="code" href="lfsck__internal_8h.html#ad106250e84ff81f4b8f0d4de4ee9fe13">01345</a> <a class="code" href="lfsck__internal_8h.html#ad106250e84ff81f4b8f0d4de4ee9fe13">lfsck_component_get</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com)
<a name="l01346"></a>01346 {
<a name="l01347"></a>01347         atomic_inc(&amp;com-&gt;<a class="code" href="structlfsck__component.html#a25ae67201755b306a9068033ff77831d">lc_ref</a>);
<a name="l01348"></a>01348 
<a name="l01349"></a>01349         <span class="keywordflow">return</span> com;
<a name="l01350"></a>01350 }
<a name="l01351"></a>01351 
<a name="l01352"></a><a class="code" href="lfsck__internal_8h.html#ac4fdef79518be720c926d699115191b2">01352</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#ac4fdef79518be720c926d699115191b2">lfsck_component_put</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01353"></a>01353                                        <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com)
<a name="l01354"></a>01354 {
<a name="l01355"></a>01355         <span class="keywordflow">if</span> (atomic_dec_and_test(&amp;com-&gt;<a class="code" href="structlfsck__component.html#a25ae67201755b306a9068033ff77831d">lc_ref</a>)) {
<a name="l01356"></a>01356                 <span class="keyword">struct </span><a class="code" href="structlfsck__sub__trace__obj.html">lfsck_sub_trace_obj</a> *lsto;
<a name="l01357"></a>01357                 <span class="keywordtype">int</span>                         i;
<a name="l01358"></a>01358 
<a name="l01359"></a>01359                 <span class="keywordflow">for</span> (i = 0, lsto = &amp;com-&gt;<a class="code" href="structlfsck__component.html#a594f2261fe6ca3acf78d7ea9b264c7fc">lc_sub_trace_objs</a>[0];
<a name="l01360"></a>01360                      i &lt; <a class="code" href="lfsck__internal_8h.html#a001e112f96436345749574e4f755aeb5">LFSCK_STF_COUNT</a>; i++, lsto++) {
<a name="l01361"></a>01361                         <span class="keywordflow">if</span> (lsto-&gt;<a class="code" href="structlfsck__sub__trace__obj.html#aedbae78c5ff557647edfff8d01dcfcde">lsto_obj</a> != NULL)
<a name="l01362"></a>01362                                 <a class="code" href="lfsck__internal_8h.html#ac0be804c9127f9c877d7af9a6d1b4d1a">lfsck_object_put</a>(env, lsto-&gt;<a class="code" href="structlfsck__sub__trace__obj.html#aedbae78c5ff557647edfff8d01dcfcde">lsto_obj</a>);
<a name="l01363"></a>01363                 }
<a name="l01364"></a>01364 
<a name="l01365"></a>01365                 <span class="keywordflow">if</span> (com-&gt;<a class="code" href="structlfsck__component.html#ad0ec2d5887ad39911f807525e54a5d82">lc_obj</a> != NULL)
<a name="l01366"></a>01366                         <a class="code" href="lfsck__internal_8h.html#ac0be804c9127f9c877d7af9a6d1b4d1a">lfsck_object_put</a>(env, com-&gt;<a class="code" href="structlfsck__component.html#ad0ec2d5887ad39911f807525e54a5d82">lc_obj</a>);
<a name="l01367"></a>01367                 <span class="keywordflow">if</span> (com-&gt;<a class="code" href="structlfsck__component.html#a2deb51c3b27862404fdb6f59a79ec571">lc_file_ram</a> != NULL)
<a name="l01368"></a>01368                         <a class="code" href="obd__support_8h.html#a9bf49373d607ed467488261f133e5e49">OBD_FREE</a>(com-&gt;<a class="code" href="structlfsck__component.html#a2deb51c3b27862404fdb6f59a79ec571">lc_file_ram</a>, com-&gt;<a class="code" href="structlfsck__component.html#a552c6f201f27dd9d14d8f41b4ba6cf31">lc_file_size</a>);
<a name="l01369"></a>01369                 <span class="keywordflow">if</span> (com-&gt;<a class="code" href="structlfsck__component.html#a000814292d24b2ba90bc8f6c24a58c36">lc_file_disk</a> != NULL)
<a name="l01370"></a>01370                         <a class="code" href="obd__support_8h.html#a9bf49373d607ed467488261f133e5e49">OBD_FREE</a>(com-&gt;<a class="code" href="structlfsck__component.html#a000814292d24b2ba90bc8f6c24a58c36">lc_file_disk</a>, com-&gt;<a class="code" href="structlfsck__component.html#a552c6f201f27dd9d14d8f41b4ba6cf31">lc_file_size</a>);
<a name="l01371"></a>01371                 <span class="keywordflow">if</span> (com-&gt;<a class="code" href="structlfsck__component.html#ac4a031ef8d2120c57936508c6a77f21e">lc_data</a> != NULL) {
<a name="l01372"></a>01372                         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(com-&gt;<a class="code" href="structlfsck__component.html#ad99aeeedf3999b43dda660248af44d14">lc_ops</a>-&gt;<a class="code" href="structlfsck__operations.html#ad7a107262d05e75c5b11266147c76a3b">lfsck_data_release</a> != NULL);
<a name="l01373"></a>01373 
<a name="l01374"></a>01374                         com-&gt;<a class="code" href="structlfsck__component.html#ad99aeeedf3999b43dda660248af44d14">lc_ops</a>-&gt;<a class="code" href="structlfsck__operations.html#ad7a107262d05e75c5b11266147c76a3b">lfsck_data_release</a>(env, com);
<a name="l01375"></a>01375                 }
<a name="l01376"></a>01376 
<a name="l01377"></a>01377                 <a class="code" href="obd__support_8h.html#a56214d823e92375ad47cd06a7daeae7a">OBD_FREE_PTR</a>(com);
<a name="l01378"></a>01378         }
<a name="l01379"></a>01379 }
<a name="l01380"></a>01380 
<a name="l01381"></a>01381 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structlfsck__instance.html">lfsck_instance</a> *
<a name="l01382"></a><a class="code" href="lfsck__internal_8h.html#af1ab4397428fd452aae5c21570c80be8">01382</a> <a class="code" href="lfsck__internal_8h.html#af1ab4397428fd452aae5c21570c80be8">lfsck_instance_get</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck)
<a name="l01383"></a>01383 {
<a name="l01384"></a>01384         atomic_inc(&amp;lfsck-&gt;<a class="code" href="structlfsck__instance.html#afdb7189ee2d8c1d794744c378bc4d1b3">li_ref</a>);
<a name="l01385"></a>01385 
<a name="l01386"></a>01386         <span class="keywordflow">return</span> lfsck;
<a name="l01387"></a>01387 }
<a name="l01388"></a>01388 
<a name="l01389"></a><a class="code" href="lfsck__internal_8h.html#a77a79e177b50ef7ed74cbcc9d185cc57">01389</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a77a79e177b50ef7ed74cbcc9d185cc57">lfsck_instance_put</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01390"></a>01390                                       <span class="keyword">struct</span> <a class="code" href="structlfsck__instance.html">lfsck_instance</a> *lfsck)
<a name="l01391"></a>01391 {
<a name="l01392"></a>01392         <span class="keywordflow">if</span> (atomic_dec_and_test(&amp;lfsck-&gt;<a class="code" href="structlfsck__instance.html#afdb7189ee2d8c1d794744c378bc4d1b3">li_ref</a>))
<a name="l01393"></a>01393                 <a class="code" href="lfsck__internal_8h.html#a474e8af1234983aaac508e097a6591b1">lfsck_instance_cleanup</a>(env, lfsck);
<a name="l01394"></a>01394 }
<a name="l01395"></a>01395 
<a name="l01396"></a><a class="code" href="lfsck__internal_8h.html#add754bfac6a9b0fd7ed2eb0796537fa1">01396</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="lfsck__internal_8h.html#add754bfac6a9b0fd7ed2eb0796537fa1">lfsck_phase2_next_ready</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__assistant__data.html">lfsck_assistant_data</a> *lad)
<a name="l01397"></a>01397 {
<a name="l01398"></a>01398         <span class="keywordflow">return</span> <a class="code" href="list_8h.html#a0fce12be81e8f2677b3a272fee1652ac" title="Test whether a list is empty.">list_empty</a>(&amp;lad-&gt;<a class="code" href="structlfsck__assistant__data.html#a4a8a745291816a7a44c77fafd1f0a9eb">lad_mdt_phase1_list</a>) &amp;&amp;
<a name="l01399"></a>01399                (!<a class="code" href="list_8h.html#a0fce12be81e8f2677b3a272fee1652ac" title="Test whether a list is empty.">list_empty</a>(&amp;lad-&gt;<a class="code" href="structlfsck__assistant__data.html#ad87542de9120386cb4b916cd0c591b27">lad_ost_phase2_list</a>) ||
<a name="l01400"></a>01400                 <a class="code" href="list_8h.html#a0fce12be81e8f2677b3a272fee1652ac" title="Test whether a list is empty.">list_empty</a>(&amp;lad-&gt;<a class="code" href="structlfsck__assistant__data.html#a322d2d110f1faf06d5c1f1e17719dfd1">lad_ost_phase1_list</a>));
<a name="l01401"></a>01401 }
<a name="l01402"></a>01402 
<a name="l01403"></a><a class="code" href="lfsck__internal_8h.html#a4fa0e5c8fa0d4dd053a6fc665b7906d6">01403</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a4fa0e5c8fa0d4dd053a6fc665b7906d6">lfsck_lad_set_bitmap</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01404"></a>01404                                         <span class="keyword">struct</span> <a class="code" href="structlfsck__component.html">lfsck_component</a> *com,
<a name="l01405"></a>01405                                         __u32 index)
<a name="l01406"></a>01406 {
<a name="l01407"></a>01407         <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__data.html">lfsck_assistant_data</a>     *lad    = com-&gt;<a class="code" href="structlfsck__component.html#ac4a031ef8d2120c57936508c6a77f21e">lc_data</a>;
<a name="l01408"></a>01408         <span class="keyword">struct </span><a class="code" href="structcfs__bitmap.html">cfs_bitmap</a>               *bitmap = lad-&gt;<a class="code" href="structlfsck__assistant__data.html#a277c7b8f2e0ab1a1505a6ebb49a55854">lad_bitmap</a>;
<a name="l01409"></a>01409 
<a name="l01410"></a>01410         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(com-&gt;<a class="code" href="structlfsck__component.html#a791bae30ccfab307e3b5aa7829c18eca">lc_lfsck</a>-&gt;<a class="code" href="structlfsck__instance.html#ab40e5646cf4f396073f4008c276ac8a0">li_master</a>);
<a name="l01411"></a>01411         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(bitmap != NULL);
<a name="l01412"></a>01412 
<a name="l01413"></a>01413         <span class="keywordflow">if</span> (<a class="code" href="libcfs__private_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a>(bitmap-&gt;<a class="code" href="structcfs__bitmap.html#a0c7b76afa8c975a626200df5a924bcfc">size</a> &gt; index)) {
<a name="l01414"></a>01414                 <a class="code" href="bitmap_8h.html#a1ea05208224f7b4a545aa2a953e76a62">cfs_bitmap_set</a>(bitmap, index);
<a name="l01415"></a>01415                 lad-&gt;<a class="code" href="structlfsck__assistant__data.html#a519b2c5b5995e838842330855c4948d0">lad_incomplete</a> = 1;
<a name="l01416"></a>01416         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (com-&gt;<a class="code" href="structlfsck__component.html#a03bf4c72d2f986904d5e352696850f77">lc_type</a> == <a class="code" href="lustre__lfsck__user_8h.html#a9227f249ebe4f9e66a984a270cd6fd95af815fbd1f07c86140e96d307145fc885">LFSCK_TYPE_NAMESPACE</a>) {
<a name="l01417"></a>01417                 <span class="keyword">struct </span><a class="code" href="structlfsck__namespace.html">lfsck_namespace</a> *ns = com-&gt;<a class="code" href="structlfsck__component.html#a2deb51c3b27862404fdb6f59a79ec571">lc_file_ram</a>;
<a name="l01418"></a>01418 
<a name="l01419"></a>01419                 ns-&gt;<a class="code" href="structlfsck__namespace.html#a8ba3bfe8df3914371ec4e399d8636d2d">ln_flags</a> |= <a class="code" href="lfsck__internal_8h.html#a572af1bd0c8abadbaf9ce0fabe683861ae11da1b86ed6b9769a9903a393d0a22d">LF_INCOMPLETE</a>;
<a name="l01420"></a>01420         }
<a name="l01421"></a>01421 }
<a name="l01422"></a>01422 
<a name="l01423"></a><a class="code" href="lfsck__internal_8h.html#a1f781ea9d5b9b7ac50bb9de228f2ae3e">01423</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a1f781ea9d5b9b7ac50bb9de228f2ae3e">lfsck_links_read</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01424"></a>01424                                    <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj,
<a name="l01425"></a>01425                                    <span class="keyword">struct</span> <a class="code" href="structlinkea__data.html">linkea_data</a> *ldata)
<a name="l01426"></a>01426 {
<a name="l01427"></a>01427         ldata-&gt;<a class="code" href="structlinkea__data.html#a2728af8bed33786e0b43d7df9692e396" title="Buffer to keep link EA body.">ld_buf</a> =
<a name="l01428"></a>01428                 <a class="code" href="group__lu.html#ga5091d615af18058ea9cf77ec076fefc9">lu_buf_check_and_alloc</a>(&amp;<a class="code" href="lfsck__internal_8h.html#abb9457be30c659d70ff99694ad4fe480">lfsck_env_info</a>(env)-&gt;lti_linkea_buf,
<a name="l01429"></a>01429                                        PAGE_CACHE_SIZE);
<a name="l01430"></a>01430 
<a name="l01431"></a>01431         <span class="keywordflow">return</span> <a class="code" href="lfsck__internal_8h.html#ae813731a3c21ac557857ceb6a94d2e2e">__lfsck_links_read</a>(env, obj, ldata);
<a name="l01432"></a>01432 }
<a name="l01433"></a>01433 
<a name="l01434"></a><a class="code" href="lfsck__internal_8h.html#a793ba45056d1b49963ce36b64e15ac79">01434</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#a793ba45056d1b49963ce36b64e15ac79">lfsck_links_read2</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01435"></a>01435                                     <span class="keyword">struct</span> <a class="code" href="structdt__object.html">dt_object</a> *obj,
<a name="l01436"></a>01436                                     <span class="keyword">struct</span> <a class="code" href="structlinkea__data.html">linkea_data</a> *ldata)
<a name="l01437"></a>01437 {
<a name="l01438"></a>01438         ldata-&gt;<a class="code" href="structlinkea__data.html#a2728af8bed33786e0b43d7df9692e396" title="Buffer to keep link EA body.">ld_buf</a> =
<a name="l01439"></a>01439                 <a class="code" href="group__lu.html#ga5091d615af18058ea9cf77ec076fefc9">lu_buf_check_and_alloc</a>(&amp;<a class="code" href="lfsck__internal_8h.html#abb9457be30c659d70ff99694ad4fe480">lfsck_env_info</a>(env)-&gt;lti_linkea_buf2,
<a name="l01440"></a>01440                                        PAGE_CACHE_SIZE);
<a name="l01441"></a>01441 
<a name="l01442"></a>01442         <span class="keywordflow">return</span> <a class="code" href="lfsck__internal_8h.html#ae813731a3c21ac557857ceb6a94d2e2e">__lfsck_links_read</a>(env, obj, ldata);
<a name="l01443"></a>01443 }
<a name="l01444"></a>01444 
<a name="l01445"></a><a class="code" href="lfsck__internal_8h.html#a4c5cf782bc8dcdfe49a7879370b414ac">01445</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structlfsck__lmv.html">lfsck_lmv</a> *<a class="code" href="lfsck__internal_8h.html#a4c5cf782bc8dcdfe49a7879370b414ac">lfsck_lmv_get</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__lmv.html">lfsck_lmv</a> *llmv)
<a name="l01446"></a>01446 {
<a name="l01447"></a>01447         <span class="keywordflow">if</span> (llmv != NULL)
<a name="l01448"></a>01448                 atomic_inc(&amp;llmv-&gt;<a class="code" href="structlfsck__lmv.html#a39df509b0e56628a8eae462537aca505">ll_ref</a>);
<a name="l01449"></a>01449 
<a name="l01450"></a>01450         <span class="keywordflow">return</span> llmv;
<a name="l01451"></a>01451 }
<a name="l01452"></a>01452 
<a name="l01453"></a><a class="code" href="lfsck__internal_8h.html#aece39034244d13590528f27d9f97e4a2">01453</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="lfsck__internal_8h.html#aece39034244d13590528f27d9f97e4a2">lfsck_sub_trace_file_fid2idx</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid)
<a name="l01454"></a>01454 {
<a name="l01455"></a>01455         <span class="keywordflow">return</span> fid-&gt;<a class="code" href="structlu__fid.html#a48aec36397824074ed1624b09edef75a">f_oid</a> &amp; (<a class="code" href="lfsck__internal_8h.html#a001e112f96436345749574e4f755aeb5">LFSCK_STF_COUNT</a> - 1);
<a name="l01456"></a>01456 }
<a name="l01457"></a>01457 
<a name="l01458"></a><a class="code" href="lfsck__internal_8h.html#a70c45ebcb2d00daacd82b18b6d5d36a2">01458</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a70c45ebcb2d00daacd82b18b6d5d36a2">lfsck_lmv_header_le_to_cpu</a>(<span class="keyword">struct</span> <a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a> *dst,
<a name="l01459"></a>01459                                               <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a> *src)
<a name="l01460"></a>01460 {
<a name="l01461"></a>01461         dst-&gt;<a class="code" href="structlmv__mds__md__v1.html#ac2b14a45c4dd28ad5872864b645fe944">lmv_magic</a> = <a class="code" href="byteorder_8h.html#a48f527b00bc1d5e46366d720280a1039">le32_to_cpu</a>(src-&gt;<a class="code" href="structlmv__mds__md__v1.html#ac2b14a45c4dd28ad5872864b645fe944">lmv_magic</a>);
<a name="l01462"></a>01462         dst-&gt;<a class="code" href="structlmv__mds__md__v1.html#a3002cd6110eb9b23fc13986d18d60591">lmv_stripe_count</a> = <a class="code" href="byteorder_8h.html#a48f527b00bc1d5e46366d720280a1039">le32_to_cpu</a>(src-&gt;<a class="code" href="structlmv__mds__md__v1.html#a3002cd6110eb9b23fc13986d18d60591">lmv_stripe_count</a>);
<a name="l01463"></a>01463         dst-&gt;<a class="code" href="structlmv__mds__md__v1.html#a84b8f3843894cd656966dc846fa36763">lmv_master_mdt_index</a> = <a class="code" href="byteorder_8h.html#a48f527b00bc1d5e46366d720280a1039">le32_to_cpu</a>(src-&gt;<a class="code" href="structlmv__mds__md__v1.html#a84b8f3843894cd656966dc846fa36763">lmv_master_mdt_index</a>);
<a name="l01464"></a>01464         dst-&gt;<a class="code" href="structlmv__mds__md__v1.html#a319805ff1f68b1bf3354d715fbfdf1d5">lmv_hash_type</a> = <a class="code" href="byteorder_8h.html#a48f527b00bc1d5e46366d720280a1039">le32_to_cpu</a>(src-&gt;<a class="code" href="structlmv__mds__md__v1.html#a319805ff1f68b1bf3354d715fbfdf1d5">lmv_hash_type</a>);
<a name="l01465"></a>01465         dst-&gt;<a class="code" href="structlmv__mds__md__v1.html#ac03443e0880b55f3105b28d2bbd683c1">lmv_layout_version</a> = <a class="code" href="byteorder_8h.html#a48f527b00bc1d5e46366d720280a1039">le32_to_cpu</a>(src-&gt;<a class="code" href="structlmv__mds__md__v1.html#ac03443e0880b55f3105b28d2bbd683c1">lmv_layout_version</a>);
<a name="l01466"></a>01466 }
<a name="l01467"></a>01467 
<a name="l01468"></a><a class="code" href="lfsck__internal_8h.html#a77d3a46f480b658ce300d8155d0eeabb">01468</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="lfsck__internal_8h.html#a77d3a46f480b658ce300d8155d0eeabb">lfsck_lmv_header_cpu_to_le</a>(<span class="keyword">struct</span> <a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a> *dst,
<a name="l01469"></a>01469                                               <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlmv__mds__md__v1.html">lmv_mds_md_v1</a> *src)
<a name="l01470"></a>01470 {
<a name="l01471"></a>01471         dst-&gt;<a class="code" href="structlmv__mds__md__v1.html#ac2b14a45c4dd28ad5872864b645fe944">lmv_magic</a> = <a class="code" href="byteorder_8h.html#a1d5ae0c36d519a1b0a789db69a598f28">cpu_to_le32</a>(src-&gt;<a class="code" href="structlmv__mds__md__v1.html#ac2b14a45c4dd28ad5872864b645fe944">lmv_magic</a>);
<a name="l01472"></a>01472         dst-&gt;<a class="code" href="structlmv__mds__md__v1.html#a3002cd6110eb9b23fc13986d18d60591">lmv_stripe_count</a> = <a class="code" href="byteorder_8h.html#a1d5ae0c36d519a1b0a789db69a598f28">cpu_to_le32</a>(src-&gt;<a class="code" href="structlmv__mds__md__v1.html#a3002cd6110eb9b23fc13986d18d60591">lmv_stripe_count</a>);
<a name="l01473"></a>01473         dst-&gt;<a class="code" href="structlmv__mds__md__v1.html#a84b8f3843894cd656966dc846fa36763">lmv_master_mdt_index</a> = <a class="code" href="byteorder_8h.html#a1d5ae0c36d519a1b0a789db69a598f28">cpu_to_le32</a>(src-&gt;<a class="code" href="structlmv__mds__md__v1.html#a84b8f3843894cd656966dc846fa36763">lmv_master_mdt_index</a>);
<a name="l01474"></a>01474         dst-&gt;<a class="code" href="structlmv__mds__md__v1.html#a319805ff1f68b1bf3354d715fbfdf1d5">lmv_hash_type</a> = <a class="code" href="byteorder_8h.html#a1d5ae0c36d519a1b0a789db69a598f28">cpu_to_le32</a>(src-&gt;<a class="code" href="structlmv__mds__md__v1.html#a319805ff1f68b1bf3354d715fbfdf1d5">lmv_hash_type</a>);
<a name="l01475"></a>01475         dst-&gt;<a class="code" href="structlmv__mds__md__v1.html#ac03443e0880b55f3105b28d2bbd683c1">lmv_layout_version</a> = <a class="code" href="byteorder_8h.html#a1d5ae0c36d519a1b0a789db69a598f28">cpu_to_le32</a>(src-&gt;<a class="code" href="structlmv__mds__md__v1.html#ac03443e0880b55f3105b28d2bbd683c1">lmv_layout_version</a>);
<a name="l01476"></a>01476 }
<a name="l01477"></a>01477 
<a name="l01478"></a>01478 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structlfsck__assistant__object.html">lfsck_assistant_object</a> *
<a name="l01479"></a><a class="code" href="lfsck__internal_8h.html#ad0bd27463a47f4fb9cf0bae1dc0505b3">01479</a> <a class="code" href="lfsck__internal_8h.html#ad0bd27463a47f4fb9cf0bae1dc0505b3">lfsck_assistant_object_get</a>(<span class="keyword">struct</span> <a class="code" href="structlfsck__assistant__object.html">lfsck_assistant_object</a> *lso)
<a name="l01480"></a>01480 {
<a name="l01481"></a>01481         atomic_inc(&amp;lso-&gt;<a class="code" href="structlfsck__assistant__object.html#a4577d04984eb418aad89b51da8a1b207">lso_ref</a>);
<a name="l01482"></a>01482 
<a name="l01483"></a>01483         <span class="keywordflow">return</span> lso;
<a name="l01484"></a>01484 }
<a name="l01485"></a>01485 
<a name="l01486"></a>01486 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l01487"></a><a class="code" href="lfsck__internal_8h.html#a397e4d101d19fc3a145635b044601d88">01487</a> <a class="code" href="lfsck__internal_8h.html#a397e4d101d19fc3a145635b044601d88">lfsck_assistant_object_put</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__env.html" title="Environment.">lu_env</a> *env,
<a name="l01488"></a>01488                            <span class="keyword">struct</span> <a class="code" href="structlfsck__assistant__object.html">lfsck_assistant_object</a> *lso)
<a name="l01489"></a>01489 {
<a name="l01490"></a>01490         <span class="keywordflow">if</span> (atomic_dec_and_test(&amp;lso-&gt;<a class="code" href="structlfsck__assistant__object.html#a4577d04984eb418aad89b51da8a1b207">lso_ref</a>))
<a name="l01491"></a>01491                 <a class="code" href="obd__support_8h.html#a56214d823e92375ad47cd06a7daeae7a">OBD_FREE_PTR</a>(lso);
<a name="l01492"></a>01492 }
<a name="l01493"></a>01493 <span class="preprocessor">#endif </span><span class="comment">/* _LFSCK_INTERNAL_H */</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:36 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
