<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/osd-zfs/osd_io.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/osd-zfs/osd_io.c File Reference</h1><code>#include &lt;<a class="el" href="lustre__ver_8h_source.html">lustre_ver.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="libcfs_8h_source.html">libcfs/libcfs.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__support_8h_source.html">obd_support.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__net_8h_source.html">lustre_net.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd_8h_source.html">obd.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__class_8h_source.html">obd_class.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__disk_8h_source.html">lustre_disk.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__fid_8h_source.html">lustre_fid.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__idl_8h_source.html">lustre/lustre_idl.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="osd-zfs_2osd__internal_8h_source.html">osd_internal.h</a>&quot;</code><br/>
<code>#include &lt;sys/dnode.h&gt;</code><br/>
<code>#include &lt;sys/dbuf.h&gt;</code><br/>
<code>#include &lt;sys/spa.h&gt;</code><br/>
<code>#include &lt;sys/stat.h&gt;</code><br/>
<code>#include &lt;sys/zap.h&gt;</code><br/>
<code>#include &lt;sys/spa_impl.h&gt;</code><br/>
<code>#include &lt;sys/zfs_znode.h&gt;</code><br/>
<code>#include &lt;sys/dmu_tx.h&gt;</code><br/>
<code>#include &lt;sys/dmu_objset.h&gt;</code><br/>
<code>#include &lt;sys/dsl_prop.h&gt;</code><br/>
<code>#include &lt;sys/sa_impl.h&gt;</code><br/>
<code>#include &lt;sys/txg.h&gt;</code><br/>

<p><a href="osd-zfs_2osd__io_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>&nbsp;&nbsp;&nbsp;S_OSD</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#a4fef44f696cf6c99f1f4969e72e1b110">record_start_io</a> (struct <a class="el" href="structosd__device.html">osd_device</a> *osd, int rw, int discont_pages)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#aec3f659aa5595059e33e11687b73a0b4">record_end_io</a> (struct <a class="el" href="structosd__device.html">osd_device</a> *osd, int rw, unsigned long elapsed, int disksize, int npages)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static ssize_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#a94d82327de57e54cb0319881c2aa1a3f">osd_read</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, struct <a class="el" href="structlu__buf.html">lu_buf</a> *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, loff_t *pos)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static ssize_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#a464c0d805bd424fc8b6952a62a8e62ea">osd_declare_write</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, const struct <a class="el" href="structlu__buf.html">lu_buf</a> *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, loff_t pos, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static ssize_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#a36b457805e2e1352ed7fa33f6fbd2fcc">osd_write</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, const struct <a class="el" href="structlu__buf.html">lu_buf</a> *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, loff_t *pos, struct <a class="el" href="structthandle.html">thandle</a> *th, int ignore_quota)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#a057ac69ff5a816adf69ddcc93e742e77">osd_bufs_put</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *lnb, int npages)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct page *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#a607d9996dfdf57e27194177d97d414d9">kmem_to_page</a> (void *addr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#accab72de80fd81615ac569a67e91ce3b">osd_bufs_get_read</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosd__object.html">osd_object</a> *obj, loff_t off, ssize_t len, struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *lnb)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prepare buffers for read.  <a href="#accab72de80fd81615ac569a67e91ce3b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#afa703894a6b6c00ee4e1a0706cc0f340">osd_bufs_get_write</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosd__object.html">osd_object</a> *obj, loff_t off, ssize_t len, struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *lnb)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#aa8ab1fabf76398a1403cbce3dd9ef27b">osd_bufs_get</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, loff_t offset, ssize_t len, struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *lnb, int rw)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#a5b3cff7912d7a563750c9fb53eb5c748">osd_write_prep</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *lnb, int npages)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#a605b995b992c0c08051a3c6f88b1c166">osd_get_blocksz</a> (struct <a class="el" href="structosd__object.html">osd_object</a> *obj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#ababb227c9b46cbe517d5de9851382c63">osd_roundup2blocksz</a> (uint64_t <a class="el" href="parallel__grouplock_8c.html#a439227feff9d7f55384e8780cfc2eb82">size</a>, uint64_t offset, uint32_t blksz)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#ae9871a19e0a7cc422881eabe3ac15f85">osd_declare_write_commit</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *lnb, int npages, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#a505e1aa2607cb07ddbb53ba66cddc4f0">osd_write_commit</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *lnb, int npages, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#af4eba136432708c300e62184245f85f6">osd_read_prep</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *lnb, int npages)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#ae8fde745f0635f4a44457989fa42a838">__osd_object_punch</a> (objset_t *os, dmu_buf_t *db, dmu_tx_t *tx, uint64_t <a class="el" href="parallel__grouplock_8c.html#a439227feff9d7f55384e8780cfc2eb82">size</a>, uint64_t off, uint64_t len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#a204b0ba7a7684d6b5bc94b8035b8ded1">osd_punch</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="el" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> end, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#a55b1901cc3b21b3f9f7d9941b3d9000f">osd_declare_punch</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="el" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> end, struct <a class="el" href="structthandle.html">thandle</a> *handle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#abca1fa8fce517b1904f43b61d8cdc8c1">osd_ladvise</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="el" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> end, enum <a class="el" href="group__lustreuser.html#ga6800d248c7e9177fa2705d90cb97c86f">lu_ladvise_type</a> advice)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#adbb45f70d3374f2bda3fd09973ff0112">osd_zerocopy_tag</a> = &quot;zerocopy&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdt__body__operations.html">dt_body_operations</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osd-zfs_2osd__io_8c.html#a7209b71cf9559b05a2c6ed9358ac0119">osd_body_ops</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="abda60744d497fcfe370cfd6b2d65c7ed"></a><!-- doxytag: member="osd_io.c::DEBUG_SUBSYSTEM" ref="abda60744d497fcfe370cfd6b2d65c7ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_SUBSYSTEM&nbsp;&nbsp;&nbsp;S_OSD</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00042">42</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ae8fde745f0635f4a44457989fa42a838"></a><!-- doxytag: member="osd_io.c::__osd_object_punch" ref="ae8fde745f0635f4a44457989fa42a838" args="(objset_t *os, dmu_buf_t *db, dmu_tx_t *tx, uint64_t size, uint64_t off, uint64_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int __osd_object_punch </td>
          <td>(</td>
          <td class="paramtype">objset_t *&nbsp;</td>
          <td class="paramname"> <em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dmu_buf_t *&nbsp;</td>
          <td class="paramname"> <em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dmu_tx_t *&nbsp;</td>
          <td class="paramname"> <em>tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>off</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00819">819</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>.</p>

<p>Referenced by <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00839">osd_punch()</a>.</p>

</div>
</div>
<a class="anchor" id="a607d9996dfdf57e27194177d97d414d9"></a><!-- doxytag: member="osd_io.c::kmem_to_page" ref="a607d9996dfdf57e27194177d97d414d9" args="(void *addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct page* kmem_to_page </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>addr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00295">295</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>Referenced by <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00323">osd_bufs_get_read()</a>, and <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00407">osd_bufs_get_write()</a>.</p>

</div>
</div>
<a class="anchor" id="aa8ab1fabf76398a1403cbce3dd9ef27b"></a><!-- doxytag: member="osd_io.c::osd_bufs_get" ref="aa8ab1fabf76398a1403cbce3dd9ef27b" args="(const struct lu_env *env, struct dt_object *dt, loff_t offset, ssize_t len, struct niobuf_local *lnb, int rw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osd_bufs_get </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">loff_t&nbsp;</td>
          <td class="paramname"> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ssize_t&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *&nbsp;</td>
          <td class="paramname"> <em>lnb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rw</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00511">511</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01790">dt_object_exists()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00323">osd_bufs_get_read()</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00407">osd_bufs_get_write()</a>, and <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00905">osd_dt_obj()</a>.</p>

</div>
</div>
<a class="anchor" id="accab72de80fd81615ac569a67e91ce3b"></a><!-- doxytag: member="osd_io.c::osd_bufs_get_read" ref="accab72de80fd81615ac569a67e91ce3b" args="(const struct lu_env *env, struct osd_object *obj, loff_t off, ssize_t len, struct niobuf_local *lnb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osd_bufs_get_read </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosd__object.html">osd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">loff_t&nbsp;</td>
          <td class="paramname"> <em>off</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ssize_t&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *&nbsp;</td>
          <td class="paramname"> <em>lnb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prepare buffers for read. </p>
<p>The function maps the range described by <em>off</em> and <em>len</em> to <em>lnb</em> array. dmu_buf_hold_array_by_bonus() finds/creates appropriate ARC buffers, then we fill <em>lnb</em> array with the pages storing ARC buffers. Notice the current implementationt passes TRUE to dmu_buf_hold_array_by_bonus() to fill ARC buffers with actual data, I/O is done in the conext of <a class="el" href="osd-zfs_2osd__io_8c.html#accab72de80fd81615ac569a67e91ce3b" title="Prepare buffers for read.">osd_bufs_get_read()</a>. A better implementation would just return the buffers (potentially unfilled) and subsequent <a class="el" href="osd-zfs_2osd__io_8c.html#af4eba136432708c300e62184245f85f6">osd_read_prep()</a> would do I/O for many ranges concurrently.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>obj</em>&nbsp;</td><td>object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>off</em>&nbsp;</td><td>offset in bytes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>len</em>&nbsp;</td><td>the number of bytes to access </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>lnb</em>&nbsp;</td><td>array of local niobufs pointing to the buffers with data</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number of failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00323">323</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="linux-time_8h_source.html#l00152">cfs_time_current()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00295">kmem_to_page()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="obd_8h_source.html#l00440">niobuf_local::lnb_data</a>, <a class="el" href="obd_8h_source.html#l00434">niobuf_local::lnb_file_offset</a>, <a class="el" href="obd_8h_source.html#l00436">niobuf_local::lnb_len</a>, <a class="el" href="obd_8h_source.html#l00439">niobuf_local::lnb_page</a>, <a class="el" href="obd_8h_source.html#l00435">niobuf_local::lnb_page_offset</a>, <a class="el" href="obd_8h_source.html#l00438">niobuf_local::lnb_rc</a>, <a class="el" href="osc__internal_8h_source.html#l00177">min_t</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00296">osd_device::od_zerocopy_pin</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00116">osd_object::oo_dt</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00257">osd_bufs_put()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00884">osd_obj2dev()</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00069">osd_zerocopy_tag</a>, <a class="el" href="parallel__grouplock_8c_source.html#l00067">READ</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00091">record_end_io()</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00072">record_start_io()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="rename__many_8c_source.html#l00057">start</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00511">osd_bufs_get()</a>.</p>

</div>
</div>
<a class="anchor" id="afa703894a6b6c00ee4e1a0706cc0f340"></a><!-- doxytag: member="osd_io.c::osd_bufs_get_write" ref="afa703894a6b6c00ee4e1a0706cc0f340" args="(const struct lu_env *env, struct osd_object *obj, loff_t off, ssize_t len, struct niobuf_local *lnb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osd_bufs_get_write </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosd__object.html">osd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">loff_t&nbsp;</td>
          <td class="paramname"> <em>off</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ssize_t&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *&nbsp;</td>
          <td class="paramname"> <em>lnb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00407">407</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00295">kmem_to_page()</a>, <a class="el" href="lu__object_8h_source.html#l00409">lu_attr::la_size</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="obd_8h_source.html#l00440">niobuf_local::lnb_data</a>, <a class="el" href="obd_8h_source.html#l00434">niobuf_local::lnb_file_offset</a>, <a class="el" href="obd_8h_source.html#l00436">niobuf_local::lnb_len</a>, <a class="el" href="obd_8h_source.html#l00439">niobuf_local::lnb_page</a>, <a class="el" href="obd_8h_source.html#l00435">niobuf_local::lnb_page_offset</a>, <a class="el" href="obd_8h_source.html#l00438">niobuf_local::lnb_rc</a>, <a class="el" href="lprocfs__status_8h_source.html#l00866">lprocfs_counter_add()</a>, <a class="el" href="osc__internal_8h_source.html#l00177">min_t</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00261">osd_device::od_stats</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00294">osd_device::od_zerocopy_alloc</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00295">osd_device::od_zerocopy_loan</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00336">osd_object::oo_attr</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00116">osd_object::oo_dt</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00257">osd_bufs_put()</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00084">OSD_GFP_IO</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00884">osd_obj2dev()</a>, <a class="el" href="lustre__net_8h_source.html#l00105">PTLRPC_MAX_BRW_PAGES</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00511">osd_bufs_get()</a>.</p>

</div>
</div>
<a class="anchor" id="a057ac69ff5a816adf69ddcc93e742e77"></a><!-- doxytag: member="osd_io.c::osd_bufs_put" ref="a057ac69ff5a816adf69ddcc93e742e77" args="(const struct lu_env *env, struct dt_object *dt, struct niobuf_local *lnb, int npages)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osd_bufs_put </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *&nbsp;</td>
          <td class="paramname"> <em>lnb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>npages</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00257">257</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01790">dt_object_exists()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="obd_8h_source.html#l00440">niobuf_local::lnb_data</a>, <a class="el" href="obd_8h_source.html#l00439">niobuf_local::lnb_page</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00294">osd_device::od_zerocopy_alloc</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00295">osd_device::od_zerocopy_loan</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00296">osd_device::od_zerocopy_pin</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00905">osd_dt_obj()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00884">osd_obj2dev()</a>, and <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00069">osd_zerocopy_tag</a>.</p>

<p>Referenced by <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00323">osd_bufs_get_read()</a>, and <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00407">osd_bufs_get_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a55b1901cc3b21b3f9f7d9941b3d9000f"></a><!-- doxytag: member="osd_io.c::osd_declare_punch" ref="a55b1901cc3b21b3f9f7d9941b3d9000f" args="(const struct lu_env *env, struct dt_object *dt, __u64 start, __u64 end, struct thandle *handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osd_declare_punch </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>handle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00876">876</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__object_8h_source.html#l00423">lu_attr::la_gid</a>, <a class="el" href="lu__object_8h_source.html#l00409">lu_attr::la_size</a>, <a class="el" href="lu__object_8h_source.html#l00421">lu_attr::la_uid</a>, <a class="el" href="lustre__idl_8h_source.html#l01767">OBD_OBJECT_EOF</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00336">osd_object::oo_attr</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00335">osd_object::oo_attr_lock</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00320">osd_object::oo_sa_hdl</a>, <a class="el" href="osd-zfs_2osd__quota_8c_source.html#l00482">osd_declare_quota()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00905">osd_dt_obj()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00884">osd_obj2dev()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00350">osd_thandle::ot_super</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00211">osd_thandle::ot_tx</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

</div>
</div>
<a class="anchor" id="a464c0d805bd424fc8b6952a62a8e62ea"></a><!-- doxytag: member="osd_io.c::osd_declare_write" ref="a464c0d805bd424fc8b6952a62a8e62ea" args="(const struct lu_env *env, struct dt_object *dt, const struct lu_buf *buf, loff_t pos, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static ssize_t osd_declare_write </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">loff_t&nbsp;</td>
          <td class="paramname"> <em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00154">154</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01790">dt_object_exists()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__object_8h_source.html#l00423">lu_attr::la_gid</a>, <a class="el" href="lu__object_8h_source.html#l00409">lu_attr::la_size</a>, <a class="el" href="lu__object_8h_source.html#l00421">lu_attr::la_uid</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="lustre__idl_8h_source.html#l03300">LLOG_MIN_CHUNK_SIZE</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00336">osd_object::oo_attr</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00320">osd_object::oo_sa_hdl</a>, <a class="el" href="osd-zfs_2osd__quota_8c_source.html#l00482">osd_declare_quota()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00905">osd_dt_obj()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00884">osd_obj2dev()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00350">osd_thandle::ot_super</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00211">osd_thandle::ot_tx</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

</div>
</div>
<a class="anchor" id="ae9871a19e0a7cc422881eabe3ac15f85"></a><!-- doxytag: member="osd_io.c::osd_declare_write_commit" ref="ae9871a19e0a7cc422881eabe3ac15f85" args="(const struct lu_env *env, struct dt_object *dt, struct niobuf_local *lnb, int npages, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osd_declare_write_commit </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *&nbsp;</td>
          <td class="paramname"> <em>lnb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>npages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00567">567</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00155">D_QUOTA</a>, <a class="el" href="dt__object_8h_source.html#l01790">dt_object_exists()</a>, <a class="el" href="dt__object_8h_source.html#l02465">dt_sync()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__object_8h_source.html#l00423">lu_attr::la_gid</a>, <a class="el" href="lu__object_8h_source.html#l00421">lu_attr::la_uid</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="obd_8h_source.html#l00434">niobuf_local::lnb_file_offset</a>, <a class="el" href="obd_8h_source.html#l00437">niobuf_local::lnb_flags</a>, <a class="el" href="obd_8h_source.html#l00436">niobuf_local::lnb_len</a>, <a class="el" href="obd_8h_source.html#l00439">niobuf_local::lnb_page</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00046">LPD64</a>, <a class="el" href="lustre__idl_8h_source.html#l01753">OBD_BRW_FROM_GRANT</a>, <a class="el" href="lustre__idl_8h_source.html#l01756">OBD_BRW_NOQUOTA</a>, <a class="el" href="lustre__idl_8h_source.html#l01761">OBD_BRW_OVER_GRPQUOTA</a>, <a class="el" href="lustre__idl_8h_source.html#l01760">OBD_BRW_OVER_USRQUOTA</a>, <a class="el" href="lustre__idl_8h_source.html#l01749">OBD_BRW_SYNC</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00250">osd_device::od_os</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00336">osd_object::oo_attr</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00320">osd_object::oo_sa_hdl</a>, <a class="el" href="osd-zfs_2osd__quota_8c_source.html#l00482">osd_declare_quota()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00905">osd_dt_obj()</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00540">osd_get_blocksz()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00884">osd_obj2dev()</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00551">osd_roundup2blocksz()</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00211">osd_thandle::ot_tx</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00213">osd_thandle::ot_write_commit</a>, <a class="el" href="lustre__quota_8h_source.html#l00224">QUOTA_FL_OVER_GRPQUOTA</a>, <a class="el" href="lustre__quota_8h_source.html#l00223">QUOTA_FL_OVER_USRQUOTA</a>, <a class="el" href="lustre__quota_8h_source.html#l00225">QUOTA_FL_SYNC</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00072">record_start_io()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="cascading__rw_8c_source.html#l00061">size</a>, <a class="el" href="dt__object_8h_source.html#l01828">thandle::th_dev</a>, <a class="el" href="lustre__idl_8h_source.html#l01840">toqb</a>, and <a class="el" href="parallel__grouplock_8c_source.html#l00068">WRITE</a>.</p>

</div>
</div>
<a class="anchor" id="a605b995b992c0c08051a3c6f88b1c166"></a><!-- doxytag: member="osd_io.c::osd_get_blocksz" ref="a605b995b992c0c08051a3c6f88b1c166" args="(struct osd_object *obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint32_t osd_get_blocksz </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosd__object.html">osd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00540">540</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, and <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>.</p>

<p>Referenced by <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00567">osd_declare_write_commit()</a>.</p>

</div>
</div>
<a class="anchor" id="abca1fa8fce517b1904f43b61d8cdc8c1"></a><!-- doxytag: member="osd_io.c::osd_ladvise" ref="abca1fa8fce517b1904f43b61d8cdc8c1" args="(const struct lu_env *env, struct dt_object *dt, __u64 start, __u64 end, enum lu_ladvise_type advice)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osd_ladvise </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__lustreuser.html#ga6800d248c7e9177fa2705d90cb97c86f">lu_ladvise_type</a>&nbsp;</td>
          <td class="paramname"> <em>advice</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00909">909</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

</div>
</div>
<a class="anchor" id="a204b0ba7a7684d6b5bc94b8035b8ded1"></a><!-- doxytag: member="osd_io.c::osd_punch" ref="a204b0ba7a7684d6b5bc94b8035b8ded1" args="(const struct lu_env *env, struct dt_object *dt, __u64 start, __u64 end, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osd_punch </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00839">839</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00819">__osd_object_punch()</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="dt__object_8h_source.html#l01790">dt_object_exists()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__object_8h_source.html#l00409">lu_attr::la_size</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__idl_8h_source.html#l01767">OBD_OBJECT_EOF</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00250">osd_device::od_os</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00336">osd_object::oo_attr</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00335">osd_object::oo_attr_lock</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00905">osd_dt_obj()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00840">osd_invariant</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00884">osd_obj2dev()</a>, <a class="el" href="osd__object_8c_source.html#l00151">osd_object_sa_update()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00350">osd_thandle::ot_super</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00211">osd_thandle::ot_tx</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

</div>
</div>
<a class="anchor" id="a94d82327de57e54cb0319881c2aa1a3f"></a><!-- doxytag: member="osd_io.c::osd_read" ref="a94d82327de57e54cb0319881c2aa1a3f" args="(const struct lu_env *env, struct dt_object *dt, struct lu_buf *buf, loff_t *pos)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static ssize_t osd_read </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">loff_t *&nbsp;</td>
          <td class="paramname"> <em>pos</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00114">114</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="linux-time_8h_source.html#l00152">cfs_time_current()</a>, <a class="el" href="dt__object_8h_source.html#l01790">dt_object_exists()</a>, <a class="el" href="lu__object_8h_source.html#l00409">lu_attr::la_size</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00250">osd_device::od_os</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00336">osd_object::oo_attr</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00335">osd_object::oo_attr_lock</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00905">osd_dt_obj()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00884">osd_obj2dev()</a>, <a class="el" href="parallel__grouplock_8c_source.html#l00067">READ</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00091">record_end_io()</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00072">record_start_io()</a>, <a class="el" href="cascading__rw_8c_source.html#l00061">size</a>, and <a class="el" href="rename__many_8c_source.html#l00057">start</a>.</p>

</div>
</div>
<a class="anchor" id="af4eba136432708c300e62184245f85f6"></a><!-- doxytag: member="osd_io.c::osd_read_prep" ref="af4eba136432708c300e62184245f85f6" args="(const struct lu_env *env, struct dt_object *dt, struct niobuf_local *lnb, int npages)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osd_read_prep </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *&nbsp;</td>
          <td class="paramname"> <em>lnb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>npages</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00769">769</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01790">dt_object_exists()</a>, <a class="el" href="lu__object_8h_source.html#l00409">lu_attr::la_size</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="obd_8h_source.html#l00434">niobuf_local::lnb_file_offset</a>, <a class="el" href="obd_8h_source.html#l00436">niobuf_local::lnb_len</a>, <a class="el" href="obd_8h_source.html#l00438">niobuf_local::lnb_rc</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00336">osd_object::oo_attr</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00335">osd_object::oo_attr_lock</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00905">osd_dt_obj()</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="ababb227c9b46cbe517d5de9851382c63"></a><!-- doxytag: member="osd_io.c::osd_roundup2blocksz" ref="ababb227c9b46cbe517d5de9851382c63" args="(uint64_t size, uint64_t offset, uint32_t blksz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint64_t osd_roundup2blocksz </td>
          <td>(</td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>blksz</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00551">551</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, and <a class="el" href="libcfs__private_8h_source.html#l00309">likely</a>.</p>

<p>Referenced by <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00567">osd_declare_write_commit()</a>.</p>

</div>
</div>
<a class="anchor" id="a36b457805e2e1352ed7fa33f6fbd2fcc"></a><!-- doxytag: member="osd_io.c::osd_write" ref="a36b457805e2e1352ed7fa33f6fbd2fcc" args="(const struct lu_env *env, struct dt_object *dt, const struct lu_buf *buf, loff_t *pos, struct thandle *th, int ignore_quota)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static ssize_t osd_write </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">loff_t *&nbsp;</td>
          <td class="paramname"> <em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ignore_quota</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00200">200</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01790">dt_object_exists()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00409">lu_attr::la_size</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00250">osd_device::od_os</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00336">osd_object::oo_attr</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00335">osd_object::oo_attr_lock</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00905">osd_dt_obj()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00884">osd_obj2dev()</a>, <a class="el" href="osd__object_8c_source.html#l00151">osd_object_sa_update()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00350">osd_thandle::ot_super</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00211">osd_thandle::ot_tx</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00091">record_end_io()</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00072">record_start_io()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>, and <a class="el" href="parallel__grouplock_8c_source.html#l00068">WRITE</a>.</p>

</div>
</div>
<a class="anchor" id="a505e1aa2607cb07ddbb53ba66cddc4f0"></a><!-- doxytag: member="osd_io.c::osd_write_commit" ref="a505e1aa2607cb07ddbb53ba66cddc4f0" args="(const struct lu_env *env, struct dt_object *dt, struct niobuf_local *lnb, int npages, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osd_write_commit </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *&nbsp;</td>
          <td class="paramname"> <em>lnb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>npages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00685">685</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="dt__object_8h_source.html#l01790">dt_object_exists()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lu__object_8h_source.html#l00409">lu_attr::la_size</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="obd_8h_source.html#l00440">niobuf_local::lnb_data</a>, <a class="el" href="obd_8h_source.html#l00434">niobuf_local::lnb_file_offset</a>, <a class="el" href="obd_8h_source.html#l00436">niobuf_local::lnb_len</a>, <a class="el" href="obd_8h_source.html#l00438">niobuf_local::lnb_rc</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00250">osd_device::od_os</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00295">osd_device::od_zerocopy_loan</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00336">osd_object::oo_attr</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00335">osd_object::oo_attr_lock</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00905">osd_dt_obj()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00884">osd_obj2dev()</a>, <a class="el" href="osd__object_8c_source.html#l00151">osd_object_sa_update()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00350">osd_thandle::ot_super</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00211">osd_thandle::ot_tx</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00091">record_end_io()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="dt__object_8h_source.html#l01848">thandle::th_local</a>, <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>, and <a class="el" href="parallel__grouplock_8c_source.html#l00068">WRITE</a>.</p>

</div>
</div>
<a class="anchor" id="a5b3cff7912d7a563750c9fb53eb5c748"></a><!-- doxytag: member="osd_io.c::osd_write_prep" ref="a5b3cff7912d7a563750c9fb53eb5c748" args="(const struct lu_env *env, struct dt_object *dt, struct niobuf_local *lnb, int npages)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osd_write_prep </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *&nbsp;</td>
          <td class="paramname"> <em>lnb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>npages</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00529">529</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01790">dt_object_exists()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="osd-zfs_2osd__internal_8h_source.html#l00319">osd_object::oo_db</a>, and <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00905">osd_dt_obj()</a>.</p>

</div>
</div>
<a class="anchor" id="aec3f659aa5595059e33e11687b73a0b4"></a><!-- doxytag: member="osd_io.c::record_end_io" ref="aec3f659aa5595059e33e11687b73a0b4" args="(struct osd_device *osd, int rw, unsigned long elapsed, int disksize, int npages)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void record_end_io </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosd__device.html">osd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>elapsed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>disksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>npages</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00091">91</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="lprocfs__status_8h_source.html#l00081">BRW_R_DISK_IOSIZE</a>, <a class="el" href="lprocfs__status_8h_source.html#l00075">BRW_R_IO_TIME</a>, <a class="el" href="lprocfs__status_8h_source.html#l00071">BRW_R_PAGES</a>, <a class="el" href="lprocfs__status_8h_source.html#l00082">BRW_W_DISK_IOSIZE</a>, <a class="el" href="lprocfs__status_8h_source.html#l00076">BRW_W_IO_TIME</a>, <a class="el" href="lprocfs__status_8h_source.html#l00072">BRW_W_PAGES</a>, <a class="el" href="lprocfs__status_8h_source.html#l00089">brw_stats::hist</a>, <a class="el" href="lprocfs__status_8h_source.html#l01034">lprocfs_oh_tally_log2()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00275">osd_device::od_brw_stats</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00276">osd_device::od_r_in_flight</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00277">osd_device::od_w_in_flight</a>, and <a class="el" href="parallel__grouplock_8c_source.html#l00067">READ</a>.</p>

<p>Referenced by <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00323">osd_bufs_get_read()</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00114">osd_read()</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00200">osd_write()</a>, and <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00685">osd_write_commit()</a>.</p>

</div>
</div>
<a class="anchor" id="a4fef44f696cf6c99f1f4969e72e1b110"></a><!-- doxytag: member="osd_io.c::record_start_io" ref="a4fef44f696cf6c99f1f4969e72e1b110" args="(struct osd_device *osd, int rw, int discont_pages)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void record_start_io </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosd__device.html">osd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>discont_pages</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00072">72</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>References <a class="el" href="lprocfs__status_8h_source.html#l00077">BRW_R_DISCONT_PAGES</a>, <a class="el" href="lprocfs__status_8h_source.html#l00073">BRW_R_RPC_HIST</a>, <a class="el" href="lprocfs__status_8h_source.html#l00078">BRW_W_DISCONT_PAGES</a>, <a class="el" href="lprocfs__status_8h_source.html#l00074">BRW_W_RPC_HIST</a>, <a class="el" href="lprocfs__status_8h_source.html#l00089">brw_stats::hist</a>, <a class="el" href="lprocfs__status_8h_source.html#l01031">lprocfs_oh_tally()</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00275">osd_device::od_brw_stats</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00276">osd_device::od_r_in_flight</a>, <a class="el" href="osd-ldiskfs_2osd__internal_8h_source.html#l00277">osd_device::od_w_in_flight</a>, and <a class="el" href="parallel__grouplock_8c_source.html#l00067">READ</a>.</p>

<p>Referenced by <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00323">osd_bufs_get_read()</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00567">osd_declare_write_commit()</a>, <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00114">osd_read()</a>, and <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00200">osd_write()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a7209b71cf9559b05a2c6ed9358ac0119"></a><!-- doxytag: member="osd_io.c::osd_body_ops" ref="a7209b71cf9559b05a2c6ed9358ac0119" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdt__body__operations.html">dt_body_operations</a> <a class="el" href="osd__object_8c.html#a7209b71cf9559b05a2c6ed9358ac0119">osd_body_ops</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .dbo_read                       = <a class="code" href="osd-ldiskfs_2osd__io_8c.html#a94d82327de57e54cb0319881c2aa1a3f">osd_read</a>,
        .dbo_declare_write              = <a class="code" href="osd-ldiskfs_2osd__io_8c.html#ab370e3e2ac1571b1ba934d60cc4efc9e">osd_declare_write</a>,
        .dbo_write                      = <a class="code" href="osd-ldiskfs_2osd__io_8c.html#aa8603b268e52b12f8fd6b366bbdfbc58">osd_write</a>,
        .dbo_bufs_get                   = <a class="code" href="osd-ldiskfs_2osd__io_8c.html#a79ceae2f4130992447992c3137bd5023" title="Load and lock pages undergoing IO.">osd_bufs_get</a>,
        .dbo_bufs_put                   = <a class="code" href="osd-ldiskfs_2osd__io_8c.html#a057ac69ff5a816adf69ddcc93e742e77" title="Unlock and release pages loaded by osd_bufs_get().">osd_bufs_put</a>,
        .dbo_write_prep                 = <a class="code" href="osd-ldiskfs_2osd__io_8c.html#a5b3cff7912d7a563750c9fb53eb5c748">osd_write_prep</a>,
        .dbo_declare_write_commit       = <a class="code" href="osd-ldiskfs_2osd__io_8c.html#a0fc7fc80675cbe2a5c4cb416dbfc5b6b">osd_declare_write_commit</a>,
        .dbo_write_commit               = <a class="code" href="osd-ldiskfs_2osd__io_8c.html#aa008d225d86e74c2e16410f054967c0c">osd_write_commit</a>,
        .dbo_read_prep                  = <a class="code" href="osd-ldiskfs_2osd__io_8c.html#af4eba136432708c300e62184245f85f6">osd_read_prep</a>,
        .dbo_declare_punch              = <a class="code" href="osd-ldiskfs_2osd__io_8c.html#ac0f72ac5193e1d3054e530a8ccfa7fd4">osd_declare_punch</a>,
        .dbo_punch                      = <a class="code" href="osd-ldiskfs_2osd__io_8c.html#a204b0ba7a7684d6b5bc94b8035b8ded1">osd_punch</a>,
        .dbo_ladvise                    = <a class="code" href="osd-ldiskfs_2osd__io_8c.html#abca1fa8fce517b1904f43b61d8cdc8c1">osd_ladvise</a>,
}
</pre></div>
<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00924">924</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>Referenced by <a class="el" href="osd__object_8c_source.html#l01126">osd_declare_object_create()</a>, <a class="el" href="osd-ldiskfs_2osd__handler_8c_source.html#l02691">osd_object_create()</a>, <a class="el" href="osd-ldiskfs_2osd__handler_8c_source.html#l03108">osd_object_ea_create()</a>, and <a class="el" href="osd-ldiskfs_2osd__handler_8c_source.html#l00989">osd_object_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="adbb45f70d3374f2bda3fd09973ff0112"></a><!-- doxytag: member="osd_io.c::osd_zerocopy_tag" ref="adbb45f70d3374f2bda3fd09973ff0112" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="osd-zfs_2osd__io_8c.html#adbb45f70d3374f2bda3fd09973ff0112">osd_zerocopy_tag</a> = &quot;zerocopy&quot;<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00069">69</a> of file <a class="el" href="osd-zfs_2osd__io_8c_source.html">osd_io.c</a>.</p>

<p>Referenced by <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00323">osd_bufs_get_read()</a>, and <a class="el" href="osd-zfs_2osd__io_8c_source.html#l00257">osd_bufs_put()</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:49 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
