<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lnet/selftest/selftest.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>lnet/selftest/selftest.h</h1><a href="selftest_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * GPL HEADER START</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> * it under the terms of the GNU General Public License version 2 only,</span>
<a name="l00008"></a>00008 <span class="comment"> * as published by the Free Software Foundation.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * This program is distributed in the hope that it will be useful, but</span>
<a name="l00011"></a>00011 <span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00013"></a>00013 <span class="comment"> * General Public License version 2 for more details (a copy is included</span>
<a name="l00014"></a>00014 <span class="comment"> * in the LICENSE file that accompanied this code).</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> * version 2 along with this program; If not, see</span>
<a name="l00018"></a>00018 <span class="comment"> * http://www.sun.com/software/products/lustre/docs/GPLv2.pdf</span>
<a name="l00019"></a>00019 <span class="comment"> * copy of GPLv2].</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * Please contact Sun Microsystems, Inc., 4150 Network Circle, Santa Clara,</span>
<a name="l00022"></a>00022 <span class="comment"> * CA 95054 USA or visit www.sun.com if you need additional information or</span>
<a name="l00023"></a>00023 <span class="comment"> * have any questions.</span>
<a name="l00024"></a>00024 <span class="comment"> *</span>
<a name="l00025"></a>00025 <span class="comment"> * GPL HEADER END</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 <span class="comment">/*</span>
<a name="l00028"></a>00028 <span class="comment"> * Copyright (c) 2007, 2010, Oracle and/or its affiliates. All rights reserved.</span>
<a name="l00029"></a>00029 <span class="comment"> * Use is subject to license terms.</span>
<a name="l00030"></a>00030 <span class="comment"> *</span>
<a name="l00031"></a>00031 <span class="comment"> * Copyright (c) 2012, 2013, Intel Corporation.</span>
<a name="l00032"></a>00032 <span class="comment"> */</span>
<a name="l00033"></a>00033 <span class="comment">/*</span>
<a name="l00034"></a>00034 <span class="comment"> * This file is part of Lustre, http://www.lustre.org/</span>
<a name="l00035"></a>00035 <span class="comment"> * Lustre is a trademark of Sun Microsystems, Inc.</span>
<a name="l00036"></a>00036 <span class="comment"> *</span>
<a name="l00037"></a>00037 <span class="comment"> * lnet/selftest/selftest.h</span>
<a name="l00038"></a>00038 <span class="comment"> *</span>
<a name="l00039"></a>00039 <span class="comment"> * Author: Isaac Huang &lt;isaac@clusterfs.com&gt;</span>
<a name="l00040"></a>00040 <span class="comment"> */</span>
<a name="l00041"></a>00041 <span class="preprocessor">#ifndef __SELFTEST_SELFTEST_H__</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="preprocessor">#define __SELFTEST_SELFTEST_H__</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00044"></a><a class="code" href="selftest_8h.html#a9a5e1b62daf204ff9055db20a5800156">00044</a> <span class="preprocessor">#define LNET_ONLY</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;<a class="code" href="libcfs_8h.html">libcfs/libcfs.h</a>&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;<a class="code" href="api_8h.html">lnet/api.h</a>&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;<a class="code" href="lib-lnet_8h.html">lnet/lib-lnet.h</a>&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;<a class="code" href="lib-types_8h.html">lnet/lib-types.h</a>&gt;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;<a class="code" href="lnetst_8h.html">lnet/lnetst.h</a>&gt;</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="rpc_8h.html">rpc.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="timer_8h.html">timer.h</a>&quot;</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#ifndef MADE_WITHOUT_COMPROMISE</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="preprocessor">#define MADE_WITHOUT_COMPROMISE</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span>
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="selftest_8h.html#a631334f20d66939a6ac7fa65584f8752">00060</a> <span class="preprocessor">#define SWI_STATE_NEWBORN                  0</span>
<a name="l00061"></a><a class="code" href="selftest_8h.html#a6b37cc8c86718526938974359b7ed101">00061</a> <span class="preprocessor"></span><span class="preprocessor">#define SWI_STATE_REPLY_SUBMITTED          1</span>
<a name="l00062"></a><a class="code" href="selftest_8h.html#a28b89986f681ee27d6d3803dd61761c1">00062</a> <span class="preprocessor"></span><span class="preprocessor">#define SWI_STATE_REPLY_SENT               2</span>
<a name="l00063"></a><a class="code" href="selftest_8h.html#a844554b548f122ad912d89461f2fcfc3">00063</a> <span class="preprocessor"></span><span class="preprocessor">#define SWI_STATE_REQUEST_SUBMITTED        3</span>
<a name="l00064"></a><a class="code" href="selftest_8h.html#a77e6e7c9238f828ebc682e93b31e16d7">00064</a> <span class="preprocessor"></span><span class="preprocessor">#define SWI_STATE_REQUEST_SENT             4</span>
<a name="l00065"></a><a class="code" href="selftest_8h.html#a086714230abe1e7d16753a304ffe8f8d">00065</a> <span class="preprocessor"></span><span class="preprocessor">#define SWI_STATE_REPLY_RECEIVED           5</span>
<a name="l00066"></a><a class="code" href="selftest_8h.html#a981ad58973e9152685e38a242388c107">00066</a> <span class="preprocessor"></span><span class="preprocessor">#define SWI_STATE_BULK_STARTED             6</span>
<a name="l00067"></a><a class="code" href="selftest_8h.html#a686130280cd74621cb3e7f0fe989daa8">00067</a> <span class="preprocessor"></span><span class="preprocessor">#define SWI_STATE_DONE                     10</span>
<a name="l00068"></a>00068 <span class="preprocessor"></span>
<a name="l00069"></a>00069 <span class="comment">/* forward refs */</span>
<a name="l00070"></a>00070 <span class="keyword">struct </span><a class="code" href="structsrpc__service.html">srpc_service</a>;
<a name="l00071"></a>00071 <span class="keyword">struct </span><a class="code" href="structsrpc__service__cd.html">srpc_service_cd</a>;
<a name="l00072"></a>00072 <span class="keyword">struct </span><a class="code" href="structsfw__test__unit.html">sfw_test_unit</a>;
<a name="l00073"></a>00073 <span class="keyword">struct </span><a class="code" href="structsfw__test__instance.html">sfw_test_instance</a>;
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 <span class="comment">/* services below SRPC_FRAMEWORK_SERVICE_MAX_ID are framework</span>
<a name="l00076"></a>00076 <span class="comment"> * services, e.g. create/modify session.</span>
<a name="l00077"></a>00077 <span class="comment"> */</span>
<a name="l00078"></a><a class="code" href="selftest_8h.html#af1d2b9068deed37592599f1cbe2c62ad">00078</a> <span class="preprocessor">#define SRPC_SERVICE_DEBUG              0</span>
<a name="l00079"></a><a class="code" href="selftest_8h.html#a7bcb7d563bc83b529bebb49591fefaef">00079</a> <span class="preprocessor"></span><span class="preprocessor">#define SRPC_SERVICE_MAKE_SESSION       1</span>
<a name="l00080"></a><a class="code" href="selftest_8h.html#a68a7324633f9f375b94792294c40edcd">00080</a> <span class="preprocessor"></span><span class="preprocessor">#define SRPC_SERVICE_REMOVE_SESSION     2</span>
<a name="l00081"></a><a class="code" href="selftest_8h.html#af6c9b9925d4800b931afac8104a46ff2">00081</a> <span class="preprocessor"></span><span class="preprocessor">#define SRPC_SERVICE_BATCH              3</span>
<a name="l00082"></a><a class="code" href="selftest_8h.html#a4a2ea0a869db94e7ccc19e60708ae4b1">00082</a> <span class="preprocessor"></span><span class="preprocessor">#define SRPC_SERVICE_TEST               4</span>
<a name="l00083"></a><a class="code" href="selftest_8h.html#a106770f1b3c351dff0515e101dfe6f43">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define SRPC_SERVICE_QUERY_STAT         5</span>
<a name="l00084"></a><a class="code" href="selftest_8h.html#a2e97b9fdbd7a2e53ce757451ea2c7f8c">00084</a> <span class="preprocessor"></span><span class="preprocessor">#define SRPC_SERVICE_JOIN               6</span>
<a name="l00085"></a><a class="code" href="selftest_8h.html#aaa4826e2715abde7379b102c9a2f5eca">00085</a> <span class="preprocessor"></span><span class="preprocessor">#define SRPC_FRAMEWORK_SERVICE_MAX_ID   10</span>
<a name="l00086"></a>00086 <span class="preprocessor"></span><span class="comment">/* other services start from SRPC_FRAMEWORK_SERVICE_MAX_ID+1 */</span>
<a name="l00087"></a><a class="code" href="selftest_8h.html#a08c6361047dbe478d7125757dc99772b">00087</a> <span class="preprocessor">#define SRPC_SERVICE_BRW                11</span>
<a name="l00088"></a><a class="code" href="selftest_8h.html#a2e288947c2cc2529ff79fb3fe69e6a98">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define SRPC_SERVICE_PING               12</span>
<a name="l00089"></a><a class="code" href="selftest_8h.html#ad9d5929143502ce73e5d26cbe44c7f3a">00089</a> <span class="preprocessor"></span><span class="preprocessor">#define SRPC_SERVICE_MAX_ID             12</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span>
<a name="l00091"></a><a class="code" href="selftest_8h.html#a01dd5c7cbdc50a34f40d751d0799eba3">00091</a> <span class="preprocessor">#define SRPC_REQUEST_PORTAL             50</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span><span class="comment">/* a lazy portal for framework RPC requests */</span>
<a name="l00093"></a><a class="code" href="selftest_8h.html#a942e6a354e36ed16438f5f27b6c4a14b">00093</a> <span class="preprocessor">#define SRPC_FRAMEWORK_REQUEST_PORTAL   51</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span><span class="comment">/* all reply/bulk RDMAs go to this portal */</span>
<a name="l00095"></a><a class="code" href="selftest_8h.html#ad4d6e0085adaf03991f1f86e622d5ef6">00095</a> <span class="preprocessor">#define SRPC_RDMA_PORTAL                52</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span>
<a name="l00097"></a>00097 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="rpc_8h.html#a0280c053b393b459a333168bf9ed81b3">srpc_msg_type_t</a>
<a name="l00098"></a><a class="code" href="selftest_8h.html#a38f7912e64cf8930ff4f1da14302198f">00098</a> <a class="code" href="selftest_8h.html#a38f7912e64cf8930ff4f1da14302198f">srpc_service2request</a> (<span class="keywordtype">int</span> <a class="code" href="o2iblnd__modparams_8c.html#a00f09e31c707a86ebc6b0cf74e934633">service</a>)
<a name="l00099"></a>00099 {
<a name="l00100"></a>00100         <span class="keywordflow">switch</span> (service) {
<a name="l00101"></a>00101         <span class="keywordflow">default</span>:
<a name="l00102"></a>00102                 <a class="code" href="libcfs__private_8h.html#a08eceadb65d1adcf8c198cff27081d5f">LBUG</a> ();
<a name="l00103"></a>00103         <span class="keywordflow">case</span> <a class="code" href="selftest_8h.html#af1d2b9068deed37592599f1cbe2c62ad">SRPC_SERVICE_DEBUG</a>:
<a name="l00104"></a>00104                 <span class="keywordflow">return</span> <a class="code" href="rpc_8h.html#a0280c053b393b459a333168bf9ed81b3ae2fe35e749c1d608f16d2385dd1bc746">SRPC_MSG_DEBUG_REQST</a>;
<a name="l00105"></a>00105 
<a name="l00106"></a>00106         <span class="keywordflow">case</span> <a class="code" href="selftest_8h.html#a7bcb7d563bc83b529bebb49591fefaef">SRPC_SERVICE_MAKE_SESSION</a>:
<a name="l00107"></a>00107                 <span class="keywordflow">return</span> <a class="code" href="rpc_8h.html#a0280c053b393b459a333168bf9ed81b3ab5150dcb22b4f457e92e0b130d9db98c">SRPC_MSG_MKSN_REQST</a>;
<a name="l00108"></a>00108 
<a name="l00109"></a>00109         <span class="keywordflow">case</span> <a class="code" href="selftest_8h.html#a68a7324633f9f375b94792294c40edcd">SRPC_SERVICE_REMOVE_SESSION</a>:
<a name="l00110"></a>00110                 <span class="keywordflow">return</span> <a class="code" href="rpc_8h.html#a0280c053b393b459a333168bf9ed81b3a1d7bde37a5f48622b9d931eacfef0ad0">SRPC_MSG_RMSN_REQST</a>;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112         <span class="keywordflow">case</span> <a class="code" href="selftest_8h.html#af6c9b9925d4800b931afac8104a46ff2">SRPC_SERVICE_BATCH</a>:
<a name="l00113"></a>00113                 <span class="keywordflow">return</span> <a class="code" href="rpc_8h.html#a0280c053b393b459a333168bf9ed81b3a2b0a6d9089298d8a3bafee72970a0e80">SRPC_MSG_BATCH_REQST</a>;
<a name="l00114"></a>00114 
<a name="l00115"></a>00115         <span class="keywordflow">case</span> <a class="code" href="selftest_8h.html#a4a2ea0a869db94e7ccc19e60708ae4b1">SRPC_SERVICE_TEST</a>:
<a name="l00116"></a>00116                 <span class="keywordflow">return</span> <a class="code" href="rpc_8h.html#a0280c053b393b459a333168bf9ed81b3a3e4a9f473709f99352499102f30bf2b0">SRPC_MSG_TEST_REQST</a>;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118         <span class="keywordflow">case</span> <a class="code" href="selftest_8h.html#a106770f1b3c351dff0515e101dfe6f43">SRPC_SERVICE_QUERY_STAT</a>:
<a name="l00119"></a>00119                 <span class="keywordflow">return</span> <a class="code" href="rpc_8h.html#a0280c053b393b459a333168bf9ed81b3a11ca655a960416bb1c6c3f4650669e22">SRPC_MSG_STAT_REQST</a>;
<a name="l00120"></a>00120 
<a name="l00121"></a>00121         <span class="keywordflow">case</span> <a class="code" href="selftest_8h.html#a08c6361047dbe478d7125757dc99772b">SRPC_SERVICE_BRW</a>:
<a name="l00122"></a>00122                 <span class="keywordflow">return</span> <a class="code" href="rpc_8h.html#a0280c053b393b459a333168bf9ed81b3aa7c02219b206a7654d2a7bc57dd4cd8f">SRPC_MSG_BRW_REQST</a>;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124         <span class="keywordflow">case</span> <a class="code" href="selftest_8h.html#a2e288947c2cc2529ff79fb3fe69e6a98">SRPC_SERVICE_PING</a>:
<a name="l00125"></a>00125                 <span class="keywordflow">return</span> <a class="code" href="rpc_8h.html#a0280c053b393b459a333168bf9ed81b3a0ee011ee027ee3a54d8a3ca757c2bc63">SRPC_MSG_PING_REQST</a>;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127         <span class="keywordflow">case</span> <a class="code" href="selftest_8h.html#a2e97b9fdbd7a2e53ce757451ea2c7f8c">SRPC_SERVICE_JOIN</a>:
<a name="l00128"></a>00128                 <span class="keywordflow">return</span> <a class="code" href="rpc_8h.html#a0280c053b393b459a333168bf9ed81b3a1488fc4805e0bb0b3035d8506f3508a2">SRPC_MSG_JOIN_REQST</a>;
<a name="l00129"></a>00129         }
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="rpc_8h.html#a0280c053b393b459a333168bf9ed81b3">srpc_msg_type_t</a>
<a name="l00133"></a><a class="code" href="selftest_8h.html#aec76a80346959a0208874081f366b48a">00133</a> <a class="code" href="selftest_8h.html#aec76a80346959a0208874081f366b48a">srpc_service2reply</a> (<span class="keywordtype">int</span> <a class="code" href="o2iblnd__modparams_8c.html#a00f09e31c707a86ebc6b0cf74e934633">service</a>)
<a name="l00134"></a>00134 {
<a name="l00135"></a>00135         <span class="keywordflow">return</span> <a class="code" href="selftest_8h.html#a38f7912e64cf8930ff4f1da14302198f">srpc_service2request</a>(service) + 1;
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1">00138</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00139"></a><a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1a9f8b0fa126faefc93357227926714909">00139</a>         <a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1a9f8b0fa126faefc93357227926714909">SRPC_BULK_REQ_RCVD</a>   = 1, <span class="comment">/* passive bulk request(PUT sink/GET source) received */</span>
<a name="l00140"></a><a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1a5af4134da3fff49c09ba20898ad3e08e">00140</a>         <a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1a5af4134da3fff49c09ba20898ad3e08e">SRPC_BULK_PUT_SENT</a>   = 2, <span class="comment">/* active bulk PUT sent (source) */</span>
<a name="l00141"></a><a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1a2137bb7048ce52a64416ccf3c8bfafec">00141</a>         <a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1a2137bb7048ce52a64416ccf3c8bfafec">SRPC_BULK_GET_RPLD</a>   = 3, <span class="comment">/* active bulk GET replied (sink) */</span>
<a name="l00142"></a><a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1a972296d516aa1004aa647c7bd5d0d886">00142</a>         <a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1a972296d516aa1004aa647c7bd5d0d886">SRPC_REPLY_RCVD</a>      = 4, <span class="comment">/* incoming reply received */</span>
<a name="l00143"></a><a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1af8e0dc4b9cc6473b621479b022b8fa68">00143</a>         <a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1af8e0dc4b9cc6473b621479b022b8fa68">SRPC_REPLY_SENT</a>      = 5, <span class="comment">/* outgoing reply sent */</span>
<a name="l00144"></a><a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1a9e7676128df14b1fded14d79ffa53220">00144</a>         <a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1a9e7676128df14b1fded14d79ffa53220">SRPC_REQUEST_RCVD</a>    = 6, <span class="comment">/* incoming request received */</span>
<a name="l00145"></a><a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1a4058374aad874a77e90ebe746cf205e0">00145</a>         <a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1a4058374aad874a77e90ebe746cf205e0">SRPC_REQUEST_SENT</a>    = 7, <span class="comment">/* outgoing request sent */</span>
<a name="l00146"></a>00146 } <a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1">srpc_event_type_t</a>;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 <span class="comment">/* RPC event */</span>
<a name="l00149"></a><a class="code" href="structsrpc__event__t.html">00149</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00150"></a><a class="code" href="structsrpc__event__t.html#a78f1ef8ea22105f62a2b776ec206ae29">00150</a>         <a class="code" href="selftest_8h.html#aa8005fa78806874c79b8e7c5258247c1">srpc_event_type_t</a> ev_type;   <span class="comment">/* what&apos;s up */</span>
<a name="l00151"></a><a class="code" href="structsrpc__event__t.html#a2738cfa8d7a8f8b0e98f7330dc07a24d">00151</a>         <a class="code" href="group__lnet__eq.html#ga03bee040520d7fabad1b3b661bd7228a" title="Six types of events can be logged in an event queue.">lnet_event_kind_t</a> ev_lnet;   <span class="comment">/* LNet event type */</span>
<a name="l00152"></a><a class="code" href="structsrpc__event__t.html#a2d6e033a334656a15f5b6cde387100d5">00152</a>         <span class="keywordtype">int</span>               ev_fired;  <span class="comment">/* LNet event fired? */</span>
<a name="l00153"></a><a class="code" href="structsrpc__event__t.html#ab522ead054485742f696880759ef0c19">00153</a>         <span class="keywordtype">int</span>               ev_status; <span class="comment">/* LNet event status */</span>
<a name="l00154"></a><a class="code" href="structsrpc__event__t.html#ad698c67de8309dbe415661bdf7423a99">00154</a>         <span class="keywordtype">void</span>             *ev_data;   <span class="comment">/* owning server/client RPC */</span>
<a name="l00155"></a>00155 } <a class="code" href="structsrpc__event__t.html">srpc_event_t</a>;
<a name="l00156"></a>00156 
<a name="l00157"></a><a class="code" href="structsrpc__bulk__t.html">00157</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00158"></a><a class="code" href="structsrpc__bulk__t.html#aac0466414bf857e8448bd7f2643299ec">00158</a>         <span class="keywordtype">int</span>              bk_len;  <span class="comment">/* len of bulk data */</span>
<a name="l00159"></a><a class="code" href="structsrpc__bulk__t.html#af63cc8e2f010211f0fe63eaca64f4dd7">00159</a>         <a class="code" href="structlnet__handle__any__t.html" title="Objects maintained by the LNet are accessed through handles.">lnet_handle_md_t</a> bk_mdh;
<a name="l00160"></a><a class="code" href="structsrpc__bulk__t.html#a92f564c7d4e1c67b29aaf858d28a1efe">00160</a>         <span class="keywordtype">int</span>              bk_sink; <span class="comment">/* sink/source */</span>
<a name="l00161"></a><a class="code" href="structsrpc__bulk__t.html#acdef82b5932daba6b2bdcea95c42cb97">00161</a>         <span class="keywordtype">int</span>              bk_niov; <span class="comment">/* # iov in bk_iovs */</span>
<a name="l00162"></a><a class="code" href="structsrpc__bulk__t.html#a3dfcc76b1ae7f68372538b8366dd9be3">00162</a>         <a class="code" href="structlnet__kiov__t.html" title="A page-based fragment of a MD.">lnet_kiov_t</a>      bk_iovs[0];
<a name="l00163"></a>00163 } <a class="code" href="structsrpc__bulk__t.html">srpc_bulk_t</a>; <span class="comment">/* bulk descriptor */</span>
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 <span class="comment">/* message buffer descriptor */</span>
<a name="l00166"></a><a class="code" href="structsrpc__buffer.html">00166</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsrpc__buffer.html">srpc_buffer</a> {
<a name="l00167"></a><a class="code" href="structsrpc__buffer.html#a894f96cc00c97850781297a0e7260cc2">00167</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsrpc__buffer.html#a894f96cc00c97850781297a0e7260cc2">buf_list</a>; <span class="comment">/* chain on srpc_service::*_msgq */</span>
<a name="l00168"></a><a class="code" href="structsrpc__buffer.html#a9b99a10b6423d9e8036f5edefdadecf6">00168</a>         <a class="code" href="structsrpc__msg.html">srpc_msg_t</a>              <a class="code" href="structsrpc__buffer.html#a9b99a10b6423d9e8036f5edefdadecf6">buf_msg</a>;
<a name="l00169"></a><a class="code" href="structsrpc__buffer.html#afe7635ec47aac94a069c8d1511a47b83">00169</a>         <a class="code" href="structlnet__handle__any__t.html" title="Objects maintained by the LNet are accessed through handles.">lnet_handle_md_t</a>        <a class="code" href="structsrpc__buffer.html#afe7635ec47aac94a069c8d1511a47b83">buf_mdh</a>;
<a name="l00170"></a><a class="code" href="structsrpc__buffer.html#adabe91c965f5275183d48129c178d253">00170</a>         <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a>              <a class="code" href="structsrpc__buffer.html#adabe91c965f5275183d48129c178d253">buf_self</a>;
<a name="l00171"></a><a class="code" href="structsrpc__buffer.html#a76d5abc6e851d4caac464f74508cae18">00171</a>         <a class="code" href="structlnet__process__id__t.html" title="Global process ID.">lnet_process_id_t</a>       <a class="code" href="structsrpc__buffer.html#a76d5abc6e851d4caac464f74508cae18">buf_peer</a>;
<a name="l00172"></a>00172 } <a class="code" href="structsrpc__buffer.html">srpc_buffer_t</a>;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174 <span class="keyword">struct </span><a class="code" href="structswi__workitem.html">swi_workitem</a>;
<a name="l00175"></a><a class="code" href="selftest_8h.html#a91bc5f4284f192c2efad1bd6548eee32">00175</a> <span class="keyword">typedef</span> int (*<a class="code" href="selftest_8h.html#a91bc5f4284f192c2efad1bd6548eee32">swi_action_t</a>) (<span class="keyword">struct </span><a class="code" href="structswi__workitem.html">swi_workitem</a> *);
<a name="l00176"></a>00176 
<a name="l00177"></a><a class="code" href="structswi__workitem.html">00177</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structswi__workitem.html">swi_workitem</a> {
<a name="l00178"></a><a class="code" href="structswi__workitem.html#ab88ebb0fa72008a898772e1e056fdabe">00178</a>         <span class="keyword">struct </span><a class="code" href="structcfs__wi__sched.html">cfs_wi_sched</a>     *<a class="code" href="structswi__workitem.html#ab88ebb0fa72008a898772e1e056fdabe">swi_sched</a>;
<a name="l00179"></a><a class="code" href="structswi__workitem.html#a40f51449b05eab0c535d32e5b61b8d24">00179</a>         <span class="keyword">struct </span><a class="code" href="structcfs__workitem.html">cfs_workitem</a>       <a class="code" href="structswi__workitem.html">swi_workitem</a>;
<a name="l00180"></a><a class="code" href="structswi__workitem.html#a0f578a4d975b15609d429aac4d63cb64">00180</a>         <a class="code" href="selftest_8h.html#a91bc5f4284f192c2efad1bd6548eee32">swi_action_t</a>         <a class="code" href="structswi__workitem.html#a0f578a4d975b15609d429aac4d63cb64">swi_action</a>;
<a name="l00181"></a><a class="code" href="structswi__workitem.html#ac18ae8cef22667df7a9ad09cece1eb81">00181</a>         <span class="keywordtype">int</span>                  <a class="code" href="structswi__workitem.html#ac18ae8cef22667df7a9ad09cece1eb81">swi_state</a>;
<a name="l00182"></a>00182 } <a class="code" href="structswi__workitem.html">swi_workitem_t</a>;
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="comment">/* server-side state of a RPC */</span>
<a name="l00185"></a><a class="code" href="structsrpc__server__rpc.html">00185</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsrpc__server__rpc.html">srpc_server_rpc</a> {
<a name="l00186"></a>00186         <span class="comment">/* chain on srpc_service::*_rpcq */</span>
<a name="l00187"></a><a class="code" href="structsrpc__server__rpc.html#a57489b1f8de04089388ab5b9eda9517e">00187</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsrpc__server__rpc.html#a57489b1f8de04089388ab5b9eda9517e">srpc_list</a>;
<a name="l00188"></a><a class="code" href="structsrpc__server__rpc.html#af5e0c400fc229432bceb2820f317fbd2">00188</a>         <span class="keyword">struct </span><a class="code" href="structsrpc__service__cd.html">srpc_service_cd</a> *<a class="code" href="structsrpc__server__rpc.html#af5e0c400fc229432bceb2820f317fbd2">srpc_scd</a>;
<a name="l00189"></a><a class="code" href="structsrpc__server__rpc.html#adc8e50fcfeca6d7cf132ea392cbe81ec">00189</a>         <a class="code" href="structswi__workitem.html">swi_workitem_t</a>          <a class="code" href="structsrpc__server__rpc.html#adc8e50fcfeca6d7cf132ea392cbe81ec">srpc_wi</a>;
<a name="l00190"></a><a class="code" href="structsrpc__server__rpc.html#aa61b36dccab4e60a3bc5850cb612b6db">00190</a>         <a class="code" href="structsrpc__event__t.html">srpc_event_t</a>            <a class="code" href="structsrpc__server__rpc.html#aa61b36dccab4e60a3bc5850cb612b6db">srpc_ev</a>;        <span class="comment">/* bulk/reply event */</span>
<a name="l00191"></a><a class="code" href="structsrpc__server__rpc.html#a35d613f51335d510b8f0f876d61bc827">00191</a>         <a class="code" href="group__lnet__addr.html#ga0d47ef2c4f1002efbdd050547f80a312" title="Address of an end-point in an LNet network.">lnet_nid_t</a>              <a class="code" href="structsrpc__server__rpc.html#a35d613f51335d510b8f0f876d61bc827">srpc_self</a>;
<a name="l00192"></a><a class="code" href="structsrpc__server__rpc.html#a78d12ab90ebb0293c210da8d69c73968">00192</a>         <a class="code" href="structlnet__process__id__t.html" title="Global process ID.">lnet_process_id_t</a>       <a class="code" href="structsrpc__server__rpc.html#a78d12ab90ebb0293c210da8d69c73968">srpc_peer</a>;
<a name="l00193"></a><a class="code" href="structsrpc__server__rpc.html#a737cc44052b407a095273c3f7cea382b">00193</a>         <a class="code" href="structsrpc__msg.html">srpc_msg_t</a>              <a class="code" href="structsrpc__server__rpc.html#a737cc44052b407a095273c3f7cea382b">srpc_replymsg</a>;
<a name="l00194"></a><a class="code" href="structsrpc__server__rpc.html#a85f254c309508b2958da9e73e054c8e2">00194</a>         <a class="code" href="structlnet__handle__any__t.html" title="Objects maintained by the LNet are accessed through handles.">lnet_handle_md_t</a>        <a class="code" href="structsrpc__server__rpc.html#a85f254c309508b2958da9e73e054c8e2">srpc_replymdh</a>;
<a name="l00195"></a><a class="code" href="structsrpc__server__rpc.html#a7918f16b24ee7f715c01e010575014b9">00195</a>         <a class="code" href="structsrpc__buffer.html">srpc_buffer_t</a>           *<a class="code" href="structsrpc__server__rpc.html#a7918f16b24ee7f715c01e010575014b9">srpc_reqstbuf</a>;
<a name="l00196"></a><a class="code" href="structsrpc__server__rpc.html#ae8056f48443e5208e413a66090b46e39">00196</a>         <a class="code" href="structsrpc__bulk__t.html">srpc_bulk_t</a>             *<a class="code" href="structsrpc__server__rpc.html#ae8056f48443e5208e413a66090b46e39">srpc_bulk</a>;
<a name="l00197"></a>00197 
<a name="l00198"></a><a class="code" href="structsrpc__server__rpc.html#a341bcab1d4052a0603d7770a743c1b4c">00198</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    <a class="code" href="structsrpc__server__rpc.html#a341bcab1d4052a0603d7770a743c1b4c">srpc_aborted</a>; <span class="comment">/* being given up */</span>
<a name="l00199"></a><a class="code" href="structsrpc__server__rpc.html#a8d1236a328bbdcc227ebe18d204c67cc">00199</a>         <span class="keywordtype">int</span>             <a class="code" href="structsrpc__server__rpc.html#a8d1236a328bbdcc227ebe18d204c67cc">srpc_status</a>;
<a name="l00200"></a>00200         void            (*<a class="code" href="structsrpc__server__rpc.html#a4e4a861a82ee9052b246e2fe762669c6">srpc_done</a>)(<span class="keyword">struct </span><a class="code" href="structsrpc__server__rpc.html">srpc_server_rpc</a> *);
<a name="l00201"></a>00201 } <a class="code" href="structsrpc__server__rpc.html">srpc_server_rpc_t</a>;
<a name="l00202"></a>00202 
<a name="l00203"></a>00203 <span class="comment">/* client-side state of a RPC */</span>
<a name="l00204"></a><a class="code" href="structsrpc__client__rpc.html">00204</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc</a> {
<a name="l00205"></a><a class="code" href="structsrpc__client__rpc.html#af4f60ff216fcbdab432ff55fb2b27c87">00205</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsrpc__client__rpc.html#af4f60ff216fcbdab432ff55fb2b27c87">crpc_list</a>;      <span class="comment">/* chain on user&apos;s lists */</span>
<a name="l00206"></a><a class="code" href="structsrpc__client__rpc.html#add80cb371ca9c4691aaaf532e542edaa">00206</a>         spinlock_t              <a class="code" href="structsrpc__client__rpc.html#add80cb371ca9c4691aaaf532e542edaa">crpc_lock</a>;      <span class="comment">/* serialize */</span>
<a name="l00207"></a><a class="code" href="structsrpc__client__rpc.html#a7fe5bfa7a83007cfc3387bf40e2fb0c6">00207</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__client__rpc.html#a7fe5bfa7a83007cfc3387bf40e2fb0c6">crpc_service</a>;
<a name="l00208"></a><a class="code" href="structsrpc__client__rpc.html#a6e381676c4efc5c5ebf5b4a71dec6df1">00208</a>         atomic_t                <a class="code" href="structsrpc__client__rpc.html#a6e381676c4efc5c5ebf5b4a71dec6df1">crpc_refcount</a>;
<a name="l00209"></a>00209         <span class="comment">/* # seconds to wait for reply */</span>
<a name="l00210"></a><a class="code" href="structsrpc__client__rpc.html#a3af82caeac393fb3b91126351934fd3a">00210</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__client__rpc.html#a3af82caeac393fb3b91126351934fd3a">crpc_timeout</a>;
<a name="l00211"></a><a class="code" href="structsrpc__client__rpc.html#addc4c9d87861858e6d03dd06d84d9877">00211</a>         <a class="code" href="structstt__timer__t.html">stt_timer_t</a>             <a class="code" href="structsrpc__client__rpc.html#addc4c9d87861858e6d03dd06d84d9877">crpc_timer</a>;
<a name="l00212"></a><a class="code" href="structsrpc__client__rpc.html#a2a16fa9d0afebf990dabedd17c6d4737">00212</a>         <a class="code" href="structswi__workitem.html">swi_workitem_t</a>          <a class="code" href="structsrpc__client__rpc.html#a2a16fa9d0afebf990dabedd17c6d4737">crpc_wi</a>;
<a name="l00213"></a><a class="code" href="structsrpc__client__rpc.html#a2aad9718781a383be546a1591691b848">00213</a>         <a class="code" href="structlnet__process__id__t.html" title="Global process ID.">lnet_process_id_t</a>       <a class="code" href="structsrpc__client__rpc.html#a2aad9718781a383be546a1591691b848">crpc_dest</a>;
<a name="l00214"></a>00214 
<a name="l00215"></a>00215         void               (*<a class="code" href="structsrpc__client__rpc.html#a2a8346ee65e07860050bbd2bdd226114">crpc_done</a>)(<span class="keyword">struct </span><a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc</a> *);
<a name="l00216"></a>00216         void               (*<a class="code" href="structsrpc__client__rpc.html#a0d6388e5f8892138a664dac04a1fa48d">crpc_fini</a>)(<span class="keyword">struct </span><a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc</a> *);
<a name="l00217"></a><a class="code" href="structsrpc__client__rpc.html#a04db7fc4909b94f181e02dbb3af3f841">00217</a>         <span class="keywordtype">int</span>                  <a class="code" href="structsrpc__client__rpc.html#a04db7fc4909b94f181e02dbb3af3f841">crpc_status</a>;    <span class="comment">/* completion status */</span>
<a name="l00218"></a><a class="code" href="structsrpc__client__rpc.html#ad83b118767ed63eb9d1358e119faec96">00218</a>         <span class="keywordtype">void</span>                *<a class="code" href="structsrpc__client__rpc.html#ad83b118767ed63eb9d1358e119faec96">crpc_priv</a>;      <span class="comment">/* caller data */</span>
<a name="l00219"></a>00219 
<a name="l00220"></a>00220         <span class="comment">/* state flags */</span>
<a name="l00221"></a><a class="code" href="structsrpc__client__rpc.html#a9d3b5a854ea9ecc4079c0985fa473851">00221</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>         <a class="code" href="structsrpc__client__rpc.html#a9d3b5a854ea9ecc4079c0985fa473851">crpc_aborted</a>:1; <span class="comment">/* being given up */</span>
<a name="l00222"></a><a class="code" href="structsrpc__client__rpc.html#adcf7b09f579aca4393858496e47a3197">00222</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>         <a class="code" href="structsrpc__client__rpc.html#adcf7b09f579aca4393858496e47a3197">crpc_closed</a>:1;  <span class="comment">/* completed */</span>
<a name="l00223"></a>00223 
<a name="l00224"></a>00224         <span class="comment">/* RPC events */</span>
<a name="l00225"></a><a class="code" href="structsrpc__client__rpc.html#a531cf1d77d9f1e3320af96a913483e60">00225</a>         <a class="code" href="structsrpc__event__t.html">srpc_event_t</a>         <a class="code" href="structsrpc__client__rpc.html#a531cf1d77d9f1e3320af96a913483e60">crpc_bulkev</a>;    <span class="comment">/* bulk event */</span>
<a name="l00226"></a><a class="code" href="structsrpc__client__rpc.html#a0ba2f43204e9deb42cf7f07bb478b37c">00226</a>         <a class="code" href="structsrpc__event__t.html">srpc_event_t</a>         <a class="code" href="structsrpc__client__rpc.html#a0ba2f43204e9deb42cf7f07bb478b37c">crpc_reqstev</a>;   <span class="comment">/* request event */</span>
<a name="l00227"></a><a class="code" href="structsrpc__client__rpc.html#aa746d064430cfbb82e9b683db02d25cd">00227</a>         <a class="code" href="structsrpc__event__t.html">srpc_event_t</a>         <a class="code" href="structsrpc__client__rpc.html#aa746d064430cfbb82e9b683db02d25cd">crpc_replyev</a>;   <span class="comment">/* reply event */</span>
<a name="l00228"></a>00228 
<a name="l00229"></a>00229         <span class="comment">/* bulk, request(reqst), and reply exchanged on wire */</span>
<a name="l00230"></a><a class="code" href="structsrpc__client__rpc.html#afa1893a803ce69556f38c47f2caa4094">00230</a>         <a class="code" href="structsrpc__msg.html">srpc_msg_t</a>           <a class="code" href="structsrpc__client__rpc.html#afa1893a803ce69556f38c47f2caa4094">crpc_reqstmsg</a>;
<a name="l00231"></a><a class="code" href="structsrpc__client__rpc.html#ad77e224458e1aa971d1e6d3b3f1ab96d">00231</a>         <a class="code" href="structsrpc__msg.html">srpc_msg_t</a>           <a class="code" href="structsrpc__client__rpc.html#ad77e224458e1aa971d1e6d3b3f1ab96d">crpc_replymsg</a>;
<a name="l00232"></a><a class="code" href="structsrpc__client__rpc.html#a3e41cbf98e3fd4b3595b7872e93fe41f">00232</a>         <a class="code" href="structlnet__handle__any__t.html" title="Objects maintained by the LNet are accessed through handles.">lnet_handle_md_t</a>     <a class="code" href="structsrpc__client__rpc.html#a3e41cbf98e3fd4b3595b7872e93fe41f">crpc_reqstmdh</a>;
<a name="l00233"></a><a class="code" href="structsrpc__client__rpc.html#a23afde61bc8a86d57af244e46c9293ff">00233</a>         <a class="code" href="structlnet__handle__any__t.html" title="Objects maintained by the LNet are accessed through handles.">lnet_handle_md_t</a>     <a class="code" href="structsrpc__client__rpc.html#a23afde61bc8a86d57af244e46c9293ff">crpc_replymdh</a>;
<a name="l00234"></a><a class="code" href="structsrpc__client__rpc.html#a4d996605e6a1aac290333de5cc68a56d">00234</a>         <a class="code" href="structsrpc__bulk__t.html">srpc_bulk_t</a>          <a class="code" href="structsrpc__client__rpc.html#a4d996605e6a1aac290333de5cc68a56d">crpc_bulk</a>;
<a name="l00235"></a>00235 } <a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a>;
<a name="l00236"></a>00236 
<a name="l00237"></a><a class="code" href="selftest_8h.html#a9f3608b23bd42e2d695405064ae88aad">00237</a> <span class="preprocessor">#define srpc_client_rpc_size(rpc)                                       \</span>
<a name="l00238"></a>00238 <span class="preprocessor">offsetof(srpc_client_rpc_t, crpc_bulk.bk_iovs[(rpc)-&gt;crpc_bulk.bk_niov])</span>
<a name="l00239"></a>00239 <span class="preprocessor"></span>
<a name="l00240"></a><a class="code" href="selftest_8h.html#a2684630b77ea7377d2cffdc2fb051bdb">00240</a> <span class="preprocessor">#define srpc_client_rpc_addref(rpc)                                     \</span>
<a name="l00241"></a>00241 <span class="preprocessor">do {                                                                    \</span>
<a name="l00242"></a>00242 <span class="preprocessor">        CDEBUG(D_NET, &quot;RPC[%p] -&gt; %s (%d)++\n&quot;,                         \</span>
<a name="l00243"></a>00243 <span class="preprocessor">               (rpc), libcfs_id2str((rpc)-&gt;crpc_dest),                  \</span>
<a name="l00244"></a>00244 <span class="preprocessor">               atomic_read(&amp;(rpc)-&gt;crpc_refcount));                 \</span>
<a name="l00245"></a>00245 <span class="preprocessor">        LASSERT(atomic_read(&amp;(rpc)-&gt;crpc_refcount) &gt; 0);            \</span>
<a name="l00246"></a>00246 <span class="preprocessor">        atomic_inc(&amp;(rpc)-&gt;crpc_refcount);                          \</span>
<a name="l00247"></a>00247 <span class="preprocessor">} while (0)</span>
<a name="l00248"></a>00248 <span class="preprocessor"></span>
<a name="l00249"></a><a class="code" href="selftest_8h.html#a6a04f1bb743ed23510fb06d22d55d7bf">00249</a> <span class="preprocessor">#define srpc_client_rpc_decref(rpc)                                     \</span>
<a name="l00250"></a>00250 <span class="preprocessor">do {                                                                    \</span>
<a name="l00251"></a>00251 <span class="preprocessor">        CDEBUG(D_NET, &quot;RPC[%p] -&gt; %s (%d)--\n&quot;,                         \</span>
<a name="l00252"></a>00252 <span class="preprocessor">               (rpc), libcfs_id2str((rpc)-&gt;crpc_dest),                  \</span>
<a name="l00253"></a>00253 <span class="preprocessor">               atomic_read(&amp;(rpc)-&gt;crpc_refcount));                 \</span>
<a name="l00254"></a>00254 <span class="preprocessor">        LASSERT(atomic_read(&amp;(rpc)-&gt;crpc_refcount) &gt; 0);            \</span>
<a name="l00255"></a>00255 <span class="preprocessor">        if (atomic_dec_and_test(&amp;(rpc)-&gt;crpc_refcount))             \</span>
<a name="l00256"></a>00256 <span class="preprocessor">                srpc_destroy_client_rpc(rpc);                           \</span>
<a name="l00257"></a>00257 <span class="preprocessor">} while (0)</span>
<a name="l00258"></a>00258 <span class="preprocessor"></span>
<a name="l00259"></a><a class="code" href="selftest_8h.html#ab7aa3f808371e6049e43cd52ae4fa2fa">00259</a> <span class="preprocessor">#define srpc_event_pending(rpc)   ((rpc)-&gt;crpc_bulkev.ev_fired == 0 ||  \</span>
<a name="l00260"></a>00260 <span class="preprocessor">                                   (rpc)-&gt;crpc_reqstev.ev_fired == 0 || \</span>
<a name="l00261"></a>00261 <span class="preprocessor">                                   (rpc)-&gt;crpc_replyev.ev_fired == 0)</span>
<a name="l00262"></a>00262 <span class="preprocessor"></span>
<a name="l00263"></a>00263 <span class="comment">/* CPU partition data of srpc service */</span>
<a name="l00264"></a><a class="code" href="structsrpc__service__cd.html">00264</a> <span class="keyword">struct </span><a class="code" href="structsrpc__service__cd.html">srpc_service_cd</a> {
<a name="l00266"></a><a class="code" href="structsrpc__service__cd.html#a6db0b4aad53dfc1dffc82e5b1aea1bc8">00266</a>         spinlock_t              <a class="code" href="structsrpc__service__cd.html#a6db0b4aad53dfc1dffc82e5b1aea1bc8" title="serialize">scd_lock</a>;
<a name="l00268"></a><a class="code" href="structsrpc__service__cd.html#a67031f3a1bac63fc1462c7986c858640">00268</a>         <span class="keyword">struct </span><a class="code" href="structsrpc__service.html">srpc_service</a>     *<a class="code" href="structsrpc__service__cd.html#a67031f3a1bac63fc1462c7986c858640" title="backref to service">scd_svc</a>;
<a name="l00270"></a><a class="code" href="structsrpc__service__cd.html#a2450cc149b979bca147122183937da6f">00270</a>         <a class="code" href="structsrpc__event__t.html">srpc_event_t</a>            <a class="code" href="structsrpc__service__cd.html#a2450cc149b979bca147122183937da6f" title="event buffer">scd_ev</a>;
<a name="l00272"></a><a class="code" href="structsrpc__service__cd.html#a01f24ff49ec79f0abc22ebe271132cfe">00272</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsrpc__service__cd.html#a01f24ff49ec79f0abc22ebe271132cfe" title="free RPC descriptors">scd_rpc_free</a>;
<a name="l00274"></a><a class="code" href="structsrpc__service__cd.html#ac3b5e6e02021b3862fd0f3c5ecec107a">00274</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsrpc__service__cd.html#ac3b5e6e02021b3862fd0f3c5ecec107a" title="in-flight RPCs">scd_rpc_active</a>;
<a name="l00276"></a><a class="code" href="structsrpc__service__cd.html#af7d180bd0b20bbac35d8df0ee2f4d1c5">00276</a>         <a class="code" href="structswi__workitem.html">swi_workitem_t</a>          <a class="code" href="structsrpc__service__cd.html#af7d180bd0b20bbac35d8df0ee2f4d1c5" title="workitem for posting buffer">scd_buf_wi</a>;
<a name="l00278"></a><a class="code" href="structsrpc__service__cd.html#aa7fe85a63c5990a7b745d76b6a8982ee">00278</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__service__cd.html#aa7fe85a63c5990a7b745d76b6a8982ee" title="CPT id.">scd_cpt</a>;
<a name="l00280"></a><a class="code" href="structsrpc__service__cd.html#a353a924bdb987b18bb6245dc381c94c3">00280</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__service__cd.html#a353a924bdb987b18bb6245dc381c94c3" title="error code for scd_buf_wi">scd_buf_err</a>;
<a name="l00282"></a><a class="code" href="structsrpc__service__cd.html#a2a2ad33cede7f87216830b4f075d6f7c">00282</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>           <a class="code" href="structsrpc__service__cd.html#a2a2ad33cede7f87216830b4f075d6f7c" title="timestamp for scd_buf_err">scd_buf_err_stamp</a>;
<a name="l00284"></a><a class="code" href="structsrpc__service__cd.html#a489bbda77fd3659a9635d8254eac5784">00284</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__service__cd.html#a489bbda77fd3659a9635d8254eac5784" title="total # request buffers">scd_buf_total</a>;
<a name="l00286"></a><a class="code" href="structsrpc__service__cd.html#a235d3782ef336477346dc666bbec6b39">00286</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__service__cd.html#a235d3782ef336477346dc666bbec6b39" title="# posted request buffers">scd_buf_nposted</a>;
<a name="l00288"></a><a class="code" href="structsrpc__service__cd.html#ac3e879b9cedc2a59e3d248fe947ffb91">00288</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__service__cd.html#ac3e879b9cedc2a59e3d248fe947ffb91" title="in progress of buffer posting">scd_buf_posting</a>;
<a name="l00290"></a><a class="code" href="structsrpc__service__cd.html#a1b1ade11fb0fd58dbac5160c9fa8fbe0">00290</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__service__cd.html#a1b1ade11fb0fd58dbac5160c9fa8fbe0" title="allocate more buffers if scd_buf_nposted &amp;lt; scd_buf_low">scd_buf_low</a>;
<a name="l00292"></a><a class="code" href="structsrpc__service__cd.html#a0625db91767a88b361c280afdb7ea884">00292</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__service__cd.html#a0625db91767a88b361c280afdb7ea884" title="increase/decrease some buffers">scd_buf_adjust</a>;
<a name="l00294"></a><a class="code" href="structsrpc__service__cd.html#aa7332eaa3bc96c6338682df5e5154bda">00294</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsrpc__service__cd.html#aa7332eaa3bc96c6338682df5e5154bda" title="posted message buffers">scd_buf_posted</a>;
<a name="l00296"></a><a class="code" href="structsrpc__service__cd.html#a71b58f528fbd68544976e918bf367025">00296</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsrpc__service__cd.html#a71b58f528fbd68544976e918bf367025" title="blocked for RPC descriptor">scd_buf_blocked</a>;
<a name="l00297"></a>00297 };
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 <span class="comment">/* number of server workitems (mini-thread) for testing service */</span>
<a name="l00300"></a><a class="code" href="selftest_8h.html#aae9645fa686179593526de311c488ea2">00300</a> <span class="preprocessor">#define SFW_TEST_WI_MIN         256</span>
<a name="l00301"></a><a class="code" href="selftest_8h.html#aa20cfec1addb36f361d21e9eaf632344">00301</a> <span class="preprocessor"></span><span class="preprocessor">#define SFW_TEST_WI_MAX         2048</span>
<a name="l00302"></a>00302 <span class="preprocessor"></span><span class="comment">/* extra buffers for tolerating buggy peers, or unbalanced number</span>
<a name="l00303"></a>00303 <span class="comment"> * of peers between partitions  */</span>
<a name="l00304"></a><a class="code" href="selftest_8h.html#a32a80a800f63e8a24ec918063315c7e4">00304</a> <span class="preprocessor">#define SFW_TEST_WI_EXTRA       64</span>
<a name="l00305"></a>00305 <span class="preprocessor"></span>
<a name="l00306"></a>00306 <span class="comment">/* number of server workitems (mini-thread) for framework service */</span>
<a name="l00307"></a><a class="code" href="selftest_8h.html#af60295a1c999a2a22f2950d0e4b31e19">00307</a> <span class="preprocessor">#define SFW_FRWK_WI_MIN         16</span>
<a name="l00308"></a><a class="code" href="selftest_8h.html#aee24f91c9b24588f0d733a888e1d4c45">00308</a> <span class="preprocessor"></span><span class="preprocessor">#define SFW_FRWK_WI_MAX         256</span>
<a name="l00309"></a>00309 <span class="preprocessor"></span>
<a name="l00310"></a><a class="code" href="structsrpc__service.html">00310</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsrpc__service.html">srpc_service</a> {
<a name="l00311"></a><a class="code" href="structsrpc__service.html#afd864dcd1906e041add5f4c2cb480e12">00311</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__service.html#afd864dcd1906e041add5f4c2cb480e12">sv_id</a>;          <span class="comment">/* service id */</span>
<a name="l00312"></a><a class="code" href="structsrpc__service.html#a1783e4ecbb7679934644df18dbf3ec36">00312</a>         <span class="keyword">const</span> <span class="keywordtype">char</span>              *<a class="code" href="structsrpc__service.html#a1783e4ecbb7679934644df18dbf3ec36">sv_name</a>;       <span class="comment">/* human readable name */</span>
<a name="l00313"></a><a class="code" href="structsrpc__service.html#a38a45dbedf773ba0d2ea34e4b4f24a30">00313</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__service.html#a38a45dbedf773ba0d2ea34e4b4f24a30">sv_wi_total</a>;    <span class="comment">/* total server workitems */</span>
<a name="l00314"></a><a class="code" href="structsrpc__service.html#ab4972b17cf07c8582347beb6547f6145">00314</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__service.html#ab4972b17cf07c8582347beb6547f6145">sv_shuttingdown</a>;
<a name="l00315"></a><a class="code" href="structsrpc__service.html#aaadacad7d954a7ae8190acfa07f67010">00315</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsrpc__service.html#aaadacad7d954a7ae8190acfa07f67010">sv_ncpts</a>;
<a name="l00316"></a>00316         <span class="comment">/* percpt data for srpc_service */</span>
<a name="l00317"></a><a class="code" href="structsrpc__service.html#a9958637b61c4bd110bbeda7d0c650fc0">00317</a>         <span class="keyword">struct </span><a class="code" href="structsrpc__service__cd.html">srpc_service_cd</a>  **<a class="code" href="structsrpc__service.html#a9958637b61c4bd110bbeda7d0c650fc0">sv_cpt_data</a>;
<a name="l00318"></a>00318         <span class="comment">/* Service callbacks:</span>
<a name="l00319"></a>00319 <span class="comment">         * - sv_handler: process incoming RPC request</span>
<a name="l00320"></a>00320 <span class="comment">         * - sv_bulk_ready: notify bulk data</span>
<a name="l00321"></a>00321 <span class="comment">         */</span>
<a name="l00322"></a>00322         int              (*<a class="code" href="structsrpc__service.html#afe2c3ceba80f53fe4bf4232692ebed6a">sv_handler</a>) (<a class="code" href="structsrpc__server__rpc.html">srpc_server_rpc_t</a> *);
<a name="l00323"></a>00323         int              (*<a class="code" href="structsrpc__service.html#af4a8c89e11495c3857825761c4880097">sv_bulk_ready</a>) (<a class="code" href="structsrpc__server__rpc.html">srpc_server_rpc_t</a> *, int);
<a name="l00324"></a>00324 } <a class="code" href="structsrpc__service.html">srpc_service_t</a>;
<a name="l00325"></a>00325 
<a name="l00326"></a><a class="code" href="structsfw__session__t.html">00326</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00327"></a>00327         <span class="comment">/* chain on fw_zombie_sessions */</span>
<a name="l00328"></a><a class="code" href="structsfw__session__t.html#a2df6eab1ea3f2948a52860aa1d6cb22c">00328</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        sn_list;
<a name="l00329"></a><a class="code" href="structsfw__session__t.html#ae2552a4d9d9ba9903c75f94966690a39">00329</a>         <a class="code" href="structlst__sid__t.html">lst_sid_t</a>               sn_id;          <span class="comment">/* unique identifier */</span>
<a name="l00330"></a>00330         <span class="comment">/* # seconds&apos; inactivity to expire */</span>
<a name="l00331"></a><a class="code" href="structsfw__session__t.html#a797cb24013e3b317d0a6b2d8c74d8756">00331</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            sn_timeout;
<a name="l00332"></a><a class="code" href="structsfw__session__t.html#ab8785b452c48eb049db5a58e9442681b">00332</a>         <span class="keywordtype">int</span>                     sn_timer_active;
<a name="l00333"></a><a class="code" href="structsfw__session__t.html#af6fcb27dae8feab8a4ff0fcab3112d68">00333</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            sn_features;
<a name="l00334"></a><a class="code" href="structsfw__session__t.html#ad1684709985bec6963df73f5c859939d">00334</a>         <a class="code" href="structstt__timer__t.html">stt_timer_t</a>             sn_timer;
<a name="l00335"></a><a class="code" href="structsfw__session__t.html#a98cef90a49d718df24b1fc0f4dffa954">00335</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        sn_batches;     <span class="comment">/* list of batches */</span>
<a name="l00336"></a><a class="code" href="structsfw__session__t.html#a35e3c94ef5a65839068ab9ea2284fefc">00336</a>         <span class="keywordtype">char</span>                    sn_name[<a class="code" href="lnetst_8h.html#a9059638ff3278906c91706d190994945">LST_NAME_SIZE</a>];
<a name="l00337"></a><a class="code" href="structsfw__session__t.html#ae6102b6c9ecb59908d9e266363a08524">00337</a>         atomic_t                sn_refcount;
<a name="l00338"></a><a class="code" href="structsfw__session__t.html#ac469ed4fc975802a5a24ee8332decdac">00338</a>         atomic_t                sn_brw_errors;
<a name="l00339"></a><a class="code" href="structsfw__session__t.html#a9be5dd15bb400282b191ecc1627611e8">00339</a>         atomic_t                sn_ping_errors;
<a name="l00340"></a><a class="code" href="structsfw__session__t.html#a212e25f4e9c3e0c4cb4292796f02d32a">00340</a>         <a class="code" href="linux-time_8h.html#a0e81d053bc8d925f6574c760bbea5ac4">cfs_time_t</a>              sn_started;
<a name="l00341"></a>00341 } <a class="code" href="structsfw__session__t.html">sfw_session_t</a>;
<a name="l00342"></a>00342 
<a name="l00343"></a><a class="code" href="selftest_8h.html#ab5e1224f0b822d8a1094726b904def0f">00343</a> <span class="preprocessor">#define sfw_sid_equal(sid0, sid1)     ((sid0).ses_nid == (sid1).ses_nid &amp;&amp; \</span>
<a name="l00344"></a>00344 <span class="preprocessor">                                       (sid0).ses_stamp == (sid1).ses_stamp)</span>
<a name="l00345"></a>00345 <span class="preprocessor"></span>
<a name="l00346"></a><a class="code" href="structsfw__batch__t.html">00346</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00347"></a><a class="code" href="structsfw__batch__t.html#a062d87c9f0bf01377e00d809422c4ed9">00347</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        bat_list;       <span class="comment">/* chain on sn_batches */</span>
<a name="l00348"></a><a class="code" href="structsfw__batch__t.html#abc83dd8cc55d7dc3910c4c8e122970bb">00348</a>         <a class="code" href="structlst__bid__t.html">lst_bid_t</a>               bat_id;         <span class="comment">/* batch id */</span>
<a name="l00349"></a><a class="code" href="structsfw__batch__t.html#a111856dbdae5db84242df77292ff92e5">00349</a>         <span class="keywordtype">int</span>                     bat_error;      <span class="comment">/* error code of batch */</span>
<a name="l00350"></a><a class="code" href="structsfw__batch__t.html#a3eb365c72ddfe13176b2494b517bcd3e">00350</a>         <a class="code" href="structsfw__session__t.html">sfw_session_t</a>           *bat_session;   <span class="comment">/* batch&apos;s session */</span>
<a name="l00351"></a><a class="code" href="structsfw__batch__t.html#a53cb2c040ee236d49d76934265c369bb">00351</a>         atomic_t                bat_nactive;    <span class="comment">/* # of active tests */</span>
<a name="l00352"></a><a class="code" href="structsfw__batch__t.html#a48b5e9ac819d81e24c33f932abe4a1a7">00352</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        bat_tests;      <span class="comment">/* test instances */</span>
<a name="l00353"></a>00353 } <a class="code" href="structsfw__batch__t.html">sfw_batch_t</a>;
<a name="l00354"></a>00354 
<a name="l00355"></a><a class="code" href="structsfw__test__client__ops__t.html">00355</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00356"></a>00356         int  (*tso_init)(<span class="keyword">struct </span><a class="code" href="structsfw__test__instance.html">sfw_test_instance</a> *tsi); <span class="comment">/* intialize test client */</span>
<a name="l00357"></a>00357         void (*tso_fini)(<span class="keyword">struct </span><a class="code" href="structsfw__test__instance.html">sfw_test_instance</a> *tsi); <span class="comment">/* finalize test client */</span>
<a name="l00358"></a>00358         int  (*tso_prep_rpc)(<span class="keyword">struct </span><a class="code" href="structsfw__test__unit.html">sfw_test_unit</a> *tsu,
<a name="l00359"></a>00359                              <a class="code" href="structlnet__process__id__t.html" title="Global process ID.">lnet_process_id_t</a> dest,
<a name="l00360"></a>00360                              <a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> **rpc);   <span class="comment">/* prep a tests rpc */</span>
<a name="l00361"></a>00361         void (*tso_done_rpc)(<span class="keyword">struct </span><a class="code" href="structsfw__test__unit.html">sfw_test_unit</a> *tsu,
<a name="l00362"></a>00362                              <a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *rpc);    <span class="comment">/* done a test rpc */</span>
<a name="l00363"></a>00363 } <a class="code" href="structsfw__test__client__ops__t.html">sfw_test_client_ops_t</a>;
<a name="l00364"></a>00364 
<a name="l00365"></a><a class="code" href="structsfw__test__instance.html">00365</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsfw__test__instance.html">sfw_test_instance</a> {
<a name="l00366"></a><a class="code" href="structsfw__test__instance.html#af920c9fb6c280e41059d43907b6a8723">00366</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsfw__test__instance.html#af920c9fb6c280e41059d43907b6a8723">tsi_list</a>;       <span class="comment">/* chain on batch */</span>
<a name="l00367"></a><a class="code" href="structsfw__test__instance.html#a90f2f090ce4b1538157ae0b29a5b0695">00367</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsfw__test__instance.html#a90f2f090ce4b1538157ae0b29a5b0695">tsi_service</a>;    <span class="comment">/* test type */</span>
<a name="l00368"></a><a class="code" href="structsfw__test__instance.html#a4e8baa78d7bec6a5ac1bcdeb4fe87e40">00368</a>         <a class="code" href="structsfw__batch__t.html">sfw_batch_t</a>             *<a class="code" href="structsfw__test__instance.html#a4e8baa78d7bec6a5ac1bcdeb4fe87e40">tsi_batch</a>;     <span class="comment">/* batch */</span>
<a name="l00369"></a><a class="code" href="structsfw__test__instance.html#a0e36ce23a0d128c2016cda33423a590c">00369</a>         <a class="code" href="structsfw__test__client__ops__t.html">sfw_test_client_ops_t</a>   *<a class="code" href="structsfw__test__instance.html#a0e36ce23a0d128c2016cda33423a590c">tsi_ops</a>;       <span class="comment">/* test client operations */</span>
<a name="l00370"></a>00370 
<a name="l00371"></a>00371         <span class="comment">/* public parameter for all test units */</span>
<a name="l00372"></a><a class="code" href="structsfw__test__instance.html#ae03e2dd3df0561ce82436bedbb82ad81">00372</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            <a class="code" href="structsfw__test__instance.html#ae03e2dd3df0561ce82436bedbb82ad81">tsi_is_client</a>:1;     <span class="comment">/* is test client */</span>
<a name="l00373"></a><a class="code" href="structsfw__test__instance.html#a6deaccaf01493544d66eb9d3c9def583">00373</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            <a class="code" href="structsfw__test__instance.html#a6deaccaf01493544d66eb9d3c9def583">tsi_stoptsu_onerr</a>:1; <span class="comment">/* stop tsu on error */</span>
<a name="l00374"></a><a class="code" href="structsfw__test__instance.html#a8c4a428718d5688acae77cfcbf6446af">00374</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsfw__test__instance.html#a8c4a428718d5688acae77cfcbf6446af">tsi_concur</a>;          <span class="comment">/* concurrency */</span>
<a name="l00375"></a><a class="code" href="structsfw__test__instance.html#a0b98f903bc5b0ce56227947d43be06f1">00375</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsfw__test__instance.html#a0b98f903bc5b0ce56227947d43be06f1">tsi_loop</a>;            <span class="comment">/* loop count */</span>
<a name="l00376"></a>00376 
<a name="l00377"></a>00377         <span class="comment">/* status of test instance */</span>
<a name="l00378"></a><a class="code" href="structsfw__test__instance.html#a6b8156857fd991120fddd32ecc010138">00378</a>         spinlock_t              <a class="code" href="structsfw__test__instance.html#a6b8156857fd991120fddd32ecc010138">tsi_lock</a>;       <span class="comment">/* serialize */</span>
<a name="l00379"></a><a class="code" href="structsfw__test__instance.html#aba46736ae0a2ed43a8370820dccf6cfa">00379</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            <a class="code" href="structsfw__test__instance.html#aba46736ae0a2ed43a8370820dccf6cfa">tsi_stopping</a>:1; <span class="comment">/* test is stopping */</span>
<a name="l00380"></a><a class="code" href="structsfw__test__instance.html#acb73bb8addb4488211de72d20b669a4f">00380</a>         atomic_t                <a class="code" href="structsfw__test__instance.html#acb73bb8addb4488211de72d20b669a4f">tsi_nactive</a>;    <span class="comment">/* # of active test unit */</span>
<a name="l00381"></a><a class="code" href="structsfw__test__instance.html#a75b8fa1d60218f61153ba4c1f69bbba6">00381</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsfw__test__instance.html#a75b8fa1d60218f61153ba4c1f69bbba6">tsi_units</a>;      <span class="comment">/* test units */</span>
<a name="l00382"></a><a class="code" href="structsfw__test__instance.html#aaafa546f92bf02dd02bb3d0ab2348163">00382</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsfw__test__instance.html#aaafa546f92bf02dd02bb3d0ab2348163">tsi_free_rpcs</a>;  <span class="comment">/* free rpcs */</span>
<a name="l00383"></a><a class="code" href="structsfw__test__instance.html#afa0a892e19d44ce5f4d0ae22d62e8271">00383</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsfw__test__instance.html#afa0a892e19d44ce5f4d0ae22d62e8271">tsi_active_rpcs</a>;<span class="comment">/* active rpcs */</span>
<a name="l00384"></a>00384 
<a name="l00385"></a>00385         <span class="keyword">union </span>{
<a name="l00386"></a><a class="code" href="structsfw__test__instance.html#a0d98b85fa393ce0c488d2000b24eed6c">00386</a>                 test_ping_req_t         <a class="code" href="structsfw__test__instance.html#a0d98b85fa393ce0c488d2000b24eed6c">ping</a>;     <span class="comment">/* ping parameter */</span>
<a name="l00387"></a><a class="code" href="structsfw__test__instance.html#a669a35d92aea654fd875dd1c08858d9c">00387</a>                 test_bulk_req_t         <a class="code" href="structsfw__test__instance.html#a669a35d92aea654fd875dd1c08858d9c">bulk_v0</a>;  <span class="comment">/* bulk parameter */</span>
<a name="l00388"></a><a class="code" href="structsfw__test__instance.html#a538937fb98073f26d338dd1bf12f49ea">00388</a>                 test_bulk_req_v1_t      <a class="code" href="structsfw__test__instance.html#a538937fb98073f26d338dd1bf12f49ea">bulk_v1</a>;  <span class="comment">/* bulk v1 parameter */</span>
<a name="l00389"></a>00389         } <a class="code" href="structsfw__test__instance.html#a500e3d6048edb9c2b991267b3213b1ac">tsi_u</a>;
<a name="l00390"></a>00390 } <a class="code" href="structsfw__test__instance.html">sfw_test_instance_t</a>;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392 <span class="comment">/* XXX: trailing (PAGE_CACHE_SIZE % sizeof(lnet_process_id_t)) bytes at</span>
<a name="l00393"></a>00393 <span class="comment"> * the end of pages are not used */</span>
<a name="l00394"></a><a class="code" href="selftest_8h.html#a4668565eedbf0490c9437b8ea8de67d3">00394</a> <span class="preprocessor">#define SFW_MAX_CONCUR     LST_MAX_CONCUR</span>
<a name="l00395"></a><a class="code" href="selftest_8h.html#a1d460d54c90444256d6a0951d0986d71">00395</a> <span class="preprocessor"></span><span class="preprocessor">#define SFW_ID_PER_PAGE    (PAGE_CACHE_SIZE / sizeof(lnet_process_id_packed_t))</span>
<a name="l00396"></a><a class="code" href="selftest_8h.html#a182f6fb6358f7223a48349d0948a7411">00396</a> <span class="preprocessor"></span><span class="preprocessor">#define SFW_MAX_NDESTS     (LNET_MAX_IOV * SFW_ID_PER_PAGE)</span>
<a name="l00397"></a><a class="code" href="selftest_8h.html#aa356d9385e70fd0df8d5e541d38f30ee">00397</a> <span class="preprocessor"></span><span class="preprocessor">#define sfw_id_pages(n)    (((n) + SFW_ID_PER_PAGE - 1) / SFW_ID_PER_PAGE)</span>
<a name="l00398"></a>00398 <span class="preprocessor"></span>
<a name="l00399"></a><a class="code" href="structsfw__test__unit.html">00399</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsfw__test__unit.html">sfw_test_unit</a> {
<a name="l00400"></a><a class="code" href="structsfw__test__unit.html#a4998ed2281a0efd9437bc4605b739193">00400</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsfw__test__unit.html#a4998ed2281a0efd9437bc4605b739193">tsu_list</a>;       <span class="comment">/* chain on lst_test_instance */</span>
<a name="l00401"></a><a class="code" href="structsfw__test__unit.html#ad93de8b21fc7a2e124a30fbffef8a88a">00401</a>         <a class="code" href="structlnet__process__id__t.html" title="Global process ID.">lnet_process_id_t</a>       <a class="code" href="structsfw__test__unit.html#ad93de8b21fc7a2e124a30fbffef8a88a">tsu_dest</a>;       <span class="comment">/* id of dest node */</span>
<a name="l00402"></a><a class="code" href="structsfw__test__unit.html#ad22c822670481c8982db3448ff80940e">00402</a>         <span class="keywordtype">int</span>                     <a class="code" href="structsfw__test__unit.html#ad22c822670481c8982db3448ff80940e">tsu_loop</a>;       <span class="comment">/* loop count of the test */</span>
<a name="l00403"></a><a class="code" href="structsfw__test__unit.html#afcf8d999d152d999f3e03e5338380161">00403</a>         <a class="code" href="structsfw__test__instance.html">sfw_test_instance_t</a>     *<a class="code" href="structsfw__test__unit.html#afcf8d999d152d999f3e03e5338380161">tsu_instance</a>;  <span class="comment">/* pointer to test instance */</span>
<a name="l00404"></a><a class="code" href="structsfw__test__unit.html#ac128ee4ee02a290846d3c5760833bbd0">00404</a>         <span class="keywordtype">void</span>                    *<a class="code" href="structsfw__test__unit.html#ac128ee4ee02a290846d3c5760833bbd0">tsu_private</a>;   <span class="comment">/* private data */</span>
<a name="l00405"></a><a class="code" href="structsfw__test__unit.html#a9ec59f623fa75a6549d30addf96e7e38">00405</a>         <a class="code" href="structswi__workitem.html">swi_workitem_t</a>          <a class="code" href="structsfw__test__unit.html#a9ec59f623fa75a6549d30addf96e7e38">tsu_worker</a>;     <span class="comment">/* workitem of the test unit */</span>
<a name="l00406"></a>00406 } <a class="code" href="structsfw__test__unit.html">sfw_test_unit_t</a>;
<a name="l00407"></a>00407 
<a name="l00408"></a><a class="code" href="structsfw__test__case.html">00408</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsfw__test__case.html">sfw_test_case</a> {
<a name="l00409"></a><a class="code" href="structsfw__test__case.html#a4f9a514907e90be37c49cb709e7a18fa">00409</a>         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a>        <a class="code" href="structsfw__test__case.html#a4f9a514907e90be37c49cb709e7a18fa">tsc_list</a>;               <span class="comment">/* chain on fw_tests */</span>
<a name="l00410"></a><a class="code" href="structsfw__test__case.html#ab7e9400441cfa46ed2769cf0245e3954">00410</a>         <a class="code" href="structsrpc__service.html">srpc_service_t</a>          *<a class="code" href="structsfw__test__case.html#ab7e9400441cfa46ed2769cf0245e3954">tsc_srv_service</a>;       <span class="comment">/* test service */</span>
<a name="l00411"></a><a class="code" href="structsfw__test__case.html#adc3a4daa9993a5d7651e7515b1045680">00411</a>         <a class="code" href="structsfw__test__client__ops__t.html">sfw_test_client_ops_t</a>   *<a class="code" href="structsfw__test__case.html#adc3a4daa9993a5d7651e7515b1045680">tsc_cli_ops</a>;           <span class="comment">/* ops of test client */</span>
<a name="l00412"></a>00412 } <a class="code" href="structsfw__test__case.html">sfw_test_case_t</a>;
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 <a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *
<a name="l00415"></a>00415 <a class="code" href="framework_8c.html#aeafad525dfa4e30a1ef0e8e974199fa0">sfw_create_rpc</a>(<a class="code" href="structlnet__process__id__t.html" title="Global process ID.">lnet_process_id_t</a> peer, <span class="keywordtype">int</span> <a class="code" href="o2iblnd__modparams_8c.html#a00f09e31c707a86ebc6b0cf74e934633">service</a>,
<a name="l00416"></a>00416                <span class="keywordtype">unsigned</span> features, <span class="keywordtype">int</span> nbulkiov, <span class="keywordtype">int</span> bulklen,
<a name="l00417"></a>00417                <span class="keywordtype">void</span> (*<a class="code" href="parser_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>) (<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *), <span class="keywordtype">void</span> *priv);
<a name="l00418"></a>00418 <span class="keywordtype">int</span> <a class="code" href="framework_8c.html#a6d521c16b9f69bcd936221daf4050360">sfw_create_test_rpc</a>(<a class="code" href="structsfw__test__unit.html">sfw_test_unit_t</a> *tsu,
<a name="l00419"></a>00419                         <a class="code" href="structlnet__process__id__t.html" title="Global process ID.">lnet_process_id_t</a> peer, <span class="keywordtype">unsigned</span> features,
<a name="l00420"></a>00420                         <span class="keywordtype">int</span> nblk, <span class="keywordtype">int</span> blklen, <a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> **rpc);
<a name="l00421"></a>00421 <span class="keywordtype">void</span> <a class="code" href="framework_8c.html#abc912f3766290b331d3846bb2743d385">sfw_abort_rpc</a>(<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *rpc);
<a name="l00422"></a>00422 <span class="keywordtype">void</span> <a class="code" href="framework_8c.html#a728fc350ef4187ac7c2c4e5766c1eb30">sfw_post_rpc</a>(<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *rpc);
<a name="l00423"></a>00423 <span class="keywordtype">void</span> <a class="code" href="selftest_8h.html#a9bbd168522819957729e3e18efc764eb">sfw_client_rpc_done</a>(<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *rpc);
<a name="l00424"></a>00424 <span class="keywordtype">void</span> <a class="code" href="framework_8c.html#a27f719a95d72c6b8bb5e4a46fb7485f2">sfw_unpack_message</a>(<a class="code" href="structsrpc__msg.html">srpc_msg_t</a> *<a class="code" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>);
<a name="l00425"></a>00425 <span class="keywordtype">void</span> <a class="code" href="framework_8c.html#a6a745b1a2b1056d3fc942601f360436a">sfw_free_pages</a>(<a class="code" href="structsrpc__server__rpc.html">srpc_server_rpc_t</a> *rpc);
<a name="l00426"></a>00426 <span class="keywordtype">void</span> <a class="code" href="selftest_8h.html#a401a1ac9fcdc0e369e3311c244ec6218">sfw_add_bulk_page</a>(<a class="code" href="structsrpc__bulk__t.html">srpc_bulk_t</a> *bk, <span class="keyword">struct</span> page *pg, <span class="keywordtype">int</span> i);
<a name="l00427"></a>00427 <span class="keywordtype">int</span> <a class="code" href="framework_8c.html#a1e5facc7c3dff1d2d1696b6bff70768e">sfw_alloc_pages</a>(<a class="code" href="structsrpc__server__rpc.html">srpc_server_rpc_t</a> *rpc, <span class="keywordtype">int</span> cpt, <span class="keywordtype">int</span> npages, <span class="keywordtype">int</span> len,
<a name="l00428"></a>00428                     <span class="keywordtype">int</span> sink);
<a name="l00429"></a>00429 <span class="keywordtype">int</span> <a class="code" href="framework_8c.html#a33df7e52ddd1edbea12b5bb6d1f9399b">sfw_make_session</a> (srpc_mksn_reqst_t *request, srpc_mksn_reply_t *reply);
<a name="l00430"></a>00430 
<a name="l00431"></a>00431 <a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *
<a name="l00432"></a>00432 <a class="code" href="rpc_8c.html#a94789a41481ae98e9d8b985d5aa005af">srpc_create_client_rpc</a>(<a class="code" href="structlnet__process__id__t.html" title="Global process ID.">lnet_process_id_t</a> peer, <span class="keywordtype">int</span> service,
<a name="l00433"></a>00433                        <span class="keywordtype">int</span> nbulkiov, <span class="keywordtype">int</span> bulklen,
<a name="l00434"></a>00434                        <span class="keywordtype">void</span> (*rpc_done)(<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *),
<a name="l00435"></a>00435                        <span class="keywordtype">void</span> (*rpc_fini)(<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *), <span class="keywordtype">void</span> *priv);
<a name="l00436"></a>00436 <span class="keywordtype">void</span> <a class="code" href="rpc_8c.html#a5ecb5055cfd78961a8922419ab0a8d5c">srpc_post_rpc</a>(<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *rpc);
<a name="l00437"></a>00437 <span class="keywordtype">void</span> <a class="code" href="rpc_8c.html#a65b8ea672452f430cc5d7264d87a1d5e">srpc_abort_rpc</a>(<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *rpc, <span class="keywordtype">int</span> why);
<a name="l00438"></a>00438 <span class="keywordtype">void</span> <a class="code" href="rpc_8c.html#a855debeb51bae517fea08536d9eedd57">srpc_free_bulk</a>(<a class="code" href="structsrpc__bulk__t.html">srpc_bulk_t</a> *bk);
<a name="l00439"></a>00439 <a class="code" href="structsrpc__bulk__t.html">srpc_bulk_t</a> *<a class="code" href="rpc_8c.html#ab770981cd2e2f07cf6bf8fd0a8ace177">srpc_alloc_bulk</a>(<span class="keywordtype">int</span> cpt, <span class="keywordtype">unsigned</span> bulk_npg, <span class="keywordtype">unsigned</span> bulk_len,
<a name="l00440"></a>00440                              <span class="keywordtype">int</span> sink);
<a name="l00441"></a>00441 <span class="keywordtype">int</span> <a class="code" href="rpc_8c.html#a7624cd297c26568926a19a9d5ae932c0">srpc_send_rpc</a>(<a class="code" href="structswi__workitem.html">swi_workitem_t</a> *wi);
<a name="l00442"></a>00442 <span class="keywordtype">int</span> <a class="code" href="rpc_8c.html#aac695f56412b001eb5568e0e382ce5f7">srpc_send_reply</a>(<a class="code" href="structsrpc__server__rpc.html">srpc_server_rpc_t</a> *rpc);
<a name="l00443"></a>00443 <span class="keywordtype">int</span> <a class="code" href="rpc_8c.html#a01239fdb5f1b84aa65dab38d54623238">srpc_add_service</a>(<a class="code" href="structsrpc__service.html">srpc_service_t</a> *sv);
<a name="l00444"></a>00444 <span class="keywordtype">int</span> <a class="code" href="rpc_8c.html#a2dfd6433540a9982e805f11c7db1de7d">srpc_remove_service</a>(<a class="code" href="structsrpc__service.html">srpc_service_t</a> *sv);
<a name="l00445"></a>00445 <span class="keywordtype">void</span> <a class="code" href="rpc_8c.html#a3a50ff8d9ad1cfddbd9bd15e8acd3271">srpc_shutdown_service</a>(<a class="code" href="structsrpc__service.html">srpc_service_t</a> *sv);
<a name="l00446"></a>00446 <span class="keywordtype">void</span> <a class="code" href="rpc_8c.html#a7e69572839ecd774a53e88d43c519b4f">srpc_abort_service</a>(<a class="code" href="structsrpc__service.html">srpc_service_t</a> *sv);
<a name="l00447"></a>00447 <span class="keywordtype">int</span> <a class="code" href="rpc_8c.html#a090cdb7736a152a7b5b0276e93c5ee63">srpc_finish_service</a>(<a class="code" href="structsrpc__service.html">srpc_service_t</a> *sv);
<a name="l00448"></a>00448 <span class="keywordtype">int</span> <a class="code" href="rpc_8c.html#a528760404a4928ee997d424d65fb8cca">srpc_service_add_buffers</a>(<a class="code" href="structsrpc__service.html">srpc_service_t</a> *sv, <span class="keywordtype">int</span> nbuffer);
<a name="l00449"></a>00449 <span class="keywordtype">void</span> <a class="code" href="rpc_8c.html#a898ac1a31860e6cfd38f72f966cd4b19">srpc_service_remove_buffers</a>(<a class="code" href="structsrpc__service.html">srpc_service_t</a> *sv, <span class="keywordtype">int</span> nbuffer);
<a name="l00450"></a>00450 <span class="keywordtype">void</span> <a class="code" href="rpc_8c.html#a81f8143b6480decc838888699e9ce2e4">srpc_get_counters</a>(srpc_counters_t *cnt);
<a name="l00451"></a>00451 <span class="keywordtype">void</span> <a class="code" href="rpc_8c.html#a79132c6d54e451cbfa0698e78ee486ea">srpc_set_counters</a>(<span class="keyword">const</span> srpc_counters_t *cnt);
<a name="l00452"></a>00452 
<a name="l00453"></a>00453 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structcfs__wi__sched.html">cfs_wi_sched</a> *<a class="code" href="lnet_2selftest_2module_8c.html#aea28e8a72fb629a5e81f6960af59b3c0">lst_sched_serial</a>;
<a name="l00454"></a>00454 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structcfs__wi__sched.html">cfs_wi_sched</a> **<a class="code" href="lnet_2selftest_2module_8c.html#a0f9c29691f5cb03ef0e13253cf37f619">lst_sched_test</a>;
<a name="l00455"></a>00455 
<a name="l00456"></a>00456 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00457"></a><a class="code" href="selftest_8h.html#ab3fb9b8a2878fb368cfc9551946c8626">00457</a> <a class="code" href="selftest_8h.html#ab3fb9b8a2878fb368cfc9551946c8626">srpc_serv_is_framework</a>(<span class="keyword">struct</span> <a class="code" href="structsrpc__service.html">srpc_service</a> *svc)
<a name="l00458"></a>00458 {
<a name="l00459"></a>00459         <span class="keywordflow">return</span> svc-&gt;<a class="code" href="structsrpc__service.html#afd864dcd1906e041add5f4c2cb480e12">sv_id</a> &lt; <a class="code" href="selftest_8h.html#aaa4826e2715abde7379b102c9a2f5eca">SRPC_FRAMEWORK_SERVICE_MAX_ID</a>;
<a name="l00460"></a>00460 }
<a name="l00461"></a>00461 
<a name="l00462"></a>00462 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00463"></a><a class="code" href="selftest_8h.html#a4926f3cc416643291e457526b532128e">00463</a> <a class="code" href="selftest_8h.html#a4926f3cc416643291e457526b532128e">swi_wi_action</a>(<span class="keyword">struct</span> <a class="code" href="structcfs__workitem.html">cfs_workitem</a> *wi)
<a name="l00464"></a>00464 {
<a name="l00465"></a>00465         <a class="code" href="structswi__workitem.html">swi_workitem_t</a> *swi = container_of(wi, <a class="code" href="structswi__workitem.html">swi_workitem_t</a>, <a class="code" href="structswi__workitem.html">swi_workitem</a>);
<a name="l00466"></a>00466 
<a name="l00467"></a>00467         <span class="keywordflow">return</span> swi-&gt;<a class="code" href="structswi__workitem.html#a0f578a4d975b15609d429aac4d63cb64">swi_action</a>(swi);
<a name="l00468"></a>00468 }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00471"></a><a class="code" href="selftest_8h.html#af61ea43a15a7d1360d0124432a6e493b">00471</a> <a class="code" href="selftest_8h.html#af61ea43a15a7d1360d0124432a6e493b">swi_init_workitem</a>(<a class="code" href="structswi__workitem.html">swi_workitem_t</a> *swi, <span class="keywordtype">void</span> *data,
<a name="l00472"></a>00472                   <a class="code" href="selftest_8h.html#a91bc5f4284f192c2efad1bd6548eee32">swi_action_t</a> action, <span class="keyword">struct</span> <a class="code" href="structcfs__wi__sched.html">cfs_wi_sched</a> *sched)
<a name="l00473"></a>00473 {
<a name="l00474"></a>00474         swi-&gt;<a class="code" href="structswi__workitem.html#ab88ebb0fa72008a898772e1e056fdabe">swi_sched</a>  = sched;
<a name="l00475"></a>00475         swi-&gt;<a class="code" href="structswi__workitem.html#a0f578a4d975b15609d429aac4d63cb64">swi_action</a> = action;
<a name="l00476"></a>00476         swi-&gt;<a class="code" href="structswi__workitem.html#ac18ae8cef22667df7a9ad09cece1eb81">swi_state</a>  = <a class="code" href="selftest_8h.html#a631334f20d66939a6ac7fa65584f8752">SWI_STATE_NEWBORN</a>;
<a name="l00477"></a>00477         <a class="code" href="libcfs__workitem_8h.html#a74441f83117f64e1b6b5bec4ce17ae5e">cfs_wi_init</a>(&amp;swi-&gt;<a class="code" href="structswi__workitem.html#a40f51449b05eab0c535d32e5b61b8d24">swi_workitem</a>, data, <a class="code" href="selftest_8h.html#a4926f3cc416643291e457526b532128e">swi_wi_action</a>);
<a name="l00478"></a>00478 }
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00481"></a><a class="code" href="selftest_8h.html#a88cfdc804c0a6c3b26208a02cebbe329">00481</a> <a class="code" href="selftest_8h.html#a88cfdc804c0a6c3b26208a02cebbe329">swi_schedule_workitem</a>(<a class="code" href="structswi__workitem.html">swi_workitem_t</a> *wi)
<a name="l00482"></a>00482 {
<a name="l00483"></a>00483         <a class="code" href="libcfs__workitem_8h.html#a5f11ca3a1dad84e1382664d82b532b31">cfs_wi_schedule</a>(wi-&gt;<a class="code" href="structswi__workitem.html#ab88ebb0fa72008a898772e1e056fdabe">swi_sched</a>, &amp;wi-&gt;<a class="code" href="structswi__workitem.html#a40f51449b05eab0c535d32e5b61b8d24">swi_workitem</a>);
<a name="l00484"></a>00484 }
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00487"></a><a class="code" href="selftest_8h.html#a6bca56bbf2350e7480b080e96d463d9b">00487</a> <a class="code" href="selftest_8h.html#a6bca56bbf2350e7480b080e96d463d9b">swi_exit_workitem</a>(<a class="code" href="structswi__workitem.html">swi_workitem_t</a> *swi)
<a name="l00488"></a>00488 {
<a name="l00489"></a>00489         <a class="code" href="libcfs__workitem_8h.html#a3c0fd17e31d40d509c328c8b8d79c72e">cfs_wi_exit</a>(swi-&gt;<a class="code" href="structswi__workitem.html#ab88ebb0fa72008a898772e1e056fdabe">swi_sched</a>, &amp;swi-&gt;<a class="code" href="structswi__workitem.html#a40f51449b05eab0c535d32e5b61b8d24">swi_workitem</a>);
<a name="l00490"></a>00490 }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00493"></a><a class="code" href="selftest_8h.html#a0f62c512f1cadf1c6fe7571afa72decc">00493</a> <a class="code" href="selftest_8h.html#a0f62c512f1cadf1c6fe7571afa72decc">swi_deschedule_workitem</a>(<a class="code" href="structswi__workitem.html">swi_workitem_t</a> *swi)
<a name="l00494"></a>00494 {
<a name="l00495"></a>00495         <span class="keywordflow">return</span> <a class="code" href="libcfs__workitem_8h.html#a9db9987406925c1eb85aa9399728c215" title="cancel schedule request of workitem wi ">cfs_wi_deschedule</a>(swi-&gt;<a class="code" href="structswi__workitem.html#ab88ebb0fa72008a898772e1e056fdabe">swi_sched</a>, &amp;swi-&gt;<a class="code" href="structswi__workitem.html#a40f51449b05eab0c535d32e5b61b8d24">swi_workitem</a>);
<a name="l00496"></a>00496 }
<a name="l00497"></a>00497 
<a name="l00498"></a>00498 <span class="keywordtype">int</span> <a class="code" href="framework_8c.html#aca47894a58a99157810b98303428f74d">sfw_startup</a>(<span class="keywordtype">void</span>);
<a name="l00499"></a>00499 <span class="keywordtype">int</span> <a class="code" href="rpc_8c.html#afdc7681da31e6b0608e517dac910f0f4">srpc_startup</a>(<span class="keywordtype">void</span>);
<a name="l00500"></a>00500 <span class="keywordtype">void</span> <a class="code" href="framework_8c.html#a2626c80cd651a53da6fbff3094b0c134">sfw_shutdown</a>(<span class="keywordtype">void</span>);
<a name="l00501"></a>00501 <span class="keywordtype">void</span> <a class="code" href="rpc_8c.html#a673e799975edf189a67df2189300e3de">srpc_shutdown</a>(<span class="keywordtype">void</span>);
<a name="l00502"></a>00502 
<a name="l00503"></a>00503 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00504"></a><a class="code" href="selftest_8h.html#ad3e3dc87b7cf1e44f67e62f7f8e78ef9">00504</a> <a class="code" href="selftest_8h.html#ad3e3dc87b7cf1e44f67e62f7f8e78ef9">srpc_destroy_client_rpc</a> (<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *rpc)
<a name="l00505"></a>00505 {
<a name="l00506"></a>00506         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a> (rpc != NULL);
<a name="l00507"></a>00507         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a> (!<a class="code" href="selftest_8h.html#ab7aa3f808371e6049e43cd52ae4fa2fa">srpc_event_pending</a>(rpc));
<a name="l00508"></a>00508         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a> (atomic_read(&amp;rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a6e381676c4efc5c5ebf5b4a71dec6df1">crpc_refcount</a>) == 0);
<a name="l00509"></a>00509 
<a name="l00510"></a>00510         <span class="keywordflow">if</span> (rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a0d6388e5f8892138a664dac04a1fa48d">crpc_fini</a> == NULL) {
<a name="l00511"></a>00511                 <a class="code" href="libcfs__private_8h.html#a41386bf0bd3a9596cd7161910902f4e7">LIBCFS_FREE</a>(rpc, <a class="code" href="selftest_8h.html#a9f3608b23bd42e2d695405064ae88aad">srpc_client_rpc_size</a>(rpc));
<a name="l00512"></a>00512         } <span class="keywordflow">else</span> {
<a name="l00513"></a>00513                 (*rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a0d6388e5f8892138a664dac04a1fa48d">crpc_fini</a>) (rpc);
<a name="l00514"></a>00514         }
<a name="l00515"></a>00515 
<a name="l00516"></a>00516         <span class="keywordflow">return</span>;
<a name="l00517"></a>00517 }
<a name="l00518"></a>00518 
<a name="l00519"></a>00519 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00520"></a><a class="code" href="selftest_8h.html#ae67adab81708919e8b8dcc89ea0b6220">00520</a> <a class="code" href="selftest_8h.html#ae67adab81708919e8b8dcc89ea0b6220">srpc_init_client_rpc</a>(<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *rpc, <a class="code" href="structlnet__process__id__t.html" title="Global process ID.">lnet_process_id_t</a> peer,
<a name="l00521"></a>00521                      <span class="keywordtype">int</span> service, <span class="keywordtype">int</span> nbulkiov, <span class="keywordtype">int</span> bulklen,
<a name="l00522"></a>00522                      <span class="keywordtype">void</span> (*rpc_done)(<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *),
<a name="l00523"></a>00523                      <span class="keywordtype">void</span> (*rpc_fini)(<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a> *), <span class="keywordtype">void</span> *priv)
<a name="l00524"></a>00524 {
<a name="l00525"></a>00525         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(nbulkiov &lt;= <a class="code" href="group__lnet__md.html#gae5c5481fe02371e7bf253b2b1cf0d030" title="limit on the number of fragments in discontiguous MDs">LNET_MAX_IOV</a>);
<a name="l00526"></a>00526 
<a name="l00527"></a>00527         memset(rpc, 0, <a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(<a class="code" href="structsrpc__client__rpc.html">srpc_client_rpc_t</a>,
<a name="l00528"></a>00528                                 crpc_bulk.bk_iovs[nbulkiov]));
<a name="l00529"></a>00529 
<a name="l00530"></a>00530         <a class="code" href="list_8h.html#a0ffe9d28c36d7b018a9cfae33bae45c0">INIT_LIST_HEAD</a>(&amp;rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#af4f60ff216fcbdab432ff55fb2b27c87">crpc_list</a>);
<a name="l00531"></a>00531         <a class="code" href="selftest_8h.html#af61ea43a15a7d1360d0124432a6e493b">swi_init_workitem</a>(&amp;rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a2a16fa9d0afebf990dabedd17c6d4737">crpc_wi</a>, rpc, <a class="code" href="rpc_8c.html#a7624cd297c26568926a19a9d5ae932c0">srpc_send_rpc</a>,
<a name="l00532"></a>00532                           lst_sched_test[<a class="code" href="lib-lnet_8h.html#a1beb7aca3785eea0587bc0db4ab7052e">lnet_cpt_of_nid</a>(peer.<a class="code" href="structlnet__process__id__t.html#ab0c421c9d4e55b3a45fa62100f20687d" title="node id">nid</a>)]);
<a name="l00533"></a>00533         spin_lock_init(&amp;rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#add80cb371ca9c4691aaaf532e542edaa">crpc_lock</a>);
<a name="l00534"></a>00534         atomic_set(&amp;rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a6e381676c4efc5c5ebf5b4a71dec6df1">crpc_refcount</a>, 1); <span class="comment">/* 1 ref for caller */</span>
<a name="l00535"></a>00535 
<a name="l00536"></a>00536         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a2aad9718781a383be546a1591691b848">crpc_dest</a>         = peer;
<a name="l00537"></a>00537         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#ad83b118767ed63eb9d1358e119faec96">crpc_priv</a>         = priv;
<a name="l00538"></a>00538         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a7fe5bfa7a83007cfc3387bf40e2fb0c6">crpc_service</a>      = service;
<a name="l00539"></a>00539         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a4d996605e6a1aac290333de5cc68a56d">crpc_bulk</a>.<a class="code" href="structsrpc__bulk__t.html#aac0466414bf857e8448bd7f2643299ec">bk_len</a>  = bulklen;
<a name="l00540"></a>00540         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a4d996605e6a1aac290333de5cc68a56d">crpc_bulk</a>.<a class="code" href="structsrpc__bulk__t.html#acdef82b5932daba6b2bdcea95c42cb97">bk_niov</a> = nbulkiov;
<a name="l00541"></a>00541         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a2a8346ee65e07860050bbd2bdd226114">crpc_done</a>         = rpc_done;
<a name="l00542"></a>00542         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a0d6388e5f8892138a664dac04a1fa48d">crpc_fini</a>         = rpc_fini;
<a name="l00543"></a>00543         <a class="code" href="group__lnet__addr.html#gab3d30e46ea269d8b39d4851c3a7c8052" title="Invalidate handle h.">LNetInvalidateHandle</a>(&amp;rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a3e41cbf98e3fd4b3595b7872e93fe41f">crpc_reqstmdh</a>);
<a name="l00544"></a>00544         <a class="code" href="group__lnet__addr.html#gab3d30e46ea269d8b39d4851c3a7c8052" title="Invalidate handle h.">LNetInvalidateHandle</a>(&amp;rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a23afde61bc8a86d57af244e46c9293ff">crpc_replymdh</a>);
<a name="l00545"></a>00545         <a class="code" href="group__lnet__addr.html#gab3d30e46ea269d8b39d4851c3a7c8052" title="Invalidate handle h.">LNetInvalidateHandle</a>(&amp;rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a4d996605e6a1aac290333de5cc68a56d">crpc_bulk</a>.<a class="code" href="structsrpc__bulk__t.html#af63cc8e2f010211f0fe63eaca64f4dd7">bk_mdh</a>);
<a name="l00546"></a>00546 
<a name="l00547"></a>00547         <span class="comment">/* no event is expected at this point */</span>
<a name="l00548"></a>00548         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a531cf1d77d9f1e3320af96a913483e60">crpc_bulkev</a>.<a class="code" href="structsrpc__event__t.html#a2d6e033a334656a15f5b6cde387100d5">ev_fired</a>  =
<a name="l00549"></a>00549         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#a0ba2f43204e9deb42cf7f07bb478b37c">crpc_reqstev</a>.<a class="code" href="structsrpc__event__t.html#a2d6e033a334656a15f5b6cde387100d5">ev_fired</a> =
<a name="l00550"></a>00550         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#aa746d064430cfbb82e9b683db02d25cd">crpc_replyev</a>.<a class="code" href="structsrpc__event__t.html#a2d6e033a334656a15f5b6cde387100d5">ev_fired</a> = 1;
<a name="l00551"></a>00551 
<a name="l00552"></a>00552         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#afa1893a803ce69556f38c47f2caa4094">crpc_reqstmsg</a>.<a class="code" href="structsrpc__msg.html#a6e19bc3729ed00441eb74910836610ff" title="magic number">msg_magic</a>   = <a class="code" href="rpc_8h.html#a1f1d3307d7605f702a02b75b6a3e0408">SRPC_MSG_MAGIC</a>;
<a name="l00553"></a>00553         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#afa1893a803ce69556f38c47f2caa4094">crpc_reqstmsg</a>.<a class="code" href="structsrpc__msg.html#a908c4f62d058a1478431f326b24be5a3" title="message version number">msg_version</a> = <a class="code" href="rpc_8h.html#ac168ed965dc2c8c7df214a7cdf89ee02">SRPC_MSG_VERSION</a>;
<a name="l00554"></a>00554         rpc-&gt;<a class="code" href="structsrpc__client__rpc.html#afa1893a803ce69556f38c47f2caa4094">crpc_reqstmsg</a>.<a class="code" href="structsrpc__msg.html#a671d12977af3f77ec638f20b383630b5" title="type of message body: srpc_msg_type_t">msg_type</a>    = <a class="code" href="selftest_8h.html#a38f7912e64cf8930ff4f1da14302198f">srpc_service2request</a>(service);
<a name="l00555"></a>00555         <span class="keywordflow">return</span>;
<a name="l00556"></a>00556 }
<a name="l00557"></a>00557 
<a name="l00558"></a>00558 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l00559"></a><a class="code" href="selftest_8h.html#a76a31dd846142128ea40fd5db32bc3c3">00559</a> <a class="code" href="selftest_8h.html#a76a31dd846142128ea40fd5db32bc3c3">swi_state2str</a> (<span class="keywordtype">int</span> <a class="code" href="fsx_8c.html#a5797ba50831ee71f60588abd75d2992e">state</a>)
<a name="l00560"></a>00560 {
<a name="l00561"></a>00561 <span class="preprocessor">#define STATE2STR(x) case x: return #x</span>
<a name="l00562"></a>00562 <span class="preprocessor"></span>        <span class="keywordflow">switch</span>(state) {
<a name="l00563"></a>00563                 <span class="keywordflow">default</span>:
<a name="l00564"></a>00564                         <a class="code" href="libcfs__private_8h.html#a08eceadb65d1adcf8c198cff27081d5f">LBUG</a>();
<a name="l00565"></a>00565                 <a class="code" href="selftest_8h.html#a789265dac764a9c31b8fdda5ae911b06">STATE2STR</a>(<a class="code" href="selftest_8h.html#a631334f20d66939a6ac7fa65584f8752">SWI_STATE_NEWBORN</a>);
<a name="l00566"></a>00566                 <a class="code" href="selftest_8h.html#a789265dac764a9c31b8fdda5ae911b06">STATE2STR</a>(<a class="code" href="selftest_8h.html#a6b37cc8c86718526938974359b7ed101">SWI_STATE_REPLY_SUBMITTED</a>);
<a name="l00567"></a>00567                 <a class="code" href="selftest_8h.html#a789265dac764a9c31b8fdda5ae911b06">STATE2STR</a>(<a class="code" href="selftest_8h.html#a28b89986f681ee27d6d3803dd61761c1">SWI_STATE_REPLY_SENT</a>);
<a name="l00568"></a>00568                 <a class="code" href="selftest_8h.html#a789265dac764a9c31b8fdda5ae911b06">STATE2STR</a>(<a class="code" href="selftest_8h.html#a844554b548f122ad912d89461f2fcfc3">SWI_STATE_REQUEST_SUBMITTED</a>);
<a name="l00569"></a>00569                 <a class="code" href="selftest_8h.html#a789265dac764a9c31b8fdda5ae911b06">STATE2STR</a>(<a class="code" href="selftest_8h.html#a77e6e7c9238f828ebc682e93b31e16d7">SWI_STATE_REQUEST_SENT</a>);
<a name="l00570"></a>00570                 <a class="code" href="selftest_8h.html#a789265dac764a9c31b8fdda5ae911b06">STATE2STR</a>(<a class="code" href="selftest_8h.html#a086714230abe1e7d16753a304ffe8f8d">SWI_STATE_REPLY_RECEIVED</a>);
<a name="l00571"></a>00571                 <a class="code" href="selftest_8h.html#a789265dac764a9c31b8fdda5ae911b06">STATE2STR</a>(<a class="code" href="selftest_8h.html#a981ad58973e9152685e38a242388c107">SWI_STATE_BULK_STARTED</a>);
<a name="l00572"></a>00572                 <a class="code" href="selftest_8h.html#a789265dac764a9c31b8fdda5ae911b06">STATE2STR</a>(<a class="code" href="selftest_8h.html#a686130280cd74621cb3e7f0fe989daa8">SWI_STATE_DONE</a>);
<a name="l00573"></a>00573         }
<a name="l00574"></a>00574 <span class="preprocessor">#undef STATE2STR</span>
<a name="l00575"></a>00575 <span class="preprocessor"></span>}
<a name="l00576"></a>00576 
<a name="l00577"></a><a class="code" href="selftest_8h.html#aab7c8ea18802fcc3a172c3b586c01b78">00577</a> <span class="preprocessor">#define lst_wait_until(cond, lock, fmt, ...)                            \</span>
<a name="l00578"></a>00578 <span class="preprocessor">do {                                                                    \</span>
<a name="l00579"></a>00579 <span class="preprocessor">        int __I = 2;                                                    \</span>
<a name="l00580"></a>00580 <span class="preprocessor">        while (!(cond)) {                                               \</span>
<a name="l00581"></a>00581 <span class="preprocessor">                CDEBUG(IS_PO2(++__I) ? D_WARNING : D_NET,               \</span>
<a name="l00582"></a>00582 <span class="preprocessor">                       fmt, ## __VA_ARGS__);                            \</span>
<a name="l00583"></a>00583 <span class="preprocessor">                spin_unlock(&amp;(lock));                                   \</span>
<a name="l00584"></a>00584 <span class="preprocessor">                                                                        \</span>
<a name="l00585"></a>00585 <span class="preprocessor">                set_current_state(TASK_UNINTERRUPTIBLE);                \</span>
<a name="l00586"></a>00586 <span class="preprocessor">                schedule_timeout(cfs_time_seconds(1) / 10);             \</span>
<a name="l00587"></a>00587 <span class="preprocessor">                                                                        \</span>
<a name="l00588"></a>00588 <span class="preprocessor">                spin_lock(&amp;(lock));                                     \</span>
<a name="l00589"></a>00589 <span class="preprocessor">        }                                                               \</span>
<a name="l00590"></a>00590 <span class="preprocessor">} while (0)</span>
<a name="l00591"></a>00591 <span class="preprocessor"></span>
<a name="l00592"></a>00592 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00593"></a><a class="code" href="selftest_8h.html#aabeb0ff45f1e45dcd47a26cbc4cc5a31">00593</a> <a class="code" href="selftest_8h.html#aabeb0ff45f1e45dcd47a26cbc4cc5a31">srpc_wait_service_shutdown</a>(<a class="code" href="structsrpc__service.html">srpc_service_t</a> *sv)
<a name="l00594"></a>00594 {
<a name="l00595"></a>00595         <span class="keywordtype">int</span> i = 2;
<a name="l00596"></a>00596 
<a name="l00597"></a>00597         <a class="code" href="utils_2wirehdr_8c.html#a40eabc293a68a6404ce1de507c99c4b5">LASSERT</a>(sv-&gt;<a class="code" href="structsrpc__service.html#ab4972b17cf07c8582347beb6547f6145">sv_shuttingdown</a>);
<a name="l00598"></a>00598 
<a name="l00599"></a>00599         <span class="keywordflow">while</span> (<a class="code" href="rpc_8c.html#a090cdb7736a152a7b5b0276e93c5ee63">srpc_finish_service</a>(sv) == 0) {
<a name="l00600"></a>00600                 i++;
<a name="l00601"></a>00601                 <a class="code" href="libcfs__debug_8h.html#a9253e2ada2b31c570a7c99d1bd6a6355">CDEBUG</a>(((i &amp; -i) == i) ? <a class="code" href="libcfs__debug_8h.html#acca9c9cff9837f6f3d2759b02a61ff1d">D_WARNING</a> : <a class="code" href="libcfs__debug_8h.html#a645bb72e3ae1cac3c21a4b507d522a92">D_NET</a>,
<a name="l00602"></a>00602                        <span class="stringliteral">&quot;Waiting for %s service to shutdown...\n&quot;</span>,
<a name="l00603"></a>00603                        sv-&gt;<a class="code" href="structsrpc__service.html#a1783e4ecbb7679934644df18dbf3ec36">sv_name</a>);
<a name="l00604"></a>00604                 set_current_state(TASK_UNINTERRUPTIBLE);
<a name="l00605"></a>00605                 schedule_timeout(<a class="code" href="linux-time_8h.html#a025b413736cfecdc30256f4e5d3d2605">cfs_time_seconds</a>(1) / 10);
<a name="l00606"></a>00606         }
<a name="l00607"></a>00607 }
<a name="l00608"></a>00608 
<a name="l00609"></a>00609 <span class="keyword">extern</span> <a class="code" href="structsfw__test__client__ops__t.html">sfw_test_client_ops_t</a> <a class="code" href="ping__test_8c.html#a2f9abcff4f9d3ce15ef3347fb793a125">ping_test_client</a>;
<a name="l00610"></a>00610 <span class="keyword">extern</span> <a class="code" href="structsrpc__service.html">srpc_service_t</a>        <a class="code" href="ping__test_8c.html#a4ae452ed53b46b40068b31bfc3fc333e">ping_test_service</a>;
<a name="l00611"></a>00611 <span class="keywordtype">void</span> <a class="code" href="ping__test_8c.html#a248762a3662e8a4ecea563ebb7922fbf">ping_init_test_client</a>(<span class="keywordtype">void</span>);
<a name="l00612"></a>00612 <span class="keywordtype">void</span> <a class="code" href="ping__test_8c.html#a92980f9244eb89a895f4e420e088660d">ping_init_test_service</a>(<span class="keywordtype">void</span>);
<a name="l00613"></a>00613 
<a name="l00614"></a>00614 <span class="keyword">extern</span> <a class="code" href="structsfw__test__client__ops__t.html">sfw_test_client_ops_t</a> <a class="code" href="brw__test_8c.html#aa73539429b856cf2b066fe94a362d9b4">brw_test_client</a>;
<a name="l00615"></a>00615 <span class="keyword">extern</span> <a class="code" href="structsrpc__service.html">srpc_service_t</a>        <a class="code" href="brw__test_8c.html#a92e5c076c917e0075e627407f9214685">brw_test_service</a>;
<a name="l00616"></a>00616 <span class="keywordtype">void</span> <a class="code" href="brw__test_8c.html#a61b4a2b679f8c9fbcdc60c7446d41d20">brw_init_test_client</a>(<span class="keywordtype">void</span>);
<a name="l00617"></a>00617 <span class="keywordtype">void</span> <a class="code" href="brw__test_8c.html#ab15412fa47f877c44da5c4497be04873">brw_init_test_service</a>(<span class="keywordtype">void</span>);
<a name="l00618"></a>00618 
<a name="l00619"></a>00619 <span class="preprocessor">#endif </span><span class="comment">/* __SELFTEST_SELFTEST_H__ */</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:34 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
