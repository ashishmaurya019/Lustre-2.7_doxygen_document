<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/ldlm/ldlm_lock.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/ldlm/ldlm_lock.c File Reference</h1><code>#include &lt;<a class="el" href="libcfs_8h_source.html">libcfs/libcfs.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__swab_8h_source.html">lustre_swab.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__class_8h_source.html">obd_class.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="ldlm__internal_8h_source.html">ldlm_internal.h</a>&quot;</code><br/>

<p><a href="ldlm__lock_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsl__insert__point.html">sl_insert_point</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlock__match__data.html">lock_match_data</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Describe the overlap between two locks.  <a href="structlock__match__data.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structexport__cl__data.html">export_cl_data</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>&nbsp;&nbsp;&nbsp;S_LDLM</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga82466f1300e6e9395e768b7336c0ac46">ldlm_convert_policy_to_wire</a> (enum <a class="el" href="group__lustreidl.html#ga5ced9a6707006817f5e2409b368f36b5">ldlm_type</a> type, const union <a class="el" href="unionldlm__policy__data.html">ldlm_policy_data</a> *lpolicy, union <a class="el" href="unionldlm__wire__policy__data.html">ldlm_wire_policy_data</a> *wpolicy)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Converts lock policy from local format to on the wire lock_desc format.  <a href="group__LDLM.html#ga82466f1300e6e9395e768b7336c0ac46"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga0f272b273065dc0d916fcb5c6b61d656">ldlm_convert_policy_to_local</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp, enum <a class="el" href="group__lustreidl.html#ga5ced9a6707006817f5e2409b368f36b5">ldlm_type</a> type, const union <a class="el" href="unionldlm__wire__policy__data.html">ldlm_wire_policy_data</a> *wpolicy, union <a class="el" href="unionldlm__policy__data.html">ldlm_policy_data</a> *lpolicy)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Converts lock policy from on the wire lock_desc format to local format.  <a href="group__LDLM.html#ga0f272b273065dc0d916fcb5c6b61d656"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#gad3450a8071d042dd92be8f2a9177e112">ldlm_it2str</a> (enum <a class="el" href="group__lustreidl.html#ga9c053c844f0d79b44f18bb65850a6081">ldlm_intent_flags</a> it)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga70d54ed9384416cd5e19fc593dac071f">ldlm_register_intent</a> (struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *ns, <a class="el" href="group__LDLM.html#ga07447890235da125e60400b2dee48626">ldlm_res_policy</a> arg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#gac526504450a40715c8e25fbab715689e">ldlm_lock_get</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a reference on a lock.  <a href="group__LDLM.html#gac526504450a40715c8e25fbab715689e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga5e363707438fb69f9253f2ab8bf4c5e6">ldlm_lock_put</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release lock reference.  <a href="group__LDLM.html#ga5e363707438fb69f9253f2ab8bf4c5e6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#aa905e3097901c0a7bb2744fdd8668e57">ldlm_lock_remove_from_lru_nolock</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes LDLM lock <em>lock</em> from LRU.  <a href="#aa905e3097901c0a7bb2744fdd8668e57"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a7cd4f877866749dceb72ca5c7b0c8e36">ldlm_lock_remove_from_lru_check</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, <a class="el" href="linux-time_8h.html#a0e81d053bc8d925f6574c760bbea5ac4">cfs_time_t</a> last_use)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes LDLM lock <em>lock</em> from LRU.  <a href="#a7cd4f877866749dceb72ca5c7b0c8e36"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a0f288b7ae24e7b38725be10472ebd0b0">ldlm_lock_add_to_lru_nolock</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds LDLM lock <em>lock</em> to namespace LRU.  <a href="#a0f288b7ae24e7b38725be10472ebd0b0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#ad08b8088fcdd1eea634b10f176c9bfeb">ldlm_lock_add_to_lru</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds LDLM lock <em>lock</em> to namespace LRU.  <a href="#ad08b8088fcdd1eea634b10f176c9bfeb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#ab2b695dcf2e2be0bbfa73c8fc7eef92a">ldlm_lock_touch_in_lru</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Moves LDLM lock <em>lock</em> that is already in namespace LRU to the tail of the LRU.  <a href="#ab2b695dcf2e2be0bbfa73c8fc7eef92a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#af9f34c7a223ad572da0072d448e49021">ldlm_lock_destroy_internal</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper to destroy a locked lock.  <a href="#af9f34c7a223ad572da0072d448e49021"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga833125f7d72f8e77cb16c031c56dd2a0">ldlm_lock_destroy</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroys a LDLM lock <em>lock</em>.  <a href="group__LDLM.html#ga833125f7d72f8e77cb16c031c56dd2a0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a3c2af810ecacce9f1dbc9308e04b090b">ldlm_lock_destroy_nolock</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroys a LDLM lock <em>lock</em> that is already locked.  <a href="#a3c2af810ecacce9f1dbc9308e04b090b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#ac3f738873bd4ebf596bcf9eea2acddf8">lock_handle_addref</a> (void *lock)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a64a3343334a2f0e07acbfebbb6e8ba38">lock_handle_free</a> (void *lock, int <a class="el" href="parallel__grouplock_8c.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#ac99ac7b91d3210a55c99a1247cb85003">ldlm_lock_new</a> (struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *resource)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate and initialize new lock structure.  <a href="#ac99ac7b91d3210a55c99a1247cb85003"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#gafd6a07a826f7d2789696e472dd81adc2">ldlm_lock_change_resource</a> (struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *ns, struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, const struct <a class="el" href="structldlm__res__id.html">ldlm_res_id</a> *new_resid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Moves LDLM lock <em>lock</em> to another resource.  <a href="group__LDLM.html#gafd6a07a826f7d2789696e472dd81adc2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ldlm__handles.html#ga35362f3605ec8dec52464f153c932c85">ldlm_lock2handle</a> (const struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *lockh)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fills in handle for LDLM lock <em>lock</em> into supplied <em>lockh</em> Does not take any references.  <a href="group__ldlm__handles.html#ga35362f3605ec8dec52464f153c932c85"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ldlm__handles.html#ga79665fefb3834e7ea72e9d8aacdad4d2">__ldlm_handle2lock</a> (const struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *handle, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> flags)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Obtain a lock reference by handle.  <a href="group__ldlm__handles.html#ga79665fefb3834e7ea72e9d8aacdad4d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga7b4cfac056355ba992b1b7d9bfbaa25b">ldlm_lock2desc</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, struct <a class="el" href="structldlm__lock__desc.html">ldlm_lock_desc</a> *desc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fill in "on the wire" representation for given LDLM lock into supplied lock descriptor <em>desc</em> structure.  <a href="group__LDLM.html#ga7b4cfac056355ba992b1b7d9bfbaa25b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a8f481ab58888944db1671b9fbd3546d0">ldlm_add_bl_work_item</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *new, struct <a class="el" href="structlist__head.html">list_head</a> *work_list)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a lock to list of conflicting locks to send AST to.  <a href="#a8f481ab58888944db1671b9fbd3546d0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a1aad28a78ae7e3d88e493212729ff5c5">ldlm_add_cp_work_item</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, struct <a class="el" href="structlist__head.html">list_head</a> *work_list)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a lock to list of just granted locks to send completion AST to.  <a href="#a1aad28a78ae7e3d88e493212729ff5c5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#ad067ab568e7a265724d233c63d0b5632">ldlm_add_ast_work_item</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *new, struct <a class="el" href="structlist__head.html">list_head</a> *work_list)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Aggregator function to add AST work items into a list.  <a href="#ad067ab568e7a265724d233c63d0b5632"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga2d77135057c3b9123a3ae5704752c946">ldlm_lock_addref</a> (const struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *lockh, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add specified reader/writer reference to LDLM lock with handle <em>lockh</em>.  <a href="group__LDLM.html#ga2d77135057c3b9123a3ae5704752c946"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a1675d9ed6639792162c92e8f2649bcab">ldlm_lock_addref_internal_nolock</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper function.  <a href="#a1675d9ed6639792162c92e8f2649bcab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga580d951cff91ebd5c1d2a7588d4c2ea3">ldlm_lock_addref_try</a> (const struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *lockh, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Attempts to add reader/writer reference to a lock with handle <em>lockh</em>, and fails if lock is already LDLM_FL_CBPENDING or destroyed.  <a href="group__LDLM.html#ga580d951cff91ebd5c1d2a7588d4c2ea3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a0f5e01f967c0a18a4b1d37054f8c86f7">ldlm_lock_addref_internal</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add specified reader/writer reference to LDLM lock <em>lock</em>.  <a href="#a0f5e01f967c0a18a4b1d37054f8c86f7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a813828f40b85a9dfd7094575cdb49a1b">ldlm_lock_decref_internal_nolock</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes reader/writer reference for LDLM lock <em>lock</em>.  <a href="#a813828f40b85a9dfd7094575cdb49a1b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a4f22b68aaaa93c8172302bd00c9095ae">ldlm_lock_decref_internal</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes reader/writer reference for LDLM lock <em>lock</em>.  <a href="#a4f22b68aaaa93c8172302bd00c9095ae"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga82ed1d0d1d2788cad8813e69df77d625">ldlm_lock_decref</a> (const struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *lockh, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Decrease reader/writer refcount for LDLM lock with handle <em>lockh</em>.  <a href="group__LDLM.html#ga82ed1d0d1d2788cad8813e69df77d625"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#gad236a9af5f0845e1046060a55419914b">ldlm_lock_decref_and_cancel</a> (const struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *lockh, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Decrease reader/writer refcount for LDLM lock with handle <em>lockh</em> and mark it for subsequent cancellation once r/w refcount drops to zero instead of putting into LRU.  <a href="group__LDLM.html#gad236a9af5f0845e1046060a55419914b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#aeb69bf6ae74acb71ba3b2fcca0f5f5b7">search_granted_lock</a> (struct <a class="el" href="structlist__head.html">list_head</a> *queue, struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *req, struct <a class="el" href="structsl__insert__point.html">sl_insert_point</a> *prev)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Finds a position to insert the new lock into granted lock list.  <a href="#aeb69bf6ae74acb71ba3b2fcca0f5f5b7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#ab7092d97dcafdb27044414e14a32d4c6">ldlm_granted_list_add_lock</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, struct <a class="el" href="structsl__insert__point.html">sl_insert_point</a> *prev)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a lock into resource granted list after a position described by <em>prev</em>.  <a href="#ab7092d97dcafdb27044414e14a32d4c6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#aa79a009d39a612f146b9a875c3eb7c26">ldlm_grant_lock_with_skiplist</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a lock to granted list on a resource maintaining skiplist correctness.  <a href="#aa79a009d39a612f146b9a875c3eb7c26"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a98e89ee56eb9d2c97ef890d98925bd6a">ldlm_grant_lock</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, struct <a class="el" href="structlist__head.html">list_head</a> *work_list)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Perform lock granting bookkeeping.  <a href="#a98e89ee56eb9d2c97ef890d98925bd6a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a66232614560bc48aea0fdffd6acdc7aa">lock_matches</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, struct <a class="el" href="structlock__match__data.html">lock_match_data</a> *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if the given  meets the criteria for a match.  <a href="#a66232614560bc48aea0fdffd6acdc7aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a748669a5e6bbd00151101b70c3d59b2b">itree_overlap_cb</a> (struct <a class="el" href="structinterval__node.html">interval_node</a> *in, void *args)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a4522443228468829f7c91226214f4fc6">search_itree</a> (struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *res, struct <a class="el" href="structlock__match__data.html">lock_match_data</a> *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Search for a lock with given parameters in interval trees.  <a href="#a4522443228468829f7c91226214f4fc6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a12474ad482f44011830f1cd01720840f">search_queue</a> (struct <a class="el" href="structlist__head.html">list_head</a> *queue, struct <a class="el" href="structlock__match__data.html">lock_match_data</a> *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Search for a lock with given properties in a queue.  <a href="#a12474ad482f44011830f1cd01720840f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga3f34c3286a49d3d2f1e4b16029647a5b">ldlm_lock_fail_match_locked</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#gae911593eccfe0aa5995935808b646d2a">ldlm_lock_fail_match</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#gab9c1d858901b9d9a4db13ffbad095fb6">ldlm_lock_allow_match_locked</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mark lock as "matchable" by OST.  <a href="group__LDLM.html#gab9c1d858901b9d9a4db13ffbad095fb6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga9e8b401ed51dda94f553670e73872135">ldlm_lock_allow_match</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mark lock as "matchable" by OST.  <a href="group__LDLM.html#ga9e8b401ed51dda94f553670e73872135"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga1373811e4c4edbb039f1da1ca7947b03">ldlm_lock_match</a> (struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *ns, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> flags, const struct <a class="el" href="structldlm__res__id.html">ldlm_res_id</a> *res_id, enum <a class="el" href="group__lustreidl.html#ga5ced9a6707006817f5e2409b368f36b5">ldlm_type</a> type, union <a class="el" href="unionldlm__policy__data.html">ldlm_policy_data</a> *policy, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>, struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *lockh, int unref)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Attempt to find a lock with specified properties.  <a href="group__LDLM.html#ga1373811e4c4edbb039f1da1ca7947b03"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga396833924edeb2118df4fdff47aa7489">ldlm_revalidate_lock_handle</a> (const struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *lockh, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *bits)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a608383931ed837256b29d8dc3fc764df">ldlm_fill_lvb</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, struct <a class="el" href="structreq__capsule.html">req_capsule</a> *pill, enum <a class="el" href="group__req__layout.html#ga0c07ccef9ef768eb7bf6cb2946c28261">req_location</a> loc, void *data, int <a class="el" href="parallel__grouplock_8c.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The caller must guarantee that the buffer is large enough.  <a href="#a608383931ed837256b29d8dc3fc764df"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a2a79df45a197b1d85e0dbb3a657b8a3e">ldlm_lock_create</a> (struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *ns, const struct <a class="el" href="structldlm__res__id.html">ldlm_res_id</a> *res_id, enum <a class="el" href="group__lustreidl.html#ga5ced9a6707006817f5e2409b368f36b5">ldlm_type</a> type, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>, const struct <a class="el" href="structldlm__callback__suite.html">ldlm_callback_suite</a> *cbs, void *data, __u32 lvb_len, enum <a class="el" href="group__LDLM.html#ga2e4dbf6d38ddcec566ec40c96391622b">lvb_type</a> <a class="el" href="group__LDLM.html#ga2e4dbf6d38ddcec566ec40c96391622b">lvb_type</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create and fill in new LDLM lock with specified properties.  <a href="#a2a79df45a197b1d85e0dbb3a657b8a3e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="group__LDLM.html#gaa2fbd012972eb2b2d0653c8df02964f7">ldlm_error</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#af677fb1f5f169d4d6f85254e41b359dd">ldlm_lock_enqueue</a> (struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *ns, struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> **lockp, void *cookie, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *flags)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enqueue (request) a lock.  <a href="#af677fb1f5f169d4d6f85254e41b359dd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a4b704d0518e64bbf3c1815b4bb1c6ba6">ldlm_work_bl_ast_lock</a> (struct <a class="el" href="structptlrpc__request__set.html">ptlrpc_request_set</a> *rqset, void *opaq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process a call to blocking AST callback for a lock in ast_work list.  <a href="#a4b704d0518e64bbf3c1815b4bb1c6ba6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a41414c0cf9fe6b7650866733df35e9ac">ldlm_work_cp_ast_lock</a> (struct <a class="el" href="structptlrpc__request__set.html">ptlrpc_request_set</a> *rqset, void *opaq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process a call to completion AST callback for a lock in ast_work list.  <a href="#a41414c0cf9fe6b7650866733df35e9ac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a09883fabdcc6784fab13873bef1e02ef">ldlm_work_revoke_ast_lock</a> (struct <a class="el" href="structptlrpc__request__set.html">ptlrpc_request_set</a> *rqset, void *opaq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process a call to revocation AST callback for a lock in ast_work list.  <a href="#a09883fabdcc6784fab13873bef1e02ef"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#afa16fd0c6f6dcd2514b6c529e58fa402">ldlm_work_gl_ast_lock</a> (struct <a class="el" href="structptlrpc__request__set.html">ptlrpc_request_set</a> *rqset, void *opaq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process a call to glimpse AST callback for a lock in ast_work list.  <a href="#afa16fd0c6f6dcd2514b6c529e58fa402"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a825464ac0dd43ec4bce6013052cd1a30">ldlm_run_ast_work</a> (struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *ns, struct <a class="el" href="structlist__head.html">list_head</a> *rpc_list, <a class="el" href="ldlm__internal_8h.html#ab2beeaa64c7143ab8c4b9f89b522a312">ldlm_desc_ast_t</a> <a class="el" href="mgs__handler_8c.html#a77091c187ac9a89404fac2e8226daef3">ast_type</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process list of locks in need of ASTs being sent.  <a href="#a825464ac0dd43ec4bce6013052cd1a30"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#af90d2f3d6d37683b8d53428602a13add">reprocess_one_queue</a> (struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *res, void *closure)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a343f0324fd5028808e6bfedc30421374">ldlm_reprocess_res</a> (struct <a class="el" href="structcfs__hash.html">cfs_hash</a> *hs, struct <a class="el" href="structcfs__hash__bd.html">cfs_hash_bd</a> *bd, struct <a class="el" href="structhlist__node.html">hlist_node</a> *hnode, void *arg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga6a893da5c75236bb6f573e2484d4eecc">ldlm_reprocess_all_ns</a> (struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *ns)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Iterate through all resources on a namespace attempting to grant waiting locks.  <a href="group__LDLM.html#ga6a893da5c75236bb6f573e2484d4eecc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga6fea368fc4ea7002b0dcd068bbe8771a">ldlm_reprocess_all</a> (struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *res)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Try to grant all waiting locks on a resource.  <a href="group__LDLM.html#ga6fea368fc4ea7002b0dcd068bbe8771a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a9b0ce4cac273cb0148c50f06f9b23635">is_bl_done</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga0a466989372b56e3cde1edae472be066">ldlm_cancel_callback</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper function to call blocking AST for LDLM lock <em>lock</em> in a "cancelling" mode.  <a href="group__LDLM.html#ga0a466989372b56e3cde1edae472be066"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#gaff973b12d9e531ff04c69b478d6750cb">ldlm_unlink_lock_skiplist</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove skiplist-enabled LDLM lock <em>req</em> from granted list.  <a href="group__LDLM.html#gaff973b12d9e531ff04c69b478d6750cb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#gadec8a773eb3b13c995cf35a4d013393b">ldlm_lock_cancel</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Attempts to cancel LDLM lock <em>lock</em> that has no reader/writer references.  <a href="group__LDLM.html#gadec8a773eb3b13c995cf35a4d013393b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga098ec9c63984ffbe25f17174b376b1a0">ldlm_lock_set_data</a> (const struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *lockh, void *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set opaque data into the lock that only makes sense to upper layer.  <a href="group__LDLM.html#ga098ec9c63984ffbe25f17174b376b1a0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#af2ba73001c34ce814342ec5a69342954">ldlm_cancel_lock_for_export</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp, struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, struct <a class="el" href="structexport__cl__data.html">export_cl_data</a> *ecl)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a35ce0cf2f5f779647a88af97a920796b">ldlm_cancel_locks_for_export_cb</a> (struct <a class="el" href="structcfs__hash.html">cfs_hash</a> *hs, struct <a class="el" href="structcfs__hash__bd.html">cfs_hash_bd</a> *bd, struct <a class="el" href="structhlist__node.html">hlist_node</a> *hnode, void *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Iterator function for ldlm_export_cancel_locks.  <a href="#a35ce0cf2f5f779647a88af97a920796b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a3eeecdf429661787db6cba2248956365">ldlm_export_cancel_blocked_locks</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cancel all blocked locks for given export.  <a href="#a3eeecdf429661787db6cba2248956365"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#afd64cd3408818286abbf6cfa5de359a2">ldlm_export_cancel_locks</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cancel all locks for given export.  <a href="#afd64cd3408818286abbf6cfa5de359a2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga1ae32c9c745cefc485fd39cf0054e2ef">ldlm_lock_downgrade</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> new_mode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Downgrade an exclusive lock.  <a href="group__LDLM.html#ga1ae32c9c745cefc485fd39cf0054e2ef"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#gaeeab5a5dbe0a5b966d52f388b69eed3f">ldlm_lock_convert</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> new_mode, __u32 *flags)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Attempt to convert already granted lock to a different mode.  <a href="group__LDLM.html#gaeeab5a5dbe0a5b966d52f388b69eed3f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga5f3ca6b2c348db5cd17b45c0e2b99ba8">ldlm_lock_dump_handle</a> (int level, const struct <a class="el" href="structlustre__handle.html">lustre_handle</a> *lockh)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print lock with lock handle <em>lockh</em> description into debug log.  <a href="group__LDLM.html#ga5f3ca6b2c348db5cd17b45c0e2b99ba8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a5d1086a76031792f1974149627c1f338">_ldlm_lock_debug</a> (struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *lock, struct <a class="el" href="structlibcfs__debug__msg__data.html">libcfs_debug_msg_data</a> *msgdata, const char *fmt,...)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print lock information with custom message into debug log.  <a href="#a5d1086a76031792f1974149627c1f338"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#gaacf06e33756d242222391e67857d6e14">ldlm_lockname</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__LDLM.html#ga0ec36144688c37580c1c66f547ba3c08">ldlm_typename</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="ldlm__internal_8h.html#a6b491ba3392406b93a373c028ffc4ded">ldlm_policy_wire_to_local_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a0d2ee6fe4b99f15e3c7b5b9a455167bf">ldlm_policy_wire_to_local</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="ldlm__internal_8h.html#ac5a58c3780ace731df7cd203849c4e8b">ldlm_policy_local_to_wire_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a904b44197a69432fcc17951b555da7b7">ldlm_policy_local_to_wire</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct kmem_cache *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#ab042af710154778086ba81ee05d69fd1">ldlm_lock_slab</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structportals__handle__ops.html">portals_handle_ops</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ldlm__lock_8c.html#a3e72e682cdfc37de37090fb9ace14586">lock_handle_ops</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="abda60744d497fcfe370cfd6b2d65c7ed"></a><!-- doxytag: member="ldlm_lock.c::DEBUG_SUBSYSTEM" ref="abda60744d497fcfe370cfd6b2d65c7ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_SUBSYSTEM&nbsp;&nbsp;&nbsp;S_LDLM</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00042">42</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a5d1086a76031792f1974149627c1f338"></a><!-- doxytag: member="ldlm_lock.c::_ldlm_lock_debug" ref="a5d1086a76031792f1974149627c1f338" args="(struct ldlm_lock *lock, struct libcfs_debug_msg_data *msgdata, const char *fmt,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ldlm_lock_debug </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlibcfs__debug__msg__data.html">libcfs_debug_msg_data</a> *&nbsp;</td>
          <td class="paramname"> <em>msgdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print lock information with custom message into debug log. </p>
<p>Helper function. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l02607">2607</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l02841">ldlm_inodebits::bits</a>, <a class="el" href="lustre__net_8h_source.html#l00521">ptlrpc_connection::c_peer</a>, <a class="el" href="obd_8h_source.html#l00162">client_obd::cl_import</a>, <a class="el" href="obd_8h_source.html#l00699">obd_device::cli</a>, <a class="el" href="lustre__idl_8h_source.html#l01017">lustre_handle::cookie</a>, <a class="el" href="lustre__idl_8h_source.html#l02783">DLDLMRES</a>, <a class="el" href="lustre__dlm_8h_source.html#l00623">ldlm_flock::end</a>, <a class="el" href="lustre__idl_8h_source.html#l02823">ldlm_extent::end</a>, <a class="el" href="lustre__export_8h_source.html#l00217">obd_export::exp_connection</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="lustre__export_8h_source.html#l00176">obd_export::exp_refcount</a>, <a class="el" href="lustre__handles_8h_source.html#l00067">portals_handle::h_cookie</a>, <a class="el" href="lustre__import_8h_source.html#l00170">obd_import::imp_connection</a>, <a class="el" href="lustre__dlm_8h_source.html#l00852">ldlm_lock::l_callback_timeout</a>, <a class="el" href="lustre__dlm_8h_source.html#l00754">ldlm_lock::l_export</a>, <a class="el" href="lustre__dlm_8h_source.html#l00633">ldlm_policy_data::l_extent</a>, <a class="el" href="lustre__dlm_8h_source.html#l00778">ldlm_lock::l_flags</a>, <a class="el" href="lustre__dlm_8h_source.html#l00634">ldlm_policy_data::l_flock</a>, <a class="el" href="lustre__dlm_8h_source.html#l00728">ldlm_lock::l_granted_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00678">ldlm_lock::l_handle</a>, <a class="el" href="lustre__dlm_8h_source.html#l00635">ldlm_policy_data::l_inodebits</a>, <a class="el" href="lustre__dlm_8h_source.html#l00812">ldlm_lock::l_lvb_type</a>, <a class="el" href="lustre__dlm_8h_source.html#l00855">ldlm_lock::l_pid</a>, <a class="el" href="lustre__dlm_8h_source.html#l00772">ldlm_lock::l_policy_data</a>, <a class="el" href="lustre__dlm_8h_source.html#l00784">ldlm_lock::l_readers</a>, <a class="el" href="lustre__dlm_8h_source.html#l00684">ldlm_lock::l_refc</a>, <a class="el" href="lustre__dlm_8h_source.html#l00766">ldlm_lock::l_remote_handle</a>, <a class="el" href="lustre__dlm_8h_source.html#l00806">ldlm_lock::l_req_extent</a>, <a class="el" href="lustre__dlm_8h_source.html#l00724">ldlm_lock::l_req_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="lustre__dlm_8h_source.html#l00785">ldlm_lock::l_writers</a>, <a class="el" href="packet-lustre_8c_source.html#l00299">LDLM_EXTENT</a>, <a class="el" href="packet-lustre_8c_source.html#l00300">LDLM_FLOCK</a>, <a class="el" href="packet-lustre_8c_source.html#l00301">LDLM_IBITS</a>, <a class="el" href="lustre__dlm_8h_source.html#l01012">ldlm_lock_to_ns_name()</a>, <a class="el" href="ldlm__lock_8c_source.html#l00052">ldlm_lockname</a>, <a class="el" href="ldlm__lock_8c_source.html#l00065">ldlm_typename</a>, <a class="el" href="libcfs__debug_8h.html#a8877fb34a6211d9fb620a7a35d97468c">libcfs_debug_vmsg2()</a>, <a class="el" href="nidstr_8h_source.html#l00077">libcfs_nid2str()</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="lustre__dlm_8h_source.html#l00932">ldlm_resource::lr_refcount</a>, <a class="el" href="lustre__dlm_8h_source.html#l00970">ldlm_resource::lr_type</a>, <a class="el" href="lnet_2include_2lnet_2types_8h_source.html#l00304">lnet_process_id_t::nid</a>, <a class="el" href="lustre__dlm_8h_source.html#l00629">ldlm_flock::pid</a>, <a class="el" href="lustre__idl_8h_source.html#l02784">PLDLMRES</a>, <a class="el" href="lustre__dlm_8h_source.html#l00622">ldlm_flock::start</a>, <a class="el" href="lustre__idl_8h_source.html#l02822">ldlm_extent::start</a>, and <a class="el" href="structobd__device.html#aebe227afed9945c803b5bda6794bb729">obd_device::u</a>.</p>

</div>
</div>
<a class="anchor" id="a9b0ce4cac273cb0148c50f06f9b23635"></a><!-- doxytag: member="ldlm_lock.c::is_bl_done" ref="a9b0ce4cac273cb0148c50f06f9b23635" args="(struct ldlm_lock *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool is_bl_done </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l02188">2188</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__dlm__flags_8h_source.html#l00281">ldlm_is_bl_done</a>, <a class="el" href="l__lock_8c_source.html#l00051">lock_res_and_lock()</a>, and <a class="el" href="l__lock_8c_source.html#l00067">unlock_res_and_lock()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l02205">ldlm_cancel_callback()</a>.</p>

</div>
</div>
<a class="anchor" id="a748669a5e6bbd00151101b70c3d59b2b"></a><!-- doxytag: member="ldlm_lock.c::itree_overlap_cb" ref="a748669a5e6bbd00151101b70c3d59b2b" args="(struct interval_node *in, void *args)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int itree_overlap_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structinterval__node.html">interval_node</a> *&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>args</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01228">1228</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="interval__tree_8h_source.html#l00061">INTERVAL_ITER_CONT</a>, <a class="el" href="interval__tree_8h_source.html#l00062">INTERVAL_ITER_STOP</a>, <a class="el" href="lustre__dlm_8h_source.html#l00882">ldlm_lock::l_sl_policy</a>, <a class="el" href="lustre__dlm_8h_source.html#l00593">ldlm_interval::li_group</a>, <a class="el" href="list_8h_source.html#l00459">list_for_each_entry</a>, <a class="el" href="ldlm__lock_8c_source.html#l01154">lock_matches()</a>, and <a class="el" href="lustre__dlm_8h_source.html#l00596">to_ldlm_interval</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l01251">search_itree()</a>.</p>

</div>
</div>
<a class="anchor" id="ad067ab568e7a265724d233c63d0b5632"></a><!-- doxytag: member="ldlm_lock.c::ldlm_add_ast_work_item" ref="ad067ab568e7a265724d233c63d0b5632" args="(struct ldlm_lock *lock, struct ldlm_lock *new, struct list_head *work_list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldlm_add_ast_work_item </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlist__head.html">list_head</a> *&nbsp;</td>
          <td class="paramname"> <em>work_list</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Aggregator function to add AST work items into a list. </p>
<p>Determines what sort of an AST work needs to be done and calls the proper adding function. Must be called with lr_lock held. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00700">700</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__dlm_8h_source.html#l01556">check_res_locked()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="ldlm__lock_8c_source.html#l00661">ldlm_add_bl_work_item()</a>, and <a class="el" href="ldlm__lock_8c_source.html#l00682">ldlm_add_cp_work_item()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__flock_8c_source.html#l00250">ldlm_flock_cancel_on_deadlock()</a>, <a class="el" href="ldlm__lock_8c_source.html#l01101">ldlm_grant_lock()</a>, and <a class="el" href="ldlm__flock_8c_source.html#l00289">ldlm_process_flock_lock()</a>.</p>

</div>
</div>
<a class="anchor" id="a8f481ab58888944db1671b9fbd3546d0"></a><!-- doxytag: member="ldlm_lock.c::ldlm_add_bl_work_item" ref="a8f481ab58888944db1671b9fbd3546d0" args="(struct ldlm_lock *lock, struct ldlm_lock *new, struct list_head *work_list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ldlm_add_bl_work_item </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlist__head.html">list_head</a> *&nbsp;</td>
          <td class="paramname"> <em>work_list</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a lock to list of conflicting locks to send AST to. </p>
<p>Only add if we have not sent a blocking AST to the lock yet. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00661">661</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__dlm_8h_source.html#l00865">ldlm_lock::l_bl_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00875">ldlm_lock::l_blocking_lock</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__dlm_8h_source.html#l01168">LDLM_DEBUG</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00152">ldlm_is_ast_discard_data</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00063">ldlm_is_ast_sent</a>, <a class="el" href="lustre__dlm_8h_source.html#l01344">LDLM_LOCK_GET</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00064">ldlm_set_ast_sent</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00096">ldlm_set_discard_data</a>, <a class="el" href="list_8h_source.html#l00076">list_add()</a>, and <a class="el" href="list_8h_source.html#l00161">list_empty()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l00700">ldlm_add_ast_work_item()</a>.</p>

</div>
</div>
<a class="anchor" id="a1aad28a78ae7e3d88e493212729ff5c5"></a><!-- doxytag: member="ldlm_lock.c::ldlm_add_cp_work_item" ref="a1aad28a78ae7e3d88e493212729ff5c5" args="(struct ldlm_lock *lock, struct list_head *work_list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ldlm_add_cp_work_item </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlist__head.html">list_head</a> *&nbsp;</td>
          <td class="paramname"> <em>work_list</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a lock to list of just granted locks to send completion AST to. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00682">682</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__dlm_8h_source.html#l00867">ldlm_lock::l_cp_ast</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__dlm_8h_source.html#l01168">LDLM_DEBUG</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00245">ldlm_is_cp_reqd</a>, <a class="el" href="lustre__dlm_8h_source.html#l01344">LDLM_LOCK_GET</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00246">ldlm_set_cp_reqd</a>, <a class="el" href="list_8h_source.html#l00076">list_add()</a>, and <a class="el" href="list_8h_source.html#l00161">list_empty()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l00700">ldlm_add_ast_work_item()</a>.</p>

</div>
</div>
<a class="anchor" id="af2ba73001c34ce814342ec5a69342954"></a><!-- doxytag: member="ldlm_lock.c::ldlm_cancel_lock_for_export" ref="af2ba73001c34ce814342ec5a69342954" args="(struct obd_export *exp, struct ldlm_lock *lock, struct export_cl_data *ecl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ldlm_cancel_lock_for_export </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structexport__cl__data.html">export_cl_data</a> *&nbsp;</td>
          <td class="paramname"> <em>ecl</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l02315">2315</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="ldlm__lock_8c_source.html#l02312">export_cl_data::ecl_loop</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="ldlm__lock_8c_source.html#l02249">ldlm_lock_cancel()</a>, <a class="el" href="ldlm__lock_8c_source.html#l02147">ldlm_reprocess_all()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01296">ldlm_res_lvbo_update()</a>, <a class="el" href="ldlm__resource_8c_source.html#l01257">ldlm_resource_getref()</a>, <a class="el" href="ldlm__resource_8c_source.html#l01295">ldlm_resource_putref()</a>, and <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_stopping</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l02341">ldlm_cancel_locks_for_export_cb()</a>, and <a class="el" href="ldlm__lock_8c_source.html#l02361">ldlm_export_cancel_blocked_locks()</a>.</p>

</div>
</div>
<a class="anchor" id="a35ce0cf2f5f779647a88af97a920796b"></a><!-- doxytag: member="ldlm_lock.c::ldlm_cancel_locks_for_export_cb" ref="a35ce0cf2f5f779647a88af97a920796b" args="(struct cfs_hash *hs, struct cfs_hash_bd *bd, struct hlist_node *hnode, void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ldlm_cancel_locks_for_export_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcfs__hash.html">cfs_hash</a> *&nbsp;</td>
          <td class="paramname"> <em>hs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcfs__hash__bd.html">cfs_hash_bd</a> *&nbsp;</td>
          <td class="paramname"> <em>bd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structhlist__node.html">hlist_node</a> *&nbsp;</td>
          <td class="paramname"> <em>hnode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Iterator function for ldlm_export_cancel_locks. </p>
<p>Cancels passed locks. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l02341">2341</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="libcfs__hash_8h_source.html#l00482">cfs_hash_object()</a>, <a class="el" href="ldlm__lock_8c_source.html#l02311">export_cl_data::ecl_exp</a>, <a class="el" href="ldlm__lock_8c_source.html#l02315">ldlm_cancel_lock_for_export()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01344">LDLM_LOCK_GET</a>, and <a class="el" href="lustre__dlm_8h_source.html#l01338">LDLM_LOCK_RELEASE</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l02401">ldlm_export_cancel_locks()</a>.</p>

</div>
</div>
<a class="anchor" id="a3eeecdf429661787db6cba2248956365"></a><!-- doxytag: member="ldlm_lock.c::ldlm_export_cancel_blocked_locks" ref="a3eeecdf429661787db6cba2248956365" args="(struct obd_export *exp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ldlm_export_cancel_blocked_locks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Cancel all blocked locks for given export. </p>
<p>Typically called on client disconnection/eviction </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l02361">2361</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00145">D_DLMTRACE</a>, <a class="el" href="ldlm__lock_8c_source.html#l02311">export_cl_data::ecl_exp</a>, <a class="el" href="ldlm__lock_8c_source.html#l02312">export_cl_data::ecl_loop</a>, <a class="el" href="lustre__export_8h_source.html#l00274">obd_export::exp_bl_list</a>, <a class="el" href="lustre__export_8h_source.html#l00275">obd_export::exp_bl_list_lock</a>, <a class="el" href="lustre__export_8h_source.html#l00221">obd_export::exp_lock_hash</a>, <a class="el" href="libcfs__hash_8h_source.html#l00220">cfs_hash::hs_count</a>, <a class="el" href="lustre__dlm_8h_source.html#l00901">ldlm_lock::l_exp_list</a>, <a class="el" href="ldlm__lock_8c_source.html#l02315">ldlm_cancel_lock_for_export()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01344">LDLM_LOCK_GET</a>, <a class="el" href="lustre__dlm_8h_source.html#l01338">LDLM_LOCK_RELEASE</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="list_8h_source.html#l00242">list_entry</a>, and <a class="el" href="list_8h_source.html#l00043">list_head::next</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lockd_8c_source.html#l02708">ldlm_bl_thread_exports()</a>.</p>

</div>
</div>
<a class="anchor" id="afd64cd3408818286abbf6cfa5de359a2"></a><!-- doxytag: member="ldlm_lock.c::ldlm_export_cancel_locks" ref="afd64cd3408818286abbf6cfa5de359a2" args="(struct obd_export *exp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ldlm_export_cancel_locks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Cancel all locks for given export. </p>
<p>Typically called after client disconnection/eviction </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l02401">2401</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="hash_8c_source.html#l01698">cfs_hash_for_each_empty()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00145">D_DLMTRACE</a>, <a class="el" href="ldlm__lock_8c_source.html#l02311">export_cl_data::ecl_exp</a>, <a class="el" href="ldlm__lock_8c_source.html#l02312">export_cl_data::ecl_loop</a>, <a class="el" href="lustre__export_8h_source.html#l00221">obd_export::exp_lock_hash</a>, <a class="el" href="libcfs__hash_8h_source.html#l00220">cfs_hash::hs_count</a>, and <a class="el" href="ldlm__lock_8c_source.html#l02341">ldlm_cancel_locks_for_export_cb()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lockd_8c_source.html#l02708">ldlm_bl_thread_exports()</a>.</p>

</div>
</div>
<a class="anchor" id="a608383931ed837256b29d8dc3fc764df"></a><!-- doxytag: member="ldlm_lock.c::ldlm_fill_lvb" ref="a608383931ed837256b29d8dc3fc764df" args="(struct ldlm_lock *lock, struct req_capsule *pill, enum req_location loc, void *data, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ldlm_fill_lvb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structreq__capsule.html">req_capsule</a> *&nbsp;</td>
          <td class="paramname"> <em>pill</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__req__layout.html#ga0c07ccef9ef768eb7bf6cb2946c28261">req_location</a>&nbsp;</td>
          <td class="paramname"> <em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The caller must guarantee that the buffer is large enough. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01539">1539</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__dlm_8h_source.html#l00812">ldlm_lock::l_lvb_type</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__dlm_8h_source.html#l01169">LDLM_ERROR</a>, <a class="el" href="libcfs__private_8h_source.html#l00302">libcfs_debug_dumpstack</a>, <a class="el" href="pack__generic_8c_source.html#l01823">lustre_swab_lquota_lvb()</a>, <a class="el" href="req-layout_8c_source.html#l00088">lustre_swab_ost_lvb</a>, <a class="el" href="req-layout_8c_source.html#l00087">lustre_swab_ost_lvb_v1</a>, <a class="el" href="lustre__idl_8h_source.html#l01822">ost_lvb::lvb_atime_ns</a>, <a class="el" href="lustre__idl_8h_source.html#l01823">ost_lvb::lvb_ctime_ns</a>, <a class="el" href="lustre__idl_8h_source.html#l01821">ost_lvb::lvb_mtime_ns</a>, <a class="el" href="lustre__dlm_8h_source.html#l00649">LVB_T_LAYOUT</a>, <a class="el" href="lustre__dlm_8h_source.html#l00648">LVB_T_LQUOTA</a>, <a class="el" href="lustre__dlm_8h_source.html#l00647">LVB_T_OST</a>, <a class="el" href="lustre__req__layout_8h_source.html#l00058">RCL_CLIENT</a>, <a class="el" href="layout_8c_source.html#l02117">req_capsule_client_get()</a>, <a class="el" href="layout_8c_source.html#l02130">req_capsule_client_swab_get()</a>, <a class="el" href="layout_8c_source.html#l02158">req_capsule_server_get()</a>, <a class="el" href="layout_8c_source.html#l02195">req_capsule_server_sized_swab_get()</a>, <a class="el" href="layout_8c_source.html#l02171">req_capsule_server_swab_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01049">RMF_DLM_LVB</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="ldlm__request_8c_source.html#l00541">ldlm_cli_enqueue_fini()</a>, and <a class="el" href="ldlm__lockd_8c_source.html#l01796">ldlm_handle_cp_callback()</a>.</p>

</div>
</div>
<a class="anchor" id="a98e89ee56eb9d2c97ef890d98925bd6a"></a><!-- doxytag: member="ldlm_lock.c::ldlm_grant_lock" ref="a98e89ee56eb9d2c97ef890d98925bd6a" args="(struct ldlm_lock *lock, struct list_head *work_list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldlm_grant_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlist__head.html">list_head</a> *&nbsp;</td>
          <td class="paramname"> <em>work_list</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Perform lock granting bookkeeping. </p>
<p>Includes putting the lock into granted list and updating lock mode. NOTE: called by</p>
<ul>
<li>ldlm_lock_enqueue</li>
<li>ldlm_reprocess_queue</li>
<li>ldlm_lock_convert</li>
</ul>
<p>must be called with lr_lock held </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01101">1101</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__dlm_8h_source.html#l01556">check_res_locked()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__dlm_8h_source.html#l00730">ldlm_lock::l_completion_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00728">ldlm_lock::l_granted_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00724">ldlm_lock::l_req_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="packet-lustre_8c_source.html#l00296">LCK_NL</a>, <a class="el" href="ldlm__lock_8c_source.html#l00700">ldlm_add_ast_work_item()</a>, <a class="el" href="packet-lustre_8c_source.html#l00299">LDLM_EXTENT</a>, <a class="el" href="ldlm__extent_8c_source.html#l00898">ldlm_extent_add_lock()</a>, <a class="el" href="ldlm__lock_8c_source.html#l01078">ldlm_grant_lock_with_skiplist()</a>, <a class="el" href="packet-lustre_8c_source.html#l00301">LDLM_IBITS</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00089">ldlm_is_flock_deadlock</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00115">ldlm_is_test_lock</a>, <a class="el" href="packet-lustre_8c_source.html#l00298">LDLM_PLAIN</a>, <a class="el" href="ldlm__pool_8c_source.html#l01536">ldlm_pool_add()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01000">ldlm_res_to_ns()</a>, <a class="el" href="ldlm__resource_8c_source.html#l01323">ldlm_resource_add_lock()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00941">ldlm_resource::lr_granted</a>, <a class="el" href="lustre__dlm_8h_source.html#l00970">ldlm_resource::lr_type</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00358">RETURN_EXIT</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lockd_8c_source.html#l01796">ldlm_handle_cp_callback()</a>, <a class="el" href="ldlm__lock_8c_source.html#l02459">ldlm_lock_convert()</a>, <a class="el" href="ldlm__lock_8c_source.html#l02428">ldlm_lock_downgrade()</a>, and <a class="el" href="ldlm__lock_8c_source.html#l01708">ldlm_lock_enqueue()</a>.</p>

</div>
</div>
<a class="anchor" id="aa79a009d39a612f146b9a875c3eb7c26"></a><!-- doxytag: member="ldlm_lock.c::ldlm_grant_lock_with_skiplist" ref="aa79a009d39a612f146b9a875c3eb7c26" args="(struct ldlm_lock *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ldlm_grant_lock_with_skiplist </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a lock to granted list on a resource maintaining skiplist correctness. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01078">1078</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__dlm_8h_source.html#l00728">ldlm_lock::l_granted_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00724">ldlm_lock::l_req_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="ldlm__lock_8c_source.html#l01040">ldlm_granted_list_add_lock()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00941">ldlm_resource::lr_granted</a>, and <a class="el" href="ldlm__lock_8c_source.html#l00955">search_granted_lock()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l01101">ldlm_grant_lock()</a>.</p>

</div>
</div>
<a class="anchor" id="ab7092d97dcafdb27044414e14a32d4c6"></a><!-- doxytag: member="ldlm_lock.c::ldlm_granted_list_add_lock" ref="ab7092d97dcafdb27044414e14a32d4c6" args="(struct ldlm_lock *lock, struct sl_insert_point *prev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ldlm_granted_list_add_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsl__insert__point.html">sl_insert_point</a> *&nbsp;</td>
          <td class="paramname"> <em>prev</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a lock into resource granted list after a position described by <em>prev</em>. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01040">1040</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="lustre__dlm_8h_source.html#l01556">check_res_locked()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="libcfs__debug_8h_source.html#l00141">D_OTHER</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__dlm_8h_source.html#l00705">ldlm_lock::l_res_link</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="lustre__dlm_8h_source.html#l00881">ldlm_lock::l_sl_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00882">ldlm_lock::l_sl_policy</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__dlm_8h_source.html#l01168">LDLM_DEBUG</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00310">ldlm_is_destroyed</a>, <a class="el" href="ldlm__resource_8c_source.html#l01448">ldlm_resource_dump()</a>, <a class="el" href="list_8h_source.html#l00076">list_add()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="ldlm__lock_8c_source.html#l00937">sl_insert_point::mode_link</a>, <a class="el" href="ldlm__lock_8c_source.html#l00938">sl_insert_point::policy_link</a>, and <a class="el" href="ldlm__lock_8c_source.html#l00936">sl_insert_point::res_link</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l01078">ldlm_grant_lock_with_skiplist()</a>, and <a class="el" href="ldlm__lock_8c_source.html#l02459">ldlm_lock_convert()</a>.</p>

</div>
</div>
<a class="anchor" id="ad08b8088fcdd1eea634b10f176c9bfeb"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_add_to_lru" ref="ad08b8088fcdd1eea634b10f176c9bfeb" args="(struct ldlm_lock *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldlm_lock_add_to_lru </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds LDLM lock <em>lock</em> to namespace LRU. </p>
<p>Obtains necessary LRU locks first. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00298">298</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="ldlm__lock_8c_source.html#l00281">ldlm_lock_add_to_lru_nolock()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01006">ldlm_lock_to_ns()</a>, and <a class="el" href="lustre__dlm_8h_source.html#l00380">ldlm_namespace::ns_lock</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l00827">ldlm_lock_decref_internal()</a>.</p>

</div>
</div>
<a class="anchor" id="a0f288b7ae24e7b38725be10472ebd0b0"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_add_to_lru_nolock" ref="a0f288b7ae24e7b38725be10472ebd0b0" args="(struct ldlm_lock *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldlm_lock_add_to_lru_nolock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds LDLM lock <em>lock</em> to namespace LRU. </p>
<p>Assumes LRU is already locked. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00281">281</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="linux-time_8h_source.html#l00152">cfs_time_current()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00803">ldlm_lock::l_last_used</a>, <a class="el" href="lustre__dlm_8h_source.html#l00699">ldlm_lock::l_lru</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00170">ldlm_clear_skipped</a>, <a class="el" href="packet-lustre_8c_source.html#l00300">LDLM_FLOCK</a>, <a class="el" href="lustre__dlm_8h_source.html#l01006">ldlm_lock_to_ns()</a>, <a class="el" href="list_8h_source.html#l00090">list_add_tail()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00970">ldlm_resource::lr_type</a>, <a class="el" href="lustre__dlm_8h_source.html#l00415">ldlm_namespace::ns_nr_unused</a>, and <a class="el" href="lustre__dlm_8h_source.html#l00413">ldlm_namespace::ns_unused_list</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l00298">ldlm_lock_add_to_lru()</a>, and <a class="el" href="ldlm__lock_8c_source.html#l00313">ldlm_lock_touch_in_lru()</a>.</p>

</div>
</div>
<a class="anchor" id="a0f5e01f967c0a18a4b1d37054f8c86f7"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_addref_internal" ref="a0f5e01f967c0a18a4b1d37054f8c86f7" args="(struct ldlm_lock *lock, enum ldlm_mode mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldlm_lock_addref_internal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add specified reader/writer reference to LDLM lock <em>lock</em>. </p>
<p>Locks LDLM lock and calls ldlm_lock_addref_internal_nolock to do the work. Only called for local locks. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00786">786</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="ldlm__lock_8c_source.html#l00735">ldlm_lock_addref_internal_nolock()</a>, <a class="el" href="l__lock_8c_source.html#l00051">lock_res_and_lock()</a>, and <a class="el" href="l__lock_8c_source.html#l00067">unlock_res_and_lock()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__request_8c_source.html#l00869">ldlm_cli_enqueue()</a>, and <a class="el" href="ldlm__lock_8c_source.html#l00717">ldlm_lock_addref()</a>.</p>

</div>
</div>
<a class="anchor" id="a1675d9ed6639792162c92e8f2649bcab"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_addref_internal_nolock" ref="a1675d9ed6639792162c92e8f2649bcab" args="(struct ldlm_lock *lock, enum ldlm_mode mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldlm_lock_addref_internal_nolock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Helper function. </p>
<p>Add specified reader/writer reference to LDLM lock <em>lock</em>. r/w reference type is determined by <em>mode</em> Removes lock from LRU if it is there. Assumes the LDLM lock is already locked. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00735">735</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__dlm_8h_source.html#l00784">ldlm_lock::l_readers</a>, <a class="el" href="lustre__dlm_8h_source.html#l00885">ldlm_lock::l_reference</a>, <a class="el" href="lustre__dlm_8h_source.html#l00785">ldlm_lock::l_writers</a>, <a class="el" href="lustre__idl_8h_source.html#l02805">LCK_COS</a>, <a class="el" href="packet-lustre_8c_source.html#l00295">LCK_CR</a>, <a class="el" href="packet-lustre_8c_source.html#l00294">LCK_CW</a>, <a class="el" href="packet-lustre_8c_source.html#l00291">LCK_EX</a>, <a class="el" href="packet-lustre_8c_source.html#l00297">LCK_GROUP</a>, <a class="el" href="packet-lustre_8c_source.html#l00296">LCK_NL</a>, <a class="el" href="packet-lustre_8c_source.html#l00293">LCK_PR</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="lustre__dlm_8h_source.html#l01168">LDLM_DEBUG</a>, <a class="el" href="lustre__dlm_8h_source.html#l01344">LDLM_LOCK_GET</a>, <a class="el" href="ldlm__internal_8h_source.html#l00171">ldlm_lock_remove_from_lru</a>, <a class="el" href="ldlm__lock_8c_source.html#l00052">ldlm_lockname</a>, and <a class="el" href="lu__ref_8h_source.html#l00210">lu_ref_add_atomic()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__request_8c_source.html#l00415">ldlm_cli_enqueue_local()</a>, <a class="el" href="ldlm__lock_8c_source.html#l00786">ldlm_lock_addref_internal()</a>, <a class="el" href="ldlm__lock_8c_source.html#l00760">ldlm_lock_addref_try()</a>, <a class="el" href="ldlm__flock_8c_source.html#l00289">ldlm_process_flock_lock()</a>, <a class="el" href="ldlm__lock_8c_source.html#l01504">ldlm_revalidate_lock_handle()</a>, and <a class="el" href="ldlm__lock_8c_source.html#l01154">lock_matches()</a>.</p>

</div>
</div>
<a class="anchor" id="a2a79df45a197b1d85e0dbb3a657b8a3e"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_create" ref="a2a79df45a197b1d85e0dbb3a657b8a3e" args="(struct ldlm_namespace *ns, const struct ldlm_res_id *res_id, enum ldlm_type type, enum ldlm_mode mode, const struct ldlm_callback_suite *cbs, void *data, __u32 lvb_len, enum lvb_type lvb_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a>* ldlm_lock_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *&nbsp;</td>
          <td class="paramname"> <em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structldlm__res__id.html">ldlm_res_id</a> *&nbsp;</td>
          <td class="paramname"> <em>res_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__lustreidl.html#ga5ced9a6707006817f5e2409b368f36b5">ldlm_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structldlm__callback__suite.html">ldlm_callback_suite</a> *&nbsp;</td>
          <td class="paramname"> <em>cbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>lvb_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__LDLM.html#ga2e4dbf6d38ddcec566ec40c96391622b">lvb_type</a> <a class="el" href="group__LDLM.html#ga2e4dbf6d38ddcec566ec40c96391622b">lvb_type</a>&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create and fill in new LDLM lock with specified properties. </p>
<p>Returns a referenced lock </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01641">1641</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="linux_2libcfs_8h_source.html#l00145">current_pid</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lustre__dlm_8h_source.html#l00822">ldlm_lock::l_ast_data</a>, <a class="el" href="lustre__dlm_8h_source.html#l00741">ldlm_lock::l_blocking_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00730">ldlm_lock::l_completion_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00747">ldlm_lock::l_glimpse_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00819">ldlm_lock::l_lvb_data</a>, <a class="el" href="lustre__dlm_8h_source.html#l00818">ldlm_lock::l_lvb_len</a>, <a class="el" href="lustre__dlm_8h_source.html#l00812">ldlm_lock::l_lvb_type</a>, <a class="el" href="lustre__dlm_8h_source.html#l00855">ldlm_lock::l_pid</a>, <a class="el" href="lustre__dlm_8h_source.html#l00724">ldlm_lock::l_req_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00709">ldlm_lock::l_tree_node</a>, <a class="el" href="lustre__dlm_8h_source.html#l01209">ldlm_callback_suite::lcs_blocking</a>, <a class="el" href="lustre__dlm_8h_source.html#l01208">ldlm_callback_suite::lcs_completion</a>, <a class="el" href="lustre__dlm_8h_source.html#l01210">ldlm_callback_suite::lcs_glimpse</a>, <a class="el" href="packet-lustre_8c_source.html#l00299">LDLM_EXTENT</a>, <a class="el" href="ldlm__extent_8c_source.html#l00836">ldlm_interval_alloc()</a>, <a class="el" href="ldlm__lock_8c_source.html#l00403">ldlm_lock_destroy()</a>, <a class="el" href="ldlm__lock_8c_source.html#l00460">ldlm_lock_new()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01338">LDLM_LOCK_RELEASE</a>, <a class="el" href="ldlm__resource_8c_source.html#l01179">ldlm_resource_get()</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00345">ldlm_set_ns_srv</a>, <a class="el" href="lustre__dlm_8h_source.html#l00531">ns_is_server()</a>, <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00353">OBD_FAIL_LDLM_NEW_LOCK</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ldlm__request_8c_source.html#l00869">ldlm_cli_enqueue()</a>, <a class="el" href="ldlm__request_8c_source.html#l00415">ldlm_cli_enqueue_local()</a>, and <a class="el" href="ldlm__flock_8c_source.html#l00289">ldlm_process_flock_lock()</a>.</p>

</div>
</div>
<a class="anchor" id="a4f22b68aaaa93c8172302bd00c9095ae"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_decref_internal" ref="a4f22b68aaaa93c8172302bd00c9095ae" args="(struct ldlm_lock *lock, enum ldlm_mode mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldlm_lock_decref_internal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes reader/writer reference for LDLM lock <em>lock</em>. </p>
<p>Locks LDLM lock first. If the lock is determined to be client lock on a client and r/w refcount drops to zero and the lock is not blocked, the lock is added to LRU lock on the namespace. For blocked LDLM locks if r/w count drops to zero, blocking_ast is called. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00827">827</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__export_8h_source.html#l00330">exp_connect_cancelset()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00759">ldlm_lock::l_conn_export</a>, <a class="el" href="lustre__dlm_8h_source.html#l00754">ldlm_lock::l_export</a>, <a class="el" href="lustre__dlm_8h_source.html#l00784">ldlm_lock::l_readers</a>, <a class="el" href="lustre__dlm_8h_source.html#l00724">ldlm_lock::l_req_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00785">ldlm_lock::l_writers</a>, <a class="el" href="lustre__dlm_8h_source.html#l00616">LCF_ASYNC</a>, <a class="el" href="packet-lustre_8c_source.html#l00297">LCK_GROUP</a>, <a class="el" href="ldlm__lockd_8c_source.html#l02075">ldlm_bl_to_thread_lock()</a>, <a class="el" href="ldlm__request_8c_source.html#l01831">ldlm_cancel_lru()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01168">LDLM_DEBUG</a>, <a class="el" href="ldlm__lockd_8c_source.html#l01758">ldlm_handle_bl_callback()</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00259">ldlm_is_atomic_cb</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00271">ldlm_is_bl_ast</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00174">ldlm_is_cbpending</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00160">ldlm_is_fail_loc</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00210">ldlm_is_local</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00290">ldlm_is_no_lru</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00344">ldlm_is_ns_srv</a>, <a class="el" href="ldlm__lock_8c_source.html#l00298">ldlm_lock_add_to_lru()</a>, <a class="el" href="ldlm__lock_8c_source.html#l00800">ldlm_lock_decref_internal_nolock()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01344">LDLM_LOCK_GET</a>, <a class="el" href="ldlm__internal_8h_source.html#l00171">ldlm_lock_remove_from_lru</a>, <a class="el" href="lustre__dlm_8h_source.html#l01006">ldlm_lock_to_ns()</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00175">ldlm_set_cbpending</a>, <a class="el" href="l__lock_8c_source.html#l00051">lock_res_and_lock()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00553">ns_connect_lru_resize()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00518">ns_is_client()</a>, <a class="el" href="obd__support_8h_source.html#l00352">OBD_FAIL_LDLM_CP_BL_RACE</a>, <a class="el" href="obd__support_8h_source.html#l00627">OBD_RACE</a>, and <a class="el" href="l__lock_8c_source.html#l00067">unlock_res_and_lock()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__request_8c_source.html#l00491">failed_lock_cleanup()</a>, <a class="el" href="ldlm__lock_8c_source.html#l00903">ldlm_lock_decref()</a>, <a class="el" href="ldlm__lock_8c_source.html#l00918">ldlm_lock_decref_and_cancel()</a>, and <a class="el" href="ldlm__lock_8c_source.html#l01370">ldlm_lock_match()</a>.</p>

</div>
</div>
<a class="anchor" id="a813828f40b85a9dfd7094575cdb49a1b"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_decref_internal_nolock" ref="a813828f40b85a9dfd7094575cdb49a1b" args="(struct ldlm_lock *lock, enum ldlm_mode mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldlm_lock_decref_internal_nolock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes reader/writer reference for LDLM lock <em>lock</em>. </p>
<p>Assumes LDLM lock is already locked. only called in ldlm_flock_destroy and for local locks. Does NOT add lock to LRU if no r/w references left to accomodate flock locks that cannot be placed in LRU. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00800">800</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__dlm_8h_source.html#l00784">ldlm_lock::l_readers</a>, <a class="el" href="lustre__dlm_8h_source.html#l00885">ldlm_lock::l_reference</a>, <a class="el" href="lustre__dlm_8h_source.html#l00785">ldlm_lock::l_writers</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__idl_8h_source.html#l02805">LCK_COS</a>, <a class="el" href="packet-lustre_8c_source.html#l00295">LCK_CR</a>, <a class="el" href="packet-lustre_8c_source.html#l00294">LCK_CW</a>, <a class="el" href="packet-lustre_8c_source.html#l00291">LCK_EX</a>, <a class="el" href="packet-lustre_8c_source.html#l00297">LCK_GROUP</a>, <a class="el" href="packet-lustre_8c_source.html#l00296">LCK_NL</a>, <a class="el" href="packet-lustre_8c_source.html#l00293">LCK_PR</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="lustre__dlm_8h_source.html#l01168">LDLM_DEBUG</a>, <a class="el" href="lustre__dlm_8h_source.html#l01338">LDLM_LOCK_RELEASE</a>, <a class="el" href="ldlm__lock_8c_source.html#l00052">ldlm_lockname</a>, and <a class="el" href="lu__ref_8h_source.html#l00223">lu_ref_del()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__request_8c_source.html#l00491">failed_lock_cleanup()</a>, <a class="el" href="ldlm__flock_8c_source.html#l00133">ldlm_flock_destroy()</a>, and <a class="el" href="ldlm__lock_8c_source.html#l00827">ldlm_lock_decref_internal()</a>.</p>

</div>
</div>
<a class="anchor" id="af9f34c7a223ad572da0072d448e49021"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_destroy_internal" ref="af9f34c7a223ad572da0072d448e49021" args="(struct ldlm_lock *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ldlm_lock_destroy_internal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Helper to destroy a locked lock. </p>
<p>Used by ldlm_lock_destroy and ldlm_lock_destroy_nolock Must be called with l_lock and lr_lock held.</p>
<p>Does not actually free the lock data, but rather marks the lock as destroyed by setting l_destroyed field in the lock to 1. Destroys a handle-&gt;lock association too, so that the lock can no longer be found and removes the lock from LRU list. Actual lock freeing occurs when last lock reference goes away.</p>
<p>Original comment (of some historical value): This used to have a 'strict' flag, which recovery would use to mark an in-use lock as needing-to-die. Lest I am ever tempted to put it back, I shall explain why it's gone: with the new hash table scheme, once you call ldlm_lock_destroy, you can never drop your final references on this lock. Because it's not in the hash table anymore. -phil </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00352">352</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="hash_8c_source.html#l01291">cfs_hash_del()</a>, <a class="el" href="genops_8c_source.html#l00812">class_export_put()</a>, <a class="el" href="lustre__handles_8c_source.html#l00128">class_handle_unhash()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__export_8h_source.html#l00221">obd_export::exp_lock_hash</a>, <a class="el" href="lustre__dlm_8h_source.html#l00730">ldlm_lock::l_completion_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00714">ldlm_lock::l_exp_hash</a>, <a class="el" href="lustre__dlm_8h_source.html#l00754">ldlm_lock::l_export</a>, <a class="el" href="lustre__dlm_8h_source.html#l00678">ldlm_lock::l_handle</a>, <a class="el" href="lustre__dlm_8h_source.html#l00699">ldlm_lock::l_lru</a>, <a class="el" href="lustre__dlm_8h_source.html#l00784">ldlm_lock::l_readers</a>, <a class="el" href="lustre__dlm_8h_source.html#l00766">ldlm_lock::l_remote_handle</a>, <a class="el" href="lustre__dlm_8h_source.html#l00705">ldlm_lock::l_res_link</a>, <a class="el" href="lustre__dlm_8h_source.html#l00785">ldlm_lock::l_writers</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="lustre__dlm_8h_source.html#l01169">LDLM_ERROR</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00310">ldlm_is_destroyed</a>, <a class="el" href="ldlm__internal_8h_source.html#l00171">ldlm_lock_remove_from_lru</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00311">ldlm_set_destroyed</a>, and <a class="el" href="list_8h_source.html#l00161">list_empty()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l00403">ldlm_lock_destroy()</a>, and <a class="el" href="ldlm__lock_8c_source.html#l00422">ldlm_lock_destroy_nolock()</a>.</p>

</div>
</div>
<a class="anchor" id="a3c2af810ecacce9f1dbc9308e04b090b"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_destroy_nolock" ref="a3c2af810ecacce9f1dbc9308e04b090b" args="(struct ldlm_lock *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldlm_lock_destroy_nolock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destroys a LDLM lock <em>lock</em> that is already locked. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00422">422</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__dlm_8h_source.html#l00885">ldlm_lock::l_reference</a>, <a class="el" href="ldlm__lock_8c_source.html#l00352">ldlm_lock_destroy_internal()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01338">LDLM_LOCK_RELEASE</a>, and <a class="el" href="lu__ref_8h_source.html#l00223">lu_ref_del()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__request_8c_source.html#l00491">failed_lock_cleanup()</a>, <a class="el" href="ldlm__flock_8c_source.html#l00133">ldlm_flock_destroy()</a>, <a class="el" href="ldlm__lock_8c_source.html#l02249">ldlm_lock_cancel()</a>, <a class="el" href="ldlm__lock_8c_source.html#l01708">ldlm_lock_enqueue()</a>, and <a class="el" href="ldlm__flock_8c_source.html#l00289">ldlm_process_flock_lock()</a>.</p>

</div>
</div>
<a class="anchor" id="af677fb1f5f169d4d6f85254e41b359dd"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_enqueue" ref="af677fb1f5f169d4d6f85254e41b359dd" args="(struct ldlm_namespace *ns, struct ldlm_lock **lockp, void *cookie, __u64 *flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__LDLM.html#gaa2fbd012972eb2b2d0653c8df02964f7">ldlm_error</a> ldlm_lock_enqueue </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *&nbsp;</td>
          <td class="paramname"> <em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> **&nbsp;</td>
          <td class="paramname"> <em>lockp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>cookie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Enqueue (request) a lock. </p>
<p>Does not block. As a result of enqueue the lock would be put into granted or waiting list.</p>
<p>If namespace has intent policy sent and the lock has LDLM_FL_HAS_INTENT flag set, skip all the enqueueing and delegate lock processing to intent policy function. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01708">1708</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__dlm_8h_source.html#l00079">ELDLM_LOCK_REPLACED</a>, <a class="el" href="lustre__dlm_8h_source.html#l00074">ELDLM_OK</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="lustre__dlm_8h_source.html#l00778">ldlm_lock::l_flags</a>, <a class="el" href="lustre__dlm_8h_source.html#l00728">ldlm_lock::l_granted_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00724">ldlm_lock::l_req_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="lustre__dlm_8h_source.html#l00709">ldlm_lock::l_tree_node</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="packet-lustre_8c_source.html#l00299">LDLM_EXTENT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00151">LDLM_FL_AST_DISCARD_DATA</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00048">LDLM_FL_BLOCK_CONV</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00040">LDLM_FL_BLOCK_GRANTED</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00056">LDLM_FL_BLOCK_WAIT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00370">LDLM_FL_BLOCKED_MASK</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00361">LDLM_FL_COS_ENABLED</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00136">LDLM_FL_COS_INCOMPAT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00082">LDLM_FL_HAS_INTENT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00076">LDLM_FL_INTENT_ONLY</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00032">LDLM_FL_LOCK_CHANGED</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00100">LDLM_FL_NO_TIMEOUT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00070">LDLM_FL_REPLAY</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00355">LDLM_FL_RESENT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00114">LDLM_FL_TEST_LOCK</a>, <a class="el" href="ldlm__lock_8c_source.html#l01101">ldlm_grant_lock()</a>, <a class="el" href="ldlm__extent_8c_source.html#l00861">ldlm_interval_attach()</a>, <a class="el" href="ldlm__extent_8c_source.html#l00835">ldlm_interval_slab</a>, <a class="el" href="ldlm__lock_8c_source.html#l00403">ldlm_lock_destroy()</a>, <a class="el" href="ldlm__lock_8c_source.html#l00422">ldlm_lock_destroy_nolock()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01338">LDLM_LOCK_RELEASE</a>, <a class="el" href="lustre__dlm_8h_source.html#l01000">ldlm_res_to_ns()</a>, <a class="el" href="ldlm__resource_8c_source.html#l01323">ldlm_resource_add_lock()</a>, <a class="el" href="ldlm__resource_8c_source.html#l01366">ldlm_resource_unlink_lock()</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00153">ldlm_set_ast_discard_data</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00363">ldlm_set_cos_enabled</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00138">ldlm_set_cos_incompat</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00116">ldlm_set_test_lock</a>, <a class="el" href="lustre__dlm_8h_source.html#l00593">ldlm_interval::li_group</a>, <a class="el" href="l__lock_8c_source.html#l00051">lock_res_and_lock()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00943">ldlm_resource::lr_converting</a>, <a class="el" href="lustre__dlm_8h_source.html#l00970">ldlm_resource::lr_type</a>, <a class="el" href="lustre__dlm_8h_source.html#l00947">ldlm_resource::lr_waiting</a>, <a class="el" href="lustre__dlm_8h_source.html#l00518">ns_is_client()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00446">ldlm_namespace::ns_policy</a>, <a class="el" href="obd__support_8h_source.html#l00851">OBD_SLAB_ALLOC_PTR_GFP</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ldlm__request_8c_source.html#l00541">ldlm_cli_enqueue_fini()</a>, and <a class="el" href="ldlm__request_8c_source.html#l00415">ldlm_cli_enqueue_local()</a>.</p>

</div>
</div>
<a class="anchor" id="ac99ac7b91d3210a55c99a1247cb85003"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_new" ref="ac99ac7b91d3210a55c99a1247cb85003" args="(struct ldlm_resource *resource)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structldlm__lock.html">ldlm_lock</a>* ldlm_lock_new </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *&nbsp;</td>
          <td class="paramname"> <em>resource</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocate and initialize new lock structure. </p>
<p>usage: pass in a resource on which you have done ldlm_resource_get new lock will take over the refcount. returns: lock with refcount 2 - one for current caller and one for remote </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00460">460</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__handles_8c_source.html#l00064">class_handle_hash()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__handles_8h_source.html#l00066">portals_handle::h_link</a>, <a class="el" href="list_8h_source.html#l00316">INIT_HLIST_NODE</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="lustre__dlm_8h_source.html#l00865">ldlm_lock::l_bl_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00875">ldlm_lock::l_blocking_lock</a>, <a class="el" href="lustre__dlm_8h_source.html#l00852">ldlm_lock::l_callback_timeout</a>, <a class="el" href="lustre__dlm_8h_source.html#l00867">ldlm_lock::l_cp_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00719">ldlm_lock::l_exp_flock_hash</a>, <a class="el" href="lustre__dlm_8h_source.html#l00714">ldlm_lock::l_exp_hash</a>, <a class="el" href="lustre__dlm_8h_source.html#l00901">ldlm_lock::l_exp_list</a>, <a class="el" href="lustre__dlm_8h_source.html#l00678">ldlm_lock::l_handle</a>, <a class="el" href="lustre__dlm_8h_source.html#l00689">ldlm_lock::l_lock</a>, <a class="el" href="lustre__dlm_8h_source.html#l00699">ldlm_lock::l_lru</a>, <a class="el" href="lustre__dlm_8h_source.html#l00843">ldlm_lock::l_pending_chain</a>, <a class="el" href="lustre__dlm_8h_source.html#l00684">ldlm_lock::l_refc</a>, <a class="el" href="lustre__dlm_8h_source.html#l00885">ldlm_lock::l_reference</a>, <a class="el" href="lustre__dlm_8h_source.html#l00705">ldlm_lock::l_res_link</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="lustre__dlm_8h_source.html#l00869">ldlm_lock::l_rk_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00881">ldlm_lock::l_sl_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00882">ldlm_lock::l_sl_policy</a>, <a class="el" href="lustre__dlm_8h_source.html#l00791">ldlm_lock::l_waitq</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="ldlm__resource_8c_source.html#l00048">ldlm_lock_slab</a>, <a class="el" href="lustre__dlm_8h_source.html#l00334">LDLM_NSS_LOCKS</a>, <a class="el" href="lustre__dlm_8h_source.html#l01000">ldlm_res_to_ns()</a>, <a class="el" href="lprocfs__status_8h_source.html#l00869">lprocfs_counter_incr()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00984">ldlm_resource::lr_reference</a>, <a class="el" href="lu__ref_8h_source.html#l00204">lu_ref_add()</a>, <a class="el" href="lu__ref_8h_source.html#l00196">lu_ref_init()</a>, <a class="el" href="obd__support_8h_source.html#l00851">OBD_SLAB_ALLOC_PTR_GFP</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l01641">ldlm_lock_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a7cd4f877866749dceb72ca5c7b0c8e36"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_remove_from_lru_check" ref="a7cd4f877866749dceb72ca5c7b0c8e36" args="(struct ldlm_lock *lock, cfs_time_t last_use)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ldlm_lock_remove_from_lru_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="linux-time_8h.html#a0e81d053bc8d925f6574c760bbea5ac4">cfs_time_t</a>&nbsp;</td>
          <td class="paramname"> <em>last_use</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes LDLM lock <em>lock</em> from LRU. </p>
<p>Obtains the LRU lock first.</p>
<p>If <em>last_use</em> is non-zero, it will remove the lock from LRU only if it matches lock's l_last_used.</p>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if <em>last_use</em> is set, the lock is not in LRU list or <em>last_use</em> doesn't match lock's l_last_used; otherwise, the lock hasn't been in the LRU list. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>the lock was in LRU list and removed. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00259">259</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__dlm_8h_source.html#l00803">ldlm_lock::l_last_used</a>, <a class="el" href="lustre__dlm_8h_source.html#l00699">ldlm_lock::l_lru</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00344">ldlm_is_ns_srv</a>, <a class="el" href="ldlm__lock_8c_source.html#l00233">ldlm_lock_remove_from_lru_nolock()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01006">ldlm_lock_to_ns()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00380">ldlm_namespace::ns_lock</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ldlm__request_8c_source.html#l01669">ldlm_prepare_lru_list()</a>.</p>

</div>
</div>
<a class="anchor" id="aa905e3097901c0a7bb2744fdd8668e57"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_remove_from_lru_nolock" ref="aa905e3097901c0a7bb2744fdd8668e57" args="(struct ldlm_lock *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ldlm_lock_remove_from_lru_nolock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes LDLM lock <em>lock</em> from LRU. </p>
<p>Assumes LRU is already locked. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00233">233</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__dlm_8h_source.html#l00699">ldlm_lock::l_lru</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="packet-lustre_8c_source.html#l00300">LDLM_FLOCK</a>, <a class="el" href="lustre__dlm_8h_source.html#l01006">ldlm_lock_to_ns()</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00970">ldlm_resource::lr_type</a>, and <a class="el" href="lustre__dlm_8h_source.html#l00415">ldlm_namespace::ns_nr_unused</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l00259">ldlm_lock_remove_from_lru_check()</a>, <a class="el" href="ldlm__lock_8c_source.html#l00313">ldlm_lock_touch_in_lru()</a>, and <a class="el" href="ldlm__request_8c_source.html#l01669">ldlm_prepare_lru_list()</a>.</p>

</div>
</div>
<a class="anchor" id="ab2b695dcf2e2be0bbfa73c8fc7eef92a"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_touch_in_lru" ref="ab2b695dcf2e2be0bbfa73c8fc7eef92a" args="(struct ldlm_lock *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldlm_lock_touch_in_lru </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Moves LDLM lock <em>lock</em> that is already in namespace LRU to the tail of the LRU. </p>
<p>Performs necessary LRU locking </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00313">313</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__dlm_8h_source.html#l00699">ldlm_lock::l_lru</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00344">ldlm_is_ns_srv</a>, <a class="el" href="ldlm__lock_8c_source.html#l00281">ldlm_lock_add_to_lru_nolock()</a>, <a class="el" href="ldlm__lock_8c_source.html#l00233">ldlm_lock_remove_from_lru_nolock()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01006">ldlm_lock_to_ns()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, and <a class="el" href="lustre__dlm_8h_source.html#l00380">ldlm_namespace::ns_lock</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l01154">lock_matches()</a>.</p>

</div>
</div>
<a class="anchor" id="a343f0324fd5028808e6bfedc30421374"></a><!-- doxytag: member="ldlm_lock.c::ldlm_reprocess_res" ref="a343f0324fd5028808e6bfedc30421374" args="(struct cfs_hash *hs, struct cfs_hash_bd *bd, struct hlist_node *hnode, void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ldlm_reprocess_res </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcfs__hash.html">cfs_hash</a> *&nbsp;</td>
          <td class="paramname"> <em>hs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcfs__hash__bd.html">cfs_hash_bd</a> *&nbsp;</td>
          <td class="paramname"> <em>bd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structhlist__node.html">hlist_node</a> *&nbsp;</td>
          <td class="paramname"> <em>hnode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>arg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l02113">2113</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="libcfs__hash_8h_source.html#l00482">cfs_hash_object()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01181">LDLM_ITER_STOP</a>, and <a class="el" href="ldlm__lock_8c_source.html#l02107">reprocess_one_queue()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l02128">ldlm_reprocess_all_ns()</a>.</p>

</div>
</div>
<a class="anchor" id="a825464ac0dd43ec4bce6013052cd1a30"></a><!-- doxytag: member="ldlm_lock.c::ldlm_run_ast_work" ref="a825464ac0dd43ec4bce6013052cd1a30" args="(struct ldlm_namespace *ns, struct list_head *rpc_list, ldlm_desc_ast_t ast_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ldlm_run_ast_work </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *&nbsp;</td>
          <td class="paramname"> <em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlist__head.html">list_head</a> *&nbsp;</td>
          <td class="paramname"> <em>rpc_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ldlm__internal_8h.html#ab2beeaa64c7143ab8c4b9f89b522a312">ldlm_desc_ast_t</a>&nbsp;</td>
          <td class="paramname"> <em>ast_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process list of locks in need of ASTs being sent. </p>
<p>Used on server to send multiple ASTs together instead of sending one by one. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l02050">2050</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="packet-lustre_8c_source.html#l00287">LDLM_BL_CALLBACK</a>, <a class="el" href="packet-lustre_8c_source.html#l00288">LDLM_CP_CALLBACK</a>, <a class="el" href="packet-lustre_8c_source.html#l00289">LDLM_GL_CALLBACK</a>, <a class="el" href="ldlm__internal_8h_source.html#l00140">LDLM_WORK_BL_AST</a>, <a class="el" href="ldlm__lock_8c_source.html#l01902">ldlm_work_bl_ast_lock()</a>, <a class="el" href="ldlm__internal_8h_source.html#l00141">LDLM_WORK_CP_AST</a>, <a class="el" href="ldlm__lock_8c_source.html#l01939">ldlm_work_cp_ast_lock()</a>, <a class="el" href="ldlm__internal_8h_source.html#l00143">LDLM_WORK_GL_AST</a>, <a class="el" href="ldlm__lock_8c_source.html#l02012">ldlm_work_gl_ast_lock()</a>, <a class="el" href="ldlm__internal_8h_source.html#l00142">LDLM_WORK_REVOKE_AST</a>, <a class="el" href="ldlm__lock_8c_source.html#l01984">ldlm_work_revoke_ast_lock()</a>, <a class="el" href="ldlm__internal_8h_source.html#l00135">ldlm_cb_set_arg::list</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00492">ldlm_namespace::ns_max_parallel_ast</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="client_8c_source.html#l00948">ptlrpc_prep_fcset()</a>, <a class="el" href="client_8c_source.html#l00973">ptlrpc_set_destroy()</a>, <a class="el" href="client_8c_source.html#l02260">ptlrpc_set_wait()</a>, <a class="el" href="ldlm__internal_8h_source.html#l00134">ldlm_cb_set_arg::restart</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="ldlm__internal_8h_source.html#l00132">ldlm_cb_set_arg::set</a>, and <a class="el" href="ldlm__internal_8h_source.html#l00133">ldlm_cb_set_arg::type</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lockd_8c_source.html#l01796">ldlm_handle_cp_callback()</a>, <a class="el" href="ldlm__flock_8c_source.html#l00289">ldlm_process_flock_lock()</a>, and <a class="el" href="ldlm__lock_8c_source.html#l02147">ldlm_reprocess_all()</a>.</p>

</div>
</div>
<a class="anchor" id="a4b704d0518e64bbf3c1815b4bb1c6ba6"></a><!-- doxytag: member="ldlm_lock.c::ldlm_work_bl_ast_lock" ref="a4b704d0518e64bbf3c1815b4bb1c6ba6" args="(struct ptlrpc_request_set *rqset, void *opaq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ldlm_work_bl_ast_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request__set.html">ptlrpc_request_set</a> *&nbsp;</td>
          <td class="paramname"> <em>rqset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>opaq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process a call to blocking AST callback for a lock in ast_work list. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01902">1902</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__dlm_8h_source.html#l00865">ldlm_lock::l_bl_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00863">ldlm_lock::l_bl_ast_run</a>, <a class="el" href="lustre__dlm_8h_source.html#l00741">ldlm_lock::l_blocking_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00875">ldlm_lock::l_blocking_lock</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__dlm_8h_source.html#l00103">LDLM_CB_BLOCKING</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00063">ldlm_is_ast_sent</a>, <a class="el" href="ldlm__lock_8c_source.html#l00646">ldlm_lock2desc()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01338">LDLM_LOCK_RELEASE</a>, <a class="el" href="ldlm__internal_8h_source.html#l00135">ldlm_cb_set_arg::list</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="list_8h_source.html#l00242">list_entry</a>, <a class="el" href="l__lock_8c_source.html#l00051">lock_res_and_lock()</a>, <a class="el" href="list_8h_source.html#l00043">list_head::next</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="l__lock_8c_source.html#l00067">unlock_res_and_lock()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l02050">ldlm_run_ast_work()</a>.</p>

</div>
</div>
<a class="anchor" id="a41414c0cf9fe6b7650866733df35e9ac"></a><!-- doxytag: member="ldlm_lock.c::ldlm_work_cp_ast_lock" ref="a41414c0cf9fe6b7650866733df35e9ac" args="(struct ptlrpc_request_set *rqset, void *opaq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ldlm_work_cp_ast_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request__set.html">ptlrpc_request_set</a> *&nbsp;</td>
          <td class="paramname"> <em>rqset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>opaq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process a call to completion AST callback for a lock in ast_work list. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01939">1939</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__dlm_8h_source.html#l00730">ldlm_lock::l_completion_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00867">ldlm_lock::l_cp_ast</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00247">ldlm_clear_cp_reqd</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00245">ldlm_is_cp_reqd</a>, <a class="el" href="lustre__dlm_8h_source.html#l01338">LDLM_LOCK_RELEASE</a>, <a class="el" href="ldlm__internal_8h_source.html#l00135">ldlm_cb_set_arg::list</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="list_8h_source.html#l00242">list_entry</a>, <a class="el" href="l__lock_8c_source.html#l00051">lock_res_and_lock()</a>, <a class="el" href="list_8h_source.html#l00043">list_head::next</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="l__lock_8c_source.html#l00067">unlock_res_and_lock()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l02050">ldlm_run_ast_work()</a>.</p>

</div>
</div>
<a class="anchor" id="afa16fd0c6f6dcd2514b6c529e58fa402"></a><!-- doxytag: member="ldlm_lock.c::ldlm_work_gl_ast_lock" ref="afa16fd0c6f6dcd2514b6c529e58fa402" args="(struct ptlrpc_request_set *rqset, void *opaq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ldlm_work_gl_ast_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request__set.html">ptlrpc_request_set</a> *&nbsp;</td>
          <td class="paramname"> <em>rqset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>opaq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process a call to glimpse AST callback for a lock in ast_work list. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l02012">2012</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__dlm_8h_source.html#l00583">ldlm_glimpse_work::gl_desc</a>, <a class="el" href="ldlm__internal_8h_source.html#l00136">ldlm_cb_set_arg::gl_desc</a>, <a class="el" href="lustre__dlm_8h_source.html#l00582">ldlm_glimpse_work::gl_flags</a>, <a class="el" href="lustre__dlm_8h_source.html#l00581">ldlm_glimpse_work::gl_list</a>, <a class="el" href="lustre__dlm_8h_source.html#l00580">ldlm_glimpse_work::gl_lock</a>, <a class="el" href="lustre__dlm_8h_source.html#l00747">ldlm_lock::l_glimpse_ast</a>, <a class="el" href="lustre__dlm_8h_source.html#l00588">LDLM_GL_WORK_NOFREE</a>, <a class="el" href="lustre__dlm_8h_source.html#l01338">LDLM_LOCK_RELEASE</a>, <a class="el" href="ldlm__internal_8h_source.html#l00135">ldlm_cb_set_arg::list</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="list_8h_source.html#l00242">list_entry</a>, <a class="el" href="list_8h_source.html#l00043">list_head::next</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l02050">ldlm_run_ast_work()</a>.</p>

</div>
</div>
<a class="anchor" id="a09883fabdcc6784fab13873bef1e02ef"></a><!-- doxytag: member="ldlm_lock.c::ldlm_work_revoke_ast_lock" ref="a09883fabdcc6784fab13873bef1e02ef" args="(struct ptlrpc_request_set *rqset, void *opaq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ldlm_work_revoke_ast_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request__set.html">ptlrpc_request_set</a> *&nbsp;</td>
          <td class="paramname"> <em>rqset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>opaq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process a call to revocation AST callback for a lock in ast_work list. </p>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01984">1984</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__dlm_8h_source.html#l00741">ldlm_lock::l_blocking_ast</a>, <a class="el" href="lustre__idl_8h_source.html#l02899">ldlm_lock_desc::l_granted_mode</a>, <a class="el" href="lustre__idl_8h_source.html#l02898">ldlm_lock_desc::l_req_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00869">ldlm_lock::l_rk_ast</a>, <a class="el" href="packet-lustre_8c_source.html#l00291">LCK_EX</a>, <a class="el" href="lustre__dlm_8h_source.html#l00103">LDLM_CB_BLOCKING</a>, <a class="el" href="ldlm__lock_8c_source.html#l00646">ldlm_lock2desc()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01338">LDLM_LOCK_RELEASE</a>, <a class="el" href="ldlm__internal_8h_source.html#l00135">ldlm_cb_set_arg::list</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="list_8h_source.html#l00242">list_entry</a>, <a class="el" href="list_8h_source.html#l00043">list_head::next</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l02050">ldlm_run_ast_work()</a>.</p>

</div>
</div>
<a class="anchor" id="ac3f738873bd4ebf596bcf9eea2acddf8"></a><!-- doxytag: member="ldlm_lock.c::lock_handle_addref" ref="ac3f738873bd4ebf596bcf9eea2acddf8" args="(void *lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void lock_handle_addref </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>lock</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00436">436</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__dlm_8h_source.html#l01344">LDLM_LOCK_GET</a>.</p>

</div>
</div>
<a class="anchor" id="a64a3343334a2f0e07acbfebbb6e8ba38"></a><!-- doxytag: member="ldlm_lock.c::lock_handle_free" ref="a64a3343334a2f0e07acbfebbb6e8ba38" args="(void *lock, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void lock_handle_free </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00441">441</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="ldlm__resource_8c_source.html#l00048">ldlm_lock_slab</a>, and <a class="el" href="obd__support_8h_source.html#l00832">OBD_SLAB_FREE</a>.</p>

</div>
</div>
<a class="anchor" id="a66232614560bc48aea0fdffd6acdc7aa"></a><!-- doxytag: member="ldlm_lock.c::lock_matches" ref="a66232614560bc48aea0fdffd6acdc7aa" args="(struct ldlm_lock *lock, struct lock_match_data *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int lock_matches </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlock__match__data.html">lock_match_data</a> *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check if the given  meets the criteria for a match. </p>
<p>A reference on the lock is taken if matched.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>lock</em>&nbsp;</td><td>test-against this lock </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>parameters </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01154">1154</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l02841">ldlm_inodebits::bits</a>, <a class="el" href="lustre__idl_8h_source.html#l02823">ldlm_extent::end</a>, <a class="el" href="osd__iam_8h_source.html#l00059">equi</a>, <a class="el" href="lustre__idl_8h_source.html#l02824">ldlm_extent::gid</a>, <a class="el" href="interval__tree_8h_source.html#l00061">INTERVAL_ITER_CONT</a>, <a class="el" href="interval__tree_8h_source.html#l00062">INTERVAL_ITER_STOP</a>, <a class="el" href="lustre__dlm_8h_source.html#l00633">ldlm_policy_data::l_extent</a>, <a class="el" href="lustre__dlm_8h_source.html#l00635">ldlm_policy_data::l_inodebits</a>, <a class="el" href="lustre__dlm_8h_source.html#l00772">ldlm_lock::l_policy_data</a>, <a class="el" href="lustre__dlm_8h_source.html#l00784">ldlm_lock::l_readers</a>, <a class="el" href="lustre__dlm_8h_source.html#l00724">ldlm_lock::l_req_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="lustre__dlm_8h_source.html#l00785">ldlm_lock::l_writers</a>, <a class="el" href="packet-lustre_8c_source.html#l00297">LCK_GROUP</a>, <a class="el" href="packet-lustre_8c_source.html#l00299">LDLM_EXTENT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00173">LDLM_FL_CBPENDING</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00191">LDLM_FL_LOCAL_ONLY</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00114">LDLM_FL_TEST_LOCK</a>, <a class="el" href="lustre__dlm_8h_source.html#l00655">LDLM_GID_ANY</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00396">LDLM_HAVE_MASK</a>, <a class="el" href="packet-lustre_8c_source.html#l00301">LDLM_IBITS</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00174">ldlm_is_cbpending</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00350">ldlm_is_excl</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00210">ldlm_is_local</a>, <a class="el" href="ldlm__lock_8c_source.html#l00735">ldlm_lock_addref_internal_nolock()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01344">LDLM_LOCK_GET</a>, <a class="el" href="ldlm__lock_8c_source.html#l00313">ldlm_lock_touch_in_lru()</a>, <a class="el" href="ldlm__lock_8c_source.html#l01143">lock_match_data::lmd_flags</a>, <a class="el" href="ldlm__lock_8c_source.html#l01140">lock_match_data::lmd_lock</a>, <a class="el" href="ldlm__lock_8c_source.html#l01139">lock_match_data::lmd_old</a>, <a class="el" href="ldlm__lock_8c_source.html#l01142">lock_match_data::lmd_policy</a>, <a class="el" href="ldlm__lock_8c_source.html#l01144">lock_match_data::lmd_unref</a>, <a class="el" href="lustre__dlm_8h_source.html#l00970">ldlm_resource::lr_type</a>, <a class="el" href="lustre__idl_8h_source.html#l02822">ldlm_extent::start</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l01228">itree_overlap_cb()</a>, and <a class="el" href="ldlm__lock_8c_source.html#l01284">search_queue()</a>.</p>

</div>
</div>
<a class="anchor" id="af90d2f3d6d37683b8d53428602a13add"></a><!-- doxytag: member="ldlm_lock.c::reprocess_one_queue" ref="af90d2f3d6d37683b8d53428602a13add" args="(struct ldlm_resource *res, void *closure)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int reprocess_one_queue </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *&nbsp;</td>
          <td class="paramname"> <em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>closure</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l02107">2107</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__dlm_8h_source.html#l01180">LDLM_ITER_CONTINUE</a>, and <a class="el" href="ldlm__lock_8c_source.html#l02147">ldlm_reprocess_all()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l02113">ldlm_reprocess_res()</a>.</p>

</div>
</div>
<a class="anchor" id="aeb69bf6ae74acb71ba3b2fcca0f5f5b7"></a><!-- doxytag: member="ldlm_lock.c::search_granted_lock" ref="aeb69bf6ae74acb71ba3b2fcca0f5f5b7" args="(struct list_head *queue, struct ldlm_lock *req, struct sl_insert_point *prev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void search_granted_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlist__head.html">list_head</a> *&nbsp;</td>
          <td class="paramname"> <em>queue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsl__insert__point.html">sl_insert_point</a> *&nbsp;</td>
          <td class="paramname"> <em>prev</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Finds a position to insert the new lock into granted lock list. </p>
<p>Used for locks eligible for skiplist optimization.</p>
<p>Parameters: queue [input]: the granted list where search acts on; req [input]: the lock whose position to be located; prev [output]: positions within 3 lists to insert  to Return Value: filled  NOTE: called by</p>
<ul>
<li>ldlm_grant_lock_with_skiplist </li>
</ul>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00955">955</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l02841">ldlm_inodebits::bits</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__dlm_8h_source.html#l00635">ldlm_policy_data::l_inodebits</a>, <a class="el" href="lustre__dlm_8h_source.html#l00772">ldlm_lock::l_policy_data</a>, <a class="el" href="lustre__dlm_8h_source.html#l00724">ldlm_lock::l_req_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00705">ldlm_lock::l_res_link</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="lustre__dlm_8h_source.html#l00881">ldlm_lock::l_sl_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00882">ldlm_lock::l_sl_policy</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="lustre__dlm_8h_source.html#l01169">LDLM_ERROR</a>, <a class="el" href="packet-lustre_8c_source.html#l00301">LDLM_IBITS</a>, <a class="el" href="packet-lustre_8c_source.html#l00298">LDLM_PLAIN</a>, <a class="el" href="list_8h_source.html#l00242">list_entry</a>, <a class="el" href="list_8h_source.html#l00253">list_for_each</a>, <a class="el" href="lustre__dlm_8h_source.html#l00970">ldlm_resource::lr_type</a>, <a class="el" href="ldlm__lock_8c_source.html#l00937">sl_insert_point::mode_link</a>, <a class="el" href="list_8h_source.html#l00043">list_head::next</a>, <a class="el" href="ldlm__lock_8c_source.html#l00938">sl_insert_point::policy_link</a>, <a class="el" href="list_8h_source.html#l00043">list_head::prev</a>, and <a class="el" href="ldlm__lock_8c_source.html#l00936">sl_insert_point::res_link</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l01078">ldlm_grant_lock_with_skiplist()</a>.</p>

</div>
</div>
<a class="anchor" id="a4522443228468829f7c91226214f4fc6"></a><!-- doxytag: member="ldlm_lock.c::search_itree" ref="a4522443228468829f7c91226214f4fc6" args="(struct ldlm_resource *res, struct lock_match_data *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structldlm__lock.html">ldlm_lock</a>* search_itree </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__resource.html">ldlm_resource</a> *&nbsp;</td>
          <td class="paramname"> <em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlock__match__data.html">lock_match_data</a> *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Search for a lock with given parameters in interval trees. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>res</em>&nbsp;</td><td>search for a lock in this resource </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>parameters</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>referenced lock or NULL. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01251">1251</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l02823">ldlm_extent::end</a>, <a class="el" href="interval__tree_8c_source.html#l00625">interval_search()</a>, <a class="el" href="ldlm__lock_8c_source.html#l01228">itree_overlap_cb()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00633">ldlm_policy_data::l_extent</a>, <a class="el" href="lustre__idl_8h_source.html#l02809">LCK_MODE_NUM</a>, <a class="el" href="lustre__dlm_8h_source.html#l00607">ldlm_interval_tree::lit_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00608">ldlm_interval_tree::lit_root</a>, <a class="el" href="ldlm__lock_8c_source.html#l01140">lock_match_data::lmd_lock</a>, <a class="el" href="ldlm__lock_8c_source.html#l01142">lock_match_data::lmd_policy</a>, <a class="el" href="lustre__dlm_8h_source.html#l00956">ldlm_resource::lr_itree</a>, and <a class="el" href="lustre__idl_8h_source.html#l02822">ldlm_extent::start</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l01370">ldlm_lock_match()</a>.</p>

</div>
</div>
<a class="anchor" id="a12474ad482f44011830f1cd01720840f"></a><!-- doxytag: member="ldlm_lock.c::search_queue" ref="a12474ad482f44011830f1cd01720840f" args="(struct list_head *queue, struct lock_match_data *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structldlm__lock.html">ldlm_lock</a>* search_queue </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlist__head.html">list_head</a> *&nbsp;</td>
          <td class="paramname"> <em>queue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlock__match__data.html">lock_match_data</a> *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Search for a lock with given properties in a queue. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>queue</em>&nbsp;</td><td>search for a lock in this queue </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>parameters</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>referenced lock or NULL. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l01284">1284</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>References <a class="el" href="interval__tree_8h_source.html#l00062">INTERVAL_ITER_STOP</a>, <a class="el" href="lustre__dlm_8h_source.html#l00705">ldlm_lock::l_res_link</a>, <a class="el" href="list_8h_source.html#l00459">list_for_each_entry</a>, <a class="el" href="ldlm__lock_8c_source.html#l01140">lock_match_data::lmd_lock</a>, and <a class="el" href="ldlm__lock_8c_source.html#l01154">lock_matches()</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l01370">ldlm_lock_match()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ab042af710154778086ba81ee05d69fd1"></a><!-- doxytag: member="ldlm_lock.c::ldlm_lock_slab" ref="ab042af710154778086ba81ee05d69fd1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kmem_cache* <a class="el" href="ldlm__resource_8c.html#a0ae39e5722c7234b717cc6ac1ce34859">ldlm_lock_slab</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ldlm__resource_8c_source.html#l00048">48</a> of file <a class="el" href="ldlm__resource_8c_source.html">ldlm_resource.c</a>.</p>

</div>
</div>
<a class="anchor" id="a904b44197a69432fcc17951b555da7b7"></a><!-- doxytag: member="ldlm_lock.c::ldlm_policy_local_to_wire" ref="a904b44197a69432fcc17951b555da7b7" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ldlm__internal_8h.html#ac5a58c3780ace731df7cd203849c4e8b">ldlm_policy_local_to_wire_t</a> <a class="el" href="ldlm__lock_8c.html#a904b44197a69432fcc17951b555da7b7">ldlm_policy_local_to_wire</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        [<a class="code" href="packet-lustre_8c.html#ac4397f44dbf94f69e645b89d4bcf3772">LDLM_PLAIN</a> - <a class="code" href="group__lustreidl.html#ga47054888fecf3154752fe78a3f2e7307">LDLM_MIN_TYPE</a>]  = <a class="code" href="ldlm__internal_8h.html#a7b7396bcef072482a5b4229cb7c792c8">ldlm_plain_policy_local_to_wire</a>,
        [<a class="code" href="packet-lustre_8c.html#ab92227eb33b3bc79ee12e10421865cad">LDLM_EXTENT</a> - <a class="code" href="group__lustreidl.html#ga47054888fecf3154752fe78a3f2e7307">LDLM_MIN_TYPE</a>] = <a class="code" href="ldlm__extent_8c.html#a7f8c1e8dc924f1cc869225f16d8b7176">ldlm_extent_policy_local_to_wire</a>,
        [<a class="code" href="packet-lustre_8c.html#a14b95988a3dcd429fb3a2e85dc317a2c">LDLM_FLOCK</a> - <a class="code" href="group__lustreidl.html#ga47054888fecf3154752fe78a3f2e7307">LDLM_MIN_TYPE</a>]  = <a class="code" href="ldlm__flock_8c.html#a97967bbb20eeada0b527c658f13b2214">ldlm_flock_policy_local_to_wire</a>,
        [<a class="code" href="packet-lustre_8c.html#afca8e3fd80560e42cd0c6013d34af412">LDLM_IBITS</a> - <a class="code" href="group__lustreidl.html#ga47054888fecf3154752fe78a3f2e7307">LDLM_MIN_TYPE</a>]  = <a class="code" href="ldlm__inodebits_8c.html#ac2e07922511e49494eb7bca0714c273a">ldlm_ibits_policy_local_to_wire</a>,
}
</pre></div>
<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00079">79</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l00089">ldlm_convert_policy_to_wire()</a>.</p>

</div>
</div>
<a class="anchor" id="a0d2ee6fe4b99f15e3c7b5b9a455167bf"></a><!-- doxytag: member="ldlm_lock.c::ldlm_policy_wire_to_local" ref="a0d2ee6fe4b99f15e3c7b5b9a455167bf" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ldlm__internal_8h.html#a6b491ba3392406b93a373c028ffc4ded">ldlm_policy_wire_to_local_t</a> <a class="el" href="ldlm__lock_8c.html#a0d2ee6fe4b99f15e3c7b5b9a455167bf">ldlm_policy_wire_to_local</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        [<a class="code" href="packet-lustre_8c.html#ac4397f44dbf94f69e645b89d4bcf3772">LDLM_PLAIN</a> - <a class="code" href="group__lustreidl.html#ga47054888fecf3154752fe78a3f2e7307">LDLM_MIN_TYPE</a>]  = <a class="code" href="ldlm__internal_8h.html#a2dc00ec9abd000a9ac324e89b3837361">ldlm_plain_policy_wire_to_local</a>,
        [<a class="code" href="packet-lustre_8c.html#ab92227eb33b3bc79ee12e10421865cad">LDLM_EXTENT</a> - <a class="code" href="group__lustreidl.html#ga47054888fecf3154752fe78a3f2e7307">LDLM_MIN_TYPE</a>] = <a class="code" href="ldlm__extent_8c.html#a658c02d498ad30c13fa1fb888348e9fe">ldlm_extent_policy_wire_to_local</a>,
        [<a class="code" href="packet-lustre_8c.html#a14b95988a3dcd429fb3a2e85dc317a2c">LDLM_FLOCK</a> - <a class="code" href="group__lustreidl.html#ga47054888fecf3154752fe78a3f2e7307">LDLM_MIN_TYPE</a>]  = <a class="code" href="ldlm__flock_8c.html#af1d5630a4d3ecdb282caccb56d520e89">ldlm_flock_policy_wire_to_local</a>,
        [<a class="code" href="packet-lustre_8c.html#afca8e3fd80560e42cd0c6013d34af412">LDLM_IBITS</a> - <a class="code" href="group__lustreidl.html#ga47054888fecf3154752fe78a3f2e7307">LDLM_MIN_TYPE</a>]  = <a class="code" href="ldlm__inodebits_8c.html#a1a4d134988f8e0bca90f8e6ca17f3542">ldlm_ibits_policy_wire_to_local</a>,
}
</pre></div>
<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00072">72</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

<p>Referenced by <a class="el" href="ldlm__lock_8c_source.html#l00103">ldlm_convert_policy_to_local()</a>.</p>

</div>
</div>
<a class="anchor" id="a3e72e682cdfc37de37090fb9ace14586"></a><!-- doxytag: member="ldlm_lock.c::lock_handle_ops" ref="a3e72e682cdfc37de37090fb9ace14586" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structportals__handle__ops.html">portals_handle_ops</a> <a class="el" href="ldlm__lock_8c.html#a3e72e682cdfc37de37090fb9ace14586">lock_handle_ops</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .hop_addref = <a class="code" href="ldlm__lock_8c.html#ac3f738873bd4ebf596bcf9eea2acddf8">lock_handle_addref</a>,
        .hop_free   = <a class="code" href="ldlm__lock_8c.html#a64a3343334a2f0e07acbfebbb6e8ba38">lock_handle_free</a>,
}
</pre></div>
<p>Definition at line <a class="el" href="ldlm__lock_8c_source.html#l00447">447</a> of file <a class="el" href="ldlm__lock_8c_source.html">ldlm_lock.c</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:47 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
