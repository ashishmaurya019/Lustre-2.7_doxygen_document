<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/ptlrpc/nrs_fifo.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/ptlrpc/nrs_fifo.c File Reference</h1><code>#include &lt;<a class="el" href="obd__support_8h_source.html">obd_support.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__class_8h_source.html">obd_class.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="libcfs_8h_source.html">libcfs/libcfs.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="ptlrpc__internal_8h_source.html">ptlrpc_internal.h</a>&quot;</code><br/>

<p><a href="nrs__fifo_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrpd41d8cd98f00b204e9800998ecf8427e"></a> </p>
<br/><br/></div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nrs__fifo_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>&nbsp;&nbsp;&nbsp;S_RPC</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">nrs  <a href="#abda60744d497fcfe370cfd6b2d65c7ed"></a><br/></td></tr>
<tr><td colspan="2"><h2>fifo</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrpcf54937a2330ac17aa523bf7130911a3"></a>The FIFO policy is a logical wrapper around previous, non-NRS functionality.</p>
<p>It schedules RPCs in the same order as they are queued from LNet. </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nrs__fifo_8c.html#a1b62512f96e298995bd69d335677f043">NRS_POL_NAME_FIFO</a>&nbsp;&nbsp;&nbsp;&quot;fifo&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structptlrpc__nrs__pol__ops.html">ptlrpc_nrs_pol_ops</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nrs__fifo_8c.html#a623bafddb208567020d1fdd494a3d890">nrs_fifo_ops</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">FIFO policy operations.  <a href="#a623bafddb208567020d1fdd494a3d890"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structptlrpc__nrs__pol__conf.html">ptlrpc_nrs_pol_conf</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nrs__fifo_8c.html#ae6199396044abe1d7985dac1cd676d3f">nrs_conf_fifo</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">FIFO policy configuration.  <a href="#ae6199396044abe1d7985dac1cd676d3f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nrs__fifo_8c.html#a179ec773075549215be77e214c8aabdc">nrs_fifo_start</a> (struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *policy, char *arg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Is called before the policy transitions into <a class="el" href="group__nrs.html#gga843285b91fa9672fdf0fcc93b4387971a8da4904dfb7ba56810332673912a76cb" title="A policy is in this state in two cases:it is the fallback policy, which is always...">ptlrpc_nrs_pol_state::NRS_POL_STATE_STARTED</a>; allocates and initializes a policy-specific private data structure.  <a href="#a179ec773075549215be77e214c8aabdc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nrs__fifo_8c.html#a8457096b19feefc2a4fa5154ae508ba6">nrs_fifo_stop</a> (struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *policy)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Is called before the policy transitions into <a class="el" href="group__nrs.html#gga843285b91fa9672fdf0fcc93b4387971a60ca6b44260cb20198b1d5d4747a6257" title="Policies are at this state either at the start of their life, or transition here...">ptlrpc_nrs_pol_state::NRS_POL_STATE_STOPPED</a>; deallocates the policy-specific private data structure.  <a href="#a8457096b19feefc2a4fa5154ae508ba6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nrs__fifo_8c.html#aca039467080c47e0a698c93dbe35ebbe">nrs_fifo_res_get</a> (struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *policy, struct <a class="el" href="structptlrpc__nrs__request.html">ptlrpc_nrs_request</a> *nrq, const struct <a class="el" href="structptlrpc__nrs__resource.html">ptlrpc_nrs_resource</a> *parent, struct <a class="el" href="structptlrpc__nrs__resource.html">ptlrpc_nrs_resource</a> **resp, bool moving_req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Is called for obtaining a FIFO policy resource.  <a href="#aca039467080c47e0a698c93dbe35ebbe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structptlrpc__nrs__request.html">ptlrpc_nrs_request</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nrs__fifo_8c.html#a4fee6e5556671dc224f38029ecf2041f">nrs_fifo_req_get</a> (struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *policy, bool peek, bool force)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called when getting a request from the FIFO policy for handling, or just peeking; removes the request from the policy when it is to be handled.  <a href="#a4fee6e5556671dc224f38029ecf2041f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nrs__fifo_8c.html#af1ca046e380c8feb4fedcd0f1d67d6f3">nrs_fifo_req_add</a> (struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *policy, struct <a class="el" href="structptlrpc__nrs__request.html">ptlrpc_nrs_request</a> *nrq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds request <em>nrq</em> to <em>policy's</em> list of queued requests.  <a href="#af1ca046e380c8feb4fedcd0f1d67d6f3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nrs__fifo_8c.html#ad871daa53b2cb4aa073f80964a84cf76">nrs_fifo_req_del</a> (struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *policy, struct <a class="el" href="structptlrpc__nrs__request.html">ptlrpc_nrs_request</a> *nrq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes request <em>nrq</em> from <em>policy's</em> list of queued requests.  <a href="#ad871daa53b2cb4aa073f80964a84cf76"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nrs__fifo_8c.html#a2bddf416a378e523b816b4859834438c">nrs_fifo_req_stop</a> (struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *policy, struct <a class="el" href="structptlrpc__nrs__request.html">ptlrpc_nrs_request</a> *nrq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prints a debug statement right before the request <em>nrq</em> stops being handled.  <a href="#a2bddf416a378e523b816b4859834438c"></a><br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="abda60744d497fcfe370cfd6b2d65c7ed"></a><!-- doxytag: member="nrs_fifo.c::DEBUG_SUBSYSTEM" ref="abda60744d497fcfe370cfd6b2d65c7ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_SUBSYSTEM&nbsp;&nbsp;&nbsp;S_RPC</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>nrs </p>

<p>Definition at line <a class="el" href="nrs__fifo_8c_source.html#l00049">49</a> of file <a class="el" href="nrs__fifo_8c_source.html">nrs_fifo.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1b62512f96e298995bd69d335677f043"></a><!-- doxytag: member="nrs_fifo.c::NRS_POL_NAME_FIFO" ref="a1b62512f96e298995bd69d335677f043" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NRS_POL_NAME_FIFO&nbsp;&nbsp;&nbsp;&quot;fifo&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="nrs__fifo_8c_source.html#l00064">64</a> of file <a class="el" href="nrs__fifo_8c_source.html">nrs_fifo.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="af1ca046e380c8feb4fedcd0f1d67d6f3"></a><!-- doxytag: member="nrs_fifo.c::nrs_fifo_req_add" ref="af1ca046e380c8feb4fedcd0f1d67d6f3" args="(struct ptlrpc_nrs_policy *policy, struct ptlrpc_nrs_request *nrq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int nrs_fifo_req_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *&nbsp;</td>
          <td class="paramname"> <em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__nrs__request.html">ptlrpc_nrs_request</a> *&nbsp;</td>
          <td class="paramname"> <em>nrq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds request <em>nrq</em> to <em>policy's</em> list of queued requests. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>policy</em>&nbsp;</td><td>The policy </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nrq</em>&nbsp;</td><td>The request to add</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success; <a class="el" href="nrs_8c.html#ac63065fc9f6fc04df590c34a1da9a1cf" title="Enqueues request nrq for later handling, via one one the policies for which resources...">nrs_request_enqueue()</a> assumes this function will always succeed </td></tr>
  </table>
  </dd>
</dl>

<p><p>Only used for debugging</p>
</p>

<p>Definition at line <a class="el" href="nrs__fifo_8c_source.html#l00194">194</a> of file <a class="el" href="nrs__fifo_8c_source.html">nrs_fifo.c</a>.</p>

<p>References <a class="el" href="lustre__nrs__fifo_8h_source.html#l00057">nrs_fifo_head::fh_list</a>, <a class="el" href="lustre__nrs__fifo_8h_source.html#l00053">nrs_fifo_head::fh_res</a>, <a class="el" href="lustre__nrs__fifo_8h_source.html#l00061">nrs_fifo_head::fh_sequence</a>, <a class="el" href="lustre__nrs_8h_source.html#l00713">ptlrpc_nrs_request::fifo</a>, <a class="el" href="lustre__nrs__fifo_8h_source.html#l00065">nrs_fifo_req::fr_list</a>, <a class="el" href="lustre__nrs__fifo_8h_source.html#l00066">nrs_fifo_req::fr_sequence</a>, <a class="el" href="writemany_8c_source.html#l00074">head</a>, <a class="el" href="list_8h_source.html#l00090">list_add_tail()</a>, <a class="el" href="structptlrpc__nrs__request.html#acbdc1427ee55ee33c12d38a71a262f05">ptlrpc_nrs_request::nr_u</a>, and <a class="el" href="ptlrpc__internal_8h_source.html#l00229">nrs_request_resource()</a>.</p>

</div>
</div>
<a class="anchor" id="ad871daa53b2cb4aa073f80964a84cf76"></a><!-- doxytag: member="nrs_fifo.c::nrs_fifo_req_del" ref="ad871daa53b2cb4aa073f80964a84cf76" args="(struct ptlrpc_nrs_policy *policy, struct ptlrpc_nrs_request *nrq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void nrs_fifo_req_del </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *&nbsp;</td>
          <td class="paramname"> <em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__nrs__request.html">ptlrpc_nrs_request</a> *&nbsp;</td>
          <td class="paramname"> <em>nrq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes request <em>nrq</em> from <em>policy's</em> list of queued requests. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>policy</em>&nbsp;</td><td>The policy </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nrq</em>&nbsp;</td><td>The request to remove </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="nrs__fifo_8c_source.html#l00216">216</a> of file <a class="el" href="nrs__fifo_8c_source.html">nrs_fifo.c</a>.</p>

<p>References <a class="el" href="lustre__nrs_8h_source.html#l00713">ptlrpc_nrs_request::fifo</a>, <a class="el" href="lustre__nrs__fifo_8h_source.html#l00065">nrs_fifo_req::fr_list</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, and <a class="el" href="structptlrpc__nrs__request.html#acbdc1427ee55ee33c12d38a71a262f05">ptlrpc_nrs_request::nr_u</a>.</p>

</div>
</div>
<a class="anchor" id="a4fee6e5556671dc224f38029ecf2041f"></a><!-- doxytag: member="nrs_fifo.c::nrs_fifo_req_get" ref="a4fee6e5556671dc224f38029ecf2041f" args="(struct ptlrpc_nrs_policy *policy, bool peek, bool force)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structptlrpc__nrs__request.html">ptlrpc_nrs_request</a>* nrs_fifo_req_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *&nbsp;</td>
          <td class="paramname"> <em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>peek</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>force</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Called when getting a request from the FIFO policy for handling, or just peeking; removes the request from the policy when it is to be handled. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>policy</em>&nbsp;</td><td>The policy </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>peek</em>&nbsp;</td><td>When set, signifies that we just want to examine the request, and not handle it, so the request is not removed from the policy. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>force</em>&nbsp;</td><td>Force the policy to return a request; unused in this policy</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>The</em>&nbsp;</td><td>request to be handled; this is the next request in the FIFO queue</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="ptlrpc__internal_8h.html#ad92335242ec3763ecf8874e00c41efee">ptlrpc_nrs_req_get_nolock()</a> </dd>
<dd>
<a class="el" href="nrs_8c.html#a03fa2d011c5fcb5c16cd48b910775cc0" title="Obtains an NRS request from policy for handling or examination; the request should...">nrs_request_get()</a> </dd></dl>

<p>Definition at line <a class="el" href="nrs__fifo_8c_source.html#l00160">160</a> of file <a class="el" href="nrs__fifo_8c_source.html">nrs_fifo.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00149">D_RPCTRACE</a>, <a class="el" href="lustre__nrs__fifo_8h_source.html#l00057">nrs_fifo_head::fh_list</a>, <a class="el" href="lustre__nrs_8h_source.html#l00713">ptlrpc_nrs_request::fifo</a>, <a class="el" href="lustre__nrs__fifo_8h_source.html#l00065">nrs_fifo_req::fr_list</a>, <a class="el" href="lustre__nrs__fifo_8h_source.html#l00066">nrs_fifo_req::fr_sequence</a>, <a class="el" href="writemany_8c_source.html#l00074">head</a>, <a class="el" href="lnet_2lnet_2nidstrings_8c_source.html#l01236">libcfs_id2str()</a>, <a class="el" href="libcfs__private_8h_source.html#l00309">likely</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="list_8h_source.html#l00242">list_entry</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="list_8h_source.html#l00043">list_head::next</a>, <a class="el" href="structptlrpc__nrs__request.html#acbdc1427ee55ee33c12d38a71a262f05">ptlrpc_nrs_request::nr_u</a>, <a class="el" href="lustre__nrs_8h_source.html#l00441">ptlrpc_nrs_pol_desc::pd_name</a>, <a class="el" href="lustre__nrs_8h_source.html#l00626">ptlrpc_nrs_policy::pol_desc</a>, <a class="el" href="lustre__nrs_8h_source.html#l00622">ptlrpc_nrs_policy::pol_private</a>, <a class="el" href="lustre__net_8h_source.html#l00939">rq_nrq</a>, <a class="el" href="lustre__net_8h_source.html#l01108">ptlrpc_request::rq_peer</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="a2bddf416a378e523b816b4859834438c"></a><!-- doxytag: member="nrs_fifo.c::nrs_fifo_req_stop" ref="a2bddf416a378e523b816b4859834438c" args="(struct ptlrpc_nrs_policy *policy, struct ptlrpc_nrs_request *nrq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void nrs_fifo_req_stop </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *&nbsp;</td>
          <td class="paramname"> <em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__nrs__request.html">ptlrpc_nrs_request</a> *&nbsp;</td>
          <td class="paramname"> <em>nrq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prints a debug statement right before the request <em>nrq</em> stops being handled. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>policy</em>&nbsp;</td><td>The policy handling the request </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nrq</em>&nbsp;</td><td>The request being handled</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="service_8c.html#a2d71c5442a9a62c66bd99bc984d2c8d1" title="to finish a request: stop sending more early replies, and release the request.">ptlrpc_server_finish_request()</a> </dd>
<dd>
<a class="el" href="nrs_8c.html#a41d6af6b26aebda69530fe3537266dfd">ptlrpc_nrs_req_stop_nolock()</a> </dd></dl>

<p>Definition at line <a class="el" href="nrs__fifo_8c_source.html#l00233">233</a> of file <a class="el" href="nrs__fifo_8c_source.html">nrs_fifo.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00149">D_RPCTRACE</a>, <a class="el" href="lustre__nrs_8h_source.html#l00713">ptlrpc_nrs_request::fifo</a>, <a class="el" href="lustre__nrs__fifo_8h_source.html#l00066">nrs_fifo_req::fr_sequence</a>, <a class="el" href="lnet_2lnet_2nidstrings_8c_source.html#l01236">libcfs_id2str()</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="structptlrpc__nrs__request.html#acbdc1427ee55ee33c12d38a71a262f05">ptlrpc_nrs_request::nr_u</a>, <a class="el" href="lustre__nrs_8h_source.html#l00441">ptlrpc_nrs_pol_desc::pd_name</a>, <a class="el" href="lustre__nrs_8h_source.html#l00626">ptlrpc_nrs_policy::pol_desc</a>, <a class="el" href="lustre__net_8h_source.html#l00939">rq_nrq</a>, and <a class="el" href="lustre__net_8h_source.html#l01108">ptlrpc_request::rq_peer</a>.</p>

</div>
</div>
<a class="anchor" id="aca039467080c47e0a698c93dbe35ebbe"></a><!-- doxytag: member="nrs_fifo.c::nrs_fifo_res_get" ref="aca039467080c47e0a698c93dbe35ebbe" args="(struct ptlrpc_nrs_policy *policy, struct ptlrpc_nrs_request *nrq, const struct ptlrpc_nrs_resource *parent, struct ptlrpc_nrs_resource **resp, bool moving_req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int nrs_fifo_res_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *&nbsp;</td>
          <td class="paramname"> <em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__nrs__request.html">ptlrpc_nrs_request</a> *&nbsp;</td>
          <td class="paramname"> <em>nrq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structptlrpc__nrs__resource.html">ptlrpc_nrs_resource</a> *&nbsp;</td>
          <td class="paramname"> <em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__nrs__resource.html">ptlrpc_nrs_resource</a> **&nbsp;</td>
          <td class="paramname"> <em>resp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>moving_req</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Is called for obtaining a FIFO policy resource. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>policy</em>&nbsp;</td><td>The policy on which the request is being asked for </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nrq</em>&nbsp;</td><td>The request for which resources are being taken </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>parent</em>&nbsp;</td><td>Parent resource, unused in this policy </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>resp</em>&nbsp;</td><td>Resources references are placed in this array </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>moving_req</em>&nbsp;</td><td>Signifies limited caller context; unused in this policy</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>The FIFO policy only has a one-level resource hierarchy, as since it implements a simple scheduling algorithm in which request priority is determined on the request arrival order, it does not need to maintain a set of resources that would otherwise be used to calculate a request's priority.</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="nrs_8c.html#a6ba673781ab2ba2e38ab4c17c1e26cff" title="Obtains resources for the resource hierarchies and policy references for the fallback...">nrs_resource_get_safe()</a> </dd></dl>

<p><p>Just return the resource embedded inside <a class="el" href="structnrs__fifo__head.html" title="Private data structure for the FIFO policy.">nrs_fifo_head</a>, and end this resource hierarchy reference request.</p>
</p>

<p>Definition at line <a class="el" href="nrs__fifo_8c_source.html#l00129">129</a> of file <a class="el" href="nrs__fifo_8c_source.html">nrs_fifo.c</a>.</p>

<p>References <a class="el" href="lustre__nrs_8h_source.html#l00622">ptlrpc_nrs_policy::pol_private</a>.</p>

</div>
</div>
<a class="anchor" id="a179ec773075549215be77e214c8aabdc"></a><!-- doxytag: member="nrs_fifo.c::nrs_fifo_start" ref="a179ec773075549215be77e214c8aabdc" args="(struct ptlrpc_nrs_policy *policy, char *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int nrs_fifo_start </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *&nbsp;</td>
          <td class="paramname"> <em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>arg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Is called before the policy transitions into <a class="el" href="group__nrs.html#gga843285b91fa9672fdf0fcc93b4387971a8da4904dfb7ba56810332673912a76cb" title="A policy is in this state in two cases:it is the fallback policy, which is always...">ptlrpc_nrs_pol_state::NRS_POL_STATE_STARTED</a>; allocates and initializes a policy-specific private data structure. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>policy</em>&nbsp;</td><td>The policy to start</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>-ENOMEM</em>&nbsp;</td><td>OOM error </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="nrs_8c.html#a90bbaf18e29bc89bc9413c3f33e67767" title="Register a policy from  descriptor desc with NRS head nrs.">nrs_policy_register()</a> </dd>
<dd>
<a class="el" href="nrs_8c.html#afbd695867fa6a33db4e9338da1e78225" title="Handler for operations that can be carried out on policies.">nrs_policy_ctl()</a> </dd></dl>

<p>Definition at line <a class="el" href="nrs__fifo_8c_source.html#l00079">79</a> of file <a class="el" href="nrs__fifo_8c_source.html">nrs_fifo.c</a>.</p>

<p>References <a class="el" href="lustre__nrs__fifo_8h_source.html#l00057">nrs_fifo_head::fh_list</a>, <a class="el" href="writemany_8c_source.html#l00074">head</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="ptlrpc__internal_8h_source.html#l00223">nrs_pol2cptab()</a>, <a class="el" href="ptlrpc__internal_8h_source.html#l00205">nrs_pol2cptid()</a>, <a class="el" href="obd__support_8h_source.html#l00719">OBD_CPT_ALLOC_PTR</a>, and <a class="el" href="lustre__nrs_8h_source.html#l00622">ptlrpc_nrs_policy::pol_private</a>.</p>

</div>
</div>
<a class="anchor" id="a8457096b19feefc2a4fa5154ae508ba6"></a><!-- doxytag: member="nrs_fifo.c::nrs_fifo_stop" ref="a8457096b19feefc2a4fa5154ae508ba6" args="(struct ptlrpc_nrs_policy *policy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void nrs_fifo_stop </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__nrs__policy.html">ptlrpc_nrs_policy</a> *&nbsp;</td>
          <td class="paramname"> <em>policy</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Is called before the policy transitions into <a class="el" href="group__nrs.html#gga843285b91fa9672fdf0fcc93b4387971a60ca6b44260cb20198b1d5d4747a6257" title="Policies are at this state either at the start of their life, or transition here...">ptlrpc_nrs_pol_state::NRS_POL_STATE_STOPPED</a>; deallocates the policy-specific private data structure. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>policy</em>&nbsp;</td><td>The policy to stop</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="nrs_8c.html#ab0431763f8af37f9f10dac5d884bab3b">nrs_policy_stop0()</a> </dd></dl>

<p>Definition at line <a class="el" href="nrs__fifo_8c_source.html#l00101">101</a> of file <a class="el" href="nrs__fifo_8c_source.html">nrs_fifo.c</a>.</p>

<p>References <a class="el" href="lustre__nrs__fifo_8h_source.html#l00057">nrs_fifo_head::fh_list</a>, <a class="el" href="writemany_8c_source.html#l00074">head</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, and <a class="el" href="lustre__nrs_8h_source.html#l00622">ptlrpc_nrs_policy::pol_private</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ae6199396044abe1d7985dac1cd676d3f"></a><!-- doxytag: member="nrs_fifo.c::nrs_conf_fifo" ref="ae6199396044abe1d7985dac1cd676d3f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structptlrpc__nrs__pol__conf.html">ptlrpc_nrs_pol_conf</a> <a class="el" href="ptlrpc__internal_8h.html#ae6199396044abe1d7985dac1cd676d3f">nrs_conf_fifo</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .nc_name                = <a class="code" href="nrs__fifo_8c.html#a1b62512f96e298995bd69d335677f043">NRS_POL_NAME_FIFO</a>,
        .nc_ops                 = &amp;<a class="code" href="nrs__fifo_8c.html#a623bafddb208567020d1fdd494a3d890" title="FIFO policy operations.">nrs_fifo_ops</a>,
        .nc_compat              = <a class="code" href="group__nrs.html#ga1c34898d90054376939d759b6e693def">nrs_policy_compat_all</a>,
        .nc_flags               = <a class="code" href="group__nrs.html#gga6ea16220314a76d72e40776a753ad5e8ad327b4b9e26d26b5620cfdb682ca0b4c" title="Fallback policy, use this flag only on a single supported policy per service.">PTLRPC_NRS_FL_FALLBACK</a> |
                                  <a class="code" href="group__nrs.html#gga6ea16220314a76d72e40776a753ad5e8a274b96449b8debe8a3aadf811d78b8aa" title="Start policy immediately after registering.">PTLRPC_NRS_FL_REG_START</a>
}
</pre></div>
<p>FIFO policy configuration. </p>

<p>Definition at line <a class="el" href="nrs__fifo_8c_source.html#l00260">260</a> of file <a class="el" href="nrs__fifo_8c_source.html">nrs_fifo.c</a>.</p>

<p>Referenced by <a class="el" href="nrs_8c_source.html#l01787">ptlrpc_nrs_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a623bafddb208567020d1fdd494a3d890"></a><!-- doxytag: member="nrs_fifo.c::nrs_fifo_ops" ref="a623bafddb208567020d1fdd494a3d890" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structptlrpc__nrs__pol__ops.html">ptlrpc_nrs_pol_ops</a> <a class="el" href="nrs__fifo_8c.html#a623bafddb208567020d1fdd494a3d890">nrs_fifo_ops</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        .op_policy_start        = <a class="code" href="nrs__fifo_8c.html#a179ec773075549215be77e214c8aabdc" title="Is called before the policy transitions into ptlrpc_nrs_pol_state::NRS_POL_STATE_STARTED;...">nrs_fifo_start</a>,
        .op_policy_stop         = <a class="code" href="nrs__fifo_8c.html#a8457096b19feefc2a4fa5154ae508ba6" title="Is called before the policy transitions into ptlrpc_nrs_pol_state::NRS_POL_STATE_STOPPED;...">nrs_fifo_stop</a>,
        .op_res_get             = <a class="code" href="nrs__fifo_8c.html#aca039467080c47e0a698c93dbe35ebbe" title="Is called for obtaining a FIFO policy resource.">nrs_fifo_res_get</a>,
        .op_req_get             = <a class="code" href="nrs__fifo_8c.html#a4fee6e5556671dc224f38029ecf2041f" title="Called when getting a request from the FIFO policy for handling, or just peeking;...">nrs_fifo_req_get</a>,
        .op_req_enqueue         = <a class="code" href="nrs__fifo_8c.html#af1ca046e380c8feb4fedcd0f1d67d6f3" title="Adds request nrq to policy&amp;#39;s list of queued requests.">nrs_fifo_req_add</a>,
        .op_req_dequeue         = <a class="code" href="nrs__fifo_8c.html#ad871daa53b2cb4aa073f80964a84cf76" title="Removes request nrq from policy&amp;#39;s list of queued requests.">nrs_fifo_req_del</a>,
        .op_req_stop            = <a class="code" href="nrs__fifo_8c.html#a2bddf416a378e523b816b4859834438c" title="Prints a debug statement right before the request nrq stops being handled.">nrs_fifo_req_stop</a>,
}
</pre></div>
<p>FIFO policy operations. </p>

<p>Definition at line <a class="el" href="nrs__fifo_8c_source.html#l00247">247</a> of file <a class="el" href="nrs__fifo_8c_source.html">nrs_fifo.c</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:50 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
