<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/target/update_records.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/target/update_records.c File Reference</h1><code>#include &lt;<a class="el" href="lu__target_8h_source.html">lu_target.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__obdo_8h_source.html">lustre_obdo.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__update_8h_source.html">lustre_update.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd_8h_source.html">obd.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__class_8h_source.html">obd_class.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="tgt__internal_8h_source.html">tgt_internal.h</a>&quot;</code><br/>

<p><a href="update__records_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>&nbsp;&nbsp;&nbsp;S_CLASS</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#acada94ed8c998be34e7c491abdf175c1">UPDATE_RECORDS_BUFFER_SIZE</a>&nbsp;&nbsp;&nbsp;8192</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a7d473853c875c101a45128c57a911e36">UPDATE_PARAMS_BUFFER_SIZE</a>&nbsp;&nbsp;&nbsp;8192</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#af5e8c053444ba3fed9d4f22db1e0e643">update_records_dump</a> (const struct <a class="el" href="structupdate__records.html">update_records</a> *records, unsigned int mask, bool dump_updates)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dump update record.  <a href="#af5e8c053444ba3fed9d4f22db1e0e643"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#adfc09a873cdee1de17b1753f221b2661">update_records_param_pack</a> (struct <a class="el" href="structupdate__params.html">update_params</a> *params, const void *new_param, size_t new_param_size, unsigned int *param_count)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack parameters to update records.  <a href="#adfc09a873cdee1de17b1753f221b2661"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a8eca2f7719b11d7f4bce26350591ce40">update_records_update_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, enum <a class="el" href="group__lustreidl.html#ga2d1a90f202540bfbcbd72a8c0f94b586">update_type</a> op_type, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_op_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, unsigned int param_bufs_count, const void **param_bufs, size_t *param_sizes)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack update to update records.  <a href="#a8eca2f7719b11d7f4bce26350591ce40"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#ab9c9d7287a010ab7190c3c4ee5e58de8">update_records_update_size</a> (__u32 param_count, size_t *sizes)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate <a class="el" href="structupdate__records.html">update_records</a> size.  <a href="#ab9c9d7287a010ab7190c3c4ee5e58de8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a326d1ece7c3e09d476144648cd9c92d3">update_records_create_size</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct <a class="el" href="structlu__attr.html">lu_attr</a> *attr, const struct <a class="el" href="structdt__allocation__hint.html">dt_allocation_hint</a> *hint, struct <a class="el" href="structdt__object__format.html">dt_object_format</a> *dof)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate create update size.  <a href="#a326d1ece7c3e09d476144648cd9c92d3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a536f2912b198af6ae7b47e81fb5123cb">update_records_create_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_ops_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct <a class="el" href="structlu__attr.html">lu_attr</a> *attr, const struct <a class="el" href="structdt__allocation__hint.html">dt_allocation_hint</a> *hint, struct <a class="el" href="structdt__object__format.html">dt_object_format</a> *dof)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack create update.  <a href="#a536f2912b198af6ae7b47e81fb5123cb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a4bf05d79caeadc1273a5a62b66232154">update_records_attr_set_size</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct <a class="el" href="structlu__attr.html">lu_attr</a> *attr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate attr set update size.  <a href="#a4bf05d79caeadc1273a5a62b66232154"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#aa11aad46fa862adb0b2d1a6790c20c36">update_records_attr_set_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_ops_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct <a class="el" href="structlu__attr.html">lu_attr</a> *attr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack attr set update.  <a href="#aa11aad46fa862adb0b2d1a6790c20c36"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#ad64a0bb9fb472f09125a383580d779ed">update_records_ref_add_size</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate ref add update size.  <a href="#ad64a0bb9fb472f09125a383580d779ed"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#aa5c1ba7c90bb603fa32b3ce2cc3c80f9">update_records_ref_add_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_ops_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack ref add update.  <a href="#aa5c1ba7c90bb603fa32b3ce2cc3c80f9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#af2bca6df33e94f5dba3cc73e8020bd66">update_records_noop_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_ops_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack noop update.  <a href="#af2bca6df33e94f5dba3cc73e8020bd66"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a63d3ba51338da1e9d0ab76f3838d2330">update_records_ref_del_size</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate ref del update size.  <a href="#a63d3ba51338da1e9d0ab76f3838d2330"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a5d679792a3b5e49d0170a1ce55df8ce4">update_records_ref_del_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_ops_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack ref del update.  <a href="#a5d679792a3b5e49d0170a1ce55df8ce4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a8bb4f27514127c7fddfed05269fddd6e">update_records_object_destroy_size</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate object destroy update size.  <a href="#a8bb4f27514127c7fddfed05269fddd6e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#af464d53afef74f1b3918d3571fa2581e">update_records_object_destroy_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_ops_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack object destroy update.  <a href="#af464d53afef74f1b3918d3571fa2581e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#ab0351ffc2e1e9c70f887fbfa8181ab0e">update_records_index_insert_size</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct dt_rec *rec, const struct <a class="el" href="dt__object_8c.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate index insert update size.  <a href="#ab0351ffc2e1e9c70f887fbfa8181ab0e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a2ba66c5a47966557f3ac9310ff1774dd">update_records_index_insert_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_ops_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct dt_rec *rec, const struct <a class="el" href="dt__object_8c.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack index insert update.  <a href="#a2ba66c5a47966557f3ac9310ff1774dd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a178056dec37f7d672b8c2989b2b3c24d">update_records_index_delete_size</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct <a class="el" href="dt__object_8c.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate index delete update size.  <a href="#a178056dec37f7d672b8c2989b2b3c24d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#ad37f503135c466368b42b72fc0061fe1">update_records_index_delete_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_ops_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct <a class="el" href="dt__object_8c.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack index delete update.  <a href="#ad37f503135c466368b42b72fc0061fe1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#ac4e8a1f313a91e3776612c227750ac27">update_records_xattr_set_size</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct <a class="el" href="structlu__buf.html">lu_buf</a> *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, const char *<a class="el" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, __u32 flag)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate xattr set size.  <a href="#ac4e8a1f313a91e3776612c227750ac27"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#ab5cbaa54ac4deb3eb969c29688a56f28">update_records_xattr_set_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_ops_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct <a class="el" href="structlu__buf.html">lu_buf</a> *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, const char *<a class="el" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, __u32 flag)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack xattr set update.  <a href="#ab5cbaa54ac4deb3eb969c29688a56f28"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a6c4c7df106878116b11868e232551086">update_records_xattr_del_size</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const char *<a class="el" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate xattr delete update size.  <a href="#a6c4c7df106878116b11868e232551086"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a79c727b585d2b96accddc19a646fecb5">update_records_xattr_del_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_ops_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const char *<a class="el" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack xattr delete update.  <a href="#a79c727b585d2b96accddc19a646fecb5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a9a613a028497e370001345de3c47ee5b">update_records_write_size</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct <a class="el" href="structlu__buf.html">lu_buf</a> *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> pos)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate write update size.  <a href="#a9a613a028497e370001345de3c47ee5b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#ac13bcde2bee8f3032877e62eaef1841f">update_records_write_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_ops_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct <a class="el" href="structlu__buf.html">lu_buf</a> *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> pos)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack write update.  <a href="#ac13bcde2bee8f3032877e62eaef1841f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a22158bbaf3c1c6e48822b0046db9532e">update_records_punch_size</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="el" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> end)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate size of punch update.  <a href="#a22158bbaf3c1c6e48822b0046db9532e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a0c8abdcf750282a719ba9c11582a210e">update_records_punch_pack</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structupdate__ops.html">update_ops</a> *ops, unsigned int *op_count, size_t *max_ops_size, struct <a class="el" href="structupdate__params.html">update_params</a> *params, unsigned int *param_count, size_t *max_param_size, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="el" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> end)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack punch.  <a href="#a0c8abdcf750282a719ba9c11582a210e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a6a2d06df1f1cf3cd53e74ec16fccd2f1">tur_update_records_create</a> (struct <a class="el" href="structthandle__update__records.html">thandle_update_records</a> *tur)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create update records in <a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a>.  <a href="#a6a2d06df1f1cf3cd53e74ec16fccd2f1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a1015e587064445a57adea2dc3f93c47e">tur_update_records_extend</a> (struct <a class="el" href="structthandle__update__records.html">thandle_update_records</a> *tur, size_t new_size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extend update records.  <a href="#a1015e587064445a57adea2dc3f93c47e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#ad210f707a77f4c3b34e784df2fa88f02">tur_update_extend</a> (struct <a class="el" href="structthandle__update__records.html">thandle_update_records</a> *tur, size_t new_op_size, size_t new_param_size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extend update records.  <a href="#ad210f707a77f4c3b34e784df2fa88f02"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#ad1d8fe575b8f17af66c1e4856279877c">tur_update_params_create</a> (struct <a class="el" href="structthandle__update__records.html">thandle_update_records</a> *tur)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create update params in <a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a>.  <a href="#ad1d8fe575b8f17af66c1e4856279877c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a23a3a01eea42de3cf2cc943246e9b157">tur_update_params_extend</a> (struct <a class="el" href="structthandle__update__records.html">thandle_update_records</a> *tur, size_t new_size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extend update params.  <a href="#a23a3a01eea42de3cf2cc943246e9b157"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a18a6ce30ff68ba772a30fd9a164b9a18">check_and_prepare_update_record</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structthandle__update__records.html">thandle_update_records</a> *tur)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check and prepare whether it needs to record update.  <a href="#a18a6ce30ff68ba772a30fd9a164b9a18"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a37c7cabb6a8f94532a8c3b9041d04194">update_key_fini</a> (const struct <a class="el" href="structlu__context.html">lu_context</a> *ctx, struct <a class="el" href="structlu__context__key.html">lu_context_key</a> *key, void *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#acc9f82c27ac49940f62ae06e612fe44f">LU_KEY_INIT</a> (update, struct <a class="el" href="structupdate__thread__info.html">update_thread_info</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#ad80c4704215a869088badf89380ab8e8">LU_CONTEXT_KEY_DEFINE</a> (update, LCT_MD_THREAD|LCT_MG_THREAD|LCT_DT_THREAD|LCT_TX_HANDLE|LCT_LOCAL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a2c1eb2f1e1369b03e405342059687c07">LU_KEY_INIT_GENERIC</a> (update)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#abb3102b38b590d56d0c531397be53292">update_info_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update__records_8c.html#a50e52cb7df7ffa36c19228b8fd137c28">update_info_fini</a> (void)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="abda60744d497fcfe370cfd6b2d65c7ed"></a><!-- doxytag: member="update_records.c::DEBUG_SUBSYSTEM" ref="abda60744d497fcfe370cfd6b2d65c7ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_SUBSYSTEM&nbsp;&nbsp;&nbsp;S_CLASS</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00041">41</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7d473853c875c101a45128c57a911e36"></a><!-- doxytag: member="update_records.c::UPDATE_PARAMS_BUFFER_SIZE" ref="a7d473853c875c101a45128c57a911e36" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UPDATE_PARAMS_BUFFER_SIZE&nbsp;&nbsp;&nbsp;8192</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00052">52</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l01054">tur_update_extend()</a>, and <a class="el" href="update__records_8c_source.html#l01103">tur_update_params_create()</a>.</p>

</div>
</div>
<a class="anchor" id="acada94ed8c998be34e7c491abdf175c1"></a><!-- doxytag: member="update_records.c::UPDATE_RECORDS_BUFFER_SIZE" ref="acada94ed8c998be34e7c491abdf175c1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UPDATE_RECORDS_BUFFER_SIZE&nbsp;&nbsp;&nbsp;8192</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00051">51</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l01054">tur_update_extend()</a>, and <a class="el" href="update__records_8c_source.html#l00991">tur_update_records_create()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a18a6ce30ff68ba772a30fd9a164b9a18"></a><!-- doxytag: member="update_records.c::check_and_prepare_update_record" ref="a18a6ce30ff68ba772a30fd9a164b9a18" args="(const struct lu_env *env, struct thandle_update_records *tur)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_and_prepare_update_record </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle__update__records.html">thandle_update_records</a> *&nbsp;</td>
          <td class="paramname"> <em>tur</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check and prepare whether it needs to record update. </p>
<p>Checks if the transaction needs to record updates, and if it does, then initialize the update record buffer in the transaction.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>transaction handle</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if updates recording succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if updates recording fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l01161">1161</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l03300">LLOG_MIN_CHUNK_SIZE</a>, <a class="el" href="lustre__idl_8h_source.html#l03114">llog_rec_hdr::lrh_len</a>, <a class="el" href="llog__test_8c_source.html#l00947">lur</a>, <a class="el" href="lustre__idl_8h_source.html#l04041">llog_update_record::lur_hdr</a>, <a class="el" href="lustre__idl_8h_source.html#l04042">llog_update_record::lur_update_rec</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__update_8h_source.html#l00278">thandle_update_records::tur_update_param_count</a>, <a class="el" href="lustre__update_8h_source.html#l00277">thandle_update_records::tur_update_params</a>, <a class="el" href="update__records_8c_source.html#l01103">tur_update_params_create()</a>, <a class="el" href="lustre__update_8h_source.html#l00273">thandle_update_records::tur_update_records</a>, <a class="el" href="update__records_8c_source.html#l00991">tur_update_records_create()</a>, <a class="el" href="lustre__idl_8h_source.html#l04024">update_records::ur_batchid</a>, <a class="el" href="lustre__idl_8h_source.html#l04025">update_records::ur_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l04023">update_records::ur_master_transno</a>, <a class="el" href="lustre__idl_8h_source.html#l04030">update_records::ur_param_count</a>, and <a class="el" href="lustre__idl_8h_source.html#l04029">update_records::ur_update_count</a>.</p>

<p>Referenced by <a class="el" href="update__trans_8c_source.html#l00750">prepare_multiple_node_trans()</a>.</p>

</div>
</div>
<a class="anchor" id="ad80c4704215a869088badf89380ab8e8"></a><!-- doxytag: member="update_records.c::LU_CONTEXT_KEY_DEFINE" ref="ad80c4704215a869088badf89380ab8e8" args="(update, LCT_MD_THREAD|LCT_MG_THREAD|LCT_DT_THREAD|LCT_TX_HANDLE|LCT_LOCAL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LU_CONTEXT_KEY_DEFINE </td>
          <td>(</td>
          <td class="paramtype">update&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LCT_MD_THREAD|LCT_MG_THREAD|LCT_DT_THREAD|LCT_TX_HANDLE|&nbsp;</td>
          <td class="paramname"> <em>LCT_LOCAL</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="acc9f82c27ac49940f62ae06e612fe44f"></a><!-- doxytag: member="update_records.c::LU_KEY_INIT" ref="acc9f82c27ac49940f62ae06e612fe44f" args="(update, struct update_thread_info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LU_KEY_INIT </td>
          <td>(</td>
          <td class="paramtype">update&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__thread__info.html">update_thread_info</a>&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2c1eb2f1e1369b03e405342059687c07"></a><!-- doxytag: member="update_records.c::LU_KEY_INIT_GENERIC" ref="a2c1eb2f1e1369b03e405342059687c07" args="(update)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LU_KEY_INIT_GENERIC </td>
          <td>(</td>
          <td class="paramtype">update&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad210f707a77f4c3b34e784df2fa88f02"></a><!-- doxytag: member="update_records.c::tur_update_extend" ref="ad210f707a77f4c3b34e784df2fa88f02" args="(struct thandle_update_records *tur, size_t new_op_size, size_t new_param_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tur_update_extend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthandle__update__records.html">thandle_update_records</a> *&nbsp;</td>
          <td class="paramname"> <em>tur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>new_op_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>new_param_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Extend update records. </p>
<p>Extend update records in <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> to make sure it is able to hold the update with certain <a class="el" href="structupdate__op.html">update_op</a> and params size.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tur</em>&nbsp;</td><td><a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a> to be extend </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>new_op_size</em>&nbsp;</td><td><a class="el" href="structupdate__op.html">update_op</a> size of the update record </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>new_param_size</em>&nbsp;</td><td>params size of the update record</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if the <a class="el" href="structupdate__records.html">update_records</a> is being extended. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if the <a class="el" href="structupdate__records.html">update_records</a> is not being extended. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l01054">1054</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__update_8h_source.html#l00154">llog_update_record_size()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__update_8h_source.html#l00278">thandle_update_records::tur_update_param_count</a>, <a class="el" href="lustre__update_8h_source.html#l00277">thandle_update_records::tur_update_params</a>, <a class="el" href="lustre__update_8h_source.html#l00279">thandle_update_records::tur_update_params_buf_size</a>, <a class="el" href="update__records_8c_source.html#l01126">tur_update_params_extend()</a>, <a class="el" href="lustre__update_8h_source.html#l00273">thandle_update_records::tur_update_records</a>, <a class="el" href="lustre__update_8h_source.html#l00274">thandle_update_records::tur_update_records_buf_size</a>, <a class="el" href="update__records_8c_source.html#l01017">tur_update_records_extend()</a>, <a class="el" href="update__records_8c_source.html#l00052">UPDATE_PARAMS_BUFFER_SIZE</a>, <a class="el" href="lustre__update_8h_source.html#l00045">update_params_size()</a>, and <a class="el" href="update__records_8c_source.html#l00051">UPDATE_RECORDS_BUFFER_SIZE</a>.</p>

</div>
</div>
<a class="anchor" id="ad1d8fe575b8f17af66c1e4856279877c"></a><!-- doxytag: member="update_records.c::tur_update_params_create" ref="ad1d8fe575b8f17af66c1e4856279877c" args="(struct thandle_update_records *tur)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int tur_update_params_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthandle__update__records.html">thandle_update_records</a> *&nbsp;</td>
          <td class="paramname"> <em>tur</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create update params in <a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a>. </p>
<p>Allocate <a class="el" href="structupdate__params.html">update_params</a> for <a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a>, the initial size will be 4KB.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tur</em>&nbsp;</td><td><a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a> where <a class="el" href="structupdate__params.html">update_params</a> will be allocated </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if allocation succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if allocation fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l01103">1103</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="lustre__update_8h_source.html#l00277">thandle_update_records::tur_update_params</a>, <a class="el" href="lustre__update_8h_source.html#l00279">thandle_update_records::tur_update_params_buf_size</a>, and <a class="el" href="update__records_8c_source.html#l00052">UPDATE_PARAMS_BUFFER_SIZE</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l01161">check_and_prepare_update_record()</a>.</p>

</div>
</div>
<a class="anchor" id="a23a3a01eea42de3cf2cc943246e9b157"></a><!-- doxytag: member="update_records.c::tur_update_params_extend" ref="a23a3a01eea42de3cf2cc943246e9b157" args="(struct thandle_update_records *tur, size_t new_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tur_update_params_extend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthandle__update__records.html">thandle_update_records</a> *&nbsp;</td>
          <td class="paramname"> <em>tur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>new_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Extend update params. </p>
<p>Extend <a class="el" href="structupdate__params.html">update_params</a> to the new size in <a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tur</em>&nbsp;</td><td><a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a> where <a class="el" href="structupdate__params.html">update_params</a> will be extended. </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if extension succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if extension fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l01126">1126</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="lustre__update_8h_source.html#l00277">thandle_update_records::tur_update_params</a>, and <a class="el" href="lustre__update_8h_source.html#l00279">thandle_update_records::tur_update_params_buf_size</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l01054">tur_update_extend()</a>.</p>

</div>
</div>
<a class="anchor" id="a6a2d06df1f1cf3cd53e74ec16fccd2f1"></a><!-- doxytag: member="update_records.c::tur_update_records_create" ref="a6a2d06df1f1cf3cd53e74ec16fccd2f1" args="(struct thandle_update_records *tur)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int tur_update_records_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthandle__update__records.html">thandle_update_records</a> *&nbsp;</td>
          <td class="paramname"> <em>tur</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create update records in <a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a>. </p>
<p>Allocate <a class="el" href="structupdate__records.html">update_records</a> for <a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a>, the initial size will be 4KB.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tur</em>&nbsp;</td><td><a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a> where <a class="el" href="structupdate__records.html">update_records</a> will be allocated </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if allocation succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if allocation fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00991">991</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="lustre__update_8h_source.html#l00273">thandle_update_records::tur_update_records</a>, <a class="el" href="lustre__update_8h_source.html#l00274">thandle_update_records::tur_update_records_buf_size</a>, and <a class="el" href="update__records_8c_source.html#l00051">UPDATE_RECORDS_BUFFER_SIZE</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l01161">check_and_prepare_update_record()</a>.</p>

</div>
</div>
<a class="anchor" id="a1015e587064445a57adea2dc3f93c47e"></a><!-- doxytag: member="update_records.c::tur_update_records_extend" ref="a1015e587064445a57adea2dc3f93c47e" args="(struct thandle_update_records *tur, size_t new_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tur_update_records_extend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthandle__update__records.html">thandle_update_records</a> *&nbsp;</td>
          <td class="paramname"> <em>tur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>new_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Extend update records. </p>
<p>Extend <a class="el" href="structupdate__records.html">update_records</a> to the new size in <a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tur</em>&nbsp;</td><td><a class="el" href="structthandle__update__records.html" title="Attached in the thandle to record the updates for distribute distribution.">thandle_update_records</a> where <a class="el" href="structupdate__records.html">update_records</a> will be extended. </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if extension succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if extension fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l01017">1017</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="lustre__update_8h_source.html#l00273">thandle_update_records::tur_update_records</a>, and <a class="el" href="lustre__update_8h_source.html#l00274">thandle_update_records::tur_update_records_buf_size</a>.</p>

<p>Referenced by <a class="el" href="update__trans_8c_source.html#l00343">prepare_writing_updates()</a>, and <a class="el" href="update__records_8c_source.html#l01054">tur_update_extend()</a>.</p>

</div>
</div>
<a class="anchor" id="a50e52cb7df7ffa36c19228b8fd137c28"></a><!-- doxytag: member="update_records.c::update_info_fini" ref="a50e52cb7df7ffa36c19228b8fd137c28" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_info_fini </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="update__records_8c_source.html#l01232">1232</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lu__object_8c_source.html#l01455">lu_context_key_degister()</a>, and <a class="el" href="tgt__internal_8h.html#aa001baf045dcb5ffc759648eceddbccb">update_thread_key</a>.</p>

<p>Referenced by <a class="el" href="tgt__main_8c_source.html#l00413">tgt_mod_exit()</a>.</p>

</div>
</div>
<a class="anchor" id="abb3102b38b590d56d0c531397be53292"></a><!-- doxytag: member="update_records.c::update_info_init" ref="abb3102b38b590d56d0c531397be53292" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_info_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="update__records_8c_source.html#l01226">1226</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lu__object_8c_source.html#l01401">lu_context_key_register()</a>, and <a class="el" href="tgt__internal_8h.html#aa001baf045dcb5ffc759648eceddbccb">update_thread_key</a>.</p>

<p>Referenced by <a class="el" href="tgt__main_8c_source.html#l00393">tgt_mod_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a37c7cabb6a8f94532a8c3b9041d04194"></a><!-- doxytag: member="update_records.c::update_key_fini" ref="a37c7cabb6a8f94532a8c3b9041d04194" args="(const struct lu_context *ctx, struct lu_context_key *key, void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void update_key_fini </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__context.html">lu_context</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__context__key.html">lu_context_key</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="update__records_8c_source.html#l01192">1192</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="obd__support_8h_source.html#l00776">OBD_FREE</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="lustre__update_8h_source.html#l00386">thandle_exec_args::ta_alloc_args</a>, <a class="el" href="lustre__update_8h_source.html#l00387">thandle_exec_args::ta_args</a>, <a class="el" href="lustre__update_8h_source.html#l00277">thandle_update_records::tur_update_params</a>, <a class="el" href="lustre__update_8h_source.html#l00279">thandle_update_records::tur_update_params_buf_size</a>, <a class="el" href="lustre__update_8h_source.html#l00273">thandle_update_records::tur_update_records</a>, <a class="el" href="lustre__update_8h_source.html#l00274">thandle_update_records::tur_update_records_buf_size</a>, <a class="el" href="tgt__internal_8h_source.html#l00263">update_thread_info::uti_tea</a>, and <a class="el" href="tgt__internal_8h_source.html#l00261">update_thread_info::uti_tur</a>.</p>

</div>
</div>
<a class="anchor" id="aa11aad46fa862adb0b2d1a6790c20c36"></a><!-- doxytag: member="update_records.c::update_records_attr_set_pack" ref="aa11aad46fa862adb0b2d1a6790c20c36" args="(const struct lu_env *env, struct update_ops *ops, unsigned int *op_count, size_t *max_ops_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, const struct lu_fid *fid, const struct lu_attr *attr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_records_attr_set_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_ops_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack attr set update. </p>
<p>Pack attr_set update into update records.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>op_count pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>param_count pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to set attr </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>attr</em>&nbsp;</td><td>attribute of attr set</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00410">410</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="lustre__obdo_8h_source.html#l00048">lustre_set_wire_obdo()</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="linux-obdo_8c_source.html#l00052">obdo_from_la()</a>, <a class="el" href="lustre__idl_8h_source.html#l03789">OUT_ATTR_SET</a>, <a class="el" href="cascading__rw_8c_source.html#l00061">size</a>, <a class="el" href="tgt__internal_8h_source.html#l00271">update_env_info()</a>, <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>, and <a class="el" href="tgt__internal_8h_source.html#l00262">update_thread_info::uti_obdo</a>.</p>

</div>
</div>
<a class="anchor" id="a4bf05d79caeadc1273a5a62b66232154"></a><!-- doxytag: member="update_records.c::update_records_attr_set_size" ref="a4bf05d79caeadc1273a5a62b66232154" args="(const struct lu_env *env, const struct lu_fid *fid, const struct lu_attr *attr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t update_records_attr_set_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate attr set update size. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to set attr </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>attr</em>&nbsp;</td><td>attribute of attr set</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>of attr set update. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00382">382</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="cascading__rw_8c_source.html#l00061">size</a>, and <a class="el" href="update__records_8c_source.html#l00257">update_records_update_size()</a>.</p>

</div>
</div>
<a class="anchor" id="a536f2912b198af6ae7b47e81fb5123cb"></a><!-- doxytag: member="update_records.c::update_records_create_pack" ref="a536f2912b198af6ae7b47e81fb5123cb" args="(const struct lu_env *env, struct update_ops *ops, unsigned int *op_count, size_t *max_ops_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, const struct lu_fid *fid, const struct lu_attr *attr, const struct dt_allocation_hint *hint, struct dt_object_format *dof)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_records_create_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_ops_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structdt__allocation__hint.html">dt_allocation_hint</a> *&nbsp;</td>
          <td class="paramname"> <em>hint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object__format.html">dt_object_format</a> *&nbsp;</td>
          <td class="paramname"> <em>dof</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack create update. </p>
<p>Pack create update into update records.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>op_count pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>param_count pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to be created </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>attr</em>&nbsp;</td><td>attribute of the object to be created </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hint</em>&nbsp;</td><td>creation hint </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dof</em>&nbsp;</td><td>creation format information</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00327">327</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l00370">dt_allocation_hint::dah_parent</a>, <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="lustre__idl_8h_source.html#l00765">fid_cpu_to_le()</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="lustre__obdo_8h_source.html#l00048">lustre_set_wire_obdo()</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="linux-obdo_8c_source.html#l00052">obdo_from_la()</a>, <a class="el" href="lustre__idl_8h_source.html#l03785">OUT_CREATE</a>, <a class="el" href="tgt__internal_8h_source.html#l00271">update_env_info()</a>, <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>, and <a class="el" href="tgt__internal_8h_source.html#l00262">update_thread_info::uti_obdo</a>.</p>

</div>
</div>
<a class="anchor" id="a326d1ece7c3e09d476144648cd9c92d3"></a><!-- doxytag: member="update_records.c::update_records_create_size" ref="a326d1ece7c3e09d476144648cd9c92d3" args="(const struct lu_env *env, const struct lu_fid *fid, const struct lu_attr *attr, const struct dt_allocation_hint *hint, struct dt_object_format *dof)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t update_records_create_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structdt__allocation__hint.html">dt_allocation_hint</a> *&nbsp;</td>
          <td class="paramname"> <em>hint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object__format.html">dt_object_format</a> *&nbsp;</td>
          <td class="paramname"> <em>dof</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate create update size. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to be created </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>attr</em>&nbsp;</td><td>attribute of the object to be created </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hint</em>&nbsp;</td><td>creation hint </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dof</em>&nbsp;</td><td>creation format information</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>of create update. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00284">284</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l00370">dt_allocation_hint::dah_parent</a>, and <a class="el" href="update__records_8c_source.html#l00257">update_records_update_size()</a>.</p>

</div>
</div>
<a class="anchor" id="af5e8c053444ba3fed9d4f22db1e0e643"></a><!-- doxytag: member="update_records.c::update_records_dump" ref="af5e8c053444ba3fed9d4f22db1e0e643" args="(const struct update_records *records, unsigned int mask, bool dump_updates)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_records_dump </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structupdate__records.html">update_records</a> *&nbsp;</td>
          <td class="paramname"> <em>records</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>dump_updates</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Dump update record. </p>
<p>Dump all of updates in the <a class="el" href="structupdate__records.html">update_records</a>, mostly for debugging purpose.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>records</em>&nbsp;</td><td>update records to be dumpped </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mask</em>&nbsp;</td><td>debug level mask </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dump_params</em>&nbsp;</td><td>if dump all of updates the updates. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00063">63</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="lustre__idl_8h_source.html#l03812">object_update_param::oup_len</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="lustre__idl_8h_source.html#l04002">update_ops::uops_op</a>, <a class="el" href="lustre__update_8h_source.html#l00105">update_op_next_op()</a>, <a class="el" href="out__lib_8c_source.html#l00043">update_op_str()</a>, <a class="el" href="lustre__update_8h_source.html#l00064">update_params_get_param()</a>, <a class="el" href="lustre__update_8h_source.html#l00126">update_records_get_params()</a>, <a class="el" href="lustre__idl_8h_source.html#l04024">update_records::ur_batchid</a>, <a class="el" href="lustre__idl_8h_source.html#l04025">update_records::ur_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l04023">update_records::ur_master_transno</a>, <a class="el" href="lustre__idl_8h_source.html#l04031">update_records::ur_ops</a>, <a class="el" href="lustre__idl_8h_source.html#l04030">update_records::ur_param_count</a>, and <a class="el" href="lustre__idl_8h_source.html#l04029">update_records::ur_update_count</a>.</p>

<p>Referenced by <a class="el" href="update__recovery_8c_source.html#l01285">distribute_txn_replay_handle()</a>, <a class="el" href="update__recovery_8c_source.html#l00307">dtrq_append_updates()</a>, <a class="el" href="update__recovery_8c_source.html#l00480">dtrq_list_dump()</a>, <a class="el" href="update__trans_8c_source.html#l00343">prepare_writing_updates()</a>, and <a class="el" href="update__trans_8c_source.html#l00167">sub_updates_write()</a>.</p>

</div>
</div>
<a class="anchor" id="ad37f503135c466368b42b72fc0061fe1"></a><!-- doxytag: member="update_records.c::update_records_index_delete_pack" ref="ad37f503135c466368b42b72fc0061fe1" args="(const struct lu_env *env, struct update_ops *ops, unsigned int *op_count, size_t *max_ops_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, const struct lu_fid *fid, const struct dt_key *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_records_index_delete_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_ops_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="dt__object_8c.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack index delete update. </p>
<p>Pack index delete update into update records.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>op_count pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|ount]</em>&nbsp;</td><td>param_count pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to delete index </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>key</em>&nbsp;</td><td>key of deletion</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00716">716</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l03795">OUT_INDEX_DELETE</a>, <a class="el" href="cascading__rw_8c_source.html#l00061">size</a>, and <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>.</p>

</div>
</div>
<a class="anchor" id="a178056dec37f7d672b8c2989b2b3c24d"></a><!-- doxytag: member="update_records.c::update_records_index_delete_size" ref="a178056dec37f7d672b8c2989b2b3c24d" args="(const struct lu_env *env, const struct lu_fid *fid, const struct dt_key *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t update_records_index_delete_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="dt__object_8c.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate index delete update size. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to delete index </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>key</em>&nbsp;</td><td>key of deletion</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>the</em>&nbsp;</td><td>size of index delete update </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00688">688</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="cascading__rw_8c_source.html#l00061">size</a>, and <a class="el" href="update__records_8c_source.html#l00257">update_records_update_size()</a>.</p>

</div>
</div>
<a class="anchor" id="a2ba66c5a47966557f3ac9310ff1774dd"></a><!-- doxytag: member="update_records.c::update_records_index_insert_pack" ref="a2ba66c5a47966557f3ac9310ff1774dd" args="(const struct lu_env *env, struct update_ops *ops, unsigned int *op_count, size_t *max_ops_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, const struct lu_fid *fid, const struct dt_rec *rec, const struct dt_key *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_records_index_insert_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_ops_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct dt_rec *&nbsp;</td>
          <td class="paramname"> <em>rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="dt__object_8c.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack index insert update. </p>
<p>Pack index insert update into update records.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>op_count</em>&nbsp;</td><td>pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>param_count</em>&nbsp;</td><td>pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to insert index </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rec</em>&nbsp;</td><td>record of insertion </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>key</em>&nbsp;</td><td>key of insertion</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00649">649</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="byteorder_8h_source.html#l00057">cpu_to_le32</a>, <a class="el" href="lustre__idl_8h_source.html#l00765">fid_cpu_to_le()</a>, <a class="el" href="lustre__idl_8h_source.html#l03794">OUT_INDEX_INSERT</a>, <a class="el" href="dt__object_8h_source.html#l02684">dt_insert_rec::rec_fid</a>, <a class="el" href="dt__object_8h_source.html#l02689">dt_insert_rec::rec_type</a>, and <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>.</p>

</div>
</div>
<a class="anchor" id="ab0351ffc2e1e9c70f887fbfa8181ab0e"></a><!-- doxytag: member="update_records.c::update_records_index_insert_size" ref="ab0351ffc2e1e9c70f887fbfa8181ab0e" args="(const struct lu_env *env, const struct lu_fid *fid, const struct dt_rec *rec, const struct dt_key *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t update_records_index_insert_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct dt_rec *&nbsp;</td>
          <td class="paramname"> <em>rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="dt__object_8c.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate index insert update size. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to insert index </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rec</em>&nbsp;</td><td>record of insertion </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>key</em>&nbsp;</td><td>key of insertion</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>the</em>&nbsp;</td><td>size of index insert update. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00618">618</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="update__records_8c_source.html#l00618">update_records_index_insert_size()</a>, and <a class="el" href="update__records_8c_source.html#l00257">update_records_update_size()</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l00618">update_records_index_insert_size()</a>.</p>

</div>
</div>
<a class="anchor" id="af2bca6df33e94f5dba3cc73e8020bd66"></a><!-- doxytag: member="update_records.c::update_records_noop_pack" ref="af2bca6df33e94f5dba3cc73e8020bd66" args="(const struct lu_env *env, struct update_ops *ops, unsigned int *op_count, size_t *max_ops_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, const struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_records_noop_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_ops_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack noop update. </p>
<p>Pack no op update into update records. Note: no op means the update does not need do anything, which is only used in test case to verify large size record.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>op_count pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>param_count pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to add reference</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00499">499</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l03800">OUT_NOOP</a>, and <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>.</p>

</div>
</div>
<a class="anchor" id="af464d53afef74f1b3918d3571fa2581e"></a><!-- doxytag: member="update_records.c::update_records_object_destroy_pack" ref="af464d53afef74f1b3918d3571fa2581e" args="(const struct lu_env *env, struct update_ops *ops, unsigned int *op_count, size_t *max_ops_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, const struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_records_object_destroy_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_ops_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack object destroy update. </p>
<p>Pack object destroy update into update records.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>op_count pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>param_count pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to delete reference</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00593">593</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l03786">OUT_DESTROY</a>, and <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>.</p>

</div>
</div>
<a class="anchor" id="a8bb4f27514127c7fddfed05269fddd6e"></a><!-- doxytag: member="update_records.c::update_records_object_destroy_size" ref="a8bb4f27514127c7fddfed05269fddd6e" args="(const struct lu_env *env, const struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t update_records_object_destroy_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate object destroy update size. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to delete reference</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>of object destroy update. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00569">569</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="update__records_8c_source.html#l00257">update_records_update_size()</a>.</p>

</div>
</div>
<a class="anchor" id="adfc09a873cdee1de17b1753f221b2661"></a><!-- doxytag: member="update_records.c::update_records_param_pack" ref="adfc09a873cdee1de17b1753f221b2661" args="(struct update_params *params, const void *new_param, size_t new_param_size, unsigned int *param_count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int update_records_param_pack </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>new_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>new_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack parameters to update records. </p>
<p>Find and insert parameter to update records, if the parameter already exists in <em>params</em>, then just return the offset of this parameter, otherwise insert the parameter and return its offset</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>update params in which to insert parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>new_param</em>&nbsp;</td><td>parameters to be inserted. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>new_param_size</em>&nbsp;</td><td>the size of <em>new_param</em> </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>index</em>&nbsp;</td><td>inside <em>params</em> if parameter insertion succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if it fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00128">128</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l03815">object_update_param::oup_buf</a>, <a class="el" href="lustre__idl_8h_source.html#l03812">object_update_param::oup_len</a>, <a class="el" href="lustre__update_8h_source.html#l00064">update_params_get_param()</a>, and <a class="el" href="lustre__update_8h_source.html#l00045">update_params_size()</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>.</p>

</div>
</div>
<a class="anchor" id="a0c8abdcf750282a719ba9c11582a210e"></a><!-- doxytag: member="update_records.c::update_records_punch_pack" ref="a0c8abdcf750282a719ba9c11582a210e" args="(const struct lu_env *env, struct update_ops *ops, unsigned int *op_count, size_t *max_ops_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, const struct lu_fid *fid, __u64 start, __u64 end)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_records_punch_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_ops_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>end</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack punch. </p>
<p>Pack punch update into update records.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>op_count pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>param_count pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to write into </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>start</em>&nbsp;</td><td>start offset of punch </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>end</em>&nbsp;</td><td>end offet of punch</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00958">958</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="byteorder_8h_source.html#l00059">cpu_to_le64</a>, <a class="el" href="lustre__idl_8h_source.html#l03798">OUT_PUNCH</a>, and <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>.</p>

</div>
</div>
<a class="anchor" id="a22158bbaf3c1c6e48822b0046db9532e"></a><!-- doxytag: member="update_records.c::update_records_punch_size" ref="a22158bbaf3c1c6e48822b0046db9532e" args="(const struct lu_env *env, const struct lu_fid *fid, __u64 start, __u64 end)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t update_records_punch_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>end</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate size of punch update. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to write into </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>start</em>&nbsp;</td><td>start offset of punch </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>end</em>&nbsp;</td><td>end offet of punch</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>of update punch. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00929">929</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="update__records_8c_source.html#l00257">update_records_update_size()</a>.</p>

</div>
</div>
<a class="anchor" id="aa5c1ba7c90bb603fa32b3ce2cc3c80f9"></a><!-- doxytag: member="update_records.c::update_records_ref_add_pack" ref="aa5c1ba7c90bb603fa32b3ce2cc3c80f9" args="(const struct lu_env *env, struct update_ops *ops, unsigned int *op_count, size_t *max_ops_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, const struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_records_ref_add_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_ops_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack ref add update. </p>
<p>Pack ref add update into update records.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>op_count pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>param_count pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to add reference</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00465">465</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l03787">OUT_REF_ADD</a>, and <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>.</p>

</div>
</div>
<a class="anchor" id="ad64a0bb9fb472f09125a383580d779ed"></a><!-- doxytag: member="update_records.c::update_records_ref_add_size" ref="ad64a0bb9fb472f09125a383580d779ed" args="(const struct lu_env *env, const struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t update_records_ref_add_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate ref add update size. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to add reference</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>of ref_add udpate. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00441">441</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="update__records_8c_source.html#l00257">update_records_update_size()</a>.</p>

</div>
</div>
<a class="anchor" id="a5d679792a3b5e49d0170a1ce55df8ce4"></a><!-- doxytag: member="update_records.c::update_records_ref_del_pack" ref="a5d679792a3b5e49d0170a1ce55df8ce4" args="(const struct lu_env *env, struct update_ops *ops, unsigned int *op_count, size_t *max_ops_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, const struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_records_ref_del_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_ops_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack ref del update. </p>
<p>Pack ref del update into update records.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>op_count pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>param_count</em>&nbsp;</td><td>pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to delete reference</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00546">546</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l03788">OUT_REF_DEL</a>, and <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>.</p>

</div>
</div>
<a class="anchor" id="a63d3ba51338da1e9d0ab76f3838d2330"></a><!-- doxytag: member="update_records.c::update_records_ref_del_size" ref="a63d3ba51338da1e9d0ab76f3838d2330" args="(const struct lu_env *env, const struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t update_records_ref_del_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate ref del update size. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to delete reference</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>of ref_del update. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00522">522</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="update__records_8c_source.html#l00257">update_records_update_size()</a>.</p>

</div>
</div>
<a class="anchor" id="a8eca2f7719b11d7f4bce26350591ce40"></a><!-- doxytag: member="update_records.c::update_records_update_pack" ref="a8eca2f7719b11d7f4bce26350591ce40" args="(const struct lu_env *env, const struct lu_fid *fid, enum update_type op_type, struct update_ops *ops, unsigned int *op_count, size_t *max_op_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, unsigned int param_bufs_count, const void **param_bufs, size_t *param_sizes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int update_records_update_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__lustreidl.html#ga2d1a90f202540bfbcbd72a8c0f94b586">update_type</a>&nbsp;</td>
          <td class="paramname"> <em>op_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_op_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>param_bufs_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void **&nbsp;</td>
          <td class="paramname"> <em>param_bufs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>param_sizes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack update to update records. </p>
<p>Pack the update and its parameters to the update records. First it will insert parameters, get the offset of these parameter, then fill the update with these offset. If insertion exceed the maximum size of current update records, it will return -E2BIG here, and the caller might extend the update_record size </p>
<dl class="see"><dt><b>See also:</b></dt><dd>lod_updates_pack.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the update. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>op_type</em>&nbsp;</td><td>operation type of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>op_count pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>param_count pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>param_bufs</em>&nbsp;</td><td>buffers of parameters </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params_buf_count</em>&nbsp;</td><td>the count of the parameter buffers </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>param_size</em>&nbsp;</td><td>sizes of parameters</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00184">184</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="lustre__user_8h_source.html#l01295">cfs_size_round()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>, <a class="el" href="lustre__idl_8h_source.html#l03995">update_op::uop_fid</a>, <a class="el" href="lustre__idl_8h_source.html#l03997">update_op::uop_param_count</a>, <a class="el" href="lustre__idl_8h_source.html#l03998">update_op::uop_params_off</a>, <a class="el" href="lustre__idl_8h_source.html#l03996">update_op::uop_type</a>, <a class="el" href="lustre__update_8h_source.html#l00099">update_op_size()</a>, <a class="el" href="out__lib_8c_source.html#l00043">update_op_str()</a>, <a class="el" href="lustre__update_8h_source.html#l00162">update_ops_get_op()</a>, and <a class="el" href="update__records_8c_source.html#l00128">update_records_param_pack()</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l00410">update_records_attr_set_pack()</a>, <a class="el" href="update__records_8c_source.html#l00327">update_records_create_pack()</a>, <a class="el" href="update__records_8c_source.html#l00716">update_records_index_delete_pack()</a>, <a class="el" href="update__records_8c_source.html#l00649">update_records_index_insert_pack()</a>, <a class="el" href="update__records_8c_source.html#l00499">update_records_noop_pack()</a>, <a class="el" href="update__records_8c_source.html#l00593">update_records_object_destroy_pack()</a>, <a class="el" href="update__records_8c_source.html#l00958">update_records_punch_pack()</a>, <a class="el" href="update__records_8c_source.html#l00465">update_records_ref_add_pack()</a>, <a class="el" href="update__records_8c_source.html#l00546">update_records_ref_del_pack()</a>, <a class="el" href="update__records_8c_source.html#l00896">update_records_write_pack()</a>, <a class="el" href="update__records_8c_source.html#l00837">update_records_xattr_del_pack()</a>, and <a class="el" href="update__records_8c_source.html#l00777">update_records_xattr_set_pack()</a>.</p>

</div>
</div>
<a class="anchor" id="ab9c9d7287a010ab7190c3c4ee5e58de8"></a><!-- doxytag: member="update_records.c::update_records_update_size" ref="ab9c9d7287a010ab7190c3c4ee5e58de8" args="(__u32 param_count, size_t *sizes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static size_t update_records_update_size </td>
          <td>(</td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>sizes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate <a class="el" href="structupdate__records.html">update_records</a> size. </p>
<p>Calculate <a class="el" href="structupdate__records.html">update_records</a> size by param_count and param_sizes array.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>param_count</em>&nbsp;</td><td>the count of parameters </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sizes</em>&nbsp;</td><td>the size array of these parameters</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>the</em>&nbsp;</td><td>size of this update </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00257">257</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lustre__user_8h_source.html#l01295">cfs_size_round()</a>, <a class="el" href="cascading__rw_8c_source.html#l00061">size</a>, and <a class="el" href="lustre__update_8h_source.html#l00099">update_op_size()</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l00382">update_records_attr_set_size()</a>, <a class="el" href="update__records_8c_source.html#l00284">update_records_create_size()</a>, <a class="el" href="update__records_8c_source.html#l00688">update_records_index_delete_size()</a>, <a class="el" href="update__records_8c_source.html#l00618">update_records_index_insert_size()</a>, <a class="el" href="update__records_8c_source.html#l00569">update_records_object_destroy_size()</a>, <a class="el" href="update__records_8c_source.html#l00929">update_records_punch_size()</a>, <a class="el" href="update__records_8c_source.html#l00441">update_records_ref_add_size()</a>, <a class="el" href="update__records_8c_source.html#l00522">update_records_ref_del_size()</a>, <a class="el" href="update__records_8c_source.html#l00866">update_records_write_size()</a>, <a class="el" href="update__records_8c_source.html#l00809">update_records_xattr_del_size()</a>, and <a class="el" href="update__records_8c_source.html#l00746">update_records_xattr_set_size()</a>.</p>

</div>
</div>
<a class="anchor" id="ac13bcde2bee8f3032877e62eaef1841f"></a><!-- doxytag: member="update_records.c::update_records_write_pack" ref="ac13bcde2bee8f3032877e62eaef1841f" args="(const struct lu_env *env, struct update_ops *ops, unsigned int *op_count, size_t *max_ops_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, const struct lu_fid *fid, const struct lu_buf *buf, __u64 pos)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_records_write_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_ops_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>pos</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack write update. </p>
<p>Pack write update into update records.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>op_count pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>param_count pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to write into </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>buffer to write which includes an embedded size field </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pos</em>&nbsp;</td><td>offet in the object to start writing at</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00896">896</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="byteorder_8h_source.html#l00059">cpu_to_le64</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="lustre__idl_8h_source.html#l03796">OUT_WRITE</a>, <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>, and <a class="el" href="update__records_8c_source.html#l00896">update_records_write_pack()</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l00896">update_records_write_pack()</a>.</p>

</div>
</div>
<a class="anchor" id="a9a613a028497e370001345de3c47ee5b"></a><!-- doxytag: member="update_records.c::update_records_write_size" ref="a9a613a028497e370001345de3c47ee5b" args="(const struct lu_env *env, const struct lu_fid *fid, const struct lu_buf *buf, __u64 pos)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t update_records_write_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>pos</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate write update size. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to write into </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>buffer to write which includes an embedded size field </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pos</em>&nbsp;</td><td>offet in the object to start writing at</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>of write udpate. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00866">866</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="update__records_8c_source.html#l00257">update_records_update_size()</a>, and <a class="el" href="update__records_8c_source.html#l00866">update_records_write_size()</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l00866">update_records_write_size()</a>.</p>

</div>
</div>
<a class="anchor" id="a79c727b585d2b96accddc19a646fecb5"></a><!-- doxytag: member="update_records.c::update_records_xattr_del_pack" ref="a79c727b585d2b96accddc19a646fecb5" args="(const struct lu_env *env, struct update_ops *ops, unsigned int *op_count, size_t *max_ops_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, const struct lu_fid *fid, const char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_records_xattr_del_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_ops_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack xattr delete update. </p>
<p>Pack xattr delete update into update records.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>op_count pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>param_count pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to delete xattr </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>name of the xattr</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00837">837</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l03797">OUT_XATTR_DEL</a>, <a class="el" href="cascading__rw_8c_source.html#l00061">size</a>, and <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>.</p>

</div>
</div>
<a class="anchor" id="a6c4c7df106878116b11868e232551086"></a><!-- doxytag: member="update_records.c::update_records_xattr_del_size" ref="a6c4c7df106878116b11868e232551086" args="(const struct lu_env *env, const struct lu_fid *fid, const char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t update_records_xattr_del_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate xattr delete update size. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to delete xattr </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>name of the xattr</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>of xattr delet updatee. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00809">809</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="cascading__rw_8c_source.html#l00061">size</a>, and <a class="el" href="update__records_8c_source.html#l00257">update_records_update_size()</a>.</p>

</div>
</div>
<a class="anchor" id="ab5cbaa54ac4deb3eb969c29688a56f28"></a><!-- doxytag: member="update_records.c::update_records_xattr_set_pack" ref="ab5cbaa54ac4deb3eb969c29688a56f28" args="(const struct lu_env *env, struct update_ops *ops, unsigned int *op_count, size_t *max_ops_size, struct update_params *params, unsigned int *param_count, size_t *max_param_size, const struct lu_fid *fid, const struct lu_buf *buf, const char *name, __u32 flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_records_xattr_set_pack </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__ops.html">update_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>op_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_ops_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structupdate__params.html">update_params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&nbsp;</td>
          <td class="paramname"> <em>param_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>max_param_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack xattr set update. </p>
<p>Pack xattr set update into update records.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ops</em>&nbsp;</td><td>ur_ops in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>op_count pointer to the count of ops </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_op_size maximum size of the update </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>ur_params in update records </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>param_count pointer to the count of params </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in|out]</em>&nbsp;</td><td>max_param_size maximum size of the parameter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to set xattr </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>xattr to be set </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>name of the xattr </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>flag</em>&nbsp;</td><td>flag for setting xattr</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00777">777</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="byteorder_8h_source.html#l00057">cpu_to_le32</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="lustre__idl_8h_source.html#l03791">OUT_XATTR_SET</a>, <a class="el" href="update__records_8c_source.html#l00184">update_records_update_pack()</a>, and <a class="el" href="update__records_8c_source.html#l00777">update_records_xattr_set_pack()</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l00777">update_records_xattr_set_pack()</a>.</p>

</div>
</div>
<a class="anchor" id="ac4e8a1f313a91e3776612c227750ac27"></a><!-- doxytag: member="update_records.c::update_records_xattr_set_size" ref="ac4e8a1f313a91e3776612c227750ac27" args="(const struct lu_env *env, const struct lu_fid *fid, const struct lu_buf *buf, const char *name, __u32 flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t update_records_xattr_set_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate xattr set size. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object to set xattr </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>xattr to be set </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>name of the xattr </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>flag</em>&nbsp;</td><td>flag for setting xattr</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>of xattr set update. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="update__records_8c_source.html#l00746">746</a> of file <a class="el" href="update__records_8c_source.html">update_records.c</a>.</p>

<p>References <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="update__records_8c_source.html#l00257">update_records_update_size()</a>, and <a class="el" href="update__records_8c_source.html#l00746">update_records_xattr_set_size()</a>.</p>

<p>Referenced by <a class="el" href="update__records_8c_source.html#l00746">update_records_xattr_set_size()</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:51 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
