<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/ptlrpc/sec.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/ptlrpc/sec.c File Reference</h1><code>#include &lt;linux/user_namespace.h&gt;</code><br/>
<code>#include &lt;linux/crypto.h&gt;</code><br/>
<code>#include &lt;linux/key.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="libcfs_8h_source.html">libcfs/libcfs.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd_8h_source.html">obd.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__class_8h_source.html">obd_class.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__support_8h_source.html">obd_support.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__net_8h_source.html">lustre_net.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__import_8h_source.html">lustre_import.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__dlm_8h_source.html">lustre_dlm.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__sec_8h_source.html">lustre_sec.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="ptlrpc__internal_8h_source.html">ptlrpc_internal.h</a>&quot;</code><br/>

<p><a href="sec_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>&nbsp;&nbsp;&nbsp;S_SEC</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a27e996b3bb0d1419ff59f958af5e5f6b">EXP_FLVR_UPDATE_EXPIRE</a>&nbsp;&nbsp;&nbsp;(OBD_TIMEOUT_DEFAULT + 10)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga1a05c039cd87056cf638e2051cf3fe83">sptlrpc_register_policy</a> (struct <a class="el" href="structptlrpc__sec__policy.html">ptlrpc_sec_policy</a> *policy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gaed742582f21f7873e14c565bbbf25ff2">sptlrpc_unregister_policy</a> (struct <a class="el" href="structptlrpc__sec__policy.html">ptlrpc_sec_policy</a> *policy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structptlrpc__sec__policy.html">ptlrpc_sec_policy</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#afb9bb4727d146b44d3b91883ef3ca99c">sptlrpc_wireflavor2policy</a> (__u32 flavor)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga912a600308193abc2eec4daee744cfca">sptlrpc_name2flavor_base</a> (const char *<a class="el" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga3132dfbf193fbf12fff8c2b03a9f8b45">sptlrpc_flavor2name_base</a> (__u32 flvr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gaa1315e2959982e95e86a8627d34bd408">sptlrpc_flavor2name_bulk</a> (struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *sf, char *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, int <a class="el" href="multiop_8c.html#a199ab88d4ca8eab30e1cb7d35edacca5">bufsize</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga06e6b1fc8fbc7addf5900923b0469d6a">sptlrpc_flavor2name</a> (struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *sf, char *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, int <a class="el" href="multiop_8c.html#a199ab88d4ca8eab30e1cb7d35edacca5">bufsize</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga325dd2fed56fea11600d8cc135b19b41">sptlrpc_secflags2str</a> (__u32 flags, char *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, int <a class="el" href="multiop_8c.html#a199ab88d4ca8eab30e1cb7d35edacca5">bufsize</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#ab4be1435d16423d1a4e503916160bfbb">get_my_ctx</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gab9129ba640c50c1a8b7d3e50bfec54f4">sptlrpc_cli_ctx_get</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga69f6e7f870c1215e81c9e939d790ae3b">sptlrpc_cli_ctx_put</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx, int sync)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga6c05663895d669f077f0369232b46dad">sptlrpc_cli_ctx_expire</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Expire the client context immediately.  <a href="group__sptlrpc.html#ga6c05663895d669f077f0369232b46dad"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gae8509673f10f3ba05986d960f5b4a20d">sptlrpc_cli_ctx_wakeup</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">To wake up the threads who are waiting for this client context.  <a href="group__sptlrpc.html#gae8509673f10f3ba05986d960f5b4a20d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga606c9a5cf4f1a5a6668ff8d1ea65bb5e">sptlrpc_cli_ctx_display</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx, char *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, int <a class="el" href="multiop_8c.html#a199ab88d4ca8eab30e1cb7d35edacca5">bufsize</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a7421358574e6bfecfe92c4f78e742c00">import_sec_check_expire</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a71e98c4ed89ba8d118536a554d316cc8">import_sec_validate_get</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp, struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> **sec)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get and validate the client side ptlrpc security facilities from <em>imp</em>.  <a href="#a71e98c4ed89ba8d118536a554d316cc8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga5aafb085a9167ed0295a28d4bddb5847">sptlrpc_req_get_ctx</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a <em>req</em>, find or allocate an appropriate context for it.  <a href="group__sptlrpc.html#ga5aafb085a9167ed0295a28d4bddb5847"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga9c506dfa976b8fa42f6d351f1a67098c">sptlrpc_req_put_ctx</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int sync)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Drop the context for <em>req</em>.  <a href="group__sptlrpc.html#ga9c506dfa976b8fa42f6d351f1a67098c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#ad71829360197a42fb2e92bcb78861abc">sptlrpc_req_ctx_switch</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *oldctx, struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *newctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga7254cf32b0cefed6242f298d3326e8dd">sptlrpc_req_replace_dead_ctx</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">If current context of <em>req</em> is dead somehow, e.g.  <a href="group__sptlrpc.html#ga7254cf32b0cefed6242f298d3326e8dd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a6d85f232754b7f32f6d81e690c928740">ctx_check_refresh</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a53429c85be016a96a7f50d623ce05815">ctx_refresh_timeout</a> (void *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a5dd4a775f8b530e4fc436c548763d11e">ctx_refresh_interrupt</a> (void *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a0546a42c84c4b68ffa1a1680444ec9e8">req_off_ctx_list</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga94cbed545313e8c7bc6a682a438c89b0">sptlrpc_req_refresh_ctx</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, long <a class="el" href="o2iblnd__modparams_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">To refresh the context of , if it's not up-to-date.  <a href="group__sptlrpc.html#ga94cbed545313e8c7bc6a682a438c89b0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga701bf20eebf0fd9d03c94918418f3b31">sptlrpc_req_set_flavor</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int opcode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize flavor settings for <em>req</em>, according to <em>opcode</em>.  <a href="group__sptlrpc.html#ga701bf20eebf0fd9d03c94918418f3b31"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga61d2d3a2133c043d3998bd7a473f3937">sptlrpc_request_out_callback</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gaa43ec50fcb7c93e96d80c8b544da92a5">sptlrpc_import_check_ctx</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given an import <em>imp</em>, check whether current user has a valid context or not.  <a href="group__sptlrpc.html#gaa43ec50fcb7c93e96d80c8b544da92a5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga2b508842c18d6c0a32c9678445565ce2">sptlrpc_cli_wrap_request</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc client, to perform the pre-defined security transformation upon the request message of <em>req</em>.  <a href="group__sptlrpc.html#ga2b508842c18d6c0a32c9678445565ce2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a60f58b2a5bbbf0c33335a9bf85fcbdc5">do_cli_unwrap_reply</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga4e652d7f03a8727b8eb9c290936aec23">sptlrpc_cli_unwrap_reply</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc client, to perform security transformation upon the reply message of <em>req</em>.  <a href="group__sptlrpc.html#ga4e652d7f03a8727b8eb9c290936aec23"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga555969de6cd1c126c5a8887b740e1354">sptlrpc_cli_unwrap_early_reply</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> **req_ret)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc client, to perform security transformation upon the early reply message of <em>req</em>.  <a href="group__sptlrpc.html#ga555969de6cd1c126c5a8887b740e1354"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga9e900c41f0c033d65d6a108d1a1a553c">sptlrpc_cli_finish_early_reply</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *early_req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc client, to release a processed early reply <em>early_req</em>.  <a href="group__sptlrpc.html#ga9e900c41f0c033d65d6a108d1a1a553c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga4b64d60127ec57a387ff0477a9ae64f5">sptlrpc_get_next_secid</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#aee65856b19bef55e18c7cad2015ba224">sec_cop_flush_ctx_cache</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, uid_t uid, int grace, int force)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a91c850f5692e2deaf21f0dc75c9bc884">sec_cop_destroy_sec</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga5c544de8ca3702af15a342280e984797">sptlrpc_sec_destroy</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#ad6144b9e43fd5f6ece490d8e7bb97a13">sptlrpc_sec_kill</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga46b62f214acc7091ec6a686b6b7e7467">sptlrpc_sec_get</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga7614fad9d6201ee956c2b8c591b63e27">sptlrpc_sec_put</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#ac9b77912f15b5fe483e82afec3597eec">sptlrpc_sec_create</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp, struct <a class="el" href="structptlrpc__svc__ctx.html">ptlrpc_svc_ctx</a> *svc_ctx, struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *sf, enum <a class="el" href="group__sptlrpc.html#gaceeb8c40afd0179b5b42fc19aa58d177">lustre_sec_part</a> sp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gaaaacc60ce00e1c012d6a657e285853f6">sptlrpc_import_sec_ref</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a5d2f64090369eb520b37b7f8e3c7d19a">sptlrpc_import_sec_install</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp, struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a382e7bcc43f72af700384142eb65a7b7">flavor_equal</a> (struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *sf1, struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *sf2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#af65bc0e956d231d20e8281ab9a471210">flavor_copy</a> (struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *dst, struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *src)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a333d45f5d69dadb739275036609acdfd">sptlrpc_import_sec_adapt_inplace</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp, struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *sf)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga01235b3d6bd59ff6adee314742be930b">sptlrpc_import_sec_adapt</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp, struct <a class="el" href="structptlrpc__svc__ctx.html">ptlrpc_svc_ctx</a> *svc_ctx, struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *flvr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">To get an appropriate <a class="el" href="structptlrpc__sec.html" title="The ptlrpc_sec represents the client side ptlrpc security facilities, each obd_import...">ptlrpc_sec</a> for the <em>imp</em>, according to the current configuration.  <a href="group__sptlrpc.html#ga01235b3d6bd59ff6adee314742be930b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga1abd65eeaa270acbef838fcbccaaeac5">sptlrpc_import_sec_put</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a6039f781b088e008fea1c292a7835b2e">import_flush_ctx_common</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp, uid_t uid, int grace, int force)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gad4617ddc0fa8e067bbc8737e446c22d4">sptlrpc_import_flush_root_ctx</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga84bad1e7778dc00a63e61ecd39032ef9">sptlrpc_import_flush_my_ctx</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga92154e132fba9ee6e8452e2694efcedd">sptlrpc_import_flush_all_ctx</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gaafb426af1f450b0f25952ba1b38f640d">sptlrpc_cli_alloc_reqbuf</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int msgsize)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc client to allocate request buffer of <em>req</em>.  <a href="group__sptlrpc.html#gaafb426af1f450b0f25952ba1b38f640d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga2f36863ed408b2fc13f7a04eb6280dd4">sptlrpc_cli_free_reqbuf</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc client to free request buffer of <em>req</em>.  <a href="group__sptlrpc.html#ga2f36863ed408b2fc13f7a04eb6280dd4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gafd69575358901d3eef6fab761a1eeea2">_sptlrpc_enlarge_msg_inplace</a> (struct lustre_msg *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, int segment, int newsize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gae060941c4c97b1cb7ba03904a24b53c3">sptlrpc_cli_enlarge_reqbuf</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int segment, int newsize)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc client to enlarge the <em>segment</em> of request message pointed by req-&gt;rq_reqmsg to size <em>newsize</em>, all previously filled-in data will be preserved after the enlargement.  <a href="group__sptlrpc.html#gae060941c4c97b1cb7ba03904a24b53c3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga2059ff503d15d0b06699e153845bc66f">sptlrpc_cli_alloc_repbuf</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int msgsize)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc client to allocate reply buffer of <em>req</em>.  <a href="group__sptlrpc.html#ga2059ff503d15d0b06699e153845bc66f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga6cd89bd371e4a81930e260bb1b8c79f8">sptlrpc_cli_free_repbuf</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc client to free reply buffer of <em>req</em>.  <a href="group__sptlrpc.html#ga6cd89bd371e4a81930e260bb1b8c79f8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga78e7e46d42204a9fc6366341ca7825a6">sptlrpc_cli_install_rvs_ctx</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp, struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gaa6cf2336242cfbca59edb26b9444508a">sptlrpc_svc_install_rvs_ctx</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp, struct <a class="el" href="structptlrpc__svc__ctx.html">ptlrpc_svc_ctx</a> *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a87c82f8d426e03b1f4afbe7a11511b25">flavor_allowed</a> (struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *exp, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gaf12efdd6553013c0e886d356541dd86b">sptlrpc_target_export_check</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given an export <em>exp</em>, check whether the flavor of incoming <em>req</em> is allowed by the export <em>exp</em>.  <a href="group__sptlrpc.html#gaf12efdd6553013c0e886d356541dd86b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga722b78e23977e8a40890e54e043fb743">sptlrpc_target_update_exp_flavor</a> (struct <a class="el" href="structobd__device.html">obd_device</a> *obd, struct <a class="el" href="structsptlrpc__rule__set.html">sptlrpc_rule_set</a> *rset)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a8f86b39041d37b1c534e76f54f3dfa73">sptlrpc_svc_check_from</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int svc_rc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga6fdd12db4bcfd925fed91da8a4ecf857">sptlrpc_svc_unwrap_request</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc server, to perform transformation upon request message of incoming <em>req</em>.  <a href="group__sptlrpc.html#ga6fdd12db4bcfd925fed91da8a4ecf857"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga1bcf6cf901c5c461f6f273a9b764430a">sptlrpc_svc_alloc_rs</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int msglen)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc server, to allocate reply buffer for <em>req</em>.  <a href="group__sptlrpc.html#ga1bcf6cf901c5c461f6f273a9b764430a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gaa36445bb3135100651ecb584e151f3cb">sptlrpc_svc_wrap_reply</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc server, to perform transformation upon reply message.  <a href="group__sptlrpc.html#gaa36445bb3135100651ecb584e151f3cb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga993608bc2cfa31615e26f5f368801d30">sptlrpc_svc_free_rs</a> (struct <a class="el" href="structptlrpc__reply__state.html">ptlrpc_reply_state</a> *rs)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by ptlrpc server, to free reply_state.  <a href="group__sptlrpc.html#ga993608bc2cfa31615e26f5f368801d30"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gac66b97b1dc648126eca05d226eb472d4">sptlrpc_svc_ctx_addref</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gabb77528ba2594382bae01ea165279b33">sptlrpc_svc_ctx_decref</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga190589b71fa07942382f910717c24698">sptlrpc_svc_ctx_invalidate</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gae9ac9239c38fc5eb10c0951976a38512">sptlrpc_cli_wrap_bulk</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *desc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Perform transformation upon bulk data pointed by <em>desc</em>.  <a href="group__sptlrpc.html#gae9ac9239c38fc5eb10c0951976a38512"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga40f686bb862f149e189cf81f3a51a7c3">sptlrpc_cli_unwrap_bulk_read</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *desc, int nob)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This is called after unwrap the reply message.  <a href="group__sptlrpc.html#ga40f686bb862f149e189cf81f3a51a7c3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga4a0448bc155a2dd383e108188f99beec">sptlrpc_cli_unwrap_bulk_write</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structptlrpc__bulk__desc.html">ptlrpc_bulk_desc</a> *desc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This is called after unwrap the reply message.  <a href="group__sptlrpc.html#ga4a0448bc155a2dd383e108188f99beec"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gacf61d7452ef3a6935b30b6dba4ba8039">sptlrpc_current_user_desc_size</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gab78c9aec11cc11bf54cec647da66230f">sptlrpc_pack_user_desc</a> (struct lustre_msg *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, int offset)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#ga3e53853e63a860a62a3b72b4f13f5632">sptlrpc_unpack_user_desc</a> (struct lustre_msg *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, int offset, int swabbed)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gafca48f8057fe571c4bfb390c91959ed4">sec2target_str</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sptlrpc.html#gaa80ab1abf7cfff17fd225a9cc473ea33">sptlrpc_flavor_has_bulk</a> (struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *flvr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a85cf05726ee3abcf3a3c9d82b267445d">sptlrpc_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#af4c088cbb797dc841ec45509b2626147">sptlrpc_fini</a> (void)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static rwlock_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a0ed0bbaea3aeb7c7d9b2422269cc8577">policy_lock</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structptlrpc__sec__policy.html">ptlrpc_sec_policy</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a2cb591bc9afa8f2a4f7e74adb4bfede7">policies</a> [SPTLRPC_POLICY_MAX]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static atomic_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec_8c.html#a1456be82ec79a3c94348466dc066a4c1">sptlrpc_sec_id</a> = ATOMIC_INIT(1)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="abda60744d497fcfe370cfd6b2d65c7ed"></a><!-- doxytag: member="sec.c::DEBUG_SUBSYSTEM" ref="abda60744d497fcfe370cfd6b2d65c7ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_SUBSYSTEM&nbsp;&nbsp;&nbsp;S_SEC</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l00041">41</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

</div>
</div>
<a class="anchor" id="a27e996b3bb0d1419ff59f958af5e5f6b"></a><!-- doxytag: member="sec.c::EXP_FLVR_UPDATE_EXPIRE" ref="a27e996b3bb0d1419ff59f958af5e5f6b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EXP_FLVR_UPDATE_EXPIRE&nbsp;&nbsp;&nbsp;(OBD_TIMEOUT_DEFAULT + 10)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01790">1790</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01797">sptlrpc_target_export_check()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a6d85f232754b7f32f6d81e690c928740"></a><!-- doxytag: member="sec.c::ctx_check_refresh" ref="a6d85f232754b7f32f6d81e690c928740" args="(struct ptlrpc_cli_ctx *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ctx_check_refresh </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l00614">614</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l01001">cli_ctx_is_refreshed()</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l00675">sptlrpc_req_refresh_ctx()</a>.</p>

</div>
</div>
<a class="anchor" id="a5dd4a775f8b530e4fc436c548763d11e"></a><!-- doxytag: member="sec.c::ctx_refresh_interrupt" ref="a5dd4a775f8b530e4fc436c548763d11e" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ctx_refresh_interrupt </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l00643">643</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="lustre__net_8h_source.html#l00968">ptlrpc_request::rq_intr</a>, and <a class="el" href="lustre__net_8h_source.html#l00966">ptlrpc_request::rq_lock</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l00675">sptlrpc_req_refresh_ctx()</a>.</p>

</div>
</div>
<a class="anchor" id="a53429c85be016a96a7f50d623ce05815"></a><!-- doxytag: member="sec.c::ctx_refresh_timeout" ref="a53429c85be016a96a7f50d623ce05815" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ctx_refresh_timeout </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l00622">622</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="lustre__import_8h_source.html#l00239">obd_import::imp_conn_cnt</a>, <a class="el" href="pack__generic_8c_source.html#l01454">lustre_msg_set_conn_cnt()</a>, <a class="el" href="client_8c_source.html#l02050">ptlrpc_expire_one_request()</a>, <a class="el" href="lustre__net_8h_source.html#l01104">ptlrpc_request::rq_import</a>, and <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l00675">sptlrpc_req_refresh_ctx()</a>.</p>

</div>
</div>
<a class="anchor" id="a60f58b2a5bbbf0c33335a9bf85fcbdc5"></a><!-- doxytag: member="sec.c::do_cli_unwrap_reply" ref="a60f58b2a5bbbf0c33335a9bf85fcbdc5" args="(struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int do_cli_unwrap_reply </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01021">1021</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="pack__generic_8c_source.html#l00574">__lustre_unpack_msg()</a>, <a class="el" href="lustre__sec_8h_source.html#l00538">ptlrpc_cli_ctx::cc_ops</a>, <a class="el" href="lustre__sec_8h_source.html#l00537">ptlrpc_cli_ctx::cc_sec</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="lustre__idl_8h_source.html#l01047">lustre_msg</a>, <a class="el" href="lustre__net_8h_source.html#l01217">lustre_set_rep_swabbed()</a>, <a class="el" href="lustre__idl_8h_source.html#l01144">MSG_PTLRPC_HEADER_OFF</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_init</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__net_8h_source.html#l01097">ptlrpc_request::rq_rep_swab_mask</a>, <a class="el" href="lustre__net_8h_source.html#l01080">ptlrpc_request::rq_repbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01081">ptlrpc_request::rq_repdata</a>, <a class="el" href="lustre__net_8h_source.html#l01087">ptlrpc_request::rq_repdata_len</a>, <a class="el" href="lustre__net_8h_source.html#l01032">ptlrpc_request::rq_repmsg</a>, <a class="el" href="lustre__net_8h_source.html#l00968">ptlrpc_request::rq_resend</a>, <a class="el" href="lustre__net_8h_source.html#l01036">ptlrpc_request::rq_xid</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00152">SPTLRPC_FLVR_POLICY</a>, <a class="el" href="lustre__sec_8h_source.html#l00156">SPTLRPC_FLVR_SVC</a>, <a class="el" href="lustre__sec_8h_source.html#l00088">SPTLRPC_POLICY_NULL</a>, <a class="el" href="lustre__sec_8h_source.html#l00113">SPTLRPC_SVC_AUTH</a>, <a class="el" href="lustre__sec_8h_source.html#l00114">SPTLRPC_SVC_INTG</a>, <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>, <a class="el" href="lustre__sec_8h_source.html#l00115">SPTLRPC_SVC_PRIV</a>, <a class="el" href="structptlrpc__ctx__ops.html#adfd6f5c19365d9e9d49f6e52ca55be61">ptlrpc_ctx_ops::unseal</a>, and <a class="el" href="structptlrpc__ctx__ops.html#af81c94560ecbdcb48151bd89767d9f75">ptlrpc_ctx_ops::verify</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01130">sptlrpc_cli_unwrap_early_reply()</a>, and <a class="el" href="sec_8c_source.html#l01090">sptlrpc_cli_unwrap_reply()</a>.</p>

</div>
</div>
<a class="anchor" id="a87c82f8d426e03b1f4afbe7a11511b25"></a><!-- doxytag: member="sec.c::flavor_allowed" ref="a87c82f8d426e03b1f4afbe7a11511b25" args="(struct sptlrpc_flavor *exp, struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int flavor_allowed </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01773">1773</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_fini</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_init</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00251">SPTLRPC_FLVR_ANY</a>, <a class="el" href="lustre__sec_8h_source.html#l00154">SPTLRPC_FLVR_MECH</a>, and <a class="el" href="lustre__sec_8h_source.html#l00152">SPTLRPC_FLVR_POLICY</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01797">sptlrpc_target_export_check()</a>.</p>

</div>
</div>
<a class="anchor" id="af65bc0e956d231d20e8281ab9a471210"></a><!-- doxytag: member="sec.c::flavor_copy" ref="af65bc0e956d231d20e8281ab9a471210" args="(struct sptlrpc_flavor *dst, struct sptlrpc_flavor *src)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void flavor_copy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *&nbsp;</td>
          <td class="paramname"> <em>src</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01408">1408</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01413">sptlrpc_import_sec_adapt_inplace()</a>.</p>

</div>
</div>
<a class="anchor" id="a382e7bcc43f72af700384142eb65a7b7"></a><!-- doxytag: member="sec.c::flavor_equal" ref="a382e7bcc43f72af700384142eb65a7b7" args="(struct sptlrpc_flavor *sf1, struct sptlrpc_flavor *sf2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int flavor_equal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *&nbsp;</td>
          <td class="paramname"> <em>sf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *&nbsp;</td>
          <td class="paramname"> <em>sf2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01402">1402</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01438">sptlrpc_import_sec_adapt()</a>, and <a class="el" href="sec_8c_source.html#l01977">sptlrpc_target_update_exp_flavor()</a>.</p>

</div>
</div>
<a class="anchor" id="ab4be1435d16423d1a4e503916160bfbb"></a><!-- doxytag: member="sec.c::get_my_ctx" ref="ab4be1435d16423d1a4e503916160bfbb" args="(struct ptlrpc_sec *sec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a>* get_my_ctx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l00271">271</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="curproc_8h_source.html#l00085">from_kgid()</a>, <a class="el" href="curproc_8h_source.html#l00080">from_kuid()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="structptlrpc__sec__cops.html#ab3722080e66868d83901a114d4ac3897">ptlrpc_sec_cops::lookup_ctx</a>, <a class="el" href="lustre__sec_8h_source.html#l00852">ptlrpc_sec::ps_flvr</a>, <a class="el" href="lustre__sec_8h_source.html#l00846">ptlrpc_sec::ps_policy</a>, <a class="el" href="lustre__sec_8h_source.html#l00832">PTLRPC_SEC_FL_REVERSE</a>, <a class="el" href="lustre__sec_8h_source.html#l00833">PTLRPC_SEC_FL_ROOTONLY</a>, <a class="el" href="lustre__sec_8h_source.html#l00296">sptlrpc_flavor::sf_flags</a>, <a class="el" href="lustre__sec_8h_source.html#l00828">ptlrpc_sec_policy::sp_cops</a>, <a class="el" href="lustre__sec_8h_source.html#l00393">vfs_cred::vc_gid</a>, and <a class="el" href="lustre__sec_8h_source.html#l00392">vfs_cred::vc_uid</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l00926">sptlrpc_import_check_ctx()</a>, and <a class="el" href="sec_8c_source.html#l00425">sptlrpc_req_get_ctx()</a>.</p>

</div>
</div>
<a class="anchor" id="a6039f781b088e008fea1c292a7835b2e"></a><!-- doxytag: member="sec.c::import_flush_ctx_common" ref="a6039f781b088e008fea1c292a7835b2e" args="(struct obd_import *imp, uid_t uid, int grace, int force)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void import_flush_ctx_common </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__import.html">obd_import</a> *&nbsp;</td>
          <td class="paramname"> <em>imp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uid_t&nbsp;</td>
          <td class="paramname"> <em>uid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>grace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>force</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01540">1540</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="sec_8c_source.html#l01251">sec_cop_flush_ctx_cache()</a>, <a class="el" href="sec_8c_source.html#l01369">sptlrpc_import_sec_ref()</a>, and <a class="el" href="sec_8c_source.html#l01302">sptlrpc_sec_put()</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01570">sptlrpc_import_flush_all_ctx()</a>, <a class="el" href="sec_8c_source.html#l01563">sptlrpc_import_flush_my_ctx()</a>, and <a class="el" href="sec_8c_source.html#l01556">sptlrpc_import_flush_root_ctx()</a>.</p>

</div>
</div>
<a class="anchor" id="a7421358574e6bfecfe92c4f78e742c00"></a><!-- doxytag: member="sec.c::import_sec_check_expire" ref="a7421358574e6bfecfe92c4f78e742c00" args="(struct obd_import *imp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int import_sec_check_expire </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__import.html">obd_import</a> *&nbsp;</td>
          <td class="paramname"> <em>imp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l00357">357</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="linux-time_8h_source.html#l00157">cfs_time_current_sec()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="lustre__import_8h_source.html#l00274">obd_import::imp_lock</a>, <a class="el" href="lustre__import_8h_source.html#l00213">obd_import::imp_sec_expire</a>, and <a class="el" href="sec_8c_source.html#l01438">sptlrpc_import_sec_adapt()</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l00389">import_sec_validate_get()</a>.</p>

</div>
</div>
<a class="anchor" id="a71e98c4ed89ba8d118536a554d316cc8"></a><!-- doxytag: member="sec.c::import_sec_validate_get" ref="a71e98c4ed89ba8d118536a554d316cc8" args="(struct obd_import *imp, struct ptlrpc_sec **sec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int import_sec_validate_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__import.html">obd_import</a> *&nbsp;</td>
          <td class="paramname"> <em>imp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> **&nbsp;</td>
          <td class="paramname"> <em>sec</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get and validate the client side ptlrpc security facilities from <em>imp</em>. </p>
<p>There is a race condition on client reconnect when the import is being destroyed while there are outstanding client bound requests. In this case do not output any error messages if import secuity is not found.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>imp</em>&nbsp;</td><td>obd import associated with client </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>sec</em>&nbsp;</td><td>client side ptlrpc security</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if security retrieved successfully </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-ve</em>&nbsp;</td><td>errno if there was a problem </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sec_8c_source.html#l00389">389</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="lustre__import_8h_source.html#l00213">obd_import::imp_sec_expire</a>, <a class="el" href="lustre__import_8h_source.html#l00230">obd_import::imp_state</a>, <a class="el" href="lustre__import_8h_source.html#l00176">obd_import::imp_zombie_chain</a>, <a class="el" href="sec_8c_source.html#l00357">import_sec_check_expire()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="lustre__import_8h_source.html#l00111">ptlrpc_import_state_name()</a>, <a class="el" href="sec_8c_source.html#l01369">sptlrpc_import_sec_ref()</a>, <a class="el" href="sec_8c_source.html#l01302">sptlrpc_sec_put()</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l00425">sptlrpc_req_get_ctx()</a>, and <a class="el" href="sec_8c_source.html#l00675">sptlrpc_req_refresh_ctx()</a>.</p>

</div>
</div>
<a class="anchor" id="a0546a42c84c4b68ffa1a1680444ec9e8"></a><!-- doxytag: member="sec.c::req_off_ctx_list" ref="a0546a42c84c4b68ffa1a1680444ec9e8" args="(struct ptlrpc_request *req, struct ptlrpc_cli_ctx *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void req_off_ctx_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l00653">653</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00543">ptlrpc_cli_ctx::cc_lock</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, and <a class="el" href="list_8h_source.html#l00161">list_empty()</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l00675">sptlrpc_req_refresh_ctx()</a>.</p>

</div>
</div>
<a class="anchor" id="a91c850f5692e2deaf21f0dc75c9bc884"></a><!-- doxytag: member="sec.c::sec_cop_destroy_sec" ref="a91c850f5692e2deaf21f0dc75c9bc884" args="(struct ptlrpc_sec *sec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void sec_cop_destroy_sec </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01262">1262</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="structptlrpc__sec__cops.html#a53a9874a373d044027d52b2bf118fc00">ptlrpc_sec_cops::destroy_sec</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs__private_8h_source.html#l00410">LASSERT_ATOMIC_ZERO</a>, <a class="el" href="lustre__sec_8h_source.html#l00849">ptlrpc_sec::ps_nctx</a>, <a class="el" href="lustre__sec_8h_source.html#l00846">ptlrpc_sec::ps_policy</a>, <a class="el" href="lustre__sec_8h_source.html#l00847">ptlrpc_sec::ps_refcount</a>, <a class="el" href="lustre__sec_8h_source.html#l00828">ptlrpc_sec_policy::sp_cops</a>, <a class="el" href="lustre__sec_8h_source.html#l00826">ptlrpc_sec_policy::sp_name</a>, and <a class="el" href="lustre__sec_8h_source.html#l00980">sptlrpc_policy_put()</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01276">sptlrpc_sec_destroy()</a>, and <a class="el" href="sec_8c_source.html#l01302">sptlrpc_sec_put()</a>.</p>

</div>
</div>
<a class="anchor" id="aee65856b19bef55e18c7cad2015ba224"></a><!-- doxytag: member="sec.c::sec_cop_flush_ctx_cache" ref="aee65856b19bef55e18c7cad2015ba224" args="(struct ptlrpc_sec *sec, uid_t uid, int grace, int force)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int sec_cop_flush_ctx_cache </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uid_t&nbsp;</td>
          <td class="paramname"> <em>uid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>grace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>force</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01251">1251</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="structptlrpc__sec__cops.html#a26e276d2b4143cd7376a9a13b194b51a">ptlrpc_sec_cops::flush_ctx_cache</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__sec_8h_source.html#l00846">ptlrpc_sec::ps_policy</a>, and <a class="el" href="lustre__sec_8h_source.html#l00828">ptlrpc_sec_policy::sp_cops</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01540">import_flush_ctx_common()</a>, and <a class="el" href="sec_8c_source.html#l01282">sptlrpc_sec_kill()</a>.</p>

</div>
</div>
<a class="anchor" id="af4c088cbb797dc841ec45509b2626147"></a><!-- doxytag: member="sec.c::sptlrpc_fini" ref="af4c088cbb797dc841ec45509b2626147" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sptlrpc_fini </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l02590">2590</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="sec__config_8c_source.html#l01217">sptlrpc_conf_fini()</a>, <a class="el" href="sec__bulk_8c_source.html#l00827">sptlrpc_enc_pool_fini()</a>, <a class="el" href="sec__gc_8c_source.html#l00247">sptlrpc_gc_fini()</a>, <a class="el" href="sec__lproc_8c_source.html#l00202">sptlrpc_lproc_fini()</a>, <a class="el" href="sec__null_8c_source.html#l00453">sptlrpc_null_fini()</a>, and <a class="el" href="sec__plain_8c_source.html#l01032">sptlrpc_plain_fini()</a>.</p>

<p>Referenced by <a class="el" href="ptlrpc__module_8c_source.html#l00138">ptlrpc_exit()</a>, and <a class="el" href="ptlrpc__module_8c_source.html#l00052">ptlrpc_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a333d45f5d69dadb739275036609acdfd"></a><!-- doxytag: member="sec.c::sptlrpc_import_sec_adapt_inplace" ref="a333d45f5d69dadb739275036609acdfd" args="(struct obd_import *imp, struct ptlrpc_sec *sec, struct sptlrpc_flavor *sf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void sptlrpc_import_sec_adapt_inplace </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__import.html">obd_import</a> *&nbsp;</td>
          <td class="paramname"> <em>imp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *&nbsp;</td>
          <td class="paramname"> <em>sf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01413">1413</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="sec_8c_source.html#l01408">flavor_copy()</a>, <a class="el" href="lustre__sec_8h_source.html#l00852">ptlrpc_sec::ps_flvr</a>, <a class="el" href="lustre__sec_8h_source.html#l00858">ptlrpc_sec::ps_lock</a>, <a class="el" href="lustre__sec_8h_source.html#l00296">sptlrpc_flavor::sf_flags</a>, and <a class="el" href="sec_8c_source.html#l00247">sptlrpc_secflags2str()</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01438">sptlrpc_import_sec_adapt()</a>.</p>

</div>
</div>
<a class="anchor" id="a5d2f64090369eb520b37b7f8e3c7d19a"></a><!-- doxytag: member="sec.c::sptlrpc_import_sec_install" ref="a5d2f64090369eb520b37b7f8e3c7d19a" args="(struct obd_import *imp, struct ptlrpc_sec *sec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void sptlrpc_import_sec_install </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__import.html">obd_import</a> *&nbsp;</td>
          <td class="paramname"> <em>imp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01381">1381</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="lustre__import_8h_source.html#l00274">obd_import::imp_lock</a>, <a class="el" href="lustre__import_8h_source.html#l00211">obd_import::imp_sec</a>, <a class="el" href="libcfs__private_8h_source.html#l00411">LASSERT_ATOMIC_POS</a>, <a class="el" href="lustre__sec_8h_source.html#l00847">ptlrpc_sec::ps_refcount</a>, <a class="el" href="sec_8c_source.html#l01282">sptlrpc_sec_kill()</a>, and <a class="el" href="sec_8c_source.html#l01302">sptlrpc_sec_put()</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01438">sptlrpc_import_sec_adapt()</a>.</p>

</div>
</div>
<a class="anchor" id="a85cf05726ee3abcf3a3c9d82b267445d"></a><!-- doxytag: member="sec.c::sptlrpc_init" ref="a85cf05726ee3abcf3a3c9d82b267445d" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sptlrpc_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l02544">2544</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="sec_8c_source.html#l00065">policy_lock</a>, <a class="el" href="sec__config_8c_source.html#l01217">sptlrpc_conf_fini()</a>, <a class="el" href="sec__config_8c_source.html#l01210">sptlrpc_conf_init()</a>, <a class="el" href="sec__bulk_8c_source.html#l00827">sptlrpc_enc_pool_fini()</a>, <a class="el" href="sec__bulk_8c_source.html#l00777">sptlrpc_enc_pool_init()</a>, <a class="el" href="sec__gc_8c_source.html#l00247">sptlrpc_gc_fini()</a>, <a class="el" href="sec__gc_8c_source.html#l00220">sptlrpc_gc_init()</a>, <a class="el" href="sec__lproc_8c_source.html#l00186">sptlrpc_lproc_init()</a>, <a class="el" href="sec__null_8c_source.html#l00453">sptlrpc_null_fini()</a>, <a class="el" href="sec__null_8c_source.html#l00440">sptlrpc_null_init()</a>, <a class="el" href="sec__plain_8c_source.html#l01032">sptlrpc_plain_fini()</a>, and <a class="el" href="sec__plain_8c_source.html#l01017">sptlrpc_plain_init()</a>.</p>

<p>Referenced by <a class="el" href="ptlrpc__module_8c_source.html#l00052">ptlrpc_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ad71829360197a42fb2e92bcb78861abc"></a><!-- doxytag: member="sec.c::sptlrpc_req_ctx_switch" ref="ad71829360197a42fb2e92bcb78861abc" args="(struct ptlrpc_request *req, struct ptlrpc_cli_ctx *oldctx, struct ptlrpc_cli_ctx *newctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int sptlrpc_req_ctx_switch </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>oldctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>newctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l00482">482</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00537">ptlrpc_cli_ctx::cc_sec</a>, <a class="el" href="lustre__sec_8h_source.html#l00542">ptlrpc_cli_ctx::cc_vcred</a>, <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="lustre__sec_8h_source.html#l00846">ptlrpc_sec::ps_policy</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__net_8h_source.html#l01026">ptlrpc_request::rq_replen</a>, <a class="el" href="lustre__net_8h_source.html#l01024">ptlrpc_request::rq_reqlen</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="sec_8c_source.html#l02511">sec2target_str()</a>, <a class="el" href="lustre__sec_8h_source.html#l00826">ptlrpc_sec_policy::sp_name</a>, <a class="el" href="sec_8c_source.html#l01580">sptlrpc_cli_alloc_reqbuf()</a>, <a class="el" href="sec_8c_source.html#l01728">sptlrpc_cli_free_repbuf()</a>, <a class="el" href="sec_8c_source.html#l01610">sptlrpc_cli_free_reqbuf()</a>, <a class="el" href="sec_8c_source.html#l00845">sptlrpc_req_set_flavor()</a>, and <a class="el" href="lustre__sec_8h_source.html#l00392">vfs_cred::vc_uid</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l00549">sptlrpc_req_replace_dead_ctx()</a>.</p>

</div>
</div>
<a class="anchor" id="ac9b77912f15b5fe483e82afec3597eec"></a><!-- doxytag: member="sec.c::sptlrpc_sec_create" ref="ac9b77912f15b5fe483e82afec3597eec" args="(struct obd_import *imp, struct ptlrpc_svc_ctx *svc_ctx, struct sptlrpc_flavor *sf, enum lustre_sec_part sp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a>* sptlrpc_sec_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__import.html">obd_import</a> *&nbsp;</td>
          <td class="paramname"> <em>imp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__svc__ctx.html">ptlrpc_svc_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>svc_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *&nbsp;</td>
          <td class="paramname"> <em>sf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__sptlrpc.html#gaceeb8c40afd0179b5b42fc19aa58d177">lustre_sec_part</a>&nbsp;</td>
          <td class="paramname"> <em>sp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01319">1319</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="structptlrpc__sec__cops.html#a8bf54ba0627dde53dbce14fd8ddf1808">ptlrpc_sec_cops::create_sec</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="structptlrpc__sec__cops.html#ae5fd60f1e3563bd552852ccbc51883d0">ptlrpc_sec_cops::gc_ctx</a>, <a class="el" href="lustre__import_8h_source.html#l00277">obd_import::imp_dlm_fake</a>, <a class="el" href="lustre__import_8h_source.html#l00205">obd_import::imp_obd</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="obd_8h_source.html#l00592">obd_device::obd_type</a>, <a class="el" href="lustre__sec_8h_source.html#l00864">ptlrpc_sec::ps_gc_interval</a>, <a class="el" href="lustre__sec_8h_source.html#l00853">ptlrpc_sec::ps_part</a>, <a class="el" href="lustre__sec_8h_source.html#l00847">ptlrpc_sec::ps_refcount</a>, <a class="el" href="lustre__sec_8h_source.html#l00832">PTLRPC_SEC_FL_REVERSE</a>, <a class="el" href="lustre__sec_8h_source.html#l00833">PTLRPC_SEC_FL_ROOTONLY</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__sec_8h_source.html#l00881">ptlrpc_svc_ctx::sc_policy</a>, <a class="el" href="lustre__sec_8h_source.html#l00296">sptlrpc_flavor::sf_flags</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00828">ptlrpc_sec_policy::sp_cops</a>, <a class="el" href="sec_8c_source.html#l00226">sptlrpc_flavor2name()</a>, <a class="el" href="sec__gc_8c_source.html#l00067">sptlrpc_gc_add_sec()</a>, <a class="el" href="lustre__sec_8h_source.html#l00973">sptlrpc_policy_get()</a>, <a class="el" href="lustre__sec_8h_source.html#l00980">sptlrpc_policy_put()</a>, <a class="el" href="sec_8c_source.html#l00117">sptlrpc_wireflavor2policy()</a>, and <a class="el" href="obd_8h_source.html#l00111">obd_type::typ_name</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01438">sptlrpc_import_sec_adapt()</a>.</p>

</div>
</div>
<a class="anchor" id="ad6144b9e43fd5f6ece490d8e7bb97a13"></a><!-- doxytag: member="sec.c::sptlrpc_sec_kill" ref="ad6144b9e43fd5f6ece490d8e7bb97a13" args="(struct ptlrpc_sec *sec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void sptlrpc_sec_kill </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01282">1282</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="structptlrpc__sec__cops.html#a08e2b30856f5887883df0abf37c3a5c1">ptlrpc_sec_cops::kill_sec</a>, <a class="el" href="libcfs__private_8h_source.html#l00411">LASSERT_ATOMIC_POS</a>, <a class="el" href="lustre__sec_8h_source.html#l00846">ptlrpc_sec::ps_policy</a>, <a class="el" href="lustre__sec_8h_source.html#l00847">ptlrpc_sec::ps_refcount</a>, <a class="el" href="sec_8c_source.html#l01251">sec_cop_flush_ctx_cache()</a>, and <a class="el" href="lustre__sec_8h_source.html#l00828">ptlrpc_sec_policy::sp_cops</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01381">sptlrpc_import_sec_install()</a>, and <a class="el" href="sec_8c_source.html#l01530">sptlrpc_import_sec_put()</a>.</p>

</div>
</div>
<a class="anchor" id="a8f86b39041d37b1c534e76f54f3dfa73"></a><!-- doxytag: member="sec.c::sptlrpc_svc_check_from" ref="a8f86b39041d37b1c534e76f54f3dfa73" args="(struct ptlrpc_request *req, int svc_rc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int sptlrpc_svc_check_from </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>svc_rc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l02017">2017</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00146">D_ERROR</a>, <a class="el" href="lustre__net_8h_source.html#l01302">DEBUG_REQ</a>, <a class="el" href="lustre__sec_8h_source.html#l00321">LUSTRE_SP_ANY</a>, <a class="el" href="lustre__sec_8h_source.html#l00316">LUSTRE_SP_CLI</a>, <a class="el" href="lustre__sec_8h_source.html#l00317">LUSTRE_SP_MDT</a>, <a class="el" href="lustre__sec_8h_source.html#l00319">LUSTRE_SP_MGC</a>, <a class="el" href="lustre__sec_8h_source.html#l00320">LUSTRE_SP_MGS</a>, <a class="el" href="lustre__sec_8h_source.html#l00318">LUSTRE_SP_OST</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_auth_gss</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_auth_usr_mdt</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_auth_usr_ost</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_auth_usr_root</a>, and <a class="el" href="lustre__sec_8h_source.html#l01104">SECSVC_DROP</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l02070">sptlrpc_svc_unwrap_request()</a>.</p>

</div>
</div>
<a class="anchor" id="afb9bb4727d146b44d3b91883ef3ca99c"></a><!-- doxytag: member="sec.c::sptlrpc_wireflavor2policy" ref="afb9bb4727d146b44d3b91883ef3ca99c" args="(__u32 flavor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structptlrpc__sec__policy.html">ptlrpc_sec_policy</a>* sptlrpc_wireflavor2policy </td>
          <td>(</td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>flavor</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l00117">117</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="lcommon__cl_8c.html#a8e36eb858674e5dab2b07bb6400bcd5b">DEFINE_MUTEX()</a>, <a class="el" href="sec_8c_source.html#l00065">policy_lock</a>, <a class="el" href="lustre__sec_8h_source.html#l00825">ptlrpc_sec_policy::sp_owner</a>, <a class="el" href="lustre__sec_8h_source.html#l00152">SPTLRPC_FLVR_POLICY</a>, <a class="el" href="lustre__sec_8h_source.html#l00090">SPTLRPC_POLICY_GSS</a>, and <a class="el" href="lustre__sec_8h_source.html#l00091">SPTLRPC_POLICY_MAX</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01319">sptlrpc_sec_create()</a>, and <a class="el" href="sec_8c_source.html#l02070">sptlrpc_svc_unwrap_request()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a2cb591bc9afa8f2a4f7e74adb4bfede7"></a><!-- doxytag: member="sec.c::policies" ref="a2cb591bc9afa8f2a4f7e74adb4bfede7" args="[SPTLRPC_POLICY_MAX]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structptlrpc__sec__policy.html">ptlrpc_sec_policy</a>* <a class="el" href="sec_8c.html#a2cb591bc9afa8f2a4f7e74adb4bfede7">policies</a>[SPTLRPC_POLICY_MAX]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        NULL,
}
</pre></div>
<p>Definition at line <a class="el" href="sec_8c_source.html#l00066">66</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0ed0bbaea3aeb7c7d9b2422269cc8577"></a><!-- doxytag: member="sec.c::policy_lock" ref="a0ed0bbaea3aeb7c7d9b2422269cc8577" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rwlock_t <a class="el" href="sec_8c.html#a0ed0bbaea3aeb7c7d9b2422269cc8577">policy_lock</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l00065">65</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l02544">sptlrpc_init()</a>, <a class="el" href="sec_8c_source.html#l00070">sptlrpc_register_policy()</a>, <a class="el" href="sec_8c_source.html#l00094">sptlrpc_unregister_policy()</a>, and <a class="el" href="sec_8c_source.html#l00117">sptlrpc_wireflavor2policy()</a>.</p>

</div>
</div>
<a class="anchor" id="a1456be82ec79a3c94348466dc066a4c1"></a><!-- doxytag: member="sec.c::sptlrpc_sec_id" ref="a1456be82ec79a3c94348466dc066a4c1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">atomic_t <a class="el" href="sec_8c.html#a1456be82ec79a3c94348466dc066a4c1">sptlrpc_sec_id</a> = ATOMIC_INIT(1)<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec_8c_source.html#l01239">1239</a> of file <a class="el" href="sec_8c_source.html">sec.c</a>.</p>

<p>Referenced by <a class="el" href="sec_8c_source.html#l01241">sptlrpc_get_next_secid()</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:50 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
