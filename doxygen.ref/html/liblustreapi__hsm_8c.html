<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/utils/liblustreapi_hsm.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/utils/liblustreapi_hsm.c File Reference</h1><code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="string_8h_source.html">string.h</a>&gt;</code><br/>
<code>#include &lt;stddef.h&gt;</code><br/>
<code>#include &lt;sys/ioctl.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;malloc.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;dirent.h&gt;</code><br/>
<code>#include &lt;stdarg.h&gt;</code><br/>
<code>#include &lt;sys/stat.h&gt;</code><br/>
<code>#include &lt;sys/time.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>
<code>#include &lt;utime.h&gt;</code><br/>
<code>#include &lt;sys/syscall.h&gt;</code><br/>
<code>#include &lt;fnmatch.h&gt;</code><br/>
<code>#include &lt;signal.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="lnetctl_8h_source.html">lnet/lnetctl.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__idl_8h_source.html">lustre/lustre_idl.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustreapi_8h_source.html">lustre/lustreapi.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="lustreapi__internal_8h_source.html">lustreapi_internal.h</a>&quot;</code><br/>

<p><a href="liblustreapi__hsm_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structhsm__copytool__private.html">hsm_copytool_private</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structhsm__copyaction__private.html">hsm_copyaction_private</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#ad9394cc6efb58f07d1fa98e958954992">OPEN_BY_FID_PATH</a>&nbsp;&nbsp;&nbsp;dot_lustre_name&quot;/fid&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#a8897a64e91f1f57fd26dc99cae12b406">CT_PRIV_MAGIC</a>&nbsp;&nbsp;&nbsp;0xC0BE2001</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#a4288b68140042beb325c4b83fa8464ae">CP_PRIV_MAGIC</a>&nbsp;&nbsp;&nbsp;0x19880429</td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#aad1ce0053ed8fbe09341cdfc7c1cf0e6">ct_progress_type</a> { <br/>
&nbsp;&nbsp;<a class="el" href="liblustreapi__hsm_8c.html#aad1ce0053ed8fbe09341cdfc7c1cf0e6a3eb693b8aeda7fa5f03e25720768f950">CT_START</a> =  0, 
<a class="el" href="liblustreapi__hsm_8c.html#aad1ce0053ed8fbe09341cdfc7c1cf0e6a634ee3e5b0a0b66569ac74872a514a19">CT_RUNNING</a> =  50, 
<a class="el" href="liblustreapi__hsm_8c.html#aad1ce0053ed8fbe09341cdfc7c1cf0e6a5bbf48449d74e518d91b7f4bbf2ca1f6">CT_FINISH</a> =  100, 
<a class="el" href="liblustreapi__hsm_8c.html#aad1ce0053ed8fbe09341cdfc7c1cf0e6acb034817ed93a7f393f8ddf1882f0a7c">CT_CANCEL</a> =  150, 
<br/>
&nbsp;&nbsp;<a class="el" href="liblustreapi__hsm_8c.html#aad1ce0053ed8fbe09341cdfc7c1cf0e6a953dc74397e2314430158ffa33f2ec0a">CT_ERROR</a> =  175
<br/>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4">ct_event</a> { <br/>
&nbsp;&nbsp;<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4a132ecc36142749df939c179a92d9bc4f">CT_REGISTER</a> =  1, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4ac14777a5a7c39996524fb4b6773084ec">CT_UNREGISTER</a> =  2, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4aa494b7748f7317e4508f658df7a9ee5a">CT_ARCHIVE_START</a> =  HSMA_ARCHIVE, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4a8d4686a3e53dbff60514ab534bdc0dad">CT_ARCHIVE_RUNNING</a> =  HSMA_ARCHIVE + CT_RUNNING, 
<br/>
&nbsp;&nbsp;<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4a2c7654d59478d71187a80162012827a2">CT_ARCHIVE_FINISH</a> =  HSMA_ARCHIVE + CT_FINISH, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4afbd8574e9b6411e0bea62449c626a4be">CT_ARCHIVE_CANCEL</a> =  HSMA_ARCHIVE + CT_CANCEL, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4a5f9e4bf9258fe44f2b71a9c4b8ad6634">CT_ARCHIVE_ERROR</a> =  HSMA_ARCHIVE + CT_ERROR, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4a9566a2ca66b4783e013df608584292b8">CT_RESTORE_START</a> =  HSMA_RESTORE, 
<br/>
&nbsp;&nbsp;<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4af94343f8c15a14460339f00b65f0faf6">CT_RESTORE_RUNNING</a> =  HSMA_RESTORE + CT_RUNNING, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4a08b047e8c6d13b60227209d4378cbf56">CT_RESTORE_FINISH</a> =  HSMA_RESTORE + CT_FINISH, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4ace10be4bc594a9daec9f29fd7e8c09f2">CT_RESTORE_CANCEL</a> =  HSMA_RESTORE + CT_CANCEL, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4a29a535e10e2bf2978590e1bcf011d6a6">CT_RESTORE_ERROR</a> =  HSMA_RESTORE + CT_ERROR, 
<br/>
&nbsp;&nbsp;<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4a2b043d9e55daff446f90588d9e742771">CT_REMOVE_START</a> =  HSMA_REMOVE, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4a1851ddbb5ad7880ccc099c29c4d2128e">CT_REMOVE_RUNNING</a> =  HSMA_REMOVE + CT_RUNNING, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4ad12d48cfa7e83ca47c82adfb0050e6ea">CT_REMOVE_FINISH</a> =  HSMA_REMOVE + CT_FINISH, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4aa0777a579abbce78c11c9c785aa75ece">CT_REMOVE_CANCEL</a> =  HSMA_REMOVE + CT_CANCEL, 
<br/>
&nbsp;&nbsp;<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4abc846892088ed587028da5b21d7a9cb3">CT_REMOVE_ERROR</a> =  HSMA_REMOVE + CT_ERROR, 
<a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4a4d5e846d01177f2c2c074cc8e32bfbec">CT_EVENT_MAX</a>
<br/>
 }</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#a86acc30fbdedf2b13f03ea23f4681ff7">llapi_hsm_ct_ev2str</a> (int type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#a9d48c349fd28fe22f12d4fdef4faf08b">llapi_hsm_write_json_event</a> (struct <a class="el" href="structllapi__json__item__list.html">llapi_json_item_list</a> **event)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Writes a JSON event to the monitor FIFO.  <a href="#a9d48c349fd28fe22f12d4fdef4faf08b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#ac6f6cedf899208c2d4d0c9310d3e86ae">llapi_hsm_log_ct_registration</a> (struct <a class="el" href="structhsm__copytool__private.html">hsm_copytool_private</a> **priv, __u32 event_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Hook for llapi_hsm_copytool_register and llapi_hsm_copytool_unregister to generate JSON events suitable for consumption by a copytool monitoring process.  <a href="#ac6f6cedf899208c2d4d0c9310d3e86ae"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#a002c97f74db16694f428a1b8b8c48a5d">llapi_hsm_log_ct_progress</a> (struct <a class="el" href="structhsm__copyaction__private.html">hsm_copyaction_private</a> **phcp, const struct <a class="el" href="structhsm__action__item.html">hsm_action_item</a> *hai, __u32 progress_type, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> total, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> current)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a copytool progress update, construct a JSON event suitable for consumption by a copytool monitoring process.  <a href="#a002c97f74db16694f428a1b8b8c48a5d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#ga89cbac22a82ac6a421bb2aab980c1c3e">llapi_hsm_register_event_fifo</a> (const char *<a class="el" href="mdsrate_8c.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a path to a FIFO, create a filehandle for nonblocking writes to it.  <a href="group__llapi.html#ga89cbac22a82ac6a421bb2aab980c1c3e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#gac7e96e99dacac05914034918fc2114b8">llapi_hsm_unregister_event_fifo</a> (const char *<a class="el" href="mdsrate_8c.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a path to a FIFO, close its filehandle and delete the FIFO.  <a href="group__llapi.html#gac7e96e99dacac05914034918fc2114b8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#gac7cd8c58323ebb952e44bc3864a680f3">llapi_hsm_log_error</a> (enum <a class="el" href="group__llapi.html#ga335ce00457bf035f2e92c206c0d05568">llapi_message_level</a> level, int _rc, const char *fmt, va_list args)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Custom logging callback to be used when a monitoring FIFO has been registered.  <a href="group__llapi.html#gac7cd8c58323ebb952e44bc3864a680f3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#ga56090f57d464ed01de0443ca66f39d18">llapi_hsm_copytool_register</a> (struct <a class="el" href="structhsm__copytool__private.html">hsm_copytool_private</a> **priv, const char *mnt, int archive_count, int *archives, int rfd_flags)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register a copytool.  <a href="group__llapi.html#ga56090f57d464ed01de0443ca66f39d18"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#ga58f3918326074b092e6390939f79568a">llapi_hsm_copytool_unregister</a> (struct <a class="el" href="structhsm__copytool__private.html">hsm_copytool_private</a> **priv)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deregister a copytool Note: under Linux, until llapi_hsm_copytool_unregister is called (or the program is killed), the libcfs module will be referenced and unremovable, even after Lustre services stop.  <a href="group__llapi.html#ga58f3918326074b092e6390939f79568a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#ga694b0437493484e145b1713c7a1bb9cd">llapi_hsm_copytool_get_fd</a> (struct <a class="el" href="structhsm__copytool__private.html">hsm_copytool_private</a> *ct)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a file descriptor to poll/select on.  <a href="group__llapi.html#ga694b0437493484e145b1713c7a1bb9cd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#gad18af809c2dda475e759db9e2b066418">llapi_hsm_copytool_recv</a> (struct <a class="el" href="structhsm__copytool__private.html">hsm_copytool_private</a> *ct, struct <a class="el" href="structhsm__action__list.html">hsm_action_list</a> **halh, int *msgsize)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wait for the next <a class="el" href="structhsm__action__list.html">hsm_action_list</a>.  <a href="group__llapi.html#gad18af809c2dda475e759db9e2b066418"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#af886bb34390f017191f220dba6a03cc2">fid_parent</a> (const char *mnt, const <a class="el" href="structlu__fid.html">lustre_fid</a> *fid, char *parent, size_t parent_len)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get parent path from mount point and fid.  <a href="#af886bb34390f017191f220dba6a03cc2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#a167f7eb32c44cd518e219fb340da2f65">ct_open_by_fid</a> (const struct <a class="el" href="structhsm__copytool__private.html">hsm_copytool_private</a> *ct, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, int open_flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#a417353dee2da59bcf1de507672f0e30e">ct_md_getattr</a> (const struct <a class="el" href="structhsm__copytool__private.html">hsm_copytool_private</a> *ct, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, lstat_t *st)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get metadata attributes of file by FID.  <a href="#a417353dee2da59bcf1de507672f0e30e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#ae5709755417e652804c477119cd40723">create_restore_volatile</a> (struct <a class="el" href="structhsm__copyaction__private.html">hsm_copyaction_private</a> *hcp, int mdt_index, int open_flags)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create the destination volatile file for a restore operation.  <a href="#ae5709755417e652804c477119cd40723"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#gac3922a41eae3a32dc48ccf33f9c3d4ac">llapi_hsm_action_begin</a> (struct <a class="el" href="structhsm__copyaction__private.html">hsm_copyaction_private</a> **phcp, const struct <a class="el" href="structhsm__copytool__private.html">hsm_copytool_private</a> *ct, const struct <a class="el" href="structhsm__action__item.html">hsm_action_item</a> *hai, int restore_mdt_index, int restore_open_flags, bool is_error)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start processing an HSM action.  <a href="group__llapi.html#gac3922a41eae3a32dc48ccf33f9c3d4ac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#gaea52ba36ba47870c0f8e6586b3d48ecc">llapi_hsm_action_end</a> (struct <a class="el" href="structhsm__copyaction__private.html">hsm_copyaction_private</a> **phcp, const struct <a class="el" href="structhsm__extent.html">hsm_extent</a> *he, int hp_flags, int errval)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Terminate an HSM action processing.  <a href="group__llapi.html#gaea52ba36ba47870c0f8e6586b3d48ecc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#ga5cc2899f0dbc4a8ec90d6bd0b9b6fe17">llapi_hsm_action_progress</a> (struct <a class="el" href="structhsm__copyaction__private.html">hsm_copyaction_private</a> *hcp, const struct <a class="el" href="structhsm__extent.html">hsm_extent</a> *he, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> total, int hp_flags)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Notify a progress in processing an HSM action.  <a href="group__llapi.html#ga5cc2899f0dbc4a8ec90d6bd0b9b6fe17"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#ga4ca1f4f67749a9a11d48ea661f8ec2f8">llapi_hsm_action_get_dfid</a> (const struct <a class="el" href="structhsm__copyaction__private.html">hsm_copyaction_private</a> *hcp, <a class="el" href="structlu__fid.html">lustre_fid</a> *fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the fid of object to be used for copying data.  <a href="group__llapi.html#ga4ca1f4f67749a9a11d48ea661f8ec2f8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#gaba84da0225c8950975c3ad76aa402abd">llapi_hsm_action_get_fd</a> (const struct <a class="el" href="structhsm__copyaction__private.html">hsm_copyaction_private</a> *hcp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a file descriptor to be used for copying data.  <a href="group__llapi.html#gaba84da0225c8950975c3ad76aa402abd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#ga42de7c318652c45b7b86df855b6dd201">llapi_hsm_import</a> (const char *dst, int archive, const struct stat *st, unsigned long long stripe_size, int stripe_offset, int stripe_count, int stripe_pattern, char *pool_name, <a class="el" href="structlu__fid.html">lustre_fid</a> *newfid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Import an existing hsm-archived file into Lustre.  <a href="group__llapi.html#ga42de7c318652c45b7b86df855b6dd201"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#gae27f3f88ec0e797b2c1a7df9d029b2a7">llapi_hsm_state_get_fd</a> (int fd, struct <a class="el" href="structhsm__user__state.html">hsm_user_state</a> *hus)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the current HSM states and HSM requests related to file pointed by <em>path</em>.  <a href="group__llapi.html#gae27f3f88ec0e797b2c1a7df9d029b2a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#ga625517cdce6cc479801e10f24fe80bcb">llapi_hsm_state_get</a> (const char *<a class="el" href="mdsrate_8c.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>, struct <a class="el" href="structhsm__user__state.html">hsm_user_state</a> *hus)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the current HSM states and HSM requests related to file pointed by <em>path</em>.  <a href="group__llapi.html#ga625517cdce6cc479801e10f24fe80bcb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#gaa69acaf39672b0964307795fac1f19db">llapi_hsm_state_set_fd</a> (int fd, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> setmask, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> clearmask, __u32 archive_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set HSM states of file pointed by <em>fd</em>.  <a href="group__llapi.html#gaa69acaf39672b0964307795fac1f19db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#ga255ceef5caae75d4aee04f646bd71685">llapi_hsm_state_set</a> (const char *<a class="el" href="mdsrate_8c.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> setmask, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> clearmask, __u32 archive_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set HSM states of file pointed by <em>path</em>.  <a href="group__llapi.html#ga255ceef5caae75d4aee04f646bd71685"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#gaf26452d9f0f67d7b3efa39bc790c8349">llapi_hsm_current_action</a> (const char *<a class="el" href="mdsrate_8c.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>, struct <a class="el" href="structhsm__current__action.html">hsm_current_action</a> *hca)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the current HSM request related to file pointed by <em>path</em>.  <a href="group__llapi.html#gaf26452d9f0f67d7b3efa39bc790c8349"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structhsm__user__request.html">hsm_user_request</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#gae20de186e5b139de98e0a772517676b4">llapi_hsm_user_request_alloc</a> (int itemcount, int data_len)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate a <a class="el" href="structhsm__user__request.html">hsm_user_request</a> with the specified carateristics.  <a href="group__llapi.html#gae20de186e5b139de98e0a772517676b4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__llapi.html#gaad5620c10129544e26bb083f32d0c8e2">llapi_hsm_request</a> (const char *<a class="el" href="mdsrate_8c.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>, const struct <a class="el" href="structhsm__user__request.html">hsm_user_request</a> *request)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a HSM request to Lustre, described in.  <a href="group__llapi.html#gaad5620c10129544e26bb083f32d0c8e2"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#a65bee5fb40ed543bd245cb82d8273e08">llapi_hsm_event_fd</a> = -1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="liblustreapi__hsm_8c.html#a55da95de0837500f746b1a1bed939a66">created_hsm_event_fifo</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a4288b68140042beb325c4b83fa8464ae"></a><!-- doxytag: member="liblustreapi_hsm.c::CP_PRIV_MAGIC" ref="a4288b68140042beb325c4b83fa8464ae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CP_PRIV_MAGIC&nbsp;&nbsp;&nbsp;0x19880429</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00079">79</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l01096">llapi_hsm_action_begin()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l01160">llapi_hsm_action_end()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l01276">llapi_hsm_action_get_dfid()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l01299">llapi_hsm_action_get_fd()</a>, and <a class="el" href="liblustreapi__hsm_8c_source.html#l01239">llapi_hsm_action_progress()</a>.</p>

</div>
</div>
<a class="anchor" id="a8897a64e91f1f57fd26dc99cae12b406"></a><!-- doxytag: member="liblustreapi_hsm.c::CT_PRIV_MAGIC" ref="a8897a64e91f1f57fd26dc99cae12b406" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CT_PRIV_MAGIC&nbsp;&nbsp;&nbsp;0xC0BE2001</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00068">68</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l00838">llapi_hsm_copytool_get_fd()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00855">llapi_hsm_copytool_recv()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00676">llapi_hsm_copytool_register()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00799">llapi_hsm_copytool_unregister()</a>, and <a class="el" href="liblustreapi__hsm_8c_source.html#l00243">llapi_hsm_log_ct_registration()</a>.</p>

</div>
</div>
<a class="anchor" id="ad9394cc6efb58f07d1fa98e958954992"></a><!-- doxytag: member="liblustreapi_hsm.c::OPEN_BY_FID_PATH" ref="ad9394cc6efb58f07d1fa98e958954992" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OPEN_BY_FID_PATH&nbsp;&nbsp;&nbsp;dot_lustre_name&quot;/fid&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00065">65</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l00676">llapi_hsm_copytool_register()</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4"></a><!-- doxytag: member="liblustreapi_hsm.c::ct_event" ref="afbe5d105964d279faf48c6ae4d48f7d4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="liblustreapi__hsm_8c.html#afbe5d105964d279faf48c6ae4d48f7d4">ct_event</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4a132ecc36142749df939c179a92d9bc4f"></a><!-- doxytag: member="CT_REGISTER" ref="afbe5d105964d279faf48c6ae4d48f7d4a132ecc36142749df939c179a92d9bc4f" args="" -->CT_REGISTER</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4ac14777a5a7c39996524fb4b6773084ec"></a><!-- doxytag: member="CT_UNREGISTER" ref="afbe5d105964d279faf48c6ae4d48f7d4ac14777a5a7c39996524fb4b6773084ec" args="" -->CT_UNREGISTER</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4aa494b7748f7317e4508f658df7a9ee5a"></a><!-- doxytag: member="CT_ARCHIVE_START" ref="afbe5d105964d279faf48c6ae4d48f7d4aa494b7748f7317e4508f658df7a9ee5a" args="" -->CT_ARCHIVE_START</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4a8d4686a3e53dbff60514ab534bdc0dad"></a><!-- doxytag: member="CT_ARCHIVE_RUNNING" ref="afbe5d105964d279faf48c6ae4d48f7d4a8d4686a3e53dbff60514ab534bdc0dad" args="" -->CT_ARCHIVE_RUNNING</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4a2c7654d59478d71187a80162012827a2"></a><!-- doxytag: member="CT_ARCHIVE_FINISH" ref="afbe5d105964d279faf48c6ae4d48f7d4a2c7654d59478d71187a80162012827a2" args="" -->CT_ARCHIVE_FINISH</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4afbd8574e9b6411e0bea62449c626a4be"></a><!-- doxytag: member="CT_ARCHIVE_CANCEL" ref="afbe5d105964d279faf48c6ae4d48f7d4afbd8574e9b6411e0bea62449c626a4be" args="" -->CT_ARCHIVE_CANCEL</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4a5f9e4bf9258fe44f2b71a9c4b8ad6634"></a><!-- doxytag: member="CT_ARCHIVE_ERROR" ref="afbe5d105964d279faf48c6ae4d48f7d4a5f9e4bf9258fe44f2b71a9c4b8ad6634" args="" -->CT_ARCHIVE_ERROR</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4a9566a2ca66b4783e013df608584292b8"></a><!-- doxytag: member="CT_RESTORE_START" ref="afbe5d105964d279faf48c6ae4d48f7d4a9566a2ca66b4783e013df608584292b8" args="" -->CT_RESTORE_START</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4af94343f8c15a14460339f00b65f0faf6"></a><!-- doxytag: member="CT_RESTORE_RUNNING" ref="afbe5d105964d279faf48c6ae4d48f7d4af94343f8c15a14460339f00b65f0faf6" args="" -->CT_RESTORE_RUNNING</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4a08b047e8c6d13b60227209d4378cbf56"></a><!-- doxytag: member="CT_RESTORE_FINISH" ref="afbe5d105964d279faf48c6ae4d48f7d4a08b047e8c6d13b60227209d4378cbf56" args="" -->CT_RESTORE_FINISH</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4ace10be4bc594a9daec9f29fd7e8c09f2"></a><!-- doxytag: member="CT_RESTORE_CANCEL" ref="afbe5d105964d279faf48c6ae4d48f7d4ace10be4bc594a9daec9f29fd7e8c09f2" args="" -->CT_RESTORE_CANCEL</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4a29a535e10e2bf2978590e1bcf011d6a6"></a><!-- doxytag: member="CT_RESTORE_ERROR" ref="afbe5d105964d279faf48c6ae4d48f7d4a29a535e10e2bf2978590e1bcf011d6a6" args="" -->CT_RESTORE_ERROR</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4a2b043d9e55daff446f90588d9e742771"></a><!-- doxytag: member="CT_REMOVE_START" ref="afbe5d105964d279faf48c6ae4d48f7d4a2b043d9e55daff446f90588d9e742771" args="" -->CT_REMOVE_START</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4a1851ddbb5ad7880ccc099c29c4d2128e"></a><!-- doxytag: member="CT_REMOVE_RUNNING" ref="afbe5d105964d279faf48c6ae4d48f7d4a1851ddbb5ad7880ccc099c29c4d2128e" args="" -->CT_REMOVE_RUNNING</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4ad12d48cfa7e83ca47c82adfb0050e6ea"></a><!-- doxytag: member="CT_REMOVE_FINISH" ref="afbe5d105964d279faf48c6ae4d48f7d4ad12d48cfa7e83ca47c82adfb0050e6ea" args="" -->CT_REMOVE_FINISH</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4aa0777a579abbce78c11c9c785aa75ece"></a><!-- doxytag: member="CT_REMOVE_CANCEL" ref="afbe5d105964d279faf48c6ae4d48f7d4aa0777a579abbce78c11c9c785aa75ece" args="" -->CT_REMOVE_CANCEL</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4abc846892088ed587028da5b21d7a9cb3"></a><!-- doxytag: member="CT_REMOVE_ERROR" ref="afbe5d105964d279faf48c6ae4d48f7d4abc846892088ed587028da5b21d7a9cb3" args="" -->CT_REMOVE_ERROR</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="afbe5d105964d279faf48c6ae4d48f7d4a4d5e846d01177f2c2c074cc8e32bfbec"></a><!-- doxytag: member="CT_EVENT_MAX" ref="afbe5d105964d279faf48c6ae4d48f7d4a4d5e846d01177f2c2c074cc8e32bfbec" args="" -->CT_EVENT_MAX</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00096">96</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

</div>
</div>
<a class="anchor" id="aad1ce0053ed8fbe09341cdfc7c1cf0e6"></a><!-- doxytag: member="liblustreapi_hsm.c::ct_progress_type" ref="aad1ce0053ed8fbe09341cdfc7c1cf0e6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="liblustreapi__hsm_8c.html#aad1ce0053ed8fbe09341cdfc7c1cf0e6">ct_progress_type</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="aad1ce0053ed8fbe09341cdfc7c1cf0e6a3eb693b8aeda7fa5f03e25720768f950"></a><!-- doxytag: member="CT_START" ref="aad1ce0053ed8fbe09341cdfc7c1cf0e6a3eb693b8aeda7fa5f03e25720768f950" args="" -->CT_START</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aad1ce0053ed8fbe09341cdfc7c1cf0e6a634ee3e5b0a0b66569ac74872a514a19"></a><!-- doxytag: member="CT_RUNNING" ref="aad1ce0053ed8fbe09341cdfc7c1cf0e6a634ee3e5b0a0b66569ac74872a514a19" args="" -->CT_RUNNING</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aad1ce0053ed8fbe09341cdfc7c1cf0e6a5bbf48449d74e518d91b7f4bbf2ca1f6"></a><!-- doxytag: member="CT_FINISH" ref="aad1ce0053ed8fbe09341cdfc7c1cf0e6a5bbf48449d74e518d91b7f4bbf2ca1f6" args="" -->CT_FINISH</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aad1ce0053ed8fbe09341cdfc7c1cf0e6acb034817ed93a7f393f8ddf1882f0a7c"></a><!-- doxytag: member="CT_CANCEL" ref="aad1ce0053ed8fbe09341cdfc7c1cf0e6acb034817ed93a7f393f8ddf1882f0a7c" args="" -->CT_CANCEL</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aad1ce0053ed8fbe09341cdfc7c1cf0e6a953dc74397e2314430158ffa33f2ec0a"></a><!-- doxytag: member="CT_ERROR" ref="aad1ce0053ed8fbe09341cdfc7c1cf0e6a953dc74397e2314430158ffa33f2ec0a" args="" -->CT_ERROR</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00088">88</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ae5709755417e652804c477119cd40723"></a><!-- doxytag: member="liblustreapi_hsm.c::create_restore_volatile" ref="ae5709755417e652804c477119cd40723" args="(struct hsm_copyaction_private *hcp, int mdt_index, int open_flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int create_restore_volatile </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structhsm__copyaction__private.html">hsm_copyaction_private</a> *&nbsp;</td>
          <td class="paramname"> <em>hcp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>mdt_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>open_flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create the destination volatile file for a restore operation. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hcp</em>&nbsp;</td><td>Private copyaction handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mdt_index</em>&nbsp;</td><td>MDT index where to create the volatile file. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flags</em>&nbsp;</td><td>Volatile file creation flags. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success. </dd></dl>

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l01037">1037</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>References <a class="el" href="liblustreapi__hsm_8c_source.html#l00084">hsm_copyaction_private::copy</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00083">hsm_copyaction_private::ct_priv</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00082">hsm_copyaction_private::data_fd</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00936">fid_parent()</a>, <a class="el" href="lustre__user_8h_source.html#l01242">hsm_action_item::hai_dfid</a>, <a class="el" href="lustre__user_8h_source.html#l01241">hsm_action_item::hai_fid</a>, <a class="el" href="lustre__user_8h_source.html#l01365">hsm_copy::hc_hai</a>, <a class="el" href="liblustreapi_8c_source.html#l04372">llapi_create_volatile_idx()</a>, <a class="el" href="group__llapi.html#ga315938c57a626bde7a668f860d211ea0">llapi_error()</a>, <a class="el" href="liblustreapi_8c_source.html#l04192">llapi_fd2fid()</a>, <a class="el" href="lustreapi_8h_source.html#l00061">LLAPI_MSG_ERROR</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00071">hsm_copytool_private::mnt</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, and <a class="el" href="liblustreapi__hsm_8c_source.html#l00085">hsm_copyaction_private::stat</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l01096">llapi_hsm_action_begin()</a>.</p>

</div>
</div>
<a class="anchor" id="a417353dee2da59bcf1de507672f0e30e"></a><!-- doxytag: member="liblustreapi_hsm.c::ct_md_getattr" ref="a417353dee2da59bcf1de507672f0e30e" args="(const struct hsm_copytool_private *ct, const struct lu_fid *fid, lstat_t *st)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ct_md_getattr </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structhsm__copytool__private.html">hsm_copytool_private</a> *&nbsp;</td>
          <td class="paramname"> <em>ct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">lstat_t *&nbsp;</td>
          <td class="paramname"> <em>st</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get metadata attributes of file by FID. </p>
<p>Use the IOC_MDC_GETFILEINFO ioctl (to send a MDS_GETATTR_NAME RPC) to get the attributes of the file identified by <em>fid</em>. This returns only the attributes stored on the MDT and avoids taking layout locks or accessing OST objects. It also bypasses the inode cache. Attributes are returned in <em>st</em>. </p>

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00991">991</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>References <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="lustre__user_8h_source.html#l00547">DFID_NOBRACE</a>, <a class="el" href="lustre__user_8h_source.html#l00545">FID_NOBRACE_LEN</a>, <a class="el" href="lustre__user_8h_source.html#l00313">IOC_MDC_GETFILEINFO</a>, <a class="el" href="group__llapi.html#ga315938c57a626bde7a668f860d211ea0">llapi_error()</a>, <a class="el" href="lustreapi_8h_source.html#l00061">LLAPI_MSG_ERROR</a>, <a class="el" href="lustre__user_8h_source.html#l00369">LOV_MAX_STRIPE_COUNT</a>, <a class="el" href="lustre__user_8h_source.html#l00339">LOV_USER_MAGIC_V3</a>, <a class="el" href="lustre__user_8h_source.html#l00415">lov_user_md_size()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00071">hsm_copytool_private::mnt</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00074">hsm_copytool_private::open_by_fid_fd</a>, and <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l01096">llapi_hsm_action_begin()</a>.</p>

</div>
</div>
<a class="anchor" id="a167f7eb32c44cd518e219fb340da2f65"></a><!-- doxytag: member="liblustreapi_hsm.c::ct_open_by_fid" ref="a167f7eb32c44cd518e219fb340da2f65" args="(const struct hsm_copytool_private *ct, const struct lu_fid *fid, int open_flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ct_open_by_fid </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structhsm__copytool__private.html">hsm_copytool_private</a> *&nbsp;</td>
          <td class="paramname"> <em>ct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>open_flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00970">970</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>References <a class="el" href="lustre__user_8h_source.html#l00547">DFID_NOBRACE</a>, <a class="el" href="lustre__user_8h_source.html#l00545">FID_NOBRACE_LEN</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00074">hsm_copytool_private::open_by_fid_fd</a>, and <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l01299">llapi_hsm_action_get_fd()</a>.</p>

</div>
</div>
<a class="anchor" id="af886bb34390f017191f220dba6a03cc2"></a><!-- doxytag: member="liblustreapi_hsm.c::fid_parent" ref="af886bb34390f017191f220dba6a03cc2" args="(const char *mnt, const lustre_fid *fid, char *parent, size_t parent_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int fid_parent </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structlu__fid.html">lustre_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>parent_len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get parent path from mount point and fid. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mnt</em>&nbsp;</td><td>Filesystem root path. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fid</em>&nbsp;</td><td>Object FID. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>parent</em>&nbsp;</td><td>Destination buffer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>parent_len</em>&nbsp;</td><td>Destination buffer size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success. </dd></dl>

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00936">936</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>References <a class="el" href="lustre__user_8h_source.html#l00547">DFID_NOBRACE</a>, <a class="el" href="lustre__user_8h_source.html#l00545">FID_NOBRACE_LEN</a>, <a class="el" href="liblustreapi_8c_source.html#l04115">llapi_fid2path()</a>, and <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l01037">create_restore_volatile()</a>.</p>

</div>
</div>
<a class="anchor" id="a86acc30fbdedf2b13f03ea23f4681ff7"></a><!-- doxytag: member="liblustreapi_hsm.c::llapi_hsm_ct_ev2str" ref="a86acc30fbdedf2b13f03ea23f4681ff7" args="(int type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static const char* llapi_hsm_ct_ev2str </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00121">121</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>References <a class="el" href="liblustreapi__hsm_8c_source.html#l00102">CT_ARCHIVE_CANCEL</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00103">CT_ARCHIVE_ERROR</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00101">CT_ARCHIVE_FINISH</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00100">CT_ARCHIVE_RUNNING</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00099">CT_ARCHIVE_START</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00097">CT_REGISTER</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00112">CT_REMOVE_CANCEL</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00113">CT_REMOVE_ERROR</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00111">CT_REMOVE_FINISH</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00110">CT_REMOVE_RUNNING</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00109">CT_REMOVE_START</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00107">CT_RESTORE_CANCEL</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00108">CT_RESTORE_ERROR</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00106">CT_RESTORE_FINISH</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00105">CT_RESTORE_RUNNING</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00104">CT_RESTORE_START</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00098">CT_UNREGISTER</a>, <a class="el" href="lustreapi_8h_source.html#l00095">llapi_err_noerrno</a>, and <a class="el" href="lustreapi_8h_source.html#l00061">LLAPI_MSG_ERROR</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l00352">llapi_hsm_log_ct_progress()</a>, and <a class="el" href="liblustreapi__hsm_8c_source.html#l00243">llapi_hsm_log_ct_registration()</a>.</p>

</div>
</div>
<a class="anchor" id="a002c97f74db16694f428a1b8b8c48a5d"></a><!-- doxytag: member="liblustreapi_hsm.c::llapi_hsm_log_ct_progress" ref="a002c97f74db16694f428a1b8b8c48a5d" args="(struct hsm_copyaction_private **phcp, const struct hsm_action_item *hai, __u32 progress_type, __u64 total, __u64 current)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int llapi_hsm_log_ct_progress </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structhsm__copyaction__private.html">hsm_copyaction_private</a> **&nbsp;</td>
          <td class="paramname"> <em>phcp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structhsm__action__item.html">hsm_action_item</a> *&nbsp;</td>
          <td class="paramname"> <em>hai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>progress_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>current</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Given a copytool progress update, construct a JSON event suitable for consumption by a copytool monitoring process. </p>
<p>Examples of various events generated here and written by llapi_hsm_write_json_event:</p>
<p>Copytool registration and deregistration: {"event_time": "2014-02-26 14:58:01 -0500", "event_type": "REGISTER", "archive": 0, "mount_point": "/mnt/lustre", "uuid": "80379a60-1f8a-743f-daf2-307cde793ec2"} {"event_time": "2014-02-26 14:58:01 -0500", "event_type": "UNREGISTER", "archive": 0, "mount_point": "/mnt/lustre", "uuid": "80379a60-1f8a-743f-daf2-307cde793ec2"}</p>
<p>An archive action, start to completion: {"event_time": "2014-02-26 14:50:13 -0500", "event_type": "ARCHIVE_START", "total_bytes": 0, "lustre_path": "d71.sanity-hsm/f71.sanity-hsm", "source_fid": "0x2000013a1:0x2:0x0", "data_fid": "0x2000013a1:0x2:0x0"} {"event_time": "2014-02-26 14:50:18 -0500", "event_type": "ARCHIVE_RUNNING", "current_bytes": 5242880, "total_bytes": 39000000, "lustre_path": "d71.sanity-hsm/f71.sanity-hsm", "source_fid": "0x2000013a1:0x2:0x0", "data_fid": "0x2000013a1:0x2:0x0"} {"event_time": "2014-02-26 14:50:50 -0500", "event_type": "ARCHIVE_FINISH", "source_fid": "0x2000013a1:0x2:0x0", "data_fid": "0x2000013a1:0x2:0x0"}</p>
<p>A log message: {"event_time": "2014-02-26 14:50:13 -0500", "event_type": "LOGGED_MESSAGE", "level": "INFO", "message": "lhsmtool_posix[42]: copytool fs=lustre archive#=2 item_count=1"}</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hcp</em>&nbsp;</td><td>Opaque action handle returned by llapi_hsm_action_start. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hai</em>&nbsp;</td><td>The <a class="el" href="structhsm__action__item.html">hsm_action_item</a> describing the request. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>progress_type</em>&nbsp;</td><td>The ct_progress_type describing the update. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>total</em>&nbsp;</td><td>The total expected bytes for the request. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>current</em>&nbsp;</td><td>The current copied byte count for the request.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-errno</em>&nbsp;</td><td>on error. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00352">352</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>References <a class="el" href="liblustreapi__hsm_8c_source.html#l00084">hsm_copyaction_private::copy</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00092">CT_CANCEL</a>, <a class="el" href="lhsmtool__posix_8c_source.html#l00138">CT_ERROR</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00091">CT_FINISH</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00083">hsm_copyaction_private::ct_priv</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00090">CT_RUNNING</a>, <a class="el" href="lustre__user_8h_source.html#l00547">DFID_NOBRACE</a>, <a class="el" href="lustre__user_8h_source.html#l00545">FID_NOBRACE_LEN</a>, <a class="el" href="lustre__user_8h_source.html#l01240">hsm_action_item::hai_action</a>, <a class="el" href="lustre__user_8h_source.html#l01242">hsm_action_item::hai_dfid</a>, <a class="el" href="lustre__user_8h_source.html#l01241">hsm_action_item::hai_fid</a>, <a class="el" href="lustre__user_8h_source.html#l01363">hsm_copy::hc_errval</a>, <a class="el" href="group__llapi.html#ga315938c57a626bde7a668f860d211ea0">llapi_error()</a>, <a class="el" href="liblustreapi_8c_source.html#l04115">llapi_fid2path()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00121">llapi_hsm_ct_ev2str()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00118">llapi_hsm_event_fd</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00175">llapi_hsm_write_json_event()</a>, <a class="el" href="liblustreapi__json_8c_source.html#l00255">llapi_json_add_item()</a>, <a class="el" href="lustre__user_8h_source.html#l01371">LLAPI_JSON_BIGNUM</a>, <a class="el" href="liblustreapi__json_8c_source.html#l00207">llapi_json_destroy_list()</a>, <a class="el" href="liblustreapi__json_8c_source.html#l00186">llapi_json_init_list()</a>, <a class="el" href="lustre__user_8h_source.html#l01370">LLAPI_JSON_INTEGER</a>, <a class="el" href="lustre__user_8h_source.html#l01373">LLAPI_JSON_STRING</a>, <a class="el" href="lustreapi_8h_source.html#l00061">LLAPI_MSG_ERROR</a>, <a class="el" href="flock_8c_source.html#l00059">lustre_path</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00071">hsm_copytool_private::mnt</a>, and <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l01096">llapi_hsm_action_begin()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l01160">llapi_hsm_action_end()</a>, and <a class="el" href="liblustreapi__hsm_8c_source.html#l01239">llapi_hsm_action_progress()</a>.</p>

</div>
</div>
<a class="anchor" id="ac6f6cedf899208c2d4d0c9310d3e86ae"></a><!-- doxytag: member="liblustreapi_hsm.c::llapi_hsm_log_ct_registration" ref="ac6f6cedf899208c2d4d0c9310d3e86ae" args="(struct hsm_copytool_private **priv, __u32 event_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int llapi_hsm_log_ct_registration </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structhsm__copytool__private.html">hsm_copytool_private</a> **&nbsp;</td>
          <td class="paramname"> <em>priv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>event_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Hook for llapi_hsm_copytool_register and llapi_hsm_copytool_unregister to generate JSON events suitable for consumption by a copytool monitoring process. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>priv</em>&nbsp;</td><td>Opaque private control structure. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>event_type</em>&nbsp;</td><td>The type of event (register or unregister).</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-errno</em>&nbsp;</td><td>on error. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00243">243</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>References <a class="el" href="liblustreapi__hsm_8c_source.html#l00076">hsm_copytool_private::archives</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00068">CT_PRIV_MAGIC</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00097">CT_REGISTER</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00098">CT_UNREGISTER</a>, <a class="el" href="liblustreapi_8c_source.html#l00304">llapi_chomp_string()</a>, <a class="el" href="group__llapi.html#ga315938c57a626bde7a668f860d211ea0">llapi_error()</a>, <a class="el" href="liblustreapi_8c_source.html#l00374">llapi_get_agent_uuid()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00121">llapi_hsm_ct_ev2str()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00118">llapi_hsm_event_fd</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00175">llapi_hsm_write_json_event()</a>, <a class="el" href="liblustreapi__json_8c_source.html#l00255">llapi_json_add_item()</a>, <a class="el" href="liblustreapi__json_8c_source.html#l00207">llapi_json_destroy_list()</a>, <a class="el" href="liblustreapi__json_8c_source.html#l00186">llapi_json_init_list()</a>, <a class="el" href="lustre__user_8h_source.html#l01370">LLAPI_JSON_INTEGER</a>, <a class="el" href="lustre__user_8h_source.html#l01373">LLAPI_JSON_STRING</a>, <a class="el" href="lustreapi_8h_source.html#l00061">LLAPI_MSG_ERROR</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00070">hsm_copytool_private::magic</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00071">hsm_copytool_private::mnt</a>, and <a class="el" href="lustre__user_8h_source.html#l00490">UUID_MAX</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l00676">llapi_hsm_copytool_register()</a>, and <a class="el" href="liblustreapi__hsm_8c_source.html#l00799">llapi_hsm_copytool_unregister()</a>.</p>

</div>
</div>
<a class="anchor" id="a9d48c349fd28fe22f12d4fdef4faf08b"></a><!-- doxytag: member="liblustreapi_hsm.c::llapi_hsm_write_json_event" ref="a9d48c349fd28fe22f12d4fdef4faf08b" args="(struct llapi_json_item_list **event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int llapi_hsm_write_json_event </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structllapi__json__item__list.html">llapi_json_item_list</a> **&nbsp;</td>
          <td class="paramname"> <em>event</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Writes a JSON event to the monitor FIFO. </p>
<p>Noop if no FIFO has been registered.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>A list of llapi_json_items comprising a single JSON-formatted event.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-errno</em>&nbsp;</td><td>on error. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00175">175</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>References <a class="el" href="group__llapi.html#ga315938c57a626bde7a668f860d211ea0">llapi_error()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00118">llapi_hsm_event_fd</a>, <a class="el" href="liblustreapi__json_8c_source.html#l00255">llapi_json_add_item()</a>, <a class="el" href="lustre__user_8h_source.html#l01373">LLAPI_JSON_STRING</a>, <a class="el" href="liblustreapi__json_8c_source.html#l00114">llapi_json_write_list()</a>, and <a class="el" href="lustreapi_8h_source.html#l00061">LLAPI_MSG_ERROR</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l00352">llapi_hsm_log_ct_progress()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00243">llapi_hsm_log_ct_registration()</a>, and <a class="el" href="liblustreapi__hsm_8c_source.html#l00574">llapi_hsm_log_error()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a55da95de0837500f746b1a1bed939a66"></a><!-- doxytag: member="liblustreapi_hsm.c::created_hsm_event_fifo" ref="a55da95de0837500f746b1a1bed939a66" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="liblustreapi__hsm_8c.html#a55da95de0837500f746b1a1bed939a66">created_hsm_event_fifo</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00119">119</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l00473">llapi_hsm_register_event_fifo()</a>, and <a class="el" href="liblustreapi__hsm_8c_source.html#l00543">llapi_hsm_unregister_event_fifo()</a>.</p>

</div>
</div>
<a class="anchor" id="a65bee5fb40ed543bd245cb82d8273e08"></a><!-- doxytag: member="liblustreapi_hsm.c::llapi_hsm_event_fd" ref="a65bee5fb40ed543bd245cb82d8273e08" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="liblustreapi__hsm_8c.html#a65bee5fb40ed543bd245cb82d8273e08">llapi_hsm_event_fd</a> = -1<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="liblustreapi__hsm_8c_source.html#l00118">118</a> of file <a class="el" href="liblustreapi__hsm_8c_source.html">liblustreapi_hsm.c</a>.</p>

<p>Referenced by <a class="el" href="liblustreapi__hsm_8c_source.html#l00352">llapi_hsm_log_ct_progress()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00243">llapi_hsm_log_ct_registration()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00574">llapi_hsm_log_error()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00473">llapi_hsm_register_event_fifo()</a>, <a class="el" href="liblustreapi__hsm_8c_source.html#l00543">llapi_hsm_unregister_event_fifo()</a>, and <a class="el" href="liblustreapi__hsm_8c_source.html#l00175">llapi_hsm_write_json_event()</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:51 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
