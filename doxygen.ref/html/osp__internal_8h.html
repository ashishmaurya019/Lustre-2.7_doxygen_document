<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/osp/osp_internal.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/osp/osp_internal.h File Reference</h1><code>#include &lt;<a class="el" href="obd_8h_source.html">obd.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__class_8h_source.html">obd_class.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="dt__object_8h_source.html">dt_object.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="md__object_8h_source.html">md_object.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__fid_8h_source.html">lustre_fid.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__update_8h_source.html">lustre_update.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lu__target_8h_source.html">lu_target.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__mdc_8h_source.html">lustre_mdc.h</a>&gt;</code><br/>

<p><a href="osp__internal_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__id__tracker.html">osp_id_tracker</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__precreate.html">osp_precreate</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__update__request__sub.html">osp_update_request_sub</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__update__request.html">osp_update_request</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__updates.html">osp_updates</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__device.html">osp_device</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__xattr__entry.html">osp_xattr_entry</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__object__attr.html">osp_object_attr</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__object.html">osp_object</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__thread__info.html">osp_thread_info</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__it.html">osp_it</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__thandle.html">osp_thandle</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structosp__txn__info.html">osp_txn_info</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a8f4f848e964336697dc89158b6f92707">opd_pre_lock</a>&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_lock</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a9dc35b9b3181ac39cce2a08adc43c83d">opd_pre_used_fid</a>&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_used_fid</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a7100923c7b9bfa917040ee031074cefa">opd_pre_last_created_fid</a>&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_last_created_fid</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a1a8b99c31621ffdb37ca21e269344a3f">opd_pre_reserved</a>&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_reserved</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a6eae9e3c24780b0bcca2ee2dbffb1101">opd_pre_user_waitq</a>&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_user_waitq</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a5a986f1ecad6aa007292094cce20c12a">opd_pre_status</a>&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_status</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a04c407c11a6b959df725fc7ddbb22b1f">opd_pre_create_count</a>&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_create_count</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#aa68b8bb1a8de7154a751c4ce6e953916">opd_pre_min_create_count</a>&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_min_create_count</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#aeec7adadf98448144bc1010485eb6db3">opd_pre_max_create_count</a>&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_max_create_count</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ae0cc05840a4169412e41f5bebd3f39d6">opd_pre_create_slow</a>&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_create_slow</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a773efc591d1183ffc6283be08b3f4659">opd_pre_recovering</a>&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_recovering</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ad5acc38b25b10da1ee066ff2f2f30454">OSP_THANDLE_MAGIC</a>&nbsp;&nbsp;&nbsp;0x20141214</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a0e30b316fa5a6cc8a8464b085b888017">osp_init_rpc_lock</a>(lck)&nbsp;&nbsp;&nbsp;mdc_init_rpc_lock(lck)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a0ec6e9ba0fe3f28d7b45a1918dd61e37">osp_update_rpc_pack</a>(env, <a class="el" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, our, <a class="el" href="iam__ut_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>,...)</td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a3b00e28d2b68085c3ebf8992634dbbca">osp_update_interpreter_t</a> )(const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structobject__update__reply.html">object_update_reply</a> *rep, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structosp__object.html">osp_object</a> *obj, void *data, int index, int rc)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structosp__thandle.html">osp_thandle</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a6e6b95fc3a8c4578e0809a62c3bf52a4">thandle_to_osp_thandle</a> (struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#aeee11767575fd7392e89f28e7135ffe7">thandle_to_osp_update_request</a> (struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a33909940f130d0ddbf0f4f60dd163b08">is_only_remote_trans</a> (struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ad48113c3ad8afdf92468cb4c6b11b30c">osp_objid_buf_prep</a> (struct <a class="el" href="structlu__buf.html">lu_buf</a> *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, loff_t *off, __u32 *id, int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#acb21bb25d60c64551c51f36e6ab056a1">osp_objseq_buf_prep</a> (struct <a class="el" href="structlu__buf.html">lu_buf</a> *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, loff_t *off, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *seq, int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ac0163fa20c5c87a5f52212b518d8e459">osp_buf_prep</a> (struct <a class="el" href="structlu__buf.html">lu_buf</a> *lb, void *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, int buf_len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structosp__thread__info.html">osp_thread_info</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a79484131bd498d4f261f65c5de2af088">osp_env_info</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structosp__txn__info.html">osp_txn_info</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a07dd1da86372a8d620d6e0241e5be856">osp_txn_info</a> (struct <a class="el" href="structlu__context.html">lu_context</a> *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a5bb6aa7624abd65ed20e0f4c02eefe3a">lu_device_is_osp</a> (struct <a class="el" href="structlu__device.html">lu_device</a> *d)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#afffe9abf9b3893533e6550620568012b">lu2osp_dev</a> (struct <a class="el" href="structlu__device.html">lu_device</a> *d)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a2a742a9319121738b25b744accff7898">osp2lu_dev</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *d)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a458d702cd6853d8d1132c8635b6cc663">dt2osp_dev</a> (struct <a class="el" href="structdt__device.html">dt_device</a> *d)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structosp__object.html">osp_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a9165428b7ef613cb9e64b201c0ce3c11">lu2osp_obj</a> (struct <a class="el" href="structlu__object.html">lu_object</a> *o)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structlu__object.html">lu_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a3979d398f05faf5b113134303a66edd7">osp2lu_obj</a> (struct <a class="el" href="structosp__object.html">osp_object</a> *obj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structosp__object.html">osp_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#abee213e6b5aa210316a98ab6a05dc92a">osp_obj</a> (const struct <a class="el" href="structlu__object.html">lu_object</a> *o)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structosp__object.html">osp_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a074780981834d4e1a223d808589a0ee6">dt2osp_obj</a> (const struct <a class="el" href="structdt__object.html">dt_object</a> *d)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a1d0e37540b37bd0df90bcf224566ddaa">osp_object_child</a> (struct <a class="el" href="structosp__object.html">osp_object</a> *o)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structseq__server__site.html">seq_server_site</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a55ba5dc71f6810f2d8769b9a6fceb48f">osp_seq_site</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ad2568c2893e5e95a79d3724536b589be">osp_get_rpc_lock</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a97ac7a8248c1e841eaaf68b2bc688610">osp_put_rpc_lock</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ad07247e09c3b3aa45d705eb51c6f851c">osp_fid_diff</a> (const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid1, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a5e732504dc4a720f80dc74cd573b1237">osp_update_last_fid</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *d, struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a5a2f5d28a0fea14cb31c4bbb9fa0a9bb">osp_fid_end_seq</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a9bf651d4126997993cda6d2efac6146b">osp_precreate_end_seq_nolock</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ab8c3424a6810a58d39b1eeb73e91ee95">osp_precreate_end_seq</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a3dd9996a9555909f8605d28ee0ce005f">osp_is_fid_client</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structobject__update.html">object_update</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a33acca859878cfc874cc54cdc3c33458">update_buffer_get_update</a> (struct <a class="el" href="structobject__update__request.html">object_update_request</a> *request, unsigned int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a9b7ab9af6ec76be831a1bcec7ae183c5">osp_extend_update_buffer</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *our)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structosp__update__request__sub.html">osp_update_request_sub</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a11169ca71acf2f849764ac3e78e595c9">osp_current_object_update_request</a> (struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *our)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get current update request.  <a href="#a11169ca71acf2f849764ac3e78e595c9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a944ee7971f4e4493976d4da4baafdfda">osp_object_update_request_create</a> (struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *our, size_t <a class="el" href="parallel__grouplock_8c.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate new update request.  <a href="#a944ee7971f4e4493976d4da4baafdfda"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#acb2c73a51f76c6cf77f73578369a626c">osp_send_update_thread_running</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a2317e1f3a3cba7d6d7e377ef4eb7f17f">osp_send_update_thread_stopped</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ae12c825a26d57b1f61fc939b4b9c05e4">osp_update_last_id</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *d, u64 objid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#adf78c9e7e9976cb1c68011ccc1dd8b01">osp_insert_async_request</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, enum <a class="el" href="group__lustreidl.html#ga2d1a90f202540bfbcbd72a8c0f94b586">update_type</a> <a class="el" href="iam__ut_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>, struct <a class="el" href="structosp__object.html">osp_object</a> *obj, int count, __u16 *lens, const void **bufs, void *data, __u32 repsize, <a class="el" href="osp__internal_8h.html#a3b00e28d2b68085c3ebf8992634dbbca">osp_update_interpreter_t</a> interpreter)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Insert an asynchronous idempotent request to the shared request queue that is attached to the <a class="el" href="structosp__device.html">osp_device</a>.  <a href="#adf78c9e7e9976cb1c68011ccc1dd8b01"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#aa1b34250ba882a08a30329a2c712e3f9">osp_unplug_async_request</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__device.html">osp_device</a> *osp, struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *update)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pack all the requests in the shared asynchronous idempotent request queue into a single OUT RPC that will be given to the background <a class="el" href="structptlrpcd.html">ptlrpcd</a> daemon.  <a href="#aa1b34250ba882a08a30329a2c712e3f9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ad85a2edcb3ab6a94d03da547d8b0dd33">osp_trans_update_request_create</a> (struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a2963c05847ee507a77adeb79accdc6f7">osp_trans_create</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__device.html">dt_device</a> *d)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The OSP layer <a class="el" href="structdt__device__operations.html#a06f026899bb291ac5bb915a17dcadb7f" title="Create transaction.">dt_device_operations::dt_trans_create()</a> interface to create a transaction.  <a href="#a2963c05847ee507a77adeb79accdc6f7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#abc06232f12babe95aefb7105d7008d69">osp_trans_start</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__device.html">dt_device</a> *dt, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The OSP layer <a class="el" href="structdt__device__operations.html#a9f4532e51dbeefa61d9c0f6a9670ef5b" title="Start transaction.">dt_device_operations::dt_trans_start()</a> interface to start the transaction.  <a href="#abc06232f12babe95aefb7105d7008d69"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#abb8316c7e662b7b0845535658efba793">osp_insert_update_callback</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *update, struct <a class="el" href="structosp__object.html">osp_object</a> *obj, void *data, <a class="el" href="osp__internal_8h.html#a3b00e28d2b68085c3ebf8992634dbbca">osp_update_interpreter_t</a> interpreter)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Insert an <a class="el" href="structosp__update__callback.html" title="Call back for each update request.">osp_update_callback</a> into the <a class="el" href="structosp__update__request.html">osp_update_request</a>.  <a href="#abb8316c7e662b7b0845535658efba793"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a2ab6c8e8a82925f7fda820d3b20e7225">osp_update_request_create</a> (struct <a class="el" href="structdt__device.html">dt_device</a> *dt)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate and initialize <a class="el" href="structosp__update__request.html">osp_update_request</a>.  <a href="#a2ab6c8e8a82925f7fda820d3b20e7225"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a695103310a22be882fd6d5d45fff1c03">osp_update_request_destroy</a> (struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *update)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a7b0be3a2ddb7154bfa24d5b502c8763d">osp_send_update_thread</a> (void *arg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sending update thread.  <a href="#a7b0be3a2ddb7154bfa24d5b502c8763d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#acc48914405b387e92e6cfb6c38883562">osp_check_and_set_rpc_version</a> (struct <a class="el" href="structosp__thandle.html">osp_thandle</a> *oth, struct <a class="el" href="structosp__object.html">osp_object</a> *obj)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set version for the transaction.  <a href="#acc48914405b387e92e6cfb6c38883562"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a6bd88b1bd0177d870b04c84e6f9aea0e">osp_thandle_destroy</a> (struct <a class="el" href="structosp__thandle.html">osp_thandle</a> *oth)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a86c85504d915060117d7381e87a9d89d">osp_thandle_get</a> (struct <a class="el" href="structosp__thandle.html">osp_thandle</a> *oth)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#aaa76d6672c65cab88e50760545ca3dbf">osp_thandle_put</a> (struct <a class="el" href="structosp__thandle.html">osp_thandle</a> *oth)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a286fa51dc4b7827a253690dca8145b21">osp_prep_update_req</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structobd__import.html">obd_import</a> *imp, struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *our, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> **reqp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prepare update request.  <a href="#a286fa51dc4b7827a253690dca8145b21"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a69ead520a1bac2ac520325e430d9beca">osp_remote_sync</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__device.html">osp_device</a> *osp, struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *update, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> **reqp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send update RPC.  <a href="#a69ead520a1bac2ac520325e430d9beca"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#af9e29fa5d9911f2cd76c72c4d9d4d693">osp_get_storage_thandle</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structthandle.html">thandle</a> *th, struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get local <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> for <a class="el" href="structosp__thandle.html">osp_thandle</a>.  <a href="#af9e29fa5d9911f2cd76c72c4d9d4d693"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ac0eee5ec07a43a79b28e19e541e2a3a5">osp_trans_callback</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__thandle.html">osp_thandle</a> *oth, int rc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">callback of osp transaction  <a href="#ac0eee5ec07a43a79b28e19e541e2a3a5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a4e27b17abaedcfafe6e54d44fb616783">osp_invalidate_request</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Invalidate update request.  <a href="#a4e27b17abaedcfafe6e54d44fb616783"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#af3841bfc19af7e21ce75974da9e99b78">osp_attr_get</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, struct <a class="el" href="structlu__attr.html">lu_attr</a> *attr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implement OSP layer <a class="el" href="structdt__object__operations.html#a1d2ff17287fa229d0325cccf0aac5beb" title="Return regular attributes.">dt_object_operations::do_attr_get()</a> interface.  <a href="#af3841bfc19af7e21ce75974da9e99b78"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#aee4dfb5ebf4062287d3a3b1a4ee1ac13">osp_xattr_get</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, struct <a class="el" href="structlu__buf.html">lu_buf</a> *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, const char *<a class="el" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implement OSP layer <a class="el" href="structdt__object__operations.html#af4c8c504e52a5571dbd0557980c3818a" title="Return a value of an extended attribute.">dt_object_operations::do_xattr_get()</a> interface.  <a href="#aee4dfb5ebf4062287d3a3b1a4ee1ac13"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a087e25234317d46c46d282db94658f7b">osp_declare_xattr_set</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, const struct <a class="el" href="structlu__buf.html">lu_buf</a> *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, const char *<a class="el" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, int flag, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implement OSP layer <a class="el" href="structdt__object__operations.html#ad5d602fce101080720544cbdb0de96e8" title="Declare intention to change an extended attribute.">dt_object_operations::do_declare_xattr_set()</a> interface.  <a href="#a087e25234317d46c46d282db94658f7b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a6e9f34a7e74d91c77816e90c8d3002f5">osp_xattr_set</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, const struct <a class="el" href="structlu__buf.html">lu_buf</a> *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, const char *<a class="el" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, int fl, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implement OSP layer <a class="el" href="structdt__object__operations.html#a231db7d512a5786b8ad887e9fc47190b" title="Set an extended attribute.">dt_object_operations::do_xattr_set()</a> interface.  <a href="#a6e9f34a7e74d91c77816e90c8d3002f5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#afd49d501a6423438845e4f1e65c42dde">osp_declare_xattr_del</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, const char *<a class="el" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implement OSP layer <a class="el" href="structdt__object__operations.html#a7b2e57f4c0bdb5108e9d1920242e813e" title="Declare intention to delete an extended attribute.">dt_object_operations::do_declare_xattr_del()</a> interface.  <a href="#afd49d501a6423438845e4f1e65c42dde"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a5cba0564396dce70318ff5a5ac64f775">osp_xattr_del</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, const char *<a class="el" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implement OSP layer <a class="el" href="structdt__object__operations.html#a19762fb1d9e75136521019d51759b6ec" title="Delete an extended attribute.">dt_object_operations::do_xattr_del()</a> interface.  <a href="#a5cba0564396dce70318ff5a5ac64f775"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a38da7db0c90fa482dc7eab274b4775ef">osp_trans_stop</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__device.html">dt_device</a> *dt, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The OSP layer <a class="el" href="structdt__device__operations.html#a1a48e37999c62e8d1d2ad6e84572393b" title="Stop transaction.">dt_device_operations::dt_trans_stop()</a> interface to stop the transaction.  <a href="#a38da7db0c90fa482dc7eab274b4775ef"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a1a8c6788966fb5ad5c99a44e1e9c8bd6">osp_trans_cb_add</a> (struct <a class="el" href="structthandle.html">thandle</a> *th, struct <a class="el" href="structdt__txn__commit__cb.html">dt_txn_commit_cb</a> *dcb)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add commit callback to transaction.  <a href="#a1a8c6788966fb5ad5c99a44e1e9c8bd6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct dt_it *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a0da5f987514d58d617d9e20d1b5ffa9e">osp_it_init</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, __u32 attr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the OSP layer index iteration.  <a href="#a0da5f987514d58d617d9e20d1b5ffa9e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ae9d075a9ad9358a90a4e0ee239e944f1">osp_it_fini</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct dt_it *di)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Finalize the OSP layer index iteration.  <a href="#ae9d075a9ad9358a90a4e0ee239e944f1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a07d21a6da27503c32900b08c2c084faf">osp_it_get</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct dt_it *di, const struct <a class="el" href="dt__object_8c.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *key)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a8106562211602449cbbfe777335da553">osp_it_put</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct dt_it *di)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a80a49dbf124329dd0433ee6924d97462">osp_it_store</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct dt_it *di)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ae029b34f183e7b6def52134812822a2f">osp_it_key_rec</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, const struct dt_it *di, void *key_rec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a15b2be68bdfbe9bccf8d43b4d5174080">osp_it_next_page</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct dt_it *di)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Move the iteration cursor to the next <a class="el" href="unionlu__page.html">lu_page</a>.  <a href="#a15b2be68bdfbe9bccf8d43b4d5174080"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a6495832e4efeddcaa1368ffe41af4c85">osp_oac_init</a> (struct <a class="el" href="structosp__object.html">osp_object</a> *obj)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the OSP object attributes cache.  <a href="#a6495832e4efeddcaa1368ffe41af4c85"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a1795337c33a409d5f78b87ff38a112ec">osp_md_declare_object_create</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, struct <a class="el" href="structlu__attr.html">lu_attr</a> *attr, struct <a class="el" href="structdt__allocation__hint.html">dt_allocation_hint</a> *hint, struct <a class="el" href="structdt__object__format.html">dt_object_format</a> *dof, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structdt__object__operations.html#ab16b75516dfd3d619fbffbc96f2b9d24" title="Declare intention to create a new object.">dt_object_operations::do_declare_create</a>.  <a href="#a1795337c33a409d5f78b87ff38a112ec"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a64726676693349c027bdbe148fba7d97">osp_md_object_create</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, struct <a class="el" href="structlu__attr.html">lu_attr</a> *attr, struct <a class="el" href="structdt__allocation__hint.html">dt_allocation_hint</a> *hint, struct <a class="el" href="structdt__object__format.html">dt_object_format</a> *dof, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structdt__object__operations.html#ac1ca5a81cd3d00bd821fbfead64022c3" title="Create new object.">dt_object_operations::do_create</a>.  <a href="#a64726676693349c027bdbe148fba7d97"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#aa0885e2736c65c081a737b04e83ddf94">osp_md_declare_attr_set</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, const struct <a class="el" href="structlu__attr.html">lu_attr</a> *attr, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structdt__object__operations.html#adc1fb34feaf57d9448beaab7f04302bd" title="Declare intention to request reqular attributes.">dt_object_operations::do_declare_attr_get</a>.  <a href="#aa0885e2736c65c081a737b04e83ddf94"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ac407cef7eae29c85a3dee04fe4cc20ab">osp_md_attr_set</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, const struct <a class="el" href="structlu__attr.html">lu_attr</a> *attr, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structdt__object__operations.html#aa9a55847088d77aa8bbc16c693344ddb" title="Change regular attributes.">dt_object_operations::do_attr_set</a>.  <a href="#ac407cef7eae29c85a3dee04fe4cc20ab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a09b997ecfc36135a541eb336e22230a5">osp_init_precreate</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *d)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize precreation functionality of OSP.  <a href="#a09b997ecfc36135a541eb336e22230a5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a39a28e9de51d9e97ee937560ddbf0283">osp_precreate_reserve</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__device.html">osp_device</a> *d)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reserve object in precreate pool.  <a href="#a39a28e9de51d9e97ee937560ddbf0283"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a24bf10268d2448e2d6a4c06f107ea0ef">osp_precreate_get_id</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *d)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#afcddb5166989024d615815d6394ee83b">osp_precreate_get_fid</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__device.html">osp_device</a> *d, struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a FID from precreation pool.  <a href="#afcddb5166989024d615815d6394ee83b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a6b0bb6ab17743e9127d9a917ba9eac08">osp_precreate_fini</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *d)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Finish precreate functionality of OSP.  <a href="#a6b0bb6ab17743e9127d9a917ba9eac08"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a57b3438c59b9431b0f75eba5ef4cec44">osp_object_truncate</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structdt__object.html">dt_object</a> *dt, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ad08581208c0888d2bfb28babb414be1c">osp_pre_update_status</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *d, int rc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update precreate status using statfs data.  <a href="#ad08581208c0888d2bfb28babb414be1c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ae60d06a7a5c2c36f3248f4394e7fd7d1">osp_statfs_need_now</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *d)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Schedule an immediate update for statfs data.  <a href="#ae60d06a7a5c2c36f3248f4394e7fd7d1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a53e4fdfe8ba0a0942aa2ddfb7931b622">osp_reset_last_used</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a90b9288ca2540bfbf52700423ed6193a">osp_write_last_oid_seq_files</a> (struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__device.html">osp_device</a> *osp, struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, int sync)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write FID into into last_oid/last_seq file.  <a href="#a90b9288ca2540bfbf52700423ed6193a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a14bf441f342654b878660cf2573f08f9">osp_init_pre_fid</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize FID for precreation.  <a href="#a14bf441f342654b878660cf2573f08f9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a3b8512ad4175b3e0e2b52a1ff8f6d1ec">osp_lprocfs_init</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *osp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#af6eb77a1052667e2af318b2b5b934f80">osp_sync_declare_add</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__object.html">osp_object</a> *o, <a class="el" href="packet-lustre_8c.html#a46267c71f9f2221271c977534b08c789">llog_op_type</a> type, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declare intention to add a new change.  <a href="#af6eb77a1052667e2af318b2b5b934f80"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ad84dcbea0dbe8c7aba1d3a5514e236f0">osp_sync_add</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__object.html">osp_object</a> *o, <a class="el" href="packet-lustre_8c.html#a46267c71f9f2221271c977534b08c789">llog_op_type</a> type, struct <a class="el" href="structthandle.html">thandle</a> *th, const struct <a class="el" href="structlu__attr.html">lu_attr</a> *attr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a09b409cb21b03007d14cc16ca03c172d">osp_sync_init</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structosp__device.html">osp_device</a> *d)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the sync component of OSP.  <a href="#a09b409cb21b03007d14cc16ca03c172d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a9fad5e902635f80345fb875169be1e03">osp_sync_fini</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *d)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop the syncing thread.  <a href="#a9fad5e902635f80345fb875169be1e03"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a0ee09d7a7bbe9d8629ef0cb19e5e57d5">__osp_sync_check_for_work</a> (struct <a class="el" href="structosp__device.html">osp_device</a> *d)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct kmem_cache *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a5ba0c65d48df6137aa2c1c66354fa0e1">osp_object_kmem</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlu__object__operations.html">lu_object_operations</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a6e0b54753466e13a043eadfebe298cfa">osp_lu_obj_ops</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdt__device__operations.html">dt_device_operations</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a037aa9290c964160d0fa3173b14e9415">osp_dt_ops</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdt__object__operations.html">dt_object_operations</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#aee566563c307580adca54ebbe83a90ff">osp_md_obj_ops</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdt__body__operations.html">dt_body_operations</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ab87b8d6d0e7f500b48bab8162b2f1e2f">osp_md_body_ops</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlu__context__key.html">lu_context_key</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ad3c37ca09ea52b0ec6f6c77e71a8d18e">osp_thread_key</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlu__context__key.html">lu_context_key</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a6f9defa450c24f77e303a32d1834e142">osp_txn_key</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlu__device__operations.html">lu_device_operations</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a9e545f9a09277a5db32dcc53f3ae6484">osp_lu_ops</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structllog__operations.html">llog_operations</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a242e4f041ab0c6d014f218b12aec9622">osp_mds_ost_orig_logops</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdt__index__operations.html">dt_index_operations</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a903290e01e7a292d2756658146333a2a">osp_md_index_ops</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structobd__ops.html">obd_ops</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#a70a723146dd3838700f2cf71a2f489a5">lwp_obd_device_ops</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlu__device__type.html">lu_device_type</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="osp__internal_8h.html#ad5957782faa61ec74e1f98b9c2df7f87">lwp_device_type</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a04c407c11a6b959df725fc7ddbb22b1f"></a><!-- doxytag: member="osp_internal.h::opd_pre_create_count" ref="a04c407c11a6b959df725fc7ddbb22b1f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define opd_pre_create_count&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_create_count</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00261">261</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae0cc05840a4169412e41f5bebd3f39d6"></a><!-- doxytag: member="osp_internal.h::opd_pre_create_slow" ref="ae0cc05840a4169412e41f5bebd3f39d6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define opd_pre_create_slow&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_create_slow</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00264">264</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7100923c7b9bfa917040ee031074cefa"></a><!-- doxytag: member="osp_internal.h::opd_pre_last_created_fid" ref="a7100923c7b9bfa917040ee031074cefa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define opd_pre_last_created_fid&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_last_created_fid</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00257">257</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8f4f848e964336697dc89158b6f92707"></a><!-- doxytag: member="osp_internal.h::opd_pre_lock" ref="a8f4f848e964336697dc89158b6f92707" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define opd_pre_lock&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_lock</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00255">255</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

</div>
</div>
<a class="anchor" id="aeec7adadf98448144bc1010485eb6db3"></a><!-- doxytag: member="osp_internal.h::opd_pre_max_create_count" ref="aeec7adadf98448144bc1010485eb6db3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define opd_pre_max_create_count&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_max_create_count</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00263">263</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa68b8bb1a8de7154a751c4ce6e953916"></a><!-- doxytag: member="osp_internal.h::opd_pre_min_create_count" ref="aa68b8bb1a8de7154a751c4ce6e953916" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define opd_pre_min_create_count&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_min_create_count</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00262">262</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

</div>
</div>
<a class="anchor" id="a773efc591d1183ffc6283be08b3f4659"></a><!-- doxytag: member="osp_internal.h::opd_pre_recovering" ref="a773efc591d1183ffc6283be08b3f4659" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define opd_pre_recovering&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_recovering</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00265">265</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1a8b99c31621ffdb37ca21e269344a3f"></a><!-- doxytag: member="osp_internal.h::opd_pre_reserved" ref="a1a8b99c31621ffdb37ca21e269344a3f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define opd_pre_reserved&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_reserved</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00258">258</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5a986f1ecad6aa007292094cce20c12a"></a><!-- doxytag: member="osp_internal.h::opd_pre_status" ref="a5a986f1ecad6aa007292094cce20c12a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define opd_pre_status&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_status</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00260">260</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9dc35b9b3181ac39cce2a08adc43c83d"></a><!-- doxytag: member="osp_internal.h::opd_pre_used_fid" ref="a9dc35b9b3181ac39cce2a08adc43c83d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define opd_pre_used_fid&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_used_fid</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00256">256</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6eae9e3c24780b0bcca2ee2dbffb1101"></a><!-- doxytag: member="osp_internal.h::opd_pre_user_waitq" ref="a6eae9e3c24780b0bcca2ee2dbffb1101" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define opd_pre_user_waitq&nbsp;&nbsp;&nbsp;opd_pre-&gt;osp_pre_user_waitq</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00259">259</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0e30b316fa5a6cc8a8464b085b888017"></a><!-- doxytag: member="osp_internal.h::osp_init_rpc_lock" ref="a0e30b316fa5a6cc8a8464b085b888017" args="(lck)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define osp_init_rpc_lock</td>
          <td>(</td>
          <td class="paramtype">lck&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;mdc_init_rpc_lock(lck)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00493">493</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l00996">osp_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="ad5acc38b25b10da1ee066ff2f2f30454"></a><!-- doxytag: member="osp_internal.h::OSP_THANDLE_MAGIC" ref="ad5acc38b25b10da1ee066ff2f2f30454" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSP_THANDLE_MAGIC&nbsp;&nbsp;&nbsp;0x20141214</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00348">348</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>Referenced by <a class="el" href="osp__trans_8c_source.html#l00919">osp_thandle_destroy()</a>, and <a class="el" href="osp__trans_8c_source.html#l00956">osp_trans_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a0ec6e9ba0fe3f28d7b45a1918dd61e37"></a><!-- doxytag: member="osp_internal.h::osp_update_rpc_pack" ref="a0ec6e9ba0fe3f28d7b45a1918dd61e37" args="(env, name, our, op,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define osp_update_rpc_pack</td>
          <td>(</td>
          <td class="paramtype">env, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mdt__coordinator_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">our, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="iam__ut_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"> <em>...</em>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00605">605</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00542">osp_attr_get()</a>, <a class="el" href="osp__md__object_8c_source.html#l00359">osp_md_attr_set()</a>, <a class="el" href="osp__md__object_8c_source.html#l00652">osp_md_index_delete()</a>, <a class="el" href="osp__md__object_8c_source.html#l00598">osp_md_index_insert()</a>, <a class="el" href="osp__md__object_8c_source.html#l00480">osp_md_index_lookup()</a>, <a class="el" href="osp__md__object_8c_source.html#l00173">osp_md_object_create()</a>, <a class="el" href="osp__md__object_8c_source.html#l00983">osp_md_object_destroy()</a>, <a class="el" href="osp__md__object_8c_source.html#l01126">osp_md_read()</a>, <a class="el" href="osp__md__object_8c_source.html#l00283">osp_md_ref_add()</a>, <a class="el" href="osp__md__object_8c_source.html#l00237">osp_md_ref_del()</a>, <a class="el" href="osp__md__object_8c_source.html#l01090">osp_md_write()</a>, <a class="el" href="osp__object_8c_source.html#l01260">osp_xattr_del()</a>, <a class="el" href="osp__object_8c_source.html#l00916">osp_xattr_get()</a>, and <a class="el" href="osp__object_8c_source.html#l01153">osp_xattr_set()</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a3b00e28d2b68085c3ebf8992634dbbca"></a><!-- doxytag: member="osp_internal.h::osp_update_interpreter_t" ref="a3b00e28d2b68085c3ebf8992634dbbca" args=")(const struct lu_env *env, struct object_update_reply *rep, struct ptlrpc_request *req, struct osp_object *obj, void *data, int index, int rc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* <a class="el" href="osp__internal_8h.html#a3b00e28d2b68085c3ebf8992634dbbca">osp_update_interpreter_t</a>)(const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structobject__update__reply.html">object_update_reply</a> *rep, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structosp__object.html">osp_object</a> *obj, void *data, int index, int rc)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00660">660</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a0ee09d7a7bbe9d8629ef0cb19e5e57d5"></a><!-- doxytag: member="osp_internal.h::__osp_sync_check_for_work" ref="a0ee09d7a7bbe9d8629ef0cb19e5e57d5" args="(struct osp_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __osp_sync_check_for_work </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__sync_8c_source.html#l00236">236</a> of file <a class="el" href="osp__sync_8c_source.html">osp_sync.c</a>.</p>

<p>References <a class="el" href="osp__sync_8c_source.html#l00229">osp_sync_check_for_work</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l01574">osp_import_event()</a>, and <a class="el" href="osp__dev_8c_source.html#l00781">osp_sync()</a>.</p>

</div>
</div>
<a class="anchor" id="a458d702cd6853d8d1132c8635b6cc663"></a><!-- doxytag: member="osp_internal.h::dt2osp_dev" ref="a458d702cd6853d8d1132c8635b6cc663" args="(struct dt_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structosp__device.html">osp_device</a>* dt2osp_dev </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdt__device.html">dt_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00454">454</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="osp__internal_8h_source.html#l00438">lu_device_is_osp()</a>, and <a class="el" href="osp__internal_8h_source.html#l00139">osp_device::opd_dt_dev</a>.</p>

<p>Referenced by <a class="el" href="osp__trans_8c_source.html#l01264">osp_check_and_set_rpc_version()</a>, <a class="el" href="osp__md__object_8c_source.html#l01053">osp_md_declare_write()</a>, <a class="el" href="osp__md__object_8c_source.html#l00880">osp_md_object_lock()</a>, <a class="el" href="osp__dev_8c_source.html#l00720">osp_statfs()</a>, <a class="el" href="osp__dev_8c_source.html#l00781">osp_sync()</a>, <a class="el" href="osp__trans_8c_source.html#l01542">osp_trans_stop()</a>, and <a class="el" href="osp__trans_8c_source.html#l00605">osp_update_interpret()</a>.</p>

</div>
</div>
<a class="anchor" id="a074780981834d4e1a223d808589a0ee6"></a><!-- doxytag: member="osp_internal.h::dt2osp_obj" ref="a074780981834d4e1a223d808589a0ee6" args="(const struct dt_object *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structosp__object.html">osp_object</a>* dt2osp_obj </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00477">477</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, and <a class="el" href="osp__internal_8h_source.html#l00471">osp_obj()</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00542">osp_attr_get()</a>, <a class="el" href="osp__object_8c_source.html#l00709">osp_attr_set()</a>, <a class="el" href="osp__object_8c_source.html#l00503">osp_declare_attr_get()</a>, <a class="el" href="osp__object_8c_source.html#l00638">osp_declare_attr_set()</a>, <a class="el" href="osp__object_8c_source.html#l01309">osp_declare_object_create()</a>, <a class="el" href="osp__object_8c_source.html#l01530">osp_declare_object_destroy()</a>, <a class="el" href="osp__object_8c_source.html#l00835">osp_declare_xattr_get()</a>, <a class="el" href="osp__md__object_8c_source.html#l00121">osp_md_declare_object_create()</a>, <a class="el" href="osp__md__object_8c_source.html#l01053">osp_md_declare_write()</a>, <a class="el" href="osp__md__object_8c_source.html#l00173">osp_md_object_create()</a>, <a class="el" href="osp__md__object_8c_source.html#l00983">osp_md_object_destroy()</a>, <a class="el" href="osp__md__object_8c_source.html#l00385">osp_md_object_read_lock()</a>, <a class="el" href="osp__md__object_8c_source.html#l00424">osp_md_object_read_unlock()</a>, <a class="el" href="osp__md__object_8c_source.html#l00405">osp_md_object_write_lock()</a>, <a class="el" href="osp__md__object_8c_source.html#l00458">osp_md_object_write_locked()</a>, <a class="el" href="osp__md__object_8c_source.html#l00440">osp_md_object_write_unlock()</a>, <a class="el" href="osp__md__object_8c_source.html#l01090">osp_md_write()</a>, <a class="el" href="osp__object_8c_source.html#l01417">osp_object_create()</a>, <a class="el" href="osp__object_8c_source.html#l01562">osp_object_destroy()</a>, <a class="el" href="osp__object_8c_source.html#l01260">osp_xattr_del()</a>, <a class="el" href="osp__object_8c_source.html#l00916">osp_xattr_get()</a>, and <a class="el" href="osp__object_8c_source.html#l01153">osp_xattr_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a33909940f130d0ddbf0f4f60dd163b08"></a><!-- doxytag: member="osp_internal.h::is_only_remote_trans" ref="a33909940f130d0ddbf0f4f60dd163b08" args="(struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool is_only_remote_trans </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00378">378</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01836">thandle::th_top</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00709">osp_attr_set()</a>, <a class="el" href="osp__object_8c_source.html#l00638">osp_declare_attr_set()</a>, <a class="el" href="osp__object_8c_source.html#l01309">osp_declare_object_create()</a>, <a class="el" href="osp__object_8c_source.html#l01417">osp_object_create()</a>, and <a class="el" href="osp__trans_8c_source.html#l01509">osp_trans_start()</a>.</p>

</div>
</div>
<a class="anchor" id="afffe9abf9b3893533e6550620568012b"></a><!-- doxytag: member="osp_internal.h::lu2osp_dev" ref="afffe9abf9b3893533e6550620568012b" args="(struct lu_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structosp__device.html">osp_device</a>* lu2osp_dev </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00443">443</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="osp__internal_8h_source.html#l00438">lu_device_is_osp()</a>, and <a class="el" href="osp__internal_8h_source.html#l00139">osp_device::opd_dt_dev</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00137">is_ost_obj()</a>, <a class="el" href="osp__object_8c_source.html#l00542">osp_attr_get()</a>, <a class="el" href="osp__object_8c_source.html#l00503">osp_declare_attr_get()</a>, <a class="el" href="osp__object_8c_source.html#l00638">osp_declare_attr_set()</a>, <a class="el" href="osp__object_8c_source.html#l01309">osp_declare_object_create()</a>, <a class="el" href="osp__object_8c_source.html#l01530">osp_declare_object_destroy()</a>, <a class="el" href="osp__object_8c_source.html#l00835">osp_declare_xattr_get()</a>, <a class="el" href="osp__dev_8c_source.html#l01319">osp_device_fini()</a>, <a class="el" href="osp__dev_8c_source.html#l01255">osp_device_free()</a>, <a class="el" href="osp__dev_8c_source.html#l01821">osp_fid_alloc()</a>, <a class="el" href="osp__dev_8c_source.html#l01574">osp_import_event()</a>, <a class="el" href="osp__trans_8c_source.html#l00840">osp_insert_async_request()</a>, <a class="el" href="osp__dev_8c_source.html#l01660">osp_iocontrol()</a>, <a class="el" href="osp__object_8c_source.html#l01695">osp_it_fetch()</a>, <a class="el" href="osp__object_8c_source.html#l01833">osp_it_next_page()</a>, <a class="el" href="osp__md__object_8c_source.html#l00480">osp_md_index_lookup()</a>, <a class="el" href="osp__md__object_8c_source.html#l00983">osp_md_object_destroy()</a>, <a class="el" href="osp__md__object_8c_source.html#l01126">osp_md_read()</a>, <a class="el" href="osp__dev_8c_source.html#l01398">osp_obd_connect()</a>, <a class="el" href="osp__dev_8c_source.html#l01463">osp_obd_disconnect()</a>, <a class="el" href="osp__dev_8c_source.html#l01721">osp_obd_get_info()</a>, <a class="el" href="osp__dev_8c_source.html#l01746">osp_obd_set_info_async()</a>, <a class="el" href="osp__object_8c_source.html#l01417">osp_object_create()</a>, <a class="el" href="osp__object_8c_source.html#l01562">osp_object_destroy()</a>, <a class="el" href="osp__object_8c_source.html#l02212">osp_object_release()</a>, <a class="el" href="osp__precreate_8c_source.html#l01454">osp_object_truncate()</a>, <a class="el" href="osp__dev_8c_source.html#l00626">osp_process_config()</a>, <a class="el" href="osp__dev_8c_source.html#l00683">osp_recovery_complete()</a>, <a class="el" href="osp__sync_8c_source.html#l00429">osp_sync_add()</a>, <a class="el" href="osp__sync_8c_source.html#l00294">osp_sync_declare_add()</a>, <a class="el" href="osp__object_8c_source.html#l00916">osp_xattr_get()</a>, and <a class="el" href="osp__object_8c_source.html#l01153">osp_xattr_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a9165428b7ef613cb9e64b201c0ce3c11"></a><!-- doxytag: member="osp_internal.h::lu2osp_obj" ref="a9165428b7ef613cb9e64b201c0ce3c11" args="(struct lu_object *o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structosp__object.html">osp_object</a>* lu2osp_obj </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlu__object.html">lu_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00460">460</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="osd__iam_8h_source.html#l00057">ergo</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00472">lu_object::lo_dev</a>, <a class="el" href="osp__internal_8h_source.html#l00438">lu_device_is_osp()</a>, and <a class="el" href="osp__internal_8h_source.html#l00291">osp_object::opo_obj</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l02173">osp_object_free()</a>, <a class="el" href="osp__object_8c_source.html#l02127">osp_object_init()</a>, <a class="el" href="osp__object_8c_source.html#l02244">osp_object_print()</a>, <a class="el" href="osp__object_8c_source.html#l02212">osp_object_release()</a>, and <a class="el" href="osp__trans_8c_source.html#l00481">osp_thandle_invalidate_object()</a>.</p>

</div>
</div>
<a class="anchor" id="a5bb6aa7624abd65ed20e0f4c02eefe3a"></a><!-- doxytag: member="osp_internal.h::lu_device_is_osp" ref="a5bb6aa7624abd65ed20e0f4c02eefe3a" args="(struct lu_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int lu_device_is_osp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00438">438</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="osd__iam_8h_source.html#l00057">ergo</a>, <a class="el" href="lu__object_8h_source.html#l00279">lu_device::ld_ops</a>, and <a class="el" href="osp__dev_8c_source.html#l00697">osp_lu_ops</a>.</p>

<p>Referenced by <a class="el" href="osp__internal_8h_source.html#l00454">dt2osp_dev()</a>, <a class="el" href="osp__internal_8h_source.html#l00443">lu2osp_dev()</a>, <a class="el" href="osp__internal_8h_source.html#l00460">lu2osp_obj()</a>, and <a class="el" href="osp__internal_8h_source.html#l00471">osp_obj()</a>.</p>

</div>
</div>
<a class="anchor" id="a2a742a9319121738b25b744accff7898"></a><!-- doxytag: member="osp_internal.h::osp2lu_dev" ref="a2a742a9319121738b25b744accff7898" args="(struct osp_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structlu__device.html">lu_device</a>* osp2lu_dev </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00449">449</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, and <a class="el" href="osp__internal_8h_source.html#l00139">osp_device::opd_dt_dev</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l01283">osp_device_alloc()</a>.</p>

</div>
</div>
<a class="anchor" id="a3979d398f05faf5b113134303a66edd7"></a><!-- doxytag: member="osp_internal.h::osp2lu_obj" ref="a3979d398f05faf5b113134303a66edd7" args="(struct osp_object *obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structlu__object.html">lu_object</a>* osp2lu_obj </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__object.html">osp_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00466">466</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, and <a class="el" href="osp__internal_8h_source.html#l00291">osp_object::opo_obj</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00542">osp_attr_get()</a>, <a class="el" href="osp__object_8c_source.html#l00457">osp_attr_get_interpterer()</a>, <a class="el" href="osp__trans_8c_source.html#l00840">osp_insert_async_request()</a>, <a class="el" href="osp__internal_8h_source.html#l00482">osp_object_child()</a>, <a class="el" href="osp__trans_8c_source.html#l00582">osp_update_callback_fini()</a>, and <a class="el" href="osp__trans_8c_source.html#l00558">osp_update_callback_init()</a>.</p>

</div>
</div>
<a class="anchor" id="af3841bfc19af7e21ce75974da9e99b78"></a><!-- doxytag: member="osp_internal.h::osp_attr_get" ref="af3841bfc19af7e21ce75974da9e99b78" args="(const struct lu_env *env, struct dt_object *dt, struct lu_attr *attr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_attr_get </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implement OSP layer <a class="el" href="structdt__object__operations.html#a1d2ff17287fa229d0325cccf0aac5beb" title="Return regular attributes.">dt_object_operations::do_attr_get()</a> interface. </p>
<p>Get attribute from the specified MDT/OST object.</p>
<p>If the attribute is in the OSP object attributes cache, then return the cached attribute directly. Otherwise it will trigger an OUT RPC to the peer to get the attribute synchronously, if successful, add it to the OSP attributes cache. (</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="osp__trans_8c.html">lustre/osp/osp_trans.c</a> for <a class="el" href="gni__pub_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> RPC.)</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>pointer to the OSP layer <a class="el" href="structdt__object.html">dt_object</a> </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>attr</em>&nbsp;</td><td>pointer to the buffer to hold the output attribute</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l00542">542</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="osp__internal_8h_source.html#l00477">dt2osp_obj()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="osp__object_8c_source.html#l00137">is_ost_obj()</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="lu__object_8h_source.html#l00287">lu_device::ld_obd</a>, <a class="el" href="lu__object_8h_source.html#l00472">lu_object::lo_dev</a>, <a class="el" href="lu__object_8h_source.html#l00468">lu_object::lo_header</a>, <a class="el" href="lu__object_8h_source.html#l00539">lu_object_header::loh_attr</a>, <a class="el" href="lu__object_8h_source.html#l00501">LOHA_EXISTS</a>, <a class="el" href="osp__internal_8h_source.html#l00443">lu2osp_dev()</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="osp__internal_8h_source.html#l00284">osp_object_attr::ooa_attr</a>, <a class="el" href="osp__internal_8h_source.html#l00139">osp_device::opd_dt_dev</a>, <a class="el" href="osp__internal_8h_source.html#l00301">osp_object::opo_lock</a>, <a class="el" href="osp__internal_8h_source.html#l00292">osp_object::opo_non_exist</a>, <a class="el" href="osp__internal_8h_source.html#l00299">osp_object::opo_ooa</a>, <a class="el" href="osp__internal_8h_source.html#l00292">osp_object::opo_stale</a>, <a class="el" href="osp__internal_8h_source.html#l00466">osp2lu_obj()</a>, <a class="el" href="osp__object_8c_source.html#l00400">osp_get_attr_from_reply()</a>, <a class="el" href="osp__trans_8c_source.html#l00442">osp_remote_sync()</a>, <a class="el" href="osp__trans_8c_source.html#l00187">osp_update_request_create()</a>, <a class="el" href="osp__trans_8c_source.html#l00204">osp_update_request_destroy()</a>, <a class="el" href="osp__internal_8h_source.html#l00605">osp_update_rpc_pack</a>, <a class="el" href="lustre__idl_8h_source.html#l03922">object_update_reply::ourp_magic</a>, <a class="el" href="lustre__idl_8h_source.html#l03790">OUT_ATTR_GET</a>, <a class="el" href="lustre__update_8h_source.html#l00037">OUT_UPDATE_REPLY_SIZE</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="client_8c_source.html#l02490">ptlrpc_req_finished()</a>, <a class="el" href="layout_8c_source.html#l02186">req_capsule_server_sized_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01199">RMF_OUT_UPDATE_REPLY</a>, <a class="el" href="lustre__net_8h_source.html#l01121">ptlrpc_request::rq_pill</a>, and <a class="el" href="lustre__idl_8h_source.html#l03919">UPDATE_REPLY_MAGIC</a>.</p>

</div>
</div>
<a class="anchor" id="ac0163fa20c5c87a5f52212b518d8e459"></a><!-- doxytag: member="osp_internal.h::osp_buf_prep" ref="ac0163fa20c5c87a5f52212b518d8e459" args="(struct lu_buf *lb, void *buf, int buf_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void osp_buf_prep </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>lb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>buf_len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00401">401</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, and <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>.</p>

</div>
</div>
<a class="anchor" id="acc48914405b387e92e6cfb6c38883562"></a><!-- doxytag: member="osp_internal.h::osp_check_and_set_rpc_version" ref="acc48914405b387e92e6cfb6c38883562" args="(struct osp_thandle *oth, struct osp_object *obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_check_and_set_rpc_version </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__thandle.html">osp_thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>oth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__object.html">osp_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set version for the transaction. </p>
<p>Set the version for the transaction and add the request to the sending list, then after transaction stop, the request will be picked in the order of version, by sending thread.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oth</em>&nbsp;</td><td>osp <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> to be set version.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if set version succeeds negative errno if set version fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l01264">1264</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="osp__internal_8h_source.html#l00454">dt2osp_dev()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="list_8h_source.html#l00090">list_add_tail()</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="osp__internal_8h_source.html#l00186">osp_device::opd_update</a>, <a class="el" href="osp__internal_8h_source.html#l00292">osp_object::opo_stale</a>, <a class="el" href="osp__internal_8h_source.html#l00697">osp_thandle_get()</a>, <a class="el" href="osp__internal_8h_source.html#l00357">osp_thandle::ot_our</a>, <a class="el" href="osp__internal_8h_source.html#l00350">osp_thandle::ot_super</a>, <a class="el" href="osp__internal_8h_source.html#l00130">osp_updates::ou_list</a>, <a class="el" href="osp__internal_8h_source.html#l00131">osp_updates::ou_lock</a>, <a class="el" href="osp__internal_8h_source.html#l00135">osp_updates::ou_version</a>, <a class="el" href="osp__internal_8h_source.html#l00123">osp_update_request::our_list</a>, <a class="el" href="osp__internal_8h_source.html#l00121">osp_update_request::our_list_lock</a>, <a class="el" href="osp__internal_8h_source.html#l00125">osp_update_request::our_req_ready</a>, <a class="el" href="osp__internal_8h_source.html#l00119">osp_update_request::our_version</a>, <a class="el" href="dt__object_8h_source.html#l01828">thandle::th_dev</a>, and <a class="el" href="dt__object_8h_source.html#l01848">thandle::th_wait_submit</a>.</p>

<p>Referenced by <a class="el" href="osp__md__object_8c_source.html#l01090">osp_md_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a11169ca71acf2f849764ac3e78e595c9"></a><!-- doxytag: member="osp_internal.h::osp_current_object_update_request" ref="a11169ca71acf2f849764ac3e78e595c9" args="(struct osp_update_request *our)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structosp__update__request__sub.html">osp_update_request_sub</a>* osp_current_object_update_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *&nbsp;</td>
          <td class="paramname"> <em>our</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get current update request. </p>
<p>Get current object update request from our_req_list in <a class="el" href="structosp__update__request.html">osp_update_request</a>, because we always insert the new update request in the last position, so the last update request in the list will be the current update req.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>our</em>&nbsp;</td><td>osp update request where to get the current object update.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>the</em>&nbsp;</td><td>current object update. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00166">166</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="list_8h_source.html#l00242">list_entry</a>, <a class="el" href="osp__internal_8h_source.html#l00110">osp_update_request::our_req_list</a>, <a class="el" href="osp__internal_8h_source.html#l00101">osp_update_request_sub::ours_list</a>, and <a class="el" href="list_8h_source.html#l00043">list_head::prev</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00835">osp_declare_xattr_get()</a>, and <a class="el" href="osp__trans_8c_source.html#l00840">osp_insert_async_request()</a>.</p>

</div>
</div>
<a class="anchor" id="afd49d501a6423438845e4f1e65c42dde"></a><!-- doxytag: member="osp_internal.h::osp_declare_xattr_del" ref="afd49d501a6423438845e4f1e65c42dde" args="(const struct lu_env *env, struct dt_object *dt, const char *name, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_declare_xattr_del </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implement OSP layer <a class="el" href="structdt__object__operations.html#a7b2e57f4c0bdb5108e9d1920242e813e" title="Declare intention to delete an extended attribute.">dt_object_operations::do_declare_xattr_del()</a> interface. </p>
<p>Declare that the caller will delete extended attribute on the specified MDT/OST object.</p>
<p>If it is non-remote transaction, it will add an OUT_XATTR_DEL sub-request to the OUT RPC that will be flushed when the transaction start. And if the name extended attribute entry exists in the OSP attributes cache, then remove it from the cache.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>pointer to the OSP layer <a class="el" href="structdt__object.html">dt_object</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>the name of the extended attribute to be set </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>pointer to the transaction handler</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l01236">1236</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

<p>References <a class="el" href="osp__trans_8c_source.html#l00899">osp_trans_update_request_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a087e25234317d46c46d282db94658f7b"></a><!-- doxytag: member="osp_internal.h::osp_declare_xattr_set" ref="a087e25234317d46c46d282db94658f7b" args="(const struct lu_env *env, struct dt_object *dt, const struct lu_buf *buf, const char *name, int flag, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_declare_xattr_set </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implement OSP layer <a class="el" href="structdt__object__operations.html#ad5d602fce101080720544cbdb0de96e8" title="Declare intention to change an extended attribute.">dt_object_operations::do_declare_xattr_set()</a> interface. </p>
<p>Declare that the caller will set extended attribute to the specified MDT/OST object.</p>
<p>If it is non-remote transaction, it will add an OUT_XATTR_SET sub-request to the OUT RPC that will be flushed when the transaction start. And if the OSP attributes cache is initialized, then check whether the name extended attribute entry exists in the cache or not. If yes, replace it; otherwise, add the extended attribute to the cache.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>pointer to the OSP layer <a class="el" href="structdt__object.html">dt_object</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>pointer to the <a class="el" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> to hold the extended attribute </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>the name of the extended attribute to be set </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>flag</em>&nbsp;</td><td>to indicate the detailed set operation: LU_XATTR_CREATE or LU_XATTR_REPLACE or others </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>pointer to the transaction handler</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l01125">1125</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

<p>References <a class="el" href="osp__trans_8c_source.html#l00899">osp_trans_update_request_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a79484131bd498d4f261f65c5de2af088"></a><!-- doxytag: member="osp_internal.h::osp_env_info" ref="a79484131bd498d4f261f65c5de2af088" args="(const struct lu_env *env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structosp__thread__info.html">osp_thread_info</a>* osp_env_info </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00409">409</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01273">lu_env::le_ctx</a>, <a class="el" href="lu__object_8c_source.html#l01574">lu_context_key_get()</a>, <a class="el" href="lu__object_8c_source.html#l01889">lu_env_refill()</a>, and <a class="el" href="osp__dev_8c_source.html#l01846">osp_thread_key</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l01309">osp_declare_object_create()</a>, <a class="el" href="osp__internal_8h_source.html#l00553">osp_fid_end_seq()</a>, <a class="el" href="osp__dev_8c_source.html#l00166">osp_find_or_create_local_file()</a>, <a class="el" href="osp__object_8c_source.html#l00400">osp_get_attr_from_reply()</a>, <a class="el" href="osp__dev_8c_source.html#l00249">osp_init_last_objid()</a>, <a class="el" href="osp__dev_8c_source.html#l00306">osp_init_last_seq()</a>, <a class="el" href="osp__precreate_8c_source.html#l01008">osp_init_pre_fid()</a>, <a class="el" href="osp__dev_8c_source.html#l00362">osp_last_used_init()</a>, <a class="el" href="osp__md__object_8c_source.html#l00480">osp_md_index_lookup()</a>, <a class="el" href="osp__md__object_8c_source.html#l01126">osp_md_read()</a>, <a class="el" href="osp__object_8c_source.html#l00152">osp_object_assign_fid()</a>, <a class="el" href="osp__object_8c_source.html#l01417">osp_object_create()</a>, <a class="el" href="osp__object_8c_source.html#l02127">osp_object_init()</a>, <a class="el" href="osp__precreate_8c_source.html#l00768">osp_precreate_cleanup_orphans()</a>, <a class="el" href="osp__precreate_8c_source.html#l00488">osp_precreate_fids()</a>, <a class="el" href="osp__precreate_8c_source.html#l00428">osp_precreate_rollover_new_seq()</a>, <a class="el" href="osp__precreate_8c_source.html#l00543">osp_precreate_send()</a>, <a class="el" href="osp__sync_8c_source.html#l00357">osp_sync_add_rec()</a>, <a class="el" href="osp__sync_8c_source.html#l00294">osp_sync_declare_add()</a>, <a class="el" href="osp__sync_8c_source.html#l01244">osp_sync_llog_init()</a>, <a class="el" href="osp__precreate_8c_source.html#l00349">osp_write_last_oid_seq_files()</a>, <a class="el" href="osp__object_8c_source.html#l00916">osp_xattr_get()</a>, and <a class="el" href="osp__object_8c_source.html#l00770">osp_xattr_get_interpterer()</a>.</p>

</div>
</div>
<a class="anchor" id="a9b7ab9af6ec76be831a1bcec7ae183c5"></a><!-- doxytag: member="osp_internal.h::osp_extend_update_buffer" ref="a9b7ab9af6ec76be831a1bcec7ae183c5" args="(const struct lu_env *env, struct osp_update_request *our)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_extend_update_buffer </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *&nbsp;</td>
          <td class="paramname"> <em>our</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad07247e09c3b3aa45d705eb51c6f851c"></a><!-- doxytag: member="osp_internal.h::osp_fid_diff" ref="ad07247e09c3b3aa45d705eb51c6f851c" args="(const struct lu_fid *fid1, const struct lu_fid *fid2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osp_fid_diff </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00509">509</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="lustre__user_8h_source.html#l00147">lu_fid::f_oid</a>, <a class="el" href="lustre__user_8h_source.html#l00145">lu_fid::f_seq</a>, <a class="el" href="lustre__idl_8h_source.html#l00514">fid_idif_id()</a>, <a class="el" href="lustre__idl_8h_source.html#l00525">fid_idif_ost_idx()</a>, <a class="el" href="lustre__idl_8h_source.html#l00462">fid_is_idif()</a>, <a class="el" href="lustre__idl_8h_source.html#l00249">fid_oid()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00045">LASSERTF</a>, and <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>.</p>

<p>Referenced by <a class="el" href="osp__precreate_8c_source.html#l00255">osp_objs_precreated()</a>, <a class="el" href="osp__precreate_8c_source.html#l00768">osp_precreate_cleanup_orphans()</a>, <a class="el" href="osp__precreate_8c_source.html#l01405">osp_precreate_get_fid()</a>, <a class="el" href="osp__precreate_8c_source.html#l00543">osp_precreate_send()</a>, and <a class="el" href="osp__internal_8h_source.html#l00534">osp_update_last_fid()</a>.</p>

</div>
</div>
<a class="anchor" id="a5a2f5d28a0fea14cb31c4bbb9fa0a9bb"></a><!-- doxytag: member="osp_internal.h::osp_fid_end_seq" ref="a5a2f5d28a0fea14cb31c4bbb9fa0a9bb" args="(const struct lu_env *env, struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osp_fid_end_seq </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00553">553</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l00462">fid_is_idif()</a>, <a class="el" href="lustre__idl_8h_source.html#l00249">fid_oid()</a>, <a class="el" href="lustre__idl_8h_source.html#l00706">fid_to_ostid()</a>, <a class="el" href="lustre__idl_8h_source.html#l00320">IDIF_MAX_OID</a>, <a class="el" href="lustre__fid_8h_source.html#l00182">LUSTRE_DATA_SEQ_MAX_WIDTH</a>, <a class="el" href="structost__id.html#a01d44bff8859d8cd3aabe8a4b0c2ee46">ost_id::oi</a>, <a class="el" href="osp__internal_8h_source.html#l00314">osp_thread_info::osi_oi</a>, <a class="el" href="osp__internal_8h_source.html#l00409">osp_env_info()</a>, and <a class="el" href="lustre__idl_8h_source.html#l00546">ostid_id()</a>.</p>

<p>Referenced by <a class="el" href="osp__precreate_8c_source.html#l00322">osp_create_end_seq()</a>, and <a class="el" href="osp__internal_8h_source.html#l00566">osp_precreate_end_seq_nolock()</a>.</p>

</div>
</div>
<a class="anchor" id="ad2568c2893e5e95a79d3724536b589be"></a><!-- doxytag: member="osp_internal.h::osp_get_rpc_lock" ref="ad2568c2893e5e95a79d3724536b589be" args="(struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void osp_get_rpc_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00495">495</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="obd_8h_source.html#l00292">client_obd::cl_rpc_lock</a>, <a class="el" href="obd_8h_source.html#l00699">obd_device::cli</a>, <a class="el" href="lustre__mdc_8h_source.html#l00102">mdc_get_rpc_lock()</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, and <a class="el" href="structobd__device.html#aebe227afed9945c803b5bda6794bb729">obd_device::u</a>.</p>

<p>Referenced by <a class="el" href="osp__trans_8c_source.html#l01104">osp_send_update_req()</a>.</p>

</div>
</div>
<a class="anchor" id="af9e29fa5d9911f2cd76c72c4d9d4d693"></a><!-- doxytag: member="osp_internal.h::osp_get_storage_thandle" ref="af9e29fa5d9911f2cd76c72c4d9d4d693" args="(const struct lu_env *env, struct thandle *th, struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structthandle.html">thandle</a>* osp_get_storage_thandle </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get local <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> for <a class="el" href="structosp__thandle.html">osp_thandle</a>. </p>
<p>Get the local OSD <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> from the OSP <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a>. Currently, there are a few OSP API (<a class="el" href="osp__object_8c.html#af498986402b3be3292cfbd9d93d8273b" title="Implement OSP layer dt_object_operations::do_create() interface.">osp_object_create()</a> and <a class="el" href="osp__internal_8h.html#ad84dcbea0dbe8c7aba1d3a5514e236f0">osp_sync_add()</a>) needs to update the object on local OSD device.</p>
<p>If the <a class="el" href="structosp__thandle.html">osp_thandle</a> comes from normal stack (MDD-&gt;LOD-&gt;OSP), then we will get local <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> by thandle_get_sub_by_dt.</p>
<p>If the <a class="el" href="structosp__thandle.html">osp_thandle</a> is remote <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> (th_top == NULL, only used by LFSCK), then it will create a local <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a>, and stop it in <a class="el" href="osp__internal_8h.html#a38da7db0c90fa482dc7eab274b4775ef" title="The OSP layer dt_device_operations::dt_trans_stop() interface to stop the transaction...">osp_trans_stop()</a>. And this only happens on OSP for OST.</p>
<p>These are temporary solution, once OSP accessing OSD object is being fixed properly, this function should be removed. XXX</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>pointer to the transaction handler </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>pointer to the OSP device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pointer</em>&nbsp;</td><td>to the local <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ERR_PTR(errno)</em>&nbsp;</td><td>if it fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l01227">1227</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l02047">dt_trans_create()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="osp__internal_8h_source.html#l00167">osp_device::opd_connect_mdt</a>, <a class="el" href="osp__internal_8h_source.html#l00148">osp_device::opd_storage</a>, <a class="el" href="osp__internal_8h_source.html#l00353">osp_thandle::ot_storage_th</a>, <a class="el" href="dt__object_8h_source.html#l01836">thandle::th_top</a>, <a class="el" href="update__trans_8c_source.html#l01164">thandle_get_sub_by_dt()</a>, and <a class="el" href="osp__internal_8h_source.html#l00362">thandle_to_osp_thandle()</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l01309">osp_declare_object_create()</a>, and <a class="el" href="osp__object_8c_source.html#l01417">osp_object_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a14bf441f342654b878660cf2573f08f9"></a><!-- doxytag: member="osp_internal.h::osp_init_pre_fid" ref="a14bf441f342654b878660cf2573f08f9" args="(struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_init_pre_fid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize FID for precreation. </p>
<p>For a just created new target, a new sequence should be taken. The function checks there is no IDIF in use (if the target was added with the older version of Lustre), then requests a new sequence from FLDB using the regular protocol. Then this new sequence is stored on a persisten storage synchronously to prevent possible object leakage (for the detail see the description for <a class="el" href="osp__precreate_8c.html#ad1b7996234907b754dece35a431f5c58" title="Switch to another sequence.">osp_precreate_rollover_new_seq()</a>).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>osp</em>&nbsp;</td><td>OSP device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>negated errno on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__precreate_8c_source.html#l01008">1008</a> of file <a class="el" href="osp__precreate_8c_source.html">osp_precreate.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="obd_8h_source.html#l00322">client_obd::cl_seq</a>, <a class="el" href="obd_8h_source.html#l00699">obd_device::cli</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__user_8h_source.html#l00147">lu_fid::f_oid</a>, <a class="el" href="lustre__user_8h_source.html#l00145">lu_fid::f_seq</a>, <a class="el" href="lustre__user_8h_source.html#l00153">lu_fid::f_ver</a>, <a class="el" href="lustre__idl_8h_source.html#l00508">fid_idif_seq()</a>, <a class="el" href="lustre__user_8h_source.html#l00156">fid_is_zero()</a>, <a class="el" href="lustre__idl_8h_source.html#l00260">fid_zero()</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00275">lu_device::ld_type</a>, <a class="el" href="lu__object_8h_source.html#l00336">lu_device_type::ldt_ctx_tags</a>, <a class="el" href="lu__object_8c_source.html#l01881">lu_env_fini()</a>, <a class="el" href="lu__object_8c_source.html#l01869">lu_env_init()</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="osp__internal_8h_source.html#l00139">osp_device::opd_dt_dev</a>, <a class="el" href="osp__internal_8h_source.html#l00145">osp_device::opd_group</a>, <a class="el" href="osp__internal_8h_source.html#l00141">osp_device::opd_index</a>, <a class="el" href="osp__internal_8h_source.html#l00155">osp_device::opd_last_used_fid</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="osp__internal_8h_source.html#l00179">osp_device::opd_pre</a>, <a class="el" href="osp__internal_8h_source.html#l00312">osp_thread_info::osi_fid</a>, <a class="el" href="osp__internal_8h_source.html#l00409">osp_env_info()</a>, <a class="el" href="osp__internal_8h_source.html#l00585">osp_is_fid_client()</a>, <a class="el" href="osp__precreate_8c_source.html#l00349">osp_write_last_oid_seq_files()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="fid__request_8c_source.html#l00271">seq_client_get_seq()</a>, and <a class="el" href="structobd__device.html#aebe227afed9945c803b5bda6794bb729">obd_device::u</a>.</p>

<p>Referenced by <a class="el" href="osp__precreate_8c_source.html#l01082">osp_precreate_thread()</a>.</p>

</div>
</div>
<a class="anchor" id="a09b997ecfc36135a541eb336e22230a5"></a><!-- doxytag: member="osp_internal.h::osp_init_precreate" ref="a09b997ecfc36135a541eb336e22230a5" args="(struct osp_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_init_precreate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize precreation functionality of OSP. </p>
<p>Prepares all the internal structures and starts the precreate thread</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td>OSP device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>negated errno on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__precreate_8c_source.html#l01531">1531</a> of file <a class="el" href="osp__precreate_8c_source.html">osp_precreate.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="linux-time_8h_source.html#l00152">cfs_time_current()</a>, <a class="el" href="libcfs__time_8h_source.html#l00067">cfs_time_shift()</a>, <a class="el" href="linux-prim_8c_source.html#l00055">cfs_timer_init()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00141">D_OTHER</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__idl_8h_source.html#l00260">fid_zero()</a>, <a class="el" href="lustre__lib_8h_source.html#l00329">l_wait_event</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="osp__internal_8h_source.html#l00167">osp_device::opd_got_disconnected</a>, <a class="el" href="osp__internal_8h_source.html#l00145">osp_device::opd_group</a>, <a class="el" href="osp__internal_8h_source.html#l00141">osp_device::opd_index</a>, <a class="el" href="osp__internal_8h_source.html#l00179">osp_device::opd_pre</a>, <a class="el" href="osp__internal_8h_source.html#l00181">osp_device::opd_pre_thread</a>, <a class="el" href="osp__internal_8h_source.html#l00183">osp_device::opd_pre_waitq</a>, <a class="el" href="osp__internal_8h_source.html#l00234">osp_device::opd_statfs_fresh_till</a>, <a class="el" href="osp__internal_8h_source.html#l00238">osp_device::opd_statfs_maxage</a>, <a class="el" href="osp__internal_8h_source.html#l00235">osp_device::opd_statfs_timer</a>, <a class="el" href="osp__precreate_8c_source.html#l00086">osp_precreate_running()</a>, <a class="el" href="osp__precreate_8c_source.html#l00091">osp_precreate_stopped()</a>, <a class="el" href="osp__precreate_8c_source.html#l01082">osp_precreate_thread()</a>, <a class="el" href="osp__precreate_8c_source.html#l00096">osp_statfs_timer_cb()</a>, <a class="el" href="lustre__idl_8h_source.html#l01770">OST_MAX_PRECREATE</a>, <a class="el" href="lustre__idl_8h_source.html#l01769">OST_MIN_PRECREATE</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="lustre__net_8h_source.html#l01532">ptlrpc_thread::t_ctl_waitq</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l00996">osp_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="adf78c9e7e9976cb1c68011ccc1dd8b01"></a><!-- doxytag: member="osp_internal.h::osp_insert_async_request" ref="adf78c9e7e9976cb1c68011ccc1dd8b01" args="(const struct lu_env *env, enum update_type op, struct osp_object *obj, int count, __u16 *lens, const void **bufs, void *data, __u32 repsize, osp_update_interpreter_t interpreter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_insert_async_request </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__lustreidl.html#ga2d1a90f202540bfbcbd72a8c0f94b586">update_type</a>&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__object.html">osp_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u16 *&nbsp;</td>
          <td class="paramname"> <em>lens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void **&nbsp;</td>
          <td class="paramname"> <em>bufs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>repsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="osp__internal_8h.html#a3b00e28d2b68085c3ebf8992634dbbca">osp_update_interpreter_t</a>&nbsp;</td>
          <td class="paramname"> <em>interpreter</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Insert an asynchronous idempotent request to the shared request queue that is attached to the <a class="el" href="structosp__device.html">osp_device</a>. </p>
<p>This function generates a new osp_async_request with the given parameters, then tries to insert the request into the osp_device-based shared request queue. If the queue is full, then triggers the packaged OUT RPC to purge the shared queue firstly, and then re-tries.</p>
<p>NOTE: must hold the osp::opd_async_requests_mutex to serialize concurrent osp_insert_async_request call from others.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>op</em>&nbsp;</td><td>operation type, see 'enum update_type' </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>obj</em>&nbsp;</td><td>pointer to the operation target </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>count</em>&nbsp;</td><td>array size of the subsequent <em>lens</em> and <em>bufs</em> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lens</em>&nbsp;</td><td>buffer length array for the subsequent <em>bufs</em> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>bufs</em>&nbsp;</td><td>the buffers to compose the request </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>pointer to the data used by the interpreter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>repsize</em>&nbsp;</td><td>how many bytes the caller allocated for <em>data</em> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>interpreter</em>&nbsp;</td><td>pointer to the interpreter function</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00840">840</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="osp__internal_8h_source.html#l00443">lu2osp_dev()</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="lustre__update_8h_source.html#l00203">object_update_request_size()</a>, <a class="el" href="osp__internal_8h_source.html#l00247">osp_device::opd_async_requests</a>, <a class="el" href="osp__internal_8h_source.html#l00249">osp_device::opd_async_requests_mutex</a>, <a class="el" href="osp__internal_8h_source.html#l00466">osp2lu_obj()</a>, <a class="el" href="osp__trans_8c_source.html#l00166">osp_current_object_update_request()</a>, <a class="el" href="osp__trans_8c_source.html#l00768">osp_find_or_create_async_update_request()</a>, <a class="el" href="osp__trans_8c_source.html#l00799">osp_insert_update_callback()</a>, <a class="el" href="osp__trans_8c_source.html#l00714">osp_unplug_async_request()</a>, <a class="el" href="osp__internal_8h_source.html#l00112">osp_update_request::our_update_nr</a>, <a class="el" href="lustre__idl_8h_source.html#l03842">object_update_request::ourq_count</a>, <a class="el" href="osp__internal_8h_source.html#l00098">osp_update_request_sub::ours_req</a>, <a class="el" href="osp__internal_8h_source.html#l00099">osp_update_request_sub::ours_req_size</a>, <a class="el" href="out__lib_8c_source.html#l00146">out_update_pack()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="osp__md__object_8c_source.html#l00141">update_buffer_get_update()</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00503">osp_declare_attr_get()</a>, and <a class="el" href="osp__object_8c_source.html#l00835">osp_declare_xattr_get()</a>.</p>

</div>
</div>
<a class="anchor" id="abb8316c7e662b7b0845535658efba793"></a><!-- doxytag: member="osp_internal.h::osp_insert_update_callback" ref="abb8316c7e662b7b0845535658efba793" args="(const struct lu_env *env, struct osp_update_request *update, struct osp_object *obj, void *data, osp_update_interpreter_t interpreter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_insert_update_callback </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *&nbsp;</td>
          <td class="paramname"> <em>our</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__object.html">osp_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="osp__internal_8h.html#a3b00e28d2b68085c3ebf8992634dbbca">osp_update_interpreter_t</a>&nbsp;</td>
          <td class="paramname"> <em>interpreter</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Insert an <a class="el" href="structosp__update__callback.html" title="Call back for each update request.">osp_update_callback</a> into the <a class="el" href="structosp__update__request.html">osp_update_request</a>. </p>
<p>Insert an <a class="el" href="structosp__update__callback.html" title="Call back for each update request.">osp_update_callback</a> to the <a class="el" href="structosp__update__request.html">osp_update_request</a>. Usually each update in the <a class="el" href="structosp__update__request.html">osp_update_request</a> will have one correspondent callback, and these callbacks will be called in rq_interpret_reply.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>obj</em>&nbsp;</td><td>pointer to the operation target object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>pointer to the data used by the interpreter </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>interpreter</em>&nbsp;</td><td>pointer to the interpreter function</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00799">799</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="list_8h_source.html#l00090">list_add_tail()</a>, <a class="el" href="osp__trans_8c_source.html#l00558">osp_update_callback_init()</a>, <a class="el" href="osp__trans_8c_source.html#l00088">osp_update_callback::ouc_list</a>, <a class="el" href="osp__internal_8h_source.html#l00114">osp_update_request::our_cb_items</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="osp__trans_8c_source.html#l00840">osp_insert_async_request()</a>, <a class="el" href="osp__md__object_8c_source.html#l00173">osp_md_object_create()</a>, and <a class="el" href="osp__md__object_8c_source.html#l00983">osp_md_object_destroy()</a>.</p>

</div>
</div>
<a class="anchor" id="a4e27b17abaedcfafe6e54d44fb616783"></a><!-- doxytag: member="osp_internal.h::osp_invalidate_request" ref="a4e27b17abaedcfafe6e54d44fb616783" args="(struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void osp_invalidate_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Invalidate update request. </p>
<p>Invalidate update request in the OSP sending list, so all of requests in the sending list will return error, which happens when it finds one update (with writing llog) requests fails or the OSP is evicted by remote target. see <a class="el" href="osp__internal_8h.html#a7b0be3a2ddb7154bfa24d5b502c8763d" title="Sending update thread.">osp_send_update_thread()</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>osp</em>&nbsp;</td><td>OSP device whose update requests will be invalidated. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l01354">1354</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00148">D_HA</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="lu__object_8h_source.html#l00275">lu_device::ld_type</a>, <a class="el" href="lu__object_8h_source.html#l00336">lu_device_type::ldt_ctx_tags</a>, <a class="el" href="lnetctl_8c_source.html#l00969">list</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00484">list_for_each_entry_safe</a>, <a class="el" href="nodemap__lproc_8c.html#a16b50f3e067967583e9d2bc2eeb7ff68">LIST_HEAD()</a>, <a class="el" href="list_8h_source.html#l00137">list_move()</a>, <a class="el" href="lu__object_8c_source.html#l01881">lu_env_fini()</a>, <a class="el" href="lu__object_8c_source.html#l01869">lu_env_init()</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="osp__internal_8h_source.html#l00139">osp_device::opd_dt_dev</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="osp__internal_8h_source.html#l00186">osp_device::opd_update</a>, <a class="el" href="osp__internal_8h_source.html#l00702">osp_thandle_put()</a>, <a class="el" href="osp__trans_8c_source.html#l01067">osp_trans_callback()</a>, <a class="el" href="osp__internal_8h_source.html#l00350">osp_thandle::ot_super</a>, <a class="el" href="osp__internal_8h_source.html#l00130">osp_updates::ou_list</a>, <a class="el" href="osp__internal_8h_source.html#l00131">osp_updates::ou_lock</a>, <a class="el" href="osp__internal_8h_source.html#l00134">osp_updates::ou_rpc_version</a>, <a class="el" href="osp__internal_8h_source.html#l00123">osp_update_request::our_list</a>, <a class="el" href="osp__internal_8h_source.html#l00121">osp_update_request::our_list_lock</a>, <a class="el" href="osp__internal_8h_source.html#l00125">osp_update_request::our_req_ready</a>, <a class="el" href="osp__internal_8h_source.html#l00117">osp_update_request::our_th</a>, <a class="el" href="osp__internal_8h_source.html#l00119">osp_update_request::our_version</a>, and <a class="el" href="dt__object_8h_source.html#l01845">thandle::th_result</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l01574">osp_import_event()</a>, and <a class="el" href="osp__trans_8c_source.html#l01423">osp_send_update_thread()</a>.</p>

</div>
</div>
<a class="anchor" id="a3dd9996a9555909f8605d28ee0ce005f"></a><!-- doxytag: member="osp_internal.h::osp_is_fid_client" ref="a3dd9996a9555909f8605d28ee0ce005f" args="(struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osp_is_fid_client </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00585">585</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="obd_8h_source.html#l00162">client_obd::cl_import</a>, <a class="el" href="obd_8h_source.html#l00699">obd_device::cli</a>, <a class="el" href="lustre__import_8h_source.html#l00316">obd_import::imp_connect_data</a>, <a class="el" href="lustre__idl_8h_source.html#l01213">OBD_CONNECT_FID</a>, <a class="el" href="lustre__idl_8h_source.html#l01336">obd_connect_data::ocd_connect_flags</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, and <a class="el" href="structobd__device.html#aebe227afed9945c803b5bda6794bb729">obd_device::u</a>.</p>

<p>Referenced by <a class="el" href="osp__precreate_8c_source.html#l01008">osp_init_pre_fid()</a>, <a class="el" href="osp__object_8c_source.html#l01417">osp_object_create()</a>, and <a class="el" href="osp__precreate_8c_source.html#l00543">osp_precreate_send()</a>.</p>

</div>
</div>
<a class="anchor" id="ae9d075a9ad9358a90a4e0ee239e944f1"></a><!-- doxytag: member="osp_internal.h::osp_it_fini" ref="ae9d075a9ad9358a90a4e0ee239e944f1" args="(const struct lu_env *env, struct dt_it *di)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void osp_it_fini </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct dt_it *&nbsp;</td>
          <td class="paramname"> <em>di</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Finalize the OSP layer index iteration. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>di</em>&nbsp;</td><td>pointer to the iteration structure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l01661">1661</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

<p>References <a class="el" href="obd__support_8h_source.html#l00776">OBD_FREE</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="osp__internal_8h_source.html#l00343">osp_it::ooi_cur_page</a>, <a class="el" href="osp__internal_8h_source.html#l00345">osp_it::ooi_pages</a>, and <a class="el" href="osp__internal_8h_source.html#l00337">osp_it::ooi_total_npages</a>.</p>

</div>
</div>
<a class="anchor" id="a07d21a6da27503c32900b08c2c084faf"></a><!-- doxytag: member="osp_internal.h::osp_it_get" ref="a07d21a6da27503c32900b08c2c084faf" args="(const struct lu_env *env, struct dt_it *di, const struct dt_key *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_it_get </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct dt_it *&nbsp;</td>
          <td class="paramname"> <em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="dt__object_8c.html#aa088e3c821ba20ee0bd6bad2f8ece91c">dt_key</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l01963">1963</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0da5f987514d58d617d9e20d1b5ffa9e"></a><!-- doxytag: member="osp_internal.h::osp_it_init" ref="a0da5f987514d58d617d9e20d1b5ffa9e" args="(const struct lu_env *env, struct dt_object *dt, __u32 attr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct dt_it* osp_it_init </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>attr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize the OSP layer index iteration. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>pointer to the index object to be iterated </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>attr</em>&nbsp;</td><td>unused</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pointer</em>&nbsp;</td><td>to the iteration structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l01639">1639</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

<p>References <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="osp__internal_8h_source.html#l00335">osp_it::ooi_attr</a>, <a class="el" href="osp__internal_8h_source.html#l00341">osp_it::ooi_obj</a>, and <a class="el" href="osp__internal_8h_source.html#l00336">osp_it::ooi_pos_ent</a>.</p>

</div>
</div>
<a class="anchor" id="ae029b34f183e7b6def52134812822a2f"></a><!-- doxytag: member="osp_internal.h::osp_it_key_rec" ref="ae029b34f183e7b6def52134812822a2f" args="(const struct lu_env *env, const struct dt_it *di, void *key_rec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_it_key_rec </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct dt_it *&nbsp;</td>
          <td class="paramname"> <em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>key_rec</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l02041">2041</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

</div>
</div>
<a class="anchor" id="a15b2be68bdfbe9bccf8d43b4d5174080"></a><!-- doxytag: member="osp_internal.h::osp_it_next_page" ref="a15b2be68bdfbe9bccf8d43b4d5174080" args="(const struct lu_env *env, struct dt_it *di)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_it_next_page </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct dt_it *&nbsp;</td>
          <td class="paramname"> <em>di</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Move the iteration cursor to the next <a class="el" href="unionlu__page.html">lu_page</a>. </p>
<p>One system page (PAGE_SIZE) may contain multiple <a class="el" href="unionlu__page.html">lu_page</a> (4KB), that depends on the LU_PAGE_COUNT. If it is not the last <a class="el" href="unionlu__page.html">lu_page</a> in current system page, then move the iteration cursor to the next <a class="el" href="unionlu__page.html">lu_page</a> in current system page. Otherwise, if there are more system pages in the cache, then move the iteration cursor to the next system page. If all the cached records (pages) have been iterated, then fetch more records via <a class="el" href="osp__object_8c.html#a61ec8b07ce1945a2658af5dfcd818f9f" title="Get more records for the iteration from peer.">osp_it_fetch()</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>di</em>&nbsp;</td><td>pointer to the iteration structure</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>positive</em>&nbsp;</td><td>for end of the directory </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l01833">1833</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__idl_8h_source.html#l03549">II_END_OFF</a>, <a class="el" href="lustre__idl_8h_source.html#l03560">LIP_MAGIC</a>, <a class="el" href="lustre__idl_8h_source.html#l03565">lu_idxpage::lip_magic</a>, <a class="el" href="lustre__idl_8h_source.html#l03567">lu_idxpage::lip_nr</a>, <a class="el" href="lu__object_8h_source.html#l00472">lu_object::lo_dev</a>, <a class="el" href="osp__internal_8h_source.html#l00443">lu2osp_dev()</a>, <a class="el" href="lustre__idl_8h_source.html#l01012">LU_PAGE_COUNT</a>, <a class="el" href="lustre__idl_8h_source.html#l01009">LU_PAGE_SIZE</a>, <a class="el" href="pack__generic_8c_source.html#l02016">lustre_swab_lip_header()</a>, <a class="el" href="obd__support_8h_source.html#l00776">OBD_FREE</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="osp__internal_8h_source.html#l00344">osp_it::ooi_cur_idxpage</a>, <a class="el" href="osp__internal_8h_source.html#l00343">osp_it::ooi_cur_page</a>, <a class="el" href="osp__internal_8h_source.html#l00342">osp_it::ooi_ent</a>, <a class="el" href="osp__internal_8h_source.html#l00340">osp_it::ooi_next</a>, <a class="el" href="osp__internal_8h_source.html#l00341">osp_it::ooi_obj</a>, <a class="el" href="osp__internal_8h_source.html#l00345">osp_it::ooi_pages</a>, <a class="el" href="osp__internal_8h_source.html#l00336">osp_it::ooi_pos_ent</a>, <a class="el" href="osp__internal_8h_source.html#l00334">osp_it::ooi_pos_lu_page</a>, <a class="el" href="osp__internal_8h_source.html#l00333">osp_it::ooi_pos_page</a>, <a class="el" href="osp__internal_8h_source.html#l00339">osp_it::ooi_swab</a>, <a class="el" href="osp__internal_8h_source.html#l00337">osp_it::ooi_total_npages</a>, <a class="el" href="osp__internal_8h_source.html#l00338">osp_it::ooi_valid_npages</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="osp__object_8c_source.html#l01695">osp_it_fetch()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="osp__md__object_8c_source.html#l00683">osp_md_index_it_next()</a>, and <a class="el" href="osp__object_8c_source.html#l01932">osp_orphan_it_next()</a>.</p>

</div>
</div>
<a class="anchor" id="a8106562211602449cbbfe777335da553"></a><!-- doxytag: member="osp_internal.h::osp_it_put" ref="a8106562211602449cbbfe777335da553" args="(const struct lu_env *env, struct dt_it *di)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void osp_it_put </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct dt_it *&nbsp;</td>
          <td class="paramname"> <em>di</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l01969">1969</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

</div>
</div>
<a class="anchor" id="a80a49dbf124329dd0433ee6924d97462"></a><!-- doxytag: member="osp_internal.h::osp_it_store" ref="a80a49dbf124329dd0433ee6924d97462" args="(const struct lu_env *env, const struct dt_it *di)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> osp_it_store </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct dt_it *&nbsp;</td>
          <td class="paramname"> <em>di</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l02005">2005</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

<p>References <a class="el" href="osp__internal_8h_source.html#l00340">osp_it::ooi_next</a>.</p>

</div>
</div>
<a class="anchor" id="a3b8512ad4175b3e0e2b52a1ff8f6d1ec"></a><!-- doxytag: member="osp_internal.h::osp_lprocfs_init" ref="a3b8512ad4175b3e0e2b52a1ff8f6d1ec" args="(struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void osp_lprocfs_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l00996">osp_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="ac407cef7eae29c85a3dee04fe4cc20ab"></a><!-- doxytag: member="osp_internal.h::osp_md_attr_set" ref="ac407cef7eae29c85a3dee04fe4cc20ab" args="(const struct lu_env *env, struct dt_object *dt, const struct lu_attr *attr, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_md_attr_set </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structdt__object__operations.html#aa9a55847088d77aa8bbc16c693344ddb" title="Change regular attributes.">dt_object_operations::do_attr_set</a>. </p>
<p>Set attributes to the specified remote object.</p>
<p>Add the OUT_ATTR_SET sub-request into the OUT RPC that will be flushed when the transaction stop.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>object to set attributes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>attr</em>&nbsp;</td><td>attributes to be set </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>the transaction handle</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing attr_set succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__md__object_8c_source.html#l00359">359</a> of file <a class="el" href="osp__md__object_8c_source.html">osp_md_object.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="osp__internal_8h_source.html#l00605">osp_update_rpc_pack</a>, <a class="el" href="lustre__idl_8h_source.html#l03789">OUT_ATTR_SET</a>, and <a class="el" href="osp__internal_8h_source.html#l00368">thandle_to_osp_update_request()</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00709">osp_attr_set()</a>.</p>

</div>
</div>
<a class="anchor" id="aa0885e2736c65c081a737b04e83ddf94"></a><!-- doxytag: member="osp_internal.h::osp_md_declare_attr_set" ref="aa0885e2736c65c081a737b04e83ddf94" args="(const struct lu_env *env, struct dt_object *dt, const struct lu_attr *attr, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_md_declare_attr_set </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structdt__object__operations.html#adc1fb34feaf57d9448beaab7f04302bd" title="Declare intention to request reqular attributes.">dt_object_operations::do_declare_attr_get</a>. </p>
<p>Create the <a class="el" href="structosp__update__request.html">osp_update_request</a> to track the update for this OSP in the transaction.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>object on which to set attributes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>attr</em>&nbsp;</td><td>attributes to be set </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>the transaction handle</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if preparation succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if preparation fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__md__object_8c_source.html#l00337">337</a> of file <a class="el" href="osp__md__object_8c_source.html">osp_md_object.c</a>.</p>

<p>References <a class="el" href="osp__trans_8c_source.html#l00899">osp_trans_update_request_create()</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00638">osp_declare_attr_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a1795337c33a409d5f78b87ff38a112ec"></a><!-- doxytag: member="osp_internal.h::osp_md_declare_object_create" ref="a1795337c33a409d5f78b87ff38a112ec" args="(const struct lu_env *env, struct dt_object *dt, struct lu_attr *attr, struct dt_allocation_hint *hint, struct dt_object_format *dof, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_md_declare_object_create </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__allocation__hint.html">dt_allocation_hint</a> *&nbsp;</td>
          <td class="paramname"> <em>hint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object__format.html">dt_object_format</a> *&nbsp;</td>
          <td class="paramname"> <em>dof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structdt__object__operations.html#ab16b75516dfd3d619fbffbc96f2b9d24" title="Declare intention to create a new object.">dt_object_operations::do_declare_create</a>. </p>
<p>Create the <a class="el" href="structosp__update__request.html">osp_update_request</a> to track the update for this OSP in the transaction.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>remote object to be created </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>attr</em>&nbsp;</td><td>attribute of the created object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hint</em>&nbsp;</td><td>creation hint </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dof</em>&nbsp;</td><td>creation format information </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>the transaction handle</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if preparation succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if preparation fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__md__object_8c_source.html#l00121">121</a> of file <a class="el" href="osp__md__object_8c_source.html">osp_md_object.c</a>.</p>

<p>References <a class="el" href="osp__internal_8h_source.html#l00477">dt2osp_obj()</a>, <a class="el" href="osp__internal_8h_source.html#l00299">osp_object::opo_ooa</a>, <a class="el" href="osp__object_8c_source.html#l00174">osp_oac_init()</a>, and <a class="el" href="osp__trans_8c_source.html#l00899">osp_trans_update_request_create()</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l01309">osp_declare_object_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a64726676693349c027bdbe148fba7d97"></a><!-- doxytag: member="osp_internal.h::osp_md_object_create" ref="a64726676693349c027bdbe148fba7d97" args="(const struct lu_env *env, struct dt_object *dt, struct lu_attr *attr, struct dt_allocation_hint *hint, struct dt_object_format *dof, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_md_object_create </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__allocation__hint.html">dt_allocation_hint</a> *&nbsp;</td>
          <td class="paramname"> <em>hint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object__format.html">dt_object_format</a> *&nbsp;</td>
          <td class="paramname"> <em>dof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structdt__object__operations.html#ac1ca5a81cd3d00bd821fbfead64022c3" title="Create new object.">dt_object_operations::do_create</a>. </p>
<p>It adds an OUT_CREATE sub-request into the OUT RPC that will be flushed when the transaction stop, and sets necessary flags for created object.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>object to be created </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>attr</em>&nbsp;</td><td>attribute of the created object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hint</em>&nbsp;</td><td>creation hint </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dof</em>&nbsp;</td><td>creation format information </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>the transaction handle</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if packing creation succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if packing creation fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__md__object_8c_source.html#l00173">173</a> of file <a class="el" href="osp__md__object_8c_source.html">osp_md_object.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="osp__internal_8h_source.html#l00477">dt2osp_obj()</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00419">lu_attr::la_mode</a>, <a class="el" href="lu__object_8h_source.html#l00452">LA_TYPE</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00468">lu_object::lo_header</a>, <a class="el" href="lu__object_8h_source.html#l00539">lu_object_header::loh_attr</a>, <a class="el" href="lu__object_8h_source.html#l00501">LOHA_EXISTS</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="osp__internal_8h_source.html#l00284">osp_object_attr::ooa_attr</a>, <a class="el" href="osp__internal_8h_source.html#l00292">osp_object::opo_non_exist</a>, <a class="el" href="osp__internal_8h_source.html#l00299">osp_object::opo_ooa</a>, <a class="el" href="osp__trans_8c_source.html#l00799">osp_insert_update_callback()</a>, <a class="el" href="osp__md__object_8c_source.html#l00080">osp_object_create_interpreter()</a>, <a class="el" href="osp__internal_8h_source.html#l00605">osp_update_rpc_pack</a>, <a class="el" href="lustre__idl_8h_source.html#l03785">OUT_CREATE</a>, and <a class="el" href="osp__internal_8h_source.html#l00368">thandle_to_osp_update_request()</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l01417">osp_object_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a6495832e4efeddcaa1368ffe41af4c85"></a><!-- doxytag: member="osp_internal.h::osp_oac_init" ref="a6495832e4efeddcaa1368ffe41af4c85" args="(struct osp_object *obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_oac_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__object.html">osp_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize the OSP object attributes cache. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>obj</em>&nbsp;</td><td>pointer to the OSP object</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l00174">174</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

<p>References <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="libcfs__private_8h_source.html#l00309">likely</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="osp__internal_8h_source.html#l00285">osp_object_attr::ooa_xattr_list</a>, <a class="el" href="osp__internal_8h_source.html#l00301">osp_object::opo_lock</a>, and <a class="el" href="osp__internal_8h_source.html#l00299">osp_object::opo_ooa</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00503">osp_declare_attr_get()</a>, <a class="el" href="osp__object_8c_source.html#l00835">osp_declare_xattr_get()</a>, and <a class="el" href="osp__md__object_8c_source.html#l00121">osp_md_declare_object_create()</a>.</p>

</div>
</div>
<a class="anchor" id="abee213e6b5aa210316a98ab6a05dc92a"></a><!-- doxytag: member="osp_internal.h::osp_obj" ref="abee213e6b5aa210316a98ab6a05dc92a" args="(const struct lu_object *o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structosp__object.html">osp_object</a>* osp_obj </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__object.html">lu_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00471">471</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00472">lu_object::lo_dev</a>, <a class="el" href="osp__internal_8h_source.html#l00438">lu_device_is_osp()</a>, and <a class="el" href="osp__internal_8h_source.html#l00291">osp_object::opo_obj</a>.</p>

<p>Referenced by <a class="el" href="osp__internal_8h_source.html#l00477">dt2osp_obj()</a>, and <a class="el" href="osp__trans_8c_source.html#l00481">osp_thandle_invalidate_object()</a>.</p>

</div>
</div>
<a class="anchor" id="a1d0e37540b37bd0df90bcf224566ddaa"></a><!-- doxytag: member="osp_internal.h::osp_object_child" ref="a1d0e37540b37bd0df90bcf224566ddaa" args="(struct osp_object *o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structdt__object.html">dt_object</a>* osp_object_child </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__object.html">osp_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00482">482</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="lu__object_8h_source.html#l00762">lu_object_next()</a>, and <a class="el" href="osp__internal_8h_source.html#l00466">osp2lu_obj()</a>.</p>

</div>
</div>
<a class="anchor" id="a57b3438c59b9431b0f75eba5ef4cec44"></a><!-- doxytag: member="osp_internal.h::osp_object_truncate" ref="a57b3438c59b9431b0f75eba5ef4cec44" args="(const struct lu_env *env, struct dt_object *dt, __u64)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_object_truncate </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__precreate_8c_source.html#l01454">1454</a> of file <a class="el" href="osp__precreate_8c_source.html">osp_precreate.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="obd_8h_source.html#l00162">client_obd::cl_import</a>, <a class="el" href="obd_8h_source.html#l00699">obd_device::cli</a>, <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__idl_8h_source.html#l00706">fid_to_ostid()</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lustre__import_8h_source.html#l00316">obd_import::imp_connect_data</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00472">lu_object::lo_dev</a>, <a class="el" href="osp__internal_8h_source.html#l00443">lu2osp_dev()</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="packet-lustre_8c_source.html#l00078">LUSTRE_OST_VERSION</a>, <a class="el" href="lustre__obdo_8h_source.html#l00048">lustre_set_wire_obdo()</a>, <a class="el" href="lustre__idl_8h_source.html#l03390">obdo::o_blocks</a>, <a class="el" href="lustre__idl_8h_source.html#l03384">obdo::o_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l03386">obdo::o_size</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l03486">ost_body::oa</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="lustre__idl_8h_source.html#l01661">OBD_MD_FLBLOCKS</a>, <a class="el" href="lustre__idl_8h_source.html#l01679">OBD_MD_FLGROUP</a>, <a class="el" href="lustre__idl_8h_source.html#l01656">OBD_MD_FLID</a>, <a class="el" href="lustre__idl_8h_source.html#l01660">OBD_MD_FLSIZE</a>, <a class="el" href="lustre__idl_8h_source.html#l01767">OBD_OBJECT_EOF</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="lustre__idl_8h_source.html#l00096">OST_IO_PORTAL</a>, <a class="el" href="packet-lustre_8c_source.html#l00173">OST_PUNCH</a>, <a class="el" href="client_8c_source.html#l00293">ptlrpc_at_set_req_timeout()</a>, <a class="el" href="client_8c_source.html#l02829">ptlrpc_queue_wait()</a>, <a class="el" href="client_8c_source.html#l02490">ptlrpc_req_finished()</a>, <a class="el" href="client_8c_source.html#l00852">ptlrpc_request_alloc()</a>, <a class="el" href="client_8c_source.html#l00875">ptlrpc_request_free()</a>, <a class="el" href="client_8c_source.html#l00762">ptlrpc_request_pack()</a>, <a class="el" href="pack__generic_8c_source.html#l01551">ptlrpc_request_set_replen()</a>, <a class="el" href="layout_8c_source.html#l02117">req_capsule_client_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01105">RMF_OST_BODY</a>, <a class="el" href="lustre__net_8h_source.html#l01104">ptlrpc_request::rq_import</a>, <a class="el" href="lustre__net_8h_source.html#l00968">ptlrpc_request::rq_no_delay</a>, <a class="el" href="lustre__net_8h_source.html#l00968">ptlrpc_request::rq_no_resend</a>, <a class="el" href="lustre__net_8h_source.html#l01121">ptlrpc_request::rq_pill</a>, <a class="el" href="layout_8c_source.html#l01626">RQF_OST_PUNCH</a>, and <a class="el" href="structobd__device.html#aebe227afed9945c803b5bda6794bb729">obd_device::u</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00638">osp_declare_attr_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a944ee7971f4e4493976d4da4baafdfda"></a><!-- doxytag: member="osp_internal.h::osp_object_update_request_create" ref="a944ee7971f4e4493976d4da4baafdfda" args="(struct osp_update_request *our, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_object_update_request_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *&nbsp;</td>
          <td class="paramname"> <em>our</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocate new update request. </p>
<p>Allocate new update request and insert it to the req_update_list.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>our</em>&nbsp;</td><td>osp_udate_request where to create a new update request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if creation succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if creation fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00125">125</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="list_8h_source.html#l00090">list_add_tail()</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="osp__trans_8c_source.html#l00100">object_update_request_alloc()</a>, <a class="el" href="osp__internal_8h_source.html#l00110">osp_update_request::our_req_list</a>, <a class="el" href="osp__internal_8h_source.html#l00111">osp_update_request::our_req_nr</a>, <a class="el" href="osp__internal_8h_source.html#l00101">osp_update_request_sub::ours_list</a>, <a class="el" href="osp__internal_8h_source.html#l00098">osp_update_request_sub::ours_req</a>, <a class="el" href="osp__internal_8h_source.html#l00099">osp_update_request_sub::ours_req_size</a>, and <a class="el" href="lustre__update_8h_source.html#l00036">OUT_UPDATE_INIT_BUFFER_SIZE</a>.</p>

<p>Referenced by <a class="el" href="osp__trans_8c_source.html#l00187">osp_update_request_create()</a>.</p>

</div>
</div>
<a class="anchor" id="ad48113c3ad8afdf92468cb4c6b11b30c"></a><!-- doxytag: member="osp_internal.h::osp_objid_buf_prep" ref="ad48113c3ad8afdf92468cb4c6b11b30c" args="(struct lu_buf *buf, loff_t *off, __u32 *id, int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void osp_objid_buf_prep </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">loff_t *&nbsp;</td>
          <td class="paramname"> <em>off</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32 *&nbsp;</td>
          <td class="paramname"> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00383">383</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, and <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l00249">osp_init_last_objid()</a>, and <a class="el" href="osp__object_8c_source.html#l01417">osp_object_create()</a>.</p>

</div>
</div>
<a class="anchor" id="acb21bb25d60c64551c51f36e6ab056a1"></a><!-- doxytag: member="osp_internal.h::osp_objseq_buf_prep" ref="acb21bb25d60c64551c51f36e6ab056a1" args="(struct lu_buf *buf, loff_t *off, __u64 *seq, int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void osp_objseq_buf_prep </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">loff_t *&nbsp;</td>
          <td class="paramname"> <em>off</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> *&nbsp;</td>
          <td class="paramname"> <em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00393">393</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, and <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l00306">osp_init_last_seq()</a>, and <a class="el" href="osp__dev_8c_source.html#l00362">osp_last_used_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ad08581208c0888d2bfb28babb414be1c"></a><!-- doxytag: member="osp_internal.h::osp_pre_update_status" ref="ad08581208c0888d2bfb28babb414be1c" args="(struct osp_device *d, int rc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void osp_pre_update_status </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update precreate status using statfs data. </p>
<p>The function decides whether this OSP should be used for new objects. IOW, whether this OST is used up or has some free space. Cached statfs data is used to make this decision. If the latest result of statfs request (rc argument) is not success, then just mark OSP unavailable right away.</p>
<p>Add a bit of hysteresis so this flag isn't continually flapping, and ensure that new files don't get extremely fragmented due to only a small amount of available space in the filesystem. We want to set the NOSPC flag when there is less than ~0.1% free and clear it when there is at least ~0.2% free space, so: avail &lt; ~0.1% max max = avail + used 1025 * avail &lt; avail + used used = blocks - free 1024 * avail &lt; used 1024 * avail &lt; blocks - free avail &lt; ((blocks - free) &gt;&gt; 10)</p>
<p>On very large disk, say 16TB 0.1% will be 16 GB. We don't want to lose that amount of space so in those cases we report no space left if their is less than 1 GB left. the function updates current precreation status used: functional or not</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td>OSP device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rc</em>&nbsp;</td><td>new precreate status for device <em>d</em> </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>negated errno on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__precreate_8c_source.html#l00948">948</a> of file <a class="el" href="osp__precreate_8c_source.html">osp_precreate.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="libcfs__private_8h_source.html#l00309">likely</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="osc__internal_8h_source.html#l00177">min_t</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="osp__internal_8h_source.html#l00183">osp_device::opd_pre_waitq</a>, <a class="el" href="osp__internal_8h_source.html#l00233">osp_device::opd_statfs</a>, <a class="el" href="osp__internal_8h_source.html#l00197">osp_device::opd_syn_changes</a>, <a class="el" href="osp__internal_8h_source.html#l00213">osp_device::opd_syn_rpc_in_progress</a>, <a class="el" href="lustre__user_8h_source.html#l00111">obd_statfs::os_bavail</a>, <a class="el" href="lustre__user_8h_source.html#l00110">obd_statfs::os_bfree</a>, <a class="el" href="lustre__user_8h_source.html#l00109">obd_statfs::os_blocks</a>, <a class="el" href="lustre__user_8h_source.html#l00113">obd_statfs::os_ffree</a>, <a class="el" href="lustre__user_8h_source.html#l00108">obd_statfs::os_type</a>, and <a class="el" href="lustre__idl_8h_source.html#l01769">OST_MIN_PRECREATE</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l01574">osp_import_event()</a>, <a class="el" href="osp__precreate_8c_source.html#l00768">osp_precreate_cleanup_orphans()</a>, <a class="el" href="osp__precreate_8c_source.html#l00543">osp_precreate_send()</a>, and <a class="el" href="osp__precreate_8c_source.html#l00121">osp_statfs_interpret()</a>.</p>

</div>
</div>
<a class="anchor" id="ab8c3424a6810a58d39b1eeb73e91ee95"></a><!-- doxytag: member="osp_internal.h::osp_precreate_end_seq" ref="ab8c3424a6810a58d39b1eeb73e91ee95" args="(const struct lu_env *env, struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osp_precreate_end_seq </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00574">574</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="osp__internal_8h_source.html#l00566">osp_precreate_end_seq_nolock()</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l01417">osp_object_create()</a>, and <a class="el" href="osp__precreate_8c_source.html#l01082">osp_precreate_thread()</a>.</p>

</div>
</div>
<a class="anchor" id="a9bf651d4126997993cda6d2efac6146b"></a><!-- doxytag: member="osp_internal.h::osp_precreate_end_seq_nolock" ref="a9bf651d4126997993cda6d2efac6146b" args="(const struct lu_env *env, struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int osp_precreate_end_seq_nolock </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00566">566</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="osp__internal_8h_source.html#l00553">osp_fid_end_seq()</a>.</p>

<p>Referenced by <a class="el" href="osp__internal_8h_source.html#l00574">osp_precreate_end_seq()</a>, and <a class="el" href="osp__precreate_8c_source.html#l01292">osp_precreate_reserve()</a>.</p>

</div>
</div>
<a class="anchor" id="a6b0bb6ab17743e9127d9a917ba9eac08"></a><!-- doxytag: member="osp_internal.h::osp_precreate_fini" ref="a6b0bb6ab17743e9127d9a917ba9eac08" args="(struct osp_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void osp_precreate_fini </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Finish precreate functionality of OSP. </p>
<p>Asks all the activity (the thread, update timer) to stop, then wait till that is done.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td>OSP device </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__precreate_8c_source.html#l01596">1596</a> of file <a class="el" href="osp__precreate_8c_source.html">osp_precreate.c</a>.</p>

<p>References <a class="el" href="linux-prim_8c_source.html#l00069">cfs_timer_disarm()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="osp__internal_8h_source.html#l00179">osp_device::opd_pre</a>, <a class="el" href="osp__internal_8h_source.html#l00181">osp_device::opd_pre_thread</a>, <a class="el" href="osp__internal_8h_source.html#l00183">osp_device::opd_pre_waitq</a>, <a class="el" href="osp__internal_8h_source.html#l00235">osp_device::opd_statfs_timer</a>, <a class="el" href="libcfs__debug_8h_source.html#l00358">RETURN_EXIT</a>, <a class="el" href="lustre__net_8h_source.html#l01494">SVC_STOPPED</a>, <a class="el" href="lustre__net_8h_source.html#l01495">SVC_STOPPING</a>, <a class="el" href="lustre__net_8h_source.html#l01532">ptlrpc_thread::t_ctl_waitq</a>, <a class="el" href="lustre__net_8h_source.html#l01515">ptlrpc_thread::t_flags</a>, and <a class="el" href="obd_8c_source.html#l00114">thread</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l00996">osp_init0()</a>, and <a class="el" href="osp__dev_8c_source.html#l00587">osp_shutdown()</a>.</p>

</div>
</div>
<a class="anchor" id="afcddb5166989024d615815d6394ee83b"></a><!-- doxytag: member="osp_internal.h::osp_precreate_get_fid" ref="afcddb5166989024d615815d6394ee83b" args="(const struct lu_env *env, struct osp_device *d, struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_precreate_get_fid </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a FID from precreation pool. </p>
<p>The function is a companion for <a class="el" href="osp__internal_8h.html#a39a28e9de51d9e97ee937560ddbf0283" title="Reserve object in precreate pool.">osp_precreate_reserve()</a> - it assigns a specific FID from the precreate. The function should be called only if the call to <a class="el" href="osp__internal_8h.html#a39a28e9de51d9e97ee937560ddbf0283" title="Reserve object in precreate pool.">osp_precreate_reserve()</a> was successful. The function updates a local storage to remember the highest object ID referenced by the node in the given sequence.</p>
<p>A very importan details: this is supposed to be called once the transaction is started, so on-disk update will be atomic with the data (like LOVEA) refering this object. Then the object won't be leaked: either it's referenced by the committed transaction or it's a subject to the orphan cleanup procedure.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>LU environment provided by the caller </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td>OSP device </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>generated FID</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>negated errno on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__precreate_8c_source.html#l01405">1405</a> of file <a class="el" href="osp__precreate_8c_source.html">osp_precreate.c</a>.</p>

<p>References <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00045">LASSERTF</a>, <a class="el" href="osp__internal_8h_source.html#l00183">osp_device::opd_pre_waitq</a>, <a class="el" href="osp__internal_8h_source.html#l00509">osp_fid_diff()</a>, <a class="el" href="osp__internal_8h_source.html#l00534">osp_update_last_fid()</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00152">osp_object_assign_fid()</a>.</p>

</div>
</div>
<a class="anchor" id="a24bf10268d2448e2d6a4c06f107ea0ef"></a><!-- doxytag: member="osp_internal.h::osp_precreate_get_id" ref="a24bf10268d2448e2d6a4c06f107ea0ef" args="(struct osp_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> osp_precreate_get_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a39a28e9de51d9e97ee937560ddbf0283"></a><!-- doxytag: member="osp_internal.h::osp_precreate_reserve" ref="a39a28e9de51d9e97ee937560ddbf0283" args="(const struct lu_env *env, struct osp_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_precreate_reserve </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reserve object in precreate pool. </p>
<p>When the caller wants to create a new object on this target (target represented by the given OSP), it should declare this intention using a regular -&gt;<a class="el" href="dt__object_8h.html#a42848e00d321307e71d0243b2bbd3a1c">dt_declare_create()</a> OSD API method. Then OSP will be trying to reserve an object in the existing precreated pool or wait up to obd_timeout for the available object to appear in the pool (a dedicated thread will be doing real precreation in background). The object can be consumed later with <a class="el" href="osp__internal_8h.html#afcddb5166989024d615815d6394ee83b" title="Get a FID from precreation pool.">osp_precreate_get_fid()</a> or be released with call to <a class="el" href="group__lu.html#ga0d53e3777af7b81492a1178c75b872ea" title="Decrease reference counter on object.">lu_object_put()</a>. Notice the function doesn't reserve a specific ID, just some ID. The actual ID assignment happen in <a class="el" href="osp__internal_8h.html#afcddb5166989024d615815d6394ee83b" title="Get a FID from precreation pool.">osp_precreate_get_fid()</a>. If the space on the target is short and there is a pending object destroy, then the function forces local commit to speedup space release (see <a class="el" href="osp__sync_8c.html">osp_sync.c</a> for the details).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>LU environment provided by the caller </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td>OSP device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-ENOSPC</em>&nbsp;</td><td>when no space on OST </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-EAGAIN</em>&nbsp;</td><td>try later, slow precreation in progress </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-EIO</em>&nbsp;</td><td>when no access to OST </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__precreate_8c_source.html#l01292">1292</a> of file <a class="el" href="osp__precreate_8c_source.html">osp_precreate.c</a>.</p>

<p>References <a class="el" href="libcfs__time_8h_source.html#l00061">cfs_time_aftereq()</a>, <a class="el" href="linux-time_8h_source.html#l00152">cfs_time_current()</a>, <a class="el" href="libcfs__time_8h_source.html#l00067">cfs_time_shift()</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="dt__object_8h_source.html#l02645">dt_commit_async()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__lib_8h_source.html#l00329">l_wait_event</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00045">LASSERTF</a>, <a class="el" href="lustre__lib_8h_source.html#l00171">LWI_TIMEOUT</a>, <a class="el" href="class__obd_8c_source.html#l00083">obd_timeout</a>, <a class="el" href="osp__internal_8h_source.html#l00183">osp_device::opd_pre_waitq</a>, <a class="el" href="osp__internal_8h_source.html#l00148">osp_device::opd_storage</a>, <a class="el" href="osp__internal_8h_source.html#l00197">osp_device::opd_syn_changes</a>, <a class="el" href="osp__internal_8h_source.html#l00213">osp_device::opd_syn_rpc_in_progress</a>, <a class="el" href="osp__precreate_8c_source.html#l00255">osp_objs_precreated()</a>, <a class="el" href="osp__internal_8h_source.html#l00566">osp_precreate_end_seq_nolock()</a>, <a class="el" href="osp__precreate_8c_source.html#l00276">osp_precreate_near_empty_nolock()</a>, <a class="el" href="osp__precreate_8c_source.html#l01222">osp_precreate_ready_condition()</a>, <a class="el" href="osp__precreate_8c_source.html#l01253">osp_precreate_timeout_condition()</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l01309">osp_declare_object_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a286fa51dc4b7827a253690dca8145b21"></a><!-- doxytag: member="osp_internal.h::osp_prep_update_req" ref="a286fa51dc4b7827a253690dca8145b21" args="(const struct lu_env *env, struct obd_import *imp, struct osp_update_request *our, struct ptlrpc_request **reqp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_prep_update_req </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__import.html">obd_import</a> *&nbsp;</td>
          <td class="paramname"> <em>imp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *&nbsp;</td>
          <td class="paramname"> <em>our</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> **&nbsp;</td>
          <td class="paramname"> <em>reqp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prepare update request. </p>
<p>Prepare OUT update ptlrpc request, and the request usually includes all of updates (stored in </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ureq)</em>&nbsp;</td><td>from one operation.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>imp</em>&nbsp;</td><td>import on which ptlrpc request will be sent </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ureq</em>&nbsp;</td><td>hold all of updates which will be packed into the req </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>reqp</em>&nbsp;</td><td>request to be created</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if preparation succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if preparation fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00314">314</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="structptlrpc__bulk__frag__ops.html#a071eacf4504ae84799e0f989a0e43229">ptlrpc_bulk_frag_ops::add_iov_frag</a>, <a class="el" href="lustre__net_8h_source.html#l01451">ptlrpc_bulk_desc::bd_frag_ops</a>, <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="libcfs__debug_8h_source.html#l00141">D_OTHER</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="list_8h_source.html#l00242">list_entry</a>, <a class="el" href="list_8h_source.html#l00459">list_for_each_entry</a>, <a class="el" href="lnet_2include_2lnet_2types_8h_source.html#l00446">LNET_MTU_BITS</a>, <a class="el" href="packet-lustre_8c_source.html#l00077">LUSTRE_MDS_VERSION</a>, <a class="el" href="lustre__net_8h_source.html#l00108">MD_MAX_BRW_SIZE</a>, <a class="el" href="lustre__idl_8h_source.html#l00104">MDS_BULK_PORTAL</a>, <a class="el" href="list_8h_source.html#l00043">list_head::next</a>, <a class="el" href="osp__trans_8c_source.html#l00222">object_update_request_dump()</a>, <a class="el" href="lustre__idl_8h_source.html#l03889">object_update_request_get()</a>, <a class="el" href="lustre__update_8h_source.html#l00203">object_update_request_size()</a>, <a class="el" href="lustre__idl_8h_source.html#l00094">OSC_REPLY_PORTAL</a>, <a class="el" href="osp__trans_8c_source.html#l00262">osp_prep_inline_update_req()</a>, <a class="el" href="lustre__idl_8h_source.html#l03828">object_update::ou_result_size</a>, <a class="el" href="lustre__idl_8h_source.html#l03859">out_update_buffer::oub_size</a>, <a class="el" href="lustre__idl_8h_source.html#l03852">out_update_header::ouh_count</a>, <a class="el" href="lustre__idl_8h_source.html#l03853">out_update_header::ouh_inline_length</a>, <a class="el" href="lustre__idl_8h_source.html#l03851">out_update_header::ouh_magic</a>, <a class="el" href="lustre__idl_8h_source.html#l03854">out_update_header::ouh_reply_size</a>, <a class="el" href="osp__internal_8h_source.html#l00110">osp_update_request::our_req_list</a>, <a class="el" href="osp__internal_8h_source.html#l00112">osp_update_request::our_update_nr</a>, <a class="el" href="lustre__idl_8h_source.html#l03925">object_update_reply::ourp_lens</a>, <a class="el" href="lustre__idl_8h_source.html#l03842">object_update_request::ourq_count</a>, <a class="el" href="osp__internal_8h_source.html#l00098">osp_update_request_sub::ours_req</a>, <a class="el" href="osp__internal_8h_source.html#l00099">osp_update_request_sub::ours_req_size</a>, <a class="el" href="lustre__idl_8h_source.html#l00114">OUT_PORTAL</a>, <a class="el" href="lustre__idl_8h_source.html#l02037">OUT_UPDATE</a>, <a class="el" href="lustre__idl_8h_source.html#l03847">OUT_UPDATE_HEADER_MAGIC</a>, <a class="el" href="lustre__idl_8h_source.html#l03848">OUT_UPDATE_MAX_INLINE_SIZE</a>, <a class="el" href="lustre__update_8h_source.html#l00037">OUT_UPDATE_REPLY_SIZE</a>, <a class="el" href="lustre__net_8h_source.html#l01336">PTLRPC_BULK_BUF_KVEC</a>, <a class="el" href="lustre__net_8h_source.html#l01338">PTLRPC_BULK_GET_SOURCE</a>, <a class="el" href="client_8c_source.html#l00062">ptlrpc_bulk_kvec_ops</a>, <a class="el" href="client_8c_source.html#l00174">ptlrpc_prep_bulk_imp()</a>, <a class="el" href="client_8c_source.html#l02490">ptlrpc_req_finished()</a>, <a class="el" href="client_8c_source.html#l00852">ptlrpc_request_alloc()</a>, <a class="el" href="client_8c_source.html#l00762">ptlrpc_request_pack()</a>, <a class="el" href="pack__generic_8c_source.html#l01551">ptlrpc_request_set_replen()</a>, <a class="el" href="lustre__req__layout_8h_source.html#l00058">RCL_CLIENT</a>, <a class="el" href="lustre__req__layout_8h_source.html#l00059">RCL_SERVER</a>, <a class="el" href="layout_8c_source.html#l02117">req_capsule_client_get()</a>, <a class="el" href="layout_8c_source.html#l02226">req_capsule_set_size()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01235">RMF_OUT_UPDATE_BUF</a>, <a class="el" href="layout_8c_source.html#l01231">RMF_OUT_UPDATE_HEADER</a>, <a class="el" href="layout_8c_source.html#l01199">RMF_OUT_UPDATE_REPLY</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_bulk_write</a>, <a class="el" href="lustre__net_8h_source.html#l01121">ptlrpc_request::rq_pill</a>, <a class="el" href="layout_8c_source.html#l01436">RQF_OUT_UPDATE</a>, and <a class="el" href="cascading__rw_8c_source.html#l00061">size</a>.</p>

<p>Referenced by <a class="el" href="osp__md__object_8c_source.html#l01126">osp_md_read()</a>, <a class="el" href="osp__trans_8c_source.html#l00442">osp_remote_sync()</a>, <a class="el" href="osp__trans_8c_source.html#l01104">osp_send_update_req()</a>, and <a class="el" href="osp__trans_8c_source.html#l00714">osp_unplug_async_request()</a>.</p>

</div>
</div>
<a class="anchor" id="a97ac7a8248c1e841eaaf68b2bc688610"></a><!-- doxytag: member="osp_internal.h::osp_put_rpc_lock" ref="a97ac7a8248c1e841eaaf68b2bc688610" args="(struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void osp_put_rpc_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00502">502</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="obd_8h_source.html#l00292">client_obd::cl_rpc_lock</a>, <a class="el" href="obd_8h_source.html#l00699">obd_device::cli</a>, <a class="el" href="lustre__mdc_8h_source.html#l00142">mdc_put_rpc_lock()</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, and <a class="el" href="structobd__device.html#aebe227afed9945c803b5bda6794bb729">obd_device::u</a>.</p>

<p>Referenced by <a class="el" href="osp__trans_8c_source.html#l01104">osp_send_update_req()</a>.</p>

</div>
</div>
<a class="anchor" id="a69ead520a1bac2ac520325e430d9beca"></a><!-- doxytag: member="osp_internal.h::osp_remote_sync" ref="a69ead520a1bac2ac520325e430d9beca" args="(const struct lu_env *env, struct osp_device *osp, struct osp_update_request *update, struct ptlrpc_request **reqp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_remote_sync </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *&nbsp;</td>
          <td class="paramname"> <em>our</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> **&nbsp;</td>
          <td class="paramname"> <em>reqp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send update RPC. </p>
<p>Send update request to the remote MDT synchronously.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>imp</em>&nbsp;</td><td>import on which ptlrpc request will be sent </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>our</em>&nbsp;</td><td>hold all of updates which will be packed into the req </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>reqp</em>&nbsp;</td><td>request to be created</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if RPC succeeds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>errno if RPC fails. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00442">442</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="obd_8h_source.html#l00162">client_obd::cl_import</a>, <a class="el" href="obd_8h_source.html#l00699">obd_device::cli</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="osp__trans_8c_source.html#l00314">osp_prep_update_req()</a>, <a class="el" href="osp__internal_8h_source.html#l00107">osp_update_request::our_rc</a>, <a class="el" href="client_8c_source.html#l02829">ptlrpc_queue_wait()</a>, <a class="el" href="client_8c_source.html#l02490">ptlrpc_req_finished()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l00968">ptlrpc_request::rq_allow_intr</a>, <a class="el" href="lustre__net_8h_source.html#l00968">ptlrpc_request::rq_allow_replay</a>, and <a class="el" href="structobd__device.html#aebe227afed9945c803b5bda6794bb729">obd_device::u</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00542">osp_attr_get()</a>, <a class="el" href="osp__md__object_8c_source.html#l00480">osp_md_index_lookup()</a>, and <a class="el" href="osp__object_8c_source.html#l00916">osp_xattr_get()</a>.</p>

</div>
</div>
<a class="anchor" id="a53e4fdfe8ba0a0942aa2ddfb7931b622"></a><!-- doxytag: member="osp_internal.h::osp_reset_last_used" ref="a53e4fdfe8ba0a0942aa2ddfb7931b622" args="(const struct lu_env *env, struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_reset_last_used </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7b0be3a2ddb7154bfa24d5b502c8763d"></a><!-- doxytag: member="osp_internal.h::osp_send_update_thread" ref="a7b0be3a2ddb7154bfa24d5b502c8763d" args="(void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_send_update_thread </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>arg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sending update thread. </p>
<p>Create thread to send update request to other MDTs, this thread will pull out update request from the list in OSP by version number, i.e. it will make sure the update request with lower version number will be sent first.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>arg</em>&nbsp;</td><td>hold the OSP device.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if the thread is created successfully.  negative error if the thread is not created successfully. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l01423">1423</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__lib_8h_source.html#l00329">l_wait_event</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00275">lu_device::ld_type</a>, <a class="el" href="lu__object_8h_source.html#l00336">lu_device_type::ldt_ctx_tags</a>, <a class="el" href="lu__object_8c_source.html#l01881">lu_env_fini()</a>, <a class="el" href="lu__object_8c_source.html#l01869">lu_env_init()</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00576">OBD_FAIL_INVALIDATE_UPDATE</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="osp__internal_8h_source.html#l00139">osp_device::opd_dt_dev</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="osp__internal_8h_source.html#l00186">osp_device::opd_update</a>, <a class="el" href="osp__internal_8h_source.html#l00188">osp_device::opd_update_thread</a>, <a class="el" href="osp__trans_8c_source.html#l01315">osp_get_next_request()</a>, <a class="el" href="osp__trans_8c_source.html#l01354">osp_invalidate_request()</a>, <a class="el" href="osp__trans_8c_source.html#l01104">osp_send_update_req()</a>, <a class="el" href="osp__internal_8h_source.html#l00650">osp_send_update_thread_running()</a>, <a class="el" href="osp__internal_8h_source.html#l00702">osp_thandle_put()</a>, <a class="el" href="osp__trans_8c_source.html#l01067">osp_trans_callback()</a>, <a class="el" href="osp__internal_8h_source.html#l00350">osp_thandle::ot_super</a>, <a class="el" href="osp__internal_8h_source.html#l00131">osp_updates::ou_lock</a>, <a class="el" href="osp__internal_8h_source.html#l00134">osp_updates::ou_rpc_version</a>, <a class="el" href="osp__internal_8h_source.html#l00132">osp_updates::ou_waitq</a>, <a class="el" href="osp__internal_8h_source.html#l00117">osp_update_request::our_th</a>, <a class="el" href="osp__internal_8h_source.html#l00119">osp_update_request::our_version</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01497">SVC_RUNNING</a>, <a class="el" href="lustre__net_8h_source.html#l01494">SVC_STOPPED</a>, <a class="el" href="lustre__net_8h_source.html#l01532">ptlrpc_thread::t_ctl_waitq</a>, <a class="el" href="lustre__net_8h_source.html#l01515">ptlrpc_thread::t_flags</a>, <a class="el" href="dt__object_8h_source.html#l01845">thandle::th_result</a>, and <a class="el" href="obd_8c_source.html#l00114">thread</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l00498">osp_update_init()</a>.</p>

</div>
</div>
<a class="anchor" id="acb2c73a51f76c6cf77f73578369a626c"></a><!-- doxytag: member="osp_internal.h::osp_send_update_thread_running" ref="acb2c73a51f76c6cf77f73578369a626c" args="(struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool osp_send_update_thread_running </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00650">650</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="osp__internal_8h_source.html#l00188">osp_device::opd_update_thread</a>, <a class="el" href="lustre__net_8h_source.html#l01497">SVC_RUNNING</a>, and <a class="el" href="lustre__net_8h_source.html#l01515">ptlrpc_thread::t_flags</a>.</p>

<p>Referenced by <a class="el" href="osp__trans_8c_source.html#l01423">osp_send_update_thread()</a>, <a class="el" href="osp__trans_8c_source.html#l01542">osp_trans_stop()</a>, and <a class="el" href="osp__dev_8c_source.html#l00498">osp_update_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a2317e1f3a3cba7d6d7e377ef4eb7f17f"></a><!-- doxytag: member="osp_internal.h::osp_send_update_thread_stopped" ref="a2317e1f3a3cba7d6d7e377ef4eb7f17f" args="(struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool osp_send_update_thread_stopped </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00655">655</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="osp__internal_8h_source.html#l00188">osp_device::opd_update_thread</a>, <a class="el" href="lustre__net_8h_source.html#l01494">SVC_STOPPED</a>, and <a class="el" href="lustre__net_8h_source.html#l01515">ptlrpc_thread::t_flags</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l00498">osp_update_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a55ba5dc71f6810f2d8769b9a6fceb48f"></a><!-- doxytag: member="osp_internal.h::osp_seq_site" ref="a55ba5dc71f6810f2d8769b9a6fceb48f" args="(struct osp_device *osp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structseq__server__site.html">seq_server_site</a>* osp_seq_site </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00488">488</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="lu__object_8h_source.html#l00645">lu_site::ld_seq_site</a>, <a class="el" href="lu__object_8h_source.html#l00283">lu_device::ld_site</a>, and <a class="el" href="osp__internal_8h_source.html#l00139">osp_device::opd_dt_dev</a>.</p>

</div>
</div>
<a class="anchor" id="ae60d06a7a5c2c36f3248f4394e7fd7d1"></a><!-- doxytag: member="osp_internal.h::osp_statfs_need_now" ref="ae60d06a7a5c2c36f3248f4394e7fd7d1" args="(struct osp_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void osp_statfs_need_now </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Schedule an immediate update for statfs data. </p>
<p>If cached statfs data claim no free space, but OSP has got a request to destroy an object (so release some space probably), then we may need to refresh cached statfs data sooner than planned. The function checks there is no statfs update going and schedules immediate update if so. XXX: there might be a case where removed object(s) do not add free space (empty object). If the number of such deletions is high, then we can start to update statfs too often causing a RPC storm. some throttling is needed...</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td>OSP device where statfs data needs to be refreshed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__precreate_8c_source.html#l00231">231</a> of file <a class="el" href="osp__precreate_8c_source.html">osp_precreate.c</a>.</p>

<p>References <a class="el" href="libcfs__time_8h_source.html#l00067">cfs_time_shift()</a>, <a class="el" href="linux-prim_8c_source.html#l00069">cfs_timer_disarm()</a>, <a class="el" href="osp__internal_8h_source.html#l00183">osp_device::opd_pre_waitq</a>, <a class="el" href="osp__internal_8h_source.html#l00234">osp_device::opd_statfs_fresh_till</a>, <a class="el" href="osp__internal_8h_source.html#l00235">osp_device::opd_statfs_timer</a>, and <a class="el" href="osp__internal_8h_source.html#l00236">osp_device::opd_statfs_update_in_progress</a>.</p>

<p>Referenced by <a class="el" href="osp__sync_8c_source.html#l00515">osp_sync_interpret()</a>, and <a class="el" href="osp__sync_8c_source.html#l00966">osp_sync_process_committed()</a>.</p>

</div>
</div>
<a class="anchor" id="ad84dcbea0dbe8c7aba1d3a5514e236f0"></a><!-- doxytag: member="osp_internal.h::osp_sync_add" ref="ad84dcbea0dbe8c7aba1d3a5514e236f0" args="(const struct lu_env *env, struct osp_object *o, llog_op_type type, struct thandle *th, const struct lu_attr *attr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_sync_add </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__object.html">osp_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="packet-lustre_8c.html#a46267c71f9f2221271c977534b08c789">llog_op_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__sync_8c_source.html#l00429">429</a> of file <a class="el" href="osp__sync_8c_source.html">osp_sync.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="lu__object_8h_source.html#l00472">lu_object::lo_dev</a>, <a class="el" href="osp__internal_8h_source.html#l00443">lu2osp_dev()</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="osp__internal_8h_source.html#l00291">osp_object::opo_obj</a>, and <a class="el" href="osp__sync_8c_source.html#l00357">osp_sync_add_rec()</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00709">osp_attr_set()</a>, and <a class="el" href="osp__object_8c_source.html#l01562">osp_object_destroy()</a>.</p>

</div>
</div>
<a class="anchor" id="af6eb77a1052667e2af318b2b5b934f80"></a><!-- doxytag: member="osp_internal.h::osp_sync_declare_add" ref="af6eb77a1052667e2af318b2b5b934f80" args="(const struct lu_env *env, struct osp_object *o, llog_op_type type, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_sync_declare_add </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__object.html">osp_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="packet-lustre_8c.html#a46267c71f9f2221271c977534b08c789">llog_op_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Declare intention to add a new change. </p>
<p>With regard to OSD API, we have to declare any changes ahead. In this case we declare an intention to add a llog record representing the change on the local storage.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>LU environment provided by the caller </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>o</em>&nbsp;</td><td>OSP object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>type of change: MDS_UNLINK64_REC or MDS_SETATTR64_REC </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>transaction handle (local)</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>negated errno on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__sync_8c_source.html#l00294">294</a> of file <a class="el" href="osp__sync_8c_source.html">osp_sync.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="lu__object_8h_source.html#l01016">LCT_OSP_THREAD</a>, <a class="el" href="lustre__log_8h_source.html#l00375">llog_ctxt_put()</a>, <a class="el" href="llog_8c_source.html#l00939">llog_declare_add()</a>, <a class="el" href="lustre__log_8h_source.html#l00431">llog_get_context()</a>, <a class="el" href="lustre__idl_8h_source.html#l03046">LLOG_MDS_OST_ORIG_CTXT</a>, <a class="el" href="lu__object_8h_source.html#l00472">lu_object::lo_dev</a>, <a class="el" href="lustre__log_8h_source.html#l00316">llog_ctxt::loc_handle</a>, <a class="el" href="lustre__idl_8h_source.html#l03114">llog_rec_hdr::lrh_len</a>, <a class="el" href="osp__internal_8h_source.html#l00443">lu2osp_dev()</a>, <a class="el" href="lustre__idl_8h_source.html#l03092">MDS_SETATTR64_REC</a>, <a class="el" href="lustre__idl_8h_source.html#l03089">MDS_UNLINK64_REC</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="osp__internal_8h_source.html#l00148">osp_device::opd_storage</a>, <a class="el" href="osp__internal_8h_source.html#l00291">osp_object::opo_obj</a>, <a class="el" href="osp__internal_8h_source.html#l00319">osp_thread_info::osi_hdr</a>, <a class="el" href="osp__internal_8h_source.html#l00409">osp_env_info()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="dt__object_8h_source.html#l01841">thandle::th_tags</a>, <a class="el" href="dt__object_8h_source.html#l01836">thandle::th_top</a>, and <a class="el" href="update__trans_8c_source.html#l01164">thandle_get_sub_by_dt()</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00638">osp_declare_attr_set()</a>, and <a class="el" href="osp__object_8c_source.html#l01530">osp_declare_object_destroy()</a>.</p>

</div>
</div>
<a class="anchor" id="a9fad5e902635f80345fb875169be1e03"></a><!-- doxytag: member="osp_internal.h::osp_sync_fini" ref="a9fad5e902635f80345fb875169be1e03" args="(struct osp_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_sync_fini </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stop the syncing thread. </p>
<p>Asks the syncing thread to stop and wait until it's stopped.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td>OSP device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__sync_8c_source.html#l01444">1444</a> of file <a class="el" href="osp__sync_8c_source.html">osp_sync.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="osp__internal_8h_source.html#l00201">osp_device::opd_syn_thread</a>, <a class="el" href="osp__internal_8h_source.html#l00202">osp_device::opd_syn_waitq</a>, <a class="el" href="osp__sync_8c_source.html#l01576">osp_sync_id_traction_fini()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01494">SVC_STOPPED</a>, <a class="el" href="lustre__net_8h_source.html#l01495">SVC_STOPPING</a>, <a class="el" href="lustre__net_8h_source.html#l01532">ptlrpc_thread::t_ctl_waitq</a>, <a class="el" href="lustre__net_8h_source.html#l01515">ptlrpc_thread::t_flags</a>, and <a class="el" href="obd_8c_source.html#l00114">thread</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l00996">osp_init0()</a>, and <a class="el" href="osp__dev_8c_source.html#l00587">osp_shutdown()</a>.</p>

</div>
</div>
<a class="anchor" id="a09b409cb21b03007d14cc16ca03c172d"></a><!-- doxytag: member="osp_internal.h::osp_sync_init" ref="a09b409cb21b03007d14cc16ca03c172d" args="(const struct lu_env *env, struct osp_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_sync_init </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialization of the sync component of OSP. </p>
<p>Initializes the llog and starts a new thread to handle the changes to the remote target (OST or MDT).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>LU environment provided by the caller </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td>OSP device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>negated errno on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__sync_8c_source.html#l01381">1381</a> of file <a class="el" href="osp__sync_8c_source.html">osp_sync.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="lustre__lib_8h_source.html#l00329">l_wait_event</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="osp__internal_8h_source.html#l00145">osp_device::opd_group</a>, <a class="el" href="osp__internal_8h_source.html#l00141">osp_device::opd_index</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="osp__internal_8h_source.html#l00228">osp_device::opd_syn_barrier_waitq</a>, <a class="el" href="osp__internal_8h_source.html#l00206">osp_device::opd_syn_committed_there</a>, <a class="el" href="osp__internal_8h_source.html#l00204">osp_device::opd_syn_inflight_list</a>, <a class="el" href="osp__internal_8h_source.html#l00193">osp_device::opd_syn_lock</a>, <a class="el" href="osp__internal_8h_source.html#l00211">osp_device::opd_syn_max_rpc_in_flight</a>, <a class="el" href="osp__internal_8h_source.html#l00214">osp_device::opd_syn_max_rpc_in_progress</a>, <a class="el" href="osp__internal_8h_source.html#l00201">osp_device::opd_syn_thread</a>, <a class="el" href="osp__internal_8h_source.html#l00202">osp_device::opd_syn_waitq</a>, <a class="el" href="osp__sync_8c_source.html#l00093">OSP_MAX_IN_FLIGHT</a>, <a class="el" href="osp__sync_8c_source.html#l00094">OSP_MAX_IN_PROGRESS</a>, <a class="el" href="osp__sync_8c_source.html#l01576">osp_sync_id_traction_fini()</a>, <a class="el" href="osp__sync_8c_source.html#l01522">osp_sync_id_traction_init()</a>, <a class="el" href="osp__sync_8c_source.html#l01359">osp_sync_llog_fini()</a>, <a class="el" href="osp__sync_8c_source.html#l01244">osp_sync_llog_init()</a>, <a class="el" href="osp__sync_8c_source.html#l00106">osp_sync_running()</a>, <a class="el" href="osp__sync_8c_source.html#l00119">osp_sync_stopped()</a>, <a class="el" href="osp__sync_8c_source.html#l01142">osp_sync_thread()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="lustre__net_8h_source.html#l01532">ptlrpc_thread::t_ctl_waitq</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l00996">osp_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="a6bd88b1bd0177d870b04c84e6f9aea0e"></a><!-- doxytag: member="osp_internal.h::osp_thandle_destroy" ref="a6bd88b1bd0177d870b04c84e6f9aea0e" args="(struct osp_thandle *oth)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void osp_thandle_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__thandle.html">osp_thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>oth</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00919">919</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="osp__internal_8h_source.html#l00348">OSP_THANDLE_MAGIC</a>, <a class="el" href="osp__trans_8c_source.html#l00204">osp_update_request_destroy()</a>, <a class="el" href="osp__internal_8h_source.html#l00355">osp_thandle::ot_commit_dcb_list</a>, <a class="el" href="osp__internal_8h_source.html#l00354">osp_thandle::ot_magic</a>, <a class="el" href="osp__internal_8h_source.html#l00357">osp_thandle::ot_our</a>, and <a class="el" href="osp__internal_8h_source.html#l00356">osp_thandle::ot_stop_dcb_list</a>.</p>

<p>Referenced by <a class="el" href="osp__internal_8h_source.html#l00702">osp_thandle_put()</a>.</p>

</div>
</div>
<a class="anchor" id="a86c85504d915060117d7381e87a9d89d"></a><!-- doxytag: member="osp_internal.h::osp_thandle_get" ref="a86c85504d915060117d7381e87a9d89d" args="(struct osp_thandle *oth)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void osp_thandle_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__thandle.html">osp_thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>oth</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00697">697</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="osp__internal_8h_source.html#l00358">osp_thandle::ot_refcount</a>.</p>

<p>Referenced by <a class="el" href="osp__trans_8c_source.html#l01264">osp_check_and_set_rpc_version()</a>, and <a class="el" href="osp__trans_8c_source.html#l01104">osp_send_update_req()</a>.</p>

</div>
</div>
<a class="anchor" id="aaa76d6672c65cab88e50760545ca3dbf"></a><!-- doxytag: member="osp_internal.h::osp_thandle_put" ref="aaa76d6672c65cab88e50760545ca3dbf" args="(struct osp_thandle *oth)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void osp_thandle_put </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__thandle.html">osp_thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>oth</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00702">702</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="osp__trans_8c_source.html#l00919">osp_thandle_destroy()</a>, and <a class="el" href="osp__internal_8h_source.html#l00358">osp_thandle::ot_refcount</a>.</p>

<p>Referenced by <a class="el" href="osp__trans_8c_source.html#l01354">osp_invalidate_request()</a>, <a class="el" href="osp__trans_8c_source.html#l01019">osp_request_commit_cb()</a>, <a class="el" href="osp__trans_8c_source.html#l01104">osp_send_update_req()</a>, <a class="el" href="osp__trans_8c_source.html#l01423">osp_send_update_thread()</a>, <a class="el" href="osp__trans_8c_source.html#l01542">osp_trans_stop()</a>, <a class="el" href="osp__dev_8c_source.html#l00546">osp_update_fini()</a>, and <a class="el" href="osp__trans_8c_source.html#l00605">osp_update_interpret()</a>.</p>

</div>
</div>
<a class="anchor" id="ac0eee5ec07a43a79b28e19e541e2a3a5"></a><!-- doxytag: member="osp_internal.h::osp_trans_callback" ref="ac0eee5ec07a43a79b28e19e541e2a3a5" args="(const struct lu_env *env, struct osp_thandle *oth, int rc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void osp_trans_callback </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__thandle.html">osp_thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>oth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>callback of osp transaction </p>
<p>Call all of callbacks for this osp <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a>. This will only be called in error handler path. In the normal processing path, these callback will be called in <a class="el" href="osp__trans_8c.html#a3d2ecdd4bc2fe8b7c576d202d76dc0e6">osp_request_commit_cb()</a> and <a class="el" href="osp__trans_8c.html#a067dfbd2cb3a4bd51b2e14112d692405" title="Interpret the packaged OUT RPC results.">osp_update_interpret()</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oth</em>&nbsp;</td><td>osp <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rc</em>&nbsp;</td><td>result of the osp <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l01067">1067</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00484">list_for_each_entry_safe</a>, <a class="el" href="osp__trans_8c_source.html#l01002">osp_trans_commit_cb()</a>, <a class="el" href="osp__trans_8c_source.html#l00527">osp_trans_stop_cb()</a>, <a class="el" href="osp__trans_8c_source.html#l00582">osp_update_callback_fini()</a>, <a class="el" href="osp__internal_8h_source.html#l00357">osp_thandle::ot_our</a>, <a class="el" href="osp__trans_8c_source.html#l00094">osp_update_callback::ouc_data</a>, <a class="el" href="osp__trans_8c_source.html#l00097">osp_update_callback::ouc_interpreter</a>, <a class="el" href="osp__trans_8c_source.html#l00088">osp_update_callback::ouc_list</a>, <a class="el" href="osp__trans_8c_source.html#l00091">osp_update_callback::ouc_obj</a>, and <a class="el" href="osp__internal_8h_source.html#l00114">osp_update_request::our_cb_items</a>.</p>

<p>Referenced by <a class="el" href="osp__trans_8c_source.html#l01354">osp_invalidate_request()</a>, <a class="el" href="osp__trans_8c_source.html#l01104">osp_send_update_req()</a>, <a class="el" href="osp__trans_8c_source.html#l01423">osp_send_update_thread()</a>, <a class="el" href="osp__trans_8c_source.html#l01542">osp_trans_stop()</a>, and <a class="el" href="osp__dev_8c_source.html#l00546">osp_update_fini()</a>.</p>

</div>
</div>
<a class="anchor" id="a1a8c6788966fb5ad5c99a44e1e9c8bd6"></a><!-- doxytag: member="osp_internal.h::osp_trans_cb_add" ref="a1a8c6788966fb5ad5c99a44e1e9c8bd6" args="(struct thandle *th, struct dt_txn_commit_cb *dcb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_trans_cb_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__txn__commit__cb.html">dt_txn_commit_cb</a> *&nbsp;</td>
          <td class="paramname"> <em>dcb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add commit callback to transaction. </p>
<p>Add commit callback to the osp <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a>, which will be called when the <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> is committed remotely.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>the <a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dcb</em>&nbsp;</td><td>commit callback structure</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>only</em>&nbsp;</td><td>return 0 for now. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00989">989</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l00113">dt_txn_commit_cb::dcb_flags</a>, <a class="el" href="dt__object_8h_source.html#l00110">dt_txn_commit_cb::dcb_func</a>, <a class="el" href="dt__object_8h_source.html#l00109">dt_txn_commit_cb::dcb_linkage</a>, <a class="el" href="dt__object_8h_source.html#l00112">dt_txn_commit_cb::dcb_magic</a>, <a class="el" href="dt__object_8h_source.html#l00107">DCB_TRANS_STOP</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="list_8h_source.html#l00076">list_add()</a>, <a class="el" href="osp__internal_8h_source.html#l00355">osp_thandle::ot_commit_dcb_list</a>, <a class="el" href="osp__internal_8h_source.html#l00356">osp_thandle::ot_stop_dcb_list</a>, <a class="el" href="osp__internal_8h_source.html#l00362">thandle_to_osp_thandle()</a>, and <a class="el" href="dt__object_8h_source.html#l00104">TRANS_COMMIT_CB_MAGIC</a>.</p>

</div>
</div>
<a class="anchor" id="a2963c05847ee507a77adeb79accdc6f7"></a><!-- doxytag: member="osp_internal.h::osp_trans_create" ref="a2963c05847ee507a77adeb79accdc6f7" args="(const struct lu_env *env, struct dt_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structthandle.html">thandle</a>* osp_trans_create </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__device.html">dt_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The OSP layer <a class="el" href="structdt__device__operations.html#a06f026899bb291ac5bb915a17dcadb7f" title="Create transaction.">dt_device_operations::dt_trans_create()</a> interface to create a transaction. </p>
<p>There are two kinds of transactions that will involve OSP:</p>
<p>1) If the transaction only contains the updates on remote server (MDT or OST), such as re-generating the lost OST-object for LFSCK, then it is a remote transaction. For remote transaction, the upper layer caller (such as the LFSCK engine) will call the <a class="el" href="group__dt.html#ga689a89697bff3936cf4d60bd2651dc8a">dt_trans_create()</a> (with the OSP <a class="el" href="structdt__device.html">dt_device</a> as the parameter), then the call will be directed to the <a class="el" href="osp__internal_8h.html#a2963c05847ee507a77adeb79accdc6f7" title="The OSP layer dt_device_operations::dt_trans_create() interface to create a transaction...">osp_trans_create()</a> that creates the transaction handler and returns it to the caller.</p>
<p>2) If the transcation contains both local and remote updates, such as cross MDTs create under DNE mode, then the upper layer caller will not trigger <a class="el" href="osp__internal_8h.html#a2963c05847ee507a77adeb79accdc6f7" title="The OSP layer dt_device_operations::dt_trans_create() interface to create a transaction...">osp_trans_create()</a>. Instead, it will call <a class="el" href="group__dt.html#ga689a89697bff3936cf4d60bd2651dc8a">dt_trans_create()</a> on other <a class="el" href="structdt__device.html">dt_device</a>, such as LOD that will generate the transaction handler. Such handler will be used by the whole transaction in subsequent sub-operations.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>d</em>&nbsp;</td><td>pointer to the OSP <a class="el" href="structdt__device.html">dt_device</a></td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pointer</em>&nbsp;</td><td>to the transaction handler </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00956">956</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="lu__object_8h_source.html#l01003">LCT_TX_HANDLE</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="osp__internal_8h_source.html#l00348">OSP_THANDLE_MAGIC</a>, <a class="el" href="osp__internal_8h_source.html#l00355">osp_thandle::ot_commit_dcb_list</a>, <a class="el" href="osp__internal_8h_source.html#l00354">osp_thandle::ot_magic</a>, <a class="el" href="osp__internal_8h_source.html#l00358">osp_thandle::ot_refcount</a>, <a class="el" href="osp__internal_8h_source.html#l00356">osp_thandle::ot_stop_dcb_list</a>, <a class="el" href="osp__internal_8h_source.html#l00350">osp_thandle::ot_super</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="dt__object_8h_source.html#l01828">thandle::th_dev</a>, <a class="el" href="dt__object_8h_source.html#l01841">thandle::th_tags</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="abc06232f12babe95aefb7105d7008d69"></a><!-- doxytag: member="osp_internal.h::osp_trans_start" ref="abc06232f12babe95aefb7105d7008d69" args="(const struct lu_env *env, struct dt_device *dt, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_trans_start </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__device.html">dt_device</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The OSP layer <a class="el" href="structdt__device__operations.html#a9f4532e51dbeefa61d9c0f6a9670ef5b" title="Start transaction.">dt_device_operations::dt_trans_start()</a> interface to start the transaction. </p>
<p>If the transaction is a remote transaction, then related remote updates will be triggered in the <a class="el" href="osp__internal_8h.html#a38da7db0c90fa482dc7eab274b4775ef" title="The OSP layer dt_device_operations::dt_trans_stop() interface to stop the transaction...">osp_trans_stop()</a>. Please refer to <a class="el" href="osp__internal_8h.html#a2963c05847ee507a77adeb79accdc6f7" title="The OSP layer dt_device_operations::dt_trans_create() interface to create a transaction...">osp_trans_create()</a> for transaction type.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>pointer to the OSP <a class="el" href="structdt__device.html">dt_device</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>pointer to the transaction handler</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l01509">1509</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l02054">dt_trans_start()</a>, <a class="el" href="osp__internal_8h_source.html#l00378">is_only_remote_trans()</a>, <a class="el" href="osp__internal_8h_source.html#l00357">osp_thandle::ot_our</a>, <a class="el" href="osp__internal_8h_source.html#l00353">osp_thandle::ot_storage_th</a>, <a class="el" href="osp__internal_8h_source.html#l00350">osp_thandle::ot_super</a>, <a class="el" href="osp__internal_8h_source.html#l00105">osp_update_request::our_flags</a>, <a class="el" href="dt__object_8h_source.html#l01828">thandle::th_dev</a>, <a class="el" href="dt__object_8h_source.html#l01848">thandle::th_sync</a>, <a class="el" href="osp__internal_8h_source.html#l00362">thandle_to_osp_thandle()</a>, and <a class="el" href="lustre__idl_8h_source.html#l03806">UPDATE_FL_SYNC</a>.</p>

</div>
</div>
<a class="anchor" id="a38da7db0c90fa482dc7eab274b4775ef"></a><!-- doxytag: member="osp_internal.h::osp_trans_stop" ref="a38da7db0c90fa482dc7eab274b4775ef" args="(const struct lu_env *env, struct dt_device *dt, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_trans_stop </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__device.html">dt_device</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The OSP layer <a class="el" href="structdt__device__operations.html#a1a48e37999c62e8d1d2ad6e84572393b" title="Stop transaction.">dt_device_operations::dt_trans_stop()</a> interface to stop the transaction. </p>
<p>If the transaction is a remote transaction, related remote updates will be triggered at the end of this function.</p>
<p>For synchronous mode update or any failed update, the request will be destroyed explicitly when the <a class="el" href="osp__internal_8h.html#a38da7db0c90fa482dc7eab274b4775ef" title="The OSP layer dt_device_operations::dt_trans_stop() interface to stop the transaction...">osp_trans_stop()</a>.</p>
<p>Please refer to <a class="el" href="osp__internal_8h.html#a2963c05847ee507a77adeb79accdc6f7" title="The OSP layer dt_device_operations::dt_trans_create() interface to create a transaction...">osp_trans_create()</a> for transaction type.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>pointer to the OSP <a class="el" href="structdt__device.html">dt_device</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>pointer to the transaction handler</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l01542">1542</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00148">D_HA</a>, <a class="el" href="osp__internal_8h_source.html#l00454">dt2osp_dev()</a>, <a class="el" href="dt__object_8h_source.html#l02070">dt_trans_stop()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs__private_8h_source.html#l00309">likely</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="osp__internal_8h_source.html#l00167">osp_device::opd_connect_mdt</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="osp__internal_8h_source.html#l00186">osp_device::opd_update</a>, <a class="el" href="osp__trans_8c_source.html#l01104">osp_send_update_req()</a>, <a class="el" href="osp__internal_8h_source.html#l00650">osp_send_update_thread_running()</a>, <a class="el" href="osp__internal_8h_source.html#l00702">osp_thandle_put()</a>, <a class="el" href="osp__trans_8c_source.html#l01067">osp_trans_callback()</a>, <a class="el" href="osp__internal_8h_source.html#l00357">osp_thandle::ot_our</a>, <a class="el" href="osp__internal_8h_source.html#l00353">osp_thandle::ot_storage_th</a>, <a class="el" href="osp__internal_8h_source.html#l00132">osp_updates::ou_waitq</a>, <a class="el" href="osp__internal_8h_source.html#l00123">osp_update_request::our_list</a>, <a class="el" href="osp__internal_8h_source.html#l00121">osp_update_request::our_list_lock</a>, <a class="el" href="osp__internal_8h_source.html#l00110">osp_update_request::our_req_list</a>, <a class="el" href="osp__internal_8h_source.html#l00125">osp_update_request::our_req_ready</a>, <a class="el" href="osp__internal_8h_source.html#l00119">osp_update_request::our_version</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="dt__object_8h_source.html#l01828">thandle::th_dev</a>, <a class="el" href="dt__object_8h_source.html#l01845">thandle::th_result</a>, <a class="el" href="dt__object_8h_source.html#l01836">thandle::th_top</a>, and <a class="el" href="osp__internal_8h_source.html#l00362">thandle_to_osp_thandle()</a>.</p>

</div>
</div>
<a class="anchor" id="ad85a2edcb3ab6a94d03da547d8b0dd33"></a><!-- doxytag: member="osp_internal.h::osp_trans_update_request_create" ref="ad85a2edcb3ab6a94d03da547d8b0dd33" args="(struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_trans_update_request_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00899">899</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="osp__trans_8c_source.html#l00187">osp_update_request_create()</a>, <a class="el" href="osp__internal_8h_source.html#l00357">osp_thandle::ot_our</a>, <a class="el" href="osp__internal_8h_source.html#l00117">osp_update_request::our_th</a>, <a class="el" href="dt__object_8h_source.html#l01828">thandle::th_dev</a>, <a class="el" href="dt__object_8h_source.html#l01845">thandle::th_result</a>, and <a class="el" href="osp__internal_8h_source.html#l00362">thandle_to_osp_thandle()</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l01236">osp_declare_xattr_del()</a>, <a class="el" href="osp__object_8c_source.html#l01125">osp_declare_xattr_set()</a>, <a class="el" href="osp__md__object_8c_source.html#l00337">osp_md_declare_attr_set()</a>, <a class="el" href="osp__md__object_8c_source.html#l00630">osp_md_declare_index_delete()</a>, <a class="el" href="osp__md__object_8c_source.html#l00573">osp_md_declare_index_insert()</a>, <a class="el" href="osp__md__object_8c_source.html#l00121">osp_md_declare_object_create()</a>, <a class="el" href="osp__md__object_8c_source.html#l00962">osp_md_declare_object_destroy()</a>, <a class="el" href="osp__md__object_8c_source.html#l00264">osp_md_declare_ref_add()</a>, <a class="el" href="osp__md__object_8c_source.html#l00218">osp_md_declare_ref_del()</a>, and <a class="el" href="osp__md__object_8c_source.html#l01053">osp_md_declare_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a07dd1da86372a8d620d6e0241e5be856"></a><!-- doxytag: member="osp_internal.h::osp_txn_info" ref="a07dd1da86372a8d620d6e0241e5be856" args="(struct lu_context *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structosp__txn__info.html">osp_txn_info</a>* <a class="el" href="structosp__txn__info.html">osp_txn_info</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlu__context.html">lu_context</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00428">428</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="lu__object_8c_source.html#l01574">lu_context_key_get()</a>, and <a class="el" href="osp__dev_8c_source.html#l01856">osp_txn_key</a>.</p>

<p>Referenced by <a class="el" href="osp__sync_8c_source.html#l00357">osp_sync_add_rec()</a>, and <a class="el" href="osp__sync_8c_source.html#l01476">osp_sync_tracker_commit_cb()</a>.</p>

</div>
</div>
<a class="anchor" id="aa1b34250ba882a08a30329a2c712e3f9"></a><!-- doxytag: member="osp_internal.h::osp_unplug_async_request" ref="aa1b34250ba882a08a30329a2c712e3f9" args="(const struct lu_env *env, struct osp_device *osp, struct osp_update_request *update)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_unplug_async_request </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *&nbsp;</td>
          <td class="paramname"> <em>our</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pack all the requests in the shared asynchronous idempotent request queue into a single OUT RPC that will be given to the background <a class="el" href="structptlrpcd.html">ptlrpcd</a> daemon. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>osp</em>&nbsp;</td><td>pointer to the OSP device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>our</em>&nbsp;</td><td>pointer to the shared queue</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00714">714</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="obd_8h_source.html#l00162">client_obd::cl_import</a>, <a class="el" href="obd_8h_source.html#l00699">obd_device::cli</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00484">list_for_each_entry_safe</a>, <a class="el" href="osp__trans_8c_source.html#l00077">osp_update_args::oaua_count</a>, <a class="el" href="osp__trans_8c_source.html#l00079">osp_update_args::oaua_flow_control</a>, <a class="el" href="osp__trans_8c_source.html#l00076">osp_update_args::oaua_update</a>, <a class="el" href="osp__trans_8c_source.html#l00080">osp_update_args::oaua_update_env</a>, <a class="el" href="osp__trans_8c_source.html#l00078">osp_update_args::oaua_waitq</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="osp__trans_8c_source.html#l00314">osp_prep_update_req()</a>, <a class="el" href="osp__trans_8c_source.html#l00582">osp_update_callback_fini()</a>, <a class="el" href="osp__trans_8c_source.html#l00605">osp_update_interpret()</a>, <a class="el" href="osp__trans_8c_source.html#l00204">osp_update_request_destroy()</a>, <a class="el" href="osp__trans_8c_source.html#l00094">osp_update_callback::ouc_data</a>, <a class="el" href="osp__trans_8c_source.html#l00097">osp_update_callback::ouc_interpreter</a>, <a class="el" href="osp__trans_8c_source.html#l00088">osp_update_callback::ouc_list</a>, <a class="el" href="osp__trans_8c_source.html#l00091">osp_update_callback::ouc_obj</a>, <a class="el" href="osp__internal_8h_source.html#l00114">osp_update_request::our_cb_items</a>, <a class="el" href="lustre__net_8h_source.html#l00505">ptlrpc_req_async_args</a>, <a class="el" href="ptlrpcd_8c_source.html#l00268">ptlrpcd_add_req()</a>, and <a class="el" href="structobd__device.html#aebe227afed9945c803b5bda6794bb729">obd_device::u</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00835">osp_declare_xattr_get()</a>, and <a class="el" href="osp__trans_8c_source.html#l00840">osp_insert_async_request()</a>.</p>

</div>
</div>
<a class="anchor" id="a5e732504dc4a720f80dc74cd573b1237"></a><!-- doxytag: member="osp_internal.h::osp_update_last_fid" ref="a5e732504dc4a720f80dc74cd573b1237" args="(struct osp_device *d, struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void osp_update_last_fid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00534">534</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00148">D_HA</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="lustre__user_8h_source.html#l00147">lu_fid::f_oid</a>, <a class="el" href="osp__internal_8h_source.html#l00157">osp_device::opd_gap_count</a>, <a class="el" href="osp__internal_8h_source.html#l00156">osp_device::opd_gap_start_fid</a>, <a class="el" href="osp__internal_8h_source.html#l00155">osp_device::opd_last_used_fid</a>, <a class="el" href="osp__internal_8h_source.html#l00509">osp_fid_diff()</a>, and <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l01417">osp_object_create()</a>, and <a class="el" href="osp__precreate_8c_source.html#l01405">osp_precreate_get_fid()</a>.</p>

</div>
</div>
<a class="anchor" id="ae12c825a26d57b1f61fc939b4b9c05e4"></a><!-- doxytag: member="osp_internal.h::osp_update_last_id" ref="ae12c825a26d57b1f61fc939b4b9c05e4" args="(struct osp_device *d, u64 objid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void osp_update_last_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&nbsp;</td>
          <td class="paramname"> <em>objid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2ab6c8e8a82925f7fda820d3b20e7225"></a><!-- doxytag: member="osp_internal.h::osp_update_request_create" ref="a2ab6c8e8a82925f7fda820d3b20e7225" args="(struct dt_device *dt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structosp__update__request.html">osp_update_request</a>* osp_update_request_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdt__device.html">dt_device</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocate and initialize <a class="el" href="structosp__update__request.html">osp_update_request</a>. </p>
<p><a class="el" href="structosp__update__request.html">osp_update_request</a> is being used to track updates being executed on this dt_device(OSD or OSP). The update buffer will be 4k initially, and increased if needed.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>dt device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="structosp__update__request.html">osp_update_request</a></em>&nbsp;</td><td>being allocated if succeed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ERR_PTR(errno)</em>&nbsp;</td><td>if failed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00187">187</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="osp__trans_8c_source.html#l00125">osp_object_update_request_create()</a>, <a class="el" href="osp__internal_8h_source.html#l00114">osp_update_request::our_cb_items</a>, <a class="el" href="osp__internal_8h_source.html#l00123">osp_update_request::our_list</a>, <a class="el" href="osp__internal_8h_source.html#l00121">osp_update_request::our_list_lock</a>, <a class="el" href="osp__internal_8h_source.html#l00110">osp_update_request::our_req_list</a>, and <a class="el" href="lustre__update_8h_source.html#l00036">OUT_UPDATE_INIT_BUFFER_SIZE</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00542">osp_attr_get()</a>, <a class="el" href="osp__trans_8c_source.html#l00768">osp_find_or_create_async_update_request()</a>, <a class="el" href="osp__md__object_8c_source.html#l00480">osp_md_index_lookup()</a>, <a class="el" href="osp__md__object_8c_source.html#l01126">osp_md_read()</a>, <a class="el" href="osp__trans_8c_source.html#l00899">osp_trans_update_request_create()</a>, and <a class="el" href="osp__object_8c_source.html#l00916">osp_xattr_get()</a>.</p>

</div>
</div>
<a class="anchor" id="a695103310a22be882fd6d5d45fff1c03"></a><!-- doxytag: member="osp_internal.h::osp_update_request_destroy" ref="a695103310a22be882fd6d5d45fff1c03" args="(struct osp_update_request *update)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void osp_update_request_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structosp__update__request.html">osp_update_request</a> *&nbsp;</td>
          <td class="paramname"> <em>update</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__trans_8c_source.html#l00204">204</a> of file <a class="el" href="osp__trans_8c_source.html">osp_trans.c</a>.</p>

<p>References <a class="el" href="list_8h_source.html#l00116">list_del()</a>, <a class="el" href="list_8h_source.html#l00484">list_for_each_entry_safe</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="osp__internal_8h_source.html#l00110">osp_update_request::our_req_list</a>, <a class="el" href="osp__internal_8h_source.html#l00101">osp_update_request_sub::ours_list</a>, <a class="el" href="osp__internal_8h_source.html#l00098">osp_update_request_sub::ours_req</a>, and <a class="el" href="osp__internal_8h_source.html#l00099">osp_update_request_sub::ours_req_size</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l00542">osp_attr_get()</a>, <a class="el" href="osp__dev_8c_source.html#l01319">osp_device_fini()</a>, <a class="el" href="osp__md__object_8c_source.html#l00480">osp_md_index_lookup()</a>, <a class="el" href="osp__md__object_8c_source.html#l01126">osp_md_read()</a>, <a class="el" href="osp__trans_8c_source.html#l00919">osp_thandle_destroy()</a>, <a class="el" href="osp__trans_8c_source.html#l00714">osp_unplug_async_request()</a>, <a class="el" href="osp__trans_8c_source.html#l00605">osp_update_interpret()</a>, and <a class="el" href="osp__object_8c_source.html#l00916">osp_xattr_get()</a>.</p>

</div>
</div>
<a class="anchor" id="a90b9288ca2540bfbf52700423ed6193a"></a><!-- doxytag: member="osp_internal.h::osp_write_last_oid_seq_files" ref="a90b9288ca2540bfbf52700423ed6193a" args="(struct lu_env *env, struct osp_device *osp, struct lu_fid *fid, int sync)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_write_last_oid_seq_files </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structosp__device.html">osp_device</a> *&nbsp;</td>
          <td class="paramname"> <em>osp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sync</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write FID into into last_oid/last_seq file. </p>
<p>The function stores the sequence and the in-sequence id into two dedicated files. The sync argument can be used to request synchronous commit, so the function won't return until the updates are committed.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>LU environment provided by the caller </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>osp</em>&nbsp;</td><td>OSP device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>fid where sequence/id is taken </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sync</em>&nbsp;</td><td>update mode: 0 - asynchronously, 1 - synchronously</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>negated errno on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__precreate_8c_source.html#l00349">349</a> of file <a class="el" href="osp__precreate_8c_source.html">osp_precreate.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="dt__object_8h_source.html#l02087">dt_declare_record_write()</a>, <a class="el" href="dt__object_8c_source.html#l00504">dt_record_write()</a>, <a class="el" href="dt__object_8h_source.html#l02047">dt_trans_create()</a>, <a class="el" href="dt__object_8h_source.html#l02062">dt_trans_start_local()</a>, <a class="el" href="dt__object_8h_source.html#l02070">dt_trans_stop()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__user_8h_source.html#l00147">lu_fid::f_oid</a>, <a class="el" href="lustre__user_8h_source.html#l00145">lu_fid::f_seq</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="osp__internal_8h_source.html#l00141">osp_device::opd_index</a>, <a class="el" href="osp__internal_8h_source.html#l00149">osp_device::opd_last_used_oid_file</a>, <a class="el" href="osp__internal_8h_source.html#l00150">osp_device::opd_last_used_seq_file</a>, <a class="el" href="osp__internal_8h_source.html#l00159">osp_device::opd_obd</a>, <a class="el" href="osp__internal_8h_source.html#l00148">osp_device::opd_storage</a>, <a class="el" href="osp__internal_8h_source.html#l00310">osp_thread_info::osi_lb</a>, <a class="el" href="osp__internal_8h_source.html#l00311">osp_thread_info::osi_lb2</a>, <a class="el" href="osp__internal_8h_source.html#l00409">osp_env_info()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="dt__object_8h_source.html#l01848">thandle::th_sync</a>.</p>

<p>Referenced by <a class="el" href="osp__precreate_8c_source.html#l01008">osp_init_pre_fid()</a>, and <a class="el" href="osp__precreate_8c_source.html#l00428">osp_precreate_rollover_new_seq()</a>.</p>

</div>
</div>
<a class="anchor" id="a5cba0564396dce70318ff5a5ac64f775"></a><!-- doxytag: member="osp_internal.h::osp_xattr_del" ref="a5cba0564396dce70318ff5a5ac64f775" args="(const struct lu_env *env, struct dt_object *dt, const char *name, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_xattr_del </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implement OSP layer <a class="el" href="structdt__object__operations.html#a19762fb1d9e75136521019d51759b6ec" title="Delete an extended attribute.">dt_object_operations::do_xattr_del()</a> interface. </p>
<p>Delete extended attribute on the specified MDT/OST object.</p>
<p>If it is remote transaction, it will add an OUT_XATTR_DEL sub-request into the OUT RPC that will be flushed when the transaction stop. And if the name extended attribute entry exists in the OSP attributes cache, then remove it from the cache.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>pointer to the OSP layer <a class="el" href="structdt__object.html">dt_object</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>the name of the extended attribute to be set </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>pointer to the transaction handler</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l01260">1260</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="osp__internal_8h_source.html#l00477">dt2osp_obj()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="osp__internal_8h_source.html#l00299">osp_object::opo_ooa</a>, <a class="el" href="osp__object_8c_source.html#l00238">osp_oac_xattr_find()</a>, <a class="el" href="osp__object_8c_source.html#l00375">osp_oac_xattr_put()</a>, <a class="el" href="osp__internal_8h_source.html#l00605">osp_update_rpc_pack</a>, <a class="el" href="lustre__idl_8h_source.html#l03797">OUT_XATTR_DEL</a>, and <a class="el" href="osp__internal_8h_source.html#l00368">thandle_to_osp_update_request()</a>.</p>

</div>
</div>
<a class="anchor" id="aee4dfb5ebf4062287d3a3b1a4ee1ac13"></a><!-- doxytag: member="osp_internal.h::osp_xattr_get" ref="aee4dfb5ebf4062287d3a3b1a4ee1ac13" args="(const struct lu_env *env, struct dt_object *dt, struct lu_buf *buf, const char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_xattr_get </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implement OSP layer <a class="el" href="structdt__object__operations.html#af4c8c504e52a5571dbd0557980c3818a" title="Return a value of an extended attribute.">dt_object_operations::do_xattr_get()</a> interface. </p>
<p>Get extended attribute from the specified MDT/OST object.</p>
<p>If the extended attribute is in the OSP object attributes cache, then return the cached extended attribute directly. Otherwise it will get the extended attribute synchronously, if successful, add it to the OSP attributes cache. (</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="osp__trans_8c.html">lustre/osp/osp_trans.c</a> for <a class="el" href="gni__pub_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> RPC.)</dd></dl>
<p>There is a race condition: some other thread has added the named extended attributed entry to the OSP object attributes cache during the current OUT_XATTR_GET handling. If such case happens, the OSP will replace the (just) existing extended attribute entry with the new replied one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>pointer to the OSP layer <a class="el" href="structdt__object.html">dt_object</a> </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>pointer to the <a class="el" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> to hold the extended attribute </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>the name for the expected extended attribute</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l00916">916</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="fail_8c_source.html#l00039">cfs_fail_val</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="osp__internal_8h_source.html#l00477">dt2osp_obj()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="osp__object_8c_source.html#l00137">is_ost_obj()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="lu__object_8h_source.html#l00287">lu_device::ld_obd</a>, <a class="el" href="lu__object_8h_source.html#l00472">lu_object::lo_dev</a>, <a class="el" href="lu__object_8h_source.html#l00468">lu_object::lo_header</a>, <a class="el" href="lu__object_8h_source.html#l00539">lu_object_header::loh_attr</a>, <a class="el" href="lu__object_8h_source.html#l00501">LOHA_EXISTS</a>, <a class="el" href="osp__internal_8h_source.html#l00443">lu2osp_dev()</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00549">OBD_FAIL_LFSCK_BAD_NETWORK</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="lustre__update_8h_source.html#l00243">object_update_result_data_get()</a>, <a class="el" href="osp__internal_8h_source.html#l00167">osp_device::opd_connect_mdt</a>, <a class="el" href="osp__internal_8h_source.html#l00139">osp_device::opd_dt_dev</a>, <a class="el" href="osp__internal_8h_source.html#l00141">osp_device::opd_index</a>, <a class="el" href="osp__internal_8h_source.html#l00301">osp_object::opo_lock</a>, <a class="el" href="osp__internal_8h_source.html#l00292">osp_object::opo_non_exist</a>, <a class="el" href="osp__internal_8h_source.html#l00299">osp_object::opo_ooa</a>, <a class="el" href="osp__internal_8h_source.html#l00311">osp_thread_info::osi_lb2</a>, <a class="el" href="osp__object_8c_source.html#l00132">osp_dev2node()</a>, <a class="el" href="osp__internal_8h_source.html#l00409">osp_env_info()</a>, <a class="el" href="osp__object_8c_source.html#l00238">osp_oac_xattr_find()</a>, <a class="el" href="osp__object_8c_source.html#l00275">osp_oac_xattr_find_or_add()</a>, <a class="el" href="osp__object_8c_source.html#l00375">osp_oac_xattr_put()</a>, <a class="el" href="osp__object_8c_source.html#l00335">osp_oac_xattr_replace()</a>, <a class="el" href="osp__trans_8c_source.html#l00442">osp_remote_sync()</a>, <a class="el" href="osp__trans_8c_source.html#l00187">osp_update_request_create()</a>, <a class="el" href="osp__trans_8c_source.html#l00204">osp_update_request_destroy()</a>, <a class="el" href="osp__internal_8h_source.html#l00605">osp_update_rpc_pack</a>, <a class="el" href="lustre__idl_8h_source.html#l03922">object_update_reply::ourp_magic</a>, <a class="el" href="lustre__update_8h_source.html#l00037">OUT_UPDATE_REPLY_SIZE</a>, <a class="el" href="lustre__idl_8h_source.html#l03792">OUT_XATTR_GET</a>, <a class="el" href="osp__internal_8h_source.html#l00275">osp_xattr_entry::oxe_buflen</a>, <a class="el" href="osp__internal_8h_source.html#l00278">osp_xattr_entry::oxe_exist</a>, <a class="el" href="osp__internal_8h_source.html#l00276">osp_xattr_entry::oxe_namelen</a>, <a class="el" href="osp__internal_8h_source.html#l00278">osp_xattr_entry::oxe_ready</a>, <a class="el" href="osp__internal_8h_source.html#l00277">osp_xattr_entry::oxe_vallen</a>, <a class="el" href="osp__internal_8h_source.html#l00274">osp_xattr_entry::oxe_value</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="client_8c_source.html#l02490">ptlrpc_req_finished()</a>, <a class="el" href="layout_8c_source.html#l02186">req_capsule_server_sized_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="layout_8c_source.html#l01199">RMF_OUT_UPDATE_REPLY</a>, <a class="el" href="lustre__net_8h_source.html#l01121">ptlrpc_request::rq_pill</a>, <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>, <a class="el" href="lustre__idl_8h_source.html#l03919">UPDATE_REPLY_MAGIC</a>, and <a class="el" href="lustre__idl_8h_source.html#l01598">XATTR_NAME_LINK</a>.</p>

</div>
</div>
<a class="anchor" id="a6e9f34a7e74d91c77816e90c8d3002f5"></a><!-- doxytag: member="osp_internal.h::osp_xattr_set" ref="a6e9f34a7e74d91c77816e90c8d3002f5" args="(const struct lu_env *env, struct dt_object *dt, const struct lu_buf *buf, const char *name, int fl, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int osp_xattr_set </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__buf.html">lu_buf</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implement OSP layer <a class="el" href="structdt__object__operations.html#a231db7d512a5786b8ad887e9fc47190b" title="Set an extended attribute.">dt_object_operations::do_xattr_set()</a> interface. </p>
<p>Set extended attribute to the specified MDT/OST object.</p>
<p>Add an OUT_XATTR_SET sub-request into the OUT RPC that will be flushed in the transaction stop. And if the OSP attributes cache is initialized, then check whether the name extended attribute entry exists in the cache or not. If yes, replace it; otherwise, add the extended attribute to the cache.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>pointer to the thread context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dt</em>&nbsp;</td><td>pointer to the OSP layer <a class="el" href="structdt__object.html">dt_object</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>pointer to the <a class="el" href="structlu__buf.html" title="Common buffer structure to be passed around for various xattr_{s,g}et() methods.">lu_buf</a> to hold the extended attribute </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>the name of the extended attribute to be set </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fl</em>&nbsp;</td><td>to indicate the detailed set operation: LU_XATTR_CREATE or LU_XATTR_REPLACE or others </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>pointer to the transaction handler</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>for success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>error number on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l01153">1153</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="osp__internal_8h_source.html#l00477">dt2osp_obj()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="lu__object_8h_source.html#l00287">lu_device::ld_obd</a>, <a class="el" href="lu__object_8h_source.html#l00472">lu_object::lo_dev</a>, <a class="el" href="osp__internal_8h_source.html#l00443">lu2osp_dev()</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="osp__internal_8h_source.html#l00167">osp_device::opd_connect_mdt</a>, <a class="el" href="osp__internal_8h_source.html#l00301">osp_object::opo_lock</a>, <a class="el" href="osp__internal_8h_source.html#l00299">osp_object::opo_ooa</a>, <a class="el" href="osp__object_8c_source.html#l00275">osp_oac_xattr_find_or_add()</a>, <a class="el" href="osp__object_8c_source.html#l00375">osp_oac_xattr_put()</a>, <a class="el" href="osp__object_8c_source.html#l00335">osp_oac_xattr_replace()</a>, <a class="el" href="osp__internal_8h_source.html#l00605">osp_update_rpc_pack</a>, <a class="el" href="lustre__idl_8h_source.html#l03791">OUT_XATTR_SET</a>, <a class="el" href="osp__internal_8h_source.html#l00275">osp_xattr_entry::oxe_buflen</a>, <a class="el" href="osp__internal_8h_source.html#l00278">osp_xattr_entry::oxe_exist</a>, <a class="el" href="osp__internal_8h_source.html#l00276">osp_xattr_entry::oxe_namelen</a>, <a class="el" href="osp__internal_8h_source.html#l00278">osp_xattr_entry::oxe_ready</a>, <a class="el" href="osp__internal_8h_source.html#l00277">osp_xattr_entry::oxe_vallen</a>, <a class="el" href="osp__internal_8h_source.html#l00274">osp_xattr_entry::oxe_value</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="osp__internal_8h_source.html#l00368">thandle_to_osp_update_request()</a>.</p>

</div>
</div>
<a class="anchor" id="a6e6b95fc3a8c4578e0809a62c3bf52a4"></a><!-- doxytag: member="osp_internal.h::thandle_to_osp_thandle" ref="a6e6b95fc3a8c4578e0809a62c3bf52a4" args="(struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structosp__thandle.html">osp_thandle</a>* thandle_to_osp_thandle </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00362">362</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="osp__internal_8h_source.html#l00350">osp_thandle::ot_super</a>.</p>

<p>Referenced by <a class="el" href="osp__trans_8c_source.html#l01227">osp_get_storage_thandle()</a>, <a class="el" href="osp__md__object_8c_source.html#l01090">osp_md_write()</a>, <a class="el" href="osp__trans_8c_source.html#l01019">osp_request_commit_cb()</a>, <a class="el" href="osp__trans_8c_source.html#l00989">osp_trans_cb_add()</a>, <a class="el" href="osp__trans_8c_source.html#l01509">osp_trans_start()</a>, <a class="el" href="osp__trans_8c_source.html#l01542">osp_trans_stop()</a>, <a class="el" href="osp__trans_8c_source.html#l00899">osp_trans_update_request_create()</a>, and <a class="el" href="osp__internal_8h_source.html#l00368">thandle_to_osp_update_request()</a>.</p>

</div>
</div>
<a class="anchor" id="aeee11767575fd7392e89f28e7135ffe7"></a><!-- doxytag: member="osp_internal.h::thandle_to_osp_update_request" ref="aeee11767575fd7392e89f28e7135ffe7" args="(struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structosp__update__request.html">osp_update_request</a>* thandle_to_osp_update_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__internal_8h_source.html#l00368">368</a> of file <a class="el" href="osp__internal_8h_source.html">osp_internal.h</a>.</p>

<p>References <a class="el" href="osp__internal_8h_source.html#l00357">osp_thandle::ot_our</a>, and <a class="el" href="osp__internal_8h_source.html#l00362">thandle_to_osp_thandle()</a>.</p>

<p>Referenced by <a class="el" href="osp__md__object_8c_source.html#l00359">osp_md_attr_set()</a>, <a class="el" href="osp__md__object_8c_source.html#l00652">osp_md_index_delete()</a>, <a class="el" href="osp__md__object_8c_source.html#l00598">osp_md_index_insert()</a>, <a class="el" href="osp__md__object_8c_source.html#l00173">osp_md_object_create()</a>, <a class="el" href="osp__md__object_8c_source.html#l00983">osp_md_object_destroy()</a>, <a class="el" href="osp__md__object_8c_source.html#l00283">osp_md_ref_add()</a>, <a class="el" href="osp__md__object_8c_source.html#l00237">osp_md_ref_del()</a>, <a class="el" href="osp__md__object_8c_source.html#l01090">osp_md_write()</a>, <a class="el" href="osp__object_8c_source.html#l01260">osp_xattr_del()</a>, and <a class="el" href="osp__object_8c_source.html#l01153">osp_xattr_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a33acca859878cfc874cc54cdc3c33458"></a><!-- doxytag: member="osp_internal.h::update_buffer_get_update" ref="a33acca859878cfc874cc54cdc3c33458" args="(struct object_update_request *request, unsigned int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structobject__update.html">object_update</a>* update_buffer_get_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobject__update__request.html">object_update_request</a> *&nbsp;</td>
          <td class="paramname"> <em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__md__object_8c_source.html#l00141">141</a> of file <a class="el" href="osp__md__object_8c_source.html">osp_md_object.c</a>.</p>

<p>References <a class="el" href="lustre__idl_8h_source.html#l03882">object_update_size()</a>, <a class="el" href="lustre__idl_8h_source.html#l03842">object_update_request::ourq_count</a>, and <a class="el" href="lustre__idl_8h_source.html#l03844">object_update_request::ourq_updates</a>.</p>

<p>Referenced by <a class="el" href="osp__trans_8c_source.html#l00840">osp_insert_async_request()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ad5957782faa61ec74e1f98b9c2df7f87"></a><!-- doxytag: member="osp_internal.h::lwp_device_type" ref="ad5957782faa61ec74e1f98b9c2df7f87" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__device__type.html">lu_device_type</a> <a class="el" href="osp__internal_8h.html#ad5957782faa61ec74e1f98b9c2df7f87">lwp_device_type</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lwp__dev_8c_source.html#l00395">395</a> of file <a class="el" href="lwp__dev_8c_source.html">lwp_dev.c</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l01914">osp_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a70a723146dd3838700f2cf71a2f489a5"></a><!-- doxytag: member="osp_internal.h::lwp_obd_device_ops" ref="a70a723146dd3838700f2cf71a2f489a5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structobd__ops.html">obd_ops</a> <a class="el" href="osp__internal_8h.html#a70a723146dd3838700f2cf71a2f489a5">lwp_obd_device_ops</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="lwp__dev_8c_source.html#l00621">621</a> of file <a class="el" href="lwp__dev_8c_source.html">lwp_dev.c</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l01914">osp_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a037aa9290c964160d0fa3173b14e9415"></a><!-- doxytag: member="osp_internal.h::osp_dt_ops" ref="a037aa9290c964160d0fa3173b14e9415" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdt__device__operations.html">dt_device_operations</a> <a class="el" href="osp__internal_8h.html#a037aa9290c964160d0fa3173b14e9415">osp_dt_ops</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__dev_8c_source.html#l00886">886</a> of file <a class="el" href="osp__dev_8c_source.html">osp_dev.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6e0b54753466e13a043eadfebe298cfa"></a><!-- doxytag: member="osp_internal.h::osp_lu_obj_ops" ref="a6e0b54753466e13a043eadfebe298cfa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__object__operations.html">lu_object_operations</a> <a class="el" href="osp__object_8c.html#a6e0b54753466e13a043eadfebe298cfa">osp_lu_obj_ops</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__object_8c_source.html#l02257">2257</a> of file <a class="el" href="osp__object_8c_source.html">osp_object.c</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l00116">osp_object_alloc()</a>.</p>

</div>
</div>
<a class="anchor" id="a9e545f9a09277a5db32dcc53f3ae6484"></a><!-- doxytag: member="osp_internal.h::osp_lu_ops" ref="a9e545f9a09277a5db32dcc53f3ae6484" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__device__operations.html">lu_device_operations</a> <a class="el" href="osp__internal_8h.html#a9e545f9a09277a5db32dcc53f3ae6484">osp_lu_ops</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__dev_8c_source.html#l00697">697</a> of file <a class="el" href="osp__dev_8c_source.html">osp_dev.c</a>.</p>

<p>Referenced by <a class="el" href="osp__internal_8h_source.html#l00438">lu_device_is_osp()</a>.</p>

</div>
</div>
<a class="anchor" id="ab87b8d6d0e7f500b48bab8162b2f1e2f"></a><!-- doxytag: member="osp_internal.h::osp_md_body_ops" ref="ab87b8d6d0e7f500b48bab8162b2f1e2f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdt__body__operations.html">dt_body_operations</a> <a class="el" href="osp__md__object_8c.html#ab87b8d6d0e7f500b48bab8162b2f1e2f">osp_md_body_ops</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__md__object_8c_source.html#l01236">1236</a> of file <a class="el" href="osp__md__object_8c_source.html">osp_md_object.c</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l02127">osp_object_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a903290e01e7a292d2756658146333a2a"></a><!-- doxytag: member="osp_internal.h::osp_md_index_ops" ref="a903290e01e7a292d2756658146333a2a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdt__index__operations.html">dt_index_operations</a> <a class="el" href="osp__md__object_8c.html#a903290e01e7a292d2756658146333a2a">osp_md_index_ops</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__md__object_8c_source.html#l00820">820</a> of file <a class="el" href="osp__md__object_8c_source.html">osp_md_object.c</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l02083">osp_index_try()</a>.</p>

</div>
</div>
<a class="anchor" id="aee566563c307580adca54ebbe83a90ff"></a><!-- doxytag: member="osp_internal.h::osp_md_obj_ops" ref="aee566563c307580adca54ebbe83a90ff" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdt__object__operations.html">dt_object_operations</a> <a class="el" href="osp__md__object_8c.html#aee566563c307580adca54ebbe83a90ff">osp_md_obj_ops</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__md__object_8c_source.html#l01010">1010</a> of file <a class="el" href="osp__md__object_8c_source.html">osp_md_object.c</a>.</p>

<p>Referenced by <a class="el" href="osp__object_8c_source.html#l02127">osp_object_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a242e4f041ab0c6d014f218b12aec9622"></a><!-- doxytag: member="osp_internal.h::osp_mds_ost_orig_logops" ref="a242e4f041ab0c6d014f218b12aec9622" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structllog__operations.html">llog_operations</a> <a class="el" href="osp__internal_8h.html#a242e4f041ab0c6d014f218b12aec9622">osp_mds_ost_orig_logops</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__dev_8c_source.html#l01900">1900</a> of file <a class="el" href="osp__dev_8c_source.html">osp_dev.c</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l01914">osp_init()</a>, and <a class="el" href="osp__sync_8c_source.html#l01244">osp_sync_llog_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a5ba0c65d48df6137aa2c1c66354fa0e1"></a><!-- doxytag: member="osp_internal.h::osp_object_kmem" ref="a5ba0c65d48df6137aa2c1c66354fa0e1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kmem_cache* <a class="el" href="osp__internal_8h.html#a5ba0c65d48df6137aa2c1c66354fa0e1">osp_object_kmem</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__dev_8c_source.html#l00088">88</a> of file <a class="el" href="osp__dev_8c_source.html">osp_dev.c</a>.</p>

<p>Referenced by <a class="el" href="osp__dev_8c_source.html#l00116">osp_object_alloc()</a>, and <a class="el" href="osp__object_8c_source.html#l02173">osp_object_free()</a>.</p>

</div>
</div>
<a class="anchor" id="ad3c37ca09ea52b0ec6f6c77e71a8d18e"></a><!-- doxytag: member="osp_internal.h::osp_thread_key" ref="ad3c37ca09ea52b0ec6f6c77e71a8d18e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__context__key.html">lu_context_key</a> <a class="el" href="osp__internal_8h.html#ad3c37ca09ea52b0ec6f6c77e71a8d18e">osp_thread_key</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__dev_8c_source.html#l01846">1846</a> of file <a class="el" href="osp__dev_8c_source.html">osp_dev.c</a>.</p>

<p>Referenced by <a class="el" href="osp__internal_8h_source.html#l00409">osp_env_info()</a>.</p>

</div>
</div>
<a class="anchor" id="a6f9defa450c24f77e303a32d1834e142"></a><!-- doxytag: member="osp_internal.h::osp_txn_key" ref="a6f9defa450c24f77e303a32d1834e142" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__context__key.html">lu_context_key</a> <a class="el" href="osp__internal_8h.html#a6f9defa450c24f77e303a32d1834e142">osp_txn_key</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="osp__dev_8c_source.html#l01856">1856</a> of file <a class="el" href="osp__dev_8c_source.html">osp_dev.c</a>.</p>

<p>Referenced by <a class="el" href="osp__internal_8h_source.html#l00428">osp_txn_info()</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:50 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
