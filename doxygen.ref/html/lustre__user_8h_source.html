<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/include/lustre/lustre_user.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>lustre/include/lustre/lustre_user.h</h1><a href="lustre__user_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * GPL HEADER START</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> * it under the terms of the GNU General Public License version 2 only,</span>
<a name="l00008"></a>00008 <span class="comment"> * as published by the Free Software Foundation.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * This program is distributed in the hope that it will be useful, but</span>
<a name="l00011"></a>00011 <span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00013"></a>00013 <span class="comment"> * General Public License version 2 for more details (a copy is included</span>
<a name="l00014"></a>00014 <span class="comment"> * in the LICENSE file that accompanied this code).</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> * version 2 along with this program; If not, see</span>
<a name="l00018"></a>00018 <span class="comment"> * http://www.sun.com/software/products/lustre/docs/GPLv2.pdf</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * Please contact Sun Microsystems, Inc., 4150 Network Circle, Santa Clara,</span>
<a name="l00021"></a>00021 <span class="comment"> * CA 95054 USA or visit www.sun.com if you need additional information or</span>
<a name="l00022"></a>00022 <span class="comment"> * have any questions.</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * GPL HEADER END</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 <span class="comment">/*</span>
<a name="l00027"></a>00027 <span class="comment"> * Copyright (c) 2003, 2010, Oracle and/or its affiliates. All rights reserved.</span>
<a name="l00028"></a>00028 <span class="comment"> * Use is subject to license terms.</span>
<a name="l00029"></a>00029 <span class="comment"> *</span>
<a name="l00030"></a>00030 <span class="comment"> * Copyright (c) 2010, 2015, Intel Corporation.</span>
<a name="l00031"></a>00031 <span class="comment"> */</span>
<a name="l00032"></a>00032 <span class="comment">/*</span>
<a name="l00033"></a>00033 <span class="comment"> * This file is part of Lustre, http://www.lustre.org/</span>
<a name="l00034"></a>00034 <span class="comment"> * Lustre is a trademark of Sun Microsystems, Inc.</span>
<a name="l00035"></a>00035 <span class="comment"> *</span>
<a name="l00036"></a>00036 <span class="comment"> * lustre/include/lustre/lustre_user.h</span>
<a name="l00037"></a>00037 <span class="comment"> *</span>
<a name="l00038"></a>00038 <span class="comment"> * Lustre public user-space interface definitions.</span>
<a name="l00039"></a>00039 <span class="comment"> */</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="preprocessor">#ifndef _LUSTRE_USER_H</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="preprocessor">#define _LUSTRE_USER_H</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;linux/types.h&gt;</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="preprocessor">#ifdef __KERNEL__</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span><span class="preprocessor"># include &lt;linux/quota.h&gt;</span>
<a name="l00053"></a>00053 <span class="preprocessor"># include &lt;linux/string.h&gt;</span> <span class="comment">/* snprintf() */</span>
<a name="l00054"></a>00054 <span class="preprocessor"># include &lt;linux/version.h&gt;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#else </span><span class="comment">/* !__KERNEL__ */</span>
<a name="l00056"></a><a class="code" href="group__lustreuser.html#gaefccf0cf1163145f7bd0eb2b047b399d">00056</a> <span class="preprocessor"># define NEED_QUOTA_DEFS</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span><span class="preprocessor"># include &lt;limits.h&gt;</span>
<a name="l00058"></a>00058 <span class="preprocessor"># include &lt;stdbool.h&gt;</span>
<a name="l00059"></a>00059 <span class="preprocessor"># include &lt;stdio.h&gt;</span> <span class="comment">/* snprintf() */</span>
<a name="l00060"></a>00060 <span class="preprocessor"># include &lt;<a class="code" href="string_8h.html">string.h</a>&gt;</span>
<a name="l00061"></a>00061 <span class="preprocessor"># include &lt;sys/quota.h&gt;</span>
<a name="l00062"></a>00062 <span class="preprocessor"># include &lt;sys/stat.h&gt;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#endif </span><span class="comment">/* __KERNEL__ */</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &lt;<a class="code" href="ll__fiemap_8h.html">lustre/ll_fiemap.h</a>&gt;</span>
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="preprocessor">#if defined(__x86_64__) || defined(__ia64__) || defined(__ppc64__) || \</span>
<a name="l00067"></a>00067 <span class="preprocessor">    defined(__craynv) || defined(__mips64__) || defined(__powerpc64__) || \</span>
<a name="l00068"></a>00068 <span class="preprocessor">    defined(__aarch64__)</span>
<a name="l00069"></a>00069 <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keyword">struct </span>stat     lstat_t;
<a name="l00070"></a>00070 <span class="preprocessor"># define lstat_f        lstat</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span><span class="preprocessor"># define fstat_f        fstat</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span><span class="preprocessor"># define fstatat_f      fstatat</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span><span class="preprocessor"># define HAVE_LOV_USER_MDS_DATA</span>
<a name="l00074"></a>00074 <span class="preprocessor"></span><span class="preprocessor">#elif defined(__USE_LARGEFILE64) || defined(__KERNEL__)</span>
<a name="l00075"></a>00075 <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keyword">struct </span>stat64   lstat_t;
<a name="l00076"></a>00076 <span class="preprocessor"># define lstat_f        lstat64</span>
<a name="l00077"></a>00077 <span class="preprocessor"></span><span class="preprocessor"># define fstat_f        fstat64</span>
<a name="l00078"></a>00078 <span class="preprocessor"></span><span class="preprocessor"># define fstatat_f      fstatat64</span>
<a name="l00079"></a>00079 <span class="preprocessor"></span><span class="preprocessor"># define HAVE_LOV_USER_MDS_DATA</span>
<a name="l00080"></a>00080 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span>
<a name="l00082"></a><a class="code" href="group__lustreuser.html#ga3c03f05c1ef50ce4b8e8d79d1549856d">00082</a> <span class="preprocessor">#define LUSTRE_EOF 0xffffffffffffffffULL</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span>
<a name="l00084"></a>00084 <span class="comment">/* for statfs() */</span>
<a name="l00085"></a><a class="code" href="group__lustreuser.html#ga09239ea1e8cfba59f5e2fd49175b3ac1">00085</a> <span class="preprocessor">#define LL_SUPER_MAGIC 0x0BD00BD0</span>
<a name="l00086"></a>00086 <span class="preprocessor"></span>
<a name="l00087"></a>00087 <span class="preprocessor">#ifndef FSFILT_IOC_GETFLAGS</span>
<a name="l00088"></a><a class="code" href="group__lustreuser.html#ga1881732d7f95b8b54a31abbf71058180">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define FSFILT_IOC_GETFLAGS               _IOR(&apos;f&apos;, 1, long)</span>
<a name="l00089"></a><a class="code" href="group__lustreuser.html#gaa7486a6f17f785ef3957b0c098b72202">00089</a> <span class="preprocessor"></span><span class="preprocessor">#define FSFILT_IOC_SETFLAGS               _IOW(&apos;f&apos;, 2, long)</span>
<a name="l00090"></a><a class="code" href="group__lustreuser.html#ga334648c38663cacea3141e86179f91a9">00090</a> <span class="preprocessor"></span><span class="preprocessor">#define FSFILT_IOC_GETVERSION             _IOR(&apos;f&apos;, 3, long)</span>
<a name="l00091"></a><a class="code" href="group__lustreuser.html#ga733be7df2d5623113d32f3da05a45775">00091</a> <span class="preprocessor"></span><span class="preprocessor">#define FSFILT_IOC_SETVERSION             _IOW(&apos;f&apos;, 4, long)</span>
<a name="l00092"></a><a class="code" href="group__lustreuser.html#ga3efb70e419c1e9ad639ae189eda751ba">00092</a> <span class="preprocessor"></span><span class="preprocessor">#define FSFILT_IOC_GETVERSION_OLD         _IOR(&apos;v&apos;, 1, long)</span>
<a name="l00093"></a><a class="code" href="group__lustreuser.html#ga225a1ae4572b8400aa90e1b616aff9ea">00093</a> <span class="preprocessor"></span><span class="preprocessor">#define FSFILT_IOC_SETVERSION_OLD         _IOW(&apos;v&apos;, 2, long)</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span>
<a name="l00096"></a>00096 <span class="comment">/* FIEMAP flags supported by Lustre */</span>
<a name="l00097"></a><a class="code" href="group__lustreuser.html#ga68002f41b6a9a7a07d0f9ddfa1fe1b77">00097</a> <span class="preprocessor">#define LUSTRE_FIEMAP_FLAGS_COMPAT (FIEMAP_FLAG_SYNC | FIEMAP_FLAG_DEVICE_ORDER)</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>
<a name="l00099"></a><a class="code" href="group__lustreuser.html#ga7467b60f98d563a0c6c162997d99a3a1">00099</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga7467b60f98d563a0c6c162997d99a3a1">obd_statfs_state</a> {
<a name="l00100"></a><a class="code" href="group__lustreuser.html#gga7467b60f98d563a0c6c162997d99a3a1a65c699b6ea1410e38fa933969eaa77bb">00100</a>         <a class="code" href="group__lustreuser.html#gga7467b60f98d563a0c6c162997d99a3a1a65c699b6ea1410e38fa933969eaa77bb" title="RAID degraded/rebuilding.">OS_STATE_DEGRADED</a>       = 0x00000001, 
<a name="l00101"></a><a class="code" href="group__lustreuser.html#gga7467b60f98d563a0c6c162997d99a3a1ae451336697a9457d223941d2abfeefa1">00101</a>         <a class="code" href="group__lustreuser.html#gga7467b60f98d563a0c6c162997d99a3a1ae451336697a9457d223941d2abfeefa1" title="filesystem is read-only">OS_STATE_READONLY</a>       = 0x00000002, 
<a name="l00102"></a><a class="code" href="group__lustreuser.html#gga7467b60f98d563a0c6c162997d99a3a1a7a0ed478d5c7764dfa29aee2e8e620c0">00102</a>         <a class="code" href="group__lustreuser.html#gga7467b60f98d563a0c6c162997d99a3a1a7a0ed478d5c7764dfa29aee2e8e620c0" title="obsolete 1.6, was EROFS=30">OS_STATE_RDONLY_1</a>       = 0x00000004, 
<a name="l00103"></a><a class="code" href="group__lustreuser.html#gga7467b60f98d563a0c6c162997d99a3a1afed4afbfcc8a4d2c549466a9d6b24281">00103</a>         <a class="code" href="group__lustreuser.html#gga7467b60f98d563a0c6c162997d99a3a1afed4afbfcc8a4d2c549466a9d6b24281" title="obsolete 1.6, was EROFS=30">OS_STATE_RDONLY_2</a>       = 0x00000008, 
<a name="l00104"></a><a class="code" href="group__lustreuser.html#gga7467b60f98d563a0c6c162997d99a3a1af29a1f2ec400fde7140430860984ba9f">00104</a>         <a class="code" href="group__lustreuser.html#gga7467b60f98d563a0c6c162997d99a3a1af29a1f2ec400fde7140430860984ba9f" title="obsolete 1.6, was EROFS=30">OS_STATE_RDONLY_3</a>       = 0x00000010, 
<a name="l00105"></a>00105 };
<a name="l00106"></a>00106 
<a name="l00107"></a><a class="code" href="structobd__statfs.html">00107</a> <span class="keyword">struct </span><a class="code" href="structobd__statfs.html">obd_statfs</a> {
<a name="l00108"></a><a class="code" href="structobd__statfs.html#aa36511a41f5d57c481bc24551a1f0f08">00108</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structobd__statfs.html#aa36511a41f5d57c481bc24551a1f0f08">os_type</a>;
<a name="l00109"></a><a class="code" href="structobd__statfs.html#a215b3668739be30efec2bd7f19fbb0c7">00109</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structobd__statfs.html#a215b3668739be30efec2bd7f19fbb0c7">os_blocks</a>;
<a name="l00110"></a><a class="code" href="structobd__statfs.html#a49eece096fcec171e80fff33bd629487">00110</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structobd__statfs.html#a49eece096fcec171e80fff33bd629487">os_bfree</a>;
<a name="l00111"></a><a class="code" href="structobd__statfs.html#a7f951cad5548622404e7f191ee03c833">00111</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structobd__statfs.html#a7f951cad5548622404e7f191ee03c833">os_bavail</a>;
<a name="l00112"></a><a class="code" href="structobd__statfs.html#a587a46e0db7f8e9f0da22f11bd7ae708">00112</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structobd__statfs.html#a587a46e0db7f8e9f0da22f11bd7ae708">os_files</a>;
<a name="l00113"></a><a class="code" href="structobd__statfs.html#a36dd2709d23604535cf66c5e26ee0520">00113</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structobd__statfs.html#a36dd2709d23604535cf66c5e26ee0520">os_ffree</a>;
<a name="l00114"></a><a class="code" href="structobd__statfs.html#a741141dc41027984b10ea83370ee6e54">00114</a>         __u8            <a class="code" href="structobd__statfs.html#a741141dc41027984b10ea83370ee6e54">os_fsid</a>[40];
<a name="l00115"></a><a class="code" href="structobd__statfs.html#a76344faa86ca38a0c85c321f252cc0c3">00115</a>         __u32           <a class="code" href="structobd__statfs.html#a76344faa86ca38a0c85c321f252cc0c3">os_bsize</a>;
<a name="l00116"></a><a class="code" href="structobd__statfs.html#a89590ccf87540d046c7156cd30c799a6">00116</a>         __u32           <a class="code" href="structobd__statfs.html#a89590ccf87540d046c7156cd30c799a6">os_namelen</a>;
<a name="l00117"></a><a class="code" href="structobd__statfs.html#a7983422f0e0484d5c00051699da040b7">00117</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structobd__statfs.html#a7983422f0e0484d5c00051699da040b7">os_maxbytes</a>;
<a name="l00118"></a><a class="code" href="structobd__statfs.html#ae4a21d5d37c353b564d8aacba5c00320">00118</a>         __u32           <a class="code" href="structobd__statfs.html#ae4a21d5d37c353b564d8aacba5c00320" title="obd_statfs_state OS_STATE_* flag">os_state</a>;       
<a name="l00119"></a><a class="code" href="structobd__statfs.html#a5f5549ee5c1ef98c2b5fa9673cef2565">00119</a>         __u32           <a class="code" href="structobd__statfs.html#a5f5549ee5c1ef98c2b5fa9673cef2565">os_fprecreated</a>; <span class="comment">/* objs available now to the caller */</span>
<a name="l00120"></a>00120                                         <span class="comment">/* used in QoS code to find preferred</span>
<a name="l00121"></a>00121 <span class="comment">                                         * OSTs */</span>
<a name="l00122"></a><a class="code" href="structobd__statfs.html#a3d7be630c3799512fc5d94ee9ff5510f">00122</a>         __u32           <a class="code" href="structobd__statfs.html#a3d7be630c3799512fc5d94ee9ff5510f">os_spare2</a>;
<a name="l00123"></a><a class="code" href="structobd__statfs.html#a591310793fe2ef62616630fd12230262">00123</a>         __u32           <a class="code" href="structobd__statfs.html#a591310793fe2ef62616630fd12230262">os_spare3</a>;
<a name="l00124"></a><a class="code" href="structobd__statfs.html#aa1c373a2fb76fa173d7639daf075807b">00124</a>         __u32           <a class="code" href="structobd__statfs.html#aa1c373a2fb76fa173d7639daf075807b">os_spare4</a>;
<a name="l00125"></a><a class="code" href="structobd__statfs.html#aad4d8273bb25951376228c62253c18d7">00125</a>         __u32           <a class="code" href="structobd__statfs.html#aad4d8273bb25951376228c62253c18d7">os_spare5</a>;
<a name="l00126"></a><a class="code" href="structobd__statfs.html#abcb3205c72c38346ed81b688c101aac8">00126</a>         __u32           <a class="code" href="structobd__statfs.html#abcb3205c72c38346ed81b688c101aac8">os_spare6</a>;
<a name="l00127"></a><a class="code" href="structobd__statfs.html#a510d5c3e1e5211294c9ac607cfb5e208">00127</a>         __u32           <a class="code" href="structobd__statfs.html#a510d5c3e1e5211294c9ac607cfb5e208">os_spare7</a>;
<a name="l00128"></a><a class="code" href="structobd__statfs.html#aab42ed3f5b4c5f3440ac2e30d548976e">00128</a>         __u32           <a class="code" href="structobd__statfs.html#aab42ed3f5b4c5f3440ac2e30d548976e">os_spare8</a>;
<a name="l00129"></a><a class="code" href="structobd__statfs.html#a84553f76098bb5b9fc4592fcdd44328e">00129</a>         __u32           <a class="code" href="structobd__statfs.html#a84553f76098bb5b9fc4592fcdd44328e">os_spare9</a>;
<a name="l00130"></a>00130 };
<a name="l00131"></a>00131 
<a name="l00138"></a><a class="code" href="structlu__fid.html">00138</a> <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> {
<a name="l00145"></a><a class="code" href="structlu__fid.html#a05477e45a42f0e5ae1b438c2d9e6cf30">00145</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structlu__fid.html#a05477e45a42f0e5ae1b438c2d9e6cf30" title="FID sequence.">f_seq</a>;
<a name="l00146"></a>00146         <span class="comment">/* FID number within sequence. */</span>
<a name="l00147"></a><a class="code" href="structlu__fid.html#a48aec36397824074ed1624b09edef75a">00147</a>         __u32 <a class="code" href="structlu__fid.html#a48aec36397824074ed1624b09edef75a">f_oid</a>;
<a name="l00153"></a><a class="code" href="structlu__fid.html#af6a6857838bb5594da2fe4101985242d">00153</a>         __u32 <a class="code" href="structlu__fid.html#af6a6857838bb5594da2fe4101985242d" title="FID version, used to distinguish different versions (in the sense of snapshots, etc...">f_ver</a>;
<a name="l00154"></a>00154 };
<a name="l00155"></a>00155 
<a name="l00156"></a><a class="code" href="group__lustreuser.html#ga2c265e188b56db802b9a4ca3b1deb9a9">00156</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="group__lustreuser.html#ga2c265e188b56db802b9a4ca3b1deb9a9">fid_is_zero</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> *fid)
<a name="l00157"></a>00157 {
<a name="l00158"></a>00158         <span class="keywordflow">return</span> fid-&gt;<a class="code" href="structlu__fid.html#a05477e45a42f0e5ae1b438c2d9e6cf30" title="FID sequence.">f_seq</a> == 0 &amp;&amp; fid-&gt;<a class="code" href="structlu__fid.html#a48aec36397824074ed1624b09edef75a">f_oid</a> == 0;
<a name="l00159"></a>00159 }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 <span class="comment">/* Currently, the filter_fid::ff_parent::f_ver is not the real parent</span>
<a name="l00162"></a>00162 <span class="comment"> * MDT-object&apos;s FID::f_ver, instead it is the OST-object index in its</span>
<a name="l00163"></a>00163 <span class="comment"> * parent MDT-object&apos;s layout EA. */</span>
<a name="l00164"></a><a class="code" href="group__lustreuser.html#ga2e52765a975597afaee39eedd50e8679">00164</a> <span class="preprocessor">#define f_stripe_idx f_ver</span>
<a name="l00165"></a>00165 <span class="preprocessor"></span>
<a name="l00166"></a><a class="code" href="structfilter__fid.html">00166</a> <span class="keyword">struct </span><a class="code" href="structfilter__fid.html">filter_fid</a> {
<a name="l00167"></a><a class="code" href="structfilter__fid.html#a1fd134cc67456da4e82aeee8749ab0f6">00167</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>   <a class="code" href="structfilter__fid.html#a1fd134cc67456da4e82aeee8749ab0f6">ff_parent</a>;  <span class="comment">/* ff_parent.f_ver == file stripe number */</span>
<a name="l00168"></a>00168 };
<a name="l00169"></a>00169 
<a name="l00170"></a>00170 <span class="comment">/* keep this one for compatibility */</span>
<a name="l00171"></a><a class="code" href="structfilter__fid__old.html">00171</a> <span class="keyword">struct </span><a class="code" href="structfilter__fid__old.html">filter_fid_old</a> {
<a name="l00172"></a><a class="code" href="structfilter__fid__old.html#adb3c21250299fcdfd1dfb55eb0f8a42f">00172</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>   <a class="code" href="structfilter__fid__old.html#adb3c21250299fcdfd1dfb55eb0f8a42f">ff_parent</a>;
<a name="l00173"></a><a class="code" href="structfilter__fid__old.html#a7416e6acd350136e202ba14164c47216">00173</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structfilter__fid__old.html#a7416e6acd350136e202ba14164c47216">ff_objid</a>;
<a name="l00174"></a><a class="code" href="structfilter__fid__old.html#a20eb5aea999fc57bc0a2e0331c5d90c4">00174</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structfilter__fid__old.html#a20eb5aea999fc57bc0a2e0331c5d90c4">ff_seq</a>;
<a name="l00175"></a>00175 };
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="comment">/* Userspace should treat lu_fid as opaque, and only use the following methods</span>
<a name="l00178"></a>00178 <span class="comment"> * to print or parse them.  Other functions (e.g. compare, swab) could be moved</span>
<a name="l00179"></a>00179 <span class="comment"> * here from lustre_idl.h if needed. */</span>
<a name="l00180"></a><a class="code" href="group__lustreuser.html#ga370324eb251d0f79e6190149f94a8262">00180</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> <a class="code" href="structlu__fid.html" title="File IDentifier.">lustre_fid</a>;
<a name="l00181"></a>00181 
<a name="l00187"></a><a class="code" href="structlustre__mdt__attrs.html">00187</a> <span class="keyword">struct </span><a class="code" href="structlustre__mdt__attrs.html" title="Following struct for object attributes, that will be kept inode&amp;#39;s EA.">lustre_mdt_attrs</a> {
<a name="l00192"></a><a class="code" href="structlustre__mdt__attrs.html#aa26d844b21ea7bce00d881a1c62e3b63">00192</a>         __u32   <a class="code" href="group__lu__fid.html#ga081d8a344dc74bcb57c19b9f45ddb7c0" title="Flags for lustre_mdt_attrs::lma_compat and lustre_mdt_attrs::lma_incompat.">lma_compat</a>;
<a name="l00198"></a><a class="code" href="structlustre__mdt__attrs.html#a03ad38a2c00c68d8ef439d38cf4eaffa">00198</a>         __u32   <a class="code" href="group__lu__fid.html#ga5c86b0d816a99aa2ef2c9f6f41d4f893" title="Masks for all features that should be supported by a Lustre version to access a specific...">lma_incompat</a>;
<a name="l00200"></a><a class="code" href="structlustre__mdt__attrs.html#ac29b9ec344e2f1a5ec3d9a303057c3f2">00200</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>  <a class="code" href="structlustre__mdt__attrs.html#ac29b9ec344e2f1a5ec3d9a303057c3f2" title="FID of this inode.">lma_self_fid</a>;
<a name="l00201"></a>00201 };
<a name="l00202"></a>00202 
<a name="l00208"></a><a class="code" href="group__lustreuser.html#gaae2dd0d15d4ca9d9d9c3980978ba03df">00208</a> <span class="preprocessor">#define LMA_OLD_SIZE (sizeof(struct lustre_mdt_attrs) + 5 * sizeof(__u64))</span>
<a name="l00209"></a>00209 <span class="preprocessor"></span>
<a name="l00213"></a><a class="code" href="structost__id.html">00213</a> <span class="keyword">struct </span><a class="code" href="structost__id.html" title="OST object IDentifier.">ost_id</a> {
<a name="l00214"></a>00214         <span class="keyword">union </span>{
<a name="l00215"></a>00215                 <span class="keyword">struct </span>{
<a name="l00216"></a><a class="code" href="structost__id.html#ae8b247f388bc1548ad307f8b77b9aeae">00216</a>                         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structost__id.html#ae8b247f388bc1548ad307f8b77b9aeae">oi_id</a>;
<a name="l00217"></a><a class="code" href="structost__id.html#ad29b41117f988ea36c7ebd149c408456">00217</a>                         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structost__id.html#ad29b41117f988ea36c7ebd149c408456">oi_seq</a>;
<a name="l00218"></a>00218                 } <a class="code" href="structost__id.html#a01d44bff8859d8cd3aabe8a4b0c2ee46">oi</a>;
<a name="l00219"></a><a class="code" href="structost__id.html#a04d4b2f6051e3ca320a852cbac7aaeda">00219</a>                 <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a> <a class="code" href="structost__id.html#a04d4b2f6051e3ca320a852cbac7aaeda">oi_fid</a>;
<a name="l00220"></a>00220         };
<a name="l00221"></a>00221 };
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="group__lustreuser.html#gac64b04c9d195f0918fc22b881d2260e5">00223</a> <span class="preprocessor">#define DOSTID &quot;%#llx:%llu&quot;</span>
<a name="l00224"></a><a class="code" href="group__lustreuser.html#gad3b44cf710fe39c4adc4ae65a2a98543">00224</a> <span class="preprocessor"></span><span class="preprocessor">#define POSTID(oi) ((unsigned long long)ostid_seq(oi)), \</span>
<a name="l00225"></a>00225 <span class="preprocessor">                   ((unsigned long long)ostid_id(oi))</span>
<a name="l00226"></a>00226 <span class="preprocessor"></span>
<a name="l00227"></a><a class="code" href="structll__futimes__3.html">00227</a> <span class="keyword">struct </span><a class="code" href="structll__futimes__3.html">ll_futimes_3</a> {
<a name="l00228"></a><a class="code" href="structll__futimes__3.html#ab45ebc79701f864843fec07a71d7c99d">00228</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structll__futimes__3.html#ab45ebc79701f864843fec07a71d7c99d">lfu_atime_sec</a>;
<a name="l00229"></a><a class="code" href="structll__futimes__3.html#a23d6f0381856bda5317475aa7e81b219">00229</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structll__futimes__3.html#a23d6f0381856bda5317475aa7e81b219">lfu_atime_nsec</a>;
<a name="l00230"></a><a class="code" href="structll__futimes__3.html#ab9b9df739457e616795f5aaec0bad3e7">00230</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structll__futimes__3.html#ab9b9df739457e616795f5aaec0bad3e7">lfu_mtime_sec</a>;
<a name="l00231"></a><a class="code" href="structll__futimes__3.html#a9b576370f7b457949d56edbc88f684ce">00231</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structll__futimes__3.html#a9b576370f7b457949d56edbc88f684ce">lfu_mtime_nsec</a>;
<a name="l00232"></a><a class="code" href="structll__futimes__3.html#a1ddbda33bfb032ecd0390ff6b016712e">00232</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structll__futimes__3.html#a1ddbda33bfb032ecd0390ff6b016712e">lfu_ctime_sec</a>;
<a name="l00233"></a><a class="code" href="structll__futimes__3.html#a5ee432c57ea32fa3a11dc52339bda980">00233</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structll__futimes__3.html#a5ee432c57ea32fa3a11dc52339bda980">lfu_ctime_nsec</a>;
<a name="l00234"></a>00234 };
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 <span class="comment">/*</span>
<a name="l00237"></a>00237 <span class="comment"> * The ioctl naming rules:</span>
<a name="l00238"></a>00238 <span class="comment"> * LL_*     - works on the currently opened filehandle instead of parent dir</span>
<a name="l00239"></a>00239 <span class="comment"> * *_OBD_*  - gets data for both OSC or MDC (LOV, LMV indirectly)</span>
<a name="l00240"></a>00240 <span class="comment"> * *_MDC_*  - gets/sets data related to MDC</span>
<a name="l00241"></a>00241 <span class="comment"> * *_LOV_*  - gets/sets data related to OSC/LOV</span>
<a name="l00242"></a>00242 <span class="comment"> * *FILE*   - called on parent dir and passes in a filename</span>
<a name="l00243"></a>00243 <span class="comment"> * *STRIPE* - set/get lov_user_md</span>
<a name="l00244"></a>00244 <span class="comment"> * *INFO    - set/get lov_user_mds_data</span>
<a name="l00245"></a>00245 <span class="comment"> */</span>
<a name="l00246"></a>00246 <span class="comment">/*      lustre_ioctl.h                  101-150 */</span>
<a name="l00247"></a><a class="code" href="group__lustreuser.html#gaf33fa9ffd98c929e14f0f99de20b4dd4">00247</a> <span class="preprocessor">#define LL_IOC_GETFLAGS                 _IOR (&apos;f&apos;, 151, long)</span>
<a name="l00248"></a><a class="code" href="group__lustreuser.html#gacc81906f530de53d8722811728f31900">00248</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_SETFLAGS                 _IOW (&apos;f&apos;, 152, long)</span>
<a name="l00249"></a><a class="code" href="group__lustreuser.html#ga32a652e0e49483c913d881e83c688305">00249</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_CLRFLAGS                 _IOW (&apos;f&apos;, 153, long)</span>
<a name="l00250"></a><a class="code" href="group__lustreuser.html#gab724fa1870e1b5e3a4fc01fbd75f169c">00250</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_LOV_SETSTRIPE            _IOW (&apos;f&apos;, 154, long)</span>
<a name="l00251"></a><a class="code" href="group__lustreuser.html#ga81a1c1ad7c7ad33cb8c58c2c4f75fc75">00251</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_LOV_GETSTRIPE            _IOW (&apos;f&apos;, 155, long)</span>
<a name="l00252"></a><a class="code" href="group__lustreuser.html#gab2ef8a42c630850e9b6e54736122876e">00252</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_LOV_SETEA                _IOW (&apos;f&apos;, 156, long)</span>
<a name="l00253"></a>00253 <span class="preprocessor"></span><span class="comment">/*      LL_IOC_RECREATE_OBJ             157 obsolete */</span>
<a name="l00254"></a>00254 <span class="comment">/*      LL_IOC_RECREATE_FID             157 obsolete */</span>
<a name="l00255"></a><a class="code" href="group__lustreuser.html#ga5adc50139bc0f79a03a01980175714df">00255</a> <span class="preprocessor">#define LL_IOC_GROUP_LOCK               _IOW (&apos;f&apos;, 158, long)</span>
<a name="l00256"></a><a class="code" href="group__lustreuser.html#gaed637901f3d95c07962b49ecc0a0e002">00256</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_GROUP_UNLOCK             _IOW (&apos;f&apos;, 159, long)</span>
<a name="l00257"></a>00257 <span class="preprocessor"></span><span class="comment">/*      LL_IOC_QUOTACHECK               160 OBD_IOC_QUOTACHECK */</span>
<a name="l00258"></a>00258 <span class="comment">/*      LL_IOC_POLL_QUOTACHECK          161 OBD_IOC_POLL_QUOTACHECK */</span>
<a name="l00259"></a>00259 <span class="comment">/*      LL_IOC_QUOTACTL                 162 OBD_IOC_QUOTACTL */</span>
<a name="l00260"></a><a class="code" href="group__lustreuser.html#ga1ecdfaccbc2208f6123c288f87506957">00260</a> <span class="preprocessor">#define IOC_OBD_STATFS                  _IOWR(&apos;f&apos;, 164, struct obd_statfs *)</span>
<a name="l00261"></a>00261 <span class="preprocessor"></span><span class="comment">/*      IOC_LOV_GETINFO                 165 obsolete */</span>
<a name="l00262"></a><a class="code" href="group__lustreuser.html#ga7567e209abe40fd6e669c77d9a2061ba">00262</a> <span class="preprocessor">#define LL_IOC_FLUSHCTX                 _IOW (&apos;f&apos;, 166, long)</span>
<a name="l00263"></a><a class="code" href="group__lustreuser.html#ga7f6ef764eb1bb9df30abcf6417bf4aba">00263</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_RMTACL                   _IOW (&apos;f&apos;, 167, long)</span>
<a name="l00264"></a><a class="code" href="group__lustreuser.html#ga9b8de336ce92a6f6e02be37e5392aa34">00264</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_GETOBDCOUNT              _IOR (&apos;f&apos;, 168, long)</span>
<a name="l00265"></a><a class="code" href="group__lustreuser.html#gaee3949a0ef858d301359e7791e26edc5">00265</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_LLOOP_ATTACH             _IOWR(&apos;f&apos;, 169, long)</span>
<a name="l00266"></a><a class="code" href="group__lustreuser.html#ga06bf4576cb5d984ef16f69524ee482a8">00266</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_LLOOP_DETACH             _IOWR(&apos;f&apos;, 170, long)</span>
<a name="l00267"></a><a class="code" href="group__lustreuser.html#ga4c77be9508112c24f517a69f682a4733">00267</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_LLOOP_INFO               _IOWR(&apos;f&apos;, 171, struct lu_fid)</span>
<a name="l00268"></a><a class="code" href="group__lustreuser.html#ga4f71ba320ef7bd3a7e82293dc4eceb4a">00268</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_LLOOP_DETACH_BYDEV       _IOWR(&apos;f&apos;, 172, long)</span>
<a name="l00269"></a><a class="code" href="group__lustreuser.html#ga3a6a4569be08ad0a88418468a05803b4">00269</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_PATH2FID                 _IOR (&apos;f&apos;, 173, long)</span>
<a name="l00270"></a><a class="code" href="group__lustreuser.html#ga0821403b815b8b2948569411cd4381fe">00270</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_GET_CONNECT_FLAGS        _IOWR(&apos;f&apos;, 174, __u64 *)</span>
<a name="l00271"></a><a class="code" href="group__lustreuser.html#ga038e4addc31697e634d2de3250428119">00271</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_GET_MDTIDX               _IOR (&apos;f&apos;, 175, int)</span>
<a name="l00272"></a><a class="code" href="group__lustreuser.html#ga28dc709aeef3d203a112ab4f869fb9f5">00272</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_FUTIMES_3                _IOWR(&apos;f&apos;, 176, struct ll_futimes_3)</span>
<a name="l00273"></a>00273 <span class="preprocessor"></span><span class="comment">/*      lustre_ioctl.h                  177-210 */</span>
<a name="l00274"></a><a class="code" href="group__lustreuser.html#ga085f62ea76a23fff64ed4779b9cda006">00274</a> <span class="preprocessor">#define LL_IOC_HSM_STATE_GET            _IOR(&apos;f&apos;, 211, struct hsm_user_state)</span>
<a name="l00275"></a><a class="code" href="group__lustreuser.html#gac96938d69752fa18298c500bc10bc6bf">00275</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_HSM_STATE_SET            _IOW(&apos;f&apos;, 212, struct hsm_state_set)</span>
<a name="l00276"></a><a class="code" href="group__lustreuser.html#ga6da855b1bed19001e476418bb1ed37e3">00276</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_HSM_CT_START             _IOW(&apos;f&apos;, 213, struct lustre_kernelcomm)</span>
<a name="l00277"></a><a class="code" href="group__lustreuser.html#gaab474bacda7c219e8afec2ec36e9765c">00277</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_HSM_COPY_START           _IOW(&apos;f&apos;, 214, struct hsm_copy *)</span>
<a name="l00278"></a><a class="code" href="group__lustreuser.html#gabf2ed85d41871dcdbc68b2fce6465b62">00278</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_HSM_COPY_END             _IOW(&apos;f&apos;, 215, struct hsm_copy *)</span>
<a name="l00279"></a><a class="code" href="group__lustreuser.html#ga648311d4a24732ac88f12028ef3d59f2">00279</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_HSM_PROGRESS             _IOW(&apos;f&apos;, 216, struct hsm_user_request)</span>
<a name="l00280"></a><a class="code" href="group__lustreuser.html#ga57e475b2b81c00601922387a52fd5ab6">00280</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_HSM_REQUEST              _IOW(&apos;f&apos;, 217, struct hsm_user_request)</span>
<a name="l00281"></a><a class="code" href="group__lustreuser.html#ga334c151c20858182e4d783435934d1bd">00281</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_DATA_VERSION             _IOR(&apos;f&apos;, 218, struct ioc_data_version)</span>
<a name="l00282"></a><a class="code" href="group__lustreuser.html#gacf373a2adf6de6b69e31c2ef01a69618">00282</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_LOV_SWAP_LAYOUTS         _IOW(&apos;f&apos;, 219, \</span>
<a name="l00283"></a>00283 <span class="preprocessor">                                                struct lustre_swap_layouts)</span>
<a name="l00284"></a><a class="code" href="group__lustreuser.html#ga3a2760967ebf8f4a2cf0c769b7ca57ce">00284</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_HSM_ACTION               _IOR(&apos;f&apos;, 220, \</span>
<a name="l00285"></a>00285 <span class="preprocessor">                                                struct hsm_current_action)</span>
<a name="l00286"></a>00286 <span class="preprocessor"></span><span class="comment">/*      lustre_ioctl.h                  221-232 */</span>
<a name="l00287"></a><a class="code" href="group__lustreuser.html#gae9554783040494e52200b121a886a19a">00287</a> <span class="preprocessor">#define LL_IOC_LMV_SETSTRIPE            _IOWR(&apos;f&apos;, 240, struct lmv_user_md)</span>
<a name="l00288"></a><a class="code" href="group__lustreuser.html#gaf64d63f95f2380fa334e401cade8c6d5">00288</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_LMV_GETSTRIPE            _IOWR(&apos;f&apos;, 241, struct lmv_user_md)</span>
<a name="l00289"></a><a class="code" href="group__lustreuser.html#gafa315858f45a62dc2c713342f995435e">00289</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_REMOVE_ENTRY             _IOWR(&apos;f&apos;, 242, __u64)</span>
<a name="l00290"></a><a class="code" href="group__lustreuser.html#ga69f2913aea10806c067a02e5beddda0a">00290</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_SET_LEASE                _IOWR(&apos;f&apos;, 243, long)</span>
<a name="l00291"></a><a class="code" href="group__lustreuser.html#gaf5e439992d08f21f9cf5219bde2db46b">00291</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_GET_LEASE                _IO(&apos;f&apos;, 244)</span>
<a name="l00292"></a><a class="code" href="group__lustreuser.html#gaf912821a2828ef22bb78f6f7f3f726fc">00292</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_HSM_IMPORT               _IOWR(&apos;f&apos;, 245, struct hsm_user_import)</span>
<a name="l00293"></a><a class="code" href="group__lustreuser.html#ga8c33c067ba7a94e37d291e430e84168c">00293</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_LMV_SET_DEFAULT_STRIPE   _IOWR(&apos;f&apos;, 246, struct lmv_user_md)</span>
<a name="l00294"></a><a class="code" href="group__lustreuser.html#ga7ab53a7d2b7b5216174a43c2b334d8e6">00294</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_MIGRATE                  _IOR(&apos;f&apos;, 247, int)</span>
<a name="l00295"></a><a class="code" href="group__lustreuser.html#ga30829a8740b399b5ce9083d1204bb54b">00295</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_FID2MDTIDX               _IOWR(&apos;f&apos;, 248, struct lu_fid)</span>
<a name="l00296"></a><a class="code" href="group__lustreuser.html#gaa91a1065513e7123881eb0bdd2fb0c67">00296</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_GETPARENT                _IOWR(&apos;f&apos;, 249, struct getparent)</span>
<a name="l00297"></a><a class="code" href="group__lustreuser.html#ga298e62b46e3aebf24bd7d6d6414ed563">00297</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_LADVISE                  _IOR(&apos;f&apos;, 250, struct lu_ladvise)</span>
<a name="l00298"></a>00298 <span class="preprocessor"></span>
<a name="l00299"></a>00299 <span class="comment">/* Lease types for use as arg and return of LL_IOC_{GET,SET}_LEASE ioctl. */</span>
<a name="l00300"></a><a class="code" href="group__lustreuser.html#ga068949e45e7c3eb1086bd5ab73f8df30">00300</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga068949e45e7c3eb1086bd5ab73f8df30">ll_lease_type</a> {
<a name="l00301"></a><a class="code" href="group__lustreuser.html#gga068949e45e7c3eb1086bd5ab73f8df30ae1b29c73b39cd4a4b1b6501640457a0b">00301</a>         <a class="code" href="group__lustreuser.html#gga068949e45e7c3eb1086bd5ab73f8df30ae1b29c73b39cd4a4b1b6501640457a0b">LL_LEASE_RDLCK</a>  = 0x1,
<a name="l00302"></a><a class="code" href="group__lustreuser.html#gga068949e45e7c3eb1086bd5ab73f8df30af044bb775ffd44a3381cda8dea49305f">00302</a>         <a class="code" href="group__lustreuser.html#gga068949e45e7c3eb1086bd5ab73f8df30af044bb775ffd44a3381cda8dea49305f">LL_LEASE_WRLCK</a>  = 0x2,
<a name="l00303"></a><a class="code" href="group__lustreuser.html#gga068949e45e7c3eb1086bd5ab73f8df30a2ecdabbbc9e6fc8ea4de59388a90b608">00303</a>         <a class="code" href="group__lustreuser.html#gga068949e45e7c3eb1086bd5ab73f8df30a2ecdabbbc9e6fc8ea4de59388a90b608">LL_LEASE_UNLCK</a>  = 0x4,
<a name="l00304"></a>00304 };
<a name="l00305"></a>00305 
<a name="l00306"></a><a class="code" href="group__lustreuser.html#ga0d028c2d82f2917647a461f6977107ff">00306</a> <span class="preprocessor">#define LL_STATFS_LMV           1</span>
<a name="l00307"></a><a class="code" href="group__lustreuser.html#gad5a4894cdb6347c7f0b21fe2a399b57e">00307</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_STATFS_LOV           2</span>
<a name="l00308"></a><a class="code" href="group__lustreuser.html#ga8fb28221ecf520b03a7b96fd4fdd8014">00308</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_STATFS_NODELAY       4</span>
<a name="l00309"></a>00309 <span class="preprocessor"></span>
<a name="l00310"></a><a class="code" href="group__lustreuser.html#ga769b7ef47edc4977e53dfb1b5fdc8fe5">00310</a> <span class="preprocessor">#define IOC_MDC_TYPE            &apos;i&apos;</span>
<a name="l00311"></a><a class="code" href="group__lustreuser.html#gac5f478b569e5121d04886f0a589c272c">00311</a> <span class="preprocessor"></span><span class="preprocessor">#define IOC_MDC_LOOKUP          _IOWR(IOC_MDC_TYPE, 20, struct obd_device *)</span>
<a name="l00312"></a><a class="code" href="group__lustreuser.html#ga680fa68f53dae28487131770cf867c5d">00312</a> <span class="preprocessor"></span><span class="preprocessor">#define IOC_MDC_GETFILESTRIPE   _IOWR(IOC_MDC_TYPE, 21, struct lov_user_md *)</span>
<a name="l00313"></a><a class="code" href="group__lustreuser.html#gaa08ea9606d428fcafb1a8766cdb12877">00313</a> <span class="preprocessor"></span><span class="preprocessor">#define IOC_MDC_GETFILEINFO     _IOWR(IOC_MDC_TYPE, 22, struct lov_user_mds_data *)</span>
<a name="l00314"></a><a class="code" href="group__lustreuser.html#gab795d25e5bc30503745f7eb0e4d9a8f2">00314</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_IOC_MDC_GETINFO      _IOWR(IOC_MDC_TYPE, 23, struct lov_user_mds_data *)</span>
<a name="l00315"></a>00315 <span class="preprocessor"></span>
<a name="l00316"></a><a class="code" href="group__lustreuser.html#ga2cfdb7b2e5cc0eb8ff2ec1ea952f2b3e">00316</a> <span class="preprocessor">#define MAX_OBD_NAME 128 </span><span class="comment">/* If this changes, a NEW ioctl must be added */</span>
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 <span class="comment">/* Define O_LOV_DELAY_CREATE to be a mask that is not useful for regular</span>
<a name="l00319"></a>00319 <span class="comment"> * files, but are unlikely to be used in practice and are not harmful if</span>
<a name="l00320"></a>00320 <span class="comment"> * used incorrectly.  O_NOCTTY and FASYNC are only meaningful for character</span>
<a name="l00321"></a>00321 <span class="comment"> * devices and are safe for use on new files. See LU-4209. */</span>
<a name="l00322"></a>00322 <span class="comment">/* To be compatible with old statically linked binary we keep the check for</span>
<a name="l00323"></a>00323 <span class="comment"> * the older 0100000000 flag.  This is already removed upstream.  LU-812. */</span>
<a name="l00324"></a><a class="code" href="group__lustreuser.html#ga4daf43586f2f38f5f2a01b7b39e18eb0">00324</a> <span class="preprocessor">#define O_LOV_DELAY_CREATE_1_8  0100000000 </span><span class="comment">/* FMODE_NONOTIFY masked in 2.6.36 */</span>
<a name="l00325"></a><a class="code" href="group__lustreuser.html#ga147f166a4897818ae1a5725707667ef9">00325</a> <span class="preprocessor">#define O_LOV_DELAY_CREATE_MASK (O_NOCTTY | FASYNC)</span>
<a name="l00326"></a><a class="code" href="group__lustreuser.html#ga38062fec6207df6024847bb4c8cb5198">00326</a> <span class="preprocessor"></span><span class="preprocessor">#define O_LOV_DELAY_CREATE              (O_LOV_DELAY_CREATE_1_8 | \</span>
<a name="l00327"></a>00327 <span class="preprocessor">                                         O_LOV_DELAY_CREATE_MASK)</span>
<a name="l00328"></a>00328 <span class="preprocessor"></span>
<a name="l00329"></a><a class="code" href="group__lustreuser.html#ga651713d25f27378cd44d975c9ad7d0fe">00329</a> <span class="preprocessor">#define LL_FILE_IGNORE_LOCK     0x00000001</span>
<a name="l00330"></a><a class="code" href="group__lustreuser.html#gae7084e48dea7d2e6522f335871284864">00330</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_FILE_GROUP_LOCKED    0x00000002</span>
<a name="l00331"></a><a class="code" href="group__lustreuser.html#ga4b2f9f11e9107544ed3079686be919e5">00331</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_FILE_READAHEA        0x00000004</span>
<a name="l00332"></a><a class="code" href="group__lustreuser.html#ga055f756a585163f86d51a20f239c42ba">00332</a> <span class="preprocessor"></span><span class="preprocessor">#define LL_FILE_LOCKED_DIRECTIO 0x00000008 </span><span class="comment">/* client-side locks with dio */</span>
<a name="l00333"></a><a class="code" href="group__lustreuser.html#ga7e004bb3bf76c60fed23cbd17c0dceb0">00333</a> <span class="preprocessor">#define LL_FILE_LOCKLESS_IO     0x00000010 </span><span class="comment">/* server-side locks with cio */</span>
<a name="l00334"></a><a class="code" href="group__lustreuser.html#ga76e2addaee8d83a47b78404e400e5048">00334</a> <span class="preprocessor">#define LL_FILE_RMTACL          0x00000020</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span>
<a name="l00336"></a><a class="code" href="group__lustreuser.html#ga81d55e6256b6cf7a4664d49f4d02928d">00336</a> <span class="preprocessor">#define LOV_USER_MAGIC_V1       0x0BD10BD0</span>
<a name="l00337"></a><a class="code" href="group__lustreuser.html#gab96a4c3744fed0404f9bf49c3441d036">00337</a> <span class="preprocessor"></span><span class="preprocessor">#define LOV_USER_MAGIC          LOV_USER_MAGIC_V1</span>
<a name="l00338"></a><a class="code" href="group__lustreuser.html#ga59c4d68696565b21804559d8377b8081">00338</a> <span class="preprocessor"></span><span class="preprocessor">#define LOV_USER_MAGIC_JOIN_V1  0x0BD20BD0</span>
<a name="l00339"></a><a class="code" href="group__lustreuser.html#gade10fb540dbbc743f2a3140ca3bb4811">00339</a> <span class="preprocessor"></span><span class="preprocessor">#define LOV_USER_MAGIC_V3       0x0BD30BD0</span>
<a name="l00340"></a>00340 <span class="preprocessor"></span><span class="comment">/* 0x0BD40BD0 is occupied by LOV_MAGIC_MIGRATE */</span>
<a name="l00341"></a><a class="code" href="group__lustreuser.html#ga45d8f3dbfd52624efe358a3f3bd3057f">00341</a> <span class="preprocessor">#define LOV_USER_MAGIC_SPECIFIC 0x0BD50BD0      </span><span class="comment">/* for specific OSTs */</span>
<a name="l00342"></a>00342 
<a name="l00343"></a><a class="code" href="group__lustreuser.html#gabdf9dc5944d2440f0739a0d6c02e02e6">00343</a> <span class="preprocessor">#define LMV_USER_MAGIC    0x0CD30CD0    </span><span class="comment">/*default lmv magic*/</span>
<a name="l00344"></a>00344 
<a name="l00345"></a><a class="code" href="group__lustreuser.html#ga46587d1e96ad5b9e1863e81c3e7fb723">00345</a> <span class="preprocessor">#define LOV_PATTERN_RAID0       0x001</span>
<a name="l00346"></a><a class="code" href="group__lustreuser.html#ga42ca7409b0664cb1d55213e04984b11c">00346</a> <span class="preprocessor"></span><span class="preprocessor">#define LOV_PATTERN_RAID1       0x002</span>
<a name="l00347"></a><a class="code" href="group__lustreuser.html#ga95b5f4bfae8e2a9d282e444946d80361">00347</a> <span class="preprocessor"></span><span class="preprocessor">#define LOV_PATTERN_FIRST       0x100</span>
<a name="l00348"></a><a class="code" href="group__lustreuser.html#gae6277b37cc06f4f1071c9c1837d73d61">00348</a> <span class="preprocessor"></span><span class="preprocessor">#define LOV_PATTERN_CMOBD       0x200</span>
<a name="l00349"></a>00349 <span class="preprocessor"></span>
<a name="l00350"></a><a class="code" href="group__lustreuser.html#ga5c05899fc0a4572e7efb240d1138eb68">00350</a> <span class="preprocessor">#define LOV_PATTERN_F_MASK      0xffff0000</span>
<a name="l00351"></a><a class="code" href="group__lustreuser.html#gafeb906657639780775bf6a4d318724a7">00351</a> <span class="preprocessor"></span><span class="preprocessor">#define LOV_PATTERN_F_HOLE      0x40000000 </span><span class="comment">/* there is hole in LOV EA */</span>
<a name="l00352"></a><a class="code" href="group__lustreuser.html#ga5ea6d1e06f2ab15536f2626540c0c862">00352</a> <span class="preprocessor">#define LOV_PATTERN_F_RELEASED  0x80000000 </span><span class="comment">/* HSM released file */</span>
<a name="l00353"></a>00353 
<a name="l00354"></a><a class="code" href="group__lustreuser.html#gaff040b96729bd1570b96fa43d7b40f35">00354</a> <span class="preprocessor">#define LOV_MAXPOOLNAME 15</span>
<a name="l00355"></a><a class="code" href="group__lustreuser.html#gaff938af4b40f997eaaca2d7f4f5a8a95">00355</a> <span class="preprocessor"></span><span class="preprocessor">#define LOV_POOLNAMEF &quot;%.15s&quot;</span>
<a name="l00356"></a>00356 <span class="preprocessor"></span>
<a name="l00357"></a><a class="code" href="group__lustreuser.html#gae26eb0ebecdce154f8b0d0540427cbdf">00357</a> <span class="preprocessor">#define LOV_MIN_STRIPE_BITS 16   </span><span class="comment">/* maximum PAGE_SIZE (ia64), power of 2 */</span>
<a name="l00358"></a><a class="code" href="group__lustreuser.html#ga45a8b4b4468290fdde427bf7861b8ed7">00358</a> <span class="preprocessor">#define LOV_MIN_STRIPE_SIZE (1 &lt;&lt; LOV_MIN_STRIPE_BITS)</span>
<a name="l00359"></a><a class="code" href="group__lustreuser.html#ga0dc73ea1d350ab66a59bce7f982dc6d6">00359</a> <span class="preprocessor"></span><span class="preprocessor">#define LOV_MAX_STRIPE_COUNT_OLD 160</span>
<a name="l00360"></a>00360 <span class="preprocessor"></span><span class="comment">/* This calculation is crafted so that input of 4096 will result in 160</span>
<a name="l00361"></a>00361 <span class="comment"> * which in turn is equal to old maximal stripe count.</span>
<a name="l00362"></a>00362 <span class="comment"> * XXX: In fact this is too simpified for now, what it also need is to get</span>
<a name="l00363"></a>00363 <span class="comment"> * ea_type argument to clearly know how much space each stripe consumes.</span>
<a name="l00364"></a>00364 <span class="comment"> *</span>
<a name="l00365"></a>00365 <span class="comment"> * The limit of 12 pages is somewhat arbitrary, but is a reasonably large</span>
<a name="l00366"></a>00366 <span class="comment"> * allocation that is sufficient for the current generation of systems.</span>
<a name="l00367"></a>00367 <span class="comment"> *</span>
<a name="l00368"></a>00368 <span class="comment"> * (max buffer size - lov+rpc header) / sizeof(struct lov_ost_data_v1) */</span>
<a name="l00369"></a><a class="code" href="group__lustreuser.html#ga75a3c7e4964e86373dae6fd732947acf">00369</a> <span class="preprocessor">#define LOV_MAX_STRIPE_COUNT 2000  </span><span class="comment">/* ((12 * 4096 - 256) / 24) */</span>
<a name="l00370"></a><a class="code" href="group__lustreuser.html#gad8238ef0321fd1d8830254547a8a2282">00370</a> <span class="preprocessor">#define LOV_ALL_STRIPES       0xffff </span><span class="comment">/* only valid for directories */</span>
<a name="l00371"></a><a class="code" href="group__lustreuser.html#ga77ff76d0df8f35633b4c1d9a1e4923fd">00371</a> <span class="preprocessor">#define LOV_V1_INSANE_STRIPE_COUNT 65532 </span><span class="comment">/* maximum stripe count bz13933 */</span>
<a name="l00372"></a>00372 
<a name="l00373"></a><a class="code" href="group__lustreuser.html#ga1153ac6b7bfc12e9ba56486791b2e447">00373</a> <span class="preprocessor">#define XATTR_LUSTRE_PREFIX     &quot;lustre.&quot;</span>
<a name="l00374"></a><a class="code" href="group__lustreuser.html#ga755d0a6721aa43916c5512424120edcf">00374</a> <span class="preprocessor"></span><span class="preprocessor">#define XATTR_LUSTRE_LOV        XATTR_LUSTRE_PREFIX&quot;lov&quot;</span>
<a name="l00375"></a>00375 <span class="preprocessor"></span>
<a name="l00376"></a><a class="code" href="group__lustreuser.html#ga93740a566eb23b6f35ea20be820da0c5">00376</a> <span class="preprocessor">#define lov_user_ost_data lov_user_ost_data_v1</span>
<a name="l00377"></a><a class="code" href="structlov__user__ost__data__v1.html">00377</a> <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="structlov__user__ost__data__v1.html">lov_user_ost_data_v1</a> {     <span class="comment">/* per-stripe data structure */</span>
<a name="l00378"></a><a class="code" href="structlov__user__ost__data__v1.html#ae1c68f224d4a5ae3dadba3cdcd8731e7">00378</a>         <span class="keyword">struct </span><a class="code" href="structost__id.html" title="OST object IDentifier.">ost_id</a> <a class="code" href="structlov__user__ost__data__v1.html#ae1c68f224d4a5ae3dadba3cdcd8731e7">l_ost_oi</a>;   <span class="comment">/* OST object ID */</span>
<a name="l00379"></a><a class="code" href="structlov__user__ost__data__v1.html#a112940fc5d0965bfedc5b4e1f8914362">00379</a>         __u32 <a class="code" href="structlov__user__ost__data__v1.html#a112940fc5d0965bfedc5b4e1f8914362">l_ost_gen</a>;          <span class="comment">/* generation of this OST index */</span>
<a name="l00380"></a><a class="code" href="structlov__user__ost__data__v1.html#acc13a44e57e18a5ba950ecec646bde86">00380</a>         __u32 <a class="code" href="structlov__user__ost__data__v1.html#acc13a44e57e18a5ba950ecec646bde86">l_ost_idx</a>;          <span class="comment">/* OST index in LOV */</span>
<a name="l00381"></a>00381 } <a class="code" href="fid_8mod_8c.html#a804f230e6220e338767d15b94fc5801d">__attribute__</a>((<a class="code" href="group__lustreidl.html#ga30372a269f5fc08f064b7e94437589bb" title="Identifier for a single log object.">packed</a>));
<a name="l00382"></a>00382 
<a name="l00383"></a><a class="code" href="group__lustreuser.html#ga9c004c151be5b9c6f1886530cbd17136">00383</a> <span class="preprocessor">#define lov_user_md lov_user_md_v1</span>
<a name="l00384"></a><a class="code" href="structlov__user__md__v1.html">00384</a> <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="structlov__user__md__v1.html">lov_user_md_v1</a> {           <span class="comment">/* LOV EA user data (host-endian) */</span>
<a name="l00385"></a><a class="code" href="structlov__user__md__v1.html#ae52fc00a465a1548ea03606c7f1cf65c">00385</a>         __u32 <a class="code" href="structlov__user__md__v1.html#ae52fc00a465a1548ea03606c7f1cf65c">lmm_magic</a>;          <span class="comment">/* magic number = LOV_USER_MAGIC_V1 */</span>
<a name="l00386"></a><a class="code" href="structlov__user__md__v1.html#ae17b5386d46654a2a226a70286c677dc">00386</a>         __u32 <a class="code" href="structlov__user__md__v1.html#ae17b5386d46654a2a226a70286c677dc">lmm_pattern</a>;        <span class="comment">/* LOV_PATTERN_RAID0, LOV_PATTERN_RAID1 */</span>
<a name="l00387"></a><a class="code" href="structlov__user__md__v1.html#a1398d668081fa73c1c014bfffd691cbb">00387</a>         <span class="keyword">struct </span><a class="code" href="structost__id.html" title="OST object IDentifier.">ost_id</a> <a class="code" href="structlov__user__md__v1.html#a1398d668081fa73c1c014bfffd691cbb">lmm_oi</a>;     <span class="comment">/* LOV object ID */</span>
<a name="l00388"></a><a class="code" href="structlov__user__md__v1.html#ad42629be430d2a1bd985611c9e9936d8">00388</a>         __u32 <a class="code" href="structlov__user__md__v1.html#ad42629be430d2a1bd985611c9e9936d8">lmm_stripe_size</a>;    <span class="comment">/* size of stripe in bytes */</span>
<a name="l00389"></a><a class="code" href="structlov__user__md__v1.html#a67618600e73fe76e46ea365c6696de2b">00389</a>         __u16 <a class="code" href="structlov__user__md__v1.html#a67618600e73fe76e46ea365c6696de2b">lmm_stripe_count</a>;   <span class="comment">/* num stripes in use for this object */</span>
<a name="l00390"></a>00390         <span class="keyword">union </span>{
<a name="l00391"></a><a class="code" href="structlov__user__md__v1.html#a28a02dad5fab8bf35b8340f802db6725">00391</a>                 __u16 <a class="code" href="structlov__user__md__v1.html#a28a02dad5fab8bf35b8340f802db6725">lmm_stripe_offset</a>;  <span class="comment">/* starting stripe offset in</span>
<a name="l00392"></a>00392 <span class="comment">                                           * lmm_objects, use when writing */</span>
<a name="l00393"></a><a class="code" href="structlov__user__md__v1.html#a1d1d7368d2eb2ab0b611e3ea132ee9a6">00393</a>                 __u16 <a class="code" href="structlov__user__md__v1.html#a1d1d7368d2eb2ab0b611e3ea132ee9a6">lmm_layout_gen</a>;     <span class="comment">/* layout generation number</span>
<a name="l00394"></a>00394 <span class="comment">                                           * used when reading */</span>
<a name="l00395"></a>00395         };
<a name="l00396"></a><a class="code" href="structlov__user__md__v1.html#af22ea9f558e676c5a182b1fc73d5e3e2">00396</a>         <span class="keyword">struct </span><a class="code" href="structlov__user__ost__data__v1.html">lov_user_ost_data_v1</a> <a class="code" href="structlov__user__md__v1.html#af22ea9f558e676c5a182b1fc73d5e3e2">lmm_objects</a>[0]; <span class="comment">/* per-stripe data */</span>
<a name="l00397"></a>00397 } <a class="code" href="fid_8mod_8c.html#a804f230e6220e338767d15b94fc5801d">__attribute__</a>((<a class="code" href="group__lustreidl.html#ga30372a269f5fc08f064b7e94437589bb" title="Identifier for a single log object.">packed</a>,  <a class="code" href="group__lustreuser.html#ga8d45aef70c0aa442384441e31ee33dbe">__may_alias__</a>));
<a name="l00398"></a>00398 
<a name="l00399"></a><a class="code" href="structlov__user__md__v3.html">00399</a> <span class="keyword">struct </span><a class="code" href="structlov__user__md__v3.html">lov_user_md_v3</a> {           <span class="comment">/* LOV EA user data (host-endian) */</span>
<a name="l00400"></a><a class="code" href="structlov__user__md__v3.html#a139fc73fe189b4a9adb4fe7888a2321e">00400</a>         __u32 <a class="code" href="structlov__user__md__v3.html#a139fc73fe189b4a9adb4fe7888a2321e">lmm_magic</a>;          <span class="comment">/* magic number = LOV_USER_MAGIC_V3 */</span>
<a name="l00401"></a><a class="code" href="structlov__user__md__v3.html#a06b4a7024f4a88cf3a1531679692ea41">00401</a>         __u32 <a class="code" href="structlov__user__md__v3.html#a06b4a7024f4a88cf3a1531679692ea41">lmm_pattern</a>;        <span class="comment">/* LOV_PATTERN_RAID0, LOV_PATTERN_RAID1 */</span>
<a name="l00402"></a><a class="code" href="structlov__user__md__v3.html#a3a8d00192b4c2631465d0c597bd0c2b1">00402</a>         <span class="keyword">struct </span><a class="code" href="structost__id.html" title="OST object IDentifier.">ost_id</a> <a class="code" href="structlov__user__md__v3.html#a3a8d00192b4c2631465d0c597bd0c2b1">lmm_oi</a>;     <span class="comment">/* LOV object ID */</span>
<a name="l00403"></a><a class="code" href="structlov__user__md__v3.html#aedef47a6c9c03b044f4f655a4193a646">00403</a>         __u32 <a class="code" href="structlov__user__md__v3.html#aedef47a6c9c03b044f4f655a4193a646">lmm_stripe_size</a>;    <span class="comment">/* size of stripe in bytes */</span>
<a name="l00404"></a><a class="code" href="structlov__user__md__v3.html#a554e3ea255169ce02c18ca3712305e84">00404</a>         __u16 <a class="code" href="structlov__user__md__v3.html#a554e3ea255169ce02c18ca3712305e84">lmm_stripe_count</a>;   <span class="comment">/* num stripes in use for this object */</span>
<a name="l00405"></a>00405         <span class="keyword">union </span>{
<a name="l00406"></a><a class="code" href="structlov__user__md__v3.html#ae707a7bbd85cf24881297109fa5610ae">00406</a>                 __u16 <a class="code" href="structlov__user__md__v3.html#ae707a7bbd85cf24881297109fa5610ae">lmm_stripe_offset</a>;  <span class="comment">/* starting stripe offset in</span>
<a name="l00407"></a>00407 <span class="comment">                                           * lmm_objects, use when writing */</span>
<a name="l00408"></a><a class="code" href="structlov__user__md__v3.html#a975358e91f21e59e99ce4fa536d777b4">00408</a>                 __u16 <a class="code" href="structlov__user__md__v3.html#a975358e91f21e59e99ce4fa536d777b4">lmm_layout_gen</a>;     <span class="comment">/* layout generation number</span>
<a name="l00409"></a>00409 <span class="comment">                                           * used when reading */</span>
<a name="l00410"></a>00410         };
<a name="l00411"></a><a class="code" href="structlov__user__md__v3.html#a9acfd7af44a40edbeb720bb0414d36c0">00411</a>         <span class="keywordtype">char</span>  <a class="code" href="structlov__user__md__v3.html#a9acfd7af44a40edbeb720bb0414d36c0">lmm_pool_name</a>[<a class="code" href="group__lustreuser.html#gaff040b96729bd1570b96fa43d7b40f35">LOV_MAXPOOLNAME</a> + 1]; <span class="comment">/* pool name */</span>
<a name="l00412"></a><a class="code" href="structlov__user__md__v3.html#a039fc7e6a74d31f6324ac64328730d30">00412</a>         <span class="keyword">struct </span><a class="code" href="structlov__user__ost__data__v1.html">lov_user_ost_data_v1</a> <a class="code" href="structlov__user__md__v3.html#a039fc7e6a74d31f6324ac64328730d30">lmm_objects</a>[0]; <span class="comment">/* per-stripe data */</span>
<a name="l00413"></a>00413 } <a class="code" href="fid_8mod_8c.html#a804f230e6220e338767d15b94fc5801d">__attribute__</a>((<a class="code" href="group__lustreidl.html#ga30372a269f5fc08f064b7e94437589bb" title="Identifier for a single log object.">packed</a>));
<a name="l00414"></a>00414 
<a name="l00415"></a><a class="code" href="group__lustreuser.html#gade3b274a79957505f7006249ff946451">00415</a> <span class="keyword">static</span> <span class="keyword">inline</span> __u32 <a class="code" href="group__lustreuser.html#gade3b274a79957505f7006249ff946451">lov_user_md_size</a>(__u16 <a class="code" href="mdsrate_8c.html#ad772c21043d0158114c40cad5c2f3d4c">stripes</a>, __u32 lmm_magic)
<a name="l00416"></a>00416 {
<a name="l00417"></a>00417         <span class="keywordflow">if</span> (lmm_magic == <a class="code" href="group__lustreuser.html#ga81d55e6256b6cf7a4664d49f4d02928d">LOV_USER_MAGIC_V1</a>)
<a name="l00418"></a>00418                 <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structlov__user__md__v1.html">lov_user_md_v1</a>) +
<a name="l00419"></a>00419                               stripes * <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structlov__user__ost__data__v1.html">lov_user_ost_data_v1</a>);
<a name="l00420"></a>00420         <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structlov__user__md__v3.html">lov_user_md_v3</a>) +
<a name="l00421"></a>00421                                 stripes * <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structlov__user__ost__data__v1.html">lov_user_ost_data_v1</a>);
<a name="l00422"></a>00422 }
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 <span class="comment">/* Compile with -D_LARGEFILE64_SOURCE or -D_GNU_SOURCE (or #define) to</span>
<a name="l00425"></a>00425 <span class="comment"> * use this.  It is unsafe to #define those values in this header as it</span>
<a name="l00426"></a>00426 <span class="comment"> * is possible the application has already #included &lt;sys/stat.h&gt;. */</span>
<a name="l00427"></a>00427 <span class="preprocessor">#ifdef HAVE_LOV_USER_MDS_DATA</span>
<a name="l00428"></a>00428 <span class="preprocessor"></span><span class="preprocessor">#define lov_user_mds_data lov_user_mds_data_v1</span>
<a name="l00429"></a>00429 <span class="preprocessor"></span><span class="keyword">struct </span>lov_user_mds_data_v1 {
<a name="l00430"></a>00430         lstat_t lmd_st;                 <span class="comment">/* MDS stat struct */</span>
<a name="l00431"></a>00431         <span class="keyword">struct </span><a class="code" href="structlov__user__md__v1.html">lov_user_md_v1</a> lmd_lmm;  <span class="comment">/* LOV EA V1 user data */</span>
<a name="l00432"></a>00432 } <a class="code" href="fid_8mod_8c.html#a804f230e6220e338767d15b94fc5801d">__attribute__</a>((<a class="code" href="group__lustreidl.html#ga30372a269f5fc08f064b7e94437589bb" title="Identifier for a single log object.">packed</a>));
<a name="l00433"></a>00433 
<a name="l00434"></a>00434 <span class="keyword">struct </span>lov_user_mds_data_v3 {
<a name="l00435"></a>00435         lstat_t lmd_st;                 <span class="comment">/* MDS stat struct */</span>
<a name="l00436"></a>00436         <span class="keyword">struct </span><a class="code" href="structlov__user__md__v3.html">lov_user_md_v3</a> lmd_lmm;  <span class="comment">/* LOV EA V3 user data */</span>
<a name="l00437"></a>00437 } <a class="code" href="fid_8mod_8c.html#a804f230e6220e338767d15b94fc5801d">__attribute__</a>((<a class="code" href="group__lustreidl.html#ga30372a269f5fc08f064b7e94437589bb" title="Identifier for a single log object.">packed</a>));
<a name="l00438"></a>00438 <span class="preprocessor">#endif</span>
<a name="l00439"></a>00439 <span class="preprocessor"></span>
<a name="l00440"></a><a class="code" href="structlmv__user__mds__data.html">00440</a> <span class="keyword">struct </span><a class="code" href="structlmv__user__mds__data.html">lmv_user_mds_data</a> {
<a name="l00441"></a><a class="code" href="structlmv__user__mds__data.html#ad481e3c62367494be08062bc09ce4fbd">00441</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>   <a class="code" href="structlmv__user__mds__data.html#ad481e3c62367494be08062bc09ce4fbd">lum_fid</a>;
<a name="l00442"></a><a class="code" href="structlmv__user__mds__data.html#a48a296cdfeef45ef82c7278bc3c9c0c7">00442</a>         __u32           <a class="code" href="structlmv__user__mds__data.html#a48a296cdfeef45ef82c7278bc3c9c0c7">lum_padding</a>;
<a name="l00443"></a><a class="code" href="structlmv__user__mds__data.html#a5c9a170f1d395710523c0c425f2466b1">00443</a>         __u32           <a class="code" href="structlmv__user__mds__data.html#a5c9a170f1d395710523c0c425f2466b1">lum_mds</a>;
<a name="l00444"></a>00444 };
<a name="l00445"></a>00445 
<a name="l00446"></a><a class="code" href="group__lustreuser.html#ga87892a6b8b26aa39362f401a2f430b6e">00446</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga87892a6b8b26aa39362f401a2f430b6e">lmv_hash_type</a> {
<a name="l00447"></a><a class="code" href="group__lustreuser.html#gga87892a6b8b26aa39362f401a2f430b6ea6a8d8924aee9296e316c99a77cf295b4">00447</a>         <a class="code" href="group__lustreuser.html#gga87892a6b8b26aa39362f401a2f430b6ea6a8d8924aee9296e316c99a77cf295b4">LMV_HASH_TYPE_UNKNOWN</a>   = 0,    <span class="comment">/* 0 is reserved for testing purpose */</span>
<a name="l00448"></a><a class="code" href="group__lustreuser.html#gga87892a6b8b26aa39362f401a2f430b6eab009acece6d06fa975223421e3a2fabc">00448</a>         <a class="code" href="group__lustreuser.html#gga87892a6b8b26aa39362f401a2f430b6eab009acece6d06fa975223421e3a2fabc">LMV_HASH_TYPE_ALL_CHARS</a> = 1,
<a name="l00449"></a><a class="code" href="group__lustreuser.html#gga87892a6b8b26aa39362f401a2f430b6ea3d374628293b565e59b8680d005381f0">00449</a>         <a class="code" href="group__lustreuser.html#gga87892a6b8b26aa39362f401a2f430b6ea3d374628293b565e59b8680d005381f0">LMV_HASH_TYPE_FNV_1A_64</a> = 2,
<a name="l00450"></a>00450 };
<a name="l00451"></a>00451 
<a name="l00452"></a><a class="code" href="group__lustreuser.html#gad146046b5cd28f676d539c9e13c9fba1">00452</a> <span class="preprocessor">#define LMV_HASH_NAME_ALL_CHARS &quot;all_char&quot;</span>
<a name="l00453"></a><a class="code" href="group__lustreuser.html#ga697d52eeb8ee0f71e78d8051dfd726ba">00453</a> <span class="preprocessor"></span><span class="preprocessor">#define LMV_HASH_NAME_FNV_1A_64 &quot;fnv_1a_64&quot;</span>
<a name="l00454"></a>00454 <span class="preprocessor"></span>
<a name="l00455"></a>00455 <span class="comment">/* Got this according to how get LOV_MAX_STRIPE_COUNT, see above,</span>
<a name="l00456"></a>00456 <span class="comment"> * (max buffer size - lmv+rpc header) / sizeof(struct lmv_user_mds_data) */</span>
<a name="l00457"></a><a class="code" href="group__lustreuser.html#ga9b9a7a433244e03435cbd9d0c181affb">00457</a> <span class="preprocessor">#define LMV_MAX_STRIPE_COUNT 2000  </span><span class="comment">/* ((12 * 4096 - 256) / 24) */</span>
<a name="l00458"></a><a class="code" href="group__lustreuser.html#ga738c0eb770a010b5c6a8c6f4804cdbe4">00458</a> <span class="preprocessor">#define lmv_user_md lmv_user_md_v1</span>
<a name="l00459"></a><a class="code" href="structlmv__user__md__v1.html">00459</a> <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="structlmv__user__md__v1.html">lmv_user_md_v1</a> {
<a name="l00460"></a><a class="code" href="structlmv__user__md__v1.html#a997ff8e99168c52b7902f0e0c5583f7a">00460</a>         __u32   <a class="code" href="structlmv__user__md__v1.html#a997ff8e99168c52b7902f0e0c5583f7a">lum_magic</a>;       <span class="comment">/* must be the first field */</span>
<a name="l00461"></a><a class="code" href="structlmv__user__md__v1.html#acb7aa98756fe02bcbdcffc275684bfa3">00461</a>         __u32   <a class="code" href="structlmv__user__md__v1.html#acb7aa98756fe02bcbdcffc275684bfa3">lum_stripe_count</a>;  <span class="comment">/* dirstripe count */</span>
<a name="l00462"></a><a class="code" href="structlmv__user__md__v1.html#a6e74117562e720fba555b6d059a15eb7">00462</a>         __u32   <a class="code" href="structlmv__user__md__v1.html#a6e74117562e720fba555b6d059a15eb7">lum_stripe_offset</a>; <span class="comment">/* MDT idx for default dirstripe */</span>
<a name="l00463"></a><a class="code" href="structlmv__user__md__v1.html#a4e6590d03ad97b0026f44023e2260e67">00463</a>         __u32   <a class="code" href="structlmv__user__md__v1.html#a4e6590d03ad97b0026f44023e2260e67">lum_hash_type</a>;     <span class="comment">/* Dir stripe policy */</span>
<a name="l00464"></a><a class="code" href="structlmv__user__md__v1.html#a61098d5fc280861ec53a4758bd5c96bf">00464</a>         __u32   <a class="code" href="structlmv__user__md__v1.html#a61098d5fc280861ec53a4758bd5c96bf">lum_type</a>;         <span class="comment">/* LMV type: default or normal */</span>
<a name="l00465"></a><a class="code" href="structlmv__user__md__v1.html#ae6e07afdffadcb2057262b20ad9bb879">00465</a>         __u32   <a class="code" href="structlmv__user__md__v1.html#ae6e07afdffadcb2057262b20ad9bb879">lum_padding1</a>;
<a name="l00466"></a><a class="code" href="structlmv__user__md__v1.html#a231aa717707eaea607fdac967ab4592a">00466</a>         __u32   <a class="code" href="structlmv__user__md__v1.html#a231aa717707eaea607fdac967ab4592a">lum_padding2</a>;
<a name="l00467"></a><a class="code" href="structlmv__user__md__v1.html#af9db344a6a835c7bf7f233d2a36142a1">00467</a>         __u32   <a class="code" href="structlmv__user__md__v1.html#af9db344a6a835c7bf7f233d2a36142a1">lum_padding3</a>;
<a name="l00468"></a><a class="code" href="structlmv__user__md__v1.html#aafcc4baf2643af794ed8ab55936fea09">00468</a>         <span class="keywordtype">char</span>    <a class="code" href="structlmv__user__md__v1.html#aafcc4baf2643af794ed8ab55936fea09">lum_pool_name</a>[<a class="code" href="group__lustreuser.html#gaff040b96729bd1570b96fa43d7b40f35">LOV_MAXPOOLNAME</a> + 1];
<a name="l00469"></a><a class="code" href="structlmv__user__md__v1.html#aa715e98e307e1402b5ffe8da290006b0">00469</a>         <span class="keyword">struct  </span><a class="code" href="structlmv__user__mds__data.html">lmv_user_mds_data</a>  <a class="code" href="structlmv__user__md__v1.html#aa715e98e307e1402b5ffe8da290006b0">lum_objects</a>[0];
<a name="l00470"></a>00470 } <a class="code" href="fid_8mod_8c.html#a804f230e6220e338767d15b94fc5801d">__attribute__</a>((<a class="code" href="group__lustreidl.html#ga30372a269f5fc08f064b7e94437589bb" title="Identifier for a single log object.">packed</a>));
<a name="l00471"></a>00471 
<a name="l00472"></a><a class="code" href="group__lustreuser.html#gaa4e0e79269ebfe82fe351b3753762bc1">00472</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__lustreuser.html#gaa4e0e79269ebfe82fe351b3753762bc1">lmv_user_md_size</a>(<span class="keywordtype">int</span> <a class="code" href="mdsrate_8c.html#ad772c21043d0158114c40cad5c2f3d4c">stripes</a>, <span class="keywordtype">int</span> lmm_magic)
<a name="l00473"></a>00473 {
<a name="l00474"></a>00474         <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="group__lustreuser.html#ga738c0eb770a010b5c6a8c6f4804cdbe4">lmv_user_md</a>) +
<a name="l00475"></a>00475                       stripes * <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structlmv__user__mds__data.html">lmv_user_mds_data</a>);
<a name="l00476"></a>00476 }
<a name="l00477"></a>00477 
<a name="l00478"></a><a class="code" href="structll__recreate__obj.html">00478</a> <span class="keyword">struct </span><a class="code" href="structll__recreate__obj.html">ll_recreate_obj</a> {
<a name="l00479"></a><a class="code" href="structll__recreate__obj.html#afde714307f3a519df4f7f894ef6635eb">00479</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structll__recreate__obj.html#afde714307f3a519df4f7f894ef6635eb">lrc_id</a>;
<a name="l00480"></a><a class="code" href="structll__recreate__obj.html#a5501bad12cbd46cce5aab7e26e3c0d52">00480</a>         __u32 <a class="code" href="structll__recreate__obj.html#a5501bad12cbd46cce5aab7e26e3c0d52">lrc_ost_idx</a>;
<a name="l00481"></a>00481 };
<a name="l00482"></a>00482 
<a name="l00483"></a><a class="code" href="structll__fid.html">00483</a> <span class="keyword">struct </span><a class="code" href="structll__fid.html">ll_fid</a> {
<a name="l00484"></a><a class="code" href="structll__fid.html#a25448a54922c24b9e2013b60e8829cdd">00484</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structll__fid.html#a25448a54922c24b9e2013b60e8829cdd">id</a>;         <span class="comment">/* holds object id */</span>
<a name="l00485"></a><a class="code" href="structll__fid.html#acba7d6bae1ee1e4950a281d2a97b5979">00485</a>         __u32 <a class="code" href="structll__fid.html#acba7d6bae1ee1e4950a281d2a97b5979">generation</a>; <span class="comment">/* holds object generation */</span>
<a name="l00486"></a><a class="code" href="structll__fid.html#a8609e8c12ede1c6fb7e3e24f84aa30bf">00486</a>         __u32 <a class="code" href="structll__fid.html#a8609e8c12ede1c6fb7e3e24f84aa30bf">f_type</a>;     <span class="comment">/* holds object type or stripe idx when passing it to</span>
<a name="l00487"></a>00487 <span class="comment">                           * OST for saving into EA. */</span>
<a name="l00488"></a>00488 };
<a name="l00489"></a>00489 
<a name="l00490"></a><a class="code" href="group__lustreuser.html#ga61d19cef086f985e35a32d8016c79753">00490</a> <span class="preprocessor">#define UUID_MAX        40</span>
<a name="l00491"></a><a class="code" href="structobd__uuid.html">00491</a> <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="structobd__uuid.html">obd_uuid</a> {
<a name="l00492"></a><a class="code" href="structobd__uuid.html#aa6cced3e76a3656e5152bb9ed249e7a1">00492</a>         <span class="keywordtype">char</span> <a class="code" href="structobd__uuid.html#aa6cced3e76a3656e5152bb9ed249e7a1">uuid</a>[<a class="code" href="group__lustreuser.html#ga61d19cef086f985e35a32d8016c79753">UUID_MAX</a>];
<a name="l00493"></a>00493 };
<a name="l00494"></a>00494 
<a name="l00495"></a><a class="code" href="group__lustreuser.html#gaf5bd7cc2aabbc92d65fc26d506f1a02e">00495</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="group__lustreuser.html#gaf5bd7cc2aabbc92d65fc26d506f1a02e">obd_uuid_equals</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structobd__uuid.html">obd_uuid</a> *u1,
<a name="l00496"></a>00496                                    <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structobd__uuid.html">obd_uuid</a> *u2)
<a name="l00497"></a>00497 {
<a name="l00498"></a>00498         <span class="keywordflow">return</span> strcmp((<span class="keywordtype">char</span> *)u1-&gt;<a class="code" href="structobd__uuid.html#aa6cced3e76a3656e5152bb9ed249e7a1">uuid</a>, (<span class="keywordtype">char</span> *)u2-&gt;<a class="code" href="structobd__uuid.html#aa6cced3e76a3656e5152bb9ed249e7a1">uuid</a>) == 0;
<a name="l00499"></a>00499 }
<a name="l00500"></a>00500 
<a name="l00501"></a><a class="code" href="group__lustreuser.html#gaf0ed6fa0af32f0513db27655ed37262b">00501</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__lustreuser.html#gaf0ed6fa0af32f0513db27655ed37262b">obd_uuid_empty</a>(<span class="keyword">struct</span> <a class="code" href="structobd__uuid.html">obd_uuid</a> *<a class="code" href="llog__test_8c.html#aaa83f069991aa91e0383af81ef30f13f">uuid</a>)
<a name="l00502"></a>00502 {
<a name="l00503"></a>00503         <span class="keywordflow">return</span> uuid-&gt;<a class="code" href="structobd__uuid.html#aa6cced3e76a3656e5152bb9ed249e7a1">uuid</a>[0] == <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00504"></a>00504 }
<a name="l00505"></a>00505 
<a name="l00506"></a><a class="code" href="group__lustreuser.html#gad22b0e3b947bae0ae7e719c79e6f9100">00506</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__lustreuser.html#gad22b0e3b947bae0ae7e719c79e6f9100">obd_str2uuid</a>(<span class="keyword">struct</span> <a class="code" href="structobd__uuid.html">obd_uuid</a> *<a class="code" href="llog__test_8c.html#aaa83f069991aa91e0383af81ef30f13f">uuid</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *tmp)
<a name="l00507"></a>00507 {
<a name="l00508"></a>00508         strncpy((<span class="keywordtype">char</span> *)uuid-&gt;<a class="code" href="structobd__uuid.html#aa6cced3e76a3656e5152bb9ed249e7a1">uuid</a>, tmp, <span class="keyword">sizeof</span>(*uuid));
<a name="l00509"></a>00509         uuid-&gt;<a class="code" href="structobd__uuid.html#aa6cced3e76a3656e5152bb9ed249e7a1">uuid</a>[<span class="keyword">sizeof</span>(*uuid) - 1] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00510"></a>00510 }
<a name="l00511"></a>00511 
<a name="l00512"></a>00512 <span class="comment">/* For printf&apos;s only, make sure uuid is terminated */</span>
<a name="l00513"></a><a class="code" href="group__lustreuser.html#gaac3ce4277dee1a5b85ff0cf4b2760997">00513</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">char</span> *<a class="code" href="group__lustreuser.html#gaac3ce4277dee1a5b85ff0cf4b2760997">obd_uuid2str</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structobd__uuid.html">obd_uuid</a> *<a class="code" href="llog__test_8c.html#aaa83f069991aa91e0383af81ef30f13f">uuid</a>)
<a name="l00514"></a>00514 {
<a name="l00515"></a>00515         <span class="keywordflow">if</span> (uuid == NULL)
<a name="l00516"></a>00516                 <span class="keywordflow">return</span> NULL;
<a name="l00517"></a>00517 
<a name="l00518"></a>00518         <span class="keywordflow">if</span> (uuid-&gt;<a class="code" href="structobd__uuid.html#aa6cced3e76a3656e5152bb9ed249e7a1">uuid</a>[<span class="keyword">sizeof</span>(*uuid) - 1] != <span class="charliteral">&apos;\0&apos;</span>) {
<a name="l00519"></a>00519                 <span class="comment">/* Obviously not safe, but for printfs, no real harm done...</span>
<a name="l00520"></a>00520 <span class="comment">                   we&apos;re always null-terminated, even in a race. */</span>
<a name="l00521"></a>00521                 <span class="keyword">static</span> <span class="keywordtype">char</span> temp[<span class="keyword">sizeof</span>(*uuid)];
<a name="l00522"></a>00522                 memcpy(temp, uuid-&gt;<a class="code" href="structobd__uuid.html#aa6cced3e76a3656e5152bb9ed249e7a1">uuid</a>, <span class="keyword">sizeof</span>(*uuid) - 1);
<a name="l00523"></a>00523                 temp[<span class="keyword">sizeof</span>(*uuid) - 1] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00524"></a>00524                 <span class="keywordflow">return</span> temp;
<a name="l00525"></a>00525         }
<a name="l00526"></a>00526         <span class="keywordflow">return</span> (<span class="keywordtype">char</span> *)(uuid-&gt;<a class="code" href="structobd__uuid.html#aa6cced3e76a3656e5152bb9ed249e7a1">uuid</a>);
<a name="l00527"></a>00527 }
<a name="l00528"></a>00528 
<a name="l00529"></a>00529 <span class="comment">/* Extract fsname from uuid (or target name) of a target</span>
<a name="l00530"></a>00530 <span class="comment">   e.g. (myfs-OST0007_UUID -&gt; myfs)</span>
<a name="l00531"></a>00531 <span class="comment">   see also deuuidify. */</span>
<a name="l00532"></a><a class="code" href="group__lustreuser.html#ga7fd5c2a7850f8ff0acf3260fa8defabf">00532</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__lustreuser.html#ga7fd5c2a7850f8ff0acf3260fa8defabf">obd_uuid2fsname</a>(<span class="keywordtype">char</span> *<a class="code" href="parallel__grouplock_8c.html#a30581aaaef7980b9fc6df8f98406097c">buf</a>, <span class="keywordtype">char</span> *<a class="code" href="llog__test_8c.html#aaa83f069991aa91e0383af81ef30f13f">uuid</a>, <span class="keywordtype">int</span> buflen)
<a name="l00533"></a>00533 {
<a name="l00534"></a>00534         <span class="keywordtype">char</span> *p;
<a name="l00535"></a>00535 
<a name="l00536"></a>00536         strncpy(buf, uuid, buflen - 1);
<a name="l00537"></a>00537         buf[buflen - 1] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00538"></a>00538         p = strrchr(buf, <span class="charliteral">&apos;-&apos;</span>);
<a name="l00539"></a>00539         <span class="keywordflow">if</span> (p != NULL)
<a name="l00540"></a>00540                 *p = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00541"></a>00541 }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 <span class="comment">/* printf display format for Lustre FIDs</span>
<a name="l00544"></a>00544 <span class="comment"> * usage: printf(&quot;file FID is &quot;DFID&quot;\n&quot;, PFID(fid)); */</span>
<a name="l00545"></a><a class="code" href="group__lustreuser.html#ga10aa74855267e4f6c423158409db4a0b">00545</a> <span class="preprocessor">#define FID_NOBRACE_LEN 40</span>
<a name="l00546"></a><a class="code" href="group__lustreuser.html#ga79f2407c9ac5b4d648e299335a70ec8a">00546</a> <span class="preprocessor"></span><span class="preprocessor">#define FID_LEN (FID_NOBRACE_LEN + 2)</span>
<a name="l00547"></a><a class="code" href="group__lustreuser.html#gabefc6ea7ab6fc12d5c0c53f645f1a50b">00547</a> <span class="preprocessor"></span><span class="preprocessor">#define DFID_NOBRACE &quot;%#llx:0x%x:0x%x&quot;</span>
<a name="l00548"></a><a class="code" href="group__lustreuser.html#gada965b87689690ab45635c329842df61">00548</a> <span class="preprocessor"></span><span class="preprocessor">#define DFID &quot;[&quot;DFID_NOBRACE&quot;]&quot;</span>
<a name="l00549"></a><a class="code" href="group__lustreuser.html#ga00397843677b819317199a3198f5ecc2">00549</a> <span class="preprocessor"></span><span class="preprocessor">#define PFID(fid) (unsigned long long)(fid)-&gt;f_seq, (fid)-&gt;f_oid, (fid)-&gt;f_ver</span>
<a name="l00550"></a>00550 <span class="preprocessor"></span>
<a name="l00551"></a>00551 <span class="comment">/* scanf input parse format for fids in DFID_NOBRACE format</span>
<a name="l00552"></a>00552 <span class="comment"> * Need to strip &apos;[&apos; from DFID format first or use &quot;[&quot;SFID&quot;]&quot; at caller.</span>
<a name="l00553"></a>00553 <span class="comment"> * usage: sscanf(fidstr, SFID, RFID(&amp;fid)); */</span>
<a name="l00554"></a><a class="code" href="group__lustreuser.html#ga72afaf869b6a3c578a90f09a88ea0fb8">00554</a> <span class="preprocessor">#define SFID &quot;0x%llx:0x%x:0x%x&quot;</span>
<a name="l00555"></a><a class="code" href="group__lustreuser.html#gacbbbfaea253eb1cdd987be440beedab6">00555</a> <span class="preprocessor"></span><span class="preprocessor">#define RFID(fid) &amp;((fid)-&gt;f_seq), &amp;((fid)-&gt;f_oid), &amp;((fid)-&gt;f_ver)</span>
<a name="l00556"></a>00556 <span class="preprocessor"></span>
<a name="l00557"></a>00557 <span class="comment">/********* Quotas **********/</span>
<a name="l00558"></a>00558 
<a name="l00559"></a><a class="code" href="group__lustreuser.html#ga8ce54ed013188837dc74b5d7d560e3cd">00559</a> <span class="preprocessor">#define LUSTRE_QUOTABLOCK_BITS 10</span>
<a name="l00560"></a><a class="code" href="group__lustreuser.html#ga467db370c4a6686e986409331f75a648">00560</a> <span class="preprocessor"></span><span class="preprocessor">#define LUSTRE_QUOTABLOCK_SIZE (1 &lt;&lt; LUSTRE_QUOTABLOCK_BITS)</span>
<a name="l00561"></a>00561 <span class="preprocessor"></span>
<a name="l00562"></a><a class="code" href="group__lustreuser.html#gab18dd271555db67fdd8cbf61abe63330">00562</a> <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="group__lustreuser.html#gab18dd271555db67fdd8cbf61abe63330">lustre_stoqb</a>(<span class="keywordtype">size_t</span> space)
<a name="l00563"></a>00563 {
<a name="l00564"></a>00564         <span class="keywordflow">return</span> (space + <a class="code" href="group__lustreuser.html#ga467db370c4a6686e986409331f75a648">LUSTRE_QUOTABLOCK_SIZE</a> - 1) &gt;&gt; <a class="code" href="group__lustreuser.html#ga8ce54ed013188837dc74b5d7d560e3cd">LUSTRE_QUOTABLOCK_BITS</a>;
<a name="l00565"></a>00565 }
<a name="l00566"></a>00566 
<a name="l00567"></a><a class="code" href="group__lustreuser.html#ga57b6d20b0a062c8dd439ca84daa3c67c">00567</a> <span class="preprocessor">#define Q_QUOTACHECK    0x800100 </span><span class="comment">/* deprecated as of 2.4 */</span>
<a name="l00568"></a><a class="code" href="group__lustreuser.html#ga657bf045445ef84377115c432aa1d300">00568</a> <span class="preprocessor">#define Q_INITQUOTA     0x800101 </span><span class="comment">/* deprecated as of 2.4  */</span>
<a name="l00569"></a><a class="code" href="group__lustreuser.html#ga5805dc60c0e48caba2e58134826d84e1">00569</a> <span class="preprocessor">#define Q_GETOINFO      0x800102 </span><span class="comment">/* get obd quota info */</span>
<a name="l00570"></a><a class="code" href="group__lustreuser.html#ga8ed3793a998f2fedb262536f2b256554">00570</a> <span class="preprocessor">#define Q_GETOQUOTA     0x800103 </span><span class="comment">/* get obd quotas */</span>
<a name="l00571"></a><a class="code" href="group__lustreuser.html#gaaf7369aa86c09418eeb7ac4daaf7e67a">00571</a> <span class="preprocessor">#define Q_FINVALIDATE   0x800104 </span><span class="comment">/* deprecated as of 2.4 */</span>
<a name="l00572"></a>00572 
<a name="l00573"></a>00573 <span class="comment">/* these must be explicitly translated into linux Q_* in ll_dir_ioctl */</span>
<a name="l00574"></a><a class="code" href="group__lustreuser.html#ga48d8e0c0ff1ab65504e27b61ab5c83d1">00574</a> <span class="preprocessor">#define LUSTRE_Q_QUOTAON    0x800002     </span><span class="comment">/* deprecated as of 2.4 */</span>
<a name="l00575"></a><a class="code" href="group__lustreuser.html#ga57a9f9cf0744112205d8f12beb9fba6c">00575</a> <span class="preprocessor">#define LUSTRE_Q_QUOTAOFF   0x800003     </span><span class="comment">/* deprecated as of 2.4 */</span>
<a name="l00576"></a><a class="code" href="group__lustreuser.html#gac3ed2e62762435612c2bfb528038fac2">00576</a> <span class="preprocessor">#define LUSTRE_Q_GETINFO    0x800005     </span><span class="comment">/* get information about quota files */</span>
<a name="l00577"></a><a class="code" href="group__lustreuser.html#gac8a234f36e0f3933c086ff89f48ed509">00577</a> <span class="preprocessor">#define LUSTRE_Q_SETINFO    0x800006     </span><span class="comment">/* set information about quota files */</span>
<a name="l00578"></a><a class="code" href="group__lustreuser.html#gaddbbc54d2e1096dd0a76c9e2b3505622">00578</a> <span class="preprocessor">#define LUSTRE_Q_GETQUOTA   0x800007     </span><span class="comment">/* get user quota structure */</span>
<a name="l00579"></a><a class="code" href="group__lustreuser.html#gac8ccf829414827623aa18a51784901a9">00579</a> <span class="preprocessor">#define LUSTRE_Q_SETQUOTA   0x800008     </span><span class="comment">/* set user quota structure */</span>
<a name="l00580"></a>00580 <span class="comment">/* lustre-specific control commands */</span>
<a name="l00581"></a><a class="code" href="group__lustreuser.html#gab083cae66129858a63ba11b90cf7a8f0">00581</a> <span class="preprocessor">#define LUSTRE_Q_INVALIDATE  0x80000b     </span><span class="comment">/* deprecated as of 2.4 */</span>
<a name="l00582"></a><a class="code" href="group__lustreuser.html#gabda895614ac41d7807aaf440a1557daf">00582</a> <span class="preprocessor">#define LUSTRE_Q_FINVALIDATE 0x80000c     </span><span class="comment">/* deprecated as of 2.4 */</span>
<a name="l00583"></a>00583 
<a name="l00584"></a><a class="code" href="group__lustreuser.html#ga430e9c5364eac3cdcfe5afc87ecb82c5">00584</a> <span class="preprocessor">#define UGQUOTA 2       </span><span class="comment">/* set both USRQUOTA and GRPQUOTA */</span>
<a name="l00585"></a>00585 
<a name="l00586"></a><a class="code" href="group__lustreuser.html#ga0b63b78fbf87b7bc5323c9d1afbfff3c">00586</a> <span class="preprocessor">#define IDENTITY_DOWNCALL_MAGIC 0x6d6dd629</span>
<a name="l00587"></a>00587 <span class="preprocessor"></span>
<a name="l00588"></a>00588 <span class="comment">/* permission */</span>
<a name="l00589"></a><a class="code" href="group__lustreuser.html#ga3b449b70d0860a0c3741ef6a5ee48229">00589</a> <span class="preprocessor">#define N_PERMS_MAX      64</span>
<a name="l00590"></a>00590 <span class="preprocessor"></span>
<a name="l00591"></a><a class="code" href="structperm__downcall__data.html">00591</a> <span class="keyword">struct </span><a class="code" href="structperm__downcall__data.html">perm_downcall_data</a> {
<a name="l00592"></a><a class="code" href="structperm__downcall__data.html#ad9b7e46dd17808aa7d5d7f44d84435c2">00592</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structperm__downcall__data.html#ad9b7e46dd17808aa7d5d7f44d84435c2">pdd_nid</a>;
<a name="l00593"></a><a class="code" href="structperm__downcall__data.html#ab88840a6c1c8060dc28edfc26a21fcac">00593</a>         __u32 <a class="code" href="structperm__downcall__data.html#ab88840a6c1c8060dc28edfc26a21fcac">pdd_perm</a>;
<a name="l00594"></a><a class="code" href="structperm__downcall__data.html#aea16bb8578fbcc3b79193c7435c947a4">00594</a>         __u32 <a class="code" href="structperm__downcall__data.html#aea16bb8578fbcc3b79193c7435c947a4">pdd_padding</a>;
<a name="l00595"></a>00595 };
<a name="l00596"></a>00596 
<a name="l00597"></a><a class="code" href="structidentity__downcall__data.html">00597</a> <span class="keyword">struct </span><a class="code" href="structidentity__downcall__data.html">identity_downcall_data</a> {
<a name="l00598"></a><a class="code" href="structidentity__downcall__data.html#ab704c0f216271e46b920a84fa51e90e8">00598</a>         __u32                            <a class="code" href="structidentity__downcall__data.html#ab704c0f216271e46b920a84fa51e90e8">idd_magic</a>;
<a name="l00599"></a><a class="code" href="structidentity__downcall__data.html#a8b7ba84651dc84f89ea36f41f39dcdaf">00599</a>         __u32                            <a class="code" href="structidentity__downcall__data.html#a8b7ba84651dc84f89ea36f41f39dcdaf">idd_err</a>;
<a name="l00600"></a><a class="code" href="structidentity__downcall__data.html#a731f9cf417bc2eb255c5933865931101">00600</a>         __u32                            <a class="code" href="structidentity__downcall__data.html#a731f9cf417bc2eb255c5933865931101">idd_uid</a>;
<a name="l00601"></a><a class="code" href="structidentity__downcall__data.html#af1b910900321cad1ef925a38830ea2ee">00601</a>         __u32                            <a class="code" href="structidentity__downcall__data.html#af1b910900321cad1ef925a38830ea2ee">idd_gid</a>;
<a name="l00602"></a><a class="code" href="structidentity__downcall__data.html#a5f55737205cf6c2d35cab8cac2a03117">00602</a>         __u32                            <a class="code" href="structidentity__downcall__data.html#a5f55737205cf6c2d35cab8cac2a03117">idd_nperms</a>;
<a name="l00603"></a><a class="code" href="structidentity__downcall__data.html#a6c5cf60c79701493a4302308609d544d">00603</a>         __u32                            <a class="code" href="structidentity__downcall__data.html#a6c5cf60c79701493a4302308609d544d">idd_ngroups</a>;
<a name="l00604"></a><a class="code" href="structidentity__downcall__data.html#a971af646cac0307573a7d0ac4a5c6b2e">00604</a>         <span class="keyword">struct </span><a class="code" href="structperm__downcall__data.html">perm_downcall_data</a> <a class="code" href="structidentity__downcall__data.html#a971af646cac0307573a7d0ac4a5c6b2e">idd_perms</a>[<a class="code" href="group__lustreuser.html#ga3b449b70d0860a0c3741ef6a5ee48229">N_PERMS_MAX</a>];
<a name="l00605"></a><a class="code" href="structidentity__downcall__data.html#a74d35bdcba59a38130c4fcc1ab8d38c6">00605</a>         __u32                            <a class="code" href="structidentity__downcall__data.html#a74d35bdcba59a38130c4fcc1ab8d38c6">idd_groups</a>[0];
<a name="l00606"></a>00606 };
<a name="l00607"></a>00607 
<a name="l00608"></a>00608 <span class="comment">/* for non-mapped uid/gid */</span>
<a name="l00609"></a><a class="code" href="group__lustreuser.html#ga9e23d33c76ddf5febb8ab0874f208286">00609</a> <span class="preprocessor">#define NOBODY_UID      99</span>
<a name="l00610"></a><a class="code" href="group__lustreuser.html#ga4a5671f4045df5b9e748de7474ba648e">00610</a> <span class="preprocessor"></span><span class="preprocessor">#define NOBODY_GID      99</span>
<a name="l00611"></a>00611 <span class="preprocessor"></span>
<a name="l00612"></a><a class="code" href="group__lustreuser.html#ga483b0a38edf0c10ef4a7cb633dc8a9fc">00612</a> <span class="preprocessor">#define INVALID_ID      (-1)</span>
<a name="l00613"></a>00613 <span class="preprocessor"></span>
<a name="l00614"></a>00614 <span class="keyword">enum</span> {
<a name="l00615"></a><a class="code" href="group__lustreuser.html#ggab48899087cc647f0f791ed0c459adc53ab4dabeebbdcc92b06222c6ccf69004dd">00615</a>         <a class="code" href="group__lustreuser.html#ggab48899087cc647f0f791ed0c459adc53ab4dabeebbdcc92b06222c6ccf69004dd">RMT_LSETFACL</a>    = 1,
<a name="l00616"></a><a class="code" href="group__lustreuser.html#ggab48899087cc647f0f791ed0c459adc53a0b9ce574003808693d6f4a02e2dd7045">00616</a>         <a class="code" href="group__lustreuser.html#ggab48899087cc647f0f791ed0c459adc53a0b9ce574003808693d6f4a02e2dd7045">RMT_LGETFACL</a>    = 2,
<a name="l00617"></a><a class="code" href="group__lustreuser.html#ggab48899087cc647f0f791ed0c459adc53a109cb9c094e6345d8afc88b4809d5765">00617</a>         <a class="code" href="group__lustreuser.html#ggab48899087cc647f0f791ed0c459adc53a109cb9c094e6345d8afc88b4809d5765">RMT_RSETFACL</a>    = 3,
<a name="l00618"></a><a class="code" href="group__lustreuser.html#ggab48899087cc647f0f791ed0c459adc53aca984a5704ebe65c355372ca3866d3be">00618</a>         <a class="code" href="group__lustreuser.html#ggab48899087cc647f0f791ed0c459adc53aca984a5704ebe65c355372ca3866d3be">RMT_RGETFACL</a>    = 4
<a name="l00619"></a>00619 };
<a name="l00620"></a>00620 
<a name="l00621"></a>00621 <span class="preprocessor">#ifdef NEED_QUOTA_DEFS</span>
<a name="l00622"></a>00622 <span class="preprocessor"></span><span class="preprocessor">#ifndef QIF_BLIMITS</span>
<a name="l00623"></a><a class="code" href="group__lustreuser.html#ga44b105270eb7ae0822aaf9e6681b9715">00623</a> <span class="preprocessor"></span><span class="preprocessor">#define QIF_BLIMITS     1</span>
<a name="l00624"></a><a class="code" href="group__lustreuser.html#ga54d3af9d1f3c65c3fdd0c8cadc32e396">00624</a> <span class="preprocessor"></span><span class="preprocessor">#define QIF_SPACE       2</span>
<a name="l00625"></a><a class="code" href="group__lustreuser.html#ga402d270349bd7d65dc9de0ba8c335653">00625</a> <span class="preprocessor"></span><span class="preprocessor">#define QIF_ILIMITS     4</span>
<a name="l00626"></a><a class="code" href="group__lustreuser.html#gac0dbf45e9fe857ff59b20c57cf2f14f0">00626</a> <span class="preprocessor"></span><span class="preprocessor">#define QIF_INODES      8</span>
<a name="l00627"></a><a class="code" href="group__lustreuser.html#gabfd0de266c5b4ac8b4014c8e914f1bd7">00627</a> <span class="preprocessor"></span><span class="preprocessor">#define QIF_BTIME       16</span>
<a name="l00628"></a><a class="code" href="group__lustreuser.html#ga05965e8a501d907c1484b4e2575bda12">00628</a> <span class="preprocessor"></span><span class="preprocessor">#define QIF_ITIME       32</span>
<a name="l00629"></a><a class="code" href="group__lustreuser.html#ga2c0864f56f876ec2b640491aa267c74f">00629</a> <span class="preprocessor"></span><span class="preprocessor">#define QIF_LIMITS      (QIF_BLIMITS | QIF_ILIMITS)</span>
<a name="l00630"></a><a class="code" href="group__lustreuser.html#gaff786b63612e10ae5e59a31430b87067">00630</a> <span class="preprocessor"></span><span class="preprocessor">#define QIF_USAGE       (QIF_SPACE | QIF_INODES)</span>
<a name="l00631"></a><a class="code" href="group__lustreuser.html#gaf630bcac4f1c5df45c694865852a1fad">00631</a> <span class="preprocessor"></span><span class="preprocessor">#define QIF_TIMES       (QIF_BTIME | QIF_ITIME)</span>
<a name="l00632"></a><a class="code" href="group__lustreuser.html#ga92d7badab2e81489958c3cea9a92dfd8">00632</a> <span class="preprocessor"></span><span class="preprocessor">#define QIF_ALL         (QIF_LIMITS | QIF_USAGE | QIF_TIMES)</span>
<a name="l00633"></a>00633 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00634"></a>00634 <span class="preprocessor"></span>
<a name="l00635"></a>00635 <span class="preprocessor">#endif </span><span class="comment">/* !__KERNEL__ */</span>
<a name="l00636"></a>00636 
<a name="l00637"></a>00637 <span class="comment">/* lustre volatile file support</span>
<a name="l00638"></a>00638 <span class="comment"> * file name header: .^L^S^T^R:volatile&quot;</span>
<a name="l00639"></a>00639 <span class="comment"> */</span>
<a name="l00640"></a><a class="code" href="group__lustreuser.html#gae5bdc0a10daa6473ca9341758a50f3d6">00640</a> <span class="preprocessor">#define LUSTRE_VOLATILE_HDR     &quot;.\x0c\x13\x14\x12:VOLATILE&quot;</span>
<a name="l00641"></a><a class="code" href="group__lustreuser.html#ga2e91cce7b77ddf8bbf4b349ed966faad">00641</a> <span class="preprocessor"></span><span class="preprocessor">#define LUSTRE_VOLATILE_HDR_LEN 14</span>
<a name="l00642"></a>00642 <span class="preprocessor"></span>
<a name="l00643"></a><a class="code" href="group__lustreuser.html#gab735eaa41f1b82191956884f82fe7d43">00643</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gab735eaa41f1b82191956884f82fe7d43">lustre_quota_version</a> {
<a name="l00644"></a><a class="code" href="group__lustreuser.html#ggab735eaa41f1b82191956884f82fe7d43a70032b143efe91b4a90870c4254dbc55">00644</a>         <a class="code" href="group__lustreuser.html#ggab735eaa41f1b82191956884f82fe7d43a70032b143efe91b4a90870c4254dbc55">LUSTRE_QUOTA_V2</a> = 1
<a name="l00645"></a>00645 } <a class="code" href="group__lustreuser.html#ga54563e5f27f4b23fb278e49b04f4ba6c">lustre_quota_version_t</a>;
<a name="l00646"></a>00646 
<a name="l00647"></a>00647 <span class="comment">/* XXX: same as if_dqinfo struct in kernel */</span>
<a name="l00648"></a><a class="code" href="structobd__dqinfo.html">00648</a> <span class="keyword">struct </span><a class="code" href="structobd__dqinfo.html">obd_dqinfo</a> {
<a name="l00649"></a><a class="code" href="structobd__dqinfo.html#a79415941d144d11aaa5b7354cc21c302">00649</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structobd__dqinfo.html#a79415941d144d11aaa5b7354cc21c302">dqi_bgrace</a>;
<a name="l00650"></a><a class="code" href="structobd__dqinfo.html#aab3e70013712aeb2cec48528fccda7e3">00650</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structobd__dqinfo.html#aab3e70013712aeb2cec48528fccda7e3">dqi_igrace</a>;
<a name="l00651"></a><a class="code" href="structobd__dqinfo.html#a9e1893e463f703df2d4ad6ea0a193d4a">00651</a>         __u32 <a class="code" href="structobd__dqinfo.html#a9e1893e463f703df2d4ad6ea0a193d4a">dqi_flags</a>;
<a name="l00652"></a><a class="code" href="structobd__dqinfo.html#ac13108e3ebb35eeed2b03845bec62968">00652</a>         __u32 <a class="code" href="structobd__dqinfo.html#ac13108e3ebb35eeed2b03845bec62968">dqi_valid</a>;
<a name="l00653"></a>00653 };
<a name="l00654"></a>00654 
<a name="l00655"></a>00655 <span class="comment">/* XXX: same as if_dqblk struct in kernel, plus one padding */</span>
<a name="l00656"></a><a class="code" href="structobd__dqblk.html">00656</a> <span class="keyword">struct </span><a class="code" href="structobd__dqblk.html">obd_dqblk</a> {
<a name="l00657"></a><a class="code" href="structobd__dqblk.html#affd5cf3e1a0aeee6bc7e822a45b7dffe">00657</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structobd__dqblk.html#affd5cf3e1a0aeee6bc7e822a45b7dffe">dqb_bhardlimit</a>;
<a name="l00658"></a><a class="code" href="structobd__dqblk.html#a8a9b427abd384eccbbc560f6b8ba6e17">00658</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structobd__dqblk.html#a8a9b427abd384eccbbc560f6b8ba6e17">dqb_bsoftlimit</a>;
<a name="l00659"></a><a class="code" href="structobd__dqblk.html#a5aa03e351791e9cf09a12f32789f2040">00659</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structobd__dqblk.html#a5aa03e351791e9cf09a12f32789f2040">dqb_curspace</a>;
<a name="l00660"></a><a class="code" href="structobd__dqblk.html#adaf461d51eca9ed0c1eb33a052ec1f9e">00660</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structobd__dqblk.html#adaf461d51eca9ed0c1eb33a052ec1f9e">dqb_ihardlimit</a>;
<a name="l00661"></a><a class="code" href="structobd__dqblk.html#a10df1256eec6da70180875f0f9b683fc">00661</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structobd__dqblk.html#a10df1256eec6da70180875f0f9b683fc">dqb_isoftlimit</a>;
<a name="l00662"></a><a class="code" href="structobd__dqblk.html#a8ba495c46c1830b5cae65eab46464345">00662</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structobd__dqblk.html#a8ba495c46c1830b5cae65eab46464345">dqb_curinodes</a>;
<a name="l00663"></a><a class="code" href="structobd__dqblk.html#ad6d7540fbadc5319d5d70aab05538640">00663</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structobd__dqblk.html#ad6d7540fbadc5319d5d70aab05538640">dqb_btime</a>;
<a name="l00664"></a><a class="code" href="structobd__dqblk.html#a240ffd0188af4b74e62845ddf69c1ddc">00664</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structobd__dqblk.html#a240ffd0188af4b74e62845ddf69c1ddc">dqb_itime</a>;
<a name="l00665"></a><a class="code" href="structobd__dqblk.html#ae0695eab0a653977a549f3d2b14fa025">00665</a>         __u32 <a class="code" href="structobd__dqblk.html#ae0695eab0a653977a549f3d2b14fa025">dqb_valid</a>;
<a name="l00666"></a><a class="code" href="structobd__dqblk.html#a0cd9508d132ff8e5fa6216ed57a9074c">00666</a>         __u32 <a class="code" href="structobd__dqblk.html#a0cd9508d132ff8e5fa6216ed57a9074c">dqb_padding</a>;
<a name="l00667"></a>00667 };
<a name="l00668"></a>00668 
<a name="l00669"></a>00669 <span class="keyword">enum</span> {
<a name="l00670"></a><a class="code" href="group__lustreuser.html#gga458e651af6690959efa2afb96be7d609aae44d3edec3d42e769681561e64f7bda">00670</a>         <a class="code" href="group__lustreuser.html#gga458e651af6690959efa2afb96be7d609aae44d3edec3d42e769681561e64f7bda">QC_GENERAL</a>      = 0,
<a name="l00671"></a><a class="code" href="group__lustreuser.html#gga458e651af6690959efa2afb96be7d609aa7da3a55affababd97f6340ab65297b3">00671</a>         <a class="code" href="group__lustreuser.html#gga458e651af6690959efa2afb96be7d609aa7da3a55affababd97f6340ab65297b3">QC_MDTIDX</a>       = 1,
<a name="l00672"></a><a class="code" href="group__lustreuser.html#gga458e651af6690959efa2afb96be7d609abea34bf45280b421f9d8a62ee38669af">00672</a>         <a class="code" href="group__lustreuser.html#gga458e651af6690959efa2afb96be7d609abea34bf45280b421f9d8a62ee38669af">QC_OSTIDX</a>       = 2,
<a name="l00673"></a><a class="code" href="group__lustreuser.html#gga458e651af6690959efa2afb96be7d609ab1f6d7acde184200af0013ef1560a13a">00673</a>         <a class="code" href="group__lustreuser.html#gga458e651af6690959efa2afb96be7d609ab1f6d7acde184200af0013ef1560a13a">QC_UUID</a>         = 3
<a name="l00674"></a>00674 };
<a name="l00675"></a>00675 
<a name="l00676"></a><a class="code" href="structif__quotactl.html">00676</a> <span class="keyword">struct </span><a class="code" href="structif__quotactl.html">if_quotactl</a> {
<a name="l00677"></a><a class="code" href="structif__quotactl.html#aea1076820c51897849020a4c7df29876">00677</a>         __u32                   <a class="code" href="structif__quotactl.html#aea1076820c51897849020a4c7df29876">qc_cmd</a>;
<a name="l00678"></a><a class="code" href="structif__quotactl.html#aa2301bf533b01a907094657607bd6a10">00678</a>         __u32                   <a class="code" href="structif__quotactl.html#aa2301bf533b01a907094657607bd6a10">qc_type</a>;
<a name="l00679"></a><a class="code" href="structif__quotactl.html#a13d8feaef533f0b01ea6a5e89dc14c6c">00679</a>         __u32                   <a class="code" href="structif__quotactl.html#a13d8feaef533f0b01ea6a5e89dc14c6c">qc_id</a>;
<a name="l00680"></a><a class="code" href="structif__quotactl.html#a3aff76590ab7e9adb9f3e0a27f199cf8">00680</a>         __u32                   <a class="code" href="structif__quotactl.html#a3aff76590ab7e9adb9f3e0a27f199cf8">qc_stat</a>;
<a name="l00681"></a><a class="code" href="structif__quotactl.html#a87dc0d741c73cde196715bdb76e112e6">00681</a>         __u32                   <a class="code" href="structif__quotactl.html#a87dc0d741c73cde196715bdb76e112e6">qc_valid</a>;
<a name="l00682"></a><a class="code" href="structif__quotactl.html#a475a3dd42a1e084819df1da84fcc6211">00682</a>         __u32                   <a class="code" href="structif__quotactl.html#a475a3dd42a1e084819df1da84fcc6211">qc_idx</a>;
<a name="l00683"></a><a class="code" href="structif__quotactl.html#aa737f5ca997ebc807a72d55c9819e551">00683</a>         <span class="keyword">struct </span><a class="code" href="structobd__dqinfo.html">obd_dqinfo</a>       <a class="code" href="structif__quotactl.html#aa737f5ca997ebc807a72d55c9819e551">qc_dqinfo</a>;
<a name="l00684"></a><a class="code" href="structif__quotactl.html#a9ba8e58a7423c17d0dc48cc36d0aff2c">00684</a>         <span class="keyword">struct </span><a class="code" href="structobd__dqblk.html">obd_dqblk</a>        <a class="code" href="structif__quotactl.html#a9ba8e58a7423c17d0dc48cc36d0aff2c">qc_dqblk</a>;
<a name="l00685"></a><a class="code" href="structif__quotactl.html#ad2ccab733ed258a55b051d02b6943716">00685</a>         <span class="keywordtype">char</span>                    <a class="code" href="structobd__type.html">obd_type</a>[16];
<a name="l00686"></a><a class="code" href="structif__quotactl.html#ac655440c7d009b98beb041657f05d74d">00686</a>         <span class="keyword">struct </span><a class="code" href="structobd__uuid.html">obd_uuid</a>         <a class="code" href="structobd__uuid.html">obd_uuid</a>;
<a name="l00687"></a>00687 };
<a name="l00688"></a>00688 
<a name="l00689"></a>00689 <span class="comment">/* swap layout flags */</span>
<a name="l00690"></a><a class="code" href="group__lustreuser.html#ga0fc307c2f1e452c0208be9265181cbc0">00690</a> <span class="preprocessor">#define SWAP_LAYOUTS_CHECK_DV1          (1 &lt;&lt; 0)</span>
<a name="l00691"></a><a class="code" href="group__lustreuser.html#ga4d667fa4cda4f8eb2948415cba1e0a00">00691</a> <span class="preprocessor"></span><span class="preprocessor">#define SWAP_LAYOUTS_CHECK_DV2          (1 &lt;&lt; 1)</span>
<a name="l00692"></a><a class="code" href="group__lustreuser.html#ga76531698d77f9b4f61bb393252598b2d">00692</a> <span class="preprocessor"></span><span class="preprocessor">#define SWAP_LAYOUTS_KEEP_MTIME         (1 &lt;&lt; 2)</span>
<a name="l00693"></a><a class="code" href="group__lustreuser.html#ga0a78763fa891c6d32f6ed301c3dddb27">00693</a> <span class="preprocessor"></span><span class="preprocessor">#define SWAP_LAYOUTS_KEEP_ATIME         (1 &lt;&lt; 3)</span>
<a name="l00694"></a><a class="code" href="group__lustreuser.html#ga7e3edc945120dad9e82682180e5298ae">00694</a> <span class="preprocessor"></span><span class="preprocessor">#define SWAP_LAYOUTS_CLOSE              (1 &lt;&lt; 4)</span>
<a name="l00695"></a>00695 <span class="preprocessor"></span>
<a name="l00696"></a>00696 <span class="comment">/* Swap XATTR_NAME_HSM as well, only on the MDT so far */</span>
<a name="l00697"></a><a class="code" href="group__lustreuser.html#gaed8797fb47c4e0f000106d7f367d4c9d">00697</a> <span class="preprocessor">#define SWAP_LAYOUTS_MDS_HSM            (1 &lt;&lt; 31)</span>
<a name="l00698"></a><a class="code" href="structlustre__swap__layouts.html">00698</a> <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="structlustre__swap__layouts.html">lustre_swap_layouts</a> {
<a name="l00699"></a><a class="code" href="structlustre__swap__layouts.html#aafc4070c2bd6a0f4352b88ddcb94c96a">00699</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlustre__swap__layouts.html#aafc4070c2bd6a0f4352b88ddcb94c96a">sl_flags</a>;
<a name="l00700"></a><a class="code" href="structlustre__swap__layouts.html#a43cd459b5ba170c952459f6ba3ea3fa2">00700</a>         __u32   <a class="code" href="structlustre__swap__layouts.html#a43cd459b5ba170c952459f6ba3ea3fa2">sl_fd</a>;
<a name="l00701"></a><a class="code" href="structlustre__swap__layouts.html#ae13e68d7ee47ea1c5623a276fbba490a">00701</a>         __u32   <a class="code" href="structlustre__swap__layouts.html#ae13e68d7ee47ea1c5623a276fbba490a">sl_gid</a>;
<a name="l00702"></a><a class="code" href="structlustre__swap__layouts.html#a51706ce3b524ad056bc5dfc3492305e4">00702</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlustre__swap__layouts.html#a51706ce3b524ad056bc5dfc3492305e4">sl_dv1</a>;
<a name="l00703"></a><a class="code" href="structlustre__swap__layouts.html#ac752c6fc4e217c26d677300ed8f72922">00703</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structlustre__swap__layouts.html#ac752c6fc4e217c26d677300ed8f72922">sl_dv2</a>;
<a name="l00704"></a>00704 };
<a name="l00705"></a>00705 
<a name="l00706"></a>00706 
<a name="l00707"></a>00707 <span class="comment">/********* Changelogs **********/</span>
<a name="l00709"></a><a class="code" href="group__lustreuser.html#ga5aecf326bf672ba1d2483e0a53064d7b">00709</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga5aecf326bf672ba1d2483e0a53064d7b" title="Changelog record types.">changelog_rec_type</a> {
<a name="l00710"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7bae478f2a558d1f67f9932b54a55d8cf3e">00710</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7bae478f2a558d1f67f9932b54a55d8cf3e">CL_MARK</a>     = 0,
<a name="l00711"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba40ca5c095e06259c23eb17228dfef75e">00711</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba40ca5c095e06259c23eb17228dfef75e">CL_CREATE</a>   = 1,  <span class="comment">/* namespace */</span>
<a name="l00712"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba7a3be0c9ddc07fc15f96930734149382">00712</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba7a3be0c9ddc07fc15f96930734149382">CL_MKDIR</a>    = 2,  <span class="comment">/* namespace */</span>
<a name="l00713"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba5df1abf10225d5cf3ca1df2d6e400c5d">00713</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba5df1abf10225d5cf3ca1df2d6e400c5d">CL_HARDLINK</a> = 3,  <span class="comment">/* namespace */</span>
<a name="l00714"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba6d556f1e022e9827db28c999ef394a4c">00714</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba6d556f1e022e9827db28c999ef394a4c">CL_SOFTLINK</a> = 4,  <span class="comment">/* namespace */</span>
<a name="l00715"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7badadf56b79ccbca29a4d2f536fbb96ec7">00715</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7badadf56b79ccbca29a4d2f536fbb96ec7">CL_MKNOD</a>    = 5,  <span class="comment">/* namespace */</span>
<a name="l00716"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7baa352ba9c359fb474b93956687dddd184">00716</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7baa352ba9c359fb474b93956687dddd184">CL_UNLINK</a>   = 6,  <span class="comment">/* namespace */</span>
<a name="l00717"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba9f3bee832f56d47392c09dce816616c5">00717</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba9f3bee832f56d47392c09dce816616c5">CL_RMDIR</a>    = 7,  <span class="comment">/* namespace */</span>
<a name="l00718"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba0e72d94ee406f73274a323d9999ded35">00718</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba0e72d94ee406f73274a323d9999ded35">CL_RENAME</a>   = 8,  <span class="comment">/* namespace */</span>
<a name="l00719"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba4d2bcc2c8317744f5e83de6e56477303">00719</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba4d2bcc2c8317744f5e83de6e56477303">CL_EXT</a>      = 9,  <span class="comment">/* namespace extended record (2nd half of rename) */</span>
<a name="l00720"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7baf1be0179a4ea75fc4a6c55b0752870b8">00720</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7baf1be0179a4ea75fc4a6c55b0752870b8">CL_OPEN</a>     = 10, <span class="comment">/* not currently used */</span>
<a name="l00721"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7bac98131c1ebc7258c6d79f29151c65380">00721</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7bac98131c1ebc7258c6d79f29151c65380">CL_CLOSE</a>    = 11, <span class="comment">/* may be written to log only with mtime change */</span>
<a name="l00722"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba6337920e493a7f7e6dd7b9ab9c804ae7">00722</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba6337920e493a7f7e6dd7b9ab9c804ae7">CL_LAYOUT</a>   = 12, <span class="comment">/* file layout/striping modified */</span>
<a name="l00723"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba3b7196195a435e640dd7d232fda8e071">00723</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba3b7196195a435e640dd7d232fda8e071">CL_TRUNC</a>    = 13,
<a name="l00724"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7bad6442ee5724b743038c6700b850e373d">00724</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7bad6442ee5724b743038c6700b850e373d">CL_SETATTR</a>  = 14,
<a name="l00725"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7bacf6a4da47536b2d108bb5671d4f7e5a5">00725</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7bacf6a4da47536b2d108bb5671d4f7e5a5">CL_XATTR</a>    = 15,
<a name="l00726"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba8ceb5747291cc404ef591a13dacd0999">00726</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba8ceb5747291cc404ef591a13dacd0999">CL_HSM</a>      = 16, <span class="comment">/* HSM specific events, see flags */</span>
<a name="l00727"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba3f9c61c3cf110a8ebba75c6ed1c39241">00727</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba3f9c61c3cf110a8ebba75c6ed1c39241">CL_MTIME</a>    = 17, <span class="comment">/* Precedence: setattr &gt; mtime &gt; ctime &gt; atime */</span>
<a name="l00728"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7bae3bcafc27049720496d138b66634fefe">00728</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7bae3bcafc27049720496d138b66634fefe">CL_CTIME</a>    = 18,
<a name="l00729"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba3bbfcfb3034575a47ac1057b67966fdc">00729</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba3bbfcfb3034575a47ac1057b67966fdc">CL_ATIME</a>    = 19,
<a name="l00730"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7babca4231295fd97ea1293c15bc4adcf26">00730</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7babca4231295fd97ea1293c15bc4adcf26">CL_MIGRATE</a>  = 20,
<a name="l00731"></a><a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba191961568e4ee46f41dddf66ce7eeeb2">00731</a>         <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba191961568e4ee46f41dddf66ce7eeeb2">CL_LAST</a>
<a name="l00732"></a>00732 };
<a name="l00733"></a>00733 
<a name="l00734"></a><a class="code" href="group__lustreuser.html#ga312093679284860c08bbd050fe13c883">00734</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__lustreuser.html#ga312093679284860c08bbd050fe13c883">changelog_type2str</a>(<span class="keywordtype">int</span> type) {
<a name="l00735"></a>00735         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *changelog_str[] = {
<a name="l00736"></a>00736                 <span class="stringliteral">&quot;MARK&quot;</span>,  <span class="stringliteral">&quot;CREAT&quot;</span>, <span class="stringliteral">&quot;MKDIR&quot;</span>, <span class="stringliteral">&quot;HLINK&quot;</span>, <span class="stringliteral">&quot;SLINK&quot;</span>, <span class="stringliteral">&quot;MKNOD&quot;</span>, <span class="stringliteral">&quot;UNLNK&quot;</span>,
<a name="l00737"></a>00737                 <span class="stringliteral">&quot;RMDIR&quot;</span>, <span class="stringliteral">&quot;RENME&quot;</span>, <span class="stringliteral">&quot;RNMTO&quot;</span>, <span class="stringliteral">&quot;OPEN&quot;</span>,  <span class="stringliteral">&quot;CLOSE&quot;</span>, <span class="stringliteral">&quot;LYOUT&quot;</span>, <span class="stringliteral">&quot;TRUNC&quot;</span>,
<a name="l00738"></a>00738                 <span class="stringliteral">&quot;SATTR&quot;</span>, <span class="stringliteral">&quot;XATTR&quot;</span>, <span class="stringliteral">&quot;HSM&quot;</span>,   <span class="stringliteral">&quot;MTIME&quot;</span>, <span class="stringliteral">&quot;CTIME&quot;</span>, <span class="stringliteral">&quot;ATIME&quot;</span>, <span class="stringliteral">&quot;MIGRT&quot;</span>
<a name="l00739"></a>00739         };
<a name="l00740"></a>00740 
<a name="l00741"></a>00741         <span class="keywordflow">if</span> (type &gt;= 0 &amp;&amp; type &lt; <a class="code" href="group__lustreuser.html#gga5aecf326bf672ba1d2483e0a53064d7ba191961568e4ee46f41dddf66ce7eeeb2">CL_LAST</a>)
<a name="l00742"></a>00742                 <span class="keywordflow">return</span> changelog_str[type];
<a name="l00743"></a>00743         <span class="keywordflow">return</span> NULL;
<a name="l00744"></a>00744 }
<a name="l00745"></a>00745 
<a name="l00746"></a>00746 <span class="comment">/* per-record flags */</span>
<a name="l00747"></a><a class="code" href="group__lustreuser.html#gade641e8b14999e949d33e76f9e2ac766">00747</a> <span class="preprocessor">#define CLF_FLAGSHIFT   12</span>
<a name="l00748"></a><a class="code" href="group__lustreuser.html#ga7b711b66e8aa71e02342e9d9f4ce74db">00748</a> <span class="preprocessor"></span><span class="preprocessor">#define CLF_FLAGMASK    ((1U &lt;&lt; CLF_FLAGSHIFT) - 1)</span>
<a name="l00749"></a><a class="code" href="group__lustreuser.html#gaba4d7261210b647024000ff73252869e">00749</a> <span class="preprocessor"></span><span class="preprocessor">#define CLF_VERMASK     (~CLF_FLAGMASK)</span>
<a name="l00750"></a><a class="code" href="group__lustreuser.html#gafd9a43c6bdc39d72c3113806a84be46a">00750</a> <span class="preprocessor"></span><span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gafd9a43c6bdc39d72c3113806a84be46a">changelog_rec_flags</a> {
<a name="l00751"></a><a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aafcb030c80dab37b2206cd78eba8957c7">00751</a>         <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aafcb030c80dab37b2206cd78eba8957c7">CLF_VERSION</a>     = 0x1000,
<a name="l00752"></a><a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aa3a0fa7d565764b4cd9dc2cc3086c1087">00752</a>         <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aa3a0fa7d565764b4cd9dc2cc3086c1087">CLF_RENAME</a>      = 0x2000,
<a name="l00753"></a><a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aaf7154a276a13849d6ebd961767bab893">00753</a>         <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aaf7154a276a13849d6ebd961767bab893">CLF_JOBID</a>       = 0x4000,
<a name="l00754"></a><a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aa2d0c5d0480da5776b9e6f653c09fcd7f">00754</a>         <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aa2d0c5d0480da5776b9e6f653c09fcd7f">CLF_SUPPORTED</a>   = <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aafcb030c80dab37b2206cd78eba8957c7">CLF_VERSION</a> | <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aa3a0fa7d565764b4cd9dc2cc3086c1087">CLF_RENAME</a> | <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aaf7154a276a13849d6ebd961767bab893">CLF_JOBID</a>
<a name="l00755"></a>00755 };
<a name="l00756"></a>00756 
<a name="l00757"></a>00757 
<a name="l00758"></a>00758 <span class="comment">/* Anything under the flagmask may be per-type (if desired) */</span>
<a name="l00759"></a>00759 <span class="comment">/* Flags for unlink */</span>
<a name="l00760"></a><a class="code" href="group__lustreuser.html#gaba7efe88056bebae619259c95f46204f">00760</a> <span class="preprocessor">#define CLF_UNLINK_LAST       0x0001 </span><span class="comment">/* Unlink of last hardlink */</span>
<a name="l00761"></a><a class="code" href="group__lustreuser.html#ga3fedbde3283a62004204a80dddef8fa0">00761</a> <span class="preprocessor">#define CLF_UNLINK_HSM_EXISTS 0x0002 </span><span class="comment">/* File has something in HSM */</span>
<a name="l00762"></a>00762                                      <span class="comment">/* HSM cleaning needed */</span>
<a name="l00763"></a>00763 <span class="comment">/* Flags for rename */</span>
<a name="l00764"></a><a class="code" href="group__lustreuser.html#ga42919737a2c41b28679d8ae4553f9ddd">00764</a> <span class="preprocessor">#define CLF_RENAME_LAST         0x0001 </span><span class="comment">/* rename unlink last hardlink</span>
<a name="l00765"></a>00765 <span class="comment">                                        * of target */</span>
<a name="l00766"></a><a class="code" href="group__lustreuser.html#gaca84f58d438587c6c8f0a29e0b31c49d">00766</a> <span class="preprocessor">#define CLF_RENAME_LAST_EXISTS  0x0002 </span><span class="comment">/* rename unlink last hardlink of target</span>
<a name="l00767"></a>00767 <span class="comment">                                        * has an archive in backend */</span>
<a name="l00768"></a>00768 
<a name="l00769"></a>00769 <span class="comment">/* Flags for HSM */</span>
<a name="l00770"></a>00770 <span class="comment">/* 12b used (from high weight to low weight):</span>
<a name="l00771"></a>00771 <span class="comment"> * 2b for flags</span>
<a name="l00772"></a>00772 <span class="comment"> * 3b for event</span>
<a name="l00773"></a>00773 <span class="comment"> * 7b for error code</span>
<a name="l00774"></a>00774 <span class="comment"> */</span>
<a name="l00775"></a><a class="code" href="group__lustreuser.html#gab3e0fd85353813a8c354091747c2873a">00775</a> <span class="preprocessor">#define CLF_HSM_ERR_L        0 </span><span class="comment">/* HSM return code, 7 bits */</span>
<a name="l00776"></a><a class="code" href="group__lustreuser.html#ga9ffae878b178390ea3084470d07aac12">00776</a> <span class="preprocessor">#define CLF_HSM_ERR_H        6</span>
<a name="l00777"></a><a class="code" href="group__lustreuser.html#ga4fdb50a9fe704063f2124ce003017b65">00777</a> <span class="preprocessor"></span><span class="preprocessor">#define CLF_HSM_EVENT_L      7 </span><span class="comment">/* HSM event, 3 bits, see enum hsm_event */</span>
<a name="l00778"></a><a class="code" href="group__lustreuser.html#gac905e098fc064f9c5d9ca4d894193414">00778</a> <span class="preprocessor">#define CLF_HSM_EVENT_H      9</span>
<a name="l00779"></a><a class="code" href="group__lustreuser.html#gade55f0b14587ee27641966d978abb4da">00779</a> <span class="preprocessor"></span><span class="preprocessor">#define CLF_HSM_FLAG_L      10 </span><span class="comment">/* HSM flags, 2 bits, 1 used, 1 spare */</span>
<a name="l00780"></a><a class="code" href="group__lustreuser.html#ga942c5854c17f6b37e42840ce5d9914f2">00780</a> <span class="preprocessor">#define CLF_HSM_FLAG_H      11</span>
<a name="l00781"></a><a class="code" href="group__lustreuser.html#gae1ce4127e3e0c3da4235d6dea8aebae6">00781</a> <span class="preprocessor"></span><span class="preprocessor">#define CLF_HSM_SPARE_L     12 </span><span class="comment">/* 4 spare bits */</span>
<a name="l00782"></a><a class="code" href="group__lustreuser.html#ga75e7d68e38a7622e4ef6568af3ce7a10">00782</a> <span class="preprocessor">#define CLF_HSM_SPARE_H     15</span>
<a name="l00783"></a><a class="code" href="group__lustreuser.html#gab2b81f9d0fe7ebb13b9caa6bf97bae7f">00783</a> <span class="preprocessor"></span><span class="preprocessor">#define CLF_HSM_LAST        15</span>
<a name="l00784"></a>00784 <span class="preprocessor"></span>
<a name="l00785"></a>00785 <span class="comment">/* Remove bits higher than _h, then extract the value</span>
<a name="l00786"></a>00786 <span class="comment"> * between _h and _l by shifting lower weigth to bit 0. */</span>
<a name="l00787"></a><a class="code" href="group__lustreuser.html#gaa3dd41f8698b19b8ff2f6a69db70640b">00787</a> <span class="preprocessor">#define CLF_GET_BITS(_b, _h, _l) (((_b &lt;&lt; (CLF_HSM_LAST - _h)) &amp; 0xFFFF) \</span>
<a name="l00788"></a>00788 <span class="preprocessor">                                   &gt;&gt; (CLF_HSM_LAST - _h + _l))</span>
<a name="l00789"></a>00789 <span class="preprocessor"></span>
<a name="l00790"></a><a class="code" href="group__lustreuser.html#gaf70d4cc169385e4253654014664c26ce">00790</a> <span class="preprocessor">#define CLF_HSM_SUCCESS      0x00</span>
<a name="l00791"></a><a class="code" href="group__lustreuser.html#ga77e8f2ec31aa7c5507edc0a9dee2fd0a">00791</a> <span class="preprocessor"></span><span class="preprocessor">#define CLF_HSM_MAXERROR     0x7E</span>
<a name="l00792"></a><a class="code" href="group__lustreuser.html#ga2a654a0c592789f632e5fb6a63544548">00792</a> <span class="preprocessor"></span><span class="preprocessor">#define CLF_HSM_ERROVERFLOW  0x7F</span>
<a name="l00793"></a>00793 <span class="preprocessor"></span>
<a name="l00794"></a><a class="code" href="group__lustreuser.html#ga52c20b65c065648951d71db359e9c8fc">00794</a> <span class="preprocessor">#define CLF_HSM_DIRTY        1 </span><span class="comment">/* file is dirty after HSM request end */</span>
<a name="l00795"></a>00795 
<a name="l00796"></a>00796 <span class="comment">/* 3 bits field =&gt; 8 values allowed */</span>
<a name="l00797"></a><a class="code" href="group__lustreuser.html#gaa50b9ab8010d713229f48f0c97a6be32">00797</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gaa50b9ab8010d713229f48f0c97a6be32">hsm_event</a> {
<a name="l00798"></a><a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a226010753b7b4f394134497533a27803">00798</a>         <a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a226010753b7b4f394134497533a27803">HE_ARCHIVE</a>      = 0,
<a name="l00799"></a><a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a2e576698b183fc2a27f458a2166442e6">00799</a>         <a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a2e576698b183fc2a27f458a2166442e6">HE_RESTORE</a>      = 1,
<a name="l00800"></a><a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32aaa0964ca4d4a30907b250ec188143aa2">00800</a>         <a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32aaa0964ca4d4a30907b250ec188143aa2">HE_CANCEL</a>       = 2,
<a name="l00801"></a><a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a777ff728e10388f610241116ff196a98">00801</a>         <a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a777ff728e10388f610241116ff196a98">HE_RELEASE</a>      = 3,
<a name="l00802"></a><a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a2d6afdcfac9ac126006ae015b5fc3bc8">00802</a>         <a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a2d6afdcfac9ac126006ae015b5fc3bc8">HE_REMOVE</a>       = 4,
<a name="l00803"></a><a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a088e87d58438479df732aaf991a45a57">00803</a>         <a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a088e87d58438479df732aaf991a45a57">HE_STATE</a>        = 5,
<a name="l00804"></a><a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a2149f2c31ab871385721620c499208d0">00804</a>         <a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a2149f2c31ab871385721620c499208d0">HE_SPARE1</a>       = 6,
<a name="l00805"></a><a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a4ee1b2f09f161d15195dba39d7b2b9ca">00805</a>         <a class="code" href="group__lustreuser.html#ggaa50b9ab8010d713229f48f0c97a6be32a4ee1b2f09f161d15195dba39d7b2b9ca">HE_SPARE2</a>       = 7,
<a name="l00806"></a>00806 };
<a name="l00807"></a>00807 
<a name="l00808"></a><a class="code" href="group__lustreuser.html#ga861f58b7aedd3abce86a3afa20b4522d">00808</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gaa50b9ab8010d713229f48f0c97a6be32">hsm_event</a> <a class="code" href="group__lustreuser.html#ga861f58b7aedd3abce86a3afa20b4522d">hsm_get_cl_event</a>(__u16 flags)
<a name="l00809"></a>00809 {
<a name="l00810"></a>00810         <span class="keywordflow">return</span> (<span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gaa50b9ab8010d713229f48f0c97a6be32">hsm_event</a>)<a class="code" href="group__lustreuser.html#gaa3dd41f8698b19b8ff2f6a69db70640b">CLF_GET_BITS</a>(flags, <a class="code" href="group__lustreuser.html#gac905e098fc064f9c5d9ca4d894193414">CLF_HSM_EVENT_H</a>,
<a name="l00811"></a>00811                                             <a class="code" href="group__lustreuser.html#ga4fdb50a9fe704063f2124ce003017b65">CLF_HSM_EVENT_L</a>);
<a name="l00812"></a>00812 }
<a name="l00813"></a>00813 
<a name="l00814"></a><a class="code" href="group__lustreuser.html#ga3658d89436281f730d2611cdbfb6d347">00814</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__lustreuser.html#ga3658d89436281f730d2611cdbfb6d347">hsm_set_cl_event</a>(<span class="keywordtype">int</span> *flags, <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gaa50b9ab8010d713229f48f0c97a6be32">hsm_event</a> he)
<a name="l00815"></a>00815 {
<a name="l00816"></a>00816         *flags |= (he &lt;&lt; <a class="code" href="group__lustreuser.html#ga4fdb50a9fe704063f2124ce003017b65">CLF_HSM_EVENT_L</a>);
<a name="l00817"></a>00817 }
<a name="l00818"></a>00818 
<a name="l00819"></a><a class="code" href="group__lustreuser.html#gab44140c591d649703342f0c8c240511a">00819</a> <span class="keyword">static</span> <span class="keyword">inline</span> __u16 <a class="code" href="group__lustreuser.html#gab44140c591d649703342f0c8c240511a">hsm_get_cl_flags</a>(<span class="keywordtype">int</span> flags)
<a name="l00820"></a>00820 {
<a name="l00821"></a>00821         <span class="keywordflow">return</span> <a class="code" href="group__lustreuser.html#gaa3dd41f8698b19b8ff2f6a69db70640b">CLF_GET_BITS</a>(flags, <a class="code" href="group__lustreuser.html#ga942c5854c17f6b37e42840ce5d9914f2">CLF_HSM_FLAG_H</a>, <a class="code" href="group__lustreuser.html#gade55f0b14587ee27641966d978abb4da">CLF_HSM_FLAG_L</a>);
<a name="l00822"></a>00822 }
<a name="l00823"></a>00823 
<a name="l00824"></a><a class="code" href="group__lustreuser.html#ga78a9577b39d00a6b17e81c16ddc29ca4">00824</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__lustreuser.html#ga78a9577b39d00a6b17e81c16ddc29ca4">hsm_set_cl_flags</a>(<span class="keywordtype">int</span> *flags, <span class="keywordtype">int</span> bits)
<a name="l00825"></a>00825 {
<a name="l00826"></a>00826         *flags |= (bits &lt;&lt; <a class="code" href="group__lustreuser.html#gade55f0b14587ee27641966d978abb4da">CLF_HSM_FLAG_L</a>);
<a name="l00827"></a>00827 }
<a name="l00828"></a>00828 
<a name="l00829"></a><a class="code" href="group__lustreuser.html#gae965c8dce80b6846eb24db7acbeec887">00829</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__lustreuser.html#gae965c8dce80b6846eb24db7acbeec887">hsm_get_cl_error</a>(<span class="keywordtype">int</span> flags)
<a name="l00830"></a>00830 {
<a name="l00831"></a>00831         <span class="keywordflow">return</span> <a class="code" href="group__lustreuser.html#gaa3dd41f8698b19b8ff2f6a69db70640b">CLF_GET_BITS</a>(flags, <a class="code" href="group__lustreuser.html#ga9ffae878b178390ea3084470d07aac12">CLF_HSM_ERR_H</a>, <a class="code" href="group__lustreuser.html#gab3e0fd85353813a8c354091747c2873a">CLF_HSM_ERR_L</a>);
<a name="l00832"></a>00832 }
<a name="l00833"></a>00833 
<a name="l00834"></a><a class="code" href="group__lustreuser.html#gac8f7f8ea0723fdb7c1119c50d16894a0">00834</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__lustreuser.html#gac8f7f8ea0723fdb7c1119c50d16894a0">hsm_set_cl_error</a>(<span class="keywordtype">int</span> *flags, <span class="keywordtype">int</span> <a class="code" href="it__test_8c.html#ae70cde843eddd6d7c493335f157da127">error</a>)
<a name="l00835"></a>00835 {
<a name="l00836"></a>00836         *flags |= (error &lt;&lt; <a class="code" href="group__lustreuser.html#gab3e0fd85353813a8c354091747c2873a">CLF_HSM_ERR_L</a>);
<a name="l00837"></a>00837 }
<a name="l00838"></a>00838 
<a name="l00839"></a><a class="code" href="group__lustreuser.html#gac15c6de166ffb0489cfdbc3f22450476">00839</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gac15c6de166ffb0489cfdbc3f22450476">changelog_send_flag</a> {
<a name="l00840"></a>00840         <span class="comment">/* Not yet implemented */</span>
<a name="l00841"></a><a class="code" href="group__lustreuser.html#ggac15c6de166ffb0489cfdbc3f22450476a30fce17deb94dfec37aae32310b5d597">00841</a>         <a class="code" href="group__lustreuser.html#ggac15c6de166ffb0489cfdbc3f22450476a30fce17deb94dfec37aae32310b5d597">CHANGELOG_FLAG_FOLLOW</a>   = 0x01,
<a name="l00842"></a>00842         <span class="comment">/* Blocking IO makes sense in case of slow user parsing of the records,</span>
<a name="l00843"></a>00843 <span class="comment">         * but it also prevents us from cleaning up if the records are not</span>
<a name="l00844"></a>00844 <span class="comment">         * consumed. */</span>
<a name="l00845"></a><a class="code" href="group__lustreuser.html#ggac15c6de166ffb0489cfdbc3f22450476a223e25e92f01d1755387d0b271a71c55">00845</a>         <a class="code" href="group__lustreuser.html#ggac15c6de166ffb0489cfdbc3f22450476a223e25e92f01d1755387d0b271a71c55">CHANGELOG_FLAG_BLOCK</a>    = 0x02,
<a name="l00846"></a>00846         <span class="comment">/* Pack jobid into the changelog records if available. */</span>
<a name="l00847"></a><a class="code" href="group__lustreuser.html#ggac15c6de166ffb0489cfdbc3f22450476a953d2c513d5a7285def186a91b3e88e5">00847</a>         <a class="code" href="group__lustreuser.html#ggac15c6de166ffb0489cfdbc3f22450476a953d2c513d5a7285def186a91b3e88e5">CHANGELOG_FLAG_JOBID</a>    = 0x04,
<a name="l00848"></a>00848 };
<a name="l00849"></a>00849 
<a name="l00850"></a><a class="code" href="group__lustreuser.html#ga4ff5b9378bed1fc7c1a3e221bde43314">00850</a> <span class="preprocessor">#define CR_MAXSIZE cfs_size_round(2 * NAME_MAX + 2 + \</span>
<a name="l00851"></a>00851 <span class="preprocessor">                                  changelog_rec_offset(CLF_SUPPORTED))</span>
<a name="l00852"></a>00852 <span class="preprocessor"></span>
<a name="l00853"></a>00853 <span class="comment">/* 31 usable bytes string + null terminator. */</span>
<a name="l00854"></a><a class="code" href="group__lustreuser.html#ga0c0d05b1c505aa119e08771fbc1f0f72">00854</a> <span class="preprocessor">#define LUSTRE_JOBID_SIZE       32</span>
<a name="l00855"></a>00855 <span class="preprocessor"></span>
<a name="l00856"></a>00856 <span class="comment">/* This is the minimal changelog record. It can contain extensions</span>
<a name="l00857"></a>00857 <span class="comment"> * such as rename fields or process jobid. Its exact content is described</span>
<a name="l00858"></a>00858 <span class="comment"> * by the cr_flags.</span>
<a name="l00859"></a>00859 <span class="comment"> *</span>
<a name="l00860"></a>00860 <span class="comment"> * Extensions are packed in the same order as their corresponding flags.</span>
<a name="l00861"></a>00861 <span class="comment"> */</span>
<a name="l00862"></a><a class="code" href="structchangelog__rec.html">00862</a> <span class="keyword">struct </span><a class="code" href="structchangelog__rec.html">changelog_rec</a> {
<a name="l00863"></a><a class="code" href="structchangelog__rec.html#a1f6ca2c934d23e8687af1476642c2bc5">00863</a>         __u16                   <a class="code" href="structchangelog__rec.html#a1f6ca2c934d23e8687af1476642c2bc5">cr_namelen</a>;
<a name="l00864"></a><a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd">00864</a>         __u16                   <a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd" title="changelog_rec_flags ">cr_flags</a>; 
<a name="l00865"></a><a class="code" href="structchangelog__rec.html#a4980ca18959a4a16a9dff3cc012b6c04">00865</a>         __u32                   <a class="code" href="structchangelog__rec.html#a4980ca18959a4a16a9dff3cc012b6c04" title="changelog_rec_type ">cr_type</a>;  
<a name="l00866"></a><a class="code" href="structchangelog__rec.html#a994d96b9f37ffcc2227e12724a11f471">00866</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                   <a class="code" href="structchangelog__rec.html#a994d96b9f37ffcc2227e12724a11f471" title="changelog record number">cr_index</a>; 
<a name="l00867"></a><a class="code" href="structchangelog__rec.html#a11e640faba76dd20ef4b683a12ca5964">00867</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                   <a class="code" href="structchangelog__rec.html#a11e640faba76dd20ef4b683a12ca5964" title="last index for this target fid">cr_prev</a>;  
<a name="l00868"></a><a class="code" href="structchangelog__rec.html#a7e37ebcd3366a736a9ed98af5e39160c">00868</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                   <a class="code" href="structchangelog__rec.html#a7e37ebcd3366a736a9ed98af5e39160c">cr_time</a>;
<a name="l00869"></a>00869         <span class="keyword">union </span>{
<a name="l00870"></a><a class="code" href="structchangelog__rec.html#a409a3fce57ea09c2f18ce80513abaf27">00870</a>                 <a class="code" href="structlu__fid.html" title="File IDentifier.">lustre_fid</a>      <a class="code" href="structchangelog__rec.html#a409a3fce57ea09c2f18ce80513abaf27" title="target fid">cr_tfid</a>;        
<a name="l00871"></a><a class="code" href="structchangelog__rec.html#a9c3f6272653855b90d7cb6fc41f24a71">00871</a>                 __u32           <a class="code" href="structchangelog__rec.html#a9c3f6272653855b90d7cb6fc41f24a71" title="CL_MARK flags.">cr_markerflags</a>; 
<a name="l00872"></a>00872         };
<a name="l00873"></a><a class="code" href="structchangelog__rec.html#ae352b4a26c780096b07f29321200c15f">00873</a>         <a class="code" href="structlu__fid.html" title="File IDentifier.">lustre_fid</a>              <a class="code" href="structchangelog__rec.html#ae352b4a26c780096b07f29321200c15f" title="parent fid">cr_pfid</a>;        
<a name="l00874"></a>00874 };
<a name="l00875"></a>00875 
<a name="l00876"></a>00876 <span class="comment">/* Changelog extension for RENAME. */</span>
<a name="l00877"></a><a class="code" href="structchangelog__ext__rename.html">00877</a> <span class="keyword">struct </span><a class="code" href="structchangelog__ext__rename.html">changelog_ext_rename</a> {
<a name="l00878"></a><a class="code" href="structchangelog__ext__rename.html#a212e465b1e8df1a2106eb6124b4071b7">00878</a>         <a class="code" href="structlu__fid.html" title="File IDentifier.">lustre_fid</a>              <a class="code" href="structchangelog__ext__rename.html#a212e465b1e8df1a2106eb6124b4071b7" title="source fid, or zero">cr_sfid</a>;     
<a name="l00879"></a><a class="code" href="structchangelog__ext__rename.html#a904666467921c86d9577fec04e04fc63">00879</a>         <a class="code" href="structlu__fid.html" title="File IDentifier.">lustre_fid</a>              <a class="code" href="structchangelog__ext__rename.html#a904666467921c86d9577fec04e04fc63" title="source parent fid, or zero">cr_spfid</a>;    
<a name="l00880"></a>00880 };
<a name="l00881"></a>00881 
<a name="l00882"></a>00882 <span class="comment">/* Changelog extension to include JOBID. */</span>
<a name="l00883"></a><a class="code" href="structchangelog__ext__jobid.html">00883</a> <span class="keyword">struct </span><a class="code" href="structchangelog__ext__jobid.html">changelog_ext_jobid</a> {
<a name="l00884"></a><a class="code" href="structchangelog__ext__jobid.html#ab38a3dd0289d9d20e67dd13688336865">00884</a>         <span class="keywordtype">char</span>    <a class="code" href="structchangelog__ext__jobid.html#ab38a3dd0289d9d20e67dd13688336865" title="zero-terminated string.">cr_jobid</a>[<a class="code" href="group__lustreuser.html#ga0c0d05b1c505aa119e08771fbc1f0f72">LUSTRE_JOBID_SIZE</a>];    
<a name="l00885"></a>00885 };
<a name="l00886"></a>00886 
<a name="l00887"></a>00887 
<a name="l00888"></a><a class="code" href="group__lustreuser.html#ga3e8875e30b0a2150c577c3a1a073d9e3">00888</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="group__lustreuser.html#ga3e8875e30b0a2150c577c3a1a073d9e3">changelog_rec_offset</a>(<span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gafd9a43c6bdc39d72c3113806a84be46a">changelog_rec_flags</a> crf)
<a name="l00889"></a>00889 {
<a name="l00890"></a>00890         <span class="keywordtype">size_t</span> <a class="code" href="lp__utils_8h.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structchangelog__rec.html">changelog_rec</a>);
<a name="l00891"></a>00891 
<a name="l00892"></a>00892         <span class="keywordflow">if</span> (crf &amp; <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aa3a0fa7d565764b4cd9dc2cc3086c1087">CLF_RENAME</a>)
<a name="l00893"></a>00893                 size += <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structchangelog__ext__rename.html">changelog_ext_rename</a>);
<a name="l00894"></a>00894 
<a name="l00895"></a>00895         <span class="keywordflow">if</span> (crf &amp; <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aaf7154a276a13849d6ebd961767bab893">CLF_JOBID</a>)
<a name="l00896"></a>00896                 size += <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structchangelog__ext__jobid.html">changelog_ext_jobid</a>);
<a name="l00897"></a>00897 
<a name="l00898"></a>00898         <span class="keywordflow">return</span> size;
<a name="l00899"></a>00899 }
<a name="l00900"></a>00900 
<a name="l00901"></a><a class="code" href="group__lustreuser.html#gab02ff1b1aa7173ec5d990cc1735027e2">00901</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="group__lustreuser.html#gab02ff1b1aa7173ec5d990cc1735027e2">changelog_rec_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structchangelog__rec.html">changelog_rec</a> *rec)
<a name="l00902"></a>00902 {
<a name="l00903"></a>00903         <span class="keywordflow">return</span> <a class="code" href="group__lustreuser.html#ga3e8875e30b0a2150c577c3a1a073d9e3">changelog_rec_offset</a>(rec-&gt;<a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd" title="changelog_rec_flags ">cr_flags</a>);
<a name="l00904"></a>00904 }
<a name="l00905"></a>00905 
<a name="l00906"></a><a class="code" href="group__lustreuser.html#ga9d2fce22307cb388fc313dabc37e3dd5">00906</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="group__lustreuser.html#ga9d2fce22307cb388fc313dabc37e3dd5">changelog_rec_varsize</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structchangelog__rec.html">changelog_rec</a> *rec)
<a name="l00907"></a>00907 {
<a name="l00908"></a>00908         <span class="keywordflow">return</span> <a class="code" href="group__lustreuser.html#gab02ff1b1aa7173ec5d990cc1735027e2">changelog_rec_size</a>(rec) - <span class="keyword">sizeof</span>(*rec) + rec-&gt;<a class="code" href="structchangelog__rec.html#a1f6ca2c934d23e8687af1476642c2bc5">cr_namelen</a>;
<a name="l00909"></a>00909 }
<a name="l00910"></a>00910 
<a name="l00911"></a>00911 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l00912"></a><a class="code" href="group__lustreuser.html#gaf87f83a936aa62d4d8306115b7202d9c">00912</a> <span class="keyword">struct </span><a class="code" href="structchangelog__ext__rename.html">changelog_ext_rename</a> *<a class="code" href="group__lustreuser.html#gaf87f83a936aa62d4d8306115b7202d9c">changelog_rec_rename</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structchangelog__rec.html">changelog_rec</a> *rec)
<a name="l00913"></a>00913 {
<a name="l00914"></a>00914         <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gafd9a43c6bdc39d72c3113806a84be46a">changelog_rec_flags</a> crf = rec-&gt;<a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd" title="changelog_rec_flags ">cr_flags</a> &amp; <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aafcb030c80dab37b2206cd78eba8957c7">CLF_VERSION</a>;
<a name="l00915"></a>00915 
<a name="l00916"></a>00916         <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structchangelog__ext__rename.html">changelog_ext_rename</a> *)((<span class="keywordtype">char</span> *)rec +
<a name="l00917"></a>00917                                                <a class="code" href="group__lustreuser.html#ga3e8875e30b0a2150c577c3a1a073d9e3">changelog_rec_offset</a>(crf));
<a name="l00918"></a>00918 }
<a name="l00919"></a>00919 
<a name="l00920"></a>00920 <span class="comment">/* The jobid follows the rename extension, if present */</span>
<a name="l00921"></a>00921 <span class="keyword">static</span> <span class="keyword">inline</span>
<a name="l00922"></a><a class="code" href="group__lustreuser.html#ga560f1aa9468969eb89158f9a2e41152f">00922</a> <span class="keyword">struct </span><a class="code" href="structchangelog__ext__jobid.html">changelog_ext_jobid</a> *<a class="code" href="group__lustreuser.html#ga560f1aa9468969eb89158f9a2e41152f">changelog_rec_jobid</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structchangelog__rec.html">changelog_rec</a> *rec)
<a name="l00923"></a>00923 {
<a name="l00924"></a>00924         <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gafd9a43c6bdc39d72c3113806a84be46a">changelog_rec_flags</a> crf = rec-&gt;<a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd" title="changelog_rec_flags ">cr_flags</a> &amp;
<a name="l00925"></a>00925                                         (<a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aafcb030c80dab37b2206cd78eba8957c7">CLF_VERSION</a> | <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aa3a0fa7d565764b4cd9dc2cc3086c1087">CLF_RENAME</a>);
<a name="l00926"></a>00926 
<a name="l00927"></a>00927         <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structchangelog__ext__jobid.html">changelog_ext_jobid</a> *)((<span class="keywordtype">char</span> *)rec +
<a name="l00928"></a>00928                                               <a class="code" href="group__lustreuser.html#ga3e8875e30b0a2150c577c3a1a073d9e3">changelog_rec_offset</a>(crf));
<a name="l00929"></a>00929 }
<a name="l00930"></a>00930 
<a name="l00931"></a>00931 <span class="comment">/* The name follows the rename and jobid extensions, if present */</span>
<a name="l00932"></a><a class="code" href="group__lustreuser.html#ga09fead4b7322fedcc2a1d99dd3fbaf51">00932</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">char</span> *<a class="code" href="group__lustreuser.html#ga09fead4b7322fedcc2a1d99dd3fbaf51">changelog_rec_name</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structchangelog__rec.html">changelog_rec</a> *rec)
<a name="l00933"></a>00933 {
<a name="l00934"></a>00934         <span class="keywordflow">return</span> (<span class="keywordtype">char</span> *)rec + <a class="code" href="group__lustreuser.html#ga3e8875e30b0a2150c577c3a1a073d9e3">changelog_rec_offset</a>(rec-&gt;<a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd" title="changelog_rec_flags ">cr_flags</a> &amp;
<a name="l00935"></a>00935                                                   <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aa2d0c5d0480da5776b9e6f653c09fcd7f">CLF_SUPPORTED</a>);
<a name="l00936"></a>00936 }
<a name="l00937"></a>00937 
<a name="l00938"></a><a class="code" href="group__lustreuser.html#gac641d6d0eb1a915039043f9e50240811">00938</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="group__lustreuser.html#gac641d6d0eb1a915039043f9e50240811">changelog_rec_snamelen</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structchangelog__rec.html">changelog_rec</a> *rec)
<a name="l00939"></a>00939 {
<a name="l00940"></a>00940         <span class="keywordflow">return</span> rec-&gt;<a class="code" href="structchangelog__rec.html#a1f6ca2c934d23e8687af1476642c2bc5">cr_namelen</a> - strlen(<a class="code" href="group__lustreuser.html#ga09fead4b7322fedcc2a1d99dd3fbaf51">changelog_rec_name</a>(rec)) - 1;
<a name="l00941"></a>00941 }
<a name="l00942"></a>00942 
<a name="l00943"></a><a class="code" href="group__lustreuser.html#gab143566c4b070be94ad5f2111426a193">00943</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">char</span> *<a class="code" href="group__lustreuser.html#gab143566c4b070be94ad5f2111426a193">changelog_rec_sname</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structchangelog__rec.html">changelog_rec</a> *rec)
<a name="l00944"></a>00944 {
<a name="l00945"></a>00945         <span class="keywordtype">char</span> *cr_name = <a class="code" href="group__lustreuser.html#ga09fead4b7322fedcc2a1d99dd3fbaf51">changelog_rec_name</a>(rec);
<a name="l00946"></a>00946 
<a name="l00947"></a>00947         <span class="keywordflow">return</span> cr_name + strlen(cr_name) + 1;
<a name="l00948"></a>00948 }
<a name="l00949"></a>00949 
<a name="l00969"></a><a class="code" href="group__lustreuser.html#gab1eb19b20ae2c63f83ff335043b80461">00969</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__lustreuser.html#gab1eb19b20ae2c63f83ff335043b80461" title="Remap a record to the desired format as specified by the crf flags.">changelog_remap_rec</a>(<span class="keyword">struct</span> <a class="code" href="structchangelog__rec.html">changelog_rec</a> *rec,
<a name="l00970"></a>00970                                        <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gafd9a43c6bdc39d72c3113806a84be46a">changelog_rec_flags</a> crf_wanted)
<a name="l00971"></a>00971 {
<a name="l00972"></a>00972         <span class="keywordtype">char</span> *jid_mov;
<a name="l00973"></a>00973         <span class="keywordtype">char</span> *rnm_mov;
<a name="l00974"></a>00974 
<a name="l00975"></a>00975         crf_wanted &amp;= <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aa2d0c5d0480da5776b9e6f653c09fcd7f">CLF_SUPPORTED</a>;
<a name="l00976"></a>00976 
<a name="l00977"></a>00977         <span class="keywordflow">if</span> ((rec-&gt;<a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd" title="changelog_rec_flags ">cr_flags</a> &amp; <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aa2d0c5d0480da5776b9e6f653c09fcd7f">CLF_SUPPORTED</a>) == crf_wanted)
<a name="l00978"></a>00978                 <span class="keywordflow">return</span>;
<a name="l00979"></a>00979 
<a name="l00980"></a>00980         <span class="comment">/* First move the variable-length name field */</span>
<a name="l00981"></a>00981         memmove((<span class="keywordtype">char</span> *)rec + <a class="code" href="group__lustreuser.html#ga3e8875e30b0a2150c577c3a1a073d9e3">changelog_rec_offset</a>(crf_wanted),
<a name="l00982"></a>00982                 <a class="code" href="group__lustreuser.html#ga09fead4b7322fedcc2a1d99dd3fbaf51">changelog_rec_name</a>(rec), rec-&gt;<a class="code" href="structchangelog__rec.html#a1f6ca2c934d23e8687af1476642c2bc5">cr_namelen</a>);
<a name="l00983"></a>00983 
<a name="l00984"></a>00984         <span class="comment">/* Locations of jobid and rename extensions in the remapped record */</span>
<a name="l00985"></a>00985         jid_mov = (<span class="keywordtype">char</span> *)rec +
<a name="l00986"></a>00986                   <a class="code" href="group__lustreuser.html#ga3e8875e30b0a2150c577c3a1a073d9e3">changelog_rec_offset</a>(crf_wanted &amp; ~<a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aaf7154a276a13849d6ebd961767bab893">CLF_JOBID</a>);
<a name="l00987"></a>00987         rnm_mov = (<span class="keywordtype">char</span> *)rec +
<a name="l00988"></a>00988                   <a class="code" href="group__lustreuser.html#ga3e8875e30b0a2150c577c3a1a073d9e3">changelog_rec_offset</a>(crf_wanted &amp; ~(<a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aaf7154a276a13849d6ebd961767bab893">CLF_JOBID</a> | <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aa3a0fa7d565764b4cd9dc2cc3086c1087">CLF_RENAME</a>));
<a name="l00989"></a>00989 
<a name="l00990"></a>00990         <span class="comment">/* Move the extension fields to the desired positions */</span>
<a name="l00991"></a>00991         <span class="keywordflow">if</span> ((crf_wanted &amp; <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aaf7154a276a13849d6ebd961767bab893">CLF_JOBID</a>) &amp;&amp; (rec-&gt;<a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd" title="changelog_rec_flags ">cr_flags</a> &amp; CLF_JOBID))
<a name="l00992"></a>00992                 memmove(jid_mov, <a class="code" href="group__lustreuser.html#ga560f1aa9468969eb89158f9a2e41152f">changelog_rec_jobid</a>(rec),
<a name="l00993"></a>00993                         <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structchangelog__ext__jobid.html">changelog_ext_jobid</a>));
<a name="l00994"></a>00994 
<a name="l00995"></a>00995         <span class="keywordflow">if</span> ((crf_wanted &amp; <a class="code" href="group__lustreuser.html#ggafd9a43c6bdc39d72c3113806a84be46aa3a0fa7d565764b4cd9dc2cc3086c1087">CLF_RENAME</a>) &amp;&amp; (rec-&gt;<a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd" title="changelog_rec_flags ">cr_flags</a> &amp; CLF_RENAME))
<a name="l00996"></a>00996                 memmove(rnm_mov, <a class="code" href="group__lustreuser.html#gaf87f83a936aa62d4d8306115b7202d9c">changelog_rec_rename</a>(rec),
<a name="l00997"></a>00997                         <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structchangelog__ext__rename.html">changelog_ext_rename</a>));
<a name="l00998"></a>00998 
<a name="l00999"></a>00999         <span class="comment">/* Clear newly added fields */</span>
<a name="l01000"></a>01000         <span class="keywordflow">if</span> ((crf_wanted &amp; CLF_JOBID) &amp;&amp; !(rec-&gt;<a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd" title="changelog_rec_flags ">cr_flags</a> &amp; CLF_JOBID))
<a name="l01001"></a>01001                 memset(jid_mov, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structchangelog__ext__jobid.html">changelog_ext_jobid</a>));
<a name="l01002"></a>01002 
<a name="l01003"></a>01003         <span class="keywordflow">if</span> ((crf_wanted &amp; CLF_RENAME) &amp;&amp; !(rec-&gt;<a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd" title="changelog_rec_flags ">cr_flags</a> &amp; CLF_RENAME))
<a name="l01004"></a>01004                 memset(rnm_mov, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structchangelog__ext__rename.html">changelog_ext_rename</a>));
<a name="l01005"></a>01005 
<a name="l01006"></a>01006         <span class="comment">/* Update the record&apos;s flags accordingly */</span>
<a name="l01007"></a>01007         rec-&gt;<a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd" title="changelog_rec_flags ">cr_flags</a> = (rec-&gt;<a class="code" href="structchangelog__rec.html#a6db5c3d14180f2ce3126468c061736dd" title="changelog_rec_flags ">cr_flags</a> &amp; <a class="code" href="group__lustreuser.html#ga7b711b66e8aa71e02342e9d9f4ce74db">CLF_FLAGMASK</a>) | crf_wanted;
<a name="l01008"></a>01008 }
<a name="l01009"></a>01009 
<a name="l01010"></a><a class="code" href="structioc__changelog.html">01010</a> <span class="keyword">struct </span><a class="code" href="structioc__changelog.html">ioc_changelog</a> {
<a name="l01011"></a><a class="code" href="structioc__changelog.html#a87e7ef51e2d55acdf32060ce9b1865d5">01011</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structioc__changelog.html#a87e7ef51e2d55acdf32060ce9b1865d5">icc_recno</a>;
<a name="l01012"></a><a class="code" href="structioc__changelog.html#a928c9f28b8ddaca68ca48227f72b4807">01012</a>         __u32 <a class="code" href="structioc__changelog.html#a928c9f28b8ddaca68ca48227f72b4807">icc_mdtindex</a>;
<a name="l01013"></a><a class="code" href="structioc__changelog.html#a74baeb88c89443e9e57ec852b04905f4">01013</a>         __u32 <a class="code" href="structioc__changelog.html#a74baeb88c89443e9e57ec852b04905f4">icc_id</a>;
<a name="l01014"></a><a class="code" href="structioc__changelog.html#a3f4e9a8602f90e6ab73a2dd7b5731bfc">01014</a>         __u32 <a class="code" href="structioc__changelog.html#a3f4e9a8602f90e6ab73a2dd7b5731bfc">icc_flags</a>;
<a name="l01015"></a>01015 };
<a name="l01016"></a>01016 
<a name="l01017"></a><a class="code" href="group__lustreuser.html#gafe5ca6688aeb40384702c7f075e882b8">01017</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gafe5ca6688aeb40384702c7f075e882b8">changelog_message_type</a> {
<a name="l01018"></a><a class="code" href="group__lustreuser.html#ggafe5ca6688aeb40384702c7f075e882b8a2d5437219a9c5d21282feb9e83c6d447">01018</a>         <a class="code" href="group__lustreuser.html#ggafe5ca6688aeb40384702c7f075e882b8a2d5437219a9c5d21282feb9e83c6d447">CL_RECORD</a> = 10, <span class="comment">/* message is a changelog_rec */</span>
<a name="l01019"></a><a class="code" href="group__lustreuser.html#ggafe5ca6688aeb40384702c7f075e882b8a611a8fbc22fec7bd0410b60fa5e796c8">01019</a>         <a class="code" href="group__lustreuser.html#ggafe5ca6688aeb40384702c7f075e882b8a611a8fbc22fec7bd0410b60fa5e796c8">CL_EOF</a>    = 11, <span class="comment">/* at end of current changelog */</span>
<a name="l01020"></a>01020 };
<a name="l01021"></a>01021 
<a name="l01022"></a>01022 <span class="comment">/********* Misc **********/</span>
<a name="l01023"></a>01023 
<a name="l01024"></a><a class="code" href="structioc__data__version.html">01024</a> <span class="keyword">struct </span><a class="code" href="structioc__data__version.html">ioc_data_version</a> {
<a name="l01025"></a><a class="code" href="structioc__data__version.html#a6effa206fd1f9cd0737dddbc75f7522e">01025</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structioc__data__version.html#a6effa206fd1f9cd0737dddbc75f7522e">idv_version</a>;
<a name="l01026"></a><a class="code" href="structioc__data__version.html#a60d4adc7f0fae0d285e9ddd823b12710">01026</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structioc__data__version.html#a60d4adc7f0fae0d285e9ddd823b12710">idv_flags</a>;     <span class="comment">/* See LL_DV_xxx */</span>
<a name="l01027"></a>01027 };
<a name="l01028"></a><a class="code" href="group__lustreuser.html#ga9f78ed4b21dd6e223412cf7c4f940650">01028</a> <span class="preprocessor">#define LL_DV_RD_FLUSH (1 &lt;&lt; 0) </span><span class="comment">/* Flush dirty pages from clients */</span>
<a name="l01029"></a><a class="code" href="group__lustreuser.html#ga1823188f39f14dd5631aabf55f27364c">01029</a> <span class="preprocessor">#define LL_DV_WR_FLUSH (1 &lt;&lt; 1) </span><span class="comment">/* Flush all caching pages from clients */</span>
<a name="l01030"></a>01030 
<a name="l01031"></a>01031 <span class="preprocessor">#ifndef offsetof</span>
<a name="l01032"></a><a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">01032</a> <span class="preprocessor"></span><span class="preprocessor">#define offsetof(typ, memb)     ((unsigned long)((char *)&amp;(((typ *)0)-&gt;memb)))</span>
<a name="l01033"></a>01033 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l01034"></a>01034 <span class="preprocessor"></span>
<a name="l01035"></a><a class="code" href="group__lustreuser.html#ga42fbee01ed6ab95c258a4a28380f447a">01035</a> <span class="preprocessor">#define dot_lustre_name &quot;.lustre&quot;</span>
<a name="l01036"></a>01036 <span class="preprocessor"></span>
<a name="l01037"></a>01037 
<a name="l01038"></a>01038 <span class="comment">/********* HSM **********/</span>
<a name="l01039"></a>01039 
<a name="l01043"></a><a class="code" href="group__lustreuser.html#ga7ffc01b5782e191a02e6ea88fa4c1a83">01043</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga7ffc01b5782e191a02e6ea88fa4c1a83" title="HSM per-file state See HSM_FLAGS below.">hsm_states</a> {
<a name="l01044"></a><a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83a3d07cc136c32bdc4f7121c7f1f1322eb">01044</a>         <a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83a3d07cc136c32bdc4f7121c7f1f1322eb">HS_NONE</a>         = 0x00000000,
<a name="l01045"></a><a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83a5a8db105e6dcff2e10d1d4078ab52dfe">01045</a>         <a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83a5a8db105e6dcff2e10d1d4078ab52dfe">HS_EXISTS</a>       = 0x00000001,
<a name="l01046"></a><a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83adec05a90018482fcb9e32a57a354fd16">01046</a>         <a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83adec05a90018482fcb9e32a57a354fd16">HS_DIRTY</a>        = 0x00000002,
<a name="l01047"></a><a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83a32fa0a5b9f80418cdbe1f93457795dc5">01047</a>         <a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83a32fa0a5b9f80418cdbe1f93457795dc5">HS_RELEASED</a>     = 0x00000004,
<a name="l01048"></a><a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83adad77b3db508ed90fb0b866c45f5f07a">01048</a>         <a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83adad77b3db508ed90fb0b866c45f5f07a">HS_ARCHIVED</a>     = 0x00000008,
<a name="l01049"></a><a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83a081e981d12822606f8aad3b8e5263c57">01049</a>         <a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83a081e981d12822606f8aad3b8e5263c57">HS_NORELEASE</a>    = 0x00000010,
<a name="l01050"></a><a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83a9e76e6a1cd40a341ba693ff59b22e867">01050</a>         <a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83a9e76e6a1cd40a341ba693ff59b22e867">HS_NOARCHIVE</a>    = 0x00000020,
<a name="l01051"></a><a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83a88771fd6193d566bd0e8a971e022db91">01051</a>         <a class="code" href="group__lustreuser.html#gga7ffc01b5782e191a02e6ea88fa4c1a83a88771fd6193d566bd0e8a971e022db91">HS_LOST</a>         = 0x00000040,
<a name="l01052"></a>01052 };
<a name="l01053"></a>01053 
<a name="l01054"></a>01054 <span class="comment">/* HSM user-setable flags. */</span>
<a name="l01055"></a><a class="code" href="group__lustreuser.html#gac0a2fc387919d65354838636460dd344">01055</a> <span class="preprocessor">#define HSM_USER_MASK   (HS_NORELEASE | HS_NOARCHIVE | HS_DIRTY)</span>
<a name="l01056"></a>01056 <span class="preprocessor"></span>
<a name="l01057"></a>01057 <span class="comment">/* Other HSM flags. */</span>
<a name="l01058"></a><a class="code" href="group__lustreuser.html#gab9edf80a84704ed00baa349773743b90">01058</a> <span class="preprocessor">#define HSM_STATUS_MASK (HS_EXISTS | HS_LOST | HS_RELEASED | HS_ARCHIVED)</span>
<a name="l01059"></a>01059 <span class="preprocessor"></span>
<a name="l01060"></a>01060 <span class="comment">/*</span>
<a name="l01061"></a>01061 <span class="comment"> * All HSM-related possible flags that could be applied to a file.</span>
<a name="l01062"></a>01062 <span class="comment"> * This should be kept in sync with hsm_states.</span>
<a name="l01063"></a>01063 <span class="comment"> */</span>
<a name="l01064"></a><a class="code" href="group__lustreuser.html#ga76b32eb0e0f4bf09e586155b8ffbfd64">01064</a> <span class="preprocessor">#define HSM_FLAGS_MASK  (HSM_USER_MASK | HSM_STATUS_MASK)</span>
<a name="l01065"></a>01065 <span class="preprocessor"></span>
<a name="l01069"></a><a class="code" href="group__lustreuser.html#ga22a8ef3feb92702c222cee633d736dd6">01069</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga22a8ef3feb92702c222cee633d736dd6" title="HSM request progress state.">hsm_progress_states</a> {
<a name="l01070"></a><a class="code" href="group__lustreuser.html#gga22a8ef3feb92702c222cee633d736dd6aaaa9e99227078a7ac442c40933e8927c">01070</a>         <a class="code" href="group__lustreuser.html#gga22a8ef3feb92702c222cee633d736dd6aaaa9e99227078a7ac442c40933e8927c">HPS_WAITING</a>     = 1,
<a name="l01071"></a><a class="code" href="group__lustreuser.html#gga22a8ef3feb92702c222cee633d736dd6ad878011657fa95bcfbd05c40a1d043ee">01071</a>         <a class="code" href="group__lustreuser.html#gga22a8ef3feb92702c222cee633d736dd6ad878011657fa95bcfbd05c40a1d043ee">HPS_RUNNING</a>     = 2,
<a name="l01072"></a><a class="code" href="group__lustreuser.html#gga22a8ef3feb92702c222cee633d736dd6a9377be3841bb55d7375087e6c5bef07d">01072</a>         <a class="code" href="group__lustreuser.html#gga22a8ef3feb92702c222cee633d736dd6a9377be3841bb55d7375087e6c5bef07d">HPS_DONE</a>        = 3,
<a name="l01073"></a>01073 };
<a name="l01074"></a><a class="code" href="group__lustreuser.html#ga104a250f50375993c581143e1248509f">01074</a> <span class="preprocessor">#define HPS_NONE        0</span>
<a name="l01075"></a>01075 <span class="preprocessor"></span>
<a name="l01076"></a><a class="code" href="group__lustreuser.html#ga7564f35b6ce774a6b1983d9428792bd1">01076</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__lustreuser.html#ga7564f35b6ce774a6b1983d9428792bd1">hsm_progress_state2name</a>(<span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga22a8ef3feb92702c222cee633d736dd6" title="HSM request progress state.">hsm_progress_states</a> s)
<a name="l01077"></a>01077 {
<a name="l01078"></a>01078         <span class="keywordflow">switch</span>  (s) {
<a name="l01079"></a>01079         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#gga22a8ef3feb92702c222cee633d736dd6aaaa9e99227078a7ac442c40933e8927c">HPS_WAITING</a>:       <span class="keywordflow">return</span> <span class="stringliteral">&quot;waiting&quot;</span>;
<a name="l01080"></a>01080         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#gga22a8ef3feb92702c222cee633d736dd6ad878011657fa95bcfbd05c40a1d043ee">HPS_RUNNING</a>:       <span class="keywordflow">return</span> <span class="stringliteral">&quot;running&quot;</span>;
<a name="l01081"></a>01081         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#gga22a8ef3feb92702c222cee633d736dd6a9377be3841bb55d7375087e6c5bef07d">HPS_DONE</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;done&quot;</span>;
<a name="l01082"></a>01082         <span class="keywordflow">default</span>:                <span class="keywordflow">return</span> <span class="stringliteral">&quot;unknown&quot;</span>;
<a name="l01083"></a>01083         }
<a name="l01084"></a>01084 }
<a name="l01085"></a>01085 
<a name="l01086"></a><a class="code" href="structhsm__extent.html">01086</a> <span class="keyword">struct </span><a class="code" href="structhsm__extent.html">hsm_extent</a> {
<a name="l01087"></a><a class="code" href="structhsm__extent.html#adebe85f26db425af352eb3c867827dea">01087</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structhsm__extent.html#adebe85f26db425af352eb3c867827dea">offset</a>;
<a name="l01088"></a><a class="code" href="structhsm__extent.html#a54e7b129423205070d4be66656c5d788">01088</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structhsm__extent.html#a54e7b129423205070d4be66656c5d788">length</a>;
<a name="l01089"></a>01089 } <a class="code" href="fid_8mod_8c.html#a804f230e6220e338767d15b94fc5801d">__attribute__</a>((<a class="code" href="group__lustreidl.html#ga30372a269f5fc08f064b7e94437589bb" title="Identifier for a single log object.">packed</a>));
<a name="l01090"></a>01090 
<a name="l01097"></a><a class="code" href="structhsm__user__state.html">01097</a> <span class="keyword">struct </span><a class="code" href="structhsm__user__state.html" title="Current HSM states of a Lustre file.">hsm_user_state</a> {
<a name="l01099"></a><a class="code" href="structhsm__user__state.html#af9ec50adb78815c43889187b1c0944d4">01099</a>         __u32                   <a class="code" href="structhsm__user__state.html#af9ec50adb78815c43889187b1c0944d4" title="Current HSM states, from enum hsm_states.">hus_states</a>;
<a name="l01100"></a><a class="code" href="structhsm__user__state.html#a199a27793237977ea65c70dd0a8dbc4e">01100</a>         __u32                   <a class="code" href="structhsm__user__state.html#a199a27793237977ea65c70dd0a8dbc4e">hus_archive_id</a>;
<a name="l01102"></a><a class="code" href="structhsm__user__state.html#a748bff9b77d2792a06aea786c824124c">01102</a>         __u32                   <a class="code" href="structhsm__user__state.html#a748bff9b77d2792a06aea786c824124c" title="The current undergoing action, if there is one.">hus_in_progress_state</a>;
<a name="l01103"></a><a class="code" href="structhsm__user__state.html#a53c548a6ea0c71107f60ac2c8271b1ba">01103</a>         __u32                   <a class="code" href="structhsm__user__state.html#a53c548a6ea0c71107f60ac2c8271b1ba">hus_in_progress_action</a>;
<a name="l01104"></a><a class="code" href="structhsm__user__state.html#ad83553451d3e090e452623a39150fd98">01104</a>         <span class="keyword">struct </span><a class="code" href="structhsm__extent.html">hsm_extent</a>       <a class="code" href="structhsm__user__state.html#ad83553451d3e090e452623a39150fd98">hus_in_progress_location</a>;
<a name="l01105"></a><a class="code" href="structhsm__user__state.html#a8869fb0171dfc96a143e4031fde68bd9">01105</a>         <span class="keywordtype">char</span>                    <a class="code" href="structhsm__user__state.html#a8869fb0171dfc96a143e4031fde68bd9">hus_extended_info</a>[];
<a name="l01106"></a>01106 };
<a name="l01107"></a>01107 
<a name="l01108"></a><a class="code" href="structhsm__state__set__ioc.html">01108</a> <span class="keyword">struct </span><a class="code" href="structhsm__state__set__ioc.html">hsm_state_set_ioc</a> {
<a name="l01109"></a><a class="code" href="structhsm__state__set__ioc.html#aba5d4ba6e2669471fafe5710bf2cfce1">01109</a>         <span class="keyword">struct </span><a class="code" href="structlu__fid.html" title="File IDentifier.">lu_fid</a>   <a class="code" href="structhsm__state__set__ioc.html#aba5d4ba6e2669471fafe5710bf2cfce1">hssi_fid</a>;
<a name="l01110"></a><a class="code" href="structhsm__state__set__ioc.html#a4ed0e87326c4e4be0c183feffbcbe650">01110</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structhsm__state__set__ioc.html#a4ed0e87326c4e4be0c183feffbcbe650">hssi_setmask</a>;
<a name="l01111"></a><a class="code" href="structhsm__state__set__ioc.html#a37e9fa09348565fa0a84a74ff9c258ee">01111</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structhsm__state__set__ioc.html#a37e9fa09348565fa0a84a74ff9c258ee">hssi_clearmask</a>;
<a name="l01112"></a>01112 };
<a name="l01113"></a>01113 
<a name="l01114"></a>01114 <span class="comment">/*</span>
<a name="l01115"></a>01115 <span class="comment"> * This structure describes the current in-progress action for a file.</span>
<a name="l01116"></a>01116 <span class="comment"> * it is retuned to user space and send over the wire</span>
<a name="l01117"></a>01117 <span class="comment"> */</span>
<a name="l01118"></a><a class="code" href="structhsm__current__action.html">01118</a> <span class="keyword">struct </span><a class="code" href="structhsm__current__action.html">hsm_current_action</a> {
<a name="l01120"></a>01120         <span class="comment">/* state is one of hsm_progress_states */</span>
<a name="l01121"></a><a class="code" href="structhsm__current__action.html#a7636b757e79d461f77baae461611ffa6">01121</a>         __u32                   <a class="code" href="structhsm__current__action.html#a7636b757e79d461f77baae461611ffa6" title="The current undergoing action, if there is one.">hca_state</a>;
<a name="l01122"></a>01122         <span class="comment">/* action is one of hsm_user_action */</span>
<a name="l01123"></a><a class="code" href="structhsm__current__action.html#a90dc168c0df58dea08d3101d07c52103">01123</a>         __u32                   <a class="code" href="structhsm__current__action.html#a90dc168c0df58dea08d3101d07c52103">hca_action</a>;
<a name="l01124"></a><a class="code" href="structhsm__current__action.html#a2f4a083269410e9919403cb07f4cd405">01124</a>         <span class="keyword">struct </span><a class="code" href="structhsm__extent.html">hsm_extent</a>       <a class="code" href="structhsm__current__action.html#a2f4a083269410e9919403cb07f4cd405">hca_location</a>;
<a name="l01125"></a>01125 };
<a name="l01126"></a>01126 
<a name="l01127"></a>01127 <span class="comment">/***** HSM user requests ******/</span>
<a name="l01128"></a>01128 <span class="comment">/* User-generated (lfs/ioctl) request types */</span>
<a name="l01129"></a><a class="code" href="group__lustreuser.html#gaf6101597a48989ed143bcbc438c111cc">01129</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gaf6101597a48989ed143bcbc438c111cc">hsm_user_action</a> {
<a name="l01130"></a><a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111cca049c9cfb20247339afffc4fa5c6d501c">01130</a>         <a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111cca049c9cfb20247339afffc4fa5c6d501c">HUA_NONE</a>    =  1, <span class="comment">/* no action (noop) */</span>
<a name="l01131"></a><a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111ccac6d9fe4eaf959ba6538a493502bb8b95">01131</a>         <a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111ccac6d9fe4eaf959ba6538a493502bb8b95">HUA_ARCHIVE</a> = 10, <span class="comment">/* copy to hsm */</span>
<a name="l01132"></a><a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111ccae4299c24e9f4532b6611935422bd2dc4">01132</a>         <a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111ccae4299c24e9f4532b6611935422bd2dc4">HUA_RESTORE</a> = 11, <span class="comment">/* prestage */</span>
<a name="l01133"></a><a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111cca9f42144848ea0d776ba9ad084833d0b2">01133</a>         <a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111cca9f42144848ea0d776ba9ad084833d0b2">HUA_RELEASE</a> = 12, <span class="comment">/* drop ost objects */</span>
<a name="l01134"></a><a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111ccab24e247f49d8a9969cb1114e814cd97b">01134</a>         <a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111ccab24e247f49d8a9969cb1114e814cd97b">HUA_REMOVE</a>  = 13, <span class="comment">/* remove from archive */</span>
<a name="l01135"></a><a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111ccad22212acd00ebee1f014b16e0ff64619">01135</a>         <a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111ccad22212acd00ebee1f014b16e0ff64619">HUA_CANCEL</a>  = 14  <span class="comment">/* cancel a request */</span>
<a name="l01136"></a>01136 };
<a name="l01137"></a>01137 
<a name="l01138"></a><a class="code" href="group__lustreuser.html#ga6d960a44d7618614f103cf515a9fc09f">01138</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__lustreuser.html#ga6d960a44d7618614f103cf515a9fc09f">hsm_user_action2name</a>(<span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#gaf6101597a48989ed143bcbc438c111cc">hsm_user_action</a>  a)
<a name="l01139"></a>01139 {
<a name="l01140"></a>01140         <span class="keywordflow">switch</span>  (a) {
<a name="l01141"></a>01141         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111cca049c9cfb20247339afffc4fa5c6d501c">HUA_NONE</a>:    <span class="keywordflow">return</span> <span class="stringliteral">&quot;NOOP&quot;</span>;
<a name="l01142"></a>01142         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111ccac6d9fe4eaf959ba6538a493502bb8b95">HUA_ARCHIVE</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;ARCHIVE&quot;</span>;
<a name="l01143"></a>01143         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111ccae4299c24e9f4532b6611935422bd2dc4">HUA_RESTORE</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;RESTORE&quot;</span>;
<a name="l01144"></a>01144         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111cca9f42144848ea0d776ba9ad084833d0b2">HUA_RELEASE</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;RELEASE&quot;</span>;
<a name="l01145"></a>01145         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111ccab24e247f49d8a9969cb1114e814cd97b">HUA_REMOVE</a>:  <span class="keywordflow">return</span> <span class="stringliteral">&quot;REMOVE&quot;</span>;
<a name="l01146"></a>01146         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#ggaf6101597a48989ed143bcbc438c111ccad22212acd00ebee1f014b16e0ff64619">HUA_CANCEL</a>:  <span class="keywordflow">return</span> <span class="stringliteral">&quot;CANCEL&quot;</span>;
<a name="l01147"></a>01147         <span class="keywordflow">default</span>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;UNKNOWN&quot;</span>;
<a name="l01148"></a>01148         }
<a name="l01149"></a>01149 }
<a name="l01150"></a>01150 
<a name="l01151"></a>01151 <span class="comment">/*</span>
<a name="l01152"></a>01152 <span class="comment"> * List of hr_flags (bit field)</span>
<a name="l01153"></a>01153 <span class="comment"> */</span>
<a name="l01154"></a><a class="code" href="group__lustreuser.html#ga82a26106e4ac336fdc7991cc62664be3">01154</a> <span class="preprocessor">#define HSM_FORCE_ACTION 0x0001</span>
<a name="l01155"></a>01155 <span class="preprocessor"></span><span class="comment">/* used by CT, cannot be set by user */</span>
<a name="l01156"></a><a class="code" href="group__lustreuser.html#ga8538a9ee3a02fdb7ac5d9dd5ac39e7ec">01156</a> <span class="preprocessor">#define HSM_GHOST_COPY   0x0002</span>
<a name="l01157"></a>01157 <span class="preprocessor"></span>
<a name="l01162"></a><a class="code" href="structhsm__request.html">01162</a> <span class="keyword">struct </span><a class="code" href="structhsm__request.html" title="Contains all the fixed part of struct hsm_user_request.">hsm_request</a> {
<a name="l01163"></a><a class="code" href="structhsm__request.html#aa4ddc0a69b855eefd2177f041b082c13">01163</a>         __u32 <a class="code" href="structhsm__request.html#aa4ddc0a69b855eefd2177f041b082c13">hr_action</a>;        <span class="comment">/* enum hsm_user_action */</span>
<a name="l01164"></a><a class="code" href="structhsm__request.html#a2bdaeed755a46244d03247a16f069701">01164</a>         __u32 <a class="code" href="structhsm__request.html#a2bdaeed755a46244d03247a16f069701">hr_archive_id</a>;    <span class="comment">/* archive id, used only with HUA_ARCHIVE */</span>
<a name="l01165"></a><a class="code" href="structhsm__request.html#a5a395950d465cf989073eb7fbfa32b3f">01165</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structhsm__request.html#a5a395950d465cf989073eb7fbfa32b3f">hr_flags</a>;         <span class="comment">/* request flags */</span>
<a name="l01166"></a><a class="code" href="structhsm__request.html#a467c984247c432b699ffc5926f6fa73e">01166</a>         __u32 <a class="code" href="structhsm__request.html#a467c984247c432b699ffc5926f6fa73e">hr_itemcount</a>;     <span class="comment">/* item count in hur_user_item vector */</span>
<a name="l01167"></a><a class="code" href="structhsm__request.html#a029be1d934a91b465fe970481cdebc95">01167</a>         __u32 <a class="code" href="structhsm__request.html#a029be1d934a91b465fe970481cdebc95">hr_data_len</a>;
<a name="l01168"></a>01168 };
<a name="l01169"></a>01169 
<a name="l01170"></a><a class="code" href="structhsm__user__item.html">01170</a> <span class="keyword">struct </span><a class="code" href="structhsm__user__item.html">hsm_user_item</a> {
<a name="l01171"></a><a class="code" href="structhsm__user__item.html#a2d396fe913229ba8e3c594823b7b94e5">01171</a>        <a class="code" href="structlu__fid.html" title="File IDentifier.">lustre_fid</a>        <a class="code" href="structhsm__user__item.html#a2d396fe913229ba8e3c594823b7b94e5">hui_fid</a>;
<a name="l01172"></a><a class="code" href="structhsm__user__item.html#a8d740aa1cb4b4b8f996beb9848b85205">01172</a>        <span class="keyword">struct </span><a class="code" href="structhsm__extent.html">hsm_extent</a> <a class="code" href="structhsm__user__item.html#a8d740aa1cb4b4b8f996beb9848b85205">hui_extent</a>;
<a name="l01173"></a>01173 } <a class="code" href="fid_8mod_8c.html#a804f230e6220e338767d15b94fc5801d">__attribute__</a>((<a class="code" href="group__lustreidl.html#ga30372a269f5fc08f064b7e94437589bb" title="Identifier for a single log object.">packed</a>));
<a name="l01174"></a>01174 
<a name="l01175"></a><a class="code" href="structhsm__user__request.html">01175</a> <span class="keyword">struct </span><a class="code" href="structhsm__user__request.html">hsm_user_request</a> {
<a name="l01176"></a><a class="code" href="structhsm__user__request.html#aec0b2b86b49e55aa5c3ccac62e5fbf94">01176</a>         <span class="keyword">struct </span><a class="code" href="structhsm__request.html" title="Contains all the fixed part of struct hsm_user_request.">hsm_request</a>      <a class="code" href="structhsm__user__request.html#aec0b2b86b49e55aa5c3ccac62e5fbf94">hur_request</a>;
<a name="l01177"></a><a class="code" href="structhsm__user__request.html#a0b1ec5be1305de205eba88f70638086f">01177</a>         <span class="keyword">struct </span><a class="code" href="structhsm__user__item.html">hsm_user_item</a>    <a class="code" href="structhsm__user__request.html#a0b1ec5be1305de205eba88f70638086f">hur_user_item</a>[0];
<a name="l01178"></a>01178         <span class="comment">/* extra data blob at end of struct (after all</span>
<a name="l01179"></a>01179 <span class="comment">         * hur_user_items), only use helpers to access it</span>
<a name="l01180"></a>01180 <span class="comment">         */</span>
<a name="l01181"></a>01181 } <a class="code" href="fid_8mod_8c.html#a804f230e6220e338767d15b94fc5801d">__attribute__</a>((<a class="code" href="group__lustreidl.html#ga30372a269f5fc08f064b7e94437589bb" title="Identifier for a single log object.">packed</a>));
<a name="l01182"></a>01182 
<a name="l01184"></a><a class="code" href="group__lustreuser.html#ga0785c563d1ec17a55bc55d33dec53e0a">01184</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> *<a class="code" href="group__lustreuser.html#ga0785c563d1ec17a55bc55d33dec53e0a" title="Return pointer to data field in a hsm user request.">hur_data</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__user__request.html">hsm_user_request</a> *hur)
<a name="l01185"></a>01185 {
<a name="l01186"></a>01186         <span class="keywordflow">return</span> &amp;(hur-&gt;<a class="code" href="structhsm__user__request.html#a0b1ec5be1305de205eba88f70638086f">hur_user_item</a>[hur-&gt;<a class="code" href="structhsm__user__request.html#aec0b2b86b49e55aa5c3ccac62e5fbf94">hur_request</a>.<a class="code" href="structhsm__request.html#a467c984247c432b699ffc5926f6fa73e">hr_itemcount</a>]);
<a name="l01187"></a>01187 }
<a name="l01188"></a>01188 
<a name="l01195"></a><a class="code" href="group__lustreuser.html#gab79655d6145ffb6b2091ec3ea068f02f">01195</a> <span class="keyword">static</span> <span class="keyword">inline</span> ssize_t <a class="code" href="group__lustreuser.html#gab79655d6145ffb6b2091ec3ea068f02f" title="Compute the current length of the provided hsm_user_request.">hur_len</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__user__request.html">hsm_user_request</a> *hur)
<a name="l01196"></a>01196 {
<a name="l01197"></a>01197         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="lp__utils_8h.html#a439227feff9d7f55384e8780cfc2eb82">size</a>;
<a name="l01198"></a>01198 
<a name="l01199"></a>01199         <span class="comment">/* can&apos;t overflow a __u64 since hr_itemcount is only __u32 */</span>
<a name="l01200"></a>01200         size = <a class="code" href="group__lustreuser.html#gad4a7496cd704df3829c87864e7dbd703">offsetof</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__user__request.html">hsm_user_request</a>, hur_user_item[0]) +
<a name="l01201"></a>01201                 (<a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>)hur-&gt;<a class="code" href="structhsm__user__request.html#aec0b2b86b49e55aa5c3ccac62e5fbf94">hur_request</a>.<a class="code" href="structhsm__request.html#a467c984247c432b699ffc5926f6fa73e">hr_itemcount</a> *
<a name="l01202"></a>01202                 <span class="keyword">sizeof</span>(hur-&gt;<a class="code" href="structhsm__user__request.html#a0b1ec5be1305de205eba88f70638086f">hur_user_item</a>[0]) + hur-&gt;<a class="code" href="structhsm__user__request.html#aec0b2b86b49e55aa5c3ccac62e5fbf94">hur_request</a>.<a class="code" href="structhsm__request.html#a029be1d934a91b465fe970481cdebc95">hr_data_len</a>;
<a name="l01203"></a>01203 
<a name="l01204"></a>01204         <span class="keywordflow">if</span> (size != (ssize_t)size)
<a name="l01205"></a>01205                 <span class="keywordflow">return</span> -1;
<a name="l01206"></a>01206 
<a name="l01207"></a>01207         <span class="keywordflow">return</span> size;
<a name="l01208"></a>01208 }
<a name="l01209"></a>01209 
<a name="l01210"></a>01210 <span class="comment">/****** HSM RPCs to copytool *****/</span>
<a name="l01211"></a>01211 <span class="comment">/* Message types the copytool may receive */</span>
<a name="l01212"></a><a class="code" href="group__lustreuser.html#ga4a5211f314f78452584a6352eb97b2a3">01212</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga4a5211f314f78452584a6352eb97b2a3">hsm_message_type</a> {
<a name="l01213"></a><a class="code" href="group__lustreuser.html#gga4a5211f314f78452584a6352eb97b2a3a2420579bf34fca71d6d6c9fdb61b0414">01213</a>         <a class="code" href="group__lustreuser.html#gga4a5211f314f78452584a6352eb97b2a3a2420579bf34fca71d6d6c9fdb61b0414">HMT_ACTION_LIST</a> = 100, <span class="comment">/* message is a hsm_action_list */</span>
<a name="l01214"></a>01214 };
<a name="l01215"></a>01215 
<a name="l01216"></a>01216 <span class="comment">/* Actions the copytool may be instructed to take for a given action_item */</span>
<a name="l01217"></a><a class="code" href="group__lustreuser.html#ga8f11bf6f2778549a17dc5999701f3c0c">01217</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga8f11bf6f2778549a17dc5999701f3c0c">hsm_copytool_action</a> {
<a name="l01218"></a><a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0cabe5a3487aa46f17eb485b21762a60e4c">01218</a>         <a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0cabe5a3487aa46f17eb485b21762a60e4c">HSMA_NONE</a>    = 10, <span class="comment">/* no action */</span>
<a name="l01219"></a><a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0caa44d9e32dd07be13baa43fa8edcd7633">01219</a>         <a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0caa44d9e32dd07be13baa43fa8edcd7633">HSMA_ARCHIVE</a> = 20, <span class="comment">/* arbitrary offset */</span>
<a name="l01220"></a><a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0caa39ed66c50c133f00ab1a4f0515c034c">01220</a>         <a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0caa39ed66c50c133f00ab1a4f0515c034c">HSMA_RESTORE</a> = 21,
<a name="l01221"></a><a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0cab5f41867b413736ba8aa8f0169daf13c">01221</a>         <a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0cab5f41867b413736ba8aa8f0169daf13c">HSMA_REMOVE</a>  = 22,
<a name="l01222"></a><a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0ca5d18cacedca1a4ccefc312b5522923ae">01222</a>         <a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0ca5d18cacedca1a4ccefc312b5522923ae">HSMA_CANCEL</a>  = 23
<a name="l01223"></a>01223 };
<a name="l01224"></a>01224 
<a name="l01225"></a><a class="code" href="group__lustreuser.html#ga3463eaff8d4d8e21a20b39d97949741f">01225</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__lustreuser.html#ga3463eaff8d4d8e21a20b39d97949741f">hsm_copytool_action2name</a>(<span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga8f11bf6f2778549a17dc5999701f3c0c">hsm_copytool_action</a>  a)
<a name="l01226"></a>01226 {
<a name="l01227"></a>01227         <span class="keywordflow">switch</span>  (a) {
<a name="l01228"></a>01228         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0cabe5a3487aa46f17eb485b21762a60e4c">HSMA_NONE</a>:    <span class="keywordflow">return</span> <span class="stringliteral">&quot;NOOP&quot;</span>;
<a name="l01229"></a>01229         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0caa44d9e32dd07be13baa43fa8edcd7633">HSMA_ARCHIVE</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;ARCHIVE&quot;</span>;
<a name="l01230"></a>01230         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0caa39ed66c50c133f00ab1a4f0515c034c">HSMA_RESTORE</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;RESTORE&quot;</span>;
<a name="l01231"></a>01231         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0cab5f41867b413736ba8aa8f0169daf13c">HSMA_REMOVE</a>:  <span class="keywordflow">return</span> <span class="stringliteral">&quot;REMOVE&quot;</span>;
<a name="l01232"></a>01232         <span class="keywordflow">case</span> <a class="code" href="group__lustreuser.html#gga8f11bf6f2778549a17dc5999701f3c0ca5d18cacedca1a4ccefc312b5522923ae">HSMA_CANCEL</a>:  <span class="keywordflow">return</span> <span class="stringliteral">&quot;CANCEL&quot;</span>;
<a name="l01233"></a>01233         <span class="keywordflow">default</span>:           <span class="keywordflow">return</span> <span class="stringliteral">&quot;UNKNOWN&quot;</span>;
<a name="l01234"></a>01234         }
<a name="l01235"></a>01235 }
<a name="l01236"></a>01236 
<a name="l01237"></a>01237 <span class="comment">/* Copytool item action description */</span>
<a name="l01238"></a><a class="code" href="structhsm__action__item.html">01238</a> <span class="keyword">struct </span><a class="code" href="structhsm__action__item.html">hsm_action_item</a> {
<a name="l01239"></a><a class="code" href="structhsm__action__item.html#a96113cff6bbf3d13374879309deb181a">01239</a>         __u32      <a class="code" href="structhsm__action__item.html#a96113cff6bbf3d13374879309deb181a">hai_len</a>;     <span class="comment">/* valid size of this struct */</span>
<a name="l01240"></a><a class="code" href="structhsm__action__item.html#aecdd6fbcab85cd2438e881d3015574b4">01240</a>         __u32      <a class="code" href="structhsm__action__item.html#aecdd6fbcab85cd2438e881d3015574b4">hai_action</a>;  <span class="comment">/* hsm_copytool_action, but use known size */</span>
<a name="l01241"></a><a class="code" href="structhsm__action__item.html#a1eccaeb945f1774faeb374cd55403909">01241</a>         <a class="code" href="structlu__fid.html" title="File IDentifier.">lustre_fid</a> <a class="code" href="structhsm__action__item.html#a1eccaeb945f1774faeb374cd55403909">hai_fid</a>;     <span class="comment">/* Lustre FID to operate on */</span>
<a name="l01242"></a><a class="code" href="structhsm__action__item.html#ab2909c09e0744dac54ecc59eb5505828">01242</a>         <a class="code" href="structlu__fid.html" title="File IDentifier.">lustre_fid</a> <a class="code" href="structhsm__action__item.html#ab2909c09e0744dac54ecc59eb5505828">hai_dfid</a>;    <span class="comment">/* fid used for data access */</span>
<a name="l01243"></a><a class="code" href="structhsm__action__item.html#a5070c231ae653b0d4eb783cfcc1c6cd8">01243</a>         <span class="keyword">struct </span><a class="code" href="structhsm__extent.html">hsm_extent</a> <a class="code" href="structhsm__action__item.html#a5070c231ae653b0d4eb783cfcc1c6cd8">hai_extent</a>;  <span class="comment">/* byte range to operate on */</span>
<a name="l01244"></a><a class="code" href="structhsm__action__item.html#a2d942ebe08ce76895ac0e5a08a63f96c">01244</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>      <a class="code" href="structhsm__action__item.html#a2d942ebe08ce76895ac0e5a08a63f96c">hai_cookie</a>;  <span class="comment">/* action cookie from coordinator */</span>
<a name="l01245"></a><a class="code" href="structhsm__action__item.html#a3f3b9f84010390a048f2d076dc299b9e">01245</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>      <a class="code" href="structhsm__action__item.html#a3f3b9f84010390a048f2d076dc299b9e">hai_gid</a>;     <span class="comment">/* grouplock id */</span>
<a name="l01246"></a><a class="code" href="structhsm__action__item.html#a143b18aa8acfe37d079da3a6631b65cf">01246</a>         <span class="keywordtype">char</span>       <a class="code" href="structhsm__action__item.html#a143b18aa8acfe37d079da3a6631b65cf">hai_data</a>[0]; <span class="comment">/* variable length */</span>
<a name="l01247"></a>01247 } <a class="code" href="fid_8mod_8c.html#a804f230e6220e338767d15b94fc5801d">__attribute__</a>((<a class="code" href="group__lustreidl.html#ga30372a269f5fc08f064b7e94437589bb" title="Identifier for a single log object.">packed</a>));
<a name="l01248"></a>01248 
<a name="l01249"></a>01249 <span class="comment">/*</span>
<a name="l01250"></a>01250 <span class="comment"> * helper function which print in hexa the first bytes of</span>
<a name="l01251"></a>01251 <span class="comment"> * hai opaque field</span>
<a name="l01252"></a>01252 <span class="comment"> * \param hai [IN] record to print</span>
<a name="l01253"></a>01253 <span class="comment"> * \param buffer [OUT] output buffer</span>
<a name="l01254"></a>01254 <span class="comment"> * \param len [IN] max buffer len</span>
<a name="l01255"></a>01255 <span class="comment"> * \retval buffer</span>
<a name="l01256"></a>01256 <span class="comment"> */</span>
<a name="l01257"></a><a class="code" href="group__lustreuser.html#gaf620635cbb94a8b3bc1fdcb64b07adfd">01257</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">char</span> *<a class="code" href="group__lustreuser.html#gaf620635cbb94a8b3bc1fdcb64b07adfd">hai_dump_data_field</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structhsm__action__item.html">hsm_action_item</a> *hai,
<a name="l01258"></a>01258                                         <span class="keywordtype">char</span> *buffer, <span class="keywordtype">int</span> len)
<a name="l01259"></a>01259 {
<a name="l01260"></a>01260         <span class="keywordtype">int</span> i, sz, data_len;
<a name="l01261"></a>01261         <span class="keywordtype">char</span> *ptr;
<a name="l01262"></a>01262 
<a name="l01263"></a>01263         ptr = buffer;
<a name="l01264"></a>01264         sz = len;
<a name="l01265"></a>01265         data_len = hai-&gt;<a class="code" href="structhsm__action__item.html#a96113cff6bbf3d13374879309deb181a">hai_len</a> - <span class="keyword">sizeof</span>(*hai);
<a name="l01266"></a>01266         <span class="keywordflow">for</span> (i = 0 ; (i &lt; data_len) &amp;&amp; (sz &gt; 0) ; i++)
<a name="l01267"></a>01267         {
<a name="l01268"></a>01268                 <span class="keywordtype">int</span> cnt;
<a name="l01269"></a>01269 
<a name="l01270"></a>01270                 cnt = snprintf(ptr, sz, <span class="stringliteral">&quot;%.2X&quot;</span>,
<a name="l01271"></a>01271                                (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)hai-&gt;<a class="code" href="structhsm__action__item.html#a143b18aa8acfe37d079da3a6631b65cf">hai_data</a>[i]);
<a name="l01272"></a>01272                 ptr += cnt;
<a name="l01273"></a>01273                 sz -= cnt;
<a name="l01274"></a>01274         }
<a name="l01275"></a>01275         *ptr = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01276"></a>01276         <span class="keywordflow">return</span> buffer;
<a name="l01277"></a>01277 }
<a name="l01278"></a>01278 
<a name="l01279"></a>01279 <span class="comment">/* Copytool action list */</span>
<a name="l01280"></a><a class="code" href="group__lustreuser.html#ga547e7ece8567cec2d2e0c32e961a7e03">01280</a> <span class="preprocessor">#define HAL_VERSION 1</span>
<a name="l01281"></a><a class="code" href="group__lustreuser.html#ga79e46e3cdcecae21b8c5b94badfbe4fd">01281</a> <span class="preprocessor"></span><span class="preprocessor">#define HAL_MAXSIZE LNET_MTU </span><span class="comment">/* bytes, used in userspace only */</span>
<a name="l01282"></a><a class="code" href="structhsm__action__list.html">01282</a> <span class="keyword">struct </span><a class="code" href="structhsm__action__list.html">hsm_action_list</a> {
<a name="l01283"></a><a class="code" href="structhsm__action__list.html#a36be0f08837da5cce5a3bd0bb0fdac4a">01283</a>         __u32 <a class="code" href="structhsm__action__list.html#a36be0f08837da5cce5a3bd0bb0fdac4a">hal_version</a>;
<a name="l01284"></a><a class="code" href="structhsm__action__list.html#a807d1dcfd7be62c4b1d20902a057e4f3">01284</a>         __u32 <a class="code" href="structhsm__action__list.html#a807d1dcfd7be62c4b1d20902a057e4f3">hal_count</a>;       <span class="comment">/* number of hai&apos;s to follow */</span>
<a name="l01285"></a><a class="code" href="structhsm__action__list.html#a030326fbb3a8d9a17695f108a8157638">01285</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structhsm__action__list.html#a030326fbb3a8d9a17695f108a8157638">hal_compound_id</a>; <span class="comment">/* returned by coordinator */</span>
<a name="l01286"></a><a class="code" href="structhsm__action__list.html#a1f6f580e1673472d2f1bdd1845b572e6">01286</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structhsm__action__list.html#a1f6f580e1673472d2f1bdd1845b572e6">hal_flags</a>;
<a name="l01287"></a><a class="code" href="structhsm__action__list.html#aa888658c786c01db6fe07267b8880f3e">01287</a>         __u32 <a class="code" href="structhsm__action__list.html#aa888658c786c01db6fe07267b8880f3e">hal_archive_id</a>; <span class="comment">/* which archive backend */</span>
<a name="l01288"></a><a class="code" href="structhsm__action__list.html#a2acce47e8b0c3c4fb01d921111fdcf83">01288</a>         __u32 <a class="code" href="structhsm__action__list.html#a2acce47e8b0c3c4fb01d921111fdcf83">padding1</a>;
<a name="l01289"></a><a class="code" href="structhsm__action__list.html#a2e3ea0ecb60a7e7d1d66b6bc5eb263a1">01289</a>         <span class="keywordtype">char</span>  <a class="code" href="structhsm__action__list.html#a2e3ea0ecb60a7e7d1d66b6bc5eb263a1">hal_fsname</a>[0];   <span class="comment">/* null-terminated */</span>
<a name="l01290"></a>01290         <span class="comment">/* struct hsm_action_item[hal_count] follows, aligned on 8-byte</span>
<a name="l01291"></a>01291 <span class="comment">           boundaries. See hai_zero */</span>
<a name="l01292"></a>01292 } <a class="code" href="fid_8mod_8c.html#a804f230e6220e338767d15b94fc5801d">__attribute__</a>((<a class="code" href="group__lustreidl.html#ga30372a269f5fc08f064b7e94437589bb" title="Identifier for a single log object.">packed</a>));
<a name="l01293"></a>01293 
<a name="l01294"></a>01294 <span class="preprocessor">#ifndef HAVE_CFS_SIZE_ROUND</span>
<a name="l01295"></a><a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">01295</a> <span class="preprocessor"></span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">cfs_size_round</a> (<span class="keywordtype">int</span> val)
<a name="l01296"></a>01296 {
<a name="l01297"></a>01297         <span class="keywordflow">return</span> (val + 7) &amp; (~0x7);
<a name="l01298"></a>01298 }
<a name="l01299"></a>01299 <span class="preprocessor">#define HAVE_CFS_SIZE_ROUND</span>
<a name="l01300"></a>01300 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l01301"></a>01301 <span class="preprocessor"></span>
<a name="l01302"></a>01302 <span class="comment">/* Return pointer to first hai in action list */</span>
<a name="l01303"></a><a class="code" href="group__lustreuser.html#ga6d926d9c843ddf7e3447935258d11816">01303</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structhsm__action__item.html">hsm_action_item</a> *<a class="code" href="group__lustreuser.html#ga6d926d9c843ddf7e3447935258d11816">hai_first</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__action__list.html">hsm_action_list</a> *hal)
<a name="l01304"></a>01304 {
<a name="l01305"></a>01305         <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structhsm__action__item.html">hsm_action_item</a> *)(hal-&gt;<a class="code" href="structhsm__action__list.html#a2e3ea0ecb60a7e7d1d66b6bc5eb263a1">hal_fsname</a> +
<a name="l01306"></a>01306                                           <a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">cfs_size_round</a>(strlen(hal-&gt; \
<a name="l01307"></a>01307                                                                 hal_fsname)
<a name="l01308"></a>01308                                                          + 1));
<a name="l01309"></a>01309 }
<a name="l01310"></a>01310 <span class="comment">/* Return pointer to next hai */</span>
<a name="l01311"></a><a class="code" href="group__lustreuser.html#gac3954160b6cc61d14799ff62f3da1d70">01311</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span><a class="code" href="structhsm__action__item.html">hsm_action_item</a> * <a class="code" href="group__lustreuser.html#gac3954160b6cc61d14799ff62f3da1d70">hai_next</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__action__item.html">hsm_action_item</a> *hai)
<a name="l01312"></a>01312 {
<a name="l01313"></a>01313         <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structhsm__action__item.html">hsm_action_item</a> *)((<span class="keywordtype">char</span> *)hai +
<a name="l01314"></a>01314                                           <a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">cfs_size_round</a>(hai-&gt;<a class="code" href="structhsm__action__item.html#a96113cff6bbf3d13374879309deb181a">hai_len</a>));
<a name="l01315"></a>01315 }
<a name="l01316"></a>01316 
<a name="l01317"></a>01317 <span class="comment">/* Return size of an hsm_action_list */</span>
<a name="l01318"></a><a class="code" href="group__lustreuser.html#ga6d4160e96d16b42f15a6e73141c4fd66">01318</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="group__lustreuser.html#ga6d4160e96d16b42f15a6e73141c4fd66">hal_size</a>(<span class="keyword">struct</span> <a class="code" href="structhsm__action__list.html">hsm_action_list</a> *hal)
<a name="l01319"></a>01319 {
<a name="l01320"></a>01320         __u32 i;
<a name="l01321"></a>01321         <span class="keywordtype">size_t</span> sz;
<a name="l01322"></a>01322         <span class="keyword">struct </span><a class="code" href="structhsm__action__item.html">hsm_action_item</a> *hai;
<a name="l01323"></a>01323 
<a name="l01324"></a>01324         sz = <span class="keyword">sizeof</span>(*hal) + <a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">cfs_size_round</a>(strlen(hal-&gt;<a class="code" href="structhsm__action__list.html#a2e3ea0ecb60a7e7d1d66b6bc5eb263a1">hal_fsname</a>) + 1);
<a name="l01325"></a>01325         hai = <a class="code" href="group__lustreuser.html#ga6d926d9c843ddf7e3447935258d11816">hai_first</a>(hal);
<a name="l01326"></a>01326         <span class="keywordflow">for</span> (i = 0; i &lt; hal-&gt;<a class="code" href="structhsm__action__list.html#a807d1dcfd7be62c4b1d20902a057e4f3">hal_count</a> ; i++, hai = <a class="code" href="group__lustreuser.html#gac3954160b6cc61d14799ff62f3da1d70">hai_next</a>(hai))
<a name="l01327"></a>01327                 sz += <a class="code" href="group__lustreuser.html#ga605663c49f0739d2448d229b0ba3474d">cfs_size_round</a>(hai-&gt;hai_len);
<a name="l01328"></a>01328 
<a name="l01329"></a>01329         <span class="keywordflow">return</span> sz;
<a name="l01330"></a>01330 }
<a name="l01331"></a>01331 
<a name="l01332"></a>01332 <span class="comment">/* HSM file import</span>
<a name="l01333"></a>01333 <span class="comment"> * describe the attributes to be set on imported file</span>
<a name="l01334"></a>01334 <span class="comment"> */</span>
<a name="l01335"></a><a class="code" href="structhsm__user__import.html">01335</a> <span class="keyword">struct </span><a class="code" href="structhsm__user__import.html">hsm_user_import</a> {
<a name="l01336"></a><a class="code" href="structhsm__user__import.html#a344e54226e0103611deb17fdc2f049b1">01336</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structhsm__user__import.html#a344e54226e0103611deb17fdc2f049b1">hui_size</a>;
<a name="l01337"></a><a class="code" href="structhsm__user__import.html#a584249ba7eb8bc61030f3dd4ab2ae4b2">01337</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structhsm__user__import.html#a584249ba7eb8bc61030f3dd4ab2ae4b2">hui_atime</a>;
<a name="l01338"></a><a class="code" href="structhsm__user__import.html#a0b9883ecf9779c12cc5f9a8d20fa1f73">01338</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>           <a class="code" href="structhsm__user__import.html#a0b9883ecf9779c12cc5f9a8d20fa1f73">hui_mtime</a>;
<a name="l01339"></a><a class="code" href="structhsm__user__import.html#ad0db23bb410fff9348ff00ba7f231b08">01339</a>         __u32           <a class="code" href="structhsm__user__import.html#ad0db23bb410fff9348ff00ba7f231b08">hui_atime_ns</a>;
<a name="l01340"></a><a class="code" href="structhsm__user__import.html#a23281db4b1ad04f3e1f10ebe518050a3">01340</a>         __u32           <a class="code" href="structhsm__user__import.html#a23281db4b1ad04f3e1f10ebe518050a3">hui_mtime_ns</a>;
<a name="l01341"></a><a class="code" href="structhsm__user__import.html#a0406920a409f65dd910bbbe938a04de5">01341</a>         __u32           <a class="code" href="structhsm__user__import.html#a0406920a409f65dd910bbbe938a04de5">hui_uid</a>;
<a name="l01342"></a><a class="code" href="structhsm__user__import.html#a7b3d890eb41ecfb19675e303f41e4b31">01342</a>         __u32           <a class="code" href="structhsm__user__import.html#a7b3d890eb41ecfb19675e303f41e4b31">hui_gid</a>;
<a name="l01343"></a><a class="code" href="structhsm__user__import.html#a399aa01a198e77963a0fa9556e560081">01343</a>         __u32           <a class="code" href="structhsm__user__import.html#a399aa01a198e77963a0fa9556e560081">hui_mode</a>;
<a name="l01344"></a><a class="code" href="structhsm__user__import.html#af08c145c7ec7aa5e09d4e323329c8019">01344</a>         __u32           <a class="code" href="structhsm__user__import.html#af08c145c7ec7aa5e09d4e323329c8019">hui_archive_id</a>;
<a name="l01345"></a>01345 };
<a name="l01346"></a>01346 
<a name="l01347"></a>01347 <span class="comment">/* Copytool progress reporting */</span>
<a name="l01348"></a><a class="code" href="group__lustreuser.html#gad6a448021738c0611525b465cc31d7ea">01348</a> <span class="preprocessor">#define HP_FLAG_COMPLETED 0x01</span>
<a name="l01349"></a><a class="code" href="group__lustreuser.html#gadec5c7fe5c3098b015f07b27fb56fa7e">01349</a> <span class="preprocessor"></span><span class="preprocessor">#define HP_FLAG_RETRY     0x02</span>
<a name="l01350"></a>01350 <span class="preprocessor"></span>
<a name="l01351"></a><a class="code" href="structhsm__progress.html">01351</a> <span class="keyword">struct </span><a class="code" href="structhsm__progress.html">hsm_progress</a> {
<a name="l01352"></a><a class="code" href="structhsm__progress.html#aa55326360277c9f187cc6611cff3e9d6">01352</a>         <a class="code" href="structlu__fid.html" title="File IDentifier.">lustre_fid</a>              <a class="code" href="structhsm__progress.html#aa55326360277c9f187cc6611cff3e9d6">hp_fid</a>;
<a name="l01353"></a><a class="code" href="structhsm__progress.html#ad2ad21152ed514dfdbea0cb795716bec">01353</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                   <a class="code" href="structhsm__progress.html#ad2ad21152ed514dfdbea0cb795716bec">hp_cookie</a>;
<a name="l01354"></a><a class="code" href="structhsm__progress.html#a3692ee2ffc0b7d9bdbe5be92c3469fdd">01354</a>         <span class="keyword">struct </span><a class="code" href="structhsm__extent.html">hsm_extent</a>       <a class="code" href="structhsm__progress.html#a3692ee2ffc0b7d9bdbe5be92c3469fdd">hp_extent</a>;
<a name="l01355"></a><a class="code" href="structhsm__progress.html#a8275f6c1a5326220adfba5279ce0f606">01355</a>         __u16                   <a class="code" href="structhsm__progress.html#a8275f6c1a5326220adfba5279ce0f606">hp_flags</a>;
<a name="l01356"></a><a class="code" href="structhsm__progress.html#ab6081a2c0ee26d771d057a40a6bfe250">01356</a>         __u16                   <a class="code" href="structhsm__progress.html#ab6081a2c0ee26d771d057a40a6bfe250">hp_errval</a>; <span class="comment">/* positive val */</span>
<a name="l01357"></a><a class="code" href="structhsm__progress.html#a69fc1b55a32d49e418ca464b043176cc">01357</a>         __u32                   <a class="code" href="structhsm__progress.html#a69fc1b55a32d49e418ca464b043176cc">padding</a>;
<a name="l01358"></a>01358 };
<a name="l01359"></a>01359 
<a name="l01360"></a><a class="code" href="structhsm__copy.html">01360</a> <span class="keyword">struct </span><a class="code" href="structhsm__copy.html">hsm_copy</a> {
<a name="l01361"></a><a class="code" href="structhsm__copy.html#ac1316228cf8224c0030a929795193e62">01361</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                   <a class="code" href="structhsm__copy.html#ac1316228cf8224c0030a929795193e62">hc_data_version</a>;
<a name="l01362"></a><a class="code" href="structhsm__copy.html#aa32d089d559536f627c48ce933909f27">01362</a>         __u16                   <a class="code" href="structhsm__copy.html#aa32d089d559536f627c48ce933909f27">hc_flags</a>;
<a name="l01363"></a><a class="code" href="structhsm__copy.html#a64b7ecbb69ea70b0551bf6ceedb996bc">01363</a>         __u16                   <a class="code" href="structhsm__copy.html#a64b7ecbb69ea70b0551bf6ceedb996bc">hc_errval</a>; <span class="comment">/* positive val */</span>
<a name="l01364"></a><a class="code" href="structhsm__copy.html#a0c0b54d16c3dda78dbb949bfe2f0c0a2">01364</a>         __u32                   <a class="code" href="structhsm__copy.html#a0c0b54d16c3dda78dbb949bfe2f0c0a2">padding</a>;
<a name="l01365"></a><a class="code" href="structhsm__copy.html#a8bfbfb6b12c281f28f0baafa9e61a1c0">01365</a>         <span class="keyword">struct </span><a class="code" href="structhsm__action__item.html">hsm_action_item</a>  <a class="code" href="structhsm__copy.html#a8bfbfb6b12c281f28f0baafa9e61a1c0">hc_hai</a>;
<a name="l01366"></a>01366 };
<a name="l01367"></a>01367 
<a name="l01368"></a>01368 <span class="comment">/* JSON objects */</span>
<a name="l01369"></a><a class="code" href="group__lustreuser.html#ga7c443299beb27237c00043d9c1724768">01369</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga7c443299beb27237c00043d9c1724768">llapi_json_types</a> {
<a name="l01370"></a><a class="code" href="group__lustreuser.html#gga7c443299beb27237c00043d9c1724768a77994d3635148a7ab11d87c07aa6cdf6">01370</a>         <a class="code" href="group__lustreuser.html#gga7c443299beb27237c00043d9c1724768a77994d3635148a7ab11d87c07aa6cdf6">LLAPI_JSON_INTEGER</a> = 1,
<a name="l01371"></a><a class="code" href="group__lustreuser.html#gga7c443299beb27237c00043d9c1724768a39f5425d9bbaf44b30d28341343593c7">01371</a>         <a class="code" href="group__lustreuser.html#gga7c443299beb27237c00043d9c1724768a39f5425d9bbaf44b30d28341343593c7">LLAPI_JSON_BIGNUM</a>,
<a name="l01372"></a><a class="code" href="group__lustreuser.html#gga7c443299beb27237c00043d9c1724768abe16dc3d3b875cf328a4dae4a14258fa">01372</a>         <a class="code" href="group__lustreuser.html#gga7c443299beb27237c00043d9c1724768abe16dc3d3b875cf328a4dae4a14258fa">LLAPI_JSON_REAL</a>,
<a name="l01373"></a><a class="code" href="group__lustreuser.html#gga7c443299beb27237c00043d9c1724768a2486a4a66cc7eb2113e613ea3d39a1ae">01373</a>         <a class="code" href="group__lustreuser.html#gga7c443299beb27237c00043d9c1724768a2486a4a66cc7eb2113e613ea3d39a1ae">LLAPI_JSON_STRING</a>
<a name="l01374"></a>01374 };
<a name="l01375"></a>01375 
<a name="l01376"></a><a class="code" href="structllapi__json__item.html">01376</a> <span class="keyword">struct </span><a class="code" href="structllapi__json__item.html">llapi_json_item</a> {
<a name="l01377"></a><a class="code" href="structllapi__json__item.html#a4bcd3622369b28a53a3607678bf6a32f">01377</a>         <span class="keywordtype">char</span>                    *<a class="code" href="structllapi__json__item.html#a4bcd3622369b28a53a3607678bf6a32f">lji_key</a>;
<a name="l01378"></a><a class="code" href="structllapi__json__item.html#a405f9bdc377b05fddc4d2934a2cfca57">01378</a>         __u32                   <a class="code" href="structllapi__json__item.html#a405f9bdc377b05fddc4d2934a2cfca57">lji_type</a>;
<a name="l01379"></a>01379         <span class="keyword">union </span>{
<a name="l01380"></a><a class="code" href="structllapi__json__item.html#a182ca985e04cfc712c5a99fdcb629c96">01380</a>                 <span class="keywordtype">int</span>     <a class="code" href="structllapi__json__item.html#a182ca985e04cfc712c5a99fdcb629c96">lji_integer</a>;
<a name="l01381"></a><a class="code" href="structllapi__json__item.html#a5d91b28ec4cefee802a3302bcb8682ec">01381</a>                 <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>   <a class="code" href="structllapi__json__item.html#a5d91b28ec4cefee802a3302bcb8682ec">lji_u64</a>;
<a name="l01382"></a><a class="code" href="structllapi__json__item.html#a0031eacfbc84c3da5bb93ad7d6274aff">01382</a>                 <span class="keywordtype">double</span>  <a class="code" href="structllapi__json__item.html#a0031eacfbc84c3da5bb93ad7d6274aff">lji_real</a>;
<a name="l01383"></a><a class="code" href="structllapi__json__item.html#ac89cae82de34d0324475b3212c25a891">01383</a>                 <span class="keywordtype">char</span>    *<a class="code" href="structllapi__json__item.html#ac89cae82de34d0324475b3212c25a891">lji_string</a>;
<a name="l01384"></a>01384         };
<a name="l01385"></a><a class="code" href="structllapi__json__item.html#a58b8345cb204b7c28c044a7521c95a28">01385</a>         <span class="keyword">struct </span><a class="code" href="structllapi__json__item.html">llapi_json_item</a>  *<a class="code" href="structllapi__json__item.html#a58b8345cb204b7c28c044a7521c95a28">lji_next</a>;
<a name="l01386"></a>01386 };
<a name="l01387"></a>01387 
<a name="l01388"></a><a class="code" href="structllapi__json__item__list.html">01388</a> <span class="keyword">struct </span><a class="code" href="structllapi__json__item__list.html">llapi_json_item_list</a> {
<a name="l01389"></a><a class="code" href="structllapi__json__item__list.html#a1944c4f6a6c6afe39ef2b8e45300d25c">01389</a>         <span class="keywordtype">int</span>                     <a class="code" href="structllapi__json__item__list.html#a1944c4f6a6c6afe39ef2b8e45300d25c">ljil_item_count</a>;
<a name="l01390"></a><a class="code" href="structllapi__json__item__list.html#a329985dec98610dd07114187f7e7f387">01390</a>         <span class="keyword">struct </span><a class="code" href="structllapi__json__item.html">llapi_json_item</a>  *<a class="code" href="structllapi__json__item__list.html#a329985dec98610dd07114187f7e7f387">ljil_items</a>;
<a name="l01391"></a>01391 };
<a name="l01392"></a>01392 
<a name="l01393"></a><a class="code" href="group__lustreuser.html#ga6800d248c7e9177fa2705d90cb97c86f">01393</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga6800d248c7e9177fa2705d90cb97c86f">lu_ladvise_type</a> {
<a name="l01394"></a><a class="code" href="group__lustreuser.html#gga6800d248c7e9177fa2705d90cb97c86fa39cefe3847f85c9a316d7c33ad78f25d">01394</a>         <a class="code" href="group__lustreuser.html#gga6800d248c7e9177fa2705d90cb97c86fa39cefe3847f85c9a316d7c33ad78f25d">LU_LADVISE_INVALID</a>      = 0,
<a name="l01395"></a>01395 };
<a name="l01396"></a>01396 
<a name="l01397"></a><a class="code" href="group__lustreuser.html#ga9cd2348cf1b609464ed35ed92b834f2f">01397</a> <span class="preprocessor">#define LU_LADVISE_NAMES {                                              \</span>
<a name="l01398"></a>01398 <span class="preprocessor">}</span>
<a name="l01399"></a>01399 <span class="preprocessor"></span>
<a name="l01400"></a><a class="code" href="structlu__ladvise.html">01400</a> <span class="keyword">struct </span><a class="code" href="structlu__ladvise.html">lu_ladvise</a> {
<a name="l01401"></a><a class="code" href="structlu__ladvise.html#a17f21483ca052db32c8218c08f908e92">01401</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structlu__ladvise.html#a17f21483ca052db32c8218c08f908e92">lla_advice</a>;
<a name="l01402"></a><a class="code" href="structlu__ladvise.html#a1c5eef149bad57cfcf20d3c2c876ae6d">01402</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structlu__ladvise.html#a1c5eef149bad57cfcf20d3c2c876ae6d">lla_start</a>;
<a name="l01403"></a><a class="code" href="structlu__ladvise.html#a6dc94c416f6b7b966fc6a420baaabe79">01403</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structlu__ladvise.html#a6dc94c416f6b7b966fc6a420baaabe79">lla_end</a>;
<a name="l01404"></a><a class="code" href="structlu__ladvise.html#aef3d412f9437591b93ff0dccfe830c5c">01404</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="code" href="structlu__ladvise.html#aef3d412f9437591b93ff0dccfe830c5c">lla_padding</a>;
<a name="l01405"></a>01405 };
<a name="l01406"></a>01406 
<a name="l01407"></a><a class="code" href="group__lustreuser.html#ga67d443b1e45f93c2ca697179ab3a06ed">01407</a> <span class="keyword">enum</span> <a class="code" href="group__lustreuser.html#ga67d443b1e45f93c2ca697179ab3a06ed">ladvise_flag</a> {
<a name="l01408"></a><a class="code" href="group__lustreuser.html#gga67d443b1e45f93c2ca697179ab3a06eda5ee654c62b0183dcc48f1a673f889dea">01408</a>         <a class="code" href="group__lustreuser.html#gga67d443b1e45f93c2ca697179ab3a06eda5ee654c62b0183dcc48f1a673f889dea">LF_ASYNC</a>        = 0x00000001,
<a name="l01409"></a>01409 };
<a name="l01410"></a>01410 
<a name="l01411"></a><a class="code" href="group__lustreuser.html#ga1417963041ec2731972de13d00cde673">01411</a> <span class="preprocessor">#define LADVISE_MAGIC 0x1ADF1CE0</span>
<a name="l01412"></a><a class="code" href="group__lustreuser.html#ga935da756be698fde0145b3716520d367">01412</a> <span class="preprocessor"></span><span class="preprocessor">#define LF_MASK LF_ASYNC</span>
<a name="l01413"></a>01413 <span class="preprocessor"></span>
<a name="l01414"></a><a class="code" href="structladvise__hdr.html">01414</a> <span class="keyword">struct </span><a class="code" href="structladvise__hdr.html">ladvise_hdr</a> {
<a name="l01415"></a><a class="code" href="structladvise__hdr.html#acbe9136dd47a305c8de1ea7a716e3b78">01415</a>         __u32                   <a class="code" href="structladvise__hdr.html#acbe9136dd47a305c8de1ea7a716e3b78">lah_magic</a>;      <span class="comment">/* LADVISE_MAGIC */</span>
<a name="l01416"></a><a class="code" href="structladvise__hdr.html#a8961a339c8782ea550ca99d4e05111e5">01416</a>         __u32                   <a class="code" href="structladvise__hdr.html#a8961a339c8782ea550ca99d4e05111e5">lah_count</a>;      <span class="comment">/* number of advices */</span>
<a name="l01417"></a><a class="code" href="structladvise__hdr.html#aa67f7e0acb6dc63443b04034c69fa67a">01417</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                   <a class="code" href="structladvise__hdr.html#aa67f7e0acb6dc63443b04034c69fa67a">lah_flags</a>;      <span class="comment">/* from enum ladvise_flag */</span>
<a name="l01418"></a><a class="code" href="structladvise__hdr.html#a526697549681e95c36b644605a4743e0">01418</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                   <a class="code" href="structladvise__hdr.html#a526697549681e95c36b644605a4743e0">lah_padding1</a>;   <span class="comment">/* unused */</span>
<a name="l01419"></a><a class="code" href="structladvise__hdr.html#a280ba1b8f77be22d2f3ed8c1891dc7f5">01419</a>         <a class="code" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>                   <a class="code" href="structladvise__hdr.html#a280ba1b8f77be22d2f3ed8c1891dc7f5">lah_padding2</a>;   <span class="comment">/* unused */</span>
<a name="l01420"></a><a class="code" href="structladvise__hdr.html#a28365b092b4ff69798ddfe745b707b8c">01420</a>         <span class="keyword">struct </span><a class="code" href="structlu__ladvise.html">lu_ladvise</a>       <a class="code" href="structladvise__hdr.html#a28365b092b4ff69798ddfe745b707b8c">lah_advise</a>[0];
<a name="l01421"></a>01421 };
<a name="l01422"></a>01422 
<a name="l01423"></a><a class="code" href="group__lustreuser.html#ga10998e45893c4d274f8f0c15c61da453">01423</a> <span class="preprocessor">#define LAH_COUNT_MAX   (1024)</span>
<a name="l01424"></a>01424 <span class="preprocessor"></span>
<a name="l01427"></a>01427 <span class="preprocessor">#endif </span><span class="comment">/* _LUSTRE_USER_H */</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:35 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
