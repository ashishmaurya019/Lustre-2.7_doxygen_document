<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/ptlrpc/gss/sec_gss.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/ptlrpc/gss/sec_gss.c File Reference</h1><code>#include &lt;linux/init.h&gt;</code><br/>
<code>#include &lt;linux/module.h&gt;</code><br/>
<code>#include &lt;linux/slab.h&gt;</code><br/>
<code>#include &lt;linux/dcache.h&gt;</code><br/>
<code>#include &lt;linux/fs.h&gt;</code><br/>
<code>#include &lt;linux/mutex.h&gt;</code><br/>
<code>#include &lt;asm/atomic.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd_8h_source.html">obd.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__class_8h_source.html">obd_class.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__support_8h_source.html">obd_support.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__cksum_8h_source.html">obd_cksum.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__idl_8h_source.html">lustre/lustre_idl.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__net_8h_source.html">lustre_net.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__import_8h_source.html">lustre_import.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__sec_8h_source.html">lustre_sec.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="gss__err_8h_source.html">gss_err.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gss__internal_8h_source.html">gss_internal.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gss__api_8h_source.html">gss_api.h</a>&quot;</code><br/>
<code>#include &lt;linux/crypto.h&gt;</code><br/>
<code>#include &lt;linux/crc32.h&gt;</code><br/>

<p><a href="sec__gss_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#abda60744d497fcfe370cfd6b2d65c7ed">DEBUG_SUBSYSTEM</a>&nbsp;&nbsp;&nbsp;S_SEC</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a24a39bf9c797417d5fd23bb7544b78fc">GSS_KRB5_INTEG_MAX_PAYLOAD</a>&nbsp;&nbsp;&nbsp;(40)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a3a2c731eaccaa8d3b17460ab20a4b3bc">msg_last_segidx</a> (struct lustre_msg *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a75526277cc050e034ab9891554e970d1">msg_last_seglen</a> (struct lustre_msg *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a2ec62d812f84d0495c4e39cc16aa556e">gss_header_swabber</a> (struct <a class="el" href="structgss__header.html">gss_header</a> *ghdr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structgss__header.html">gss_header</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a826ccf3f7f174c513dd9ee7de4c67fce">gss_swab_header</a> (struct lustre_msg *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, int segment, int swabbed)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a3f75204b22ea280ce282cd7c162bbf05">gss_mech_payload</a> (struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *mechctx, int msgsize, int privacy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ad98d3670a5ba8ccb600b8d38927ccffb">gss_sign_msg</a> (struct lustre_msg *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *mechctx, enum <a class="el" href="group__sptlrpc.html#gaceeb8c40afd0179b5b42fc19aa58d177">lustre_sec_part</a> sp, __u32 flags, __u32 proc, __u32 seq, __u32 svc, <a class="el" href="structrawobj__s.html">rawobj_t</a> *handle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a7ae364739fd3d4e7932f1b9a96f79ba8">gss_verify_msg</a> (struct lustre_msg *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *mechctx, __u32 svc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static __u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a606e0bf8e87baf937dd849f64ce2316a">gss_unseal_msg</a> (struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *mechctx, struct lustre_msg *msgbuf, int *msg_len, int msgbuf_len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a0221581476c9d1e189b27f84ef6227b2">cli_ctx_expire</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a43452438866819b5296b6d5cf46881aa">cli_ctx_check_death</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a76fcb27561cf70c27aa394d4758ccaec">gss_cli_ctx_uptodate</a> (struct <a class="el" href="structgss__cli__ctx.html">gss_cli_ctx</a> *gctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a4636d84325f210983b756c2e237d2b0e">gss_cli_ctx_finalize</a> (struct <a class="el" href="structgss__cli__ctx.html">gss_cli_ctx</a> *gctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a17b3923b70bb138a03b0da7cdb95370b">gss_do_check_seq</a> (unsigned long *window, __u32 win_size, __u32 *max_seq, __u32 seq_num, int phase)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Based on sequence number algorithm as specified in RFC 2203.  <a href="#a17b3923b70bb138a03b0da7cdb95370b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a3b6985ae2b205d1d9c2ba35c37f8b890">gss_check_seq_num</a> (struct <a class="el" href="structgss__svc__seq__data.html">gss_svc_seq_data</a> *ssd, __u32 seq_num, int set)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a83ddca039c3392a305f9c35fe478ba7d">gss_cli_payload</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx, int msgsize, int privacy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a2ba4a470c6671cef915509495c0545dc">gss_cli_bulk_payload</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx, struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *flvr, int reply, int read)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a7d4c3436a0993e70fd4d85a4720ce3fe">gss_cli_ctx_match</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx, struct <a class="el" href="structvfs__cred.html">vfs_cred</a> *vcred)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a86a6d130026d1087c2ba06d898f9a41e">gss_cli_ctx_flags2str</a> (unsigned long flags, char *<a class="el" href="lnet_2utils_2debug_8c.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, int <a class="el" href="multiop_8c.html#a199ab88d4ca8eab30e1cb7d35edacca5">bufsize</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a44cabfb5eae388e35bd80f54163e2de2">gss_cli_ctx_sign</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#adf584bc8d7003dc2b7076c29741eddc0">gss_cli_ctx_handle_err_notify</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structgss__header.html">gss_header</a> *ghdr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a06963f5c7a48bd076af975b525838a8f">gss_cli_ctx_verify</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a66350a143a4db3b0a7a9c38204f4ea21">gss_cli_ctx_seal</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a138fabb1ff47eb6f9ee4f8d89ef0a31f">gss_cli_ctx_unseal</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a3af5afe7de95a8d868a31f6eaf1bb071">gss_install_rvs_svc_ctx</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp, struct <a class="el" href="structgss__sec.html">gss_sec</a> *gsec, struct <a class="el" href="structgss__cli__ctx.html">gss_cli_ctx</a> *gctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a6a57c0a715a5216abb0884ef437674fc">gss_sec_create_common</a> (struct <a class="el" href="structgss__sec.html">gss_sec</a> *gsec, struct <a class="el" href="structptlrpc__sec__policy.html">ptlrpc_sec_policy</a> *policy, struct <a class="el" href="structobd__import.html">obd_import</a> *imp, struct <a class="el" href="structptlrpc__svc__ctx.html">ptlrpc_svc_ctx</a> *svcctx, struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *sf)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a86eceac16ab00ecaca0759414e7aa972">gss_sec_destroy_common</a> (struct <a class="el" href="structgss__sec.html">gss_sec</a> *gsec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ac32200df78f9c91e30d9a815e4a6766c">gss_sec_kill</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a90054c1f8c6dff8cf2eccd382c4f8f79">gss_cli_ctx_init_common</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx, struct <a class="el" href="structptlrpc__ctx__ops.html">ptlrpc_ctx_ops</a> *ctxops, struct <a class="el" href="structvfs__cred.html">vfs_cred</a> *vcred)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a47d7dfde849fe699ed11fd7debf3311a">gss_cli_ctx_fini_common</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a3522cc319d9e570e29b10872fee500d1">gss_alloc_reqbuf_intg</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int svc, int msgsize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#acc635f2a96b365695d29e608af28f37f">gss_alloc_reqbuf_priv</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int msgsize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a790db4923bc126ade067f3a42c85ec37">gss_alloc_reqbuf</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int msgsize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ae0d2dc87ab5dced59080c99e48412579">gss_free_reqbuf</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a552cae7912094f4fed6869cc501f4b2b">do_alloc_repbuf</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int <a class="el" href="multiop_8c.html#a199ab88d4ca8eab30e1cb7d35edacca5">bufsize</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a90c13b5a58d5f06a899c46e7adf8e95c">gss_alloc_repbuf_intg</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int svc, int msgsize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a9606151a1277a8534e512260915b935d">gss_alloc_repbuf_priv</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int msgsize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a2122d6a74dbfbfeaf8e33dde73f5d67d">gss_alloc_repbuf</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int msgsize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a865d6db82f15ac488e72d6f25f29b585">gss_free_repbuf</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#aeae0154cb40baf563c12133a0fa28771">get_enlarged_msgsize</a> (struct lustre_msg *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, int segment, int newsize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a2c9c330f5808e1e950a57be4dd7c9b3a">get_enlarged_msgsize2</a> (struct lustre_msg *<a class="el" href="multiop_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>, int segment1, int newsize1, int segment2, int newsize2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a5fde8f2a30b166447e874833f2327e6a">gss_enlarge_reqbuf_intg</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int svc, int segment, int newsize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ac7566792305e21ef50010962f3e66318">gss_enlarge_reqbuf_priv</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int segment, int newsize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#af2276f33c9fca9b062941bd2921a798c">gss_enlarge_reqbuf</a> (struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int segment, int newsize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#aa5b20499d0da6a6ad5e2b67fafad10ee">gss_sec_install_rctx</a> (struct <a class="el" href="structobd__import.html">obd_import</a> *imp, struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *sec, struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a3d3c356b152a9112df57bd673cfd07bd">gss_svc_reqctx_is_special</a> (struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *grctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a3201b89cfea44c2b36e8b77fc816d8bf">gss_svc_reqctx_free</a> (struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *grctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ae89591fe95b5d09f0af7d9b7b1f4b272">gss_svc_reqctx_addref</a> (struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *grctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a471e63bda8ce126ee895fab1a439a728">gss_svc_reqctx_decref</a> (struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *grctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ac8523800995454641ed011a2bf538c49">gss_svc_sign</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structptlrpc__reply__state.html">ptlrpc_reply_state</a> *rs, struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *grctx, __u32 svc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a044646f329619da58a10330c0c4896c5">gss_pack_err_notify</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, __u32 major, __u32 minor)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#aa8b55f312083afddfb4913a12505bd79">gss_svc_handle_init</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structgss__wire__ctx.html">gss_wire_ctx</a> *gw)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a16538ab7b98707dbe38b956109bb08f9">gss_svc_verify_request</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *grctx, struct <a class="el" href="structgss__wire__ctx.html">gss_wire_ctx</a> *gw, __u32 *major)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ae1d5fefb196c3f194ed267f09e35dde1">gss_svc_unseal_request</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *grctx, struct <a class="el" href="structgss__wire__ctx.html">gss_wire_ctx</a> *gw, __u32 *major)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a2fd0044eb83a859b3021bd372f386f8e">gss_svc_handle_data</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structgss__wire__ctx.html">gss_wire_ctx</a> *gw)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a666b471e4db2652d9e06c3768faac084">gss_svc_handle_destroy</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structgss__wire__ctx.html">gss_wire_ctx</a> *gw)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#af6e1f09236107b4b437cf9df54bec18a">gss_svc_accept</a> (struct <a class="el" href="structptlrpc__sec__policy.html">ptlrpc_sec_policy</a> *policy, struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a65a2fcf20b33d6a9bf89b27963ea7852">gss_svc_invalidate_ctx</a> (struct <a class="el" href="structptlrpc__svc__ctx.html">ptlrpc_svc_ctx</a> *svc_ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#af64fd5f6b7769bbdaf81d12b10b88e1d">gss_svc_payload</a> (struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *grctx, int early, int msgsize, int privacy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a7a3dec22516a0ecf1cb89ee59b9817b8">gss_svc_bulk_payload</a> (struct <a class="el" href="structgss__svc__ctx.html">gss_svc_ctx</a> *gctx, struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *flvr, int read)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#abd29c9ffb7d0c9cc19ca1e3b1c4a970c">gss_svc_alloc_rs</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, int msglen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ae8891f930ad962ac15fe4f1c904912c8">gss_svc_seal</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req, struct <a class="el" href="structptlrpc__reply__state.html">ptlrpc_reply_state</a> *rs, struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *grctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#aa659134e6e34ca30e85dc652a408d7fc">gss_svc_authorize</a> (struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a065898e49f883619f2b5cde15af2bd72">gss_svc_free_rs</a> (struct <a class="el" href="structptlrpc__reply__state.html">ptlrpc_reply_state</a> *rs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a6f07334c490938a3644ceaaaeca8c1dc">gss_svc_free_ctx</a> (struct <a class="el" href="structptlrpc__svc__ctx.html">ptlrpc_svc_ctx</a> *ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ae1051f52e0434e77478f3c75778e38ae">gss_copy_rvc_cli_ctx</a> (struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *cli_ctx, struct <a class="el" href="structptlrpc__svc__ctx.html">ptlrpc_svc_ctx</a> *svc_ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a1cc1e1cd160e38673dad61b0bfffe09e">gss_init_at_reply_offset</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int __init&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#af5c176ee43df45c69ac8abff1d7afa76">sptlrpc_gss_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void __exit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ab2d37e1dd79021b348eebefcba7f111b">sptlrpc_gss_exit</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#adc10f40acba3bb9b2640e985276b0a7c">MODULE_AUTHOR</a> (&quot;OpenSFS, Inc. &lt;http://www.lustre.org/&gt;&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a9a142835e73ed6fee6c0f175b47de6c6">MODULE_DESCRIPTION</a> (&quot;Lustre GSS security policy&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ae9c321be2136fb8501887ee69dac11a2">MODULE_VERSION</a> (LUSTRE_VERSION_STRING)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ad94b36675e7eb067ea3ce6ff9e244a44">MODULE_LICENSE</a> (&quot;GPL&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a74791558dfaeb18f7ac66c0482d0236f">module_init</a> (sptlrpc_gss_init)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#aa65b57a9f15160764afe9f0fb7c4da08">module_exit</a> (sptlrpc_gss_exit)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#ad4dba51f4c0aec0aa35aab8ea71e53a8">gss_at_reply_off_integ</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sec__gss_8c.html#a7cfa79bf5e0a01d3abb0ec910fe533e9">gss_at_reply_off_priv</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="abda60744d497fcfe370cfd6b2d65c7ed"></a><!-- doxytag: member="sec_gss.c::DEBUG_SUBSYSTEM" ref="abda60744d497fcfe370cfd6b2d65c7ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_SUBSYSTEM&nbsp;&nbsp;&nbsp;S_SEC</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00049">49</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

</div>
</div>
<a class="anchor" id="a24a39bf9c797417d5fd23bb7544b78fc"></a><!-- doxytag: member="sec_gss.c::GSS_KRB5_INTEG_MAX_PAYLOAD" ref="a24a39bf9c797417d5fd23bb7544b78fc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GSS_KRB5_INTEG_MAX_PAYLOAD&nbsp;&nbsp;&nbsp;(40)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00163">163</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l00166">gss_mech_payload()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a43452438866819b5296b6d5cf46881aa"></a><!-- doxytag: member="sec_gss.c::cli_ctx_check_death" ref="a43452438866819b5296b6d5cf46881aa" args="(struct ptlrpc_cli_ctx *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cli_ctx_check_death </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00351">351</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00539">ptlrpc_cli_ctx::cc_expire</a>, <a class="el" href="libcfs__time_8h_source.html#l00056">cfs_time_after()</a>, <a class="el" href="linux-time_8h_source.html#l00157">cfs_time_current_sec()</a>, <a class="el" href="sec__gss_8c_source.html#l00327">cli_ctx_expire()</a>, <a class="el" href="lustre__sec_8h_source.html#l01019">cli_ctx_is_dead()</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="gss__pipefs_8c_source.html#l00159">ctx_check_death_pf()</a>, <a class="el" href="gss__keyring_8c_source.html#l01106">gss_cli_ctx_validate_kr()</a>, and <a class="el" href="gss__keyring_8c_source.html#l01012">gss_sec_gc_ctx_kr()</a>.</p>

</div>
</div>
<a class="anchor" id="a0221581476c9d1e189b27f84ef6227b2"></a><!-- doxytag: member="sec_gss.c::cli_ctx_expire" ref="a0221581476c9d1e189b27f84ef6227b2" args="(struct ptlrpc_cli_ctx *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cli_ctx_expire </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00327">327</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00540">ptlrpc_cli_ctx::cc_early_expire</a>, <a class="el" href="lustre__sec_8h_source.html#l00539">ptlrpc_cli_ctx::cc_expire</a>, <a class="el" href="lustre__sec_8h_source.html#l00541">ptlrpc_cli_ctx::cc_flags</a>, <a class="el" href="lustre__sec_8h_source.html#l00536">ptlrpc_cli_ctx::cc_refcount</a>, <a class="el" href="lustre__sec_8h_source.html#l00537">ptlrpc_cli_ctx::cc_sec</a>, <a class="el" href="lustre__sec_8h_source.html#l00542">ptlrpc_cli_ctx::cc_vcred</a>, <a class="el" href="linux-time_8h_source.html#l00157">cfs_time_current_sec()</a>, <a class="el" href="libcfs__time_8h_source.html#l00051">cfs_time_sub()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__sec_8h_source.html#l00517">PTLRPC_CTX_DEAD_BIT</a>, <a class="el" href="lustre__sec_8h_source.html#l00516">PTLRPC_CTX_UPTODATE_BIT</a>, <a class="el" href="sec_8c_source.html#l02511">sec2target_str()</a>, <a class="el" href="sec_8c_source.html#l00333">sptlrpc_cli_ctx_wakeup()</a>, and <a class="el" href="lustre__sec_8h_source.html#l00392">vfs_cred::vc_uid</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l00351">cli_ctx_check_death()</a>, <a class="el" href="gss__keyring_8c_source.html#l00146">ctx_upcall_timeout_kr()</a>, <a class="el" href="gss__keyring_8c_source.html#l01122">gss_cli_ctx_die_kr()</a>, <a class="el" href="gss__pipefs_8c_source.html#l00225">gss_cli_ctx_die_pf()</a>, <a class="el" href="gss__keyring_8c_source.html#l01333">gss_kt_update()</a>, and <a class="el" href="gss__pipefs_8c_source.html#l00257">gss_sec_ctx_replace_pf()</a>.</p>

</div>
</div>
<a class="anchor" id="a552cae7912094f4fed6869cc501f4b2b"></a><!-- doxytag: member="sec_gss.c::do_alloc_repbuf" ref="a552cae7912094f4fed6869cc501f4b2b" args="(struct ptlrpc_request *req, int bufsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int do_alloc_repbuf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>bufsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01475">1475</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="lustre__net_8h_source.html#l01080">ptlrpc_request::rq_repbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01086">ptlrpc_request::rq_repbuf_len</a>, and <a class="el" href="lustre__sec_8h_source.html#l00941">size_roundup_power2()</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01488">gss_alloc_repbuf_intg()</a>, and <a class="el" href="sec__gss_8c_source.html#l01541">gss_alloc_repbuf_priv()</a>.</p>

</div>
</div>
<a class="anchor" id="aeae0154cb40baf563c12133a0fa28771"></a><!-- doxytag: member="sec_gss.c::get_enlarged_msgsize" ref="aeae0154cb40baf563c12133a0fa28771" args="(struct lustre_msg *msg, int segment, int newsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int get_enlarged_msgsize </td>
          <td>(</td>
          <td class="paramtype">struct lustre_msg *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>newsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01606">1606</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, and <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01642">gss_enlarge_reqbuf_intg()</a>, and <a class="el" href="sec__gss_8c_source.html#l01733">gss_enlarge_reqbuf_priv()</a>.</p>

</div>
</div>
<a class="anchor" id="a2c9c330f5808e1e950a57be4dd7c9b3a"></a><!-- doxytag: member="sec_gss.c::get_enlarged_msgsize2" ref="a2c9c330f5808e1e950a57be4dd7c9b3a" args="(struct lustre_msg *msg, int segment1, int newsize1, int segment2, int newsize2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int get_enlarged_msgsize2 </td>
          <td>(</td>
          <td class="paramtype">struct lustre_msg *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>segment1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>newsize1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>segment2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>newsize2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01621">1621</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, and <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01642">gss_enlarge_reqbuf_intg()</a>.</p>

</div>
</div>
<a class="anchor" id="a2122d6a74dbfbfeaf8e33dde73f5d67d"></a><!-- doxytag: member="sec_gss.c::gss_alloc_repbuf" ref="a2122d6a74dbfbfeaf8e33dde73f5d67d" args="(struct ptlrpc_sec *sec, struct ptlrpc_request *req, int msgsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_alloc_repbuf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01573">1573</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="sec__gss_8c_source.html#l01488">gss_alloc_repbuf_intg()</a>, <a class="el" href="sec__gss_8c_source.html#l01541">gss_alloc_repbuf_priv()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00045">LASSERTF</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_bulk_read</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_bulk_write</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00156">SPTLRPC_FLVR_SVC</a>, <a class="el" href="lustre__sec_8h_source.html#l00113">SPTLRPC_SVC_AUTH</a>, <a class="el" href="lustre__sec_8h_source.html#l00114">SPTLRPC_SVC_INTG</a>, <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>, and <a class="el" href="lustre__sec_8h_source.html#l00115">SPTLRPC_SVC_PRIV</a>.</p>

</div>
</div>
<a class="anchor" id="a90c13b5a58d5f06a899c46e7adf8e95c"></a><!-- doxytag: member="sec_gss.c::gss_alloc_repbuf_intg" ref="a90c13b5a58d5f06a899c46e7adf8e95c" args="(struct ptlrpc_sec *sec, struct ptlrpc_request *req, int svc, int msgsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_alloc_repbuf_intg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>svc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01488">1488</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l01475">do_alloc_repbuf()</a>, <a class="el" href="sec__gss_8c_source.html#l00078">gss_at_reply_off_integ</a>, <a class="el" href="sec__gss_8c_source.html#l00588">gss_cli_bulk_payload()</a>, <a class="el" href="sec__gss_8c_source.html#l00582">gss_cli_payload()</a>, <a class="el" href="gss__internal_8h_source.html#l00350">GSS_CTX_INIT_MAX_LEN</a>, <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>, <a class="el" href="gss__internal_8h_source.html#l00194">PTLRPC_GSS_HEADER_SIZE</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_bulk_read</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_init</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__sec_8h_source.html#l00114">SPTLRPC_SVC_INTG</a>, and <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01573">gss_alloc_repbuf()</a>.</p>

</div>
</div>
<a class="anchor" id="a9606151a1277a8534e512260915b935d"></a><!-- doxytag: member="sec_gss.c::gss_alloc_repbuf_priv" ref="a9606151a1277a8534e512260915b935d" args="(struct ptlrpc_sec *sec, struct ptlrpc_request *req, int msgsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_alloc_repbuf_priv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01541">1541</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l01475">do_alloc_repbuf()</a>, <a class="el" href="sec__gss_8c_source.html#l00079">gss_at_reply_off_priv</a>, <a class="el" href="sec__gss_8c_source.html#l00588">gss_cli_bulk_payload()</a>, <a class="el" href="sec__gss_8c_source.html#l00582">gss_cli_payload()</a>, <a class="el" href="gss__internal_8h_source.html#l00090">GSS_MAX_CIPHER_BLOCK</a>, <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>, <a class="el" href="gss__internal_8h_source.html#l00194">PTLRPC_GSS_HEADER_SIZE</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_bulk_read</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, and <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01573">gss_alloc_repbuf()</a>.</p>

</div>
</div>
<a class="anchor" id="a790db4923bc126ade067f3a42c85ec37"></a><!-- doxytag: member="sec_gss.c::gss_alloc_reqbuf" ref="a790db4923bc126ade067f3a42c85ec37" args="(struct ptlrpc_sec *sec, struct ptlrpc_request *req, int msgsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_alloc_reqbuf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01416">1416</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l01253">gss_alloc_reqbuf_intg()</a>, <a class="el" href="sec__gss_8c_source.html#l01335">gss_alloc_reqbuf_priv()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00045">LASSERTF</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_bulk_read</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_bulk_write</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00156">SPTLRPC_FLVR_SVC</a>, <a class="el" href="lustre__sec_8h_source.html#l00113">SPTLRPC_SVC_AUTH</a>, <a class="el" href="lustre__sec_8h_source.html#l00114">SPTLRPC_SVC_INTG</a>, <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>, and <a class="el" href="lustre__sec_8h_source.html#l00115">SPTLRPC_SVC_PRIV</a>.</p>

</div>
</div>
<a class="anchor" id="a3522cc319d9e570e29b10872fee500d1"></a><!-- doxytag: member="sec_gss.c::gss_alloc_reqbuf_intg" ref="a3522cc319d9e570e29b10872fee500d1" args="(struct ptlrpc_sec *sec, struct ptlrpc_request *req, int svc, int msgsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_alloc_reqbuf_intg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>svc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01253">1253</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="multiop_8c_source.html#l00065">bufsize</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="sec__gss_8c_source.html#l00588">gss_cli_bulk_payload()</a>, <a class="el" href="sec__gss_8c_source.html#l00582">gss_cli_payload()</a>, <a class="el" href="gss__internal_8h_source.html#l00350">GSS_CTX_INIT_MAX_LEN</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="pack__generic_8c_source.html#l00192">lustre_init_msg_v2()</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>, <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="gss__internal_8h_source.html#l00194">PTLRPC_GSS_HEADER_SIZE</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_bulk_read</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_init</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_udesc</a>, <a class="el" href="lustre__net_8h_source.html#l01028">ptlrpc_request::rq_pool</a>, <a class="el" href="lustre__net_8h_source.html#l01079">ptlrpc_request::rq_reqbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01084">ptlrpc_request::rq_reqbuf_len</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00941">size_roundup_power2()</a>, <a class="el" href="sec_8c_source.html#l02432">sptlrpc_current_user_desc_size()</a>, <a class="el" href="sec_8c_source.html#l02444">sptlrpc_pack_user_desc()</a>, <a class="el" href="lustre__sec_8h_source.html#l00114">SPTLRPC_SVC_INTG</a>, and <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01416">gss_alloc_reqbuf()</a>.</p>

</div>
</div>
<a class="anchor" id="acc635f2a96b365695d29e608af28f37f"></a><!-- doxytag: member="sec_gss.c::gss_alloc_reqbuf_priv" ref="acc635f2a96b365695d29e608af28f37f" args="(struct ptlrpc_sec *sec, struct ptlrpc_request *req, int msgsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_alloc_reqbuf_priv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01335">1335</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="sec__gss_8c_source.html#l00588">gss_cli_bulk_payload()</a>, <a class="el" href="sec__gss_8c_source.html#l00582">gss_cli_payload()</a>, <a class="el" href="gss__internal_8h_source.html#l00090">GSS_MAX_CIPHER_BLOCK</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="pack__generic_8c_source.html#l00192">lustre_init_msg_v2()</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>, <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="gss__internal_8h_source.html#l00194">PTLRPC_GSS_HEADER_SIZE</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_bulk_read</a>, <a class="el" href="lustre__net_8h_source.html#l01083">ptlrpc_request::rq_clrbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01088">ptlrpc_request::rq_clrbuf_len</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_udesc</a>, <a class="el" href="lustre__net_8h_source.html#l01028">ptlrpc_request::rq_pool</a>, <a class="el" href="lustre__net_8h_source.html#l01079">ptlrpc_request::rq_reqbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01084">ptlrpc_request::rq_reqbuf_len</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="lustre__sec_8h_source.html#l00941">size_roundup_power2()</a>, <a class="el" href="sec_8c_source.html#l02432">sptlrpc_current_user_desc_size()</a>, and <a class="el" href="sec_8c_source.html#l02444">sptlrpc_pack_user_desc()</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01416">gss_alloc_reqbuf()</a>.</p>

</div>
</div>
<a class="anchor" id="a3b6985ae2b205d1d9c2ba35c37f8b890"></a><!-- doxytag: member="sec_gss.c::gss_check_seq_num" ref="a3b6985ae2b205d1d9c2ba35c37f8b890" args="(struct gss_svc_seq_data *ssd, __u32 seq_num, int set)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_check_seq_num </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__svc__seq__data.html">gss_svc_seq_data</a> *&nbsp;</td>
          <td class="paramname"> <em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>seq_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>set</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00536">536</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l00470">gss_do_check_seq()</a>, <a class="el" href="gss__internal_8h_source.html#l00207">GSS_SEQ_WIN_BACK</a>, <a class="el" href="gss__internal_8h_source.html#l00206">GSS_SEQ_WIN_MAIN</a>, <a class="el" href="lproc__gss_8c_source.html#l00087">gss_stat_oos_record_svc()</a>, <a class="el" href="gss__internal_8h_source.html#l00212">gss_svc_seq_data::ssd_lock</a>, <a class="el" href="gss__internal_8h_source.html#l00217">gss_svc_seq_data::ssd_max_back</a>, <a class="el" href="gss__internal_8h_source.html#l00216">gss_svc_seq_data::ssd_max_main</a>, <a class="el" href="gss__internal_8h_source.html#l00224">gss_svc_seq_data::ssd_win_back</a>, <a class="el" href="gss__internal_8h_source.html#l00223">gss_svc_seq_data::ssd_win_main</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02195">gss_svc_unseal_request()</a>, and <a class="el" href="sec__gss_8c_source.html#l02114">gss_svc_verify_request()</a>.</p>

</div>
</div>
<a class="anchor" id="a2ba4a470c6671cef915509495c0545dc"></a><!-- doxytag: member="sec_gss.c::gss_cli_bulk_payload" ref="a2ba4a470c6671cef915509495c0545dc" args="(struct ptlrpc_cli_ctx *ctx, struct sptlrpc_flavor *flvr, int reply, int read)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_cli_bulk_payload </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *&nbsp;</td>
          <td class="paramname"> <em>flvr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>reply</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>read</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00588">588</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l00582">gss_cli_payload()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00120">SPTLRPC_BULK_DEFAULT</a>, <a class="el" href="lustre__sec_8h_source.html#l00127">SPTLRPC_BULK_SVC_AUTH</a>, <a class="el" href="lustre__sec_8h_source.html#l00128">SPTLRPC_BULK_SVC_INTG</a>, <a class="el" href="lustre__sec_8h_source.html#l00126">SPTLRPC_BULK_SVC_NULL</a>, <a class="el" href="lustre__sec_8h_source.html#l00129">SPTLRPC_BULK_SVC_PRIV</a>, <a class="el" href="lustre__sec_8h_source.html#l00160">SPTLRPC_FLVR_BULK_SVC</a>, and <a class="el" href="lustre__sec_8h_source.html#l00158">SPTLRPC_FLVR_BULK_TYPE</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01488">gss_alloc_repbuf_intg()</a>, <a class="el" href="sec__gss_8c_source.html#l01541">gss_alloc_repbuf_priv()</a>, <a class="el" href="sec__gss_8c_source.html#l01253">gss_alloc_reqbuf_intg()</a>, and <a class="el" href="sec__gss_8c_source.html#l01335">gss_alloc_reqbuf_priv()</a>.</p>

</div>
</div>
<a class="anchor" id="a4636d84325f210983b756c2e237d2b0e"></a><!-- doxytag: member="sec_gss.c::gss_cli_ctx_finalize" ref="a4636d84325f210983b756c2e237d2b0e" args="(struct gss_cli_ctx *gctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void gss_cli_ctx_finalize </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__cli__ctx.html">gss_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00410">410</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00537">ptlrpc_cli_ctx::cc_sec</a>, <a class="el" href="gss__internal_8h_source.html#l00266">gss_cli_ctx::gc_base</a>, <a class="el" href="gss__internal_8h_source.html#l00271">gss_cli_ctx::gc_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00272">gss_cli_ctx::gc_mechctx</a>, <a class="el" href="gss__internal_8h_source.html#l00274">gss_cli_ctx::gc_svc_handle</a>, <a class="el" href="gss__svc__upcall_8c_source.html#l00864">gss_svc_upcall_expire_rvs_ctx()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__mech__switch_8c_source.html#l00324">lgss_delete_sec_context()</a>, <a class="el" href="gss__rawobj_8c_source.html#l00052">rawobj_empty()</a>, <a class="el" href="gss__rawobj_8c_source.html#l00076">rawobj_free()</a>, and <a class="el" href="lustre__sec_8h_source.html#l00868">sec_is_reverse()</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01209">gss_cli_ctx_fini_common()</a>.</p>

</div>
</div>
<a class="anchor" id="a47d7dfde849fe699ed11fd7debf3311a"></a><!-- doxytag: member="sec_gss.c::gss_cli_ctx_fini_common" ref="a47d7dfde849fe699ed11fd7debf3311a" args="(struct ptlrpc_sec *sec, struct ptlrpc_cli_ctx *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_cli_ctx_fini_common </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01209">1209</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00541">ptlrpc_cli_ctx::cc_flags</a>, <a class="el" href="lustre__sec_8h_source.html#l00536">ptlrpc_cli_ctx::cc_refcount</a>, <a class="el" href="lustre__sec_8h_source.html#l00537">ptlrpc_cli_ctx::cc_sec</a>, <a class="el" href="lustre__sec_8h_source.html#l00542">ptlrpc_cli_ctx::cc_vcred</a>, <a class="el" href="gss__internal_8h_source.html#l00322">ctx2gctx()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="gss__internal_8h_source.html#l00272">gss_cli_ctx::gc_mechctx</a>, <a class="el" href="sec__gss_8c_source.html#l00410">gss_cli_ctx_finalize()</a>, <a class="el" href="gss__cli__upcall_8c_source.html#l00376">gss_do_ctx_fini_rpc()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__sec_8h_source.html#l00849">ptlrpc_sec::ps_nctx</a>, <a class="el" href="lustre__sec_8h_source.html#l00846">ptlrpc_sec::ps_policy</a>, <a class="el" href="lustre__sec_8h_source.html#l00523">PTLRPC_CTX_UPTODATE</a>, <a class="el" href="sec_8c_source.html#l02511">sec2target_str()</a>, <a class="el" href="lustre__sec_8h_source.html#l00868">sec_is_reverse()</a>, <a class="el" href="lustre__sec_8h_source.html#l00826">ptlrpc_sec_policy::sp_name</a>, and <a class="el" href="lustre__sec_8h_source.html#l00392">vfs_cred::vc_uid</a>.</p>

<p>Referenced by <a class="el" href="gss__keyring_8c_source.html#l00232">ctx_destroy_kr()</a>, and <a class="el" href="gss__pipefs_8c_source.html#l00113">ctx_destroy_pf()</a>.</p>

</div>
</div>
<a class="anchor" id="a86a6d130026d1087c2ba06d898f9a41e"></a><!-- doxytag: member="sec_gss.c::gss_cli_ctx_flags2str" ref="a86a6d130026d1087c2ba06d898f9a41e" args="(unsigned long flags, char *buf, int bufsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gss_cli_ctx_flags2str </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>bufsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00620">620</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00526">PTLRPC_CTX_CACHED</a>, <a class="el" href="lustre__sec_8h_source.html#l00524">PTLRPC_CTX_DEAD</a>, <a class="el" href="lustre__sec_8h_source.html#l00525">PTLRPC_CTX_ERROR</a>, <a class="el" href="lustre__sec_8h_source.html#l00527">PTLRPC_CTX_ETERNAL</a>, <a class="el" href="lustre__sec_8h_source.html#l00522">PTLRPC_CTX_NEW</a>, <a class="el" href="lustre__sec_8h_source.html#l00523">PTLRPC_CTX_UPTODATE</a>, and <a class="el" href="string_8c_source.html#l00072">strlcat()</a>.</p>

<p>Referenced by <a class="el" href="gss__keyring_8c_source.html#l01045">gss_sec_display_kr()</a>.</p>

</div>
</div>
<a class="anchor" id="adf584bc8d7003dc2b7076c29741eddc0"></a><!-- doxytag: member="sec_gss.c::gss_cli_ctx_handle_err_notify" ref="adf584bc8d7003dc2b7076c29741eddc0" args="(struct ptlrpc_cli_ctx *ctx, struct ptlrpc_request *req, struct gss_header *ghdr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_cli_ctx_handle_err_notify </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__header.html">gss_header</a> *&nbsp;</td>
          <td class="paramname"> <em>ghdr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00693">693</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00537">ptlrpc_cli_ctx::cc_sec</a>, <a class="el" href="lustre__sec_8h_source.html#l00542">ptlrpc_cli_ctx::cc_vcred</a>, <a class="el" href="gss__internal_8h_source.html#l00322">ctx2gctx()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="gss__internal_8h_source.html#l00173">gss_err_header::gh_major</a>, <a class="el" href="gss__internal_8h_source.html#l00174">gss_err_header::gh_minor</a>, <a class="el" href="gss__internal_8h_source.html#l00144">gss_header::gh_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00198">gss_handle_to_u64()</a>, <a class="el" href="gss__err_8h_source.html#l00145">GSS_S_BAD_SIG</a>, <a class="el" href="gss__err_8h_source.html#l00149">GSS_S_NO_CONTEXT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="gss__internal_8h_source.html#l00105">PTLRPC_GSS_PROC_ERR</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_fini</a>, <a class="el" href="lustre__net_8h_source.html#l00968">ptlrpc_request::rq_resend</a>, <a class="el" href="lustre__net_8h_source.html#l01034">ptlrpc_request::rq_transno</a>, <a class="el" href="lustre__net_8h_source.html#l01036">ptlrpc_request::rq_xid</a>, <a class="el" href="sec_8c_source.html#l02511">sec2target_str()</a>, <a class="el" href="lustre__sec_8h_source.html#l00868">sec_is_reverse()</a>, <a class="el" href="sec_8c_source.html#l00322">sptlrpc_cli_ctx_expire()</a>, <a class="el" href="sec_8c_source.html#l00549">sptlrpc_req_replace_dead_ctx()</a>, and <a class="el" href="lustre__sec_8h_source.html#l00392">vfs_cred::vc_uid</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l00980">gss_cli_ctx_unseal()</a>, and <a class="el" href="sec__gss_8c_source.html#l00757">gss_cli_ctx_verify()</a>.</p>

</div>
</div>
<a class="anchor" id="a90054c1f8c6dff8cf2eccd382c4f8f79"></a><!-- doxytag: member="sec_gss.c::gss_cli_ctx_init_common" ref="a90054c1f8c6dff8cf2eccd382c4f8f79" args="(struct ptlrpc_sec *sec, struct ptlrpc_cli_ctx *ctx, struct ptlrpc_ctx_ops *ctxops, struct vfs_cred *vcred)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_cli_ctx_init_common </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__ctx__ops.html">ptlrpc_ctx_ops</a> *&nbsp;</td>
          <td class="paramname"> <em>ctxops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structvfs__cred.html">vfs_cred</a> *&nbsp;</td>
          <td class="paramname"> <em>vcred</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01172">1172</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00535">ptlrpc_cli_ctx::cc_cache</a>, <a class="el" href="lustre__sec_8h_source.html#l00539">ptlrpc_cli_ctx::cc_expire</a>, <a class="el" href="lustre__sec_8h_source.html#l00541">ptlrpc_cli_ctx::cc_flags</a>, <a class="el" href="lustre__sec_8h_source.html#l00545">ptlrpc_cli_ctx::cc_gc_chain</a>, <a class="el" href="lustre__sec_8h_source.html#l00543">ptlrpc_cli_ctx::cc_lock</a>, <a class="el" href="lustre__sec_8h_source.html#l00538">ptlrpc_cli_ctx::cc_ops</a>, <a class="el" href="lustre__sec_8h_source.html#l00536">ptlrpc_cli_ctx::cc_refcount</a>, <a class="el" href="lustre__sec_8h_source.html#l00544">ptlrpc_cli_ctx::cc_req_list</a>, <a class="el" href="lustre__sec_8h_source.html#l00537">ptlrpc_cli_ctx::cc_sec</a>, <a class="el" href="lustre__sec_8h_source.html#l00542">ptlrpc_cli_ctx::cc_vcred</a>, <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="gss__internal_8h_source.html#l00322">ctx2gctx()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="gss__internal_8h_source.html#l00270">gss_cli_ctx::gc_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00269">gss_cli_ctx::gc_win</a>, <a class="el" href="list_8h_source.html#l00316">INIT_HLIST_NODE</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="lustre__sec_8h_source.html#l00849">ptlrpc_sec::ps_nctx</a>, <a class="el" href="lustre__sec_8h_source.html#l00846">ptlrpc_sec::ps_policy</a>, <a class="el" href="lustre__sec_8h_source.html#l00847">ptlrpc_sec::ps_refcount</a>, <a class="el" href="lustre__sec_8h_source.html#l00522">PTLRPC_CTX_NEW</a>, <a class="el" href="sec_8c_source.html#l02511">sec2target_str()</a>, <a class="el" href="lustre__sec_8h_source.html#l00826">ptlrpc_sec_policy::sp_name</a>, and <a class="el" href="lustre__sec_8h_source.html#l00392">vfs_cred::vc_uid</a>.</p>

<p>Referenced by <a class="el" href="gss__keyring_8c_source.html#l00200">ctx_create_kr()</a>, and <a class="el" href="gss__pipefs_8c_source.html#l00092">ctx_create_pf()</a>.</p>

</div>
</div>
<a class="anchor" id="a7d4c3436a0993e70fd4d85a4720ce3fe"></a><!-- doxytag: member="sec_gss.c::gss_cli_ctx_match" ref="a7d4c3436a0993e70fd4d85a4720ce3fe" args="(struct ptlrpc_cli_ctx *ctx, struct vfs_cred *vcred)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_cli_ctx_match </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structvfs__cred.html">vfs_cred</a> *&nbsp;</td>
          <td class="paramname"> <em>vcred</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00615">615</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00542">ptlrpc_cli_ctx::cc_vcred</a>, and <a class="el" href="lustre__sec_8h_source.html#l00392">vfs_cred::vc_uid</a>.</p>

</div>
</div>
<a class="anchor" id="a66350a143a4db3b0a7a9c38204f4ea21"></a><!-- doxytag: member="sec_gss.c::gss_cli_ctx_seal" ref="a66350a143a4db3b0a7a9c38204f4ea21" args="(struct ptlrpc_cli_ctx *ctx, struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_cli_ctx_seal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00881">881</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00537">ptlrpc_cli_ctx::cc_sec</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__internal_8h_source.html#l00021">netobj_s::data</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="gss__internal_8h_source.html#l00266">gss_cli_ctx::gc_base</a>, <a class="el" href="gss__internal_8h_source.html#l00271">gss_cli_ctx::gc_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00272">gss_cli_ctx::gc_mechctx</a>, <a class="el" href="gss__internal_8h_source.html#l00268">gss_cli_ctx::gc_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00270">gss_cli_ctx::gc_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00143">gss_header::gh_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00150">gss_header::gh_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00144">gss_header::gh_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00145">gss_header::gh_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00141">gss_header::gh_sp</a>, <a class="el" href="gss__internal_8h_source.html#l00146">gss_header::gh_svc</a>, <a class="el" href="gss__internal_8h_source.html#l00140">gss_header::gh_version</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="sec__gss_8c_source.html#l00582">gss_cli_payload()</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__internal_8h_source.html#l00208">GSS_SEQ_REPACK_THRESHOLD</a>, <a class="el" href="lproc__gss_8c_source.html#l00077">gss_stat_oos_record_cli()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="gss__internal_8h_source.html#l00020">netobj_s::len</a>, <a class="el" href="gss__mech__switch_8c_source.html#l00250">lgss_wrap()</a>, <a class="el" href="gss__internal_8h_source.html#l00115">LUSTRE_GSS_PACK_BULK</a>, <a class="el" href="gss__internal_8h_source.html#l00116">LUSTRE_GSS_PACK_USER</a>, <a class="el" href="pack__generic_8c_source.html#l00192">lustre_init_msg_v2()</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00688">lustre_msg_buflen()</a>, <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>, <a class="el" href="pack__generic_8c_source.html#l00496">lustre_shrink_msg()</a>, <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="lustre__sec_8h_source.html#l00853">ptlrpc_sec::ps_part</a>, <a class="el" href="gss__internal_8h_source.html#l00194">PTLRPC_GSS_HEADER_SIZE</a>, <a class="el" href="gss__internal_8h_source.html#l00097">PTLRPC_GSS_VERSION</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01083">ptlrpc_request::rq_clrbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01088">ptlrpc_request::rq_clrbuf_len</a>, <a class="el" href="lustre__net_8h_source.html#l01089">ptlrpc_request::rq_clrdata_len</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_udesc</a>, <a class="el" href="lustre__net_8h_source.html#l01028">ptlrpc_request::rq_pool</a>, <a class="el" href="lustre__net_8h_source.html#l01079">ptlrpc_request::rq_reqbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01084">ptlrpc_request::rq_reqbuf_len</a>, <a class="el" href="lustre__net_8h_source.html#l01085">ptlrpc_request::rq_reqdata_len</a>, <a class="el" href="lustre__net_8h_source.html#l01024">ptlrpc_request::rq_reqlen</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00115">SPTLRPC_SVC_PRIV</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="a44cabfb5eae388e35bd80f54163e2de2"></a><!-- doxytag: member="sec_gss.c::gss_cli_ctx_sign" ref="a44cabfb5eae388e35bd80f54163e2de2" args="(struct ptlrpc_cli_ctx *ctx, struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_cli_ctx_sign </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00640">640</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00537">ptlrpc_cli_ctx::cc_sec</a>, <a class="el" href="gss__internal_8h_source.html#l00322">ctx2gctx()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="gss__internal_8h_source.html#l00271">gss_cli_ctx::gc_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00272">gss_cli_ctx::gc_mechctx</a>, <a class="el" href="gss__internal_8h_source.html#l00268">gss_cli_ctx::gc_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00270">gss_cli_ctx::gc_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00208">GSS_SEQ_REPACK_THRESHOLD</a>, <a class="el" href="sec__gss_8c_source.html#l00177">gss_sign_msg()</a>, <a class="el" href="lproc__gss_8c_source.html#l00077">gss_stat_oos_record_cli()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00115">LUSTRE_GSS_PACK_BULK</a>, <a class="el" href="gss__internal_8h_source.html#l00116">LUSTRE_GSS_PACK_USER</a>, <a class="el" href="lustre__sec_8h_source.html#l00853">ptlrpc_sec::ps_part</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_init</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_udesc</a>, <a class="el" href="lustre__net_8h_source.html#l01079">ptlrpc_request::rq_reqbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01085">ptlrpc_request::rq_reqdata_len</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00156">SPTLRPC_FLVR_SVC</a>, and <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>.</p>

</div>
</div>
<a class="anchor" id="a138fabb1ff47eb6f9ee4f8d89ef0a31f"></a><!-- doxytag: member="sec_gss.c::gss_cli_ctx_unseal" ref="a138fabb1ff47eb6f9ee4f8d89ef0a31f" args="(struct ptlrpc_cli_ctx *ctx, struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_cli_ctx_unseal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00980">980</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="pack__generic_8c_source.html#l00574">__lustre_unpack_msg()</a>, <a class="el" href="sec__bulk_8c_source.html#l00879">bulk_sec_desc_unpack()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="osd__iam_8h_source.html#l00059">equi</a>, <a class="el" href="gss__internal_8h_source.html#l00272">gss_cli_ctx::gc_mechctx</a>, <a class="el" href="gss__internal_8h_source.html#l00143">gss_header::gh_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00144">gss_header::gh_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00140">gss_header::gh_version</a>, <a class="el" href="sec__gss_8c_source.html#l00693">gss_cli_ctx_handle_err_notify()</a>, <a class="el" href="sec__gss_8c_source.html#l00097">gss_header_swabber()</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="sec__gss_8c_source.html#l00107">gss_swab_header()</a>, <a class="el" href="sec__gss_8c_source.html#l00275">gss_unseal_msg()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00115">LUSTRE_GSS_PACK_BULK</a>, <a class="el" href="lustre__idl_8h_source.html#l01047">lustre_msg</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="gss__internal_8h_source.html#l00101">PTLRPC_GSS_PROC_DATA</a>, <a class="el" href="gss__internal_8h_source.html#l00105">PTLRPC_GSS_PROC_ERR</a>, <a class="el" href="gss__internal_8h_source.html#l00097">PTLRPC_GSS_VERSION</a>, <a class="el" href="lustre__net_8h_source.html#l01198">ptlrpc_rep_need_swab()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_init</a>, <a class="el" href="lustre__net_8h_source.html#l00968">ptlrpc_request::rq_early</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__net_8h_source.html#l01081">ptlrpc_request::rq_repdata</a>, <a class="el" href="lustre__net_8h_source.html#l01087">ptlrpc_request::rq_repdata_len</a>, <a class="el" href="lustre__net_8h_source.html#l01026">ptlrpc_request::rq_replen</a>, and <a class="el" href="lustre__net_8h_source.html#l01032">ptlrpc_request::rq_repmsg</a>.</p>

</div>
</div>
<a class="anchor" id="a76fcb27561cf70c27aa394d4758ccaec"></a><!-- doxytag: member="sec_gss.c::gss_cli_ctx_uptodate" ref="a76fcb27561cf70c27aa394d4758ccaec" args="(struct gss_cli_ctx *gctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gss_cli_ctx_uptodate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__cli__ctx.html">gss_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00369">369</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00539">ptlrpc_cli_ctx::cc_expire</a>, <a class="el" href="lustre__sec_8h_source.html#l00541">ptlrpc_cli_ctx::cc_flags</a>, <a class="el" href="lustre__sec_8h_source.html#l00537">ptlrpc_cli_ctx::cc_sec</a>, <a class="el" href="lustre__sec_8h_source.html#l00542">ptlrpc_cli_ctx::cc_vcred</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="linux-time_8h_source.html#l00157">cfs_time_current_sec()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="gss__internal_8h_source.html#l00266">gss_cli_ctx::gc_base</a>, <a class="el" href="gss__internal_8h_source.html#l00271">gss_cli_ctx::gc_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00272">gss_cli_ctx::gc_mechctx</a>, <a class="el" href="gss__internal_8h_source.html#l00198">gss_handle_to_u64()</a>, <a class="el" href="gss__internal_8h_source.html#l00075">gss_round_ctx_expiry()</a>, <a class="el" href="sec__gss_8c_source.html#l01859">gss_sec_install_rctx()</a>, <a class="el" href="gss__mech__switch_8c_source.html#l00193">lgss_inquire_context()</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="lustre__sec_8h_source.html#l00852">ptlrpc_sec::ps_flvr</a>, <a class="el" href="lustre__sec_8h_source.html#l00857">ptlrpc_sec::ps_import</a>, <a class="el" href="lustre__sec_8h_source.html#l00516">PTLRPC_CTX_UPTODATE_BIT</a>, <a class="el" href="sec_8c_source.html#l02511">sec2target_str()</a>, <a class="el" href="lustre__sec_8h_source.html#l00868">sec_is_reverse()</a>, <a class="el" href="lustre__sec_8h_source.html#l00296">sptlrpc_flavor::sf_flags</a>, <a class="el" href="sec_8c_source.html#l00333">sptlrpc_cli_ctx_wakeup()</a>, and <a class="el" href="lustre__sec_8h_source.html#l00392">vfs_cred::vc_uid</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02801">gss_copy_rvc_cli_ctx()</a>, <a class="el" href="gss__keyring_8c_source.html#l01333">gss_kt_update()</a>, and <a class="el" href="gss__pipefs_8c_source.html#l00829">gss_pipe_downcall()</a>.</p>

</div>
</div>
<a class="anchor" id="a06963f5c7a48bd076af975b525838a8f"></a><!-- doxytag: member="sec_gss.c::gss_cli_ctx_verify" ref="a06963f5c7a48bd076af975b525838a8f" args="(struct ptlrpc_cli_ctx *ctx, struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_cli_ctx_verify </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00757">757</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__bulk_8c_source.html#l00879">bulk_sec_desc_unpack()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="o2iblnd__modparams_8c_source.html#l00047">cksum</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="osd__iam_8h_source.html#l00059">equi</a>, <a class="el" href="gss__internal_8h_source.html#l00272">gss_cli_ctx::gc_mechctx</a>, <a class="el" href="gss__internal_8h_source.html#l00143">gss_header::gh_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00144">gss_header::gh_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00145">gss_header::gh_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00146">gss_header::gh_svc</a>, <a class="el" href="gss__internal_8h_source.html#l00140">gss_header::gh_version</a>, <a class="el" href="sec__gss_8c_source.html#l00693">gss_cli_ctx_handle_err_notify()</a>, <a class="el" href="sec__gss_8c_source.html#l00097">gss_header_swabber()</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="sec__gss_8c_source.html#l00107">gss_swab_header()</a>, <a class="el" href="sec__gss_8c_source.html#l00239">gss_verify_msg()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00115">LUSTRE_GSS_PACK_BULK</a>, <a class="el" href="lustre__idl_8h_source.html#l01047">lustre_msg</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00688">lustre_msg_buflen()</a>, <a class="el" href="gss__internal_8h_source.html#l00101">PTLRPC_GSS_PROC_DATA</a>, <a class="el" href="gss__internal_8h_source.html#l00105">PTLRPC_GSS_PROC_ERR</a>, <a class="el" href="lustre__net_8h_source.html#l01198">ptlrpc_rep_need_swab()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_init</a>, <a class="el" href="lustre__net_8h_source.html#l00968">ptlrpc_request::rq_early</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__net_8h_source.html#l01081">ptlrpc_request::rq_repdata</a>, <a class="el" href="lustre__net_8h_source.html#l01026">ptlrpc_request::rq_replen</a>, <a class="el" href="lustre__net_8h_source.html#l01032">ptlrpc_request::rq_repmsg</a>, and <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>.</p>

</div>
</div>
<a class="anchor" id="a83ddca039c3392a305f9c35fe478ba7d"></a><!-- doxytag: member="sec_gss.c::gss_cli_payload" ref="a83ddca039c3392a305f9c35fe478ba7d" args="(struct ptlrpc_cli_ctx *ctx, int msgsize, int privacy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_cli_payload </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>privacy</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00582">582</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l00166">gss_mech_payload()</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01488">gss_alloc_repbuf_intg()</a>, <a class="el" href="sec__gss_8c_source.html#l01541">gss_alloc_repbuf_priv()</a>, <a class="el" href="sec__gss_8c_source.html#l01253">gss_alloc_reqbuf_intg()</a>, <a class="el" href="sec__gss_8c_source.html#l01335">gss_alloc_reqbuf_priv()</a>, <a class="el" href="sec__gss_8c_source.html#l00588">gss_cli_bulk_payload()</a>, <a class="el" href="sec__gss_8c_source.html#l00881">gss_cli_ctx_seal()</a>, <a class="el" href="sec__gss_8c_source.html#l01642">gss_enlarge_reqbuf_intg()</a>, <a class="el" href="sec__gss_8c_source.html#l01733">gss_enlarge_reqbuf_priv()</a>, and <a class="el" href="sec__gss_8c_source.html#l02854">gss_init_at_reply_offset()</a>.</p>

</div>
</div>
<a class="anchor" id="ae1051f52e0434e77478f3c75778e38ae"></a><!-- doxytag: member="sec_gss.c::gss_copy_rvc_cli_ctx" ref="ae1051f52e0434e77478f3c75778e38ae" args="(struct ptlrpc_cli_ctx *cli_ctx, struct ptlrpc_svc_ctx *svc_ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_copy_rvc_cli_ctx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>cli_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__svc__ctx.html">ptlrpc_svc_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>svc_ctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02801">2801</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00322">ctx2gctx()</a>, <a class="el" href="gss__internal_8h_source.html#l00271">gss_cli_ctx::gc_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00272">gss_cli_ctx::gc_mechctx</a>, <a class="el" href="gss__internal_8h_source.html#l00268">gss_cli_ctx::gc_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00270">gss_cli_ctx::gc_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00274">gss_cli_ctx::gc_svc_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00269">gss_cli_ctx::gc_win</a>, <a class="el" href="gss__internal_8h_source.html#l00228">gss_svc_ctx::gsc_mechctx</a>, <a class="el" href="gss__internal_8h_source.html#l00230">gss_svc_ctx::gsc_rvs_hdl</a>, <a class="el" href="gss__internal_8h_source.html#l00231">gss_svc_ctx::gsc_rvs_seq</a>, <a class="el" href="sec__gss_8c_source.html#l00369">gss_cli_ctx_uptodate()</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__internal_8h_source.html#l00205">GSS_SEQ_WIN</a>, <a class="el" href="gss__internal_8h_source.html#l00367">gss_svc_ctx2gssctx()</a>, <a class="el" href="gss__svc__upcall_8c_source.html#l00880">gss_svc_upcall_dup_handle()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__mech__switch_8c_source.html#l00163">lgss_copy_reverse_context()</a>, <a class="el" href="gss__mech__switch_8c_source.html#l00324">lgss_delete_sec_context()</a>, <a class="el" href="gss__internal_8h_source.html#l00101">PTLRPC_GSS_PROC_DATA</a>, <a class="el" href="gss__rawobj_8c_source.html#l00097">rawobj_dup()</a>, and <a class="el" href="gss__rawobj_8c_source.html#l00076">rawobj_free()</a>.</p>

<p>Referenced by <a class="el" href="gss__pipefs_8c_source.html#l00294">gss_install_rvs_cli_ctx_pf()</a>, and <a class="el" href="gss__keyring_8c_source.html#l01144">sec_install_rctx_kr()</a>.</p>

</div>
</div>
<a class="anchor" id="a17b3923b70bb138a03b0da7cdb95370b"></a><!-- doxytag: member="sec_gss.c::gss_do_check_seq" ref="a17b3923b70bb138a03b0da7cdb95370b" args="(unsigned long *window, __u32 win_size, __u32 *max_seq, __u32 seq_num, int phase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_do_check_seq </td>
          <td>(</td>
          <td class="paramtype">unsigned long *&nbsp;</td>
          <td class="paramname"> <em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>win_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32 *&nbsp;</td>
          <td class="paramname"> <em>max_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>seq_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>phase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Based on sequence number algorithm as specified in RFC 2203. </p>
<p>Modified for our own problem: arriving request has valid sequence number, but unwrapping request might cost a long time, after that its sequence are not valid anymore (fall behind the window). It rarely happen, mostly under extreme load.</p>
<p>Note we should not check sequence before verifying the integrity of incoming request, because just one attacking request with high sequence number might cause all following requests be dropped.</p>
<p>So here we use a multi-phase approach: prepare 2 sequence windows, "main window" for normal sequence and "back window" for fall behind sequence. and 3-phase checking mechanism: 0 - before integrity verification, perform an initial sequence checking in main window, which only tries and doesn't actually set any bits. if the sequence is high above the window or fits in the window and the bit is 0, then accept and proceed to integrity verification. otherwise reject this sequence. 1 - after integrity verification, check in main window again. if this sequence is high above the window or fits in the window and the bit is 0, then set the bit and accept; if it fits in the window but bit already set, then reject; if it falls behind the window, then proceed to phase 2. 2 - check in back window. if it is high above the window or fits in the window and the bit is 0, then set the bit and accept. otherwise reject.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>1: looks like a replay </dd>
<dd>
0: is ok </dd>
<dd>
-1: is a replay</dd></dl>
<p>Note phase 0 is necessary, because otherwise replay attacking request of sequence which between the 2 windows can't be detected.</p>
<p>This mechanism can't totally solve the problem, but could help reduce the number of valid requests be dropped. </p>

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00470">470</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, and <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l00536">gss_check_seq_num()</a>.</p>

</div>
</div>
<a class="anchor" id="af2276f33c9fca9b062941bd2921a798c"></a><!-- doxytag: member="sec_gss.c::gss_enlarge_reqbuf" ref="af2276f33c9fca9b062941bd2921a798c" args="(struct ptlrpc_sec *sec, struct ptlrpc_request *req, int segment, int newsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_enlarge_reqbuf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>newsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01838">1838</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l01642">gss_enlarge_reqbuf_intg()</a>, <a class="el" href="sec__gss_8c_source.html#l01733">gss_enlarge_reqbuf_priv()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00045">LASSERTF</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_fini</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_init</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00156">SPTLRPC_FLVR_SVC</a>, <a class="el" href="lustre__sec_8h_source.html#l00113">SPTLRPC_SVC_AUTH</a>, <a class="el" href="lustre__sec_8h_source.html#l00114">SPTLRPC_SVC_INTG</a>, <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>, and <a class="el" href="lustre__sec_8h_source.html#l00115">SPTLRPC_SVC_PRIV</a>.</p>

</div>
</div>
<a class="anchor" id="a5fde8f2a30b166447e874833f2327e6a"></a><!-- doxytag: member="sec_gss.c::gss_enlarge_reqbuf_intg" ref="a5fde8f2a30b166447e874833f2327e6a" args="(struct ptlrpc_sec *sec, struct ptlrpc_request *req, int svc, int segment, int newsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_enlarge_reqbuf_intg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>svc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>newsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01642">1642</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec_8c_source.html#l01631">_sptlrpc_enlarge_msg_inplace()</a>, <a class="el" href="sec__gss_8c_source.html#l01606">get_enlarged_msgsize()</a>, <a class="el" href="sec__gss_8c_source.html#l01621">get_enlarged_msgsize2()</a>, <a class="el" href="sec__gss_8c_source.html#l00582">gss_cli_payload()</a>, <a class="el" href="lustre__import_8h_source.html#l00274">obd_import::imp_lock</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__idl_8h_source.html#l01047">lustre_msg</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="sec__gss_8c_source.html#l00082">msg_last_segidx()</a>, <a class="el" href="sec__gss_8c_source.html#l00087">msg_last_seglen()</a>, <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01104">ptlrpc_request::rq_import</a>, <a class="el" href="lustre__net_8h_source.html#l01028">ptlrpc_request::rq_pool</a>, <a class="el" href="lustre__net_8h_source.html#l01079">ptlrpc_request::rq_reqbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01084">ptlrpc_request::rq_reqbuf_len</a>, <a class="el" href="lustre__net_8h_source.html#l01024">ptlrpc_request::rq_reqlen</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="lustre__sec_8h_source.html#l00941">size_roundup_power2()</a>, <a class="el" href="lustre__sec_8h_source.html#l00114">SPTLRPC_SVC_INTG</a>, and <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01838">gss_enlarge_reqbuf()</a>.</p>

</div>
</div>
<a class="anchor" id="ac7566792305e21ef50010962f3e66318"></a><!-- doxytag: member="sec_gss.c::gss_enlarge_reqbuf_priv" ref="ac7566792305e21ef50010962f3e66318" args="(struct ptlrpc_sec *sec, struct ptlrpc_request *req, int segment, int newsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_enlarge_reqbuf_priv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>newsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01733">1733</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec_8c_source.html#l01631">_sptlrpc_enlarge_msg_inplace()</a>, <a class="el" href="sec__gss_8c_source.html#l01606">get_enlarged_msgsize()</a>, <a class="el" href="sec__gss_8c_source.html#l00582">gss_cli_payload()</a>, <a class="el" href="gss__internal_8h_source.html#l00090">GSS_MAX_CIPHER_BLOCK</a>, <a class="el" href="lustre__import_8h_source.html#l00274">obd_import::imp_lock</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__idl_8h_source.html#l01047">lustre_msg</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>, <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="gss__internal_8h_source.html#l00194">PTLRPC_GSS_HEADER_SIZE</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01083">ptlrpc_request::rq_clrbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01088">ptlrpc_request::rq_clrbuf_len</a>, <a class="el" href="lustre__net_8h_source.html#l01104">ptlrpc_request::rq_import</a>, <a class="el" href="lustre__net_8h_source.html#l01028">ptlrpc_request::rq_pool</a>, <a class="el" href="lustre__net_8h_source.html#l01079">ptlrpc_request::rq_reqbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01084">ptlrpc_request::rq_reqbuf_len</a>, <a class="el" href="lustre__net_8h_source.html#l01024">ptlrpc_request::rq_reqlen</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="lustre__sec_8h_source.html#l00941">size_roundup_power2()</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01838">gss_enlarge_reqbuf()</a>.</p>

</div>
</div>
<a class="anchor" id="a865d6db82f15ac488e72d6f25f29b585"></a><!-- doxytag: member="sec_gss.c::gss_free_repbuf" ref="a865d6db82f15ac488e72d6f25f29b585" args="(struct ptlrpc_sec *sec, struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gss_free_repbuf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01596">1596</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="lustre__net_8h_source.html#l01080">ptlrpc_request::rq_repbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01086">ptlrpc_request::rq_repbuf_len</a>, <a class="el" href="lustre__net_8h_source.html#l01081">ptlrpc_request::rq_repdata</a>, and <a class="el" href="lustre__net_8h_source.html#l01087">ptlrpc_request::rq_repdata_len</a>.</p>

</div>
</div>
<a class="anchor" id="ae0d2dc87ab5dced59080c99e48412579"></a><!-- doxytag: member="sec_gss.c::gss_free_reqbuf" ref="ae0d2dc87ab5dced59080c99e48412579" args="(struct ptlrpc_sec *sec, struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gss_free_reqbuf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01438">1438</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="lustre__net_8h_source.html#l01083">ptlrpc_request::rq_clrbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01088">ptlrpc_request::rq_clrbuf_len</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__net_8h_source.html#l01028">ptlrpc_request::rq_pool</a>, <a class="el" href="lustre__net_8h_source.html#l01079">ptlrpc_request::rq_reqbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01084">ptlrpc_request::rq_reqbuf_len</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00156">SPTLRPC_FLVR_SVC</a>, and <a class="el" href="lustre__sec_8h_source.html#l00115">SPTLRPC_SVC_PRIV</a>.</p>

</div>
</div>
<a class="anchor" id="a2ec62d812f84d0495c4e39cc16aa556e"></a><!-- doxytag: member="sec_gss.c::gss_header_swabber" ref="a2ec62d812f84d0495c4e39cc16aa556e" args="(struct gss_header *ghdr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void gss_header_swabber </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__header.html">gss_header</a> *&nbsp;</td>
          <td class="paramname"> <em>ghdr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00097">97</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="byteorder_8h_source.html#l00045">__swab32s</a>, <a class="el" href="gss__internal_8h_source.html#l00143">gss_header::gh_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00150">gss_header::gh_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00147">gss_header::gh_pad1</a>, <a class="el" href="gss__internal_8h_source.html#l00144">gss_header::gh_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00145">gss_header::gh_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00146">gss_header::gh_svc</a>, and <a class="el" href="gss__internal_8h_source.html#l00020">netobj_s::len</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l00980">gss_cli_ctx_unseal()</a>, <a class="el" href="sec__gss_8c_source.html#l00757">gss_cli_ctx_verify()</a>, <a class="el" href="sec__gss_8c_source.html#l02366">gss_svc_accept()</a>, and <a class="el" href="sec__gss_8c_source.html#l00107">gss_swab_header()</a>.</p>

</div>
</div>
<a class="anchor" id="a1cc1e1cd160e38673dad61b0bfffe09e"></a><!-- doxytag: member="sec_gss.c::gss_init_at_reply_offset" ref="a1cc1e1cd160e38673dad61b0bfffe09e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void gss_init_at_reply_offset </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02854">2854</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l00078">gss_at_reply_off_integ</a>, <a class="el" href="sec__gss_8c_source.html#l00079">gss_at_reply_off_priv</a>, <a class="el" href="sec__gss_8c_source.html#l00582">gss_cli_payload()</a>, <a class="el" href="pack__generic_8c_source.html#l00121">lustre_msg_early_size()</a>, <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>, and <a class="el" href="gss__internal_8h_source.html#l00194">PTLRPC_GSS_HEADER_SIZE</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02872">sptlrpc_gss_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a3af5afe7de95a8d868a31f6eaf1bb071"></a><!-- doxytag: member="sec_gss.c::gss_install_rvs_svc_ctx" ref="a3af5afe7de95a8d868a31f6eaf1bb071" args="(struct obd_import *imp, struct gss_sec *gsec, struct gss_cli_ctx *gctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_install_rvs_svc_ctx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__import.html">obd_import</a> *&nbsp;</td>
          <td class="paramname"> <em>imp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__sec.html">gss_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>gsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__cli__ctx.html">gss_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01085">1085</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="gss__svc__upcall_8c_source.html#l00805">gss_svc_upcall_install_rvs_ctx()</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01859">gss_sec_install_rctx()</a>.</p>

</div>
</div>
<a class="anchor" id="a3f75204b22ea280ce282cd7c162bbf05"></a><!-- doxytag: member="sec_gss.c::gss_mech_payload" ref="a3f75204b22ea280ce282cd7c162bbf05" args="(struct gss_ctx *mechctx, int msgsize, int privacy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_mech_payload </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>mechctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>privacy</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00166">166</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l00163">GSS_KRB5_INTEG_MAX_PAYLOAD</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l00582">gss_cli_payload()</a>, <a class="el" href="sec__gss_8c_source.html#l02492">gss_svc_bulk_payload()</a>, <a class="el" href="sec__gss_8c_source.html#l02480">gss_svc_payload()</a>, and <a class="el" href="sec__gss_8c_source.html#l02637">gss_svc_seal()</a>.</p>

</div>
</div>
<a class="anchor" id="a044646f329619da58a10330c0c4896c5"></a><!-- doxytag: member="sec_gss.c::gss_pack_err_notify" ref="a044646f329619da58a10330c0c4896c5" args="(struct ptlrpc_request *req, __u32 major, __u32 minor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_pack_err_notify </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>major</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>minor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01955">1955</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="gss__internal_8h_source.html#l00171">gss_err_header::gh_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00178">gss_err_header::gh_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00173">gss_err_header::gh_major</a>, <a class="el" href="gss__internal_8h_source.html#l00174">gss_err_header::gh_minor</a>, <a class="el" href="gss__internal_8h_source.html#l00172">gss_err_header::gh_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00168">gss_err_header::gh_version</a>, <a class="el" href="gss__internal_8h_source.html#l00360">gss_svc_ctx2reqctx()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00020">netobj_s::len</a>, <a class="el" href="nidstr_8h_source.html#l00077">libcfs_nid2str()</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>, <a class="el" href="pack__generic_8c_source.html#l00329">lustre_pack_reply_v2()</a>, <a class="el" href="lnet_2include_2lnet_2types_8h_source.html#l00304">lnet_process_id_t::nid</a>, <a class="el" href="lustre__idl_8h_source.html#l01092">ptlrpc_body</a>, <a class="el" href="gss__internal_8h_source.html#l00105">PTLRPC_GSS_PROC_ERR</a>, <a class="el" href="gss__internal_8h_source.html#l00097">PTLRPC_GSS_VERSION</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01108">ptlrpc_request::rq_peer</a>, <a class="el" href="lustre__net_8h_source.html#l00695">ptlrpc_reply_state::rs_repbuf</a>, <a class="el" href="lustre__net_8h_source.html#l00699">ptlrpc_reply_state::rs_repdata_len</a>, <a class="el" href="gss__internal_8h_source.html#l00259">gss_svc_reqctx::src_err_notify</a>, and <a class="el" href="gss__internal_8h_source.html#l00262">gss_svc_reqctx::src_reserve_len</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02272">gss_svc_handle_data()</a>, and <a class="el" href="gss__svc__upcall_8c_source.html#l00908">gss_svc_upcall_handle_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a6a57c0a715a5216abb0884ef437674fc"></a><!-- doxytag: member="sec_gss.c::gss_sec_create_common" ref="a6a57c0a715a5216abb0884ef437674fc" args="(struct gss_sec *gsec, struct ptlrpc_sec_policy *policy, struct obd_import *imp, struct ptlrpc_svc_ctx *svcctx, struct sptlrpc_flavor *sf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_sec_create_common </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__sec.html">gss_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>gsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec__policy.html">ptlrpc_sec_policy</a> *&nbsp;</td>
          <td class="paramname"> <em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__import.html">obd_import</a> *&nbsp;</td>
          <td class="paramname"> <em>imp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__svc__ctx.html">ptlrpc_svc_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>svcctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *&nbsp;</td>
          <td class="paramname"> <em>sf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01095">1095</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="genops_8c_source.html#l01005">class_import_get()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="gss__internal_8h_source.html#l00284">gss_sec::gs_base</a>, <a class="el" href="gss__internal_8h_source.html#l00286">gss_sec::gs_lock</a>, <a class="el" href="gss__internal_8h_source.html#l00285">gss_sec::gs_mech</a>, <a class="el" href="gss__internal_8h_source.html#l00287">gss_sec::gs_rvs_hdl</a>, <a class="el" href="gss__internal_8h_source.html#l00072">GSS_GC_INTERVAL</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__mech__switch_8c_source.html#l00121">lgss_subflavor_to_mech()</a>, <a class="el" href="lustre__sec_8h_source.html#l00852">ptlrpc_sec::ps_flvr</a>, <a class="el" href="lustre__sec_8h_source.html#l00864">ptlrpc_sec::ps_gc_interval</a>, <a class="el" href="lustre__sec_8h_source.html#l00863">ptlrpc_sec::ps_gc_list</a>, <a class="el" href="lustre__sec_8h_source.html#l00851">ptlrpc_sec::ps_id</a>, <a class="el" href="lustre__sec_8h_source.html#l00857">ptlrpc_sec::ps_import</a>, <a class="el" href="lustre__sec_8h_source.html#l00858">ptlrpc_sec::ps_lock</a>, <a class="el" href="lustre__sec_8h_source.html#l00849">ptlrpc_sec::ps_nctx</a>, <a class="el" href="lustre__sec_8h_source.html#l00846">ptlrpc_sec::ps_policy</a>, <a class="el" href="lustre__sec_8h_source.html#l00847">ptlrpc_sec::ps_refcount</a>, <a class="el" href="lustre__sec_8h_source.html#l00868">sec_is_reverse()</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00826">ptlrpc_sec_policy::sp_name</a>, <a class="el" href="lustre__sec_8h_source.html#l00129">SPTLRPC_BULK_SVC_PRIV</a>, <a class="el" href="sec__bulk_8c_source.html#l00729">sptlrpc_enc_pool_add_user()</a>, <a class="el" href="lustre__sec_8h_source.html#l00165">SPTLRPC_FLVR_BASE_SUB</a>, <a class="el" href="lustre__sec_8h_source.html#l00160">SPTLRPC_FLVR_BULK_SVC</a>, <a class="el" href="lustre__sec_8h_source.html#l00152">SPTLRPC_FLVR_POLICY</a>, <a class="el" href="sec_8c_source.html#l01241">sptlrpc_get_next_secid()</a>, and <a class="el" href="lustre__sec_8h_source.html#l00090">SPTLRPC_POLICY_GSS</a>.</p>

<p>Referenced by <a class="el" href="gss__keyring_8c_source.html#l00611">gss_sec_create_kr()</a>, and <a class="el" href="gss__pipefs_8c_source.html#l00345">gss_sec_create_pf()</a>.</p>

</div>
</div>
<a class="anchor" id="a86eceac16ab00ecaca0759414e7aa972"></a><!-- doxytag: member="sec_gss.c::gss_sec_destroy_common" ref="a86eceac16ab00ecaca0759414e7aa972" args="(struct gss_sec *gsec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gss_sec_destroy_common </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__sec.html">gss_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>gsec</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01145">1145</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="genops_8c_source.html#l01015">class_import_put()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="gss__internal_8h_source.html#l00284">gss_sec::gs_base</a>, <a class="el" href="gss__internal_8h_source.html#l00285">gss_sec::gs_mech</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__mech__switch_8c_source.html#l00140">lgss_mech_put()</a>, <a class="el" href="lustre__sec_8h_source.html#l00852">ptlrpc_sec::ps_flvr</a>, <a class="el" href="lustre__sec_8h_source.html#l00857">ptlrpc_sec::ps_import</a>, <a class="el" href="lustre__sec_8h_source.html#l00849">ptlrpc_sec::ps_nctx</a>, <a class="el" href="lustre__sec_8h_source.html#l00847">ptlrpc_sec::ps_refcount</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00129">SPTLRPC_BULK_SVC_PRIV</a>, <a class="el" href="sec__bulk_8c_source.html#l00753">sptlrpc_enc_pool_del_user()</a>, and <a class="el" href="lustre__sec_8h_source.html#l00160">SPTLRPC_FLVR_BULK_SVC</a>.</p>

<p>Referenced by <a class="el" href="gss__keyring_8c_source.html#l00611">gss_sec_create_kr()</a>, <a class="el" href="gss__pipefs_8c_source.html#l00345">gss_sec_create_pf()</a>, <a class="el" href="gss__keyring_8c_source.html#l00647">gss_sec_destroy_kr()</a>, and <a class="el" href="gss__pipefs_8c_source.html#l00394">gss_sec_destroy_pf()</a>.</p>

</div>
</div>
<a class="anchor" id="aa5b20499d0da6a6ad5e2b67fafad10ee"></a><!-- doxytag: member="sec_gss.c::gss_sec_install_rctx" ref="aa5b20499d0da6a6ad5e2b67fafad10ee" args="(struct obd_import *imp, struct ptlrpc_sec *sec, struct ptlrpc_cli_ctx *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_sec_install_rctx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__import.html">obd_import</a> *&nbsp;</td>
          <td class="paramname"> <em>imp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__cli__ctx.html">ptlrpc_cli_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01859">1859</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="gss__internal_8h_source.html#l00266">gss_cli_ctx::gc_base</a>, and <a class="el" href="sec__gss_8c_source.html#l01085">gss_install_rvs_svc_ctx()</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l00369">gss_cli_ctx_uptodate()</a>.</p>

</div>
</div>
<a class="anchor" id="ac32200df78f9c91e30d9a815e4a6766c"></a><!-- doxytag: member="sec_gss.c::gss_sec_kill" ref="ac32200df78f9c91e30d9a815e4a6766c" args="(struct ptlrpc_sec *sec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gss_sec_kill </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec.html">ptlrpc_sec</a> *&nbsp;</td>
          <td class="paramname"> <em>sec</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01167">1167</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="lustre__sec_8h_source.html#l00855">ptlrpc_sec::ps_dying</a>.</p>

</div>
</div>
<a class="anchor" id="ad98d3670a5ba8ccb600b8d38927ccffb"></a><!-- doxytag: member="sec_gss.c::gss_sign_msg" ref="ad98d3670a5ba8ccb600b8d38927ccffb" args="(struct lustre_msg *msg, struct gss_ctx *mechctx, enum lustre_sec_part sp, __u32 flags, __u32 proc, __u32 seq, __u32 svc, rawobj_t *handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_sign_msg </td>
          <td>(</td>
          <td class="paramtype">struct lustre_msg *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>mechctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__sptlrpc.html#gaceeb8c40afd0179b5b42fc19aa58d177">lustre_sec_part</a>&nbsp;</td>
          <td class="paramname"> <em>sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>proc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>svc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrawobj__s.html">rawobj_t</a> *&nbsp;</td>
          <td class="paramname"> <em>handle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00177">177</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__internal_8h_source.html#l00021">netobj_s::data</a>, <a class="el" href="gss__internal_8h_source.html#l00143">gss_header::gh_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00150">gss_header::gh_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00144">gss_header::gh_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00145">gss_header::gh_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00141">gss_header::gh_sp</a>, <a class="el" href="gss__internal_8h_source.html#l00146">gss_header::gh_svc</a>, <a class="el" href="gss__internal_8h_source.html#l00140">gss_header::gh_version</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00020">netobj_s::len</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="gss__mech__switch_8c_source.html#l00207">lgss_get_mic()</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>, <a class="el" href="pack__generic_8c_source.html#l00496">lustre_shrink_msg()</a>, <a class="el" href="sec__gss_8c_source.html#l00082">msg_last_segidx()</a>, <a class="el" href="gss__internal_8h_source.html#l00097">PTLRPC_GSS_VERSION</a>, <a class="el" href="lustre__sec_8h_source.html#l00113">SPTLRPC_SVC_AUTH</a>, and <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l00640">gss_cli_ctx_sign()</a>, and <a class="el" href="sec__gss_8c_source.html#l01913">gss_svc_sign()</a>.</p>

</div>
</div>
<a class="anchor" id="af6e1f09236107b4b437cf9df54bec18a"></a><!-- doxytag: member="sec_gss.c::gss_svc_accept" ref="af6e1f09236107b4b437cf9df54bec18a" args="(struct ptlrpc_sec_policy *policy, struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_svc_accept </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__sec__policy.html">ptlrpc_sec_policy</a> *&nbsp;</td>
          <td class="paramname"> <em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02366">2366</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="gss__internal_8h_source.html#l00143">gss_header::gh_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00150">gss_header::gh_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00144">gss_header::gh_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00145">gss_header::gh_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00141">gss_header::gh_sp</a>, <a class="el" href="gss__internal_8h_source.html#l00146">gss_header::gh_svc</a>, <a class="el" href="gss__internal_8h_source.html#l00140">gss_header::gh_version</a>, <a class="el" href="gss__internal_8h_source.html#l00234">gss_svc_ctx::gsc_mapped_uid</a>, <a class="el" href="gss__internal_8h_source.html#l00235">gss_svc_ctx::gsc_remote</a>, <a class="el" href="gss__internal_8h_source.html#l00232">gss_svc_ctx::gsc_uid</a>, <a class="el" href="gss__internal_8h_source.html#l00235">gss_svc_ctx::gsc_usr_mds</a>, <a class="el" href="gss__internal_8h_source.html#l00235">gss_svc_ctx::gsc_usr_oss</a>, <a class="el" href="gss__internal_8h_source.html#l00235">gss_svc_ctx::gsc_usr_root</a>, <a class="el" href="sec__gss_8c_source.html#l00097">gss_header_swabber()</a>, <a class="el" href="sec__gss_8c_source.html#l02272">gss_svc_handle_data()</a>, <a class="el" href="sec__gss_8c_source.html#l02318">gss_svc_handle_destroy()</a>, <a class="el" href="sec__gss_8c_source.html#l01996">gss_svc_handle_init()</a>, <a class="el" href="sec__gss_8c_source.html#l01887">gss_svc_reqctx_free()</a>, <a class="el" href="sec__gss_8c_source.html#l00107">gss_swab_header()</a>, <a class="el" href="gss__internal_8h_source.html#l00186">gss_wire_ctx::gw_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00190">gss_wire_ctx::gw_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00187">gss_wire_ctx::gw_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00188">gss_wire_ctx::gw_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00189">gss_wire_ctx::gw_svc</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="gss__internal_8h_source.html#l00103">PTLRPC_GSS_PROC_CONTINUE_INIT</a>, <a class="el" href="gss__internal_8h_source.html#l00101">PTLRPC_GSS_PROC_DATA</a>, <a class="el" href="gss__internal_8h_source.html#l00104">PTLRPC_GSS_PROC_DESTROY</a>, <a class="el" href="gss__internal_8h_source.html#l00102">PTLRPC_GSS_PROC_INIT</a>, <a class="el" href="gss__internal_8h_source.html#l00097">PTLRPC_GSS_VERSION</a>, <a class="el" href="lustre__net_8h_source.html#l01190">ptlrpc_req_need_swab()</a>, <a class="el" href="gss__rawobj_8c_source.html#l00202">rawobj_from_netobj()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_auth_gss</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_auth_remote</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_auth_usr_mdt</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_auth_usr_ost</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_auth_usr_root</a>, <a class="el" href="lustre__net_8h_source.html#l01079">ptlrpc_request::rq_reqbuf</a>, <a class="el" href="lustre__sec_8h_source.html#l00881">ptlrpc_svc_ctx::sc_policy</a>, <a class="el" href="lustre__sec_8h_source.html#l00880">ptlrpc_svc_ctx::sc_refcount</a>, <a class="el" href="lustre__sec_8h_source.html#l01103">SECSVC_COMPLETE</a>, <a class="el" href="lustre__sec_8h_source.html#l01104">SECSVC_DROP</a>, <a class="el" href="lustre__sec_8h_source.html#l01102">SECSVC_OK</a>, <a class="el" href="lustre__sec_8h_source.html#l00973">sptlrpc_policy_get()</a>, <a class="el" href="gss__internal_8h_source.html#l00243">gss_svc_reqctx::src_base</a>, <a class="el" href="gss__internal_8h_source.html#l00248">gss_svc_reqctx::src_ctx</a>, and <a class="el" href="gss__internal_8h_source.html#l00247">gss_svc_reqctx::src_wirectx</a>.</p>

<p>Referenced by <a class="el" href="gss__keyring_8c_source.html#l01247">gss_svc_accept_kr()</a>, and <a class="el" href="gss__pipefs_8c_source.html#l00596">gss_svc_accept_pf()</a>.</p>

</div>
</div>
<a class="anchor" id="abd29c9ffb7d0c9cc19ca1e3b1c4a970c"></a><!-- doxytag: member="sec_gss.c::gss_svc_alloc_rs" ref="abd29c9ffb7d0c9cc19ca1e3b1c4a970c" args="(struct ptlrpc_request *req, int msglen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_svc_alloc_rs </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msglen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02517">2517</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="gss__internal_8h_source.html#l00090">GSS_MAX_CIPHER_BLOCK</a>, <a class="el" href="sec__gss_8c_source.html#l02492">gss_svc_bulk_payload()</a>, <a class="el" href="gss__internal_8h_source.html#l00360">gss_svc_ctx2reqctx()</a>, <a class="el" href="sec__gss_8c_source.html#l02480">gss_svc_payload()</a>, <a class="el" href="sec__gss_8c_source.html#l01897">gss_svc_reqctx_addref()</a>, <a class="el" href="sec__gss_8c_source.html#l01879">gss_svc_reqctx_is_special()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="pack__generic_8c_source.html#l00192">lustre_init_msg_v2()</a>, <a class="el" href="lustre__idl_8h_source.html#l01047">lustre_msg</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00688">lustre_msg_buflen()</a>, <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>, <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="gss__internal_8h_source.html#l00194">PTLRPC_GSS_HEADER_SIZE</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_bulk_read</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_bulk_write</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__net_8h_source.html#l01003">ptlrpc_request::rq_packed_final</a>, <a class="el" href="lustre__net_8h_source.html#l00705">ptlrpc_reply_state::rs_msg</a>, <a class="el" href="lustre__net_8h_source.html#l00695">ptlrpc_reply_state::rs_repbuf</a>, <a class="el" href="lustre__net_8h_source.html#l00697">ptlrpc_reply_state::rs_repbuf_len</a>, <a class="el" href="lustre__net_8h_source.html#l00680">ptlrpc_reply_state::rs_size</a>, <a class="el" href="lustre__net_8h_source.html#l00693">ptlrpc_reply_state::rs_svc_ctx</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00156">SPTLRPC_FLVR_SVC</a>, <a class="el" href="lustre__sec_8h_source.html#l00114">SPTLRPC_SVC_INTG</a>, <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>, <a class="el" href="lustre__sec_8h_source.html#l00115">SPTLRPC_SVC_PRIV</a>, <a class="el" href="gss__internal_8h_source.html#l00248">gss_svc_reqctx::src_ctx</a>, <a class="el" href="gss__internal_8h_source.html#l00254">gss_svc_reqctx::src_repbsd</a>, <a class="el" href="gss__internal_8h_source.html#l00255">gss_svc_reqctx::src_repbsd_size</a>, and <a class="el" href="gss__internal_8h_source.html#l00252">gss_svc_reqctx::src_reqbsd</a>.</p>

</div>
</div>
<a class="anchor" id="aa659134e6e34ca30e85dc652a408d7fc"></a><!-- doxytag: member="sec_gss.c::gss_svc_authorize" ref="aa659134e6e34ca30e85dc652a408d7fc" args="(struct ptlrpc_request *req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gss_svc_authorize </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02735">2735</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="sec__gss_8c_source.html#l00078">gss_at_reply_off_integ</a>, <a class="el" href="gss__internal_8h_source.html#l00360">gss_svc_ctx2reqctx()</a>, <a class="el" href="sec__gss_8c_source.html#l01879">gss_svc_reqctx_is_special()</a>, <a class="el" href="sec__gss_8c_source.html#l02637">gss_svc_seal()</a>, <a class="el" href="sec__gss_8c_source.html#l01913">gss_svc_sign()</a>, <a class="el" href="gss__internal_8h_source.html#l00187">gss_wire_ctx::gw_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00189">gss_wire_ctx::gw_svc</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00101">PTLRPC_GSS_PROC_DATA</a>, <a class="el" href="gss__internal_8h_source.html#l00104">PTLRPC_GSS_PROC_DESTROY</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01003">ptlrpc_request::rq_packed_final</a>, <a class="el" href="lustre__net_8h_source.html#l01092">ptlrpc_request::rq_reply_off</a>, <a class="el" href="lustre__net_8h_source.html#l00699">ptlrpc_reply_state::rs_repdata_len</a>, <a class="el" href="lustre__sec_8h_source.html#l00113">SPTLRPC_SVC_AUTH</a>, <a class="el" href="lustre__sec_8h_source.html#l00114">SPTLRPC_SVC_INTG</a>, <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>, <a class="el" href="lustre__sec_8h_source.html#l00115">SPTLRPC_SVC_PRIV</a>, <a class="el" href="gss__internal_8h_source.html#l00248">gss_svc_reqctx::src_ctx</a>, and <a class="el" href="gss__internal_8h_source.html#l00247">gss_svc_reqctx::src_wirectx</a>.</p>

</div>
</div>
<a class="anchor" id="a7a3dec22516a0ecf1cb89ee59b9817b8"></a><!-- doxytag: member="sec_gss.c::gss_svc_bulk_payload" ref="a7a3dec22516a0ecf1cb89ee59b9817b8" args="(struct gss_svc_ctx *gctx, struct sptlrpc_flavor *flvr, int read)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_svc_bulk_payload </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__svc__ctx.html">gss_svc_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsptlrpc__flavor.html">sptlrpc_flavor</a> *&nbsp;</td>
          <td class="paramname"> <em>flvr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>read</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02492">2492</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l00166">gss_mech_payload()</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00127">SPTLRPC_BULK_SVC_AUTH</a>, <a class="el" href="lustre__sec_8h_source.html#l00128">SPTLRPC_BULK_SVC_INTG</a>, <a class="el" href="lustre__sec_8h_source.html#l00126">SPTLRPC_BULK_SVC_NULL</a>, <a class="el" href="lustre__sec_8h_source.html#l00129">SPTLRPC_BULK_SVC_PRIV</a>, and <a class="el" href="lustre__sec_8h_source.html#l00160">SPTLRPC_FLVR_BULK_SVC</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02517">gss_svc_alloc_rs()</a>.</p>

</div>
</div>
<a class="anchor" id="a6f07334c490938a3644ceaaaeca8c1dc"></a><!-- doxytag: member="sec_gss.c::gss_svc_free_ctx" ref="a6f07334c490938a3644ceaaaeca8c1dc" args="(struct ptlrpc_svc_ctx *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gss_svc_free_ctx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__svc__ctx.html">ptlrpc_svc_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>ctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02795">2795</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="gss__internal_8h_source.html#l00360">gss_svc_ctx2reqctx()</a>, <a class="el" href="sec__gss_8c_source.html#l01887">gss_svc_reqctx_free()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, and <a class="el" href="lustre__sec_8h_source.html#l00880">ptlrpc_svc_ctx::sc_refcount</a>.</p>

</div>
</div>
<a class="anchor" id="a065898e49f883619f2b5cde15af2bd72"></a><!-- doxytag: member="sec_gss.c::gss_svc_free_rs" ref="a065898e49f883619f2b5cde15af2bd72" args="(struct ptlrpc_reply_state *rs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gss_svc_free_rs </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__reply__state.html">ptlrpc_reply_state</a> *&nbsp;</td>
          <td class="paramname"> <em>rs</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02781">2781</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l01904">gss_svc_reqctx_decref()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="lustre__net_8h_source.html#l00671">ptlrpc_reply_state::rs_prealloc</a>, <a class="el" href="lustre__net_8h_source.html#l00680">ptlrpc_reply_state::rs_size</a>, <a class="el" href="lustre__net_8h_source.html#l00693">ptlrpc_reply_state::rs_svc_ctx</a>, and <a class="el" href="gss__internal_8h_source.html#l00243">gss_svc_reqctx::src_base</a>.</p>

</div>
</div>
<a class="anchor" id="a2fd0044eb83a859b3021bd372f386f8e"></a><!-- doxytag: member="sec_gss.c::gss_svc_handle_data" ref="a2fd0044eb83a859b3021bd372f386f8e" args="(struct ptlrpc_request *req, struct gss_wire_ctx *gw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_svc_handle_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__wire__ctx.html">gss_wire_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gw</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02272">2272</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="it__test_8c_source.html#l00055">error</a>, <a class="el" href="gss__internal_8h_source.html#l00232">gss_svc_ctx::gsc_uid</a>, <a class="el" href="gss__internal_8h_source.html#l00198">gss_handle_to_u64()</a>, <a class="el" href="sec__gss_8c_source.html#l01955">gss_pack_err_notify()</a>, <a class="el" href="gss__err_8h_source.html#l00145">GSS_S_BAD_SIG</a>, <a class="el" href="gss__err_8h_source.html#l00149">GSS_S_NO_CONTEXT</a>, <a class="el" href="gss__internal_8h_source.html#l00360">gss_svc_ctx2reqctx()</a>, <a class="el" href="sec__gss_8c_source.html#l02195">gss_svc_unseal_request()</a>, <a class="el" href="gss__svc__upcall_8c_source.html#l01091">gss_svc_upcall_get_ctx()</a>, <a class="el" href="sec__gss_8c_source.html#l02114">gss_svc_verify_request()</a>, <a class="el" href="gss__internal_8h_source.html#l00190">gss_wire_ctx::gw_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00189">gss_wire_ctx::gw_svc</a>, <a class="el" href="nidstr_8h_source.html#l00077">libcfs_nid2str()</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="lnet_2include_2lnet_2types_8h_source.html#l00304">lnet_process_id_t::nid</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01108">ptlrpc_request::rq_peer</a>, <a class="el" href="lustre__net_8h_source.html#l01036">ptlrpc_request::rq_xid</a>, <a class="el" href="lustre__sec_8h_source.html#l01103">SECSVC_COMPLETE</a>, <a class="el" href="lustre__sec_8h_source.html#l01104">SECSVC_DROP</a>, <a class="el" href="lustre__sec_8h_source.html#l01102">SECSVC_OK</a>, <a class="el" href="lustre__sec_8h_source.html#l00113">SPTLRPC_SVC_AUTH</a>, <a class="el" href="lustre__sec_8h_source.html#l00114">SPTLRPC_SVC_INTG</a>, <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>, <a class="el" href="lustre__sec_8h_source.html#l00115">SPTLRPC_SVC_PRIV</a>, and <a class="el" href="gss__internal_8h_source.html#l00248">gss_svc_reqctx::src_ctx</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02366">gss_svc_accept()</a>.</p>

</div>
</div>
<a class="anchor" id="a666b471e4db2652d9e06c3768faac084"></a><!-- doxytag: member="sec_gss.c::gss_svc_handle_destroy" ref="a666b471e4db2652d9e06c3768faac084" args="(struct ptlrpc_request *req, struct gss_wire_ctx *gw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_svc_handle_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__wire__ctx.html">gss_wire_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gw</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02318">2318</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="gss__internal_8h_source.html#l00232">gss_svc_ctx::gsc_uid</a>, <a class="el" href="gss__internal_8h_source.html#l00198">gss_handle_to_u64()</a>, <a class="el" href="gss__internal_8h_source.html#l00360">gss_svc_ctx2reqctx()</a>, <a class="el" href="gss__svc__upcall_8c_source.html#l01114">gss_svc_upcall_destroy_ctx()</a>, <a class="el" href="gss__svc__upcall_8c_source.html#l01091">gss_svc_upcall_get_ctx()</a>, <a class="el" href="sec__gss_8c_source.html#l02114">gss_svc_verify_request()</a>, <a class="el" href="gss__internal_8h_source.html#l00186">gss_wire_ctx::gw_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00190">gss_wire_ctx::gw_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00189">gss_wire_ctx::gw_svc</a>, <a class="el" href="nidstr_8h_source.html#l00077">libcfs_nid2str()</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="gss__internal_8h_source.html#l00116">LUSTRE_GSS_PACK_USER</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="lnet_2include_2lnet_2types_8h_source.html#l00304">lnet_process_id_t::nid</a>, <a class="el" href="lustre__net_8h_source.html#l01190">ptlrpc_req_need_swab()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_fini</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_no_reply</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_udesc</a>, <a class="el" href="lustre__net_8h_source.html#l01108">ptlrpc_request::rq_peer</a>, <a class="el" href="lustre__net_8h_source.html#l01079">ptlrpc_request::rq_reqbuf</a>, <a class="el" href="lustre__sec_8h_source.html#l01104">SECSVC_DROP</a>, <a class="el" href="lustre__sec_8h_source.html#l01102">SECSVC_OK</a>, <a class="el" href="lustre__sec_8h_source.html#l00114">SPTLRPC_SVC_INTG</a>, <a class="el" href="sec_8c_source.html#l02468">sptlrpc_unpack_user_desc()</a>, and <a class="el" href="gss__internal_8h_source.html#l00248">gss_svc_reqctx::src_ctx</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02366">gss_svc_accept()</a>.</p>

</div>
</div>
<a class="anchor" id="aa8b55f312083afddfb4913a12505bd79"></a><!-- doxytag: member="sec_gss.c::gss_svc_handle_init" ref="aa8b55f312083afddfb4913a12505bd79" args="(struct ptlrpc_request *req, struct gss_wire_ctx *gw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_svc_handle_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__wire__ctx.html">gss_wire_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gw</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01996">1996</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="genops_8c_source.html#l00458">class_uuid2obd()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="libcfs__debug_8h_source.html#l00156">D_SEC</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="gss__internal_8h_source.html#l00232">gss_svc_ctx::gsc_uid</a>, <a class="el" href="gss__internal_8h_source.html#l00235">gss_svc_ctx::gsc_usr_mds</a>, <a class="el" href="gss__internal_8h_source.html#l00235">gss_svc_ctx::gsc_usr_oss</a>, <a class="el" href="gss__internal_8h_source.html#l00235">gss_svc_ctx::gsc_usr_root</a>, <a class="el" href="gss__internal_8h_source.html#l00360">gss_svc_ctx2reqctx()</a>, <a class="el" href="gss__svc__upcall_8c_source.html#l00908">gss_svc_upcall_handle_init()</a>, <a class="el" href="gss__internal_8h_source.html#l00186">gss_wire_ctx::gw_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00190">gss_wire_ctx::gw_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00187">gss_wire_ctx::gw_proc</a>, <a class="el" href="byteorder_8h_source.html#l00056">le32_to_cpu</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="nidstr_8h_source.html#l00077">libcfs_nid2str()</a>, <a class="el" href="gss__internal_8h_source.html#l00115">LUSTRE_GSS_PACK_BULK</a>, <a class="el" href="gss__internal_8h_source.html#l00116">LUSTRE_GSS_PACK_USER</a>, <a class="el" href="lustre__idl_8h_source.html#l01047">lustre_msg</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00688">lustre_msg_buflen()</a>, <a class="el" href="lnet_2include_2lnet_2types_8h_source.html#l00304">lnet_process_id_t::nid</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_set_up</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_stopping</a>, <a class="el" href="gss__internal_8h_source.html#l00102">PTLRPC_GSS_PROC_INIT</a>, <a class="el" href="lustre__net_8h_source.html#l01190">ptlrpc_req_need_swab()</a>, <a class="el" href="gss__rawobj_8c_source.html#l00182">rawobj_extract()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_ctx_init</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_udesc</a>, <a class="el" href="lustre__net_8h_source.html#l01108">ptlrpc_request::rq_peer</a>, <a class="el" href="lustre__net_8h_source.html#l01079">ptlrpc_request::rq_reqbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01024">ptlrpc_request::rq_reqlen</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="lustre__sec_8h_source.html#l01104">SECSVC_DROP</a>, <a class="el" href="lustre__sec_8h_source.html#l01102">SECSVC_OK</a>, <a class="el" href="sec_8c_source.html#l02468">sptlrpc_unpack_user_desc()</a>, <a class="el" href="gss__internal_8h_source.html#l00248">gss_svc_reqctx::src_ctx</a>, <a class="el" href="lustre__user_8h_source.html#l00492">obd_uuid::uuid</a>, and <a class="el" href="llog__test_8c_source.html#l00057">uuid</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02366">gss_svc_accept()</a>.</p>

</div>
</div>
<a class="anchor" id="a65a2fcf20b33d6a9bf89b27963ea7852"></a><!-- doxytag: member="sec_gss.c::gss_svc_invalidate_ctx" ref="a65a2fcf20b33d6a9bf89b27963ea7852" args="(struct ptlrpc_svc_ctx *svc_ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gss_svc_invalidate_ctx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__svc__ctx.html">ptlrpc_svc_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>svc_ctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02460">2460</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="gss__internal_8h_source.html#l00232">gss_svc_ctx::gsc_uid</a>, <a class="el" href="gss__internal_8h_source.html#l00360">gss_svc_ctx2reqctx()</a>, <a class="el" href="gss__svc__upcall_8c_source.html#l01114">gss_svc_upcall_destroy_ctx()</a>, and <a class="el" href="gss__internal_8h_source.html#l00248">gss_svc_reqctx::src_ctx</a>.</p>

</div>
</div>
<a class="anchor" id="af64fd5f6b7769bbdaf81d12b10b88e1d"></a><!-- doxytag: member="sec_gss.c::gss_svc_payload" ref="af64fd5f6b7769bbdaf81d12b10b88e1d" args="(struct gss_svc_reqctx *grctx, int early, int msgsize, int privacy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_svc_payload </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *&nbsp;</td>
          <td class="paramname"> <em>grctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>early</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>privacy</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02480">2480</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l00166">gss_mech_payload()</a>, <a class="el" href="sec__gss_8c_source.html#l01879">gss_svc_reqctx_is_special()</a>, and <a class="el" href="gss__internal_8h_source.html#l00262">gss_svc_reqctx::src_reserve_len</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02517">gss_svc_alloc_rs()</a>.</p>

</div>
</div>
<a class="anchor" id="ae89591fe95b5d09f0af7d9b7b1f4b272"></a><!-- doxytag: member="sec_gss.c::gss_svc_reqctx_addref" ref="ae89591fe95b5d09f0af7d9b7b1f4b272" args="(struct gss_svc_reqctx *grctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void gss_svc_reqctx_addref </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *&nbsp;</td>
          <td class="paramname"> <em>grctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01897">1897</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__sec_8h_source.html#l00880">ptlrpc_svc_ctx::sc_refcount</a>, and <a class="el" href="gss__internal_8h_source.html#l00243">gss_svc_reqctx::src_base</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02517">gss_svc_alloc_rs()</a>.</p>

</div>
</div>
<a class="anchor" id="a471e63bda8ce126ee895fab1a439a728"></a><!-- doxytag: member="sec_gss.c::gss_svc_reqctx_decref" ref="a471e63bda8ce126ee895fab1a439a728" args="(struct gss_svc_reqctx *grctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void gss_svc_reqctx_decref </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *&nbsp;</td>
          <td class="paramname"> <em>grctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01904">1904</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l01887">gss_svc_reqctx_free()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__sec_8h_source.html#l00880">ptlrpc_svc_ctx::sc_refcount</a>, and <a class="el" href="gss__internal_8h_source.html#l00243">gss_svc_reqctx::src_base</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02781">gss_svc_free_rs()</a>.</p>

</div>
</div>
<a class="anchor" id="a3201b89cfea44c2b36e8b77fc816d8bf"></a><!-- doxytag: member="sec_gss.c::gss_svc_reqctx_free" ref="a3201b89cfea44c2b36e8b77fc816d8bf" args="(struct gss_svc_reqctx *grctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void gss_svc_reqctx_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *&nbsp;</td>
          <td class="paramname"> <em>grctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01887">1887</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="gss__svc__upcall_8c_source.html#l01107">gss_svc_upcall_put_ctx()</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="lustre__sec_8h_source.html#l00881">ptlrpc_svc_ctx::sc_policy</a>, <a class="el" href="lustre__sec_8h_source.html#l00980">sptlrpc_policy_put()</a>, <a class="el" href="gss__internal_8h_source.html#l00243">gss_svc_reqctx::src_base</a>, and <a class="el" href="gss__internal_8h_source.html#l00248">gss_svc_reqctx::src_ctx</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02366">gss_svc_accept()</a>, <a class="el" href="sec__gss_8c_source.html#l02795">gss_svc_free_ctx()</a>, and <a class="el" href="sec__gss_8c_source.html#l01904">gss_svc_reqctx_decref()</a>.</p>

</div>
</div>
<a class="anchor" id="a3d3c356b152a9112df57bd673cfd07bd"></a><!-- doxytag: member="sec_gss.c::gss_svc_reqctx_is_special" ref="a3d3c356b152a9112df57bd673cfd07bd" args="(struct gss_svc_reqctx *grctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_svc_reqctx_is_special </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *&nbsp;</td>
          <td class="paramname"> <em>grctx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01879">1879</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00259">gss_svc_reqctx::src_err_notify</a>, <a class="el" href="gss__internal_8h_source.html#l00259">gss_svc_reqctx::src_init</a>, and <a class="el" href="gss__internal_8h_source.html#l00259">gss_svc_reqctx::src_init_continue</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02517">gss_svc_alloc_rs()</a>, <a class="el" href="sec__gss_8c_source.html#l02735">gss_svc_authorize()</a>, and <a class="el" href="sec__gss_8c_source.html#l02480">gss_svc_payload()</a>.</p>

</div>
</div>
<a class="anchor" id="ae8891f930ad962ac15fe4f1c904912c8"></a><!-- doxytag: member="sec_gss.c::gss_svc_seal" ref="ae8891f930ad962ac15fe4f1c904912c8" args="(struct ptlrpc_request *req, struct ptlrpc_reply_state *rs, struct gss_svc_reqctx *grctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_svc_seal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__reply__state.html">ptlrpc_reply_state</a> *&nbsp;</td>
          <td class="paramname"> <em>rs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *&nbsp;</td>
          <td class="paramname"> <em>grctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02637">2637</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="gss__internal_8h_source.html#l00143">gss_header::gh_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00150">gss_header::gh_handle</a>, <a class="el" href="gss__internal_8h_source.html#l00144">gss_header::gh_proc</a>, <a class="el" href="gss__internal_8h_source.html#l00145">gss_header::gh_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00141">gss_header::gh_sp</a>, <a class="el" href="gss__internal_8h_source.html#l00146">gss_header::gh_svc</a>, <a class="el" href="gss__internal_8h_source.html#l00140">gss_header::gh_version</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="gss__internal_8h_source.html#l00228">gss_svc_ctx::gsc_mechctx</a>, <a class="el" href="sec__gss_8c_source.html#l00079">gss_at_reply_off_priv</a>, <a class="el" href="sec__gss_8c_source.html#l00166">gss_mech_payload()</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__internal_8h_source.html#l00188">gss_wire_ctx::gw_seq</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="gss__internal_8h_source.html#l00020">netobj_s::len</a>, <a class="el" href="gss__mech__switch_8c_source.html#l00250">lgss_wrap()</a>, <a class="el" href="gss__internal_8h_source.html#l00115">LUSTRE_GSS_PACK_BULK</a>, <a class="el" href="pack__generic_8c_source.html#l00192">lustre_init_msg_v2()</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00688">lustre_msg_buflen()</a>, <a class="el" href="pack__generic_8c_source.html#l00139">lustre_msg_size_v2()</a>, <a class="el" href="pack__generic_8c_source.html#l00805">lustre_msghdr_get_flags()</a>, <a class="el" href="pack__generic_8c_source.html#l00496">lustre_shrink_msg()</a>, <a class="el" href="lustre__sec_8h_source.html#l00321">LUSTRE_SP_ANY</a>, <a class="el" href="lustre__idl_8h_source.html#l01044">MSGHDR_AT_SUPPORT</a>, <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, <a class="el" href="gss__internal_8h_source.html#l00194">PTLRPC_GSS_HEADER_SIZE</a>, <a class="el" href="gss__internal_8h_source.html#l00101">PTLRPC_GSS_PROC_DATA</a>, <a class="el" href="gss__internal_8h_source.html#l00097">PTLRPC_GSS_VERSION</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01055">ptlrpc_request::rq_flvr</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__net_8h_source.html#l01003">ptlrpc_request::rq_packed_final</a>, <a class="el" href="lustre__net_8h_source.html#l01026">ptlrpc_request::rq_replen</a>, <a class="el" href="lustre__net_8h_source.html#l01092">ptlrpc_request::rq_reply_off</a>, <a class="el" href="lustre__net_8h_source.html#l01032">ptlrpc_request::rq_repmsg</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="lustre__net_8h_source.html#l00705">ptlrpc_reply_state::rs_msg</a>, <a class="el" href="lustre__net_8h_source.html#l00695">ptlrpc_reply_state::rs_repbuf</a>, <a class="el" href="lustre__net_8h_source.html#l00697">ptlrpc_reply_state::rs_repbuf_len</a>, <a class="el" href="lustre__net_8h_source.html#l00699">ptlrpc_reply_state::rs_repdata_len</a>, <a class="el" href="lustre__sec_8h_source.html#l00292">sptlrpc_flavor::sf_rpc</a>, <a class="el" href="lustre__sec_8h_source.html#l00115">SPTLRPC_SVC_PRIV</a>, <a class="el" href="gss__internal_8h_source.html#l00248">gss_svc_reqctx::src_ctx</a>, <a class="el" href="gss__internal_8h_source.html#l00254">gss_svc_reqctx::src_repbsd</a>, <a class="el" href="gss__internal_8h_source.html#l00255">gss_svc_reqctx::src_repbsd_size</a>, and <a class="el" href="gss__internal_8h_source.html#l00247">gss_svc_reqctx::src_wirectx</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02735">gss_svc_authorize()</a>.</p>

</div>
</div>
<a class="anchor" id="ac8523800995454641ed011a2bf538c49"></a><!-- doxytag: member="sec_gss.c::gss_svc_sign" ref="ac8523800995454641ed011a2bf538c49" args="(struct ptlrpc_request *req, struct ptlrpc_reply_state *rs, struct gss_svc_reqctx *grctx, __u32 svc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_svc_sign </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__reply__state.html">ptlrpc_reply_state</a> *&nbsp;</td>
          <td class="paramname"> <em>rs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *&nbsp;</td>
          <td class="paramname"> <em>grctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>svc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l01913">1913</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="gss__internal_8h_source.html#l00228">gss_svc_ctx::gsc_mechctx</a>, <a class="el" href="sec__gss_8c_source.html#l00078">gss_at_reply_off_integ</a>, <a class="el" href="sec__gss_8c_source.html#l00177">gss_sign_msg()</a>, <a class="el" href="gss__internal_8h_source.html#l00188">gss_wire_ctx::gw_seq</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs__private_8h_source.html#l00309">likely</a>, <a class="el" href="gss__internal_8h_source.html#l00115">LUSTRE_GSS_PACK_BULK</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00688">lustre_msg_buflen()</a>, <a class="el" href="pack__generic_8c_source.html#l00805">lustre_msghdr_get_flags()</a>, <a class="el" href="pack__generic_8c_source.html#l00496">lustre_shrink_msg()</a>, <a class="el" href="lustre__sec_8h_source.html#l00321">LUSTRE_SP_ANY</a>, <a class="el" href="lustre__idl_8h_source.html#l01044">MSGHDR_AT_SUPPORT</a>, <a class="el" href="gss__internal_8h_source.html#l00101">PTLRPC_GSS_PROC_DATA</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__net_8h_source.html#l01003">ptlrpc_request::rq_packed_final</a>, <a class="el" href="lustre__net_8h_source.html#l01026">ptlrpc_request::rq_replen</a>, <a class="el" href="lustre__net_8h_source.html#l01092">ptlrpc_request::rq_reply_off</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="lustre__net_8h_source.html#l00705">ptlrpc_reply_state::rs_msg</a>, <a class="el" href="lustre__net_8h_source.html#l00695">ptlrpc_reply_state::rs_repbuf</a>, <a class="el" href="lustre__net_8h_source.html#l00699">ptlrpc_reply_state::rs_repdata_len</a>, <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>, <a class="el" href="gss__internal_8h_source.html#l00248">gss_svc_reqctx::src_ctx</a>, and <a class="el" href="gss__internal_8h_source.html#l00247">gss_svc_reqctx::src_wirectx</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02735">gss_svc_authorize()</a>.</p>

</div>
</div>
<a class="anchor" id="ae1d5fefb196c3f194ed267f09e35dde1"></a><!-- doxytag: member="sec_gss.c::gss_svc_unseal_request" ref="ae1d5fefb196c3f194ed267f09e35dde1" args="(struct ptlrpc_request *req, struct gss_svc_reqctx *grctx, struct gss_wire_ctx *gw, __u32 *major)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_svc_unseal_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *&nbsp;</td>
          <td class="paramname"> <em>grctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__wire__ctx.html">gss_wire_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32 *&nbsp;</td>
          <td class="paramname"> <em>major</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02195">2195</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="pack__generic_8c_source.html#l00574">__lustre_unpack_msg()</a>, <a class="el" href="sec__bulk_8c_source.html#l00879">bulk_sec_desc_unpack()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="gss__internal_8h_source.html#l00228">gss_svc_ctx::gsc_mechctx</a>, <a class="el" href="gss__internal_8h_source.html#l00229">gss_svc_ctx::gsc_seqdata</a>, <a class="el" href="sec__gss_8c_source.html#l00536">gss_check_seq_num()</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00176">GSS_S_DUPLICATE_TOKEN</a>, <a class="el" href="sec__gss_8c_source.html#l00275">gss_unseal_msg()</a>, <a class="el" href="gss__internal_8h_source.html#l00186">gss_wire_ctx::gw_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00188">gss_wire_ctx::gw_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00115">LUSTRE_GSS_PACK_BULK</a>, <a class="el" href="gss__internal_8h_source.html#l00116">LUSTRE_GSS_PACK_USER</a>, <a class="el" href="lustre__idl_8h_source.html#l01047">lustre_msg</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00688">lustre_msg_buflen()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_udesc</a>, <a class="el" href="lustre__net_8h_source.html#l01079">ptlrpc_request::rq_reqbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01085">ptlrpc_request::rq_reqdata_len</a>, <a class="el" href="lustre__net_8h_source.html#l01024">ptlrpc_request::rq_reqlen</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="sec_8c_source.html#l02468">sptlrpc_unpack_user_desc()</a>, <a class="el" href="gss__internal_8h_source.html#l00248">gss_svc_reqctx::src_ctx</a>, <a class="el" href="gss__internal_8h_source.html#l00252">gss_svc_reqctx::src_reqbsd</a>, and <a class="el" href="gss__internal_8h_source.html#l00253">gss_svc_reqctx::src_reqbsd_size</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02272">gss_svc_handle_data()</a>.</p>

</div>
</div>
<a class="anchor" id="a16538ab7b98707dbe38b956109bb08f9"></a><!-- doxytag: member="sec_gss.c::gss_svc_verify_request" ref="a16538ab7b98707dbe38b956109bb08f9" args="(struct ptlrpc_request *req, struct gss_svc_reqctx *grctx, struct gss_wire_ctx *gw, __u32 *major)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gss_svc_verify_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structptlrpc__request.html">ptlrpc_request</a> *&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__svc__reqctx.html">gss_svc_reqctx</a> *&nbsp;</td>
          <td class="paramname"> <em>grctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__wire__ctx.html">gss_wire_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>gw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32 *&nbsp;</td>
          <td class="paramname"> <em>major</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02114">2114</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__bulk_8c_source.html#l00879">bulk_sec_desc_unpack()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="gss__internal_8h_source.html#l00228">gss_svc_ctx::gsc_mechctx</a>, <a class="el" href="gss__internal_8h_source.html#l00235">gss_svc_ctx::gsc_reverse</a>, <a class="el" href="gss__internal_8h_source.html#l00229">gss_svc_ctx::gsc_seqdata</a>, <a class="el" href="sec__gss_8c_source.html#l00536">gss_check_seq_num()</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00176">GSS_S_DUPLICATE_TOKEN</a>, <a class="el" href="sec__gss_8c_source.html#l00239">gss_verify_msg()</a>, <a class="el" href="gss__internal_8h_source.html#l00186">gss_wire_ctx::gw_flags</a>, <a class="el" href="gss__internal_8h_source.html#l00188">gss_wire_ctx::gw_seq</a>, <a class="el" href="gss__internal_8h_source.html#l00189">gss_wire_ctx::gw_svc</a>, <a class="el" href="gss__internal_8h_source.html#l00115">LUSTRE_GSS_PACK_BULK</a>, <a class="el" href="gss__internal_8h_source.html#l00116">LUSTRE_GSS_PACK_USER</a>, <a class="el" href="lustre__idl_8h_source.html#l01047">lustre_msg</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00688">lustre_msg_buflen()</a>, <a class="el" href="lustre__net_8h_source.html#l01190">ptlrpc_req_need_swab()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_bulk</a>, <a class="el" href="lustre__net_8h_source.html#l01059">ptlrpc_request::rq_pack_udesc</a>, <a class="el" href="lustre__net_8h_source.html#l01079">ptlrpc_request::rq_reqbuf</a>, <a class="el" href="lustre__net_8h_source.html#l01024">ptlrpc_request::rq_reqlen</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>, <a class="el" href="sec_8c_source.html#l02468">sptlrpc_unpack_user_desc()</a>, <a class="el" href="gss__internal_8h_source.html#l00248">gss_svc_reqctx::src_ctx</a>, <a class="el" href="gss__internal_8h_source.html#l00252">gss_svc_reqctx::src_reqbsd</a>, and <a class="el" href="gss__internal_8h_source.html#l00253">gss_svc_reqctx::src_reqbsd_size</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l02272">gss_svc_handle_data()</a>, and <a class="el" href="sec__gss_8c_source.html#l02318">gss_svc_handle_destroy()</a>.</p>

</div>
</div>
<a class="anchor" id="a826ccf3f7f174c513dd9ee7de4c67fce"></a><!-- doxytag: member="sec_gss.c::gss_swab_header" ref="a826ccf3f7f174c513dd9ee7de4c67fce" args="(struct lustre_msg *msg, int segment, int swabbed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structgss__header.html">gss_header</a>* gss_swab_header </td>
          <td>(</td>
          <td class="paramtype">struct lustre_msg *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>swabbed</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00107">107</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00150">gss_header::gh_handle</a>, <a class="el" href="sec__gss_8c_source.html#l00097">gss_header_swabber()</a>, <a class="el" href="gss__internal_8h_source.html#l00020">netobj_s::len</a>, and <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>.</p>

<p>Referenced by <a class="el" href="gss__cli__upcall_8c_source.html#l00146">ctx_init_parse_reply()</a>, <a class="el" href="sec__gss_8c_source.html#l00980">gss_cli_ctx_unseal()</a>, <a class="el" href="sec__gss_8c_source.html#l00757">gss_cli_ctx_verify()</a>, and <a class="el" href="sec__gss_8c_source.html#l02366">gss_svc_accept()</a>.</p>

</div>
</div>
<a class="anchor" id="a606e0bf8e87baf937dd849f64ce2316a"></a><!-- doxytag: member="sec_gss.c::gss_unseal_msg" ref="a606e0bf8e87baf937dd849f64ce2316a" args="(struct gss_ctx *mechctx, struct lustre_msg *msgbuf, int *msg_len, int msgbuf_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 gss_unseal_msg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>mechctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct lustre_msg *&nbsp;</td>
          <td class="paramname"> <em>msgbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>msg_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msgbuf_len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00275">275</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="gss__err_8h_source.html#l00159">GSS_S_FAILURE</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="gss__mech__switch_8c_source.html#l00265">lgss_unwrap()</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00688">lustre_msg_buflen()</a>, <a class="el" href="obd__support_8h_source.html#l00747">OBD_ALLOC_LARGE</a>, <a class="el" href="obd__support_8h_source.html#l00783">OBD_FREE_LARGE</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l00980">gss_cli_ctx_unseal()</a>, and <a class="el" href="sec__gss_8c_source.html#l02195">gss_svc_unseal_request()</a>.</p>

</div>
</div>
<a class="anchor" id="a7ae364739fd3d4e7932f1b9a96f79ba8"></a><!-- doxytag: member="sec_gss.c::gss_verify_msg" ref="a7ae364739fd3d4e7932f1b9a96f79ba8" args="(struct lustre_msg *msg, struct gss_ctx *mechctx, __u32 svc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static __u32 gss_verify_msg </td>
          <td>(</td>
          <td class="paramtype">struct lustre_msg *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgss__ctx.html">gss_ctx</a> *&nbsp;</td>
          <td class="paramname"> <em>mechctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>svc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00239">239</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="gss__internal_8h_source.html#l00028">rawobj_s::data</a>, <a class="el" href="gss__err_8h_source.html#l00091">GSS_S_COMPLETE</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="gss__internal_8h_source.html#l00027">rawobj_s::len</a>, <a class="el" href="gss__mech__switch_8c_source.html#l00229">lgss_verify_mic()</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="sec__gss_8c_source.html#l00082">msg_last_segidx()</a>, <a class="el" href="lustre__sec_8h_source.html#l00113">SPTLRPC_SVC_AUTH</a>, and <a class="el" href="lustre__sec_8h_source.html#l00112">SPTLRPC_SVC_NULL</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l00757">gss_cli_ctx_verify()</a>, and <a class="el" href="sec__gss_8c_source.html#l02114">gss_svc_verify_request()</a>.</p>

</div>
</div>
<a class="anchor" id="adc10f40acba3bb9b2640e985276b0a7c"></a><!-- doxytag: member="sec_gss.c::MODULE_AUTHOR" ref="adc10f40acba3bb9b2640e985276b0a7c" args="(&quot;OpenSFS, Inc. &lt;http://www.lustre.org/&gt;&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MODULE_AUTHOR </td>
          <td>(</td>
          <td class="paramtype">&quot;&nbsp;</td>
          <td class="paramname"> <em>OpenSFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Inc.&lt; http://www.lustre.org/&gt;&quot;&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9a142835e73ed6fee6c0f175b47de6c6"></a><!-- doxytag: member="sec_gss.c::MODULE_DESCRIPTION" ref="a9a142835e73ed6fee6c0f175b47de6c6" args="(&quot;Lustre GSS security policy&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MODULE_DESCRIPTION </td>
          <td>(</td>
          <td class="paramtype">&quot;Lustre GSS security policy&quot;&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa65b57a9f15160764afe9f0fb7c4da08"></a><!-- doxytag: member="sec_gss.c::module_exit" ref="aa65b57a9f15160764afe9f0fb7c4da08" args="(sptlrpc_gss_exit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_exit </td>
          <td>(</td>
          <td class="paramtype">sptlrpc_gss_exit&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a74791558dfaeb18f7ac66c0482d0236f"></a><!-- doxytag: member="sec_gss.c::module_init" ref="a74791558dfaeb18f7ac66c0482d0236f" args="(sptlrpc_gss_init)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">module_init </td>
          <td>(</td>
          <td class="paramtype">sptlrpc_gss_init&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad94b36675e7eb067ea3ce6ff9e244a44"></a><!-- doxytag: member="sec_gss.c::MODULE_LICENSE" ref="ad94b36675e7eb067ea3ce6ff9e244a44" args="(&quot;GPL&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MODULE_LICENSE </td>
          <td>(</td>
          <td class="paramtype">&quot;GPL&quot;&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae9c321be2136fb8501887ee69dac11a2"></a><!-- doxytag: member="sec_gss.c::MODULE_VERSION" ref="ae9c321be2136fb8501887ee69dac11a2" args="(LUSTRE_VERSION_STRING)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MODULE_VERSION </td>
          <td>(</td>
          <td class="paramtype">LUSTRE_VERSION_STRING&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3a2c731eaccaa8d3b17460ab20a4b3bc"></a><!-- doxytag: member="sec_gss.c::msg_last_segidx" ref="a3a2c731eaccaa8d3b17460ab20a4b3bc" args="(struct lustre_msg *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int msg_last_segidx </td>
          <td>(</td>
          <td class="paramtype">struct lustre_msg *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00082">82</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01642">gss_enlarge_reqbuf_intg()</a>, <a class="el" href="sec__gss_8c_source.html#l00177">gss_sign_msg()</a>, <a class="el" href="sec__gss_8c_source.html#l00239">gss_verify_msg()</a>, and <a class="el" href="sec__gss_8c_source.html#l00087">msg_last_seglen()</a>.</p>

</div>
</div>
<a class="anchor" id="a75526277cc050e034ab9891554e970d1"></a><!-- doxytag: member="sec_gss.c::msg_last_seglen" ref="a75526277cc050e034ab9891554e970d1" args="(struct lustre_msg *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int msg_last_seglen </td>
          <td>(</td>
          <td class="paramtype">struct lustre_msg *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00087">87</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="sec__gss_8c_source.html#l00082">msg_last_segidx()</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01642">gss_enlarge_reqbuf_intg()</a>.</p>

</div>
</div>
<a class="anchor" id="ab2d37e1dd79021b348eebefcba7f111b"></a><!-- doxytag: member="sec_gss.c::sptlrpc_gss_exit" ref="ab2d37e1dd79021b348eebefcba7f111b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void __exit sptlrpc_gss_exit </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02932">2932</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="gss__krb5__mech_8c_source.html#l01972">cleanup_kerberos_module()</a>, <a class="el" href="gss__cli__upcall_8c_source.html#l00445">gss_exit_cli_upcall()</a>, <a class="el" href="gss__keyring_8c_source.html#l01586">gss_exit_keyring()</a>, <a class="el" href="lproc__gss_8c_source.html#l00188">gss_exit_lproc()</a>, <a class="el" href="gss__pipefs_8c_source.html#l01249">gss_exit_pipefs()</a>, and <a class="el" href="gss__svc__upcall_8c_source.html#l01167">gss_exit_svc_upcall()</a>.</p>

</div>
</div>
<a class="anchor" id="af5c176ee43df45c69ac8abff1d7afa76"></a><!-- doxytag: member="sec_gss.c::sptlrpc_gss_init" ref="af5c176ee43df45c69ac8abff1d7afa76" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int __init sptlrpc_gss_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l02872">2872</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>References <a class="el" href="gss__krb5__mech_8c_source.html#l01972">cleanup_kerberos_module()</a>, <a class="el" href="gss__null__mech_8c_source.html#l00195">cleanup_null_module()</a>, <a class="el" href="gss__sk__mech_8c_source.html#l00226">cleanup_sk_module()</a>, <a class="el" href="gss__cli__upcall_8c_source.html#l00445">gss_exit_cli_upcall()</a>, <a class="el" href="gss__keyring_8c_source.html#l01586">gss_exit_keyring()</a>, <a class="el" href="lproc__gss_8c_source.html#l00188">gss_exit_lproc()</a>, <a class="el" href="gss__svc__upcall_8c_source.html#l01167">gss_exit_svc_upcall()</a>, <a class="el" href="sec__gss_8c_source.html#l02854">gss_init_at_reply_offset()</a>, <a class="el" href="gss__cli__upcall_8c_source.html#l00440">gss_init_cli_upcall()</a>, <a class="el" href="gss__keyring_8c_source.html#l01567">gss_init_keyring()</a>, <a class="el" href="lproc__gss_8c_source.html#l00201">gss_init_lproc()</a>, <a class="el" href="gss__pipefs_8c_source.html#l01232">gss_init_pipefs()</a>, <a class="el" href="gss__svc__upcall_8c_source.html#l01124">gss_init_svc_upcall()</a>, <a class="el" href="gss__krb5__mech_8c_source.html#l01960">init_kerberos_module()</a>, <a class="el" href="gss__null__mech_8c_source.html#l00184">init_null_module()</a>, and <a class="el" href="gss__sk__mech_8c_source.html#l00215">init_sk_module()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ad4dba51f4c0aec0aa35aab8ea71e53a8"></a><!-- doxytag: member="sec_gss.c::gss_at_reply_off_integ" ref="ad4dba51f4c0aec0aa35aab8ea71e53a8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="sec__gss_8c.html#ad4dba51f4c0aec0aa35aab8ea71e53a8">gss_at_reply_off_integ</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00078">78</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01488">gss_alloc_repbuf_intg()</a>, <a class="el" href="sec__gss_8c_source.html#l02854">gss_init_at_reply_offset()</a>, <a class="el" href="sec__gss_8c_source.html#l02735">gss_svc_authorize()</a>, and <a class="el" href="sec__gss_8c_source.html#l01913">gss_svc_sign()</a>.</p>

</div>
</div>
<a class="anchor" id="a7cfa79bf5e0a01d3abb0ec910fe533e9"></a><!-- doxytag: member="sec_gss.c::gss_at_reply_off_priv" ref="a7cfa79bf5e0a01d3abb0ec910fe533e9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="sec__gss_8c.html#a7cfa79bf5e0a01d3abb0ec910fe533e9">gss_at_reply_off_priv</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sec__gss_8c_source.html#l00079">79</a> of file <a class="el" href="sec__gss_8c_source.html">sec_gss.c</a>.</p>

<p>Referenced by <a class="el" href="sec__gss_8c_source.html#l01541">gss_alloc_repbuf_priv()</a>, <a class="el" href="sec__gss_8c_source.html#l02854">gss_init_at_reply_offset()</a>, and <a class="el" href="sec__gss_8c_source.html#l02637">gss_svc_seal()</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:50 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
