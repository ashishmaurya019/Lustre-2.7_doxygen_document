<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: lustre/ofd/ofd_internal.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lustre/ofd/ofd_internal.h File Reference</h1><code>#include &lt;<a class="el" href="obd_8h_source.html">obd.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="obd__class_8h_source.html">obd_class.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="dt__object_8h_source.html">dt_object.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="md__object_8h_source.html">md_object.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="lustre__fid_8h_source.html">lustre_fid.h</a>&gt;</code><br/>

<p><a href="ofd__internal_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structofd__mod__data.html">ofd_mod_data</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structofd__seq.html">ofd_seq</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structofd__device.html">ofd_device</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structofd__object.html">ofd_object</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structofd__thread__info.html">ofd_thread_info</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a83e9c6b976e748cec6206611941db35d">OFD_INIT_OBJID</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ae2f608bb1acddf7bd154c623a55f4d68">OFD_PRECREATE_BATCH_DEFAULT</a>&nbsp;&nbsp;&nbsp;(OBJ_SUBDIR_COUNT * 4)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a8414c34d94a42f674a910837033fae73">OFD_PRECREATE_SMALL_FS</a>&nbsp;&nbsp;&nbsp;(1024ULL * 1024 * 1024)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ac324fa139c6232593840d7a3412edcd1">OFD_PRECREATE_BATCH_SMALL</a>&nbsp;&nbsp;&nbsp;8</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ac901be17f19b08129686f5fb2834e927">OFD_VALID_FLAGS</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a9cd27fbd3f69599be7ed3815fecabca6">OFD_FMD_MAX_NUM_DEFAULT</a>&nbsp;&nbsp;&nbsp;128</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a6a1a69afb670005afeb5c2733283a6cd">OFD_FMD_MAX_AGE_DEFAULT</a>&nbsp;&nbsp;&nbsp;msecs_to_jiffies((<a class="el" href="class__obd_8c.html#aa0f9a3f30233340b9fe0b3a3eb300735">obd_timeout</a>+10)*MSEC_PER_SEC)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a74df2d5e0c8225ad33ed721692382381">OFD_SOFT_SYNC_LIMIT_DEFAULT</a>&nbsp;&nbsp;&nbsp;16</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a0f816134bb3056fa752be066c9a5fcca">COMPAT_BSIZE_SHIFT</a>&nbsp;&nbsp;&nbsp;12</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ac49791f4ede39fcc281524014f5ccc8b">ofd_fmd_drop</a>(exp, fid)&nbsp;&nbsp;&nbsp;do {} while (0)</td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <br/>
&nbsp;&nbsp;<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1a80991169bbda577b52aad7c456a071fb">LPROC_OFD_STATS_READ</a> =  0, 
<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1a985cd03473089fd60af6b415b3e9df63">LPROC_OFD_STATS_WRITE</a>, 
<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1ab92636dadd23f0b7ad828bc51163d8e0">LPROC_OFD_STATS_GETATTR</a>, 
<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1af799d1d27a025c5dacf7159829b96abe">LPROC_OFD_STATS_SETATTR</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1a3ef4eefb604dc9ed38973a45b03b17e3">LPROC_OFD_STATS_PUNCH</a>, 
<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1a33446192e5a61685358c62e824233346">LPROC_OFD_STATS_SYNC</a>, 
<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1a53bbc272f8167d9a41aa2836b9e72edb">LPROC_OFD_STATS_DESTROY</a>, 
<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1a286d10f3e8a402bf8fe5b88f8c4d48f6">LPROC_OFD_STATS_CREATE</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1a0388e3def786ef35ff72f89e1b1306f2">LPROC_OFD_STATS_STATFS</a>, 
<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1a009c50ad492db3674deffeb95c4b64c6">LPROC_OFD_STATS_GET_INFO</a>, 
<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1a1b05028ed29010a00660556dcd0971f1">LPROC_OFD_STATS_SET_INFO</a>, 
<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1a88c5034b60103d3ceeaa2ff6c25168c5">LPROC_OFD_STATS_QUOTACTL</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="ofd__internal_8h.html#af59064efe753e6928fd91539a27503d1ae4579e3facb2acc059ca5d2ef42dfd3c">LPROC_OFD_STATS_LAST</a>
<br/>
 }</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a61757442bd0cc0ec16bb3f720ada527b">ofd_counter_incr</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp, int opcode, char *jobid, long amount)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#acf2d317977364c79c44f66e6feba0e78">ofd_dev</a> (struct <a class="el" href="structlu__device.html">lu_device</a> *d)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structobd__device.html">obd_device</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#aef602a45635c5892c237ab74709cd8d1">ofd_obd</a> (struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a663fe6f0f85a398de889d88c635020fd">ofd_exp</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a087f286e42ffa0e2530decea9b9b658e">ofd_name</a> (struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a6f529d63e425ee42652d7d4481c95ce9">ofd_obj</a> (struct <a class="el" href="structlu__object.html">lu_object</a> *o)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a3f9a60b36e41790dfd1c056db7b0eab2">ofd_object_exists</a> (struct <a class="el" href="structofd__object.html">ofd_object</a> *obj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#aa42c5acd9cf2edad9ba7ad5a9aceacac">fo2dt</a> (struct <a class="el" href="structofd__object.html">ofd_object</a> *obj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structdt__object.html">dt_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a56709decfe3371e72247faf28e816dec">ofd_object_child</a> (struct <a class="el" href="structofd__object.html">ofd_object</a> *_obj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a44100c7cf85c189a2826a021adf42113">ofd_obj2dev</a> (const struct <a class="el" href="structofd__object.html">ofd_object</a> *fo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ae30c9aa5fcc0a7316734f68dcb115b0d">ofd_read_lock</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__object.html">ofd_object</a> *fo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a493ef7e2cb003f26e6ae08c1a013a862">ofd_read_unlock</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__object.html">ofd_object</a> *fo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a724ef660aab12afe48e0a40d530c0561">ofd_write_lock</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__object.html">ofd_object</a> *fo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a86ec5e33746e5cf58f09a9fe497662fe">ofd_write_unlock</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__object.html">ofd_object</a> *fo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ac3db3f215fff161c7d1276d6217b1bfc">target_recovery_fini</a> (struct <a class="el" href="structobd__device.html">obd_device</a> *obd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a8c8ebefb0e9c977840de5620dfd7e655">target_recovery_init</a> (struct <a class="el" href="structlu__target.html">lu_target</a> *lut, <a class="el" href="group__net.html#gaafdde121d699c66fbef23b0a702d1cb0">svc_handler_t</a> handler)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a75bf6a3caae3bb3a84364235ee1bad78">ofd_postrecov</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Notify all devices in server stack about recovery completion.  <a href="#a75bf6a3caae3bb3a84364235ee1bad78"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ad493a8cc1ef417f7c163d365cd3135ed">ofd_fiemap_get</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, struct fiemap *fiemap)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get FIEMAP (FIle Extent MAPping) for object with the given FID.  <a href="#ad493a8cc1ef417f7c163d365cd3135ed"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a74db0692a1936a385df730c631e73178">ofd_statfs_internal</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, struct <a class="el" href="structobd__statfs.html">obd_statfs</a> *osfs, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> max_age, int *from_cache)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get file system statistics of OST server.  <a href="#a74db0692a1936a385df730c631e73178"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a4ca35902254971b1607e297996aab7eb">ofd_destroy_by_fid</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, int orphan)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy OFD object by its FID.  <a href="#a4ca35902254971b1607e297996aab7eb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ad45ee8814249ae10c9afa9e7fcc73ce6">ofd_statfs</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structobd__export.html">obd_export</a> *exp, struct <a class="el" href="structobd__statfs.html">obd_statfs</a> *osfs, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> max_age, __u32 flags)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of <a class="el" href="structobd__ops.html#a3290ce3a9029a8715d49b42778683c7a">obd_ops::o_statfs</a>.  <a href="#ad45ee8814249ae10c9afa9e7fcc73ce6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ab2316ccdd15f9c236b56bdff44b73e73">ofd_obd_disconnect</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disconnect a connected client.  <a href="#ab2316ccdd15f9c236b56bdff44b73e73"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">u64&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a98c3a57bca104c0247e3bf2c9edde525">ofd_seq_last_oid</a> (struct <a class="el" href="structofd__seq.html">ofd_seq</a> *oseq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get last object ID for the given sequence.  <a href="#a98c3a57bca104c0247e3bf2c9edde525"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a53b878498f900554e87c79dd176abe9f">ofd_seq_last_oid_set</a> (struct <a class="el" href="structofd__seq.html">ofd_seq</a> *oseq, u64 id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set new last object ID for the given sequence.  <a href="#a53b878498f900554e87c79dd176abe9f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a0e8216b91fa99c0ef833dc36059f25e9">ofd_seq_last_oid_write</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, struct <a class="el" href="structofd__seq.html">ofd_seq</a> *oseq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update last used OID on disk for the given sequence.  <a href="#a0e8216b91fa99c0ef833dc36059f25e9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a8e0f9a8309ee9b967ccc0f52efaa8a80">ofd_seqs_init</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize SEQ and FLD service on OFD.  <a href="#a8e0f9a8309ee9b967ccc0f52efaa8a80"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structofd__seq.html">ofd_seq</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a6507e38efbceeb8037a85d4a4a7a0e74">ofd_seq_get</a> (struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, u64 seq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get <a class="el" href="structofd__seq.html">ofd_seq</a> for <em>seq</em>.  <a href="#a6507e38efbceeb8037a85d4a4a7a0e74"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a1a85189347d12ff0d970c7a49b5a6331">ofd_seq_put</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__seq.html">ofd_seq</a> *oseq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Drop a reference to <a class="el" href="structofd__seq.html">ofd_seq</a>.  <a href="#a1a85189347d12ff0d970c7a49b5a6331"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a09cb79bda92756a3fff7a04dcf19f75b">ofd_fs_setup</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, struct <a class="el" href="structobd__device.html">obd_device</a> *obd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize storage for the OFD.  <a href="#a09cb79bda92756a3fff7a04dcf19f75b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a289144fa393d3d5eacc6e494dfb3aef6">ofd_fs_cleanup</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cleanup service files on OFD.  <a href="#a289144fa393d3d5eacc6e494dfb3aef6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#aad0ed2371c99ff9007c8963b60bb47d5">ofd_precreate_batch</a> (struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, int batch)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Restrict precreate batch count by its upper limit.  <a href="#aad0ed2371c99ff9007c8963b60bb47d5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structofd__seq.html">ofd_seq</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ad84239bc5d9db54e5bdc961bb89924c0">ofd_seq_load</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, u64 seq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return <a class="el" href="structofd__seq.html">ofd_seq</a> structure filled with valid data.  <a href="#ad84239bc5d9db54e5bdc961bb89924c0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#aaf7ceb2e214dd8f5f7bfb79bfde55294">ofd_seqs_fini</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop FLDB and SEQ services on OFD.  <a href="#aaf7ceb2e214dd8f5f7bfb79bfde55294"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a6ed155b23c822c61f6eacf4eda65d847">ofd_seqs_free</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free sequence structures on OFD.  <a href="#a6ed155b23c822c61f6eacf4eda65d847"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#abad8e9cb4f2bf23b5f26f3fa2064d164">ofd_start_inconsistency_verification_thread</a> (struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start parent FID verification thread.  <a href="#abad8e9cb4f2bf23b5f26f3fa2064d164"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a0aca95140be0eaf4b18bac3e2db396da">ofd_stop_inconsistency_verification_thread</a> (struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop parent FID verification thread.  <a href="#a0aca95140be0eaf4b18bac3e2db396da"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#aea6c312b1e6a241a81a51050dffb8bc5">ofd_verify_ff</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__object.html">ofd_object</a> *fo, struct <a class="el" href="structobdo.html">obdo</a> *oa)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify parent FID of an object.  <a href="#aea6c312b1e6a241a81a51050dffb8bc5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a5e1b48d7cdf4e6ccdc5f00ba323f1ddb">ofd_preprw</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, int <a class="el" href="mdsrate_8c.html#a7353cae57e2530c316ddacb27ef14932">cmd</a>, struct <a class="el" href="structobd__export.html">obd_export</a> *exp, struct <a class="el" href="structobdo.html">obdo</a> *oa, int objcount, struct <a class="el" href="structobd__ioobj.html">obd_ioobj</a> *obj, struct <a class="el" href="structniobuf__remote.html">niobuf_remote</a> *rnb, int *nr_local, struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *lnb)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prepare bulk IO requests for processing.  <a href="#a5e1b48d7cdf4e6ccdc5f00ba323f1ddb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a390d484ba582cfdbd4e5b50466d3a5af">ofd_commitrw</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, int <a class="el" href="mdsrate_8c.html#a7353cae57e2530c316ddacb27ef14932">cmd</a>, struct <a class="el" href="structobd__export.html">obd_export</a> *exp, struct <a class="el" href="structobdo.html">obdo</a> *oa, int objcount, struct <a class="el" href="structobd__ioobj.html">obd_ioobj</a> *obj, struct <a class="el" href="structniobuf__remote.html">niobuf_remote</a> *rnb, int npages, struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *lnb, int old_rc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Commit bulk IO to the storage.  <a href="#a390d484ba582cfdbd4e5b50466d3a5af"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a08d8d088e838713b409b0351fd9f0ebe">ofd_trans_create</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create new transaction in OFD.  <a href="#a08d8d088e838713b409b0351fd9f0ebe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a68e23d460b9e82c290f2c0b8fa08b086">ofd_trans_start</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, struct <a class="el" href="structofd__object.html">ofd_object</a> *fo, struct <a class="el" href="structthandle.html">thandle</a> *th)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start transaction in OFD.  <a href="#a68e23d460b9e82c290f2c0b8fa08b086"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a384bafbc8a5652ed745ac484ba7ceefe">ofd_trans_stop</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, struct <a class="el" href="structthandle.html">thandle</a> *th, int rc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop transaction in OFD.  <a href="#a384bafbc8a5652ed745ac484ba7ceefe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#add3e10a12dc6751ec757027d934ee378">ofd_txn_stop_cb</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structthandle.html">thandle</a> *txn, void *cookie)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#adce0d9126693d57d473e86e92997c061">ofd_stats_counter_init</a> (struct <a class="el" href="structlprocfs__stats.html">lprocfs_stats</a> *stats)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a57ac86f9d9ab8efeac61c1a578175a40">ofd_object_find</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get OFD object by FID.  <a href="#a57ac86f9d9ab8efeac61c1a578175a40"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a717bbfb0c00e765805d251e3cefef3ff">ofd_object_ff_load</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__object.html">ofd_object</a> *fo)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get FID of parent MDT object.  <a href="#a717bbfb0c00e765805d251e3cefef3ff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a996461722e57519b8c0af17df020a387">ofd_precreate_objects</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, u64 id, struct <a class="el" href="structofd__seq.html">ofd_seq</a> *oseq, int nr, int sync)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Precreate the given number <em>nr</em> of objects in the given sequence <em>oseq</em>.  <a href="#a996461722e57519b8c0af17df020a387"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a72400bb0b6ad0127f9056b7d7676ff6d">ofd_object_put</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__object.html">ofd_object</a> *fo)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Put OFD object reference.  <a href="#a72400bb0b6ad0127f9056b7d7676ff6d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a870eac73cb1ba85bca50cf8f1e116973">ofd_attr_set</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__object.html">ofd_object</a> *fo, struct <a class="el" href="structlu__attr.html">lu_attr</a> *la, struct <a class="el" href="structfilter__fid.html">filter_fid</a> *ff)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set OFD object attributes.  <a href="#a870eac73cb1ba85bca50cf8f1e116973"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a7b3f8fb17c1e77da04da0352c11e4fd3">ofd_object_punch</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__object.html">ofd_object</a> *fo, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> <a class="el" href="rename__many_8c.html#ac452537b6646180ccdf7beba12c1b331">start</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> end, struct <a class="el" href="structlu__attr.html">lu_attr</a> *la, struct <a class="el" href="structfilter__fid.html">filter_fid</a> *ff, struct <a class="el" href="structobdo.html">obdo</a> *oa)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Truncate/punch OFD object.  <a href="#a7b3f8fb17c1e77da04da0352c11e4fd3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#aa45de7e119bfb1d96ad8e39b5a2c2346">ofd_object_destroy</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *, struct <a class="el" href="structofd__object.html">ofd_object</a> *, int)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy OFD object.  <a href="#aa45de7e119bfb1d96ad8e39b5a2c2346"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a84d4011f9915ff3ccad468d9c724a81d">ofd_attr_get</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__object.html">ofd_object</a> *fo, struct <a class="el" href="structlu__attr.html">lu_attr</a> *la)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get OFD object attributes.  <a href="#a84d4011f9915ff3ccad468d9c724a81d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ae7dbf73641d2ab238392befa35628d06">ofd_attr_handle_ugid</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__object.html">ofd_object</a> *fo, struct <a class="el" href="structlu__attr.html">lu_attr</a> *la, int is_setattr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fix the OFD object ownership.  <a href="#ae7dbf73641d2ab238392befa35628d06"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a7d7e4e95133f3eaf0679cdafb2b893e7">ofd_object_find_exists</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a42df280ab7f65db40fc65411ade34c9e">ofd_grant_param_supp</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ad6d8a98d588b57a713c71f9f39af420f">ofd_grant_prohibit</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a01e9a616f37fbe4dd804bd6d864cd6e8">ofd_grant_sanity_check</a> (struct <a class="el" href="structobd__device.html">obd_device</a> *obd, const char *func)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Perform extra sanity checks for grant accounting.  <a href="#a01e9a616f37fbe4dd804bd6d864cd6e8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a6d08da2f1b2f2d6e860d2f5c3c557802">ofd_grant_connect</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structobd__export.html">obd_export</a> *exp, struct <a class="el" href="structobd__connect__data.html">obd_connect_data</a> *data, bool new_conn)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle grant space allocation on client connection &amp; reconnection.  <a href="#a6d08da2f1b2f2d6e860d2f5c3c557802"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a9dc214b6b807ee6b502fe0592f4e1f08">ofd_grant_discard</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release all grant space attached to a given export.  <a href="#a9dc214b6b807ee6b502fe0592f4e1f08"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a51b11ecae7477d806a7d3d7c75e1a816">ofd_grant_prepare_read</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structobd__export.html">obd_export</a> *exp, struct <a class="el" href="structobdo.html">obdo</a> *oa)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process grant information from incoming bulk read request.  <a href="#a51b11ecae7477d806a7d3d7c75e1a816"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ad4cabc16c355460895a463ca3d1709f8">ofd_grant_prepare_write</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structobd__export.html">obd_export</a> *exp, struct <a class="el" href="structobdo.html">obdo</a> *oa, struct <a class="el" href="structniobuf__remote.html">niobuf_remote</a> *rnb, int niocount)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process grant information from incoming bulk write request.  <a href="#ad4cabc16c355460895a463ca3d1709f8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ae9b8319ddc8fc509351807815eb2965d">ofd_grant_commit</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp, unsigned long grant_used, int rc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release grant space added to the pending counter by <a class="el" href="ofd__grant_8c.html#ad4cabc16c355460895a463ca3d1709f8" title="Process grant information from incoming bulk write request.">ofd_grant_prepare_write()</a>.  <a href="#ae9b8319ddc8fc509351807815eb2965d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a57d55e594efb1f58600f0e7a226a02a5">ofd_grant_commit_cb_add</a> (struct <a class="el" href="structthandle.html">thandle</a> *th, struct <a class="el" href="structobd__export.html">obd_export</a> *exp, unsigned long grant)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add callback for grant releasing.  <a href="#a57d55e594efb1f58600f0e7a226a02a5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#aa2cd0e80217345bb6e78ac73a8c914d8">ofd_grant_create</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structobd__export.html">obd_export</a> *exp, int *nr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Consume grant space reserved for object creation.  <a href="#aa2cd0e80217345bb6e78ac73a8c914d8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ae6efbe1decaab7a5ad715491cc8112bd">ofd_fmd_init</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize FMD subsystem.  <a href="#ae6efbe1decaab7a5ad715491cc8112bd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ab44b575625aab8199957673f650cdede">ofd_fmd_exit</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop FMD subsystem.  <a href="#ab44b575625aab8199957673f650cdede"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structofd__mod__data.html">ofd_mod_data</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a5c52afc72fe46f15f9fb90ccfda96964">ofd_fmd_find</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find FMD by specified FID with locking.  <a href="#a5c52afc72fe46f15f9fb90ccfda96964"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structofd__mod__data.html">ofd_mod_data</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#aaadfc93c4fff5bf2333b92096bf45cfa">ofd_fmd_get</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find FMD by FID or create a new one if none is found.  <a href="#aaadfc93c4fff5bf2333b92096bf45cfa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a2ff4c339286e71e27dcd8a1138556deb">ofd_fmd_put</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp, struct <a class="el" href="structofd__mod__data.html">ofd_mod_data</a> *fmd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wrapper to drop FMD reference with fed_lock held.  <a href="#a2ff4c339286e71e27dcd8a1138556deb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a514d9002b47398e274c36c1685ca84a1">ofd_fmd_expire</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Expire FMD entries.  <a href="#a514d9002b47398e274c36c1685ca84a1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ae7b039d7de4e39805249623f35fed5cd">ofd_fmd_cleanup</a> (struct <a class="el" href="structobd__export.html">obd_export</a> *exp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove all entries from FMD list.  <a href="#ae7b039d7de4e39805249623f35fed5cd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ab68d4eee40ba72f8a6e311af8e24924f">ofd_fid_set_index</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd, int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a03683c1eafac0ab48333eeb263f06861">ofd_fid_init</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start SEQ/FID server on OFD.  <a href="#a03683c1eafac0ab48333eeb263f06861"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a9e84654f575fdd164e707530a9177c29">ofd_fid_fini</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop SEQ/FID server on OFD.  <a href="#a9e84654f575fdd164e707530a9177c29"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#abe0aad5ebcdfc374de558116d45cbff1">ofd_intent_policy</a> (struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *ns, struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> **lockp, void *req_cookie, enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a> <a class="el" href="mdsrate_8c.html#a000e34997df38c2005a83d63e67d9282">mode</a>, <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a> flags, void *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OFD lock intent policy.  <a href="#abe0aad5ebcdfc374de558116d45cbff1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structofd__thread__info.html">ofd_thread_info</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a55b1ef676b3241957525e2c6db7c7325">ofd_info</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structofd__thread__info.html">ofd_thread_info</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a5e56bc9467dbe869ed8fbdc463269c46">ofd_info_init</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structobd__export.html">obd_export</a> *exp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structofd__thread__info.html">ofd_thread_info</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#ae5479a564cd26fac4d4fcf5b74380883">tsi2ofd_info</a> (struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *tsi)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a40fe40101c0614c64acbde80d766e470">ofd_slc_set</a> (struct <a class="el" href="structofd__device.html">ofd_device</a> *ofd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a5ca68f3e89576e95623a4dfa3303c215">ofd_prepare_fidea</a> (struct <a class="el" href="structfilter__fid.html">filter_fid</a> *ff, const struct <a class="el" href="structobdo.html">obdo</a> *oa)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlu__context__key.html">lu_context_key</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a5715d5d1456c6eabe4053582059eb50f">ofd_thread_key</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structobd__ops.html">obd_ops</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#a6e86af7981400cf59dc30181a66397cb">ofd_obd_ops</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structldlm__valblock__ops.html">ldlm_valblock_ops</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ofd__internal_8h.html#af322483570ead4fcf76f62f40afe5cd8">ofd_lvbo</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a0f816134bb3056fa752be066c9a5fcca"></a><!-- doxytag: member="ofd_internal.h::COMPAT_BSIZE_SHIFT" ref="a0f816134bb3056fa752be066c9a5fcca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPAT_BSIZE_SHIFT&nbsp;&nbsp;&nbsp;12</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00443">443</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>Referenced by <a class="el" href="ofd__grant_8c_source.html#l00095">ofd_grant_deflate()</a>, <a class="el" href="ofd__grant_8c_source.html#l00082">ofd_grant_inflate()</a>, <a class="el" href="ofd__grant_8c_source.html#l00529">ofd_grant_rnb_size()</a>, and <a class="el" href="ofd__obd_8c_source.html#l00806">ofd_statfs()</a>.</p>

</div>
</div>
<a class="anchor" id="ac49791f4ede39fcc281524014f5ccc8b"></a><!-- doxytag: member="ofd_internal.h::ofd_fmd_drop" ref="ac49791f4ede39fcc281524014f5ccc8b" args="(exp, fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ofd_fmd_drop</td>
          <td>(</td>
          <td class="paramtype">exp, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fid&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;do {} while (0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00484">484</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00722">ofd_object_destroy()</a>.</p>

</div>
</div>
<a class="anchor" id="a6a1a69afb670005afeb5c2733283a6cd"></a><!-- doxytag: member="ofd_internal.h::OFD_FMD_MAX_AGE_DEFAULT" ref="a6a1a69afb670005afeb5c2733283a6cd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OFD_FMD_MAX_AGE_DEFAULT&nbsp;&nbsp;&nbsp;msecs_to_jiffies((<a class="el" href="class__obd_8c.html#aa0f9a3f30233340b9fe0b3a3eb300735">obd_timeout</a>+10)*MSEC_PER_SEC)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00068">68</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="a9cd27fbd3f69599be7ed3815fecabca6"></a><!-- doxytag: member="ofd_internal.h::OFD_FMD_MAX_NUM_DEFAULT" ref="a9cd27fbd3f69599be7ed3815fecabca6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OFD_FMD_MAX_NUM_DEFAULT&nbsp;&nbsp;&nbsp;128</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00067">67</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="a83e9c6b976e748cec6206611941db35d"></a><!-- doxytag: member="ofd_internal.h::OFD_INIT_OBJID" ref="a83e9c6b976e748cec6206611941db35d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OFD_INIT_OBJID&nbsp;&nbsp;&nbsp;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00046">46</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>Referenced by <a class="el" href="ofd__fs_8c_source.html#l00362">ofd_seq_load()</a>.</p>

</div>
</div>
<a class="anchor" id="ae2f608bb1acddf7bd154c623a55f4d68"></a><!-- doxytag: member="ofd_internal.h::OFD_PRECREATE_BATCH_DEFAULT" ref="ae2f608bb1acddf7bd154c623a55f4d68" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OFD_PRECREATE_BATCH_DEFAULT&nbsp;&nbsp;&nbsp;(OBJ_SUBDIR_COUNT * 4)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00047">47</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="ac324fa139c6232593840d7a3412edcd1"></a><!-- doxytag: member="ofd_internal.h::OFD_PRECREATE_BATCH_SMALL" ref="ac324fa139c6232593840d7a3412edcd1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OFD_PRECREATE_BATCH_SMALL&nbsp;&nbsp;&nbsp;8</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00052">52</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="a8414c34d94a42f674a910837033fae73"></a><!-- doxytag: member="ofd_internal.h::OFD_PRECREATE_SMALL_FS" ref="a8414c34d94a42f674a910837033fae73" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OFD_PRECREATE_SMALL_FS&nbsp;&nbsp;&nbsp;(1024ULL * 1024 * 1024)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00051">51</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="a74df2d5e0c8225ad33ed721692382381"></a><!-- doxytag: member="ofd_internal.h::OFD_SOFT_SYNC_LIMIT_DEFAULT" ref="a74df2d5e0c8225ad33ed721692382381" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OFD_SOFT_SYNC_LIMIT_DEFAULT&nbsp;&nbsp;&nbsp;16</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00070">70</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="ac901be17f19b08129686f5fb2834e927"></a><!-- doxytag: member="ofd_internal.h::OFD_VALID_FLAGS" ref="ac901be17f19b08129686f5fb2834e927" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OFD_VALID_FLAGS</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">(<a class="code" href="group__lu.html#gga88a0b6df60974746bbc3b1a79da159a8a3152220061a8618dc53d5f4f05dfaf24">LA_TYPE</a> | <a class="code" href="group__lu.html#gga88a0b6df60974746bbc3b1a79da159a8a8f5cb234e67250a996261dce8b13733f">LA_MODE</a> | <a class="code" href="group__lu.html#gga88a0b6df60974746bbc3b1a79da159a8ae810659c3210c116f0912a58ea9dbbc2">LA_SIZE</a> | <a class="code" href="group__lu.html#gga88a0b6df60974746bbc3b1a79da159a8a1ad4509b42b35b7fd4eb9f31dc5d6326">LA_BLOCKS</a> | \
                         <a class="code" href="group__lu.html#gga88a0b6df60974746bbc3b1a79da159a8a46cf336192074e50d2b044d7cbd757e8">LA_BLKSIZE</a> | <a class="code" href="group__lu.html#gga88a0b6df60974746bbc3b1a79da159a8adafe66c6a0d5b07f7fc027f00f7353f5">LA_ATIME</a> | <a class="code" href="group__lu.html#gga88a0b6df60974746bbc3b1a79da159a8a4c6b99fcd67b9469e84ec708a4552326">LA_MTIME</a> | <a class="code" href="group__lu.html#gga88a0b6df60974746bbc3b1a79da159a8abdcd5b62b2bce6b186ec771a412ff10a">LA_CTIME</a>)
</pre></div>
<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00055">55</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>Referenced by <a class="el" href="ofd__io_8c_source.html#l01163">ofd_commitrw()</a>, <a class="el" href="ofd__obd_8c_source.html#l01168">ofd_echo_getattr()</a>, <a class="el" href="ofd__dev_8c_source.html#l01281">ofd_getattr_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01363">ofd_setattr_hdl()</a>, and <a class="el" href="ofd__dev_8c_source.html#l01948">ofd_sync_hdl()</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="af59064efe753e6928fd91539a27503d1"></a><!-- doxytag: member="ofd_internal.h::@137" ref="af59064efe753e6928fd91539a27503d1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1a80991169bbda577b52aad7c456a071fb"></a><!-- doxytag: member="LPROC_OFD_STATS_READ" ref="af59064efe753e6928fd91539a27503d1a80991169bbda577b52aad7c456a071fb" args="" -->LPROC_OFD_STATS_READ</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1a985cd03473089fd60af6b415b3e9df63"></a><!-- doxytag: member="LPROC_OFD_STATS_WRITE" ref="af59064efe753e6928fd91539a27503d1a985cd03473089fd60af6b415b3e9df63" args="" -->LPROC_OFD_STATS_WRITE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1ab92636dadd23f0b7ad828bc51163d8e0"></a><!-- doxytag: member="LPROC_OFD_STATS_GETATTR" ref="af59064efe753e6928fd91539a27503d1ab92636dadd23f0b7ad828bc51163d8e0" args="" -->LPROC_OFD_STATS_GETATTR</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1af799d1d27a025c5dacf7159829b96abe"></a><!-- doxytag: member="LPROC_OFD_STATS_SETATTR" ref="af59064efe753e6928fd91539a27503d1af799d1d27a025c5dacf7159829b96abe" args="" -->LPROC_OFD_STATS_SETATTR</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1a3ef4eefb604dc9ed38973a45b03b17e3"></a><!-- doxytag: member="LPROC_OFD_STATS_PUNCH" ref="af59064efe753e6928fd91539a27503d1a3ef4eefb604dc9ed38973a45b03b17e3" args="" -->LPROC_OFD_STATS_PUNCH</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1a33446192e5a61685358c62e824233346"></a><!-- doxytag: member="LPROC_OFD_STATS_SYNC" ref="af59064efe753e6928fd91539a27503d1a33446192e5a61685358c62e824233346" args="" -->LPROC_OFD_STATS_SYNC</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1a53bbc272f8167d9a41aa2836b9e72edb"></a><!-- doxytag: member="LPROC_OFD_STATS_DESTROY" ref="af59064efe753e6928fd91539a27503d1a53bbc272f8167d9a41aa2836b9e72edb" args="" -->LPROC_OFD_STATS_DESTROY</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1a286d10f3e8a402bf8fe5b88f8c4d48f6"></a><!-- doxytag: member="LPROC_OFD_STATS_CREATE" ref="af59064efe753e6928fd91539a27503d1a286d10f3e8a402bf8fe5b88f8c4d48f6" args="" -->LPROC_OFD_STATS_CREATE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1a0388e3def786ef35ff72f89e1b1306f2"></a><!-- doxytag: member="LPROC_OFD_STATS_STATFS" ref="af59064efe753e6928fd91539a27503d1a0388e3def786ef35ff72f89e1b1306f2" args="" -->LPROC_OFD_STATS_STATFS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1a009c50ad492db3674deffeb95c4b64c6"></a><!-- doxytag: member="LPROC_OFD_STATS_GET_INFO" ref="af59064efe753e6928fd91539a27503d1a009c50ad492db3674deffeb95c4b64c6" args="" -->LPROC_OFD_STATS_GET_INFO</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1a1b05028ed29010a00660556dcd0971f1"></a><!-- doxytag: member="LPROC_OFD_STATS_SET_INFO" ref="af59064efe753e6928fd91539a27503d1a1b05028ed29010a00660556dcd0971f1" args="" -->LPROC_OFD_STATS_SET_INFO</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1a88c5034b60103d3ceeaa2ff6c25168c5"></a><!-- doxytag: member="LPROC_OFD_STATS_QUOTACTL" ref="af59064efe753e6928fd91539a27503d1a88c5034b60103d3ceeaa2ff6c25168c5" args="" -->LPROC_OFD_STATS_QUOTACTL</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af59064efe753e6928fd91539a27503d1ae4579e3facb2acc059ca5d2ef42dfd3c"></a><!-- doxytag: member="LPROC_OFD_STATS_LAST" ref="af59064efe753e6928fd91539a27503d1ae4579e3facb2acc059ca5d2ef42dfd3c" args="" -->LPROC_OFD_STATS_LAST</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00073">73</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa42c5acd9cf2edad9ba7ad5a9aceacac"></a><!-- doxytag: member="ofd_internal.h::fo2dt" ref="aa42c5acd9cf2edad9ba7ad5a9aceacac" args="(struct ofd_object *obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structdt__object.html">dt_object</a>* fo2dt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00238">238</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="ofd__internal_8h_source.html#l00219">ofd_object::ofo_obj</a>.</p>

</div>
</div>
<a class="anchor" id="a84d4011f9915ff3ccad468d9c724a81d"></a><!-- doxytag: member="ofd_internal.h::ofd_attr_get" ref="a84d4011f9915ff3ccad468d9c724a81d" args="(const struct lu_env *env, struct ofd_object *fo, struct lu_attr *la)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_attr_get </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>la</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get OFD object attributes. </p>
<p>This function gets OFD object regular attributes. It is used to serve incoming request as well as for local OFD purposes.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fo</em>&nbsp;</td><td>OFD object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>la</em>&nbsp;</td><td>object attributes</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__objects_8c_source.html#l00778">778</a> of file <a class="el" href="ofd__objects_8c_source.html">ofd_objects.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l02225">dt_attr_get()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>, <a class="el" href="ofd__internal_8h_source.html#l00230">ofd_object_exists()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l01168">ofd_echo_getattr()</a>, <a class="el" href="ofd__dev_8c_source.html#l01281">ofd_getattr_hdl()</a>, <a class="el" href="ofd__lvb_8c_source.html#l00085">ofd_lvbo_init()</a>, <a class="el" href="ofd__lvb_8c_source.html#l00182">ofd_lvbo_update()</a>, and <a class="el" href="ofd__dev_8c_source.html#l01948">ofd_sync_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="ae7dbf73641d2ab238392befa35628d06"></a><!-- doxytag: member="ofd_internal.h::ofd_attr_handle_ugid" ref="ae7dbf73641d2ab238392befa35628d06" args="(const struct lu_env *env, struct ofd_object *fo, struct lu_attr *la, int is_setattr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_attr_handle_ugid </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>la</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>is_setattr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fix the OFD object ownership. </p>
<p>If the object still has SUID+SGID bits set, meaning that it was precreated by the MDT before it was assigned to any file, (see <a class="el" href="ofd__internal_8h.html#a996461722e57519b8c0af17df020a387" title="Precreate the given number nr of objects in the given sequence oseq.">ofd_precreate_objects()</a>) then we will accept the UID+GID if sent by the client for initializing the ownership of this object. We only allow this to happen once (so clear these bits) and later only allow setattr.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fo</em>&nbsp;</td><td>OFD object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>la</em>&nbsp;</td><td>object attributes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>is_setattr</em>&nbsp;</td><td>was this function called from setattr or not</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__objects_8c_source.html#l00434">434</a> of file <a class="el" href="ofd__objects_8c_source.html">ofd_objects.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l02225">dt_attr_get()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="ofd__internal_8h_source.html#l00300">ofd_thread_info::fti_attr2</a>, <a class="el" href="lu__object_8h_source.html#l00450">LA_GID</a>, <a class="el" href="lu__object_8h_source.html#l00419">lu_attr::la_mode</a>, <a class="el" href="lu__object_8h_source.html#l00448">LA_MODE</a>, <a class="el" href="lu__object_8h_source.html#l00449">LA_UID</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>, and <a class="el" href="ofd__io_8c_source.html#l00813">ofd_write_attr_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a870eac73cb1ba85bca50cf8f1e116973"></a><!-- doxytag: member="ofd_internal.h::ofd_attr_set" ref="a870eac73cb1ba85bca50cf8f1e116973" args="(const struct lu_env *env, struct ofd_object *fo, struct lu_attr *la, struct filter_fid *ff)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_attr_set </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>la</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfilter__fid.html">filter_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>ff</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set OFD object attributes. </p>
<p>This function sets OFD object attributes taken from incoming request. It sets not only regular attributes but also XATTR_NAME_FID extended attribute if needed. The "fid" xattr allows the object's MDT parent inode to be found and verified by LFSCK and other tools in case of inconsistency.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fo</em>&nbsp;</td><td>OFD object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>la</em>&nbsp;</td><td>object attributes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ff</em>&nbsp;</td><td><a class="el" href="structfilter__fid.html">filter_fid</a> structure, contains additional attributes</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__objects_8c_source.html#l00491">491</a> of file <a class="el" href="ofd__objects_8c_source.html">ofd_objects.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l02253">dt_attr_set()</a>, <a class="el" href="dt__object_8h_source.html#l02238">dt_declare_attr_set()</a>, <a class="el" href="dt__object_8h_source.html#l02543">dt_declare_xattr_set()</a>, <a class="el" href="dt__object_8h_source.html#l02559">dt_xattr_set()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__user_8h_source.html#l00147">lu_fid::f_oid</a>, <a class="el" href="lustre__user_8h_source.html#l00145">lu_fid::f_seq</a>, <a class="el" href="lustre__user_8h_source.html#l00167">filter_fid::ff_parent</a>, <a class="el" href="ofd__internal_8h_source.html#l00062">ofd_mod_data::fmd_mactime_xid</a>, <a class="el" href="ofd__internal_8h_source.html#l00316">ofd_thread_info::fti_buf</a>, <a class="el" href="ofd__internal_8h_source.html#l00294">ofd_thread_info::fti_exp</a>, <a class="el" href="ofd__internal_8h_source.html#l00295">ofd_thread_info::fti_xid</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00444">LA_ATIME</a>, <a class="el" href="lu__object_8h_source.html#l00446">LA_CTIME</a>, <a class="el" href="lu__object_8h_source.html#l00445">LA_MTIME</a>, <a class="el" href="lu__object_8h_source.html#l00447">LA_SIZE</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="byteorder_8h_source.html#l00056">le32_to_cpu</a>, <a class="el" href="byteorder_8h_source.html#l00058">le64_to_cpu</a>, <a class="el" href="lu__object_8h_source.html#l00525">lu_object_header::loh_fid</a>, <a class="el" href="ofd__objects_8c_source.html#l00434">ofd_attr_handle_ugid()</a>, <a class="el" href="ofd__fmd_8c_source.html#l00228">ofd_fmd_get()</a>, <a class="el" href="ofd__fmd_8c_source.html#l00084">ofd_fmd_put()</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00250">ofd_obj2dev()</a>, <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>, <a class="el" href="ofd__internal_8h_source.html#l00230">ofd_object_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00138">ofd_object_ff_load()</a>, <a class="el" href="ofd__trans_8c_source.html#l00057">ofd_trans_create()</a>, <a class="el" href="ofd__trans_8c_source.html#l00089">ofd_trans_start()</a>, <a class="el" href="ofd__trans_8c_source.html#l00110">ofd_trans_stop()</a>, <a class="el" href="ofd__objects_8c_source.html#l00063">ofd_version_get_check()</a>, <a class="el" href="ofd__internal_8h_source.html#l00271">ofd_write_lock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00279">ofd_write_unlock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00218">ofd_object::ofo_header</a>, <a class="el" href="ofd__internal_8h_source.html#l00220">ofd_object::ofo_pfid</a>, <a class="el" href="rename__many_8c_source.html#l00056">stop</a>, and <a class="el" href="lustre__idl_8h_source.html#l01599">XATTR_NAME_FID</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l00892">ofd_echo_setattr()</a>, and <a class="el" href="ofd__dev_8c_source.html#l01363">ofd_setattr_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="a390d484ba582cfdbd4e5b50466d3a5af"></a><!-- doxytag: member="ofd_internal.h::ofd_commitrw" ref="a390d484ba582cfdbd4e5b50466d3a5af" args="(const struct lu_env *env, int cmd, struct obd_export *exp, struct obdo *oa, int objcount, struct obd_ioobj *obj, struct niobuf_remote *rnb, int npages, struct niobuf_local *lnb, int old_rc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_commitrw </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobdo.html">obdo</a> *&nbsp;</td>
          <td class="paramname"> <em>oa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>objcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__ioobj.html">obd_ioobj</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__remote.html">niobuf_remote</a> *&nbsp;</td>
          <td class="paramname"> <em>rnb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>npages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *&nbsp;</td>
          <td class="paramname"> <em>lnb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>old_rc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Commit bulk IO to the storage. </p>
<p>This is companion function to the <a class="el" href="ofd__internal_8h.html#a5e1b48d7cdf4e6ccdc5f00ba323f1ddb" title="Prepare bulk IO requests for processing.">ofd_preprw()</a>. It finishes bulk IO request processing by committing buffers to the storage (WRITE) and/or freeing those buffers (read/write). See <a class="el" href="ofd__io_8c.html#a726260e44939ea9ba9f68887cde3cdfe" title="Drop reference on local buffers for read bulk IO.">ofd_commitrw_read()</a> and <a class="el" href="ofd__io_8c.html#a1e84a4a9ee850e6cf2bb06643e7f77ad" title="Commit bulk IO buffers to the storage.">ofd_commitrw_write()</a> for details about each type of IO.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cmd</em>&nbsp;</td><td>IO type (READ/WRITE) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>OBD export of client </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oa</em>&nbsp;</td><td>OBDO structure from client </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>objcount</em>&nbsp;</td><td>always 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>obj</em>&nbsp;</td><td>object data </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rnb</em>&nbsp;</td><td>remote buffers </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>npages</em>&nbsp;</td><td>number of local buffers </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lnb</em>&nbsp;</td><td>local buffers </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>old_rc</em>&nbsp;</td><td>result of processing at this point</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on successful commit </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__io_8c_source.html#l01163">1163</a> of file <a class="el" href="ofd__io_8c_source.html">ofd_io.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="ofd__internal_8h_source.html#l00062">ofd_mod_data::fmd_mactime_xid</a>, <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="ofd__internal_8h_source.html#l00303">ofd_thread_info::fti_mds_fid</a>, <a class="el" href="ofd__internal_8h_source.html#l00301">ofd_thread_info::fti_resid</a>, <a class="el" href="ofd__internal_8h_source.html#l00295">ofd_thread_info::fti_xid</a>, <a class="el" href="linux-obdo_8c_source.html#l00103">la_from_obdo()</a>, <a class="el" href="lu__object_8h_source.html#l00450">LA_GID</a>, <a class="el" href="lu__object_8h_source.html#l00449">LA_UID</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="packet-lustre_8c_source.html#l00299">LDLM_EXTENT</a>, <a class="el" href="lustre__dlm_8h_source.html#l01296">ldlm_res_lvbo_update()</a>, <a class="el" href="ldlm__resource_8c_source.html#l01179">ldlm_resource_get()</a>, <a class="el" href="ldlm__resource_8c_source.html#l01295">ldlm_resource_putref()</a>, <a class="el" href="structldlm__valblock__ops.html#a2a67bc2634b21d63b85e93494b74a067">ldlm_valblock_ops::lvbo_update</a>, <a class="el" href="lustre__dlm_8h_source.html#l00452">ldlm_namespace::ns_lvbo</a>, <a class="el" href="lustre__idl_8h_source.html#l03398">obdo::o_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l03384">obdo::o_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l01761">OBD_BRW_OVER_GRPQUOTA</a>, <a class="el" href="lustre__idl_8h_source.html#l01760">OBD_BRW_OVER_USRQUOTA</a>, <a class="el" href="lustre__idl_8h_source.html#l01746">OBD_BRW_READ</a>, <a class="el" href="lustre__idl_8h_source.html#l01747">OBD_BRW_WRITE</a>, <a class="el" href="lustre__idl_8h_source.html#l01433">OBD_FL_NO_GRPQUOTA</a>, <a class="el" href="lustre__idl_8h_source.html#l01432">OBD_FL_NO_USRQUOTA</a>, <a class="el" href="lustre__idl_8h_source.html#l01657">OBD_MD_FLATIME</a>, <a class="el" href="lustre__idl_8h_source.html#l01659">OBD_MD_FLCTIME</a>, <a class="el" href="lustre__idl_8h_source.html#l01680">OBD_MD_FLFID</a>, <a class="el" href="lustre__idl_8h_source.html#l01667">OBD_MD_FLFLAGS</a>, <a class="el" href="lustre__idl_8h_source.html#l01666">OBD_MD_FLGID</a>, <a class="el" href="lustre__idl_8h_source.html#l01686">OBD_MD_FLGRPQUOTA</a>, <a class="el" href="lustre__idl_8h_source.html#l01658">OBD_MD_FLMTIME</a>, <a class="el" href="lustre__idl_8h_source.html#l01665">OBD_MD_FLUID</a>, <a class="el" href="lustre__idl_8h_source.html#l01685">OBD_MD_FLUSRQUOTA</a>, <a class="el" href="linux-obdo_8c_source.html#l00052">obdo_from_la()</a>, <a class="el" href="ofd__io_8c_source.html#l00772">ofd_commitrw_read()</a>, <a class="el" href="ofd__io_8c_source.html#l01009">ofd_commitrw_write()</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__fmd_8c_source.html#l00199">ofd_fmd_find()</a>, <a class="el" href="ofd__fmd_8c_source.html#l00084">ofd_fmd_put()</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00122">ofd_device::ofd_namespace</a>, <a class="el" href="ofd__internal_8h_source.html#l00562">ofd_prepare_fidea()</a>, <a class="el" href="ofd__internal_8h_source.html#l00055">OFD_VALID_FLAGS</a>, <a class="el" href="lustre__user_8h_source.html#l00219">ost_id::oi_fid</a>, <a class="el" href="lustre__fid_8h_source.html#l00652">ost_fid_build_resid()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

</div>
</div>
<a class="anchor" id="a61757442bd0cc0ec16bb3f720ada527b"></a><!-- doxytag: member="ofd_internal.h::ofd_counter_incr" ref="a61757442bd0cc0ec16bb3f720ada527b" args="(struct obd_export *exp, int opcode, char *jobid, long amount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_counter_incr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>opcode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>jobid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>amount</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00089">89</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="lustre__export_8h_source.html#l00304">exp_connect_flags()</a>, <a class="el" href="lustre__export_8h_source.html#l00215">obd_export::exp_nid_stats</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="lprocfs__status_8h_source.html#l00866">lprocfs_counter_add()</a>, <a class="el" href="lprocfs__status_8h_source.html#l01059">lprocfs_job_stats_log()</a>, <a class="el" href="lustre__export_8h_source.html#l00138">nid_stat::nid_stats</a>, <a class="el" href="lustre__idl_8h_source.html#l01225">OBD_CONNECT_JOBSTATS</a>, <a class="el" href="obd_8h_source.html#l00706">obd_device::obd_stats</a>, and <a class="el" href="structobd__device.html#aebe227afed9945c803b5bda6794bb729">obd_device::u</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01825">ofd_destroy_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l00892">ofd_echo_setattr()</a>, <a class="el" href="ofd__dev_8c_source.html#l01136">ofd_get_info_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01281">ofd_getattr_hdl()</a>, <a class="el" href="ofd__io_8c_source.html#l00440">ofd_preprw_read()</a>, <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>, <a class="el" href="ofd__dev_8c_source.html#l02007">ofd_punch_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l02210">ofd_quotactl()</a>, <a class="el" href="ofd__dev_8c_source.html#l00897">ofd_set_info_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01363">ofd_setattr_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01913">ofd_statfs_hdl()</a>, and <a class="el" href="ofd__dev_8c_source.html#l01948">ofd_sync_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="a4ca35902254971b1607e297996aab7eb"></a><!-- doxytag: member="ofd_internal.h::ofd_destroy_by_fid" ref="a4ca35902254971b1607e297996aab7eb" args="(const struct lu_env *env, struct ofd_device *ofd, const struct lu_fid *fid, int orphan)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_destroy_by_fid </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>orphan</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destroy OFD object by its FID. </p>
<p>Supplemental function to destroy object by FID, it is used by request handler and by <a class="el" href="ofd__obd_8c.html#a3d11697b4834f5cb58389ecb01d8933d" title="Implementation of obd_ops::o_destroy.">ofd_echo_destroy()</a> below to find object by FID, lock it and call <a class="el" href="ofd__internal_8h.html#aa45de7e119bfb1d96ad8e39b5a2c2346" title="Destroy OFD object.">ofd_object_destroy()</a> finally.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>orphan</em>&nbsp;</td><td>set if object being destroyed is an orphan</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__obd_8c_source.html#l00984">984</a> of file <a class="el" href="ofd__obd_8c_source.html">ofd_obd.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="lustre__dlm_8h_source.html#l00074">ELDLM_OK</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="ofd__internal_8h_source.html#l00301">ofd_thread_info::fti_resid</a>, <a class="el" href="lustre__dlm_8h_source.html#l00633">ldlm_policy_data::l_extent</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="packet-lustre_8c_source.html#l00292">LCK_PW</a>, <a class="el" href="ldlm__request_8c_source.html#l00354">ldlm_blocking_ast()</a>, <a class="el" href="ldlm__request_8c_source.html#l00415">ldlm_cli_enqueue_local()</a>, <a class="el" href="ldlm__request_8c_source.html#l00230">ldlm_completion_ast()</a>, <a class="el" href="packet-lustre_8c_source.html#l00299">LDLM_EXTENT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00151">LDLM_FL_AST_DISCARD_DATA</a>, <a class="el" href="ldlm__lock_8c_source.html#l00903">ldlm_lock_decref()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00646">LVB_T_NONE</a>, <a class="el" href="lustre__idl_8h_source.html#l01767">OBD_OBJECT_EOF</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00122">ofd_device::ofd_namespace</a>, <a class="el" href="ofd__objects_8c_source.html#l00722">ofd_object_destroy()</a>, <a class="el" href="ofd__internal_8h_source.html#l00420">ofd_object_find_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00174">ofd_object_put()</a>, <a class="el" href="lustre__fid_8h_source.html#l00652">ost_fid_build_resid()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01825">ofd_destroy_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l01038">ofd_echo_destroy()</a>, and <a class="el" href="ofd__dev_8c_source.html#l01461">ofd_orphans_destroy()</a>.</p>

</div>
</div>
<a class="anchor" id="acf2d317977364c79c44f66e6feba0e78"></a><!-- doxytag: member="ofd_internal.h::ofd_dev" ref="acf2d317977364c79c44f66e6feba0e78" args="(struct lu_device *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structofd__device.html">ofd_device</a>* ofd_dev </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlu__device.html">lu_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00197">197</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, and <a class="el" href="ofd__internal_8h_source.html#l00117">ofd_device::ofd_dt_dev</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l03028">ofd_device_fini()</a>, <a class="el" href="ofd__dev_8c_source.html#l03046">ofd_device_free()</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__grant_8c_source.html#l00147">ofd_grant_sanity_check()</a>, <a class="el" href="ofd__obd_8c_source.html#l01420">ofd_health_check()</a>, <a class="el" href="ofd__obd_8c_source.html#l00340">ofd_obd_connect()</a>, <a class="el" href="ofd__obd_8c_source.html#l00573">ofd_obd_postrecov()</a>, <a class="el" href="ofd__obd_8c_source.html#l00295">ofd_obd_reconnect()</a>, <a class="el" href="ofd__internal_8h_source.html#l00250">ofd_obj2dev()</a>, <a class="el" href="ofd__dev_8c_source.html#l00403">ofd_object_init()</a>, <a class="el" href="ofd__dev_8c_source.html#l00576">ofd_prepare()</a>, <a class="el" href="ofd__dev_8c_source.html#l00319">ofd_process_config()</a>, and <a class="el" href="ofd__dev_8c_source.html#l00634">ofd_recovery_complete()</a>.</p>

</div>
</div>
<a class="anchor" id="a663fe6f0f85a398de889d88c635020fd"></a><!-- doxytag: member="ofd_internal.h::ofd_exp" ref="a663fe6f0f85a398de889d88c635020fd" args="(struct obd_export *exp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structofd__device.html">ofd_device</a>* ofd_exp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00207">207</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="obd_8h_source.html#l00595">obd_device::obd_lu_dev</a>, and <a class="el" href="ofd__internal_8h_source.html#l00197">ofd_dev()</a>.</p>

<p>Referenced by <a class="el" href="ofd__io_8c_source.html#l01163">ofd_commitrw()</a>, <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l00492">ofd_destroy_export()</a>, <a class="el" href="ofd__dev_8c_source.html#l01825">ofd_destroy_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l01084">ofd_echo_create()</a>, <a class="el" href="ofd__obd_8c_source.html#l01038">ofd_echo_destroy()</a>, <a class="el" href="ofd__obd_8c_source.html#l01168">ofd_echo_getattr()</a>, <a class="el" href="ofd__obd_8c_source.html#l00892">ofd_echo_setattr()</a>, <a class="el" href="ofd__fmd_8c_source.html#l00111">ofd_fmd_expire_nolock()</a>, <a class="el" href="ofd__fmd_8c_source.html#l00162">ofd_fmd_find_nolock()</a>, <a class="el" href="ofd__fmd_8c_source.html#l00228">ofd_fmd_get()</a>, <a class="el" href="ofd__obd_8c_source.html#l00651">ofd_get_info()</a>, <a class="el" href="ofd__dev_8c_source.html#l01136">ofd_get_info_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01281">ofd_getattr_hdl()</a>, <a class="el" href="ofd__grant_8c_source.html#l00778">ofd_grant_alloc()</a>, <a class="el" href="ofd__grant_8c_source.html#l00591">ofd_grant_check()</a>, <a class="el" href="ofd__grant_8c_source.html#l01264">ofd_grant_commit()</a>, <a class="el" href="ofd__grant_8c_source.html#l00868">ofd_grant_connect()</a>, <a class="el" href="ofd__grant_8c_source.html#l01172">ofd_grant_create()</a>, <a class="el" href="ofd__grant_8c_source.html#l00947">ofd_grant_discard()</a>, <a class="el" href="ofd__grant_8c_source.html#l00393">ofd_grant_incoming()</a>, <a class="el" href="ofd__grant_8c_source.html#l00988">ofd_grant_prepare_read()</a>, <a class="el" href="ofd__grant_8c_source.html#l01068">ofd_grant_prepare_write()</a>, <a class="el" href="ofd__grant_8c_source.html#l00483">ofd_grant_shrink()</a>, <a class="el" href="ofd__grant_8c_source.html#l00330">ofd_grant_space_left()</a>, <a class="el" href="ofd__grant_8c_source.html#l00290">ofd_grant_statfs()</a>, <a class="el" href="ofd__obd_8c_source.html#l01293">ofd_iocontrol()</a>, <a class="el" href="ofd__dev_8c_source.html#l02118">ofd_ladvise_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l00411">ofd_obd_disconnect()</a>, <a class="el" href="ofd__obd_8c_source.html#l00137">ofd_parse_connect_data()</a>, <a class="el" href="ofd__io_8c_source.html#l00685">ofd_preprw()</a>, <a class="el" href="ofd__dev_8c_source.html#l02007">ofd_punch_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01363">ofd_setattr_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l00806">ofd_statfs()</a>, and <a class="el" href="ofd__dev_8c_source.html#l01948">ofd_sync_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="a9e84654f575fdd164e707530a9177c29"></a><!-- doxytag: member="ofd_internal.h::ofd_fid_fini" ref="a9e84654f575fdd164e707530a9177c29" args="(const struct lu_env *env, struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_fid_fini </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stop SEQ/FID server on OFD. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00802">802</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="ofd__internal_8h_source.html#l00186">ofd_device::ofd_seq_site</a>, and <a class="el" href="fid__handler_8c_source.html#l00603">seq_site_fini()</a>.</p>

<p>Referenced by <a class="el" href="ofd__fs_8c_source.html#l00332">ofd_seqs_fini()</a>, and <a class="el" href="ofd__fs_8c_source.html#l00572">ofd_seqs_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a03683c1eafac0ab48333eeb263f06861"></a><!-- doxytag: member="ofd_internal.h::ofd_fid_init" ref="a03683c1eafac0ab48333eeb263f06861" args="(const struct lu_env *env, struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_fid_init </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start SEQ/FID server on OFD. </p>
<p>The SEQ/FID server on OFD is needed to allocate FIDs for new objects. It also connects to the master server to get own FID sequence (SEQ) range to this particular OFD. Typically that happens when the OST is first formatted or in the rare case that it exhausts the local sequence range.</p>
<p>The sequence range is allocated out to the MDTs for OST object allocations, and not directly to the clients.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00824">824</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00645">lu_site::ld_seq_site</a>, <a class="el" href="lu__object_8h_source.html#l00283">lu_device::ld_site</a>, <a class="el" href="lustre__disk_8h_source.html#l00344">lr_server_data::lsd_osd_index</a>, <a class="el" href="lustre__idl_8h_source.html#l00156">lu_seq_range::lsr_index</a>, <a class="el" href="lustre__fid_8h_source.html#l00395">lu_server_seq::lss_space</a>, <a class="el" href="lustre__fid_8h_source.html#l00340">LUSTRE_SEQ_DATA</a>, <a class="el" href="lustre__fid_8h_source.html#l00344">LUSTRE_SEQ_SERVER</a>, <a class="el" href="lu__target_8h_source.html#l00144">lu_target::lut_lsd</a>, <a class="el" href="mdt__coordinator_8c_source.html#l01693">name</a>, <a class="el" href="obd__support_8h_source.html#l00708">OBD_ALLOC</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00776">OBD_FREE</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="ofd__internal_8h_source.html#l00117">ofd_device::ofd_dt_dev</a>, <a class="el" href="ofd__internal_8h_source.html#l00125">ofd_device::ofd_lut</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__internal_8h_source.html#l00186">ofd_device::ofd_seq_site</a>, <a class="el" href="fid__request_8c_source.html#l00506">seq_client_fini()</a>, <a class="el" href="fid__request_8c_source.html#l00468">seq_client_init()</a>, <a class="el" href="fid__handler_8c_source.html#l00591">seq_server_fini()</a>, <a class="el" href="fid__handler_8c_source.html#l00501">seq_server_init()</a>, <a class="el" href="fid__handler_8c_source.html#l00058">seq_server_set_cli()</a>, <a class="el" href="lustre__fid_8h_source.html#l00475">seq_server_site::ss_client_seq</a>, <a class="el" href="lustre__fid_8h_source.html#l00450">seq_server_site::ss_lu</a>, <a class="el" href="lustre__fid_8h_source.html#l00454">seq_server_site::ss_node_id</a>, and <a class="el" href="lustre__fid_8h_source.html#l00464">seq_server_site::ss_server_seq</a>.</p>

<p>Referenced by <a class="el" href="ofd__fs_8c_source.html#l00572">ofd_seqs_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ab68d4eee40ba72f8a6e311af8e24924f"></a><!-- doxytag: member="ofd_internal.h::ofd_fid_set_index" ref="ab68d4eee40ba72f8a6e311af8e24924f" args="(const struct lu_env *env, struct ofd_device *ofd, int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_fid_set_index </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad493a8cc1ef417f7c163d365cd3135ed"></a><!-- doxytag: member="ofd_internal.h::ofd_fiemap_get" ref="ad493a8cc1ef417f7c163d365cd3135ed" args="(const struct lu_env *env, struct ofd_device *ofd, struct lu_fid *fid, struct fiemap *fiemap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_fiemap_get </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct fiemap *&nbsp;</td>
          <td class="paramname"> <em>fiemap</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get FIEMAP (FIle Extent MAPping) for object with the given FID. </p>
<p>This function returns a list of extents which describes how a file's blocks are laid out on the disk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fiemap</em>&nbsp;</td><td>fiemap structure to fill with data</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if <em>fiemap</em> is filled with data successfully </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l00973">973</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="dt__object_8h_source.html#l02426">dt_fiemap_get()</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>, <a class="el" href="ofd__internal_8h_source.html#l00230">ofd_object_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00102">ofd_object_find()</a>, <a class="el" href="ofd__objects_8c_source.html#l00174">ofd_object_put()</a>, <a class="el" href="ofd__internal_8h_source.html#l00255">ofd_read_lock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00263">ofd_read_unlock()</a>, and <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l00651">ofd_get_info()</a>, and <a class="el" href="ofd__dev_8c_source.html#l01136">ofd_get_info_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="ae7b039d7de4e39805249623f35fed5cd"></a><!-- doxytag: member="ofd_internal.h::ofd_fmd_cleanup" ref="ae7b039d7de4e39805249623f35fed5cd" args="(struct obd_export *exp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_fmd_cleanup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Remove all entries from FMD list. </p>
<p>Cleanup function to free all FMD enries on the given export.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>OBD export </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fmd_8c_source.html#l00300">300</a> of file <a class="el" href="ofd__fmd_8c_source.html">ofd_fmd.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00135">D_INFO</a>, <a class="el" href="lustre__export_8h_source.html#l00109">filter_export_data::fed_lock</a>, <a class="el" href="lustre__export_8h_source.html#l00113">filter_export_data::fed_mod_list</a>, <a class="el" href="ofd__internal_8h_source.html#l00060">ofd_mod_data::fmd_list</a>, <a class="el" href="ofd__internal_8h_source.html#l00064">ofd_mod_data::fmd_refcount</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00484">list_for_each_entry_safe</a>, and <a class="el" href="ofd__fmd_8c_source.html#l00063">ofd_fmd_put_nolock()</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l00492">ofd_destroy_export()</a>.</p>

</div>
</div>
<a class="anchor" id="ab44b575625aab8199957673f650cdede"></a><!-- doxytag: member="ofd_internal.h::ofd_fmd_exit" ref="ab44b575625aab8199957673f650cdede" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_fmd_exit </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stop FMD subsystem. </p>
<p>This function is called upon OFD cleanup and destroy memory used by FMD entries. </p>

<p>Definition at line <a class="el" href="ofd__fmd_8c_source.html#l00340">340</a> of file <a class="el" href="ofd__fmd_8c_source.html">ofd_fmd.c</a>.</p>

<p>References <a class="el" href="ofd__fmd_8c_source.html#l00053">ll_fmd_cachep</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l03148">ofd_exit()</a>.</p>

</div>
</div>
<a class="anchor" id="a514d9002b47398e274c36c1685ca84a1"></a><!-- doxytag: member="ofd_internal.h::ofd_fmd_expire" ref="a514d9002b47398e274c36c1685ca84a1" args="(struct obd_export *exp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_fmd_expire </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Expire FMD entries. </p>
<p>This is a wrapper to call <a class="el" href="ofd__fmd_8c.html#a7c3604ccb1133f4f5b3f6dc6a44a96f5" title="Expire FMD entries.">ofd_fmd_expire_nolock()</a> with the required lock.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>OBD export </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fmd_8c_source.html#l00140">140</a> of file <a class="el" href="ofd__fmd_8c_source.html">ofd_fmd.c</a>.</p>

<p>References <a class="el" href="lustre__export_8h_source.html#l00109">filter_export_data::fed_lock</a>, and <a class="el" href="ofd__fmd_8c_source.html#l00111">ofd_fmd_expire_nolock()</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l01396">ofd_ping()</a>.</p>

</div>
</div>
<a class="anchor" id="a5c52afc72fe46f15f9fb90ccfda96964"></a><!-- doxytag: member="ofd_internal.h::ofd_fmd_find" ref="a5c52afc72fe46f15f9fb90ccfda96964" args="(struct obd_export *exp, const struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structofd__mod__data.html">ofd_mod_data</a>* ofd_fmd_find </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Find FMD by specified FID with locking. </p>
<p>Wrapper to the <a class="el" href="ofd__fmd_8c.html#a0f6ee7a2220c7bbf9bade1e81cfdaf21" title="Find FMD by specified FID.">ofd_fmd_find_nolock()</a> with correct locks.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>OBD export </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of FMD to find</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>struct</em>&nbsp;</td><td><a class="el" href="structofd__mod__data.html">ofd_mod_data</a> found by FID </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NULL</em>&nbsp;</td><td>indicates FMD is not found </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fmd_8c_source.html#l00199">199</a> of file <a class="el" href="ofd__fmd_8c_source.html">ofd_fmd.c</a>.</p>

<p>References <a class="el" href="lustre__export_8h_source.html#l00109">filter_export_data::fed_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00064">ofd_mod_data::fmd_refcount</a>, and <a class="el" href="ofd__fmd_8c_source.html#l00162">ofd_fmd_find_nolock()</a>.</p>

<p>Referenced by <a class="el" href="ofd__io_8c_source.html#l01163">ofd_commitrw()</a>.</p>

</div>
</div>
<a class="anchor" id="aaadfc93c4fff5bf2333b92096bf45cfa"></a><!-- doxytag: member="ofd_internal.h::ofd_fmd_get" ref="aaadfc93c4fff5bf2333b92096bf45cfa" args="(struct obd_export *exp, const struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structofd__mod__data.html">ofd_mod_data</a>* ofd_fmd_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Find FMD by FID or create a new one if none is found. </p>
<p>It is possible for this function to return NULL under memory pressure, or if the passed FID is zero (which will only cause old entries to expire). Currently this is not fatal because any FMD state is transient and may also be freed when it gets sufficiently old.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>OBD export </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of FMD to find</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>struct</em>&nbsp;</td><td><a class="el" href="structofd__mod__data.html">ofd_mod_data</a> found by FID </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NULL</em>&nbsp;</td><td>indicates FMD is not found </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fmd_8c_source.html#l00228">228</a> of file <a class="el" href="ofd__fmd_8c_source.html">ofd_fmd.c</a>.</p>

<p>References <a class="el" href="libcfs__time_8h_source.html#l00046">cfs_time_add()</a>, <a class="el" href="linux-time_8h_source.html#l00152">cfs_time_current()</a>, <a class="el" href="lustre__export_8h_source.html#l00109">filter_export_data::fed_lock</a>, <a class="el" href="lustre__export_8h_source.html#l00118">filter_export_data::fed_mod_count</a>, <a class="el" href="lustre__export_8h_source.html#l00113">filter_export_data::fed_mod_list</a>, <a class="el" href="ofd__internal_8h_source.html#l00063">ofd_mod_data::fmd_expire</a>, <a class="el" href="ofd__internal_8h_source.html#l00064">ofd_mod_data::fmd_refcount</a>, <a class="el" href="list_8h_source.html#l00090">list_add_tail()</a>, <a class="el" href="ofd__fmd_8c_source.html#l00053">ll_fmd_cachep</a>, <a class="el" href="createmany_8c_source.html#l00069">now()</a>, <a class="el" href="obd__support_8h_source.html#l00845">OBD_SLAB_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00857">OBD_SLAB_FREE_PTR</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__fmd_8c_source.html#l00162">ofd_fmd_find_nolock()</a>, and <a class="el" href="ofd__internal_8h_source.html#l00172">ofd_device::ofd_fmd_max_age</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, and <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>.</p>

</div>
</div>
<a class="anchor" id="ae6efbe1decaab7a5ad715491cc8112bd"></a><!-- doxytag: member="ofd_internal.h::ofd_fmd_init" ref="ae6efbe1decaab7a5ad715491cc8112bd" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_fmd_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize FMD subsystem. </p>
<p>This function is called upon OFD setup and initialize memory to be used by FMD entries. </p>

<p>Definition at line <a class="el" href="ofd__fmd_8c_source.html#l00323">323</a> of file <a class="el" href="ofd__fmd_8c_source.html">ofd_fmd.c</a>.</p>

<p>References <a class="el" href="ofd__fmd_8c_source.html#l00053">ll_fmd_cachep</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l03123">ofd_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a2ff4c339286e71e27dcd8a1138556deb"></a><!-- doxytag: member="ofd_internal.h::ofd_fmd_put" ref="a2ff4c339286e71e27dcd8a1138556deb" args="(struct obd_export *exp, struct ofd_mod_data *fmd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_fmd_put </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__mod__data.html">ofd_mod_data</a> *&nbsp;</td>
          <td class="paramname"> <em>fmd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Wrapper to drop FMD reference with fed_lock held. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>OBD export </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fmd</em>&nbsp;</td><td>FMD to put </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fmd_8c_source.html#l00084">84</a> of file <a class="el" href="ofd__fmd_8c_source.html">ofd_fmd.c</a>.</p>

<p>References <a class="el" href="lustre__export_8h_source.html#l00109">filter_export_data::fed_lock</a>, and <a class="el" href="ofd__fmd_8c_source.html#l00063">ofd_fmd_put_nolock()</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__io_8c_source.html#l01163">ofd_commitrw()</a>, and <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>.</p>

</div>
</div>
<a class="anchor" id="a289144fa393d3d5eacc6e494dfb3aef6"></a><!-- doxytag: member="ofd_internal.h::ofd_fs_cleanup" ref="a289144fa393d3d5eacc6e494dfb3aef6" args="(const struct lu_env *env, struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_fs_cleanup </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Cleanup service files on OFD. </p>
<p>This function syncs whole OFD device and close "health check" file.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fs_8c_source.html#l00666">666</a> of file <a class="el" href="ofd__fs_8c_source.html">ofd_fs.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="dt__object_8h_source.html#l02465">dt_sync()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lu__object_8c_source.html#l00097">lu_object_put()</a>, <a class="el" href="ofd__internal_8h_source.html#l00126">ofd_device::ofd_health_check_file</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, and <a class="el" href="ofd__fs_8c_source.html#l00332">ofd_seqs_fini()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02983">ofd_fini()</a>, and <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="a09cb79bda92756a3fff7a04dcf19f75b"></a><!-- doxytag: member="ofd_internal.h::ofd_fs_setup" ref="a09cb79bda92756a3fff7a04dcf19f75b" args="(const struct lu_env *env, struct ofd_device *ofd, struct obd_device *obd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_fs_setup </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__device.html">obd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>obd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize storage for the OFD. </p>
<p>This function sets up service files for OFD. Currently, the only service file is "health_check".</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>obd</em>&nbsp;</td><td>OBD device (unused now)</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on successful setup </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fs_8c_source.html#l00621">621</a> of file <a class="el" href="ofd__fs_8c_source.html">ofd_fs.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l00396">dt_object_format::dof_type</a>, <a class="el" href="dt__object_8c_source.html#l00388">dt_find_or_create()</a>, <a class="el" href="dt__object_8c_source.html#l00192">dt_mode_to_dft()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="ofd__internal_8h_source.html#l00315">ofd_thread_info::fti_dof</a>, <a class="el" href="ofd__internal_8h_source.html#l00298">ofd_thread_info::fti_fid</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00419">lu_attr::la_mode</a>, <a class="el" href="lu__object_8h_source.html#l00448">LA_MODE</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="lustre__fid_8h_source.html#l00242">lu_local_obj_fid()</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00212">OBD_FAIL_MDS_FS_SETUP</a>, <a class="el" href="ofd__internal_8h_source.html#l00126">ofd_device::ofd_health_check_file</a>, <a class="el" href="lustre__fid_8h_source.html#l00232">OFD_HEALTH_CHECK_OID</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__fs_8c_source.html#l00332">ofd_seqs_fini()</a>, <a class="el" href="ofd__fs_8c_source.html#l00572">ofd_seqs_init()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="ae9b8319ddc8fc509351807815eb2965d"></a><!-- doxytag: member="ofd_internal.h::ofd_grant_commit" ref="ae9b8319ddc8fc509351807815eb2965d" args="(struct obd_export *exp, unsigned long grant_used, int rc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_grant_commit </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>pending</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Release grant space added to the pending counter by <a class="el" href="ofd__grant_8c.html#ad4cabc16c355460895a463ca3d1709f8" title="Process grant information from incoming bulk write request.">ofd_grant_prepare_write()</a>. </p>
<p>Update pending grant counter once buffers have been written to the disk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>export of the client which sent the request </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pending</em>&nbsp;</td><td>amount of reserved space to be released </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rc</em>&nbsp;</td><td>return code of pre-commit operations </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__grant_8c_source.html#l01264">1264</a> of file <a class="el" href="ofd__grant_8c_source.html">ofd_grant.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__export_8h_source.html#l00193">obd_export::exp_client_uuid</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="osc__internal_8h_source.html#l00177">min_t</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="ofd__internal_8h_source.html#l00143">ofd_device::ofd_blockbits</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__internal_8h_source.html#l00157">ofd_device::ofd_grant_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00141">ofd_device::ofd_osfs</a>, <a class="el" href="ofd__internal_8h_source.html#l00153">ofd_device::ofd_osfs_inflight</a>, <a class="el" href="ofd__internal_8h_source.html#l00139">ofd_device::ofd_osfs_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00150">ofd_device::ofd_statfs_inflight</a>, <a class="el" href="ofd__internal_8h_source.html#l00161">ofd_device::ofd_tot_granted</a>, <a class="el" href="ofd__internal_8h_source.html#l00163">ofd_device::ofd_tot_pending</a>, <a class="el" href="lustre__user_8h_source.html#l00111">obd_statfs::os_bavail</a>, <a class="el" href="libcfs__debug_8h_source.html#l00358">RETURN_EXIT</a>, and <a class="el" href="lustre__user_8h_source.html#l00492">obd_uuid::uuid</a>.</p>

<p>Referenced by <a class="el" href="ofd__io_8c_source.html#l01009">ofd_commitrw_write()</a>, <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l01084">ofd_echo_create()</a>, <a class="el" href="ofd__grant_8c_source.html#l01345">ofd_grant_commit_cb()</a>, and <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a57d55e594efb1f58600f0e7a226a02a5"></a><!-- doxytag: member="ofd_internal.h::ofd_grant_commit_cb_add" ref="a57d55e594efb1f58600f0e7a226a02a5" args="(struct thandle *th, struct obd_export *exp, unsigned long grant)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_grant_commit_cb_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>granted</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add callback for grant releasing. </p>
<p>Register a commit callback to release grant space.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>transaction handle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>OBD export of client </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>granted</em>&nbsp;</td><td>amount of grant space to be released upon commit</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on successful callback adding </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__grant_8c_source.html#l01369">1369</a> of file <a class="el" href="ofd__grant_8c_source.html">ofd_grant.c</a>.</p>

<p>References <a class="el" href="obd__class_8h_source.html#l00273">class_export_cb_get</a>, <a class="el" href="obd__class_8h_source.html#l00281">class_export_cb_put</a>, <a class="el" href="dt__object_8h_source.html#l00110">dt_txn_commit_cb::dcb_func</a>, <a class="el" href="dt__object_8h_source.html#l00109">dt_txn_commit_cb::dcb_linkage</a>, <a class="el" href="dt__object_8h_source.html#l00114">dt_txn_commit_cb::dcb_name</a>, <a class="el" href="dt__object_8h_source.html#l02077">dt_trans_cb_add()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="ofd__grant_8c_source.html#l01345">ofd_grant_commit_cb()</a>, <a class="el" href="ofd__grant_8c_source.html#l01328">ofd_grant_cb::ogc_cb</a>, <a class="el" href="ofd__grant_8c_source.html#l01330">ofd_grant_cb::ogc_exp</a>, <a class="el" href="ofd__grant_8c_source.html#l01332">ofd_grant_cb::ogc_granted</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="string_8c_source.html#l00058">strlcpy()</a>.</p>

<p>Referenced by <a class="el" href="ofd__io_8c_source.html#l01009">ofd_commitrw_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a6d08da2f1b2f2d6e860d2f5c3c557802"></a><!-- doxytag: member="ofd_internal.h::ofd_grant_connect" ref="a6d08da2f1b2f2d6e860d2f5c3c557802" args="(const struct lu_env *env, struct obd_export *exp, struct obd_connect_data *data, bool new_conn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_grant_connect </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__connect__data.html">obd_connect_data</a> *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>new_conn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handle grant space allocation on client connection &amp; reconnection. </p>
<p>A new non-readonly connection gets an initial grant allocation equals to <a class="el" href="ofd__grant_8c.html#a7faa8aa15e5a34def92bf0d6b3c49d08">ofd_grant_chunk()</a> (i.e. twice the max BRW size in most of the cases). On reconnection, grant counters between client &amp; OST are resynchronized and additional space might be granted back if possible.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>LU environment provided by the caller </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>client's export which is (re)connecting </td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td><a class="el" href="structobd__connect__data.html">obd_connect_data</a> structure sent by the client in the connect request </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>new_conn</em>&nbsp;</td><td>must set to true if this is a new connection and false for a reconnection </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__grant_8c_source.html#l00868">868</a> of file <a class="el" href="ofd__grant_8c_source.html">ofd_grant.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00134">D_CACHE</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__export_8h_source.html#l00193">obd_export::exp_client_uuid</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="lustre__export_8h_source.html#l00111">filter_export_data::fed_dirty</a>, <a class="el" href="lustre__export_8h_source.html#l00112">filter_export_data::fed_grant</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="lustre__idl_8h_source.html#l01182">OBD_CONNECT_GRANT</a>, <a class="el" href="lustre__idl_8h_source.html#l01229">OBD_CONNECT_GRANT_PARAM</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="lustre__idl_8h_source.html#l01336">obd_connect_data::ocd_connect_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l01338">obd_connect_data::ocd_grant</a>, <a class="el" href="lustre__idl_8h_source.html#l01268">OCD_HAS_FLAG</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__grant_8c_source.html#l00778">ofd_grant_alloc()</a>, <a class="el" href="ofd__grant_8c_source.html#l00106">ofd_grant_chunk()</a>, <a class="el" href="ofd__internal_8h_source.html#l00175">ofd_device::ofd_grant_compat_disable</a>, <a class="el" href="ofd__grant_8c_source.html#l00095">ofd_grant_deflate()</a>, <a class="el" href="ofd__grant_8c_source.html#l00082">ofd_grant_inflate()</a>, <a class="el" href="ofd__internal_8h_source.html#l00157">ofd_device::ofd_grant_lock</a>, <a class="el" href="ofd__grant_8c_source.html#l00330">ofd_grant_space_left()</a>, <a class="el" href="ofd__grant_8c_source.html#l00290">ofd_grant_statfs()</a>, <a class="el" href="ofd__internal_8h_source.html#l00159">ofd_device::ofd_tot_dirty</a>, <a class="el" href="ofd__internal_8h_source.html#l00165">ofd_device::ofd_tot_granted_clients</a>, <a class="el" href="libcfs__debug_8h_source.html#l00358">RETURN_EXIT</a>, and <a class="el" href="lustre__user_8h_source.html#l00492">obd_uuid::uuid</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l00137">ofd_parse_connect_data()</a>, and <a class="el" href="ofd__dev_8c_source.html#l00634">ofd_recovery_complete()</a>.</p>

</div>
</div>
<a class="anchor" id="aa2cd0e80217345bb6e78ac73a8c914d8"></a><!-- doxytag: member="ofd_internal.h::ofd_grant_create" ref="aa2cd0e80217345bb6e78ac73a8c914d8" args="(const struct lu_env *env, struct obd_export *exp, int *nr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long ofd_grant_create </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>nr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Consume grant space reserved for object creation. </p>
<p>Grant space is allocated to the local self export for object precreation. This is required to prevent object precreation from consuming grant space allocated to client nodes for the data writeback cache. This function consumes enough space to create <em>nr</em> objects and allocates more grant space to the self export for future precreation requests, if possible.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>LU environment provided by the caller </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>export holding the grant space for precreation (= self export currently) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nr</em>&nbsp;</td><td>number of objects to be created</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>&gt;=</em>&nbsp;</td><td>0 amount of grant space allocated to the precreate request </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-ENOSPC</em>&nbsp;</td><td>on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__grant_8c_source.html#l01172">1172</a> of file <a class="el" href="ofd__grant_8c_source.html">ofd_grant.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00149">D_RPCTRACE</a>, <a class="el" href="dt__object_8h_source.html#l00086">dt_device_param::ddp_inodespace</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="lustre__export_8h_source.html#l00112">filter_export_data::fed_grant</a>, <a class="el" href="lustre__export_8h_source.html#l00114">filter_export_data::fed_pending</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_recovering</a>, <a class="el" href="ofd__internal_8h_source.html#l00143">ofd_device::ofd_blockbits</a>, <a class="el" href="ofd__internal_8h_source.html#l00120">ofd_device::ofd_dt_conf</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__grant_8c_source.html#l00778">ofd_grant_alloc()</a>, <a class="el" href="ofd__grant_8c_source.html#l00106">ofd_grant_chunk()</a>, <a class="el" href="ofd__internal_8h_source.html#l00157">ofd_device::ofd_grant_lock</a>, <a class="el" href="ofd__grant_8c_source.html#l00330">ofd_grant_space_left()</a>, <a class="el" href="ofd__grant_8c_source.html#l00290">ofd_grant_statfs()</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00141">ofd_device::ofd_osfs</a>, <a class="el" href="ofd__internal_8h_source.html#l00161">ofd_device::ofd_tot_granted</a>, <a class="el" href="ofd__internal_8h_source.html#l00163">ofd_device::ofd_tot_pending</a>, <a class="el" href="lustre__user_8h_source.html#l00111">obd_statfs::os_bavail</a>, <a class="el" href="lustre__user_8h_source.html#l00109">obd_statfs::os_blocks</a>, <a class="el" href="lustre__idl_8h_source.html#l01770">OST_MAX_PRECREATE</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, and <a class="el" href="ofd__obd_8c_source.html#l01084">ofd_echo_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a9dc214b6b807ee6b502fe0592f4e1f08"></a><!-- doxytag: member="ofd_internal.h::ofd_grant_discard" ref="a9dc214b6b807ee6b502fe0592f4e1f08" args="(struct obd_export *exp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_grant_discard </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Release all grant space attached to a given export. </p>
<p>Remove a client from the grant accounting totals. We also remove the export from the obd device under the osfs and dev locks to ensure that the <a class="el" href="ofd__grant_8c.html#a01e9a616f37fbe4dd804bd6d864cd6e8" title="Perform extra sanity checks for grant accounting.">ofd_grant_sanity_check()</a> calculations are always valid. The client should do something similar when it invalidates its import.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>client's export to remove from grant accounting </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__grant_8c_source.html#l00947">947</a> of file <a class="el" href="ofd__grant_8c_source.html">ofd_grant.c</a>.</p>

<p>References <a class="el" href="lustre__export_8h_source.html#l00193">obd_export::exp_client_uuid</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="lustre__export_8h_source.html#l00111">filter_export_data::fed_dirty</a>, <a class="el" href="lustre__export_8h_source.html#l00112">filter_export_data::fed_grant</a>, <a class="el" href="lustre__export_8h_source.html#l00114">filter_export_data::fed_pending</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00045">LASSERTF</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__internal_8h_source.html#l00157">ofd_device::ofd_grant_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00159">ofd_device::ofd_tot_dirty</a>, <a class="el" href="ofd__internal_8h_source.html#l00161">ofd_device::ofd_tot_granted</a>, <a class="el" href="ofd__internal_8h_source.html#l00163">ofd_device::ofd_tot_pending</a>, and <a class="el" href="lustre__user_8h_source.html#l00492">obd_uuid::uuid</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l00492">ofd_destroy_export()</a>, and <a class="el" href="ofd__obd_8c_source.html#l00411">ofd_obd_disconnect()</a>.</p>

</div>
</div>
<a class="anchor" id="a42df280ab7f65db40fc65411ade34c9e"></a><!-- doxytag: member="ofd_internal.h::ofd_grant_param_supp" ref="a42df280ab7f65db40fc65411ade34c9e" args="(struct obd_export *exp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_grant_param_supp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00435">435</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="lustre__export_8h_source.html#l00304">exp_connect_flags()</a>, and <a class="el" href="lustre__idl_8h_source.html#l01229">OBD_CONNECT_GRANT_PARAM</a>.</p>

<p>Referenced by <a class="el" href="ofd__grant_8c_source.html#l00591">ofd_grant_check()</a>, <a class="el" href="ofd__grant_8c_source.html#l00106">ofd_grant_chunk()</a>, <a class="el" href="ofd__grant_8c_source.html#l00393">ofd_grant_incoming()</a>, <a class="el" href="ofd__grant_8c_source.html#l00988">ofd_grant_prepare_read()</a>, <a class="el" href="ofd__grant_8c_source.html#l01068">ofd_grant_prepare_write()</a>, <a class="el" href="ofd__internal_8h_source.html#l00445">ofd_grant_prohibit()</a>, <a class="el" href="ofd__grant_8c_source.html#l00529">ofd_grant_rnb_size()</a>, and <a class="el" href="ofd__obd_8c_source.html#l00806">ofd_statfs()</a>.</p>

</div>
</div>
<a class="anchor" id="a51b11ecae7477d806a7d3d7c75e1a816"></a><!-- doxytag: member="ofd_internal.h::ofd_grant_prepare_read" ref="a51b11ecae7477d806a7d3d7c75e1a816" args="(const struct lu_env *env, struct obd_export *exp, struct obdo *oa)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_grant_prepare_read </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobdo.html">obdo</a> *&nbsp;</td>
          <td class="paramname"> <em>oa</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process grant information from incoming bulk read request. </p>
<p>Extract grant information packed in <a class="el" href="structobdo.html">obdo</a> structure (OBD_MD_FLGRANT set in o_valid). Bulk reads usually comes with grant announcements (number of dirty blocks, remaining amount of grant space, ...) and could also include a grant shrink request. Unlike bulk write, no additional grant space is returned on bulk read request.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>is the lu environment provided by the caller </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>is the export of the client which sent the request </td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>oa</em>&nbsp;</td><td>is the incoming <a class="el" href="structobdo.html">obdo</a> sent by the client </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__grant_8c_source.html#l00988">988</a> of file <a class="el" href="ofd__grant_8c_source.html">ofd_grant.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__idl_8h_source.html#l03398">obdo::o_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l03391">obdo::o_grant</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l01441">OBD_FL_SHRINK_GRANT</a>, <a class="el" href="lustre__idl_8h_source.html#l01667">OBD_MD_FLFLAGS</a>, <a class="el" href="lustre__idl_8h_source.html#l01683">OBD_MD_FLGRANT</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__grant_8c_source.html#l00106">ofd_grant_chunk()</a>, <a class="el" href="ofd__grant_8c_source.html#l00095">ofd_grant_deflate()</a>, <a class="el" href="ofd__grant_8c_source.html#l00393">ofd_grant_incoming()</a>, <a class="el" href="ofd__internal_8h_source.html#l00157">ofd_device::ofd_grant_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00435">ofd_grant_param_supp()</a>, <a class="el" href="ofd__grant_8c_source.html#l00483">ofd_grant_shrink()</a>, <a class="el" href="ofd__grant_8c_source.html#l00330">ofd_grant_space_left()</a>, <a class="el" href="ofd__grant_8c_source.html#l00290">ofd_grant_statfs()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00358">RETURN_EXIT</a>.</p>

<p>Referenced by <a class="el" href="ofd__io_8c_source.html#l00685">ofd_preprw()</a>, <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>, and <a class="el" href="ofd__dev_8c_source.html#l00897">ofd_set_info_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="ad4cabc16c355460895a463ca3d1709f8"></a><!-- doxytag: member="ofd_internal.h::ofd_grant_prepare_write" ref="ad4cabc16c355460895a463ca3d1709f8" args="(const struct lu_env *env, struct obd_export *exp, struct obdo *oa, struct niobuf_remote *rnb, int niocount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_grant_prepare_write </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobdo.html">obdo</a> *&nbsp;</td>
          <td class="paramname"> <em>oa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__remote.html">niobuf_remote</a> *&nbsp;</td>
          <td class="paramname"> <em>rnb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>niocount</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process grant information from incoming bulk write request. </p>
<p>This function extracts client's grant announcements from incoming bulk write request and attempts to allocate grant space for <a class="el" href="structnetwork.html">network</a> buffers that need it (i.e. OBD_BRW_FROM_GRANT not set in rnb_fags). Network buffers which aren't granted the OBD_BRW_GRANTED flag should not proceed further and should fail with -ENOSPC. Whenever possible, additional grant space will be returned to the client in the bulk write reply. <a class="el" href="ofd__grant_8c.html#ad4cabc16c355460895a463ca3d1709f8" title="Process grant information from incoming bulk write request.">ofd_grant_prepare_write()</a> must be called before writting any buffers to the backend storage. This function works in pair with <a class="el" href="ofd__grant_8c.html#a7ea6cee2b1147f98d0ac30b1ef6068c1" title="Release grant space added to the pending counter by ofd_grant_prepare_write().">ofd_grant_commit()</a> which must be invoked once all buffers have been written to disk in order to release space from the pending grant counter.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>LU environment provided by the caller </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>export of the client which sent the request </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oa</em>&nbsp;</td><td>incoming <a class="el" href="structobdo.html">obdo</a> sent by the client </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rnb</em>&nbsp;</td><td>list of <a class="el" href="structnetwork.html">network</a> buffers </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>niocount</em>&nbsp;</td><td>number of <a class="el" href="structnetwork.html">network</a> buffers in the list </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__grant_8c_source.html#l01068">1068</a> of file <a class="el" href="ofd__grant_8c_source.html">ofd_grant.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00134">D_CACHE</a>, <a class="el" href="dt__object_8h_source.html#l02465">dt_sync()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="lustre__idl_8h_source.html#l03398">obdo::o_flags</a>, <a class="el" href="lustre__idl_8h_source.html#l03391">obdo::o_grant</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l01753">OBD_BRW_FROM_GRANT</a>, <a class="el" href="lustre__idl_8h_source.html#l01441">OBD_FL_SHRINK_GRANT</a>, <a class="el" href="lustre__idl_8h_source.html#l01667">OBD_MD_FLFLAGS</a>, <a class="el" href="lustre__idl_8h_source.html#l01683">OBD_MD_FLGRANT</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_recovering</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__grant_8c_source.html#l00778">ofd_grant_alloc()</a>, <a class="el" href="ofd__grant_8c_source.html#l00591">ofd_grant_check()</a>, <a class="el" href="ofd__grant_8c_source.html#l00106">ofd_grant_chunk()</a>, <a class="el" href="ofd__grant_8c_source.html#l00095">ofd_grant_deflate()</a>, <a class="el" href="ofd__grant_8c_source.html#l00393">ofd_grant_incoming()</a>, <a class="el" href="ofd__internal_8h_source.html#l00157">ofd_device::ofd_grant_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00435">ofd_grant_param_supp()</a>, <a class="el" href="ofd__grant_8c_source.html#l00483">ofd_grant_shrink()</a>, <a class="el" href="ofd__grant_8c_source.html#l00330">ofd_grant_space_left()</a>, <a class="el" href="ofd__grant_8c_source.html#l00290">ofd_grant_statfs()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00358">RETURN_EXIT</a>.</p>

<p>Referenced by <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>.</p>

</div>
</div>
<a class="anchor" id="ad6d8a98d588b57a713c71f9f39af420f"></a><!-- doxytag: member="ofd_internal.h::ofd_grant_prohibit" ref="ad6d8a98d588b57a713c71f9f39af420f" args="(struct obd_export *exp, struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_grant_prohibit </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00445">445</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="obd_8h_source.html#l00655">obd_device::obd_self_export</a>, <a class="el" href="ofd__internal_8h_source.html#l00175">ofd_device::ofd_grant_compat_disable</a>, <a class="el" href="ofd__internal_8h_source.html#l00435">ofd_grant_param_supp()</a>, and <a class="el" href="ofd__internal_8h_source.html#l00202">ofd_obd()</a>.</p>

<p>Referenced by <a class="el" href="ofd__grant_8c_source.html#l00778">ofd_grant_alloc()</a>.</p>

</div>
</div>
<a class="anchor" id="a01e9a616f37fbe4dd804bd6d864cd6e8"></a><!-- doxytag: member="ofd_internal.h::ofd_grant_sanity_check" ref="a01e9a616f37fbe4dd804bd6d864cd6e8" args="(struct obd_device *obd, const char *func)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_grant_sanity_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__device.html">obd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>obd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>func</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Perform extra sanity checks for grant accounting. </p>
<p>This function scans the export list, sanity checks per-export grant counters and verifies accuracy of global grant accounting. If an inconsistency is found, a CERROR is printed with the function name  that was passed as argument. LBUG is only called in case of serious counter corruption (i.e. value larger than the device size). Those sanity checks can be pretty expensive and are disabled if the OBD device has more than 100 connected exports.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>obd</em>&nbsp;</td><td>OBD device for which grant accounting should be verified </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>func</em>&nbsp;</td><td>caller's function name </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__grant_8c_source.html#l00147">147</a> of file <a class="el" href="ofd__grant_8c_source.html">ofd_grant.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00266">CDEBUG_LIMIT</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00134">D_CACHE</a>, <a class="el" href="libcfs__debug_8h_source.html#l00146">D_ERROR</a>, <a class="el" href="it__test_8c_source.html#l00055">error</a>, <a class="el" href="lustre__export_8h_source.html#l00193">obd_export::exp_client_uuid</a>, <a class="el" href="lustre__export_8h_source.html#l00195">obd_export::exp_obd_chain</a>, <a class="el" href="lustre__export_8h_source.html#l00111">filter_export_data::fed_dirty</a>, <a class="el" href="lustre__export_8h_source.html#l00112">filter_export_data::fed_grant</a>, <a class="el" href="lustre__export_8h_source.html#l00114">filter_export_data::fed_pending</a>, <a class="el" href="libcfs__private_8h_source.html#l00281">LBUG</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="list_8h_source.html#l00459">list_for_each_entry</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="obd_8h_source.html#l00644">obd_device::obd_dev_lock</a>, <a class="el" href="obd_8h_source.html#l00634">obd_device::obd_exports</a>, <a class="el" href="obd_8h_source.html#l00595">obd_device::obd_lu_dev</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="obd_8h_source.html#l00639">obd_device::obd_num_exports</a>, <a class="el" href="obd_8h_source.html#l00655">obd_device::obd_self_export</a>, <a class="el" href="obd_8h_source.html#l00635">obd_device::obd_unlinked_exports</a>, <a class="el" href="ofd__internal_8h_source.html#l00143">ofd_device::ofd_blockbits</a>, <a class="el" href="ofd__internal_8h_source.html#l00197">ofd_dev()</a>, <a class="el" href="ofd__internal_8h_source.html#l00157">ofd_device::ofd_grant_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00141">ofd_device::ofd_osfs</a>, <a class="el" href="ofd__internal_8h_source.html#l00159">ofd_device::ofd_tot_dirty</a>, <a class="el" href="ofd__internal_8h_source.html#l00161">ofd_device::ofd_tot_granted</a>, <a class="el" href="ofd__internal_8h_source.html#l00163">ofd_device::ofd_tot_pending</a>, <a class="el" href="lustre__user_8h_source.html#l00109">obd_statfs::os_blocks</a>, and <a class="el" href="lustre__user_8h_source.html#l00492">obd_uuid::uuid</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l00492">ofd_destroy_export()</a>, <a class="el" href="ofd__obd_8c_source.html#l00411">ofd_obd_disconnect()</a>, and <a class="el" href="ofd__obd_8c_source.html#l00806">ofd_statfs()</a>.</p>

</div>
</div>
<a class="anchor" id="a55b1ef676b3241957525e2c6db7c7325"></a><!-- doxytag: member="ofd_internal.h::ofd_info" ref="a55b1ef676b3241957525e2c6db7c7325" args="(const struct lu_env *env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structofd__thread__info.html">ofd_thread_info</a>* ofd_info </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00501">501</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8c_source.html#l01574">lu_context_key_get()</a>, <a class="el" href="lu__object_8c_source.html#l01889">lu_env_refill()</a>, and <a class="el" href="ofd__dev_8c_source.html#l02792">ofd_thread_key</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00434">ofd_attr_handle_ugid()</a>, <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__io_8c_source.html#l01163">ofd_commitrw()</a>, <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l00984">ofd_destroy_by_fid()</a>, <a class="el" href="ofd__fs_8c_source.html#l00621">ofd_fs_setup()</a>, <a class="el" href="ofd__grant_8c_source.html#l00591">ofd_grant_check()</a>, <a class="el" href="ofd__grant_8c_source.html#l00290">ofd_grant_statfs()</a>, <a class="el" href="ofd__internal_8h_source.html#l00511">ofd_info_init()</a>, <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>, <a class="el" href="ofd__objects_8c_source.html#l00722">ofd_object_destroy()</a>, <a class="el" href="ofd__objects_8c_source.html#l00138">ofd_object_ff_load()</a>, <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>, <a class="el" href="ofd__dev_8c_source.html#l01461">ofd_orphans_destroy()</a>, <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>, <a class="el" href="ofd__dev_8c_source.html#l00634">ofd_recovery_complete()</a>, <a class="el" href="ofd__fs_8c_source.html#l00204">ofd_seq_last_oid_write()</a>, <a class="el" href="ofd__fs_8c_source.html#l00362">ofd_seq_load()</a>, <a class="el" href="ofd__dev_8c_source.html#l00163">ofd_stack_init()</a>, <a class="el" href="ofd__trans_8c_source.html#l00057">ofd_trans_create()</a>, <a class="el" href="ofd__io_8c_source.html#l00813">ofd_write_attr_set()</a>, and <a class="el" href="ofd__internal_8h_source.html#l00527">tsi2ofd_info()</a>.</p>

</div>
</div>
<a class="anchor" id="a5e56bc9467dbe869ed8fbdc463269c46"></a><!-- doxytag: member="ofd_internal.h::ofd_info_init" ref="a5e56bc9467dbe869ed8fbdc463269c46" args="(const struct lu_env *env, struct obd_export *exp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structofd__thread__info.html">ofd_thread_info</a>* ofd_info_init </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00511">511</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="ofd__internal_8h_source.html#l00292">ofd_thread_info::fti_env</a>, <a class="el" href="ofd__internal_8h_source.html#l00294">ofd_thread_info::fti_exp</a>, <a class="el" href="ofd__internal_8h_source.html#l00296">ofd_thread_info::fti_pre_version</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, and <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l01084">ofd_echo_create()</a>, <a class="el" href="ofd__obd_8c_source.html#l01038">ofd_echo_destroy()</a>, <a class="el" href="ofd__obd_8c_source.html#l01168">ofd_echo_getattr()</a>, <a class="el" href="ofd__obd_8c_source.html#l00892">ofd_echo_setattr()</a>, <a class="el" href="ofd__obd_8c_source.html#l00651">ofd_get_info()</a>, <a class="el" href="ofd__obd_8c_source.html#l01420">ofd_health_check()</a>, <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>, <a class="el" href="ofd__dev_8c_source.html#l02118">ofd_ladvise_hdl()</a>, <a class="el" href="ofd__lvb_8c_source.html#l00085">ofd_lvbo_init()</a>, <a class="el" href="ofd__lvb_8c_source.html#l00182">ofd_lvbo_update()</a>, <a class="el" href="ofd__obd_8c_source.html#l00573">ofd_obd_postrecov()</a>, <a class="el" href="ofd__dev_8c_source.html#l00576">ofd_prepare()</a>, and <a class="el" href="ofd__io_8c_source.html#l00685">ofd_preprw()</a>.</p>

</div>
</div>
<a class="anchor" id="abe0aad5ebcdfc374de558116d45cbff1"></a><!-- doxytag: member="ofd_internal.h::ofd_intent_policy" ref="abe0aad5ebcdfc374de558116d45cbff1" args="(struct ldlm_namespace *ns, struct ldlm_lock **lockp, void *req_cookie, enum ldlm_mode mode, __u64 flags, void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_intent_policy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structldlm__namespace.html">ldlm_namespace</a> *&nbsp;</td>
          <td class="paramname"> <em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structldlm__lock.html">ldlm_lock</a> **&nbsp;</td>
          <td class="paramname"> <em>lockp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>req_cookie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__lustreidl.html#ga78e7c1d7ad283002413a597e75aa7441">ldlm_mode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OFD lock intent policy. </p>
<p>This defines <a class="el" href="structldlm__namespace.html#a926bc3bad4997f595bdde4644119dac2" title="&quot;policy&quot; function that does actual lock conflict determination">ldlm_namespace::ns_policy</a> interface for OFD. Intent policy is called when lock has an intent, for OFD that means glimpse lock and policy fills Lock Value Block (LVB).</p>
<p>If already granted lock is found it will be placed in <em>lockp</em> and returned back to caller function.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ns</em>&nbsp;</td><td>namespace </td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>lockp</em>&nbsp;</td><td>pointer to the lock </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>req_cookie</em>&nbsp;</td><td>incoming request </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mode</em>&nbsp;</td><td>LDLM mode </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>flags</em>&nbsp;</td><td>LDLM flags </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>opaque data, not used in OFD policy</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ELDLM_LOCK_REPLACED</em>&nbsp;</td><td>if already granted lock was found and placed in <em>lockp</em> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ELDLM_LOCK_ABORTED</em>&nbsp;</td><td>in other cases except error </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__dlm_8c_source.html#l00129">129</a> of file <a class="el" href="ofd__dlm_8c_source.html">ofd_dlm.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="lustre__dlm_8h_source.html#l01556">check_res_locked()</a>, <a class="el" href="lustre__idl_8h_source.html#l01140">DLM_LOCKREPLY_OFF</a>, <a class="el" href="lustre__idl_8h_source.html#l01141">DLM_REPLY_REC_OFF</a>, <a class="el" href="lustre__dlm_8h_source.html#l00078">ELDLM_LOCK_ABORTED</a>, <a class="el" href="lustre__dlm_8h_source.html#l00079">ELDLM_LOCK_REPLACED</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__export_8h_source.html#l00245">obd_export::exp_libclient</a>, <a class="el" href="lustre__dlm_8h_source.html#l00583">ldlm_glimpse_work::gl_desc</a>, <a class="el" href="lustre__dlm_8h_source.html#l00582">ldlm_glimpse_work::gl_flags</a>, <a class="el" href="lustre__dlm_8h_source.html#l00581">ldlm_glimpse_work::gl_list</a>, <a class="el" href="lustre__dlm_8h_source.html#l00580">ldlm_glimpse_work::gl_lock</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="interval__tree_8c_source.html#l00207">interval_iterate_reverse()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00754">ldlm_lock::l_export</a>, <a class="el" href="lustre__dlm_8h_source.html#l00812">ldlm_lock::l_lvb_type</a>, <a class="el" href="lustre__dlm_8h_source.html#l00694">ldlm_lock::l_resource</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__idl_8h_source.html#l02809">LCK_MODE_NUM</a>, <a class="el" href="packet-lustre_8c_source.html#l00293">LCK_PR</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00108">LDLM_FL_BLOCK_NOWAIT</a>, <a class="el" href="lustre__dlm__flags_8h_source.html#l00355">LDLM_FL_RESENT</a>, <a class="el" href="lustre__dlm_8h_source.html#l00588">LDLM_GL_WORK_NOFREE</a>, <a class="el" href="lustre__dlm_8h_source.html#l01180">LDLM_ITER_CONTINUE</a>, <a class="el" href="lustre__dlm_8h_source.html#l01344">LDLM_LOCK_GET</a>, <a class="el" href="lustre__dlm_8h_source.html#l01338">LDLM_LOCK_RELEASE</a>, <a class="el" href="lustre__dlm_8h_source.html#l01296">ldlm_res_lvbo_update()</a>, <a class="el" href="lustre__dlm_8h_source.html#l01000">ldlm_res_to_ns()</a>, <a class="el" href="ldlm__resource_8c_source.html#l01366">ldlm_resource_unlink_lock()</a>, <a class="el" href="ofd__dlm_8c_source.html#l00050">ofd_intent_args::liblustre</a>, <a class="el" href="list_8h_source.html#l00090">list_add_tail()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00607">ldlm_interval_tree::lit_mode</a>, <a class="el" href="lustre__dlm_8h_source.html#l00608">ldlm_interval_tree::lit_root</a>, <a class="el" href="lustre__idl_8h_source.html#l02929">ldlm_reply::lock_policy_res1</a>, <a class="el" href="lustre__dlm_8h_source.html#l01537">lock_res()</a>, <a class="el" href="lustre__dlm_8h_source.html#l00956">ldlm_resource::lr_itree</a>, <a class="el" href="lustre__dlm_8h_source.html#l00979">ldlm_resource::lr_lvb_data</a>, <a class="el" href="pack__generic_8c_source.html#l00436">lustre_msg_buf()</a>, <a class="el" href="pack__generic_8c_source.html#l00401">lustre_pack_reply()</a>, <a class="el" href="lustre__idl_8h_source.html#l01816">ost_lvb::lvb_size</a>, <a class="el" href="lustre__dlm_8h_source.html#l00647">LVB_T_OST</a>, <a class="el" href="lustre__idl_8h_source.html#l01125">MSG_PTLRPC_BODY_OFF</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00354">OBD_FAIL_LDLM_AGL_DELAY</a>, <a class="el" href="obd__support_8h_source.html#l00355">OBD_FAIL_LDLM_AGL_NOLOCK</a>, <a class="el" href="obd__support_8h_source.html#l00343">OBD_FAIL_LDLM_GLIMPSE</a>, <a class="el" href="obd__support_8h_source.html#l00624">OBD_FAIL_TIMEOUT</a>, <a class="el" href="ofd__dlm_8c_source.html#l00069">ofd_intent_cb()</a>, <a class="el" href="lustre__idl_8h_source.html#l01092">ptlrpc_body</a>, <a class="el" href="lustre__net_8h_source.html#l02395">ptlrpc_status_hton()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lustre__net_8h_source.html#l01032">ptlrpc_request::rq_repmsg</a>, <a class="el" href="lustre__net_8h_source.html#l00957">ptlrpc_request::rq_status</a>, <a class="el" href="ofd__dlm_8c_source.html#l00049">ofd_intent_args::size</a>, <a class="el" href="lustre__dlm_8h_source.html#l01550">unlock_res()</a>, and <a class="el" href="ofd__dlm_8c_source.html#l00048">ofd_intent_args::victim</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="a087f286e42ffa0e2530decea9b9b658e"></a><!-- doxytag: member="ofd_internal.h::ofd_name" ref="a087f286e42ffa0e2530decea9b9b658e" args="(struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* ofd_name </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00212">212</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="lu__object_8h_source.html#l00287">lu_device::ld_obd</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, and <a class="el" href="ofd__internal_8h_source.html#l00117">ofd_device::ofd_dt_dev</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l00110">ofd_connect_to_next()</a>, <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01825">ofd_destroy_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l01084">ofd_echo_create()</a>, <a class="el" href="ofd__obd_8c_source.html#l01038">ofd_echo_destroy()</a>, <a class="el" href="ofd__obd_8c_source.html#l00892">ofd_echo_setattr()</a>, <a class="el" href="ofd__dev_8c_source.html#l00824">ofd_fid_init()</a>, <a class="el" href="ofd__dev_8c_source.html#l00973">ofd_fiemap_get()</a>, <a class="el" href="ofd__fs_8c_source.html#l00666">ofd_fs_cleanup()</a>, <a class="el" href="ofd__obd_8c_source.html#l00651">ofd_get_info()</a>, <a class="el" href="ofd__dev_8c_source.html#l01136">ofd_get_info_hdl()</a>, <a class="el" href="ofd__grant_8c_source.html#l01172">ofd_grant_create()</a>, <a class="el" href="ofd__io_8c_source.html#l00065">ofd_inconsistency_verify_one()</a>, <a class="el" href="ofd__dev_8c_source.html#l00528">ofd_lfsck_out_notify()</a>, <a class="el" href="ofd__lvb_8c_source.html#l00182">ofd_lvbo_update()</a>, <a class="el" href="ofd__dev_8c_source.html#l01461">ofd_orphans_destroy()</a>, <a class="el" href="ofd__obd_8c_source.html#l00541">ofd_postrecov()</a>, <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>, <a class="el" href="ofd__io_8c_source.html#l00685">ofd_preprw()</a>, <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>, <a class="el" href="ofd__fs_8c_source.html#l00483">ofd_register_lwp_callback()</a>, <a class="el" href="ofd__fs_8c_source.html#l00527">ofd_register_seq_exp()</a>, <a class="el" href="ofd__fs_8c_source.html#l00204">ofd_seq_last_oid_write()</a>, <a class="el" href="ofd__fs_8c_source.html#l00362">ofd_seq_load()</a>, <a class="el" href="ofd__fs_8c_source.html#l00332">ofd_seqs_fini()</a>, <a class="el" href="ofd__fs_8c_source.html#l00572">ofd_seqs_init()</a>, <a class="el" href="ofd__dev_8c_source.html#l01363">ofd_setattr_hdl()</a>, and <a class="el" href="ofd__io_8c_source.html#l00247">ofd_start_inconsistency_verification_thread()</a>.</p>

</div>
</div>
<a class="anchor" id="aef602a45635c5892c237ab74709cd8d1"></a><!-- doxytag: member="ofd_internal.h::ofd_obd" ref="aef602a45635c5892c237ab74709cd8d1" args="(struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structobd__device.html">obd_device</a>* ofd_obd </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00202">202</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="lu__object_8h_source.html#l00287">lu_device::ld_obd</a>, and <a class="el" href="ofd__internal_8h_source.html#l00117">ofd_device::ofd_dt_dev</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l01084">ofd_echo_create()</a>, <a class="el" href="ofd__obd_8c_source.html#l00067">ofd_export_stats_init()</a>, <a class="el" href="ofd__dev_8c_source.html#l02983">ofd_fini()</a>, <a class="el" href="ofd__grant_8c_source.html#l00106">ofd_grant_chunk()</a>, <a class="el" href="ofd__internal_8h_source.html#l00445">ofd_grant_prohibit()</a>, <a class="el" href="ofd__obd_8c_source.html#l01293">ofd_iocontrol()</a>, <a class="el" href="ofd__dev_8c_source.html#l00528">ofd_lfsck_out_notify()</a>, <a class="el" href="ofd__obd_8c_source.html#l00411">ofd_obd_disconnect()</a>, <a class="el" href="ofd__dev_8c_source.html#l00576">ofd_prepare()</a>, <a class="el" href="ofd__dev_8c_source.html#l00319">ofd_process_config()</a>, <a class="el" href="ofd__dev_8c_source.html#l00751">ofd_procfs_add_brw_stats_symlink()</a>, <a class="el" href="ofd__dev_8c_source.html#l00783">ofd_procfs_fini()</a>, <a class="el" href="ofd__dev_8c_source.html#l00681">ofd_procfs_init()</a>, and <a class="el" href="ofd__dev_8c_source.html#l00220">ofd_stack_fini()</a>.</p>

</div>
</div>
<a class="anchor" id="ab2316ccdd15f9c236b56bdff44b73e73"></a><!-- doxytag: member="ofd_internal.h::ofd_obd_disconnect" ref="ab2316ccdd15f9c236b56bdff44b73e73" args="(struct obd_export *exp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_obd_disconnect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Disconnect a connected client. </p>
<p>This function terminates the client connection. The client export is disconnected (cleaned up) and client data on persistent storage is removed.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>OBD export</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__obd_8c_source.html#l00411">411</a> of file <a class="el" href="ofd__obd_8c_source.html">ofd_obd.c</a>.</p>

<p>References <a class="el" href="genops_8c_source.html#l00803">class_export_get()</a>, <a class="el" href="genops_8c_source.html#l00812">class_export_put()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__export_8h_source.html#l00245">obd_export::exp_failed</a>, <a class="el" href="lustre__export_8h_source.html#l00244">obd_export::exp_flags</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00999">LCT_DT_THREAD</a>, <a class="el" href="lu__object_8c_source.html#l01881">lu_env_fini()</a>, <a class="el" href="lu__object_8c_source.html#l01869">lu_env_init()</a>, <a class="el" href="nodemap__handler_8c_source.html#l00376">nodemap_del_member()</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_fail</a>, <a class="el" href="lustre__export_8h_source.html#l00157">OBD_OPT_FORCE</a>, <a class="el" href="obd_8h_source.html#l00603">obd_device::obd_replayable</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__grant_8c_source.html#l00947">ofd_grant_discard()</a>, <a class="el" href="ofd__grant_8c_source.html#l00147">ofd_grant_sanity_check()</a>, <a class="el" href="ofd__internal_8h_source.html#l00202">ofd_obd()</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="tgt__lastrcvd_8c_source.html#l01013">tgt_client_del()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="a6f529d63e425ee42652d7d4481c95ce9"></a><!-- doxytag: member="ofd_internal.h::ofd_obj" ref="a6f529d63e425ee42652d7d4481c95ce9" args="(struct lu_object *o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structofd__object.html">ofd_object</a>* ofd_obj </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlu__object.html">lu_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00225">225</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, and <a class="el" href="ofd__internal_8h_source.html#l00219">ofd_object::ofo_obj</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00102">ofd_object_find()</a>, and <a class="el" href="ofd__dev_8c_source.html#l00434">ofd_object_free()</a>.</p>

</div>
</div>
<a class="anchor" id="a44100c7cf85c189a2826a021adf42113"></a><!-- doxytag: member="ofd_internal.h::ofd_obj2dev" ref="a44100c7cf85c189a2826a021adf42113" args="(const struct ofd_object *fo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structofd__device.html">ofd_device</a>* ofd_obj2dev </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00250">250</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="lu__object_8h_source.html#l00472">lu_object::lo_dev</a>, <a class="el" href="ofd__internal_8h_source.html#l00197">ofd_dev()</a>, and <a class="el" href="ofd__internal_8h_source.html#l00219">ofd_object::ofo_obj</a>.</p>

<p>Referenced by <a class="el" href="ofd__io_8c_source.html#l00320">ofd_add_inconsistency_item()</a>, <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__objects_8c_source.html#l00722">ofd_object_destroy()</a>, and <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>.</p>

</div>
</div>
<a class="anchor" id="a56709decfe3371e72247faf28e816dec"></a><!-- doxytag: member="ofd_internal.h::ofd_object_child" ref="a56709decfe3371e72247faf28e816dec" args="(struct ofd_object *_obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structdt__object.html">dt_object</a>* ofd_object_child </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>_obj</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00243">243</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, and <a class="el" href="lu__object_8h_source.html#l00762">lu_object_next()</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00778">ofd_attr_get()</a>, <a class="el" href="ofd__objects_8c_source.html#l00434">ofd_attr_handle_ugid()</a>, <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__io_8c_source.html#l00772">ofd_commitrw_read()</a>, <a class="el" href="ofd__io_8c_source.html#l01009">ofd_commitrw_write()</a>, <a class="el" href="ofd__obd_8c_source.html#l01168">ofd_echo_getattr()</a>, <a class="el" href="ofd__dev_8c_source.html#l00973">ofd_fiemap_get()</a>, <a class="el" href="ofd__dev_8c_source.html#l01281">ofd_getattr_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l01220">ofd_ioc_get_obj_version()</a>, <a class="el" href="ofd__objects_8c_source.html#l00722">ofd_object_destroy()</a>, <a class="el" href="ofd__objects_8c_source.html#l00138">ofd_object_ff_load()</a>, <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>, <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>, <a class="el" href="ofd__io_8c_source.html#l00440">ofd_preprw_read()</a>, <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>, <a class="el" href="ofd__internal_8h_source.html#l00255">ofd_read_lock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00263">ofd_read_unlock()</a>, <a class="el" href="ofd__dev_8c_source.html#l01948">ofd_sync_hdl()</a>, <a class="el" href="ofd__trans_8c_source.html#l00089">ofd_trans_start()</a>, <a class="el" href="ofd__objects_8c_source.html#l00063">ofd_version_get_check()</a>, <a class="el" href="ofd__io_8c_source.html#l00813">ofd_write_attr_set()</a>, <a class="el" href="ofd__internal_8h_source.html#l00271">ofd_write_lock()</a>, and <a class="el" href="ofd__internal_8h_source.html#l00279">ofd_write_unlock()</a>.</p>

</div>
</div>
<a class="anchor" id="aa45de7e119bfb1d96ad8e39b5a2c2346"></a><!-- doxytag: member="ofd_internal.h::ofd_object_destroy" ref="aa45de7e119bfb1d96ad8e39b5a2c2346" args="(const struct lu_env *, struct ofd_object *, int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_object_destroy </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>orphan</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destroy OFD object. </p>
<p>This function destroys OFD object. If object wasn't used at all (orphan) then local transaction is used, which means the transaction data is not returned back in reply.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fo</em>&nbsp;</td><td>OFD object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>orphan</em>&nbsp;</td><td>flag to indicate that object is orphaned</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__objects_8c_source.html#l00722">722</a> of file <a class="el" href="ofd__objects_8c_source.html">ofd_objects.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l02137">dt_declare_destroy()</a>, <a class="el" href="dt__object_8h_source.html#l02292">dt_declare_ref_del()</a>, <a class="el" href="dt__object_8h_source.html#l02151">dt_destroy()</a>, <a class="el" href="dt__object_8h_source.html#l02305">dt_ref_del()</a>, <a class="el" href="dt__object_8h_source.html#l02062">dt_trans_start_local()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lu__object_8h_source.html#l00525">lu_object_header::loh_fid</a>, <a class="el" href="ofd__internal_8h_source.html#l00484">ofd_fmd_drop</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00250">ofd_obj2dev()</a>, <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>, <a class="el" href="ofd__internal_8h_source.html#l00230">ofd_object_exists()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__trans_8c_source.html#l00057">ofd_trans_create()</a>, <a class="el" href="ofd__trans_8c_source.html#l00089">ofd_trans_start()</a>, <a class="el" href="ofd__trans_8c_source.html#l00110">ofd_trans_stop()</a>, <a class="el" href="ofd__internal_8h_source.html#l00271">ofd_write_lock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00279">ofd_write_unlock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00218">ofd_object::ofo_header</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, and <a class="el" href="rename__many_8c_source.html#l00056">stop</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l00984">ofd_destroy_by_fid()</a>.</p>

</div>
</div>
<a class="anchor" id="a3f9a60b36e41790dfd1c056db7b0eab2"></a><!-- doxytag: member="ofd_internal.h::ofd_object_exists" ref="a3f9a60b36e41790dfd1c056db7b0eab2" args="(struct ofd_object *obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ofd_object_exists </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00230">230</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l00468">lu_object::lo_header</a>, <a class="el" href="lu__object_8h_source.html#l00840">lu_object_exists</a>, <a class="el" href="lu__object_8h_source.html#l00719">lu_object_is_dying()</a>, and <a class="el" href="ofd__internal_8h_source.html#l00219">ofd_object::ofo_obj</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00778">ofd_attr_get()</a>, <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__io_8c_source.html#l00772">ofd_commitrw_read()</a>, <a class="el" href="ofd__io_8c_source.html#l01009">ofd_commitrw_write()</a>, <a class="el" href="ofd__dev_8c_source.html#l00973">ofd_fiemap_get()</a>, <a class="el" href="ofd__obd_8c_source.html#l01220">ofd_ioc_get_obj_version()</a>, <a class="el" href="ofd__objects_8c_source.html#l00722">ofd_object_destroy()</a>, <a class="el" href="ofd__internal_8h_source.html#l00420">ofd_object_find_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>, <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>, <a class="el" href="ofd__io_8c_source.html#l00440">ofd_preprw_read()</a>, <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>, and <a class="el" href="ofd__objects_8c_source.html#l00063">ofd_version_get_check()</a>.</p>

</div>
</div>
<a class="anchor" id="a717bbfb0c00e765805d251e3cefef3ff"></a><!-- doxytag: member="ofd_internal.h::ofd_object_ff_load" ref="a717bbfb0c00e765805d251e3cefef3ff" args="(const struct lu_env *env, struct ofd_object *fo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_object_ff_load </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get FID of parent MDT object. </p>
<p>This function reads extended attribute XATTR_NAME_FID of OFD object which contains the MDT parent object FID and saves it in <a class="el" href="structofd__object.html#ab4655ef8f7b9783a6cdd5d08adadadd1">ofd_object::ofo_pfid</a>.</p>
<p>The filter_fid::ff_parent::f_ver field currently holds the OST-object index in the parent MDT-object's layout EA, not the actual FID::f_ver of the parent. We therefore access it via the macro f_stripe_idx.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fo</em>&nbsp;</td><td>OFD object</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-ENODATA</em>&nbsp;</td><td>if there is no such xattr </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__objects_8c_source.html#l00138">138</a> of file <a class="el" href="ofd__objects_8c_source.html">ofd_objects.c</a>.</p>

<p>References <a class="el" href="parallel__grouplock_8c_source.html#l00078">buf</a>, <a class="el" href="dt__object_8h_source.html#l02588">dt_xattr_get()</a>, <a class="el" href="lustre__user_8h_source.html#l00147">lu_fid::f_oid</a>, <a class="el" href="lustre__user_8h_source.html#l00145">lu_fid::f_seq</a>, <a class="el" href="lustre__user_8h_source.html#l00172">filter_fid_old::ff_parent</a>, <a class="el" href="lustre__idl_8h_source.html#l00793">fid_is_sane()</a>, <a class="el" href="lustre__idl_8h_source.html#l00260">fid_zero()</a>, <a class="el" href="ofd__internal_8h_source.html#l00316">ofd_thread_info::fti_buf</a>, <a class="el" href="ofd__internal_8h_source.html#l00304">ofd_thread_info::fti_mds_fid_old</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="byteorder_8h_source.html#l00056">le32_to_cpu</a>, <a class="el" href="byteorder_8h_source.html#l00058">le64_to_cpu</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>, <a class="el" href="ofd__internal_8h_source.html#l00220">ofd_object::ofo_pfid</a>, and <a class="el" href="lustre__idl_8h_source.html#l01599">XATTR_NAME_FID</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>, <a class="el" href="ofd__io_8c_source.html#l00378">ofd_verify_ff()</a>, and <a class="el" href="ofd__io_8c_source.html#l00813">ofd_write_attr_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a57ac86f9d9ab8efeac61c1a578175a40"></a><!-- doxytag: member="ofd_internal.h::ofd_object_find" ref="a57ac86f9d9ab8efeac61c1a578175a40" args="(const struct lu_env *env, struct ofd_device *ofd, const struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structofd__object.html">ofd_object</a>* ofd_object_find </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get OFD object by FID. </p>
<p>This function finds OFD slice of compound object with the given FID.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fid</em>&nbsp;</td><td>FID of the object</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pointer</em>&nbsp;</td><td>to the found <a class="el" href="structofd__object.html">ofd_object</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ERR_PTR(errno)</em>&nbsp;</td><td>in case of error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__objects_8c_source.html#l00102">102</a> of file <a class="el" href="ofd__objects_8c_source.html">ofd_objects.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="libcfs__private_8h_source.html#l00309">likely</a>, <a class="el" href="lu__object_8c_source.html#l00643">lu_object_find()</a>, <a class="el" href="ofd__internal_8h_source.html#l00117">ofd_device::ofd_dt_dev</a>, <a class="el" href="ofd__internal_8h_source.html#l00225">ofd_obj()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__io_8c_source.html#l00772">ofd_commitrw_read()</a>, <a class="el" href="ofd__io_8c_source.html#l01009">ofd_commitrw_write()</a>, <a class="el" href="ofd__dev_8c_source.html#l00973">ofd_fiemap_get()</a>, <a class="el" href="ofd__obd_8c_source.html#l01220">ofd_ioc_get_obj_version()</a>, <a class="el" href="ofd__dev_8c_source.html#l02118">ofd_ladvise_hdl()</a>, <a class="el" href="ofd__lvb_8c_source.html#l00085">ofd_lvbo_init()</a>, <a class="el" href="ofd__lvb_8c_source.html#l00182">ofd_lvbo_update()</a>, <a class="el" href="ofd__internal_8h_source.html#l00420">ofd_object_find_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>, <a class="el" href="ofd__io_8c_source.html#l00440">ofd_preprw_read()</a>, and <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a7d7e4e95133f3eaf0679cdafb2b893e7"></a><!-- doxytag: member="ofd_internal.h::ofd_object_find_exists" ref="a7d7e4e95133f3eaf0679cdafb2b893e7" args="(const struct lu_env *env, struct ofd_device *ofd, const struct lu_fid *fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structofd__object.html">ofd_object</a>* ofd_object_find_exists </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00420">420</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="ofd__internal_8h_source.html#l00230">ofd_object_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00102">ofd_object_find()</a>, and <a class="el" href="ofd__objects_8c_source.html#l00174">ofd_object_put()</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l00984">ofd_destroy_by_fid()</a>, <a class="el" href="ofd__obd_8c_source.html#l01168">ofd_echo_getattr()</a>, <a class="el" href="ofd__obd_8c_source.html#l00892">ofd_echo_setattr()</a>, <a class="el" href="ofd__dev_8c_source.html#l01281">ofd_getattr_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l02007">ofd_punch_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01363">ofd_setattr_hdl()</a>, and <a class="el" href="ofd__dev_8c_source.html#l01948">ofd_sync_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="a7b3f8fb17c1e77da04da0352c11e4fd3"></a><!-- doxytag: member="ofd_internal.h::ofd_object_punch" ref="a7b3f8fb17c1e77da04da0352c11e4fd3" args="(const struct lu_env *env, struct ofd_object *fo, __u64 start, __u64 end, struct lu_attr *la, struct filter_fid *ff, struct obdo *oa)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_object_punch </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlu__attr.html">lu_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>la</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfilter__fid.html">filter_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>ff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobdo.html">obdo</a> *&nbsp;</td>
          <td class="paramname"> <em>oa</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Truncate/punch OFD object. </p>
<p>This function frees all of the allocated object's space from the <em>start</em> offset to the <em>end</em> offset. For truncate() operations the <em>end</em> offset is OBD_OBJECT_EOF. The functionality to punch holes in an object via fallocate(FALLOC_FL_PUNCH_HOLE) is not yet implemented (see LU-3606).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fo</em>&nbsp;</td><td>OFD object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>start</em>&nbsp;</td><td>start offset to punch from </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>end</em>&nbsp;</td><td>end of punch </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>la</em>&nbsp;</td><td>object attributes </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ff</em>&nbsp;</td><td><a class="el" href="structfilter__fid.html">filter_fid</a> structure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oa</em>&nbsp;</td><td><a class="el" href="structobdo.html">obdo</a> struct from incoming request</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__objects_8c_source.html#l00600">600</a> of file <a class="el" href="ofd__objects_8c_source.html">ofd_objects.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l02253">dt_attr_set()</a>, <a class="el" href="dt__object_8h_source.html#l02238">dt_declare_attr_set()</a>, <a class="el" href="dt__object_8h_source.html#l02398">dt_declare_punch()</a>, <a class="el" href="dt__object_8h_source.html#l02543">dt_declare_xattr_set()</a>, <a class="el" href="dt__object_8h_source.html#l02408">dt_punch()</a>, <a class="el" href="dt__object_8h_source.html#l02559">dt_xattr_set()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__user_8h_source.html#l00147">lu_fid::f_oid</a>, <a class="el" href="lustre__user_8h_source.html#l00145">lu_fid::f_seq</a>, <a class="el" href="lustre__user_8h_source.html#l00167">filter_fid::ff_parent</a>, <a class="el" href="ofd__internal_8h_source.html#l00062">ofd_mod_data::fmd_mactime_xid</a>, <a class="el" href="ofd__internal_8h_source.html#l00316">ofd_thread_info::fti_buf</a>, <a class="el" href="ofd__internal_8h_source.html#l00294">ofd_thread_info::fti_exp</a>, <a class="el" href="ofd__internal_8h_source.html#l00295">ofd_thread_info::fti_xid</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="byteorder_8h_source.html#l00056">le32_to_cpu</a>, <a class="el" href="byteorder_8h_source.html#l00058">le64_to_cpu</a>, <a class="el" href="lu__object_8h_source.html#l00525">lu_object_header::loh_fid</a>, <a class="el" href="lustre__idl_8h_source.html#l03383">obdo::o_valid</a>, <a class="el" href="lustre__idl_8h_source.html#l01680">OBD_MD_FLFID</a>, <a class="el" href="lustre__idl_8h_source.html#l01767">OBD_OBJECT_EOF</a>, <a class="el" href="ofd__objects_8c_source.html#l00434">ofd_attr_handle_ugid()</a>, <a class="el" href="ofd__fmd_8c_source.html#l00228">ofd_fmd_get()</a>, <a class="el" href="ofd__fmd_8c_source.html#l00084">ofd_fmd_put()</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00175">ofd_device::ofd_lfsck_verify_pfid</a>, <a class="el" href="ofd__internal_8h_source.html#l00250">ofd_obj2dev()</a>, <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>, <a class="el" href="ofd__internal_8h_source.html#l00230">ofd_object_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00138">ofd_object_ff_load()</a>, <a class="el" href="ofd__trans_8c_source.html#l00057">ofd_trans_create()</a>, <a class="el" href="ofd__trans_8c_source.html#l00089">ofd_trans_start()</a>, <a class="el" href="ofd__trans_8c_source.html#l00110">ofd_trans_stop()</a>, <a class="el" href="ofd__io_8c_source.html#l00378">ofd_verify_ff()</a>, <a class="el" href="ofd__objects_8c_source.html#l00063">ofd_version_get_check()</a>, <a class="el" href="ofd__internal_8h_source.html#l00271">ofd_write_lock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00279">ofd_write_unlock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00218">ofd_object::ofo_header</a>, <a class="el" href="ofd__internal_8h_source.html#l00220">ofd_object::ofo_pfid</a>, <a class="el" href="rename__many_8c_source.html#l00056">stop</a>, and <a class="el" href="lustre__idl_8h_source.html#l01599">XATTR_NAME_FID</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02007">ofd_punch_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="a72400bb0b6ad0127f9056b7d7676ff6d"></a><!-- doxytag: member="ofd_internal.h::ofd_object_put" ref="a72400bb0b6ad0127f9056b7d7676ff6d" args="(const struct lu_env *env, struct ofd_object *fo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_object_put </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Put OFD object reference. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fo</em>&nbsp;</td><td>OFD object </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__objects_8c_source.html#l00174">174</a> of file <a class="el" href="ofd__objects_8c_source.html">ofd_objects.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="lu__object_8c_source.html#l00097">lu_object_put()</a>, and <a class="el" href="ofd__internal_8h_source.html#l00219">ofd_object::ofo_obj</a>.</p>

<p>Referenced by <a class="el" href="ofd__io_8c_source.html#l00772">ofd_commitrw_read()</a>, <a class="el" href="ofd__io_8c_source.html#l01009">ofd_commitrw_write()</a>, <a class="el" href="ofd__obd_8c_source.html#l00984">ofd_destroy_by_fid()</a>, <a class="el" href="ofd__obd_8c_source.html#l01168">ofd_echo_getattr()</a>, <a class="el" href="ofd__obd_8c_source.html#l00892">ofd_echo_setattr()</a>, <a class="el" href="ofd__dev_8c_source.html#l00973">ofd_fiemap_get()</a>, <a class="el" href="ofd__dev_8c_source.html#l01281">ofd_getattr_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l01220">ofd_ioc_get_obj_version()</a>, <a class="el" href="ofd__dev_8c_source.html#l02118">ofd_ladvise_hdl()</a>, <a class="el" href="ofd__lvb_8c_source.html#l00085">ofd_lvbo_init()</a>, <a class="el" href="ofd__lvb_8c_source.html#l00182">ofd_lvbo_update()</a>, <a class="el" href="ofd__internal_8h_source.html#l00420">ofd_object_find_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>, <a class="el" href="ofd__io_8c_source.html#l00440">ofd_preprw_read()</a>, <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>, <a class="el" href="ofd__dev_8c_source.html#l02007">ofd_punch_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01363">ofd_setattr_hdl()</a>, and <a class="el" href="ofd__dev_8c_source.html#l01948">ofd_sync_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="a75bf6a3caae3bb3a84364235ee1bad78"></a><!-- doxytag: member="ofd_internal.h::ofd_postrecov" ref="a75bf6a3caae3bb3a84364235ee1bad78" args="(const struct lu_env *env, struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_postrecov </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Notify all devices in server stack about recovery completion. </p>
<p>This function calls ldo_recovery_complete() for all lower devices in the server stack so they will be prepared for normal operations.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__obd_8c_source.html#l00541">541</a> of file <a class="el" href="ofd__obd_8c_source.html">ofd_obd.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00277">CWARN</a>, <a class="el" href="libcfs__debug_8h_source.html#l00148">D_HA</a>, <a class="el" href="dt__object_8h_source.html#l01723">dt_device::dd_lu_dev</a>, <a class="el" href="lu__object_8h_source.html#l00279">lu_device::ld_ops</a>, <a class="el" href="structlu__device__operations.html#a0786583fdaf5ff6bf3f4aaa4e48d3dd9">lu_device_operations::ldo_recovery_complete</a>, <a class="el" href="lfsck__lib_8c_source.html#l02937">lfsck_start()</a>, <a class="el" href="lustre__lfsck_8h_source.html#l00044">lfsck_start_param::lsp_index_valid</a>, <a class="el" href="lustre__lfsck_8h_source.html#l00042">lfsck_start_param::lsp_start</a>, <a class="el" href="ofd__internal_8h_source.html#l00117">ofd_device::ofd_dt_dev</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, and <a class="el" href="ofd__internal_8h_source.html#l00175">ofd_device::ofd_skip_lfsck</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l00573">ofd_obd_postrecov()</a>, and <a class="el" href="ofd__dev_8c_source.html#l00576">ofd_prepare()</a>.</p>

</div>
</div>
<a class="anchor" id="aad0ed2371c99ff9007c8963b60bb47d5"></a><!-- doxytag: member="ofd_internal.h::ofd_precreate_batch" ref="aad0ed2371c99ff9007c8963b60bb47d5" args="(struct ofd_device *ofd, int batch)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_precreate_batch </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>batch</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Restrict precreate batch count by its upper limit. </p>
<p>The precreate batch count is a number of precreates to do in single transaction. It has upper limit - <a class="el" href="structofd__device.html#ab0c56062b60a7f9e5ca8f21d798433b5">ofd_device::ofd_precreate_batch</a> value which shouldn't be exceeded.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>batch</em>&nbsp;</td><td>number of updates in the batch</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>\a</em>&nbsp;</td><td>batch limited by <a class="el" href="structofd__device.html#ab0c56062b60a7f9e5ca8f21d798433b5">ofd_device::ofd_precreate_batch</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fs_8c_source.html#l00061">61</a> of file <a class="el" href="ofd__fs_8c_source.html">ofd_fs.c</a>.</p>

<p>References <a class="el" href="ofd__internal_8h_source.html#l00136">ofd_device::ofd_batch_lock</a>, and <a class="el" href="ofd__internal_8h_source.html#l00135">ofd_device::ofd_precreate_batch</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l01084">ofd_echo_create()</a>, and <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a996461722e57519b8c0af17df020a387"></a><!-- doxytag: member="ofd_internal.h::ofd_precreate_objects" ref="a996461722e57519b8c0af17df020a387" args="(const struct lu_env *env, struct ofd_device *ofd, u64 id, struct ofd_seq *oseq, int nr, int sync)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_precreate_objects </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&nbsp;</td>
          <td class="paramname"> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__seq.html">ofd_seq</a> *&nbsp;</td>
          <td class="paramname"> <em>oseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sync</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Precreate the given number <em>nr</em> of objects in the given sequence <em>oseq</em>. </p>
<p>This function precreates new OST objects in the given sequence. The precreation starts from <em>id</em> and creates <em>nr</em> objects sequentially.</p>
<p>Notes: This function may create fewer objects than requested.</p>
<p>We mark object SUID+SGID to flag it for accepting UID+GID from client on first write. Currently the permission bits on the OST are never used, so this is OK.</p>
<p>Initialize a/c/m time so any client timestamp will always be newer and update the inode. The ctime = 0 case is also handled specially in <a class="el" href="osd-ldiskfs_2osd__handler_8c.html#ab28dd16ff6b86e9465309b87a94a39f3">osd_inode_setattr()</a>. See LU-221, LU-1042 for details.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>id</em>&nbsp;</td><td>object ID to start precreation from </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oseq</em>&nbsp;</td><td>object sequence </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nr</em>&nbsp;</td><td>number of objects to precreate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sync</em>&nbsp;</td><td>synchronous precreation flag</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__objects_8c_source.html#l00206">206</a> of file <a class="el" href="ofd__objects_8c_source.html">ofd_objects.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="byteorder_8h_source.html#l00059">cpu_to_le64</a>, <a class="el" href="libcfs__debug_8h_source.html#l00146">D_ERROR</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="libcfs__debug_8h_source.html#l00141">D_OTHER</a>, <a class="el" href="dt__object_8h_source.html#l01732">dt_device::dd_record_fid_accessed</a>, <a class="el" href="lustre__user_8h_source.html#l00548">DFID</a>, <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="dt__object_8h_source.html#l00396">dt_object_format::dof_type</a>, <a class="el" href="lustre__user_8h_source.html#l00223">DOSTID</a>, <a class="el" href="dt__object_8h_source.html#l02120">dt_create()</a>, <a class="el" href="dt__object_8h_source.html#l02103">dt_declare_create()</a>, <a class="el" href="dt__object_8h_source.html#l02087">dt_declare_record_write()</a>, <a class="el" href="dt__object_8c_source.html#l00192">dt_mode_to_dft()</a>, <a class="el" href="dt__object_8c_source.html#l00504">dt_record_write()</a>, <a class="el" href="dt__object_8h_source.html#l02062">dt_trans_start_local()</a>, <a class="el" href="dt__object_8h_source.html#l02175">dt_write_lock()</a>, <a class="el" href="dt__object_8h_source.html#l02194">dt_write_unlock()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="osd__iam_8h_source.html#l00057">ergo</a>, <a class="el" href="lustre__idl_8h_source.html#l00342">fid_seq_is_mdt0()</a>, <a class="el" href="lustre__idl_8h_source.html#l00623">fid_set_id()</a>, <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="ofd__internal_8h_source.html#l00316">ofd_thread_info::fti_buf</a>, <a class="el" href="ofd__internal_8h_source.html#l00315">ofd_thread_info::fti_dof</a>, <a class="el" href="ofd__internal_8h_source.html#l00298">ofd_thread_info::fti_fid</a>, <a class="el" href="ofd__internal_8h_source.html#l00323">ofd_thread_info::fti_lr</a>, <a class="el" href="ofd__internal_8h_source.html#l00317">ofd_thread_info::fti_off</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="lustre__idl_8h_source.html#l00320">IDIF_MAX_OID</a>, <a class="el" href="lu__object_8h_source.html#l00413">lu_attr::la_atime</a>, <a class="el" href="lu__object_8h_source.html#l00444">LA_ATIME</a>, <a class="el" href="lu__object_8h_source.html#l00415">lu_attr::la_ctime</a>, <a class="el" href="lu__object_8h_source.html#l00446">LA_CTIME</a>, <a class="el" href="lu__object_8h_source.html#l00419">lu_attr::la_mode</a>, <a class="el" href="lu__object_8h_source.html#l00448">LA_MODE</a>, <a class="el" href="lu__object_8h_source.html#l00411">lu_attr::la_mtime</a>, <a class="el" href="lu__object_8h_source.html#l00445">LA_MTIME</a>, <a class="el" href="lu__object_8h_source.html#l00452">LA_TYPE</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="lustre__idl_8h_source.html#l03465">LE_FID_ACCESSED</a>, <a class="el" href="lfsck__lib_8c_source.html#l03296">lfsck_in_notify()</a>, <a class="el" href="lustre__lfsck_8h_source.html#l00087">lfsck_pack_rfa()</a>, <a class="el" href="lustre__lfsck__user_8h_source.html#l00168">LFSCK_TYPE_LAYOUT</a>, <a class="el" href="libcfs__private_8h_source.html#l00309">likely</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="lu__object_8h_source.html#l00770">lu_object_fid()</a>, <a class="el" href="obd__support_8h_source.html#l00708">OBD_ALLOC</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00537">OBD_FAIL_LFSCK_DANGLING</a>, <a class="el" href="obd__support_8h_source.html#l00534">OBD_FAIL_LFSCK_SKIP_LASTID</a>, <a class="el" href="obd__support_8h_source.html#l00776">OBD_FREE</a>, <a class="el" href="lustre__idl_8h_source.html#l00317">OBIF_MAX_OID</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>, <a class="el" href="ofd__internal_8h_source.html#l00230">ofd_object_exists()</a>, <a class="el" href="ofd__objects_8c_source.html#l00102">ofd_object_find()</a>, <a class="el" href="ofd__objects_8c_source.html#l00174">ofd_object_put()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__fs_8c_source.html#l00164">ofd_seq_last_oid()</a>, <a class="el" href="ofd__fs_8c_source.html#l00181">ofd_seq_last_oid_set()</a>, <a class="el" href="ofd__trans_8c_source.html#l00057">ofd_trans_create()</a>, <a class="el" href="ofd__trans_8c_source.html#l00110">ofd_trans_stop()</a>, <a class="el" href="ofd__internal_8h_source.html#l00271">ofd_write_lock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00279">ofd_write_unlock()</a>, <a class="el" href="ofd__internal_8h_source.html#l00219">ofd_object::ofo_obj</a>, <a class="el" href="ofd__internal_8h_source.html#l00112">ofd_seq::os_lastid_obj</a>, <a class="el" href="ofd__internal_8h_source.html#l00108">ofd_seq::os_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l00531">ostid_seq()</a>, <a class="el" href="lustre__user_8h_source.html#l00549">PFID</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="dt__object_8h_source.html#l01848">thandle::th_sync</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l01084">ofd_echo_create()</a>, and <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a5ca68f3e89576e95623a4dfa3303c215"></a><!-- doxytag: member="ofd_internal.h::ofd_prepare_fidea" ref="a5ca68f3e89576e95623a4dfa3303c215" args="(struct filter_fid *ff, const struct obdo *oa)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_prepare_fidea </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfilter__fid.html">filter_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>ff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structobdo.html">obdo</a> *&nbsp;</td>
          <td class="paramname"> <em>oa</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00562">562</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="byteorder_8h_source.html#l00057">cpu_to_le32</a>, <a class="el" href="byteorder_8h_source.html#l00059">cpu_to_le64</a>, <a class="el" href="lustre__user_8h_source.html#l00147">lu_fid::f_oid</a>, <a class="el" href="lustre__user_8h_source.html#l00145">lu_fid::f_seq</a>, <a class="el" href="lustre__user_8h_source.html#l00153">lu_fid::f_ver</a>, <a class="el" href="lustre__user_8h_source.html#l00167">filter_fid::ff_parent</a>, <a class="el" href="lustre__idl_8h_source.html#l03400">obdo::o_parent_oid</a>, <a class="el" href="lustre__idl_8h_source.html#l03385">obdo::o_parent_seq</a>, and <a class="el" href="lustre__idl_8h_source.html#l03404">obdo::o_stripe_idx</a>.</p>

<p>Referenced by <a class="el" href="ofd__io_8c_source.html#l01163">ofd_commitrw()</a>, <a class="el" href="ofd__obd_8c_source.html#l00892">ofd_echo_setattr()</a>, <a class="el" href="ofd__dev_8c_source.html#l02007">ofd_punch_hdl()</a>, and <a class="el" href="ofd__dev_8c_source.html#l01363">ofd_setattr_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="a5e1b48d7cdf4e6ccdc5f00ba323f1ddb"></a><!-- doxytag: member="ofd_internal.h::ofd_preprw" ref="a5e1b48d7cdf4e6ccdc5f00ba323f1ddb" args="(const struct lu_env *env, int cmd, struct obd_export *exp, struct obdo *oa, int objcount, struct obd_ioobj *obj, struct niobuf_remote *rnb, int *nr_local, struct niobuf_local *lnb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_preprw </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobdo.html">obdo</a> *&nbsp;</td>
          <td class="paramname"> <em>oa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>objcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__ioobj.html">obd_ioobj</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__remote.html">niobuf_remote</a> *&nbsp;</td>
          <td class="paramname"> <em>rnb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>nr_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structniobuf__local.html">niobuf_local</a> *&nbsp;</td>
          <td class="paramname"> <em>lnb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prepare bulk IO requests for processing. </p>
<p>This function does initial checks of IO and calls corresponding functions for read/write processing.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cmd</em>&nbsp;</td><td>IO type (read/write) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>OBD export of client </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oa</em>&nbsp;</td><td>OBDO structure from request </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>objcount</em>&nbsp;</td><td>always 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>obj</em>&nbsp;</td><td>object data </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rnb</em>&nbsp;</td><td>remote buffers </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nr_local</em>&nbsp;</td><td>number of local buffers </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lnb</em>&nbsp;</td><td>local buffers</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on successful prepare </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__io_8c_source.html#l00685">685</a> of file <a class="el" href="ofd__io_8c_source.html">ofd_io.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="lustre__user_8h_source.html#l00223">DOSTID</a>, <a class="el" href="lustre__export_8h_source.html#l00209">obd_export::exp_obd</a>, <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="lustre__idl_8h_source.html#l01777">obd_ioobj::ioo_bufcnt</a>, <a class="el" href="lu__object_8h_source.html#l00444">LA_ATIME</a>, <a class="el" href="linux-obdo_8c_source.html#l00103">la_from_obdo()</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lustre__idl_8h_source.html#l03384">obdo::o_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l01746">OBD_BRW_READ</a>, <a class="el" href="lustre__idl_8h_source.html#l01747">OBD_BRW_WRITE</a>, <a class="el" href="obd__support_8h_source.html#l00619">OBD_FAIL_CHECK</a>, <a class="el" href="obd__support_8h_source.html#l00302">OBD_FAIL_SRV_ENOENT</a>, <a class="el" href="lustre__idl_8h_source.html#l01720">OBD_MD_FLGETATTR</a>, <a class="el" href="obd_8h_source.html#l00599">obd_device::obd_name</a>, <a class="el" href="linux-obdo_8c_source.html#l00052">obdo_from_la()</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__grant_8c_source.html#l00988">ofd_grant_prepare_read()</a>, <a class="el" href="ofd__internal_8h_source.html#l00511">ofd_info_init()</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__io_8c_source.html#l00440">ofd_preprw_read()</a>, <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>, <a class="el" href="ofd__fs_8c_source.html#l00362">ofd_seq_load()</a>, <a class="el" href="ofd__fs_8c_source.html#l00109">ofd_seq_put()</a>, <a class="el" href="lustre__user_8h_source.html#l00219">ost_id::oi_fid</a>, <a class="el" href="ofd__internal_8h_source.html#l00113">ofd_seq::os_destroys_in_progress</a>, <a class="el" href="lustre__idl_8h_source.html#l00531">ostid_seq()</a>, <a class="el" href="lustre__user_8h_source.html#l00224">POSTID</a>, <a class="el" href="lustre__net_8h_source.html#l00105">PTLRPC_MAX_BRW_PAGES</a>, <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>, <a class="el" href="lu__target_8h_source.html#l00235">tgt_ses_info()</a>, <a class="el" href="lu__target_8h_source.html#l00334">tgt_ses_req()</a>, <a class="el" href="ofd__internal_8h_source.html#l00527">tsi2ofd_info()</a>, and <a class="el" href="lu__target_8h_source.html#l00227">tgt_session_info::tsi_jobid</a>.</p>

</div>
</div>
<a class="anchor" id="ae30c9aa5fcc0a7316734f68dcb115b0d"></a><!-- doxytag: member="ofd_internal.h::ofd_read_lock" ref="ae30c9aa5fcc0a7316734f68dcb115b0d" args="(const struct lu_env *env, struct ofd_object *fo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_read_lock </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00255">255</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01751">dt_object::do_ops</a>, <a class="el" href="structdt__object__operations.html#a32a37f3abca0903ec9fa5c70b2b7a423">dt_object_operations::do_read_lock</a>, and <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l00973">ofd_fiemap_get()</a>, <a class="el" href="ofd__io_8c_source.html#l00440">ofd_preprw_read()</a>, and <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a493ef7e2cb003f26e6ae08c1a013a862"></a><!-- doxytag: member="ofd_internal.h::ofd_read_unlock" ref="a493ef7e2cb003f26e6ae08c1a013a862" args="(const struct lu_env *env, struct ofd_object *fo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_read_unlock </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00263">263</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01751">dt_object::do_ops</a>, <a class="el" href="structdt__object__operations.html#a5d68d191697e7964615a090f9896f7f5">dt_object_operations::do_read_unlock</a>, and <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>.</p>

<p>Referenced by <a class="el" href="ofd__io_8c_source.html#l00772">ofd_commitrw_read()</a>, <a class="el" href="ofd__io_8c_source.html#l01009">ofd_commitrw_write()</a>, <a class="el" href="ofd__dev_8c_source.html#l00973">ofd_fiemap_get()</a>, <a class="el" href="ofd__io_8c_source.html#l00440">ofd_preprw_read()</a>, and <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a6507e38efbceeb8037a85d4a4a7a0e74"></a><!-- doxytag: member="ofd_internal.h::ofd_seq_get" ref="a6507e38efbceeb8037a85d4a4a7a0e74" args="(struct ofd_device *ofd, u64 seq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structofd__seq.html">ofd_seq</a>* ofd_seq_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&nbsp;</td>
          <td class="paramname"> <em>seq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get <a class="el" href="structofd__seq.html">ofd_seq</a> for <em>seq</em>. </p>
<p>Function finds appropriate structure by <em>seq</em> number and increases the reference counter of that structure.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>seq</em>&nbsp;</td><td>sequence number, FID sequence number usually</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pointer</em>&nbsp;</td><td>to the requested <a class="el" href="structofd__seq.html">ofd_seq</a> structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NULL</em>&nbsp;</td><td>if <a class="el" href="structofd__seq.html">ofd_seq</a> is not found </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fs_8c_source.html#l00084">84</a> of file <a class="el" href="ofd__fs_8c_source.html">ofd_fs.c</a>.</p>

<p>References <a class="el" href="list_8h_source.html#l00459">list_for_each_entry</a>, <a class="el" href="ofd__internal_8h_source.html#l00132">ofd_device::ofd_seq_list</a>, <a class="el" href="ofd__internal_8h_source.html#l00133">ofd_device::ofd_seq_list_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00107">ofd_seq::os_list</a>, <a class="el" href="ofd__internal_8h_source.html#l00108">ofd_seq::os_oi</a>, <a class="el" href="ofd__internal_8h_source.html#l00111">ofd_seq::os_refc</a>, and <a class="el" href="lustre__idl_8h_source.html#l00531">ostid_seq()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01461">ofd_orphans_destroy()</a>, and <a class="el" href="ofd__fs_8c_source.html#l00362">ofd_seq_load()</a>.</p>

</div>
</div>
<a class="anchor" id="a98c3a57bca104c0247e3bf2c9edde525"></a><!-- doxytag: member="ofd_internal.h::ofd_seq_last_oid" ref="a98c3a57bca104c0247e3bf2c9edde525" args="(struct ofd_seq *oseq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u64 ofd_seq_last_oid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__seq.html">ofd_seq</a> *&nbsp;</td>
          <td class="paramname"> <em>oseq</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get last object ID for the given sequence. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oseq</em>&nbsp;</td><td>OFD sequence structure</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>the</em>&nbsp;</td><td>last object ID for this sequence </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fs_8c_source.html#l00164">164</a> of file <a class="el" href="ofd__fs_8c_source.html">ofd_fs.c</a>.</p>

<p>References <a class="el" href="ofd__internal_8h_source.html#l00109">ofd_seq::os_last_oid_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00108">ofd_seq::os_oi</a>, and <a class="el" href="lustre__idl_8h_source.html#l00546">ostid_id()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l01084">ofd_echo_create()</a>, <a class="el" href="ofd__dev_8c_source.html#l01136">ofd_get_info_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01461">ofd_orphans_destroy()</a>, <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>, <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>, and <a class="el" href="ofd__fs_8c_source.html#l00204">ofd_seq_last_oid_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a53b878498f900554e87c79dd176abe9f"></a><!-- doxytag: member="ofd_internal.h::ofd_seq_last_oid_set" ref="a53b878498f900554e87c79dd176abe9f" args="(struct ofd_seq *oseq, u64 id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_seq_last_oid_set </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__seq.html">ofd_seq</a> *&nbsp;</td>
          <td class="paramname"> <em>oseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&nbsp;</td>
          <td class="paramname"> <em>id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set new last object ID for the given sequence. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oseq</em>&nbsp;</td><td>OFD sequence </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>id</em>&nbsp;</td><td>the new OID to set </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fs_8c_source.html#l00181">181</a> of file <a class="el" href="ofd__fs_8c_source.html">ofd_fs.c</a>.</p>

<p>References <a class="el" href="libcfs__private_8h_source.html#l00309">likely</a>, <a class="el" href="ofd__internal_8h_source.html#l00109">ofd_seq::os_last_oid_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00108">ofd_seq::os_oi</a>, <a class="el" href="lustre__idl_8h_source.html#l00546">ostid_id()</a>, and <a class="el" href="lustre__idl_8h_source.html#l00594">ostid_set_id()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01461">ofd_orphans_destroy()</a>, <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>, and <a class="el" href="ofd__fs_8c_source.html#l00362">ofd_seq_load()</a>.</p>

</div>
</div>
<a class="anchor" id="a0e8216b91fa99c0ef833dc36059f25e9"></a><!-- doxytag: member="ofd_internal.h::ofd_seq_last_oid_write" ref="a0e8216b91fa99c0ef833dc36059f25e9" args="(const struct lu_env *env, struct ofd_device *ofd, struct ofd_seq *oseq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_seq_last_oid_write </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__seq.html">ofd_seq</a> *&nbsp;</td>
          <td class="paramname"> <em>oseq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update last used OID on disk for the given sequence. </p>
<p>The last used object ID is stored persistently on disk and must be written when updated. This function writes the sequence data. The format is just an object ID of the latest used object FID. Each ID is stored in per-sequence file.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oseq</em>&nbsp;</td><td><a class="el" href="structofd__seq.html">ofd_seq</a> structure with data to write</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on successful write of data from <em>oseq</em> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fs_8c_source.html#l00204">204</a> of file <a class="el" href="ofd__fs_8c_source.html">ofd_fs.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="byteorder_8h_source.html#l00059">cpu_to_le64</a>, <a class="el" href="libcfs__debug_8h_source.html#l00130">D_INODE</a>, <a class="el" href="lustre__user_8h_source.html#l00223">DOSTID</a>, <a class="el" href="dt__object_8h_source.html#l02087">dt_declare_record_write()</a>, <a class="el" href="dt__object_8c_source.html#l00504">dt_record_write()</a>, <a class="el" href="dt__object_8h_source.html#l02047">dt_trans_create()</a>, <a class="el" href="dt__object_8h_source.html#l02062">dt_trans_start_local()</a>, <a class="el" href="dt__object_8h_source.html#l02070">dt_trans_stop()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="ofd__internal_8h_source.html#l00316">ofd_thread_info::fti_buf</a>, <a class="el" href="ofd__internal_8h_source.html#l00317">ofd_thread_info::fti_off</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__fs_8c_source.html#l00164">ofd_seq_last_oid()</a>, <a class="el" href="ofd__internal_8h_source.html#l00112">ofd_seq::os_lastid_obj</a>, <a class="el" href="ofd__internal_8h_source.html#l00108">ofd_seq::os_oi</a>, <a class="el" href="lustre__user_8h_source.html#l00224">POSTID</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01461">ofd_orphans_destroy()</a>, and <a class="el" href="ofd__fs_8c_source.html#l00362">ofd_seq_load()</a>.</p>

</div>
</div>
<a class="anchor" id="ad84239bc5d9db54e5bdc961bb89924c0"></a><!-- doxytag: member="ofd_internal.h::ofd_seq_load" ref="ad84239bc5d9db54e5bdc961bb89924c0" args="(const struct lu_env *env, struct ofd_device *ofd, u64 seq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structofd__seq.html">ofd_seq</a>* ofd_seq_load </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&nbsp;</td>
          <td class="paramname"> <em>seq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return <a class="el" href="structofd__seq.html">ofd_seq</a> structure filled with valid data. </p>
<p>This function gets the <a class="el" href="structofd__seq.html">ofd_seq</a> by sequence number and read corresponding data from disk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>seq</em>&nbsp;</td><td>sequence number</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="structofd__seq.html">ofd_seq</a></em>&nbsp;</td><td>structure filled with data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ERR_PTR</em>&nbsp;</td><td>pointer on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fs_8c_source.html#l00362">362</a> of file <a class="el" href="ofd__fs_8c_source.html">ofd_fs.c</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="fsx_8c_source.html#l01082">cleanup()</a>, <a class="el" href="dt__object_8h_source.html#l00396">dt_object_format::dof_type</a>, <a class="el" href="dt__object_8h_source.html#l02225">dt_attr_get()</a>, <a class="el" href="dt__object_8c_source.html#l00388">dt_find_or_create()</a>, <a class="el" href="dt__object_8c_source.html#l00192">dt_mode_to_dft()</a>, <a class="el" href="dt__object_8c_source.html#l00490">dt_record_read()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="ofd__internal_8h_source.html#l00316">ofd_thread_info::fti_buf</a>, <a class="el" href="ofd__internal_8h_source.html#l00315">ofd_thread_info::fti_dof</a>, <a class="el" href="ofd__internal_8h_source.html#l00298">ofd_thread_info::fti_fid</a>, <a class="el" href="ofd__internal_8h_source.html#l00317">ofd_thread_info::fti_off</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="lu__object_8h_source.html#l00419">lu_attr::la_mode</a>, <a class="el" href="lu__object_8h_source.html#l00448">LA_MODE</a>, <a class="el" href="lu__object_8h_source.html#l00409">lu_attr::la_size</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="lu__object_8h_source.html#l01335">lu_buf::lb_buf</a>, <a class="el" href="lu__object_8h_source.html#l01336">lu_buf::lb_len</a>, <a class="el" href="byteorder_8h_source.html#l00058">le64_to_cpu</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00047">LPX64</a>, <a class="el" href="lustre__disk_8h_source.html#l00344">lr_server_data::lsd_osd_index</a>, <a class="el" href="lustre__fid_8h_source.html#l00318">lu_last_id_fid()</a>, <a class="el" href="lu__target_8h_source.html#l00144">lu_target::lut_lsd</a>, <a class="el" href="obd__support_8h_source.html#l00710">OBD_ALLOC_PTR</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00046">OFD_INIT_OBJID</a>, <a class="el" href="ofd__internal_8h_source.html#l00125">ofd_device::ofd_lut</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__fs_8c_source.html#l00134">ofd_seq_add()</a>, <a class="el" href="ofd__fs_8c_source.html#l00084">ofd_seq_get()</a>, <a class="el" href="ofd__fs_8c_source.html#l00181">ofd_seq_last_oid_set()</a>, <a class="el" href="ofd__fs_8c_source.html#l00204">ofd_seq_last_oid_write()</a>, <a class="el" href="ofd__fs_8c_source.html#l00109">ofd_seq_put()</a>, <a class="el" href="ofd__internal_8h_source.html#l00110">ofd_seq::os_create_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00109">ofd_seq::os_last_oid_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00112">ofd_seq::os_lastid_obj</a>, <a class="el" href="ofd__internal_8h_source.html#l00107">ofd_seq::os_list</a>, <a class="el" href="ofd__internal_8h_source.html#l00108">ofd_seq::os_oi</a>, <a class="el" href="ofd__internal_8h_source.html#l00111">ofd_seq::os_refc</a>, <a class="el" href="lustre__idl_8h_source.html#l00561">ostid_set_seq()</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l01084">ofd_echo_create()</a>, <a class="el" href="ofd__dev_8c_source.html#l01136">ofd_get_info_hdl()</a>, <a class="el" href="ofd__io_8c_source.html#l00685">ofd_preprw()</a>, and <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a1a85189347d12ff0d970c7a49b5a6331"></a><!-- doxytag: member="ofd_internal.h::ofd_seq_put" ref="a1a85189347d12ff0d970c7a49b5a6331" args="(const struct lu_env *env, struct ofd_seq *oseq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_seq_put </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__seq.html">ofd_seq</a> *&nbsp;</td>
          <td class="paramname"> <em>oseq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Drop a reference to <a class="el" href="structofd__seq.html">ofd_seq</a>. </p>
<p>The paired function to the <a class="el" href="ofd__fs_8c.html#a6507e38efbceeb8037a85d4a4a7a0e74" title="Get ofd_seq for seq.">ofd_seq_get()</a>. It decrease the reference counter of the <a class="el" href="structofd__seq.html">ofd_seq</a> structure and free it if that reference was last one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oseq</em>&nbsp;</td><td><a class="el" href="structofd__seq.html">ofd_seq</a> structure to put </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fs_8c_source.html#l00109">109</a> of file <a class="el" href="ofd__fs_8c_source.html">ofd_fs.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01750">dt_object::do_lu</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="lu__object_8c_source.html#l00097">lu_object_put()</a>, <a class="el" href="obd__support_8h_source.html#l00830">OBD_FREE_PTR</a>, <a class="el" href="ofd__internal_8h_source.html#l00112">ofd_seq::os_lastid_obj</a>, <a class="el" href="ofd__internal_8h_source.html#l00107">ofd_seq::os_list</a>, and <a class="el" href="ofd__internal_8h_source.html#l00111">ofd_seq::os_refc</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01553">ofd_create_hdl()</a>, <a class="el" href="ofd__obd_8c_source.html#l01084">ofd_echo_create()</a>, <a class="el" href="ofd__dev_8c_source.html#l01136">ofd_get_info_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01461">ofd_orphans_destroy()</a>, <a class="el" href="ofd__io_8c_source.html#l00685">ofd_preprw()</a>, <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>, <a class="el" href="ofd__fs_8c_source.html#l00134">ofd_seq_add()</a>, <a class="el" href="ofd__fs_8c_source.html#l00362">ofd_seq_load()</a>, and <a class="el" href="ofd__fs_8c_source.html#l00304">ofd_seqs_free()</a>.</p>

</div>
</div>
<a class="anchor" id="aaf7ceb2e214dd8f5f7bfb79bfde55294"></a><!-- doxytag: member="ofd_internal.h::ofd_seqs_fini" ref="aaf7ceb2e214dd8f5f7bfb79bfde55294" args="(const struct lu_env *env, struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_seqs_fini </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stop FLDB and SEQ services on OFD. </p>
<p>This function is part of OFD cleanup process.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fs_8c_source.html#l00332">332</a> of file <a class="el" href="ofd__fs_8c_source.html">ofd_fs.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="ofd__fs_8c_source.html#l00259">ofd_deregister_seq_exp()</a>, <a class="el" href="ofd__dev_8c_source.html#l00802">ofd_fid_fini()</a>, <a class="el" href="ofd__fs_8c_source.html#l00283">ofd_fld_fini()</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__internal_8h_source.html#l00132">ofd_device::ofd_seq_list</a>, and <a class="el" href="ofd__fs_8c_source.html#l00304">ofd_seqs_free()</a>.</p>

<p>Referenced by <a class="el" href="ofd__fs_8c_source.html#l00666">ofd_fs_cleanup()</a>, and <a class="el" href="ofd__fs_8c_source.html#l00621">ofd_fs_setup()</a>.</p>

</div>
</div>
<a class="anchor" id="a6ed155b23c822c61f6eacf4eda65d847"></a><!-- doxytag: member="ofd_internal.h::ofd_seqs_free" ref="a6ed155b23c822c61f6eacf4eda65d847" args="(const struct lu_env *env, struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_seqs_free </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Free sequence structures on OFD. </p>
<p>This function is part of OFD cleanup process, it goes through the list of <a class="el" href="structofd__seq.html">ofd_seq</a> structures stored in <a class="el" href="structofd__device.html">ofd_device</a> structure and frees them.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fs_8c_source.html#l00304">304</a> of file <a class="el" href="ofd__fs_8c_source.html">ofd_fs.c</a>.</p>

<p>References <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="list_8h_source.html#l00125">list_del_init()</a>, <a class="el" href="list_8h_source.html#l00161">list_empty()</a>, <a class="el" href="list_8h_source.html#l00484">list_for_each_entry_safe</a>, <a class="el" href="list_8h_source.html#l00137">list_move()</a>, <a class="el" href="list_8h_source.html#l00043">list_head::next</a>, <a class="el" href="ofd__internal_8h_source.html#l00132">ofd_device::ofd_seq_list</a>, <a class="el" href="ofd__internal_8h_source.html#l00133">ofd_device::ofd_seq_list_lock</a>, <a class="el" href="ofd__fs_8c_source.html#l00109">ofd_seq_put()</a>, and <a class="el" href="ofd__internal_8h_source.html#l00107">ofd_seq::os_list</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l00528">ofd_lfsck_out_notify()</a>, and <a class="el" href="ofd__fs_8c_source.html#l00332">ofd_seqs_fini()</a>.</p>

</div>
</div>
<a class="anchor" id="a8e0f9a8309ee9b967ccc0f52efaa8a80"></a><!-- doxytag: member="ofd_internal.h::ofd_seqs_init" ref="a8e0f9a8309ee9b967ccc0f52efaa8a80" args="(const struct lu_env *env, struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_seqs_init </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize SEQ and FLD service on OFD. </p>
<p>This is part of OFD setup process.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on successful services initialization </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__fs_8c_source.html#l00572">572</a> of file <a class="el" href="ofd__fs_8c_source.html">ofd_fs.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="list_8h_source.html#l00048">INIT_LIST_HEAD</a>, <a class="el" href="ofd__dev_8c_source.html#l00802">ofd_fid_fini()</a>, <a class="el" href="ofd__dev_8c_source.html#l00824">ofd_fid_init()</a>, <a class="el" href="ofd__fs_8c_source.html#l00283">ofd_fld_fini()</a>, <a class="el" href="ofd__fs_8c_source.html#l00449">ofd_fld_init()</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="ofd__fs_8c_source.html#l00527">ofd_register_seq_exp()</a>, <a class="el" href="ofd__internal_8h_source.html#l00134">ofd_device::ofd_seq_count</a>, <a class="el" href="ofd__internal_8h_source.html#l00132">ofd_device::ofd_seq_list</a>, <a class="el" href="ofd__internal_8h_source.html#l00133">ofd_device::ofd_seq_list_lock</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__fs_8c_source.html#l00621">ofd_fs_setup()</a>.</p>

</div>
</div>
<a class="anchor" id="a40fe40101c0614c64acbde80d766e470"></a><!-- doxytag: member="ofd_internal.h::ofd_slc_set" ref="a40fe40101c0614c64acbde80d766e470" args="(struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_slc_set </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00554">554</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="obd_8h_source.html#l00144">ALWAYS_SYNC_ON_CANCEL</a>, <a class="el" href="lu__target_8h_source.html#l00135">lu_target::lut_sync_lock_cancel</a>, <a class="el" href="obd_8h_source.html#l00142">NEVER_SYNC_ON_CANCEL</a>, <a class="el" href="ofd__internal_8h_source.html#l00125">ofd_device::ofd_lut</a>, and <a class="el" href="ofd__internal_8h_source.html#l00175">ofd_device::ofd_syncjournal</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="abad8e9cb4f2bf23b5f26f3fa2064d164"></a><!-- doxytag: member="ofd_internal.h::ofd_start_inconsistency_verification_thread" ref="abad8e9cb4f2bf23b5f26f3fa2064d164" args="(struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_start_inconsistency_verification_thread </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start parent FID verification thread. </p>
<p>See <a class="el" href="ofd__io_8c.html#ae73678766b398ab02bc2d2cc9fbe0d90" title="Verification thread to check parent FID consistency.">ofd_inconsistency_verification_main()</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on successful start of thread </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__io_8c_source.html#l00247">247</a> of file <a class="el" href="ofd__io_8c_source.html">ofd_io.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00278">CERROR</a>, <a class="el" href="lustre__lib_8h_source.html#l00329">l_wait_event</a>, <a class="el" href="ofd__internal_8h_source.html#l00194">ofd_device::ofd_inconsistency_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00192">ofd_device::ofd_inconsistency_thread</a>, <a class="el" href="ofd__io_8c_source.html#l00154">ofd_inconsistency_verification_main()</a>, <a class="el" href="ofd__internal_8h_source.html#l00212">ofd_name()</a>, <a class="el" href="lustre__net_8h_source.html#l01532">ptlrpc_thread::t_ctl_waitq</a>, <a class="el" href="obd_8c_source.html#l00114">thread</a>, <a class="el" href="lustre__net_8h_source.html#l01557">thread_is_running()</a>, <a class="el" href="lustre__net_8h_source.html#l01542">thread_is_stopped()</a>, <a class="el" href="lustre__net_8h_source.html#l01577">thread_set_flags()</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="ad45ee8814249ae10c9afa9e7fcc73ce6"></a><!-- doxytag: member="ofd_internal.h::ofd_statfs" ref="ad45ee8814249ae10c9afa9e7fcc73ce6" args="(const struct lu_env *env, struct obd_export *exp, struct obd_statfs *osfs, __u64 max_age, __u32 flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_statfs </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__export.html">obd_export</a> *&nbsp;</td>
          <td class="paramname"> <em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__statfs.html">obd_statfs</a> *&nbsp;</td>
          <td class="paramname"> <em>osfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>max_age</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implementation of <a class="el" href="structobd__ops.html#a3290ce3a9029a8715d49b42778683c7a">obd_ops::o_statfs</a>. </p>
<p>This function returns information about a storage file system. It is called from several places by using the OBD API as well as by direct call, e.g. from request handler.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="ofd__dev_8c.html#af6be8cdea32bea774b3422720a4aeabf" title="OFD request handler for OST_STATFS RPC.">ofd_statfs_hdl()</a> for request <a class="el" href="rename__many_8c.html#a3c2348f39cf58c5c0f48742b32b15d83">handler</a> function.</dd></dl>
<p>Report also the state of the OST to the caller in osfs-&gt;os_state (OS_STATE_READONLY, OS_STATE_DEGRADED).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>exp</em>&nbsp;</td><td>OBD export of OFD device </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>osfs</em>&nbsp;</td><td>statistic data to return </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>max_age</em>&nbsp;</td><td>maximum age for cached data </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>flags</em>&nbsp;</td><td>not used in OFD</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__obd_8c_source.html#l00806">806</a> of file <a class="el" href="ofd__obd_8c_source.html">ofd_obd.c</a>.</p>

<p>References <a class="el" href="libcfs__debug_8h_source.html#l00259">CDEBUG</a>, <a class="el" href="genops_8c_source.html#l00729">class_exp2obd()</a>, <a class="el" href="ofd__internal_8h_source.html#l00443">COMPAT_BSIZE_SHIFT</a>, <a class="el" href="libcfs__debug_8h_source.html#l00134">D_CACHE</a>, <a class="el" href="libcfs__debug_8h_source.html#l00131">D_SUPER</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="flock_8c_source.html#l00090">EXIT</a>, <a class="el" href="lustre__export_8h_source.html#l00304">exp_connect_flags()</a>, <a class="el" href="lustre__export_8h_source.html#l00112">filter_export_data::fed_grant</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="libcfs_2include_2libcfs_2types_8h_source.html#l00045">LPU64</a>, <a class="el" href="lustre__disk_8h_source.html#l00344">lr_server_data::lsd_osd_index</a>, <a class="el" href="lu__target_8h_source.html#l00144">lu_target::lut_lsd</a>, <a class="el" href="osc__internal_8h_source.html#l00177">min_t</a>, <a class="el" href="lustre__idl_8h_source.html#l01181">OBD_CONNECT_MDS</a>, <a class="el" href="obd__support_8h_source.html#l00620">OBD_FAIL_CHECK_VALUE</a>, <a class="el" href="obd__support_8h_source.html#l00320">OBD_FAIL_OST_ENOINO</a>, <a class="el" href="obd__support_8h_source.html#l00300">OBD_FAIL_OST_ENOSPC</a>, <a class="el" href="obd_8h_source.html#l00655">obd_device::obd_self_export</a>, <a class="el" href="ofd__internal_8h_source.html#l00143">ofd_device::ofd_blockbits</a>, <a class="el" href="ofd__internal_8h_source.html#l00207">ofd_exp()</a>, <a class="el" href="ofd__internal_8h_source.html#l00435">ofd_grant_param_supp()</a>, <a class="el" href="ofd__grant_8c_source.html#l00147">ofd_grant_sanity_check()</a>, <a class="el" href="ofd__internal_8h_source.html#l00125">ofd_device::ofd_lut</a>, <a class="el" href="ofd__internal_8h_source.html#l00175">ofd_device::ofd_raid_degraded</a>, <a class="el" href="ofd__obd_8c_source.html#l00701">ofd_statfs_internal()</a>, <a class="el" href="ofd__internal_8h_source.html#l00159">ofd_device::ofd_tot_dirty</a>, <a class="el" href="ofd__internal_8h_source.html#l00161">ofd_device::ofd_tot_granted</a>, <a class="el" href="ofd__internal_8h_source.html#l00163">ofd_device::ofd_tot_pending</a>, <a class="el" href="lustre__user_8h_source.html#l00111">obd_statfs::os_bavail</a>, <a class="el" href="lustre__user_8h_source.html#l00110">obd_statfs::os_bfree</a>, <a class="el" href="lustre__user_8h_source.html#l00109">obd_statfs::os_blocks</a>, <a class="el" href="lustre__user_8h_source.html#l00115">obd_statfs::os_bsize</a>, <a class="el" href="lustre__user_8h_source.html#l00113">obd_statfs::os_ffree</a>, <a class="el" href="lustre__user_8h_source.html#l00112">obd_statfs::os_files</a>, <a class="el" href="lustre__user_8h_source.html#l00118">obd_statfs::os_state</a>, <a class="el" href="lustre__user_8h_source.html#l00100">OS_STATE_DEGRADED</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01913">ofd_statfs_hdl()</a>.</p>

</div>
</div>
<a class="anchor" id="a74db0692a1936a385df730c631e73178"></a><!-- doxytag: member="ofd_internal.h::ofd_statfs_internal" ref="a74db0692a1936a385df730c631e73178" args="(const struct lu_env *env, struct ofd_device *ofd, struct obd_statfs *osfs, __u64 max_age, int *from_cache)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_statfs_internal </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobd__statfs.html">obd_statfs</a> *&nbsp;</td>
          <td class="paramname"> <em>osfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>&nbsp;</td>
          <td class="paramname"> <em>max_age</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>from_cache</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get file system statistics of OST server. </p>
<p>Helper function for <a class="el" href="ofd__internal_8h.html#ad45ee8814249ae10c9afa9e7fcc73ce6" title="Implementation of obd_ops::o_statfs.">ofd_statfs()</a>, also used by grant code. Implements caching for statistics to avoid calling OSD device each time.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>osfs</em>&nbsp;</td><td>statistic data to return </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>max_age</em>&nbsp;</td><td>maximum age for cached data </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>from_cache</em>&nbsp;</td><td>show that data was get from cache or not</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__obd_8c_source.html#l00701">701</a> of file <a class="el" href="ofd__obd_8c_source.html">ofd_obd.c</a>.</p>

<p>References <a class="el" href="linux-time_8h_source.html#l00248">cfs_time_before_64()</a>, <a class="el" href="linux-time_8h_source.html#l00235">cfs_time_current_64</a>, <a class="el" href="dt__object_8h_source.html#l02437">dt_statfs()</a>, <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="small__write_8c_source.html#l00044">GOTO</a>, <a class="el" href="osc__internal_8h_source.html#l00177">min_t</a>, <a class="el" href="ofd__internal_8h_source.html#l00143">ofd_device::ofd_blockbits</a>, <a class="el" href="ofd__internal_8h_source.html#l00157">ofd_device::ofd_grant_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, <a class="el" href="ofd__internal_8h_source.html#l00141">ofd_device::ofd_osfs</a>, <a class="el" href="ofd__internal_8h_source.html#l00142">ofd_device::ofd_osfs_age</a>, <a class="el" href="ofd__internal_8h_source.html#l00153">ofd_device::ofd_osfs_inflight</a>, <a class="el" href="ofd__internal_8h_source.html#l00139">ofd_device::ofd_osfs_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00146">ofd_device::ofd_osfs_unstable</a>, <a class="el" href="ofd__internal_8h_source.html#l00150">ofd_device::ofd_statfs_inflight</a>, <a class="el" href="ofd__internal_8h_source.html#l00163">ofd_device::ofd_tot_pending</a>, <a class="el" href="lustre__user_8h_source.html#l00111">obd_statfs::os_bavail</a>, and <a class="el" href="libcfs__private_8h_source.html#l00310">unlikely</a>.</p>

<p>Referenced by <a class="el" href="ofd__grant_8c_source.html#l00290">ofd_grant_statfs()</a>, <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>, and <a class="el" href="ofd__obd_8c_source.html#l00806">ofd_statfs()</a>.</p>

</div>
</div>
<a class="anchor" id="adce0d9126693d57d473e86e92997c061"></a><!-- doxytag: member="ofd_internal.h::ofd_stats_counter_init" ref="adce0d9126693d57d473e86e92997c061" args="(struct lprocfs_stats *stats)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_stats_counter_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlprocfs__stats.html">lprocfs_stats</a> *&nbsp;</td>
          <td class="paramname"> <em>stats</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00396">396</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>Referenced by <a class="el" href="ofd__obd_8c_source.html#l00067">ofd_export_stats_init()</a>, and <a class="el" href="ofd__dev_8c_source.html#l00681">ofd_procfs_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a0aca95140be0eaf4b18bac3e2db396da"></a><!-- doxytag: member="ofd_internal.h::ofd_stop_inconsistency_verification_thread" ref="a0aca95140be0eaf4b18bac3e2db396da" args="(struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_stop_inconsistency_verification_thread </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stop parent FID verification thread. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on successful start of thread </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-EALREADY</em>&nbsp;</td><td>if thread is already stopped </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__io_8c_source.html#l00288">288</a> of file <a class="el" href="ofd__io_8c_source.html">ofd_io.c</a>.</p>

<p>References <a class="el" href="lustre__lib_8h_source.html#l00329">l_wait_event</a>, <a class="el" href="ofd__internal_8h_source.html#l00194">ofd_device::ofd_inconsistency_lock</a>, <a class="el" href="ofd__internal_8h_source.html#l00192">ofd_device::ofd_inconsistency_thread</a>, <a class="el" href="lustre__net_8h_source.html#l01495">SVC_STOPPING</a>, <a class="el" href="lustre__net_8h_source.html#l01532">ptlrpc_thread::t_ctl_waitq</a>, <a class="el" href="obd_8c_source.html#l00114">thread</a>, <a class="el" href="lustre__net_8h_source.html#l01537">thread_is_init()</a>, <a class="el" href="lustre__net_8h_source.html#l01542">thread_is_stopped()</a>, and <a class="el" href="lustre__net_8h_source.html#l01577">thread_set_flags()</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02983">ofd_fini()</a>.</p>

</div>
</div>
<a class="anchor" id="a08d8d088e838713b409b0351fd9f0ebe"></a><!-- doxytag: member="ofd_internal.h::ofd_trans_create" ref="a08d8d088e838713b409b0351fd9f0ebe" args="(const struct lu_env *env, struct ofd_device *ofd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structthandle.html">thandle</a>* ofd_trans_create </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create new transaction in OFD. </p>
<p>This function creates a transaction with <a class="el" href="group__dt.html#ga689a89697bff3936cf4d60bd2651dc8a">dt_trans_create()</a> and makes it synchronous if required by the export state.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>struct</em>&nbsp;</td><td><a class="el" href="structthandle.html" title="This is the general purpose transaction handle.">thandle</a> if transaction was created successfully </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ERR_PTR</em>&nbsp;</td><td>on negative value in case of error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__trans_8c_source.html#l00057">57</a> of file <a class="el" href="ofd__trans_8c_source.html">ofd_trans.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l02047">dt_trans_create()</a>, <a class="el" href="lustre__export_8h_source.html#l00245">obd_export::exp_need_sync</a>, <a class="el" href="ofd__internal_8h_source.html#l00294">ofd_thread_info::fti_exp</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, and <a class="el" href="dt__object_8h_source.html#l01848">thandle::th_sync</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__io_8c_source.html#l01009">ofd_commitrw_write()</a>, <a class="el" href="ofd__objects_8c_source.html#l00722">ofd_object_destroy()</a>, <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>, <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>, and <a class="el" href="ofd__io_8c_source.html#l00813">ofd_write_attr_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a68e23d460b9e82c290f2c0b8fa08b086"></a><!-- doxytag: member="ofd_internal.h::ofd_trans_start" ref="a68e23d460b9e82c290f2c0b8fa08b086" args="(const struct lu_env *env, struct ofd_device *ofd, struct ofd_object *fo, struct thandle *th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_trans_start </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start transaction in OFD. </p>
<p>This function updates the given <em>obj</em> object version and calls <a class="el" href="group__dt.html#ga93ebb43b2740f8628a781a8dcfd23f6b">dt_trans_start()</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>obj</em>&nbsp;</td><td>OFD object affected by this transaction </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>transaction handle</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if successful </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>negative</em>&nbsp;</td><td>value in case of error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__trans_8c_source.html#l00089">89</a> of file <a class="el" href="ofd__trans_8c_source.html">ofd_trans.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l02054">dt_trans_start()</a>, <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, and <a class="el" href="lu__target_8h_source.html#l00245">tgt_vbr_obj_set()</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__io_8c_source.html#l01009">ofd_commitrw_write()</a>, <a class="el" href="ofd__objects_8c_source.html#l00722">ofd_object_destroy()</a>, and <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>.</p>

</div>
</div>
<a class="anchor" id="a384bafbc8a5652ed745ac484ba7ceefe"></a><!-- doxytag: member="ofd_internal.h::ofd_trans_stop" ref="a384bafbc8a5652ed745ac484ba7ceefe" args="(const struct lu_env *env, struct ofd_device *ofd, struct thandle *th, int rc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ofd_trans_stop </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__device.html">ofd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>ofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stop transaction in OFD. </p>
<p>This function fills <a class="el" href="structthandle.html#a768f192711e7d5c5280da153173cb463" title="the last operation result in this transaction.">thandle::th_result</a> with result of whole operation and calls <a class="el" href="group__dt.html#gac5cb16311e5767ec9068c9aac417628a">dt_trans_stop()</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ofd</em>&nbsp;</td><td>OFD device </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>th</em>&nbsp;</td><td>transaction handle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rc</em>&nbsp;</td><td>result code of whole operation </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__trans_8c_source.html#l00110">110</a> of file <a class="el" href="ofd__trans_8c_source.html">ofd_trans.c</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l02070">dt_trans_stop()</a>, <a class="el" href="ofd__internal_8h_source.html#l00118">ofd_device::ofd_osd</a>, and <a class="el" href="dt__object_8h_source.html#l01845">thandle::th_result</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__io_8c_source.html#l01009">ofd_commitrw_write()</a>, <a class="el" href="ofd__objects_8c_source.html#l00722">ofd_object_destroy()</a>, <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>, and <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>.</p>

</div>
</div>
<a class="anchor" id="add3e10a12dc6751ec757027d934ee378"></a><!-- doxytag: member="ofd_internal.h::ofd_txn_stop_cb" ref="add3e10a12dc6751ec757027d934ee378" args="(const struct lu_env *env, struct thandle *txn, void *cookie)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_txn_stop_cb </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structthandle.html">thandle</a> *&nbsp;</td>
          <td class="paramname"> <em>txn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>cookie</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aea6c312b1e6a241a81a51050dffb8bc5"></a><!-- doxytag: member="ofd_internal.h::ofd_verify_ff" ref="aea6c312b1e6a241a81a51050dffb8bc5" args="(const struct lu_env *env, struct ofd_object *fo, struct obdo *oa)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ofd_verify_ff </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structobdo.html">obdo</a> *&nbsp;</td>
          <td class="paramname"> <em>oa</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verify parent FID of an object. </p>
<p>Check the parent FID is sane and start extended verification procedure otherwise.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>execution environment </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fo</em>&nbsp;</td><td>OFD object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>oa</em>&nbsp;</td><td>OBDO structure with PFID</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on successful verification </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-EINPROGRESS</em>&nbsp;</td><td>if PFID is being repaired </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-EPERM</em>&nbsp;</td><td>if PFID was verified but still insane </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ofd__io_8c_source.html#l00378">378</a> of file <a class="el" href="ofd__io_8c_source.html">ofd_io.c</a>.</p>

<p>References <a class="el" href="flock_8c_source.html#l00061">ENTRY</a>, <a class="el" href="lustre__user_8h_source.html#l00147">lu_fid::f_oid</a>, <a class="el" href="lustre__user_8h_source.html#l00145">lu_fid::f_seq</a>, <a class="el" href="lustre__idl_8h_source.html#l00793">fid_is_sane()</a>, <a class="el" href="libcfs__private_8h_source.html#l00309">likely</a>, <a class="el" href="lustre__idl_8h_source.html#l03400">obdo::o_parent_oid</a>, <a class="el" href="lustre__idl_8h_source.html#l03385">obdo::o_parent_seq</a>, <a class="el" href="lustre__idl_8h_source.html#l03404">obdo::o_stripe_idx</a>, <a class="el" href="ofd__io_8c_source.html#l00320">ofd_add_inconsistency_item()</a>, <a class="el" href="ofd__objects_8c_source.html#l00138">ofd_object_ff_load()</a>, <a class="el" href="ofd__internal_8h_source.html#l00220">ofd_object::ofo_pfid</a>, <a class="el" href="ofd__internal_8h_source.html#l00221">ofd_object::ofo_pfid_checking</a>, <a class="el" href="ofd__internal_8h_source.html#l00221">ofd_object::ofo_pfid_verified</a>, and <a class="el" href="libcfs__debug_8h_source.html#l00352">RETURN</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>, <a class="el" href="ofd__io_8c_source.html#l00440">ofd_preprw_read()</a>, and <a class="el" href="ofd__io_8c_source.html#l00524">ofd_preprw_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a724ef660aab12afe48e0a40d530c0561"></a><!-- doxytag: member="ofd_internal.h::ofd_write_lock" ref="a724ef660aab12afe48e0a40d530c0561" args="(const struct lu_env *env, struct ofd_object *fo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_write_lock </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00271">271</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01751">dt_object::do_ops</a>, <a class="el" href="structdt__object__operations.html#a5bf582901eb4dcb781f03f02621535a2">dt_object_operations::do_write_lock</a>, and <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__io_8c_source.html#l00154">ofd_inconsistency_verification_main()</a>, <a class="el" href="ofd__io_8c_source.html#l00065">ofd_inconsistency_verify_one()</a>, <a class="el" href="ofd__objects_8c_source.html#l00722">ofd_object_destroy()</a>, <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>, and <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>.</p>

</div>
</div>
<a class="anchor" id="a86ec5e33746e5cf58f09a9fe497662fe"></a><!-- doxytag: member="ofd_internal.h::ofd_write_unlock" ref="a86ec5e33746e5cf58f09a9fe497662fe" args="(const struct lu_env *env, struct ofd_object *fo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ofd_write_unlock </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structofd__object.html">ofd_object</a> *&nbsp;</td>
          <td class="paramname"> <em>fo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00279">279</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="dt__object_8h_source.html#l01751">dt_object::do_ops</a>, <a class="el" href="structdt__object__operations.html#ad5346269fb80455252849f4fd7403720">dt_object_operations::do_write_unlock</a>, and <a class="el" href="ofd__internal_8h_source.html#l00243">ofd_object_child()</a>.</p>

<p>Referenced by <a class="el" href="ofd__objects_8c_source.html#l00491">ofd_attr_set()</a>, <a class="el" href="ofd__io_8c_source.html#l00154">ofd_inconsistency_verification_main()</a>, <a class="el" href="ofd__io_8c_source.html#l00065">ofd_inconsistency_verify_one()</a>, <a class="el" href="ofd__objects_8c_source.html#l00722">ofd_object_destroy()</a>, <a class="el" href="ofd__objects_8c_source.html#l00600">ofd_object_punch()</a>, and <a class="el" href="ofd__objects_8c_source.html#l00206">ofd_precreate_objects()</a>.</p>

</div>
</div>
<a class="anchor" id="ac3db3f215fff161c7d1276d6217b1bfc"></a><!-- doxytag: member="ofd_internal.h::target_recovery_fini" ref="ac3db3f215fff161c7d1276d6217b1bfc" args="(struct obd_device *obd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void target_recovery_fini </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structobd__device.html">obd_device</a> *&nbsp;</td>
          <td class="paramname"> <em>obd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a8c8ebefb0e9c977840de5620dfd7e655"></a><!-- doxytag: member="ofd_internal.h::target_recovery_init" ref="a8c8ebefb0e9c977840de5620dfd7e655" args="(struct lu_target *lut, svc_handler_t handler)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void target_recovery_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlu__target.html">lu_target</a> *&nbsp;</td>
          <td class="paramname"> <em>lut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__net.html#gaafdde121d699c66fbef23b0a702d1cb0">svc_handler_t</a>&nbsp;</td>
          <td class="paramname"> <em>handler</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae5479a564cd26fac4d4fcf5b74380883"></a><!-- doxytag: member="ofd_internal.h::tsi2ofd_info" ref="ae5479a564cd26fac4d4fcf5b74380883" args="(struct tgt_session_info *tsi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structofd__thread__info.html">ofd_thread_info</a>* tsi2ofd_info </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtgt__session__info.html">tgt_session_info</a> *&nbsp;</td>
          <td class="paramname"> <em>tsi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>VBR: take versions from request </p>
</p>

<p>Definition at line <a class="el" href="ofd__internal_8h_source.html#l00527">527</a> of file <a class="el" href="ofd__internal_8h_source.html">ofd_internal.h</a>.</p>

<p>References <a class="el" href="uapi__kernelcomm_8h.html#adc2adfee3162ec44eb82da5f869a806c">__u64</a>, <a class="el" href="ofd__internal_8h_source.html#l00299">ofd_thread_info::fti_attr</a>, <a class="el" href="ofd__internal_8h_source.html#l00292">ofd_thread_info::fti_env</a>, <a class="el" href="ofd__internal_8h_source.html#l00294">ofd_thread_info::fti_exp</a>, <a class="el" href="ofd__internal_8h_source.html#l00296">ofd_thread_info::fti_pre_version</a>, <a class="el" href="ofd__internal_8h_source.html#l00295">ofd_thread_info::fti_xid</a>, <a class="el" href="lu__object_8h_source.html#l00439">lu_attr::la_valid</a>, <a class="el" href="utils_2wirehdr_8c_source.html#l00044">LASSERT</a>, <a class="el" href="pack__generic_8c_source.html#l00829">lustre_msg_get_flags()</a>, <a class="el" href="pack__generic_8c_source.html#l01062">lustre_msg_get_versions()</a>, <a class="el" href="lustre__idl_8h_source.html#l01154">MSG_REPLAY</a>, <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>, <a class="el" href="lustre__net_8h_source.html#l01030">ptlrpc_request::rq_reqmsg</a>, <a class="el" href="lustre__net_8h_source.html#l01036">ptlrpc_request::rq_xid</a>, <a class="el" href="lu__target_8h_source.html#l00334">tgt_ses_req()</a>, <a class="el" href="lu__target_8h_source.html#l00203">tgt_session_info::tsi_env</a>, and <a class="el" href="lu__target_8h_source.html#l00202">tgt_session_info::tsi_exp</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l01825">ofd_destroy_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01136">ofd_get_info_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01281">ofd_getattr_hdl()</a>, <a class="el" href="ofd__io_8c_source.html#l00685">ofd_preprw()</a>, <a class="el" href="ofd__dev_8c_source.html#l02007">ofd_punch_hdl()</a>, <a class="el" href="ofd__dev_8c_source.html#l01363">ofd_setattr_hdl()</a>, and <a class="el" href="ofd__dev_8c_source.html#l01948">ofd_sync_hdl()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="af322483570ead4fcf76f62f40afe5cd8"></a><!-- doxytag: member="ofd_internal.h::ofd_lvbo" ref="af322483570ead4fcf76f62f40afe5cd8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structldlm__valblock__ops.html">ldlm_valblock_ops</a> <a class="el" href="ofd__lvb_8c.html#af322483570ead4fcf76f62f40afe5cd8">ofd_lvbo</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__lvb_8c_source.html#l00383">383</a> of file <a class="el" href="ofd__lvb_8c_source.html">ofd_lvb.c</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l02814">ofd_init0()</a>.</p>

</div>
</div>
<a class="anchor" id="a6e86af7981400cf59dc30181a66397cb"></a><!-- doxytag: member="ofd_internal.h::ofd_obd_ops" ref="a6e86af7981400cf59dc30181a66397cb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structobd__ops.html">obd_ops</a> <a class="el" href="ofd__obd_8c.html#a6e86af7981400cf59dc30181a66397cb">ofd_obd_ops</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__obd_8c_source.html#l01476">1476</a> of file <a class="el" href="ofd__obd_8c_source.html">ofd_obd.c</a>.</p>

<p>Referenced by <a class="el" href="ofd__dev_8c_source.html#l03123">ofd_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a5715d5d1456c6eabe4053582059eb50f"></a><!-- doxytag: member="ofd_internal.h::ofd_thread_key" ref="a5715d5d1456c6eabe4053582059eb50f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlu__context__key.html">lu_context_key</a> <a class="el" href="ofd__internal_8h.html#a5715d5d1456c6eabe4053582059eb50f">ofd_thread_key</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ofd__dev_8c_source.html#l02792">2792</a> of file <a class="el" href="ofd__dev_8c_source.html">ofd_dev.c</a>.</p>

<p>Referenced by <a class="el" href="ofd__internal_8h_source.html#l00501">ofd_info()</a>.</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:54:49 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
