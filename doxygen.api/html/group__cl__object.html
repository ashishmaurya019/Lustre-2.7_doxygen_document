<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: cl_object</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>cl_object<br/>
<small>
[<a class="el" href="group__clio.html">clio</a>]</small>
</h1>
<p><div class="dynheader">
Collaboration diagram for cl_object:</div>
<div class="dynsection">
<center><table><tr><td><img src="group__cl__object.png" border="0" alt="" usemap="#group____cl____object_map"/>
<map name="group____cl____object_map" id="group____cl____object">
<area shape="rect" id="node1" href="group__clio.html" title="Client objects implement io operations and cache pages." alt="" coords="7,5,49,35"/></map></td></tr></table></center>
</div>
</p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcl__attr.html">cl_attr</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">"Data attributes" of <a class="el" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a>.  <a href="structcl__attr.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcl__object.html">cl_object</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sub-class of <a class="el" href="structlu__object.html" title="Layer in the layered object.">lu_object</a> with methods common for objects on the client stacks.  <a href="structcl__object.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcl__object__conf.html">cl_object_conf</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Description of the client object configuration.  <a href="structcl__object__conf.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcl__layout.html">cl_layout</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcl__object__operations.html">cl_object_operations</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Operations implemented for each cl object layer.  <a href="structcl__object__operations.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcl__object__header.html">cl_object_header</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extended header for client object.  <a href="structcl__object__header.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#ga6477841d5f3bd9c2a2ca05e2aa089ea9">cl_object_for_each</a>(slice, obj)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper macro: iterate over all layers of the object <em>obj</em>, assigning every layer top-to-bottom to <em>slice</em>.  <a href="#ga6477841d5f3bd9c2a2ca05e2aa089ea9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#gade758968f8d058a2849df2f8f3e70762">cl_object_for_each_reverse</a>(slice, obj)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper macro: iterate over all layers of the object <em>obj</em>, assigning every layer bottom-to-top to <em>slice</em>.  <a href="#gade758968f8d058a2849df2f8f3e70762"></a><br/></td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#ga48fd4da7a215ef4bcc31582adceb8b83">cl_attr_valid</a> { <br/>
&nbsp;&nbsp;<b>CAT_SIZE</b> =  1 &lt;&lt; 0, 
<b>CAT_KMS</b> =  1 &lt;&lt; 1, 
<b>CAT_MTIME</b> =  1 &lt;&lt; 3, 
<b>CAT_ATIME</b> =  1 &lt;&lt; 4, 
<br/>
&nbsp;&nbsp;<b>CAT_CTIME</b> =  1 &lt;&lt; 5, 
<b>CAT_BLOCKS</b> =  1 &lt;&lt; 6, 
<b>CAT_UID</b> =  1 &lt;&lt; 7, 
<b>CAT_GID</b> =  1 &lt;&lt; 8
<br/>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Fields in <a class="el" href="structcl__attr.html" title="&quot;Data attributes&quot; of cl_object.">cl_attr</a> that are being set. </p>
<br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="group__cl__object.html#gga99fb83031ce9923c84392b4e92f956b5afbab2abc5d277403ef84e9bcd75ee7e5">OBJECT_CONF_SET</a> =  0, 
<a class="el" href="group__cl__object.html#gga99fb83031ce9923c84392b4e92f956b5a008009ec8f83b28274d90a650cca813b">OBJECT_CONF_INVALIDATE</a> =  1, 
<a class="el" href="group__cl__object.html#gga99fb83031ce9923c84392b4e92f956b5a916b610eabe05c138a1717820f9a0696">OBJECT_CONF_WAIT</a> =  2
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <b>CL_LAYOUT_GEN_NONE</b> =  (u32)-2, 
<b>CL_LAYOUT_GEN_EMPTY</b> =  (u32)-1
 }</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#ga00ef0f7240b9a7d773a49a77c667f03a">cl_object_top</a> (struct <a class="el" href="structcl__object.html">cl_object</a> *o)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the top-object for a given <em>o</em>.  <a href="#ga00ef0f7240b9a7d773a49a77c667f03a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#gacc02a64c0c65d5fab9a6fafc83771acd">cl_object_find</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__device.html">cl_device</a> *cd, const struct <a class="el" href="structlu__fid.html">lu_fid</a> *fid, const struct <a class="el" href="structcl__object__conf.html">cl_object_conf</a> *c)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a <a class="el" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> with a given <em>fid</em>.  <a href="#gacc02a64c0c65d5fab9a6fafc83771acd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga0e1e8f1e195acfd9ad600b33e8f183e7"></a><!-- doxytag: member="cl_object::cl_object_header_init" ref="ga0e1e8f1e195acfd9ad600b33e8f183e7" args="(struct cl_object_header *h)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#ga0e1e8f1e195acfd9ad600b33e8f183e7">cl_object_header_init</a> (struct <a class="el" href="structcl__object__header.html">cl_object_header</a> *h)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize <a class="el" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga76b88e11955bc3109371ae6194189d25"></a><!-- doxytag: member="cl_object::cl_object_header_fini" ref="ga76b88e11955bc3109371ae6194189d25" args="(struct cl_object_header *h)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#ga76b88e11955bc3109371ae6194189d25">cl_object_header_fini</a> (struct <a class="el" href="structcl__object__header.html">cl_object_header</a> *h)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Finalize <a class="el" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#ga61a377b8d6ccf182357c959cfdbbcf16">cl_object_put</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__object.html">cl_object</a> *o)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Releases a reference on <em>o</em>.  <a href="#ga61a377b8d6ccf182357c959cfdbbcf16"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#gae84de86afc6e9dbf1f9e1a7219bd202b">cl_object_get</a> (struct <a class="el" href="structcl__object.html">cl_object</a> *o)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Acquire an additional reference to the object <em>o</em>.  <a href="#gae84de86afc6e9dbf1f9e1a7219bd202b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#ga0ab97a8a879d5a81b4b5d60367e0ff0a">cl_object_attr_lock</a> (struct <a class="el" href="structcl__object.html">cl_object</a> *o)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Locks data-attributes.  <a href="#ga0ab97a8a879d5a81b4b5d60367e0ff0a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga2fc69699a9214cda8ac2e8264b709dac"></a><!-- doxytag: member="cl_object::cl_object_attr_unlock" ref="ga2fc69699a9214cda8ac2e8264b709dac" args="(struct cl_object *o)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#ga2fc69699a9214cda8ac2e8264b709dac">cl_object_attr_unlock</a> (struct <a class="el" href="structcl__object.html">cl_object</a> *o)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Releases data-attributes lock, acquired by <a class="el" href="group__cl__object.html#ga0ab97a8a879d5a81b4b5d60367e0ff0a" title="Locks data-attributes.">cl_object_attr_lock()</a>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#gadfa2c03f781edcc53976843d94c18b48">cl_object_attr_get</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__object.html">cl_object</a> *obj, struct <a class="el" href="structcl__attr.html">cl_attr</a> *attr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns data-attributes of an object <em>obj</em>.  <a href="#gadfa2c03f781edcc53976843d94c18b48"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#gaaa4c4e2f092946a662c321e1aa7a4aab">cl_object_attr_update</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__object.html">cl_object</a> *obj, const struct <a class="el" href="structcl__attr.html">cl_attr</a> *attr, unsigned valid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates data-attributes of an object <em>obj</em>.  <a href="#gaaa4c4e2f092946a662c321e1aa7a4aab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#gaeed557c8f4926f9d6492df7026fd4b13">cl_object_glimpse</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__object.html">cl_object</a> *obj, struct <a class="el" href="structost__lvb.html">ost_lvb</a> *lvb)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Notifies layers (bottom-to-top) that glimpse AST was received.  <a href="#gaeed557c8f4926f9d6492df7026fd4b13"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga2e572a2e5a92e017e5d45187657e3f94"></a><!-- doxytag: member="cl_object::cl_conf_set" ref="ga2e572a2e5a92e017e5d45187657e3f94" args="(const struct lu_env *env, struct cl_object *obj, const struct cl_object_conf *conf)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#ga2e572a2e5a92e017e5d45187657e3f94">cl_conf_set</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__object.html">cl_object</a> *obj, const struct <a class="el" href="structcl__object__conf.html">cl_object_conf</a> *conf)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates a configuration of an object <em>obj</em>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gacbefea6c611d782bb7ccfac4be7f3ec9"></a><!-- doxytag: member="cl_object::cl_object_prune" ref="gacbefea6c611d782bb7ccfac4be7f3ec9" args="(const struct lu_env *env, struct cl_object *obj)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#gacbefea6c611d782bb7ccfac4be7f3ec9">cl_object_prune</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__object.html">cl_object</a> *obj)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prunes caches of pages and locks for this object. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#ga2969ac9d2e4cce406eb1bfa24838964f">cl_object_kill</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__object.html">cl_object</a> *obj)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper function removing all object locks, and marking object for deletion.  <a href="#ga2969ac9d2e4cce406eb1bfa24838964f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga746cc5d7737450ca64ba6997f3e9afd8"></a><!-- doxytag: member="cl_object::cl_object_getstripe" ref="ga746cc5d7737450ca64ba6997f3e9afd8" args="(const struct lu_env *env, struct cl_object *obj, struct lov_user_md __user *lum)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#ga746cc5d7737450ca64ba6997f3e9afd8">cl_object_getstripe</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__object.html">cl_object</a> *obj, struct lov_user_md __user *lum)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get stripe information of this object. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html#gae661d62a9c4af07425119b1308c3ff61">cl_object_fiemap</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__object.html">cl_object</a> *obj, struct <a class="el" href="structll__fiemap__info__key.html">ll_fiemap_info_key</a> *fmkey, struct fiemap *fiemap, size_t *buflen)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get fiemap extents from file object.  <a href="#gae661d62a9c4af07425119b1308c3ff61"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaed35f941df7b7d63305b33783313b235"></a><!-- doxytag: member="cl_object::cl_object_layout_get" ref="gaed35f941df7b7d63305b33783313b235" args="(const struct lu_env *env, struct cl_object *obj, struct cl_layout *cl)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>cl_object_layout_get</b> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__object.html">cl_object</a> *obj, struct <a class="el" href="structcl__layout.html">cl_layout</a> *cl)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa30ca80e8a50712e8ccf910be0bf0845"></a><!-- doxytag: member="cl_object::cl_object_maxbytes" ref="gaa30ca80e8a50712e8ccf910be0bf0845" args="(struct cl_object *obj)" -->
loff_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>cl_object_maxbytes</b> (struct <a class="el" href="structcl__object.html">cl_object</a> *obj)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ga6477841d5f3bd9c2a2ca05e2aa089ea9"></a><!-- doxytag: member="cl_object.h::cl_object_for_each" ref="ga6477841d5f3bd9c2a2ca05e2aa089ea9" args="(slice, obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define cl_object_for_each</td>
          <td>(</td>
          <td class="paramtype">slice, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">obj&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">list_for_each_entry((slice),                            \
                            &amp;(obj)-&gt;<a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>.<a class="code" href="structlu__object.html#ab55ad0889ad4d306d0a5aad7ed0aa398" title="Header for this object.">lo_header</a>-&gt;<a class="code" href="structlu__object__header.html#a1a4f1dbeb2aadfe34d9d11ed0ede12ec" title="Linkage into list of layers.">loh_layers</a>,\
                            <a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>.<a class="code" href="structlu__object.html#a40275d310eb13538f41291f1cf7cba77" title="Linkage into list of all layers.">lo_linkage</a>)
</pre></div>
<p>Helper macro: iterate over all layers of the object <em>obj</em>, assigning every layer top-to-bottom to <em>slice</em>. </p>

<p>Definition at line <a class="el" href="cl__object_8h_source.html#l00454">454</a> of file <a class="el" href="cl__object_8h_source.html">cl_object.h</a>.</p>

<p>Referenced by <a class="el" href="cl__io_8c_source.html#l01174">cl_req_attr_set()</a>.</p>

</div>
</div>
<a class="anchor" id="gade758968f8d058a2849df2f8f3e70762"></a><!-- doxytag: member="cl_object.h::cl_object_for_each_reverse" ref="gade758968f8d058a2849df2f8f3e70762" args="(slice, obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define cl_object_for_each_reverse</td>
          <td>(</td>
          <td class="paramtype">slice, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">obj&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">list_for_each_entry_reverse((slice),                            \
                                    &amp;(obj)-&gt;<a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>.<a class="code" href="structlu__object.html#ab55ad0889ad4d306d0a5aad7ed0aa398" title="Header for this object.">lo_header</a>-&gt;<a class="code" href="structlu__object__header.html#a1a4f1dbeb2aadfe34d9d11ed0ede12ec" title="Linkage into list of layers.">loh_layers</a>,\
                                    <a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>.<a class="code" href="structlu__object.html#a40275d310eb13538f41291f1cf7cba77" title="Linkage into list of all layers.">lo_linkage</a>)
</pre></div>
<p>Helper macro: iterate over all layers of the object <em>obj</em>, assigning every layer bottom-to-top to <em>slice</em>. </p>

<p>Definition at line <a class="el" href="cl__object_8h_source.html#l00463">463</a> of file <a class="el" href="cl__object_8h_source.html">cl_object.h</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="ga99fb83031ce9923c84392b4e92f956b5"></a><!-- doxytag: member="cl_object.h::@2" ref="ga99fb83031ce9923c84392b4e92f956b5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga99fb83031ce9923c84392b4e92f956b5afbab2abc5d277403ef84e9bcd75ee7e5"></a><!-- doxytag: member="OBJECT_CONF_SET" ref="gga99fb83031ce9923c84392b4e92f956b5afbab2abc5d277403ef84e9bcd75ee7e5" args="" -->OBJECT_CONF_SET</em>&nbsp;</td><td>
<p>configure layout, set up a new stripe, must be called while holding layout lock. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga99fb83031ce9923c84392b4e92f956b5a008009ec8f83b28274d90a650cca813b"></a><!-- doxytag: member="OBJECT_CONF_INVALIDATE" ref="gga99fb83031ce9923c84392b4e92f956b5a008009ec8f83b28274d90a650cca813b" args="" -->OBJECT_CONF_INVALIDATE</em>&nbsp;</td><td>
<p>invalidate the current stripe configuration due to losing layout lock. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga99fb83031ce9923c84392b4e92f956b5a916b610eabe05c138a1717820f9a0696"></a><!-- doxytag: member="OBJECT_CONF_WAIT" ref="gga99fb83031ce9923c84392b4e92f956b5a916b610eabe05c138a1717820f9a0696" args="" -->OBJECT_CONF_WAIT</em>&nbsp;</td><td>
<p>wait for old layout to go away so that new layout can be set up. </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="cl__object_8h_source.html#l00267">267</a> of file <a class="el" href="cl__object_8h_source.html">cl_object.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00267"></a>00267      {
<a name="l00270"></a>00270         <a class="code" href="group__cl__object.html#gga99fb83031ce9923c84392b4e92f956b5afbab2abc5d277403ef84e9bcd75ee7e5" title="configure layout, set up a new stripe, must be called while holding layout lock.">OBJECT_CONF_SET</a> = 0,
<a name="l00273"></a>00273         <a class="code" href="group__cl__object.html#gga99fb83031ce9923c84392b4e92f956b5a008009ec8f83b28274d90a650cca813b" title="invalidate the current stripe configuration due to losing layout lock.">OBJECT_CONF_INVALIDATE</a> = 1,
<a name="l00276"></a>00276         <a class="code" href="group__cl__object.html#gga99fb83031ce9923c84392b4e92f956b5a916b610eabe05c138a1717820f9a0696" title="wait for old layout to go away so that new layout can be set up.">OBJECT_CONF_WAIT</a> = 2
<a name="l00277"></a>00277 };
</pre></div></p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gadfa2c03f781edcc53976843d94c18b48"></a><!-- doxytag: member="cl_object.h::cl_object_attr_get" ref="gadfa2c03f781edcc53976843d94c18b48" args="(const struct lu_env *env, struct cl_object *obj, struct cl_attr *attr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cl_object_attr_get </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__attr.html">cl_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns data-attributes of an object <em>obj</em>. </p>
<p>Every layer is asked (by calling <a class="el" href="structcl__object__operations.html#a63cabd646365a83d06c0e8eae0fe633f" title="Fill portion of attr that this layer controls.">cl_object_operations::coo_attr_get()</a>) top-to-bottom to fill in parts of <em>attr</em> that this layer is responsible for. </p>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00204">204</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00227">co_lu</a>, <a class="el" href="cl__object_8h_source.html#l00229">co_ops</a>, <a class="el" href="structcl__object__operations.html#a63cabd646365a83d06c0e8eae0fe633f">cl_object_operations::coo_attr_get</a>, <a class="el" href="lu__object_8h_source.html#l00468">lu_object::lo_header</a>, and <a class="el" href="lu__object_8h_source.html#l00552">lu_object_header::loh_layers</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00206"></a>00206 {
<a name="l00207"></a>00207         <span class="keyword">struct </span><a class="code" href="structlu__object__header.html" title="&amp;quot;Compound&amp;quot; object, consisting of multiple layers.">lu_object_header</a> *top;
<a name="l00208"></a>00208         <span class="keywordtype">int</span> result;
<a name="l00209"></a>00209 
<a name="l00210"></a>00210         assert_spin_locked(cl_object_attr_guard(obj));
<a name="l00211"></a>00211         ENTRY;
<a name="l00212"></a>00212 
<a name="l00213"></a>00213         top = obj-&gt;<a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>.<a class="code" href="structlu__object.html#ab55ad0889ad4d306d0a5aad7ed0aa398" title="Header for this object.">lo_header</a>;
<a name="l00214"></a>00214         result = 0;
<a name="l00215"></a>00215         list_for_each_entry(obj, &amp;top-&gt;<a class="code" href="structlu__object__header.html#a1a4f1dbeb2aadfe34d9d11ed0ede12ec" title="Linkage into list of layers.">loh_layers</a>, co_lu.lo_linkage) {
<a name="l00216"></a>00216                 <span class="keywordflow">if</span> (obj-&gt;<a class="code" href="structcl__object.html#a84db2d531bbd895d49cc44b795778064" title="per-object-layer operations">co_ops</a>-&gt;<a class="code" href="structcl__object__operations.html#a63cabd646365a83d06c0e8eae0fe633f" title="Fill portion of attr that this layer controls.">coo_attr_get</a> != NULL) {
<a name="l00217"></a>00217                         result = obj-&gt;<a class="code" href="structcl__object.html#a84db2d531bbd895d49cc44b795778064" title="per-object-layer operations">co_ops</a>-&gt;<a class="code" href="structcl__object__operations.html#a63cabd646365a83d06c0e8eae0fe633f" title="Fill portion of attr that this layer controls.">coo_attr_get</a>(env, obj, attr);
<a name="l00218"></a>00218                         <span class="keywordflow">if</span> (result != 0) {
<a name="l00219"></a>00219                                 <span class="keywordflow">if</span> (result &gt; 0)
<a name="l00220"></a>00220                                         result = 0;
<a name="l00221"></a>00221                                 <span class="keywordflow">break</span>;
<a name="l00222"></a>00222                         }
<a name="l00223"></a>00223                 }
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225         RETURN(result);
<a name="l00226"></a>00226 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga0ab97a8a879d5a81b4b5d60367e0ff0a"></a><!-- doxytag: member="cl_object.h::cl_object_attr_lock" ref="ga0ab97a8a879d5a81b4b5d60367e0ff0a" args="(struct cl_object *o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cl_object_attr_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Locks data-attributes. </p>
<p>Prevents data-attributes from changing, until lock is released by <a class="el" href="group__cl__object.html#ga2fc69699a9214cda8ac2e8264b709dac" title="Releases data-attributes lock, acquired by cl_object_attr_lock().">cl_object_attr_unlock()</a>. This has to be called before calls to <a class="el" href="group__cl__object.html#gadfa2c03f781edcc53976843d94c18b48" title="Returns data-attributes of an object obj.">cl_object_attr_get()</a>, <a class="el" href="group__cl__object.html#gaaa4c4e2f092946a662c321e1aa7a4aab" title="Updates data-attributes of an object obj.">cl_object_attr_update()</a>. </p>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00180">180</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00182"></a>00182 {
<a name="l00183"></a>00183         spin_lock(cl_object_attr_guard(o));
<a name="l00184"></a>00184 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="gaaa4c4e2f092946a662c321e1aa7a4aab"></a><!-- doxytag: member="cl_object.h::cl_object_attr_update" ref="gaaa4c4e2f092946a662c321e1aa7a4aab" args="(const struct lu_env *env, struct cl_object *obj, const struct cl_attr *attr, unsigned valid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cl_object_attr_update </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structcl__attr.html">cl_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>v</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Updates data-attributes of an object <em>obj</em>. </p>
<p>Only attributes, mentioned in a validness bit-mask <em>v</em> are updated. Calls cl_object_operations::coo_upd_attr() on every layer, bottom to top. </p>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00236">236</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00227">co_lu</a>, <a class="el" href="cl__object_8h_source.html#l00229">co_ops</a>, <a class="el" href="structcl__object__operations.html#add30d6bf56d89a425b3980a1184558ab">cl_object_operations::coo_attr_update</a>, <a class="el" href="lu__object_8h_source.html#l00468">lu_object::lo_header</a>, and <a class="el" href="lu__object_8h_source.html#l00552">lu_object_header::loh_layers</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00238"></a>00238 {
<a name="l00239"></a>00239         <span class="keyword">struct </span><a class="code" href="structlu__object__header.html" title="&amp;quot;Compound&amp;quot; object, consisting of multiple layers.">lu_object_header</a> *top;
<a name="l00240"></a>00240         <span class="keywordtype">int</span> result;
<a name="l00241"></a>00241 
<a name="l00242"></a>00242         assert_spin_locked(cl_object_attr_guard(obj));
<a name="l00243"></a>00243         ENTRY;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245         top = obj-&gt;<a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>.<a class="code" href="structlu__object.html#ab55ad0889ad4d306d0a5aad7ed0aa398" title="Header for this object.">lo_header</a>;
<a name="l00246"></a>00246         result = 0;
<a name="l00247"></a>00247         list_for_each_entry_reverse(obj, &amp;top-&gt;<a class="code" href="structlu__object__header.html#a1a4f1dbeb2aadfe34d9d11ed0ede12ec" title="Linkage into list of layers.">loh_layers</a>, co_lu.lo_linkage) {
<a name="l00248"></a>00248                 <span class="keywordflow">if</span> (obj-&gt;<a class="code" href="structcl__object.html#a84db2d531bbd895d49cc44b795778064" title="per-object-layer operations">co_ops</a>-&gt;<a class="code" href="structcl__object__operations.html#add30d6bf56d89a425b3980a1184558ab" title="Update attributes.">coo_attr_update</a> != NULL) {
<a name="l00249"></a>00249                         result = obj-&gt;<a class="code" href="structcl__object.html#a84db2d531bbd895d49cc44b795778064" title="per-object-layer operations">co_ops</a>-&gt;<a class="code" href="structcl__object__operations.html#add30d6bf56d89a425b3980a1184558ab" title="Update attributes.">coo_attr_update</a>(env, obj, attr,
<a name="l00250"></a>00250                                                               v);
<a name="l00251"></a>00251                         <span class="keywordflow">if</span> (result != 0) {
<a name="l00252"></a>00252                                 <span class="keywordflow">if</span> (result &gt; 0)
<a name="l00253"></a>00253                                         result = 0;
<a name="l00254"></a>00254                                 <span class="keywordflow">break</span>;
<a name="l00255"></a>00255                         }
<a name="l00256"></a>00256                 }
<a name="l00257"></a>00257         }
<a name="l00258"></a>00258         RETURN(result);
<a name="l00259"></a>00259 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="gae661d62a9c4af07425119b1308c3ff61"></a><!-- doxytag: member="cl_object.h::cl_object_fiemap" ref="gae661d62a9c4af07425119b1308c3ff61" args="(const struct lu_env *env, struct cl_object *obj, struct ll_fiemap_info_key *fmkey, struct fiemap *fiemap, size_t *buflen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cl_object_fiemap </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structll__fiemap__info__key.html">ll_fiemap_info_key</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct fiemap *&nbsp;</td>
          <td class="paramname"> <em>fiemap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>buflen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get fiemap extents from file object. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>env</em>&nbsp;</td><td>[in] lustre environment </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>obj</em>&nbsp;</td><td>[in] file object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>[in] fiemap request argument </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fiemap</em>&nbsp;</td><td>[out] fiemap extents mapping retrived </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buflen</em>&nbsp;</td><td>[in] max buffer length of </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>&lt;</em>&nbsp;</td><td>0 error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00376">376</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00227">co_lu</a>, <a class="el" href="cl__object_8h_source.html#l00229">co_ops</a>, <a class="el" href="structcl__object__operations.html#ab2deed25a532503a0b8a2b5ba9e48479">cl_object_operations::coo_fiemap</a>, <a class="el" href="lu__object_8h_source.html#l00468">lu_object::lo_header</a>, and <a class="el" href="lu__object_8h_source.html#l00552">lu_object_header::loh_layers</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00379"></a>00379 {
<a name="l00380"></a>00380         <span class="keyword">struct </span><a class="code" href="structlu__object__header.html" title="&amp;quot;Compound&amp;quot; object, consisting of multiple layers.">lu_object_header</a> *top;
<a name="l00381"></a>00381         <span class="keywordtype">int</span>                     result = 0;
<a name="l00382"></a>00382         ENTRY;
<a name="l00383"></a>00383 
<a name="l00384"></a>00384         top = obj-&gt;<a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>.<a class="code" href="structlu__object.html#ab55ad0889ad4d306d0a5aad7ed0aa398" title="Header for this object.">lo_header</a>;
<a name="l00385"></a>00385         list_for_each_entry(obj, &amp;top-&gt;<a class="code" href="structlu__object__header.html#a1a4f1dbeb2aadfe34d9d11ed0ede12ec" title="Linkage into list of layers.">loh_layers</a>, co_lu.lo_linkage) {
<a name="l00386"></a>00386                 <span class="keywordflow">if</span> (obj-&gt;<a class="code" href="structcl__object.html#a84db2d531bbd895d49cc44b795778064" title="per-object-layer operations">co_ops</a>-&gt;<a class="code" href="structcl__object__operations.html#ab2deed25a532503a0b8a2b5ba9e48479" title="Get FIEMAP mapping from the object.">coo_fiemap</a> != NULL) {
<a name="l00387"></a>00387                         result = obj-&gt;<a class="code" href="structcl__object.html#a84db2d531bbd895d49cc44b795778064" title="per-object-layer operations">co_ops</a>-&gt;<a class="code" href="structcl__object__operations.html#ab2deed25a532503a0b8a2b5ba9e48479" title="Get FIEMAP mapping from the object.">coo_fiemap</a>(env, obj, key, fiemap,
<a name="l00388"></a>00388                                                          buflen);
<a name="l00389"></a>00389                         <span class="keywordflow">if</span> (result != 0)
<a name="l00390"></a>00390                                 <span class="keywordflow">break</span>;
<a name="l00391"></a>00391                 }
<a name="l00392"></a>00392         }
<a name="l00393"></a>00393         RETURN(result);
<a name="l00394"></a>00394 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="gacc02a64c0c65d5fab9a6fafc83771acd"></a><!-- doxytag: member="cl_object.h::cl_object_find" ref="gacc02a64c0c65d5fab9a6fafc83771acd" args="(const struct lu_env *env, struct cl_device *cd, const struct lu_fid *fid, const struct cl_object_conf *c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcl__object.html">cl_object</a>* cl_object_find </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__device.html">cl_device</a> *&nbsp;</td>
          <td class="paramname"> <em>cd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlu__fid.html">lu_fid</a> *&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structcl__object__conf.html">cl_object_conf</a> *&nbsp;</td>
          <td class="paramname"> <em>c</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns a <a class="el" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> with a given <em>fid</em>. </p>
<p>Returns either cached or newly created object. Additional reference on the returned object is acquired.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__lu.html#ga507da2d12daef52e3859b9b96d0ae591" title="Search cache for an object with the fid f.">lu_object_find()</a>, <a class="el" href="group__cl__page.html#ga448fbdaea940886c756e4a2d659982ba" title="Returns a cl_page with index idx at the object o, and associated with the VM page...">cl_page_find()</a>, cl_lock_find() </dd></dl>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00103">103</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00241">cl_object_conf::coc_lu</a>, and <a class="el" href="lu__object_8c_source.html#l00808">lu_object_find_slice()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00106"></a>00106 {
<a name="l00107"></a>00107         might_sleep();
<a name="l00108"></a>00108         <span class="keywordflow">return</span> lu2cl(<a class="code" href="group__lu.html#ga54cb269068bb3767dde66b0bb58afb70" title="Find object with given fid, and return its slice belonging to given device.">lu_object_find_slice</a>(env, cl2lu_dev(cd), fid, &amp;c-&gt;<a class="code" href="structcl__object__conf.html#a2dae6350547faf461529cfa61811385c" title="Super-class.">coc_lu</a>));
<a name="l00109"></a>00109 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="group__cl__object_gacc02a64c0c65d5fab9a6fafc83771acd_cgraph.png" border="0" usemap="#group__cl__object_gacc02a64c0c65d5fab9a6fafc83771acd_cgraph_map" alt=""></div>
<map name="group__cl__object_gacc02a64c0c65d5fab9a6fafc83771acd_cgraph_map" id="group__cl__object_gacc02a64c0c65d5fab9a6fafc83771acd_cgraph">
<area shape="rect" id="node3" href="group__lu.html#ga54cb269068bb3767dde66b0bb58afb70" title="Find object with given fid, and return its slice belonging to given device." alt="" coords="168,59,320,88"/><area shape="rect" id="node5" href="group__lu.html#ga507da2d12daef52e3859b9b96d0ae591" title="Search cache for an object with the fid f." alt="" coords="379,5,493,35"/><area shape="rect" id="node9" href="group__lu.html#gaee34b6396491c109bd66e4c055dd7189" title="Given a compound object, find its slice, corresponding to the device type dtype." alt="" coords="369,59,503,88"/><area shape="rect" id="node11" href="group__lu.html#ga0d53e3777af7b81492a1178c75b872ea" title="Decrease reference counter on object." alt="" coords="379,112,493,141"/><area shape="rect" id="node7" href="group__lu.html#gad0df5edda743e3ab2a9165faecb8656b" title="Much like lu_object_find(), but top level device of object is specifically dev rather..." alt="" coords="553,5,689,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gae84de86afc6e9dbf1f9e1a7219bd202b"></a><!-- doxytag: member="cl_object.h::cl_object_get" ref="gae84de86afc6e9dbf1f9e1a7219bd202b" args="(struct cl_object *o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cl_object_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Acquire an additional reference to the object <em>o</em>. </p>
<p>This can only be used to acquire _additional_ reference, i.e., caller already has to possess at least one reference to <em>o</em> before calling this.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__cl__page.html#gafc2fc785c3daf1db46bb250244dfde13" title="Acquires an additional reference to a page.">cl_page_get()</a>, cl_lock_get(). </dd></dl>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00134">134</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00227">co_lu</a>.</p>

<p>Referenced by <a class="el" href="osc__page_8c_source.html#l00667">osc_lru_shrink()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00135"></a>00135 {
<a name="l00136"></a>00136         lu_object_get(&amp;o-&gt;<a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>);
<a name="l00137"></a>00137 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="group__cl__object_gae84de86afc6e9dbf1f9e1a7219bd202b_icgraph.png" border="0" usemap="#group__cl__object_gae84de86afc6e9dbf1f9e1a7219bd202b_icgraph_map" alt=""></div>
<map name="group__cl__object_gae84de86afc6e9dbf1f9e1a7219bd202b_icgraph_map" id="group__cl__object_gae84de86afc6e9dbf1f9e1a7219bd202b_icgraph">
<area shape="rect" id="node3" href="group__osc.html#gacad2bab69d5c52c6248c0b76fcf1e93a" title="Drop &#160;of pages from LRU at most." alt="" coords="169,5,281,35"/><area shape="rect" id="node5" href="group__osc.html#ga084c788be8d116db87ebdd3c273d9a23" title="Scan and try to reclaim sc&#45;&gt;nr_to_scan cached LRU pages." alt="" coords="331,5,507,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaeed557c8f4926f9d6492df7026fd4b13"></a><!-- doxytag: member="cl_object.h::cl_object_glimpse" ref="gaeed557c8f4926f9d6492df7026fd4b13" args="(const struct lu_env *env, struct cl_object *obj, struct ost_lvb *lvb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cl_object_glimpse </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structost__lvb.html">ost_lvb</a> *&nbsp;</td>
          <td class="paramname"> <em>lvb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Notifies layers (bottom-to-top) that glimpse AST was received. </p>
<p>Layers have to fill <em>lvb</em> fields with information that will be shipped back to glimpse issuer.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>cl_lock_operations::clo_glimpse() </dd></dl>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00270">270</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00227">co_lu</a>, <a class="el" href="cl__object_8h_source.html#l00229">co_ops</a>, <a class="el" href="structcl__object__operations.html#a1cacda5692e51d04da73eed3fdbf37c6">cl_object_operations::coo_glimpse</a>, <a class="el" href="lu__object_8h_source.html#l00468">lu_object::lo_header</a>, <a class="el" href="lu__object_8h_source.html#l00552">lu_object_header::loh_layers</a>, and <a class="el" href="lu__object_8h_source.html#l00812">LU_OBJECT_HEADER</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00272"></a>00272 {
<a name="l00273"></a>00273         <span class="keyword">struct </span><a class="code" href="structlu__object__header.html" title="&amp;quot;Compound&amp;quot; object, consisting of multiple layers.">lu_object_header</a> *top;
<a name="l00274"></a>00274         <span class="keywordtype">int</span> result;
<a name="l00275"></a>00275 
<a name="l00276"></a>00276         ENTRY;
<a name="l00277"></a>00277         top = obj-&gt;<a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>.<a class="code" href="structlu__object.html#ab55ad0889ad4d306d0a5aad7ed0aa398" title="Header for this object.">lo_header</a>;
<a name="l00278"></a>00278         result = 0;
<a name="l00279"></a>00279         list_for_each_entry_reverse(obj, &amp;top-&gt;<a class="code" href="structlu__object__header.html#a1a4f1dbeb2aadfe34d9d11ed0ede12ec" title="Linkage into list of layers.">loh_layers</a>, co_lu.lo_linkage) {
<a name="l00280"></a>00280                 <span class="keywordflow">if</span> (obj-&gt;<a class="code" href="structcl__object.html#a84db2d531bbd895d49cc44b795778064" title="per-object-layer operations">co_ops</a>-&gt;<a class="code" href="structcl__object__operations.html#a1cacda5692e51d04da73eed3fdbf37c6" title="Glimpse ast.">coo_glimpse</a> != NULL) {
<a name="l00281"></a>00281                         result = obj-&gt;<a class="code" href="structcl__object.html#a84db2d531bbd895d49cc44b795778064" title="per-object-layer operations">co_ops</a>-&gt;<a class="code" href="structcl__object__operations.html#a1cacda5692e51d04da73eed3fdbf37c6" title="Glimpse ast.">coo_glimpse</a>(env, obj, lvb);
<a name="l00282"></a>00282                         <span class="keywordflow">if</span> (result != 0)
<a name="l00283"></a>00283                                 <span class="keywordflow">break</span>;
<a name="l00284"></a>00284                 }
<a name="l00285"></a>00285         }
<a name="l00286"></a>00286         <a class="code" href="group__lu.html#gab6811b221fe08d6e5b46ce532fdd1059" title="Print short object description followed by a user-supplied message.">LU_OBJECT_HEADER</a>(D_DLMTRACE, env, lu_object_top(top),
<a name="l00287"></a>00287                          <span class="stringliteral">&quot;size: &quot;</span>LPU64<span class="stringliteral">&quot; mtime: &quot;</span>LPU64<span class="stringliteral">&quot; atime: &quot;</span>LPU64<span class="stringliteral">&quot; &quot;</span>
<a name="l00288"></a>00288                          <span class="stringliteral">&quot;ctime: &quot;</span>LPU64<span class="stringliteral">&quot; blocks: &quot;</span>LPU64<span class="stringliteral">&quot;\n&quot;</span>,
<a name="l00289"></a>00289                          lvb-&gt;lvb_size, lvb-&gt;lvb_mtime, lvb-&gt;lvb_atime,
<a name="l00290"></a>00290                          lvb-&gt;lvb_ctime, lvb-&gt;lvb_blocks);
<a name="l00291"></a>00291         RETURN(result);
<a name="l00292"></a>00292 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga2969ac9d2e4cce406eb1bfa24838964f"></a><!-- doxytag: member="cl_object.h::cl_object_kill" ref="ga2969ac9d2e4cce406eb1bfa24838964f" args="(const struct lu_env *env, struct cl_object *obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cl_object_kill </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Helper function removing all object locks, and marking object for deletion. </p>
<p>All object pages must have been deleted at this point.</p>
<p>This is called by cl_inode_fini() and lov_object_delete() to destroy top- and sub- objects respectively. </p>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00435">435</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00421">cl_object_header::coh_lu</a>, <a class="el" href="lu__object_8h_source.html#l00530">lu_object_header::loh_flags</a>, and <a class="el" href="lu__object_8h_source.html#l00493">LU_OBJECT_HEARD_BANSHEE</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00436"></a>00436 {
<a name="l00437"></a>00437         <span class="keyword">struct </span><a class="code" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a> *hdr = <a class="code" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a>(obj);
<a name="l00438"></a>00438 
<a name="l00439"></a>00439         set_bit(<a class="code" href="group__lu.html#gga519a2e6103ae639c8df1777d311cc985aca9a04f530d5436e7996a1ff142d01d0" title="Don&amp;#39;t keep this object in cache.">LU_OBJECT_HEARD_BANSHEE</a>, &amp;hdr-&gt;<a class="code" href="structcl__object__header.html#ae1f6b59740d6bf9e0bbc6d8786fbc677" title="Standard lu_object_header.">coh_lu</a>.<a class="code" href="structlu__object__header.html#a85952a1c723e48ffa0bb7024438ac08f" title="Object flags from enum lu_object_header_flags.">loh_flags</a>);
<a name="l00440"></a>00440 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga61a377b8d6ccf182357c959cfdbbcf16"></a><!-- doxytag: member="cl_object.h::cl_object_put" ref="ga61a377b8d6ccf182357c959cfdbbcf16" args="(const struct lu_env *env, struct cl_object *o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cl_object_put </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Releases a reference on <em>o</em>. </p>
<p>When last reference is released object is returned to the cache, unless <a class="el" href="group__lu.html#gga519a2e6103ae639c8df1777d311cc985aca9a04f530d5436e7996a1ff142d01d0" title="Don&#39;t keep this object in cache.">lu_object_header_flags::LU_OBJECT_HEARD_BANSHEE</a> bit is set in its header.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__cl__page.html#ga1dc4205fd892e559c96ce97aad4eebf1" title="Releases a reference to a page.">cl_page_put()</a>, cl_lock_put(). </dd></dl>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00120">120</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00227">co_lu</a>, and <a class="el" href="lu__object_8c_source.html#l00097">lu_object_put()</a>.</p>

<p>Referenced by <a class="el" href="osc__page_8c_source.html#l00667">osc_lru_shrink()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00121"></a>00121 {
<a name="l00122"></a>00122         <a class="code" href="group__lu.html#ga0d53e3777af7b81492a1178c75b872ea" title="Decrease reference counter on object.">lu_object_put</a>(env, &amp;o-&gt;<a class="code" href="structcl__object.html#acff3a09f38d513eda81deb6644332c2d" title="super class">co_lu</a>);
<a name="l00123"></a>00123 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="group__cl__object_ga61a377b8d6ccf182357c959cfdbbcf16_cgraph.png" border="0" usemap="#group__cl__object_ga61a377b8d6ccf182357c959cfdbbcf16_cgraph_map" alt=""></div>
<map name="group__cl__object_ga61a377b8d6ccf182357c959cfdbbcf16_cgraph_map" id="group__cl__object_ga61a377b8d6ccf182357c959cfdbbcf16_cgraph">
<area shape="rect" id="node3" href="group__lu.html#ga0d53e3777af7b81492a1178c75b872ea" title="Decrease reference counter on object." alt="" coords="168,5,283,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="group__cl__object_ga61a377b8d6ccf182357c959cfdbbcf16_icgraph.png" border="0" usemap="#group__cl__object_ga61a377b8d6ccf182357c959cfdbbcf16_icgraph_map" alt=""></div>
<map name="group__cl__object_ga61a377b8d6ccf182357c959cfdbbcf16_icgraph_map" id="group__cl__object_ga61a377b8d6ccf182357c959cfdbbcf16_icgraph">
<area shape="rect" id="node3" href="group__osc.html#gacad2bab69d5c52c6248c0b76fcf1e93a" title="Drop &#160;of pages from LRU at most." alt="" coords="169,5,281,35"/><area shape="rect" id="node5" href="group__osc.html#ga084c788be8d116db87ebdd3c273d9a23" title="Scan and try to reclaim sc&#45;&gt;nr_to_scan cached LRU pages." alt="" coords="331,5,507,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga00ef0f7240b9a7d773a49a77c667f03a"></a><!-- doxytag: member="cl_object.h::cl_object_top" ref="ga00ef0f7240b9a7d773a49a77c667f03a" args="(struct cl_object *o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcl__object.html">cl_object</a>* cl_object_top </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the top-object for a given <em>o</em>. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__cl__io.html#ga4bb065eb52291173dbda9a0721b1ea2c" title="Returns top-level io.">cl_io_top()</a> </dd></dl>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00145">145</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00421">cl_object_header::coh_lu</a>, and <a class="el" href="cl__object_8h_source.html#l00430">cl_object_header::coh_parent</a>.</p>

<p>Referenced by <a class="el" href="cl__io_8c_source.html#l00211">cl_io_init()</a>, and <a class="el" href="cl__io_8c_source.html#l00189">cl_io_sub_init()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00146"></a>00146 {
<a name="l00147"></a>00147         <span class="keyword">struct </span><a class="code" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a> *hdr = <a class="code" href="structcl__object__header.html" title="Extended header for client object.">cl_object_header</a>(o);
<a name="l00148"></a>00148         <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *top;
<a name="l00149"></a>00149 
<a name="l00150"></a>00150         <span class="keywordflow">while</span> (hdr-&gt;<a class="code" href="structcl__object__header.html#a8c0f69348f6ae0a74edf0411d7f69d37" title="Parent object.">coh_parent</a> != NULL)
<a name="l00151"></a>00151                 hdr = hdr-&gt;<a class="code" href="structcl__object__header.html#a8c0f69348f6ae0a74edf0411d7f69d37" title="Parent object.">coh_parent</a>;
<a name="l00152"></a>00152 
<a name="l00153"></a>00153         top = lu2cl(lu_object_top(&amp;hdr-&gt;<a class="code" href="structcl__object__header.html#ae1f6b59740d6bf9e0bbc6d8786fbc677" title="Standard lu_object_header.">coh_lu</a>));
<a name="l00154"></a>00154         CDEBUG(D_TRACE, <span class="stringliteral">&quot;%p -&gt; %p\n&quot;</span>, o, top);
<a name="l00155"></a>00155         <span class="keywordflow">return</span> top;
<a name="l00156"></a>00156 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="group__cl__object_ga00ef0f7240b9a7d773a49a77c667f03a_icgraph.png" border="0" usemap="#group__cl__object_ga00ef0f7240b9a7d773a49a77c667f03a_icgraph_map" alt=""></div>
<map name="group__cl__object_ga00ef0f7240b9a7d773a49a77c667f03a_icgraph_map" id="group__cl__object_ga00ef0f7240b9a7d773a49a77c667f03a_icgraph">
<area shape="rect" id="node3" href="group__cl__io.html#ga2a75c8a7a83eb31d6c899da9dc5143b1" title="Initialize io, by calling cl_io_operations::cio_init() top&#45;to&#45;bottom." alt="" coords="184,32,261,61"/><area shape="rect" id="node11" href="group__cl__io.html#ga485aa4a9e93475523519f07aca310bac" title="Initialize sub&#45;io, by calling cl_io_operations::cio_init() top&#45;to&#45;bottom." alt="" coords="168,85,277,115"/><area shape="rect" id="node5" href="group__cl__io.html#gacff72463468f75b6af811bf709aefa9d" title="Initialize read or write io." alt="" coords="332,5,433,35"/><area shape="rect" id="node7" href="group__osc.html#gacad2bab69d5c52c6248c0b76fcf1e93a" title="Drop &#160;of pages from LRU at most." alt="" coords="327,59,439,88"/><area shape="rect" id="node9" href="group__osc.html#ga084c788be8d116db87ebdd3c273d9a23" title="Scan and try to reclaim sc&#45;&gt;nr_to_scan cached LRU pages." alt="" coords="488,59,664,88"/></map>
</div>
</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:55:37 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
