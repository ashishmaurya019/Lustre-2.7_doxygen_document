<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: clio</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>clio</h1>
<p>Client objects implement io operations and cache pages.  
<a href="#_details">More...</a></p>

<p><div class="dynheader">
Collaboration diagram for clio:</div>
<div class="dynsection">
<center><table><tr><td><img src="group__clio.png" border="0" alt="" usemap="#group____clio_map"/>
<map name="group____clio_map" id="group____clio">
<area shape="rect" id="node2" href="group__cl__page__list.html" title="Page list used to perform collective operations on a group of pages." alt="" coords="100,5,199,35"/><area shape="rect" id="node3" href="group__cl__page.html" title="cl_page" alt="" coords="113,59,185,88"/><area shape="rect" id="node4" href="group__cl__sync__io.html" title="cl_sync_io" alt="" coords="105,112,193,141"/><area shape="rect" id="node5" href="group__cl__io.html" title="cl_io" alt="" coords="124,165,175,195"/><area shape="rect" id="node6" href="group__cl__lock.html" title="cl_lock" alt="" coords="116,219,183,248"/><area shape="rect" id="node7" href="group__cl__object.html" title="cl_object" alt="" coords="108,272,191,301"/><area shape="rect" id="node8" href="group__cl__env.html" title="lu_env handling for a client." alt="" coords="117,325,181,355"/></map></td></tr></table></center>
</div>
</p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcl__device.html">cl_device</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Device in the client stack.  <a href="structcl__device.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcl__req__attr.html">cl_req_attr</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Per-transfer attributes.  <a href="structcl__req__attr.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcache__stats.html">cache_stats</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stats for a generic cache (similar to inode, <a class="el" href="structlu__object.html" title="Layer in the layered object.">lu_object</a>, etc.  <a href="structcache__stats.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcl__site.html">cl_site</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Client-side site.  <a href="structcl__site.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Modules</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__object.html">cl_object</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__page.html">cl_page</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__lock.html">cl_lock</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__io.html">cl_io</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__page__list.html">cl_page_list</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Page list used to perform collective operations on a group of pages. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__sync__io.html">cl_sync_io</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cl__env.html">cl_env</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p><a class="el" href="structlu__env.html" title="Environment.">lu_env</a> handling for a client. </p>
<br/></td></tr>
</p>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gafe652221af494d72225936c18562922f"></a><!-- doxytag: member="clio::CL_PAGE_EOF" ref="gafe652221af494d72225936c18562922f" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>CL_PAGE_EOF</b>&nbsp;&nbsp;&nbsp;((pgoff_t)~0ull)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gab615588a450704f3b1c875ccfd9361de"></a><!-- doxytag: member="clio::CS_NAMES" ref="gab615588a450704f3b1c875ccfd9361de" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>CS_NAMES</b>&nbsp;&nbsp;&nbsp;{ &quot;lookup&quot;, &quot;hit&quot;, &quot;total&quot;, &quot;busy&quot;, &quot;create&quot; }</td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clio.html#gae65e5f5fa59d73bc289f6c6f6e566e52">cache_stats_item</a> { <br/>
&nbsp;&nbsp;<a class="el" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52aa453d6bdec4a9c94fa728d9ece3a682e">CS_lookup</a> =  0, 
<a class="el" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52af5a2cda59cd742b3182d202b1895f8d7">CS_hit</a>, 
<a class="el" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52a232ade650d55eb6e9554284682464b0b">CS_total</a>, 
<a class="el" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52a344d449ca6a9a6d812f7019929fd8a03">CS_busy</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52ae628f58c8c153c29328b6b5185bdff5a">CS_create</a>, 
<b>CS_NR</b>
<br/>
 }</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga1e4ceb0e1ebe73971d4b3e7f5efaad02"></a><!-- doxytag: member="clio::cache_stats_init" ref="ga1e4ceb0e1ebe73971d4b3e7f5efaad02" args="(struct cache_stats *cs, const char *name)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clio.html#ga1e4ceb0e1ebe73971d4b3e7f5efaad02">cache_stats_init</a> (struct <a class="el" href="structcache__stats.html">cache_stats</a> *cs, const char *name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">These are not exported so far. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clio.html#ga57611e1e5715dc94dd0eb503a72a8b33">cl_site_init</a> (struct <a class="el" href="structcl__site.html">cl_site</a> *s, struct <a class="el" href="structcl__device.html">cl_device</a> *top)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize client site.  <a href="#ga57611e1e5715dc94dd0eb503a72a8b33"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clio.html#ga5384082c04872b0c11252ead509cdd7a">cl_site_fini</a> (struct <a class="el" href="structcl__site.html">cl_site</a> *s)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Finalize client site.  <a href="#ga5384082c04872b0c11252ead509cdd7a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga0f3ca66265a771105086ea8d48cd814d"></a><!-- doxytag: member="clio::cl_stack_fini" ref="ga0f3ca66265a771105086ea8d48cd814d" args="(const struct lu_env *env, struct cl_device *cl)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clio.html#ga0f3ca66265a771105086ea8d48cd814d">cl_stack_fini</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__device.html">cl_device</a> *cl)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Finalize device stack by calling <a class="el" href="group__lu.html#gadaddcc81c2131ec1158c21f009cf1739" title="Finalize and free devices in the device stack.">lu_stack_fini()</a>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clio.html#ga5898f38acc8064feb8aecae6b0cbffd4">cl_site_stats_print</a> (const struct <a class="el" href="structcl__site.html">cl_site</a> *site, struct seq_file *m)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Output client site statistical counters into a buffer.  <a href="#ga5898f38acc8064feb8aecae6b0cbffd4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clio.html#ga596455746e16e88acee9318d8d95339d">cl_req_attr_set</a> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structcl__object.html">cl_object</a> *obj, struct <a class="el" href="structcl__req__attr.html">cl_req_attr</a> *attr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fills in attributes that are passed to server together with transfer.  <a href="#ga596455746e16e88acee9318d8d95339d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clio.html#ga5a05126b8b0aeb6f733aa358791aeed2">cl_attr2lvb</a> (struct <a class="el" href="structost__lvb.html">ost_lvb</a> *lvb, const struct <a class="el" href="structcl__attr.html">cl_attr</a> *attr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Converts struct <a class="el" href="structcl__attr.html" title="&quot;Data attributes&quot; of cl_object.">cl_attr</a> to struct <a class="el" href="structost__lvb.html">ost_lvb</a>.  <a href="#ga5a05126b8b0aeb6f733aa358791aeed2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clio.html#gad69ffcfdd3d835937721abdc10dd1098">cl_lvb2attr</a> (struct <a class="el" href="structcl__attr.html">cl_attr</a> *attr, const struct <a class="el" href="structost__lvb.html">ost_lvb</a> *lvb)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Converts struct <a class="el" href="structost__lvb.html">ost_lvb</a> to struct <a class="el" href="structcl__attr.html" title="&quot;Data attributes&quot; of cl_object.">cl_attr</a>.  <a href="#gad69ffcfdd3d835937721abdc10dd1098"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga673ce59def375f145c75249200d9dd53"></a><!-- doxytag: member="clio::cl_type_setup" ref="ga673ce59def375f145c75249200d9dd53" args="(const struct lu_env *env, struct lu_site *site, struct lu_device_type *ldt, struct lu_device *next)" -->
struct <a class="el" href="structcl__device.html">cl_device</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><b>cl_type_setup</b> (const struct <a class="el" href="structlu__env.html">lu_env</a> *env, struct <a class="el" href="structlu__site.html">lu_site</a> *site, struct <a class="el" href="structlu__device__type.html">lu_device_type</a> *ldt, struct <a class="el" href="structlu__device.html">lu_device</a> *next)</td></tr>
<tr><td colspan="2"><h2>helpers</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrpc2c3081275569a523f7b887c77722c5b"></a>Type conversion and accessory functions. </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clio.html#gaf9c2b2723494e52efc66d52fe2d0b93f">cl_page_slice_add</a> (struct <a class="el" href="structcl__page.html">cl_page</a> *page, struct <a class="el" href="structcl__page__slice.html">cl_page_slice</a> *slice, struct <a class="el" href="structcl__object.html">cl_object</a> *obj, pgoff_t index, const struct <a class="el" href="structcl__page__operations.html">cl_page_operations</a> *ops)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds page slice to the compound page.  <a href="#gaf9c2b2723494e52efc66d52fe2d0b93f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clio.html#ga9c2fdf8ae73a6f36bc8df4249459da93">cl_lock_slice_add</a> (struct <a class="el" href="structcl__lock.html">cl_lock</a> *lock, struct <a class="el" href="structcl__lock__slice.html">cl_lock_slice</a> *slice, struct <a class="el" href="structcl__object.html">cl_object</a> *obj, const struct <a class="el" href="structcl__lock__operations.html">cl_lock_operations</a> *ops)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds lock slice to the compound lock.  <a href="#ga9c2fdf8ae73a6f36bc8df4249459da93"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clio.html#ga7f11d31070279077648197650a60f10e">cl_io_slice_add</a> (struct <a class="el" href="structcl__io.html">cl_io</a> *io, struct <a class="el" href="structcl__io__slice.html">cl_io_slice</a> *slice, struct <a class="el" href="structcl__object.html">cl_object</a> *obj, const struct <a class="el" href="structcl__io__operations.html">cl_io_operations</a> *ops)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds io slice to the <a class="el" href="structcl__io.html" title="State for io.">cl_io</a>.  <a href="#ga7f11d31070279077648197650a60f10e"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Client objects implement io operations and cache pages. </p>
<p>Examples: lov and osc are implementations of cl interface.</p>
<p>Big Theory Statement.</p>
<p>Layered objects.</p>
<p>Client implementation is based on the following data-types:</p>
<ul>
<li><a class="el" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a></li>
</ul>
<ul>
<li><a class="el" href="structcl__page.html" title="Fields are protected by the lock on struct page, except for atomics and immutables...">cl_page</a></li>
</ul>
<ul>
<li><a class="el" href="structcl__lock.html" title="Layered client lock.">cl_lock</a> represents an extent lock on an object.</li>
</ul>
<ul>
<li><a class="el" href="structcl__io.html" title="State for io.">cl_io</a> represents high-level i/o activity such as whole read/write system call, or write-out of pages from under the lock being canceled. <a class="el" href="structcl__io.html" title="State for io.">cl_io</a> has sub-ios that can be stopped and resumed independently, thus achieving high degree of transfer parallelism. Single <a class="el" href="structcl__io.html" title="State for io.">cl_io</a> can be advanced forward by the multiple threads (although in the most usual case of read/write system call it is associated with the single user thread, that issued the system call).</li>
</ul>
<p>Terminology</p>
<ul>
<li>to avoid confusion high-level I/O operation like read or write system call is referred to as "an io", whereas low-level I/O operation, like RPC, is referred to as "a transfer"</li>
</ul>
<ul>
<li>"generic code" means generic (not file system specific) code in the hosting environment. "cl-code" means code (mostly in cl_*.c files) that is not layer specific.</li>
</ul>
<p>Locking.</p>
<ul>
<li>i_mutex<ul>
<li>PG_locked<ul>
<li>cl_object_header::coh_page_guard</li>
<li>lu_site::ls_guard</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>See the top comment in <a class="el" href="cl__object_8c_source.html">cl_object.c</a> for the description of overall locking and reference-counting design.</p>
<p>See comments below for the description of i/o, page, and dlm-locking design. </p>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="gae65e5f5fa59d73bc289f6c6f6e566e52"></a><!-- doxytag: member="cl_object.h::cache_stats_item" ref="gae65e5f5fa59d73bc289f6c6f6e566e52" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__clio.html#gae65e5f5fa59d73bc289f6c6f6e566e52">cache_stats_item</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggae65e5f5fa59d73bc289f6c6f6e566e52aa453d6bdec4a9c94fa728d9ece3a682e"></a><!-- doxytag: member="CS_lookup" ref="ggae65e5f5fa59d73bc289f6c6f6e566e52aa453d6bdec4a9c94fa728d9ece3a682e" args="" -->CS_lookup</em>&nbsp;</td><td>
<p>how many cache lookups were performed </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggae65e5f5fa59d73bc289f6c6f6e566e52af5a2cda59cd742b3182d202b1895f8d7"></a><!-- doxytag: member="CS_hit" ref="ggae65e5f5fa59d73bc289f6c6f6e566e52af5a2cda59cd742b3182d202b1895f8d7" args="" -->CS_hit</em>&nbsp;</td><td>
<p>how many times cache lookup resulted in a hit </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggae65e5f5fa59d73bc289f6c6f6e566e52a232ade650d55eb6e9554284682464b0b"></a><!-- doxytag: member="CS_total" ref="ggae65e5f5fa59d73bc289f6c6f6e566e52a232ade650d55eb6e9554284682464b0b" args="" -->CS_total</em>&nbsp;</td><td>
<p>how many entities are in the cache right now </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggae65e5f5fa59d73bc289f6c6f6e566e52a344d449ca6a9a6d812f7019929fd8a03"></a><!-- doxytag: member="CS_busy" ref="ggae65e5f5fa59d73bc289f6c6f6e566e52a344d449ca6a9a6d812f7019929fd8a03" args="" -->CS_busy</em>&nbsp;</td><td>
<p>how many entities in the cache are actively used (and cannot be evicted) right now </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggae65e5f5fa59d73bc289f6c6f6e566e52ae628f58c8c153c29328b6b5185bdff5a"></a><!-- doxytag: member="CS_create" ref="ggae65e5f5fa59d73bc289f6c6f6e566e52ae628f58c8c153c29328b6b5185bdff5a" args="" -->CS_create</em>&nbsp;</td><td>
<p>how many entities were created at all </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="cl__object_8h_source.html#l01873">1873</a> of file <a class="el" href="cl__object_8h_source.html">cl_object.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01873"></a>01873                       {
<a name="l01875"></a>01875         <a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52aa453d6bdec4a9c94fa728d9ece3a682e" title="how many cache lookups were performed">CS_lookup</a> = 0,
<a name="l01877"></a>01877         <a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52af5a2cda59cd742b3182d202b1895f8d7" title="how many times cache lookup resulted in a hit">CS_hit</a>,
<a name="l01879"></a>01879         <a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52a232ade650d55eb6e9554284682464b0b" title="how many entities are in the cache right now">CS_total</a>,
<a name="l01882"></a>01882         <a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52a344d449ca6a9a6d812f7019929fd8a03" title="how many entities in the cache are actively used (and cannot be evicted) right now...">CS_busy</a>,
<a name="l01884"></a>01884         <a class="code" href="group__clio.html#ggae65e5f5fa59d73bc289f6c6f6e566e52ae628f58c8c153c29328b6b5185bdff5a" title="how many entities were created at all">CS_create</a>,
<a name="l01885"></a>01885         CS_NR
<a name="l01886"></a>01886 };
</pre></div></p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga5a05126b8b0aeb6f733aa358791aeed2"></a><!-- doxytag: member="cl_object.h::cl_attr2lvb" ref="ga5a05126b8b0aeb6f733aa358791aeed2" args="(struct ost_lvb *lvb, const struct cl_attr *attr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cl_attr2lvb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structost__lvb.html">ost_lvb</a> *&nbsp;</td>
          <td class="paramname"> <em>lvb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structcl__attr.html">cl_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Converts struct <a class="el" href="structcl__attr.html" title="&quot;Data attributes&quot; of cl_object.">cl_attr</a> to struct <a class="el" href="structost__lvb.html">ost_lvb</a>. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__clio.html#gad69ffcfdd3d835937721abdc10dd1098" title="Converts struct ost_lvb to struct cl_attr.">cl_lvb2attr</a> </dd></dl>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l01116">1116</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00153">cl_attr::cat_atime</a>, <a class="el" href="cl__object_8h_source.html#l00161">cl_attr::cat_blocks</a>, <a class="el" href="cl__object_8h_source.html#l00155">cl_attr::cat_ctime</a>, <a class="el" href="cl__object_8h_source.html#l00151">cl_attr::cat_mtime</a>, and <a class="el" href="cl__object_8h_source.html#l00143">cl_attr::cat_size</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01117"></a>01117 {
<a name="l01118"></a>01118         ENTRY;
<a name="l01119"></a>01119         lvb-&gt;lvb_size   = attr-&gt;<a class="code" href="structcl__attr.html#a301cbfa8e597852a6f7cf1b5a22d5269" title="Object size, in bytes.">cat_size</a>;
<a name="l01120"></a>01120         lvb-&gt;lvb_mtime  = attr-&gt;<a class="code" href="structcl__attr.html#ac337ab4467993ed3c1ed8a74407e933b" title="Modification time.">cat_mtime</a>;
<a name="l01121"></a>01121         lvb-&gt;lvb_atime  = attr-&gt;<a class="code" href="structcl__attr.html#a703fa4a91dbf487ea43a491efbcbb26c" title="Access time.">cat_atime</a>;
<a name="l01122"></a>01122         lvb-&gt;lvb_ctime  = attr-&gt;<a class="code" href="structcl__attr.html#ad219a939eaf54b1de26b049f26d513e3" title="Change time.">cat_ctime</a>;
<a name="l01123"></a>01123         lvb-&gt;lvb_blocks = attr-&gt;<a class="code" href="structcl__attr.html#aa5bce270584ece6d9511008c0d827821" title="Blocks allocated to this cl_object on the server file system.">cat_blocks</a>;
<a name="l01124"></a>01124         EXIT;
<a name="l01125"></a>01125 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga7f11d31070279077648197650a60f10e"></a><!-- doxytag: member="cl_object.h::cl_io_slice_add" ref="ga7f11d31070279077648197650a60f10e" args="(struct cl_io *io, struct cl_io_slice *slice, struct cl_object *obj, const struct cl_io_operations *ops)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cl_io_slice_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcl__io.html">cl_io</a> *&nbsp;</td>
          <td class="paramname"> <em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__io__slice.html">cl_io_slice</a> *&nbsp;</td>
          <td class="paramname"> <em>slice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structcl__io__operations.html">cl_io_operations</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds io slice to the <a class="el" href="structcl__io.html" title="State for io.">cl_io</a>. </p>
<p>This is called by <a class="el" href="structcl__object__operations.html#a8b8a7168fdc690b21120ab5d03ae67ce" title="Initialize io state for a given layer.">cl_object_operations::coo_io_init()</a> methods to add a per-layer state to the io. New state is added at the end of <a class="el" href="structcl__io.html#ab5a63aa434fec58687af4e284ab2392b" title="List of slices.">cl_io::ci_layers</a> list, that is, it is at the bottom of the stack.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__clio.html#ga9c2fdf8ae73a6f36bc8df4249459da93" title="Adds lock slice to the compound lock.">cl_lock_slice_add()</a>, cl_req_slice_add(), <a class="el" href="group__clio.html#gaf9c2b2723494e52efc66d52fe2d0b93f" title="Adds page slice to the compound page.">cl_page_slice_add()</a> </dd></dl>

<p>Definition at line <a class="el" href="cl__io_8c_source.html#l00831">831</a> of file <a class="el" href="cl__io_8c_source.html">cl_io.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l01759">cl_io::ci_layers</a>, <a class="el" href="cl__object_8h_source.html#l01443">cl_io_slice::cis_iop</a>, <a class="el" href="cl__object_8h_source.html#l01448">cl_io_slice::cis_linkage</a>, and <a class="el" href="cl__object_8h_source.html#l01441">cl_io_slice::cis_obj</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00834"></a>00834 {
<a name="l00835"></a>00835         <span class="keyword">struct </span><a class="code" href="structlist__head.html">list_head</a> *linkage = &amp;slice-&gt;<a class="code" href="structcl__io__slice.html#a14f89af8e28c08c0c20c1a157e7ec9e9" title="linkage into a list of all slices for a given cl_io, hanging off cl_io::ci_layers...">cis_linkage</a>;
<a name="l00836"></a>00836 
<a name="l00837"></a>00837         LASSERT((linkage-&gt;prev == NULL &amp;&amp; linkage-&gt;next == NULL) ||
<a name="l00838"></a>00838                 list_empty(linkage));
<a name="l00839"></a>00839         ENTRY;
<a name="l00840"></a>00840 
<a name="l00841"></a>00841         list_add_tail(linkage, &amp;io-&gt;<a class="code" href="structcl__io.html#ab5a63aa434fec58687af4e284ab2392b" title="List of slices.">ci_layers</a>);
<a name="l00842"></a>00842         slice-&gt;cis_io  = io;
<a name="l00843"></a>00843         slice-&gt;<a class="code" href="structcl__io__slice.html#a9f4d53548c52d6d9639819fd62557008" title="corresponding object slice.">cis_obj</a> = obj;
<a name="l00844"></a>00844         slice-&gt;<a class="code" href="structcl__io__slice.html#a18ddc4d2d844be0a28d5303ca1e79964" title="io operations.">cis_iop</a> = ops;
<a name="l00845"></a>00845         EXIT;
<a name="l00846"></a>00846 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga9c2fdf8ae73a6f36bc8df4249459da93"></a><!-- doxytag: member="cl_object.h::cl_lock_slice_add" ref="ga9c2fdf8ae73a6f36bc8df4249459da93" args="(struct cl_lock *lock, struct cl_lock_slice *slice, struct cl_object *obj, const struct cl_lock_operations *ops)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cl_lock_slice_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcl__lock.html">cl_lock</a> *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__lock__slice.html">cl_lock_slice</a> *&nbsp;</td>
          <td class="paramname"> <em>slice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structcl__lock__operations.html">cl_lock_operations</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds lock slice to the compound lock. </p>
<p>This is called by <a class="el" href="structcl__object__operations.html#a636de14a3118ef9d708121f95a1330e4" title="Initialize lock slice for this layer.">cl_object_operations::coo_lock_init()</a> methods to add a per-layer state to the lock. New state is added at the end of <a class="el" href="structcl__lock.html#a0b01a26d3cefbee85d1c803a490b34e8" title="List of slices.">cl_lock::cll_layers</a> list, that is, it is at the bottom of the stack.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>cl_req_slice_add(), <a class="el" href="group__clio.html#gaf9c2b2723494e52efc66d52fe2d0b93f" title="Adds page slice to the compound page.">cl_page_slice_add()</a>, <a class="el" href="group__clio.html#ga7f11d31070279077648197650a60f10e" title="Adds io slice to the cl_io.">cl_io_slice_add()</a> </dd></dl>

<p>Definition at line <a class="el" href="cl__lock_8c_source.html#l00072">72</a> of file <a class="el" href="cl__lock_8c_source.html">cl_lock.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l01191">cl_lock::cll_layers</a>, <a class="el" href="cl__object_8h_source.html#l01208">cl_lock_slice::cls_linkage</a>, and <a class="el" href="cl__object_8h_source.html#l01205">cl_lock_slice::cls_obj</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00075"></a>00075 {
<a name="l00076"></a>00076         ENTRY;
<a name="l00077"></a>00077         slice-&gt;cls_lock = lock;
<a name="l00078"></a>00078         list_add_tail(&amp;slice-&gt;<a class="code" href="structcl__lock__slice.html#ade7bcd39b007dcafd05e98434e3ee990" title="Linkage into cl_lock::cll_layers.">cls_linkage</a>, &amp;lock-&gt;<a class="code" href="structcl__lock.html#a0b01a26d3cefbee85d1c803a490b34e8" title="List of slices.">cll_layers</a>);
<a name="l00079"></a>00079         slice-&gt;<a class="code" href="structcl__lock__slice.html#a7b92d10a7e81059bb811ba196a438d56" title="Object slice corresponding to this lock slice.">cls_obj</a> = obj;
<a name="l00080"></a>00080         slice-&gt;cls_ops = ops;
<a name="l00081"></a>00081         EXIT;
<a name="l00082"></a>00082 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="gad69ffcfdd3d835937721abdc10dd1098"></a><!-- doxytag: member="cl_object.h::cl_lvb2attr" ref="gad69ffcfdd3d835937721abdc10dd1098" args="(struct cl_attr *attr, const struct ost_lvb *lvb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cl_lvb2attr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcl__attr.html">cl_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structost__lvb.html">ost_lvb</a> *&nbsp;</td>
          <td class="paramname"> <em>lvb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Converts struct <a class="el" href="structost__lvb.html">ost_lvb</a> to struct <a class="el" href="structcl__attr.html" title="&quot;Data attributes&quot; of cl_object.">cl_attr</a>. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__clio.html#ga5a05126b8b0aeb6f733aa358791aeed2" title="Converts struct cl_attr to struct ost_lvb.">cl_attr2lvb</a> </dd></dl>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l01132">1132</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00153">cl_attr::cat_atime</a>, <a class="el" href="cl__object_8h_source.html#l00161">cl_attr::cat_blocks</a>, <a class="el" href="cl__object_8h_source.html#l00155">cl_attr::cat_ctime</a>, <a class="el" href="cl__object_8h_source.html#l00151">cl_attr::cat_mtime</a>, and <a class="el" href="cl__object_8h_source.html#l00143">cl_attr::cat_size</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01133"></a>01133 {
<a name="l01134"></a>01134         ENTRY;
<a name="l01135"></a>01135         attr-&gt;<a class="code" href="structcl__attr.html#a301cbfa8e597852a6f7cf1b5a22d5269" title="Object size, in bytes.">cat_size</a>   = lvb-&gt;lvb_size;
<a name="l01136"></a>01136         attr-&gt;<a class="code" href="structcl__attr.html#ac337ab4467993ed3c1ed8a74407e933b" title="Modification time.">cat_mtime</a>  = lvb-&gt;lvb_mtime;
<a name="l01137"></a>01137         attr-&gt;<a class="code" href="structcl__attr.html#a703fa4a91dbf487ea43a491efbcbb26c" title="Access time.">cat_atime</a>  = lvb-&gt;lvb_atime;
<a name="l01138"></a>01138         attr-&gt;<a class="code" href="structcl__attr.html#ad219a939eaf54b1de26b049f26d513e3" title="Change time.">cat_ctime</a>  = lvb-&gt;lvb_ctime;
<a name="l01139"></a>01139         attr-&gt;<a class="code" href="structcl__attr.html#aa5bce270584ece6d9511008c0d827821" title="Blocks allocated to this cl_object on the server file system.">cat_blocks</a> = lvb-&gt;lvb_blocks;
<a name="l01140"></a>01140         EXIT;
<a name="l01141"></a>01141 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="gaf9c2b2723494e52efc66d52fe2d0b93f"></a><!-- doxytag: member="cl_object.h::cl_page_slice_add" ref="gaf9c2b2723494e52efc66d52fe2d0b93f" args="(struct cl_page *page, struct cl_page_slice *slice, struct cl_object *obj, pgoff_t index, const struct cl_page_operations *ops)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cl_page_slice_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcl__page.html">cl_page</a> *&nbsp;</td>
          <td class="paramname"> <em>page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__page__slice.html">cl_page_slice</a> *&nbsp;</td>
          <td class="paramname"> <em>slice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pgoff_t&nbsp;</td>
          <td class="paramname"> <em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structcl__page__operations.html">cl_page_operations</a> *&nbsp;</td>
          <td class="paramname"> <em>ops</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds page slice to the compound page. </p>
<p>This is called by <a class="el" href="structcl__object__operations.html#a86e603bbbf4c6b1625b8dece6cbb5f32" title="Initialize page slice for this layer.">cl_object_operations::coo_page_init()</a> methods to add a per-layer state to the page. New state is added at the end of <a class="el" href="structcl__page.html#a96b574e5021d9b6464adac298980e594" title="List of slices.">cl_page::cp_layers</a> list, that is, it is at the bottom of the stack.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__clio.html#ga9c2fdf8ae73a6f36bc8df4249459da93" title="Adds lock slice to the compound lock.">cl_lock_slice_add()</a>, cl_req_slice_add(), <a class="el" href="group__clio.html#ga7f11d31070279077648197650a60f10e" title="Adds io slice to the cl_io.">cl_io_slice_add()</a> </dd></dl>

<p>Definition at line <a class="el" href="cl__page_8c_source.html#l01080">1080</a> of file <a class="el" href="cl__page_8c_source.html">cl_page.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00726">cl_page::cp_layers</a>, <a class="el" href="cl__object_8h_source.html#l00768">cl_page_slice::cpl_linkage</a>, and <a class="el" href="cl__object_8h_source.html#l00765">cl_page_slice::cpl_obj</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01083"></a>01083 {
<a name="l01084"></a>01084         ENTRY;
<a name="l01085"></a>01085         list_add_tail(&amp;slice-&gt;<a class="code" href="structcl__page__slice.html#a175a12bef0d16b36991be092737a92d1" title="Linkage into cl_page::cp_layers.">cpl_linkage</a>, &amp;page-&gt;<a class="code" href="structcl__page.html#a96b574e5021d9b6464adac298980e594" title="List of slices.">cp_layers</a>);
<a name="l01086"></a>01086         slice-&gt;<a class="code" href="structcl__page__slice.html#a71c54d2bf9c69b3a66df261412d0ba78" title="Object slice corresponding to this page slice.">cpl_obj</a>  = obj;
<a name="l01087"></a>01087         slice-&gt;cpl_index = index;
<a name="l01088"></a>01088         slice-&gt;cpl_ops  = ops;
<a name="l01089"></a>01089         slice-&gt;cpl_page = page;
<a name="l01090"></a>01090         EXIT;
<a name="l01091"></a>01091 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga596455746e16e88acee9318d8d95339d"></a><!-- doxytag: member="cl_object.h::cl_req_attr_set" ref="ga596455746e16e88acee9318d8d95339d" args="(const struct lu_env *env, struct cl_object *obj, struct cl_req_attr *attr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cl_req_attr_set </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlu__env.html">lu_env</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__object.html">cl_object</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__req__attr.html">cl_req_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fills in attributes that are passed to server together with transfer. </p>
<p>Only attributes from <em>flags</em> may be touched. This can be called multiple times for the same request. </p>

<p>Definition at line <a class="el" href="cl__io_8c_source.html#l01174">1174</a> of file <a class="el" href="cl__io_8c_source.html">cl_io.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00454">cl_object_for_each</a>, <a class="el" href="cl__object_8h_source.html#l00229">cl_object::co_ops</a>, and <a class="el" href="structcl__object__operations.html#ac4285e5c1c552110704ba50cce4d326c">cl_object_operations::coo_req_attr_set</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01176"></a>01176 {
<a name="l01177"></a>01177         <span class="keyword">struct </span><a class="code" href="structcl__object.html" title="Sub-class of lu_object with methods common for objects on the client stacks.">cl_object</a> *scan;
<a name="l01178"></a>01178         ENTRY;
<a name="l01179"></a>01179 
<a name="l01180"></a>01180         <a class="code" href="group__cl__object.html#ga6477841d5f3bd9c2a2ca05e2aa089ea9" title="Helper macro: iterate over all layers of the object obj, assigning every layer top-to-bottom...">cl_object_for_each</a>(scan, obj) {
<a name="l01181"></a>01181                 <span class="keywordflow">if</span> (scan-&gt;<a class="code" href="structcl__object.html#a84db2d531bbd895d49cc44b795778064" title="per-object-layer operations">co_ops</a>-&gt;<a class="code" href="structcl__object__operations.html#ac4285e5c1c552110704ba50cce4d326c" title="Set request attributes.">coo_req_attr_set</a> != NULL)
<a name="l01182"></a>01182                         scan-&gt;<a class="code" href="structcl__object.html#a84db2d531bbd895d49cc44b795778064" title="per-object-layer operations">co_ops</a>-&gt;<a class="code" href="structcl__object__operations.html#ac4285e5c1c552110704ba50cce4d326c" title="Set request attributes.">coo_req_attr_set</a>(env, scan, attr);
<a name="l01183"></a>01183         }
<a name="l01184"></a>01184         EXIT;
<a name="l01185"></a>01185 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga5384082c04872b0c11252ead509cdd7a"></a><!-- doxytag: member="cl_object.h::cl_site_fini" ref="ga5384082c04872b0c11252ead509cdd7a" args="(struct cl_site *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cl_site_fini </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcl__site.html">cl_site</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Finalize client site. </p>
<p>Dual to <a class="el" href="group__clio.html#ga57611e1e5715dc94dd0eb503a72a8b33" title="Initialize client site.">cl_site_init()</a>. </p>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00503">503</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="lu__object_8c_source.html#l01140">lu_site_fini()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00504"></a>00504 {
<a name="l00505"></a>00505         <a class="code" href="group__lu.html#ga91afa048e05c24fbd176d46dbc676f61" title="Finalize s and release its resources.">lu_site_fini</a>(&amp;s-&gt;cs_lu);
<a name="l00506"></a>00506 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="group__clio_ga5384082c04872b0c11252ead509cdd7a_cgraph.png" border="0" usemap="#group__clio_ga5384082c04872b0c11252ead509cdd7a_cgraph_map" alt=""></div>
<map name="group__clio_ga5384082c04872b0c11252ead509cdd7a_cgraph_map" id="group__clio_ga5384082c04872b0c11252ead509cdd7a_cgraph">
<area shape="rect" id="node3" href="group__lu.html#ga91afa048e05c24fbd176d46dbc676f61" title="Finalize s and release its resources." alt="" coords="148,5,239,35"/><area shape="rect" id="node5" href="group__lu.html#ga2c86262bfddc5bac1777e7f6fefb35f0" title="Release reference on device d." alt="" coords="288,5,403,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga57611e1e5715dc94dd0eb503a72a8b33"></a><!-- doxytag: member="cl_object.h::cl_site_init" ref="ga57611e1e5715dc94dd0eb503a72a8b33" args="(struct cl_site *s, struct cl_device *top)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cl_site_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcl__site.html">cl_site</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcl__device.html">cl_device</a> *&nbsp;</td>
          <td class="paramname"> <em>d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize client site. </p>
<p>Perform common initialization (<a class="el" href="group__lu.html#ga3776a9c76adcfa00202f6fe19751c96e" title="Initialize site s, with d as the top level device.">lu_site_init()</a>), and initialize statistical counters. Also perform global initializations on the first call. </p>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00484">484</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8c_source.html#l00443">cache_stats_init()</a>, <a class="el" href="cl__object_8h_source.html#l00131">cl_device::cd_lu_dev</a>, <a class="el" href="cl__object_8h_source.html#l01917">cl_site::cs_pages</a>, and <a class="el" href="lu__object_8c_source.html#l01058">lu_site_init()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00485"></a>00485 {
<a name="l00486"></a>00486         <span class="keywordtype">size_t</span> i;
<a name="l00487"></a>00487         <span class="keywordtype">int</span> result;
<a name="l00488"></a>00488 
<a name="l00489"></a>00489         result = <a class="code" href="group__lu.html#ga3776a9c76adcfa00202f6fe19751c96e" title="Initialize site s, with d as the top level device.">lu_site_init</a>(&amp;s-&gt;cs_lu, &amp;d-&gt;<a class="code" href="structcl__device.html#a881ea223a07828242f8c3b02f65792db" title="Super-class.">cd_lu_dev</a>);
<a name="l00490"></a>00490         <span class="keywordflow">if</span> (result == 0) {
<a name="l00491"></a>00491                 <a class="code" href="group__clio.html#ga1e4ceb0e1ebe73971d4b3e7f5efaad02" title="These are not exported so far.">cache_stats_init</a>(&amp;s-&gt;<a class="code" href="structcl__site.html#a2fb2d9347902b0a4662669665229e795" title="Statistical counters.">cs_pages</a>, <span class="stringliteral">&quot;pages&quot;</span>);
<a name="l00492"></a>00492                 <span class="keywordflow">for</span> (i = 0; i &lt; ARRAY_SIZE(s-&gt;cs_pages_state); ++i)
<a name="l00493"></a>00493                         atomic_set(&amp;s-&gt;cs_pages_state[0], 0);
<a name="l00494"></a>00494                 cl_env_percpu_refill();
<a name="l00495"></a>00495         }
<a name="l00496"></a>00496         <span class="keywordflow">return</span> result;
<a name="l00497"></a>00497 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="group__clio_ga57611e1e5715dc94dd0eb503a72a8b33_cgraph.png" border="0" usemap="#group__clio_ga57611e1e5715dc94dd0eb503a72a8b33_cgraph_map" alt=""></div>
<map name="group__clio_ga57611e1e5715dc94dd0eb503a72a8b33_cgraph_map" id="group__clio_ga57611e1e5715dc94dd0eb503a72a8b33_cgraph">
<area shape="rect" id="node3" href="group__clio.html#ga1e4ceb0e1ebe73971d4b3e7f5efaad02" title="These are not exported so far." alt="" coords="151,5,284,35"/><area shape="rect" id="node5" href="group__lu.html#ga3776a9c76adcfa00202f6fe19751c96e" title="Initialize site s, with d as the top level device." alt="" coords="171,59,264,88"/><area shape="rect" id="node7" href="group__lu.html#ga29fe0250f218e64064069bcc3116e481" title="Acquire additional reference on device d." alt="" coords="335,59,449,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga5898f38acc8064feb8aecae6b0cbffd4"></a><!-- doxytag: member="cl_object.h::cl_site_stats_print" ref="ga5898f38acc8064feb8aecae6b0cbffd4" args="(const struct cl_site *site, struct seq_file *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cl_site_stats_print </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structcl__site.html">cl_site</a> *&nbsp;</td>
          <td class="paramname"> <em>site</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct seq_file *&nbsp;</td>
          <td class="paramname"> <em>m</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Output client site statistical counters into a buffer. </p>
<p>Suitable for ll_rd_*()-style functions.</p>
<p>Output client site statistical counters into a buffer.</p>
<p>Suitable for ll_rd_*()-style functions. </p>

<p>Definition at line <a class="el" href="cl__object_8c_source.html#l00518">518</a> of file <a class="el" href="cl__object_8c_source.html">cl_object.c</a>.</p>

<p>References <a class="el" href="cl__object_8h_source.html#l00611">CPS_CACHED</a>, <a class="el" href="cl__object_8h_source.html#l00690">CPS_FREEING</a>, <a class="el" href="cl__object_8h_source.html#l00640">CPS_OWNED</a>, <a class="el" href="cl__object_8h_source.html#l00680">CPS_PAGEIN</a>, <a class="el" href="cl__object_8h_source.html#l00668">CPS_PAGEOUT</a>, <a class="el" href="cl__object_8h_source.html#l01917">cl_site::cs_pages</a>, and <a class="el" href="lu__object_8c_source.html#l02224">lu_site_stats_seq_print()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00519"></a>00519 {
<a name="l00520"></a>00520         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *pstate[] = {
<a name="l00521"></a>00521                 [<a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39a820b29d9f4041d5672898ba94a52a7ba" title="Page is in the cache, un-owned.">CPS_CACHED</a>]    = <span class="stringliteral">&quot;c&quot;</span>,
<a name="l00522"></a>00522                 [<a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39ac64ebd72495a45cc57902f32131deee9" title="Page is exclusively owned by some cl_io.">CPS_OWNED</a>]     = <span class="stringliteral">&quot;o&quot;</span>,
<a name="l00523"></a>00523                 [<a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39a5508b13b7d061f6806482dbb1c20d9e4" title="Page is being written out, as a part of a transfer.">CPS_PAGEOUT</a>]   = <span class="stringliteral">&quot;w&quot;</span>,
<a name="l00524"></a>00524                 [<a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39a23d1b66d4877127e29434eb39ee1b998" title="Page is being read in, as a part of a transfer.">CPS_PAGEIN</a>]    = <span class="stringliteral">&quot;r&quot;</span>,
<a name="l00525"></a>00525                 [<a class="code" href="group__cl__page.html#gga762f808d1d3ac30a12a132d0344f1f39a77531f34ed93e3ddd0ab7c013cdd87d8" title="Page is being destroyed.">CPS_FREEING</a>]   = <span class="stringliteral">&quot;f&quot;</span>
<a name="l00526"></a>00526         };
<a name="l00527"></a>00527         <span class="keywordtype">size_t</span> i;
<a name="l00528"></a>00528 
<a name="l00529"></a>00529 <span class="comment">/*</span>
<a name="l00530"></a>00530 <span class="comment">       lookup    hit  total   busy create</span>
<a name="l00531"></a>00531 <span class="comment">pages: ...... ...... ...... ...... ...... [...... ...... ...... ......]</span>
<a name="l00532"></a>00532 <span class="comment">locks: ...... ...... ...... ...... ...... [...... ...... ...... ...... ......]</span>
<a name="l00533"></a>00533 <span class="comment">  env: ...... ...... ...... ...... ......</span>
<a name="l00534"></a>00534 <span class="comment"> */</span>
<a name="l00535"></a>00535         <a class="code" href="group__lu.html#gaab0f4c7f840a5d798e5a4f23d68abacd" title="Output site statistical counters into a buffer.">lu_site_stats_seq_print</a>(&amp;site-&gt;cs_lu, m);
<a name="l00536"></a>00536         cache_stats_print(&amp;site-&gt;<a class="code" href="structcl__site.html#a2fb2d9347902b0a4662669665229e795" title="Statistical counters.">cs_pages</a>, m, 1);
<a name="l00537"></a>00537         seq_printf(m, <span class="stringliteral">&quot; [&quot;</span>);
<a name="l00538"></a>00538         <span class="keywordflow">for</span> (i = 0; i &lt; ARRAY_SIZE(site-&gt;cs_pages_state); ++i)
<a name="l00539"></a>00539                 seq_printf(m, <span class="stringliteral">&quot;%s: %u &quot;</span>, pstate[i],
<a name="l00540"></a>00540                            atomic_read(&amp;site-&gt;cs_pages_state[i]));
<a name="l00541"></a>00541         seq_printf(m, <span class="stringliteral">&quot;]\n&quot;</span>);
<a name="l00542"></a>00542         cache_stats_print(&amp;cl_env_stats, m, 0);
<a name="l00543"></a>00543         seq_printf(m, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00544"></a>00544         <span class="keywordflow">return</span> 0;
<a name="l00545"></a>00545 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="group__clio_ga5898f38acc8064feb8aecae6b0cbffd4_cgraph.png" border="0" usemap="#group__clio_ga5898f38acc8064feb8aecae6b0cbffd4_cgraph_map" alt=""></div>
<map name="group__clio_ga5898f38acc8064feb8aecae6b0cbffd4_cgraph_map" id="group__clio_ga5898f38acc8064feb8aecae6b0cbffd4_cgraph">
<area shape="rect" id="node3" href="group__lu.html#gaab0f4c7f840a5d798e5a4f23d68abacd" title="Output site statistical counters into a buffer." alt="" coords="200,5,379,35"/></map>
</div>
</p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 20:55:37 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
