<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Lustre: ptlrpc_service_part Struct Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body fgcolor="#202020">
<img src="http://wiki.lustre.org/apidoc/header.jpg">
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structure&nbsp;Index</span></a></li>
      <li><a href="functions.html"><span>Data&nbsp;Fields</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>ptlrpc_service_part Struct Reference<br/>
<small>
[<a class="el" href="group__net.html">net</a>]</small>
</h1><!-- doxytag: class="ptlrpc_service_part" -->
<p>Definition of PortalRPC service partition data.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="lustre__net_8h_source.html">lustre_net.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for ptlrpc_service_part:</div>
<div class="dynsection">
<div class="center"><img src="structptlrpc__service__part__coll__graph.png" border="0" usemap="#ptlrpc__service__part_coll__map" alt="Collaboration graph"/></div>
<map name="ptlrpc__service__part_coll__map" id="ptlrpc__service__part_coll__map">
<area shape="rect" id="node7" href="structptlrpc__service.html" title="Definition of PortalRPC service." alt="" coords="316,1553,521,2071"/><area shape="rect" id="node23" href="structptlrpc__nrs.html" title="NRS head." alt="" coords="849,1665,1009,1959"/><area shape="rect" id="node2" href="structlist__head.html" title="{list_head\n|+ next\l+ prev\l|}" alt="" coords="1059,31,1141,134"/><area shape="rect" id="node27" href="structptlrpc__nrs__policy.html" title="NRS policy." alt="" coords="855,2155,996,2413"/><area shape="rect" id="node29" href="structptlrpc__nrs__pol__desc.html" title="NRS policy registering descriptor." alt="" coords="1247,3475,1433,3682"/><area shape="rect" id="node39" href="structnrs__tbf__req.html" title="{nrs_tbf_req\n|+ tr_list\l+ tr_sequence\l|}" alt="" coords="1517,441,1637,543"/><area shape="rect" id="node54" href="structnrs__fifo__req.html" title="{nrs_fifo_req\n|+ fr_list\l+ fr_sequence\l|}" alt="" coords="1228,1425,1345,1527"/><area shape="rect" id="node60" href="structptlrpc__at__array.html" title="{ptlrpc_at_array\n|+ paa_reqs_array\l+ paa_size\l+ paa_count\l+ paa_deadline\l+ paa_reqs_count\l|}" alt="" coords="683,244,824,399"/><area shape="rect" id="node5" href="structadaptive__timeout.html" title="{adaptive_timeout\n|+ at_binstart\l+ at_hist\l+ at_flags\l+ at_current\l+ at_worst_ever\l+ at_worst_time\l+ at_lock\l|}" alt="" coords="517,227,659,416"/><area shape="rect" id="node10" href="structlprocfs__stats.html" title="{lprocfs_stats\n|+ ls_num\l+ ls_biggest_alloc_num\l+ ls_flags\l+ ls_lock\l+ ls_cnt_header\l+ ls_percpu\l|}" alt="" coords="181,898,357,1070"/><area shape="rect" id="node12" href="structlprocfs__percpu.html" title="{lprocfs_percpu\n|+ lp_cntr\l|}" alt="" coords="39,279,156,364"/><area shape="rect" id="node14" href="structlprocfs__counter.html" title="{lprocfs_counter\n|+ lc_count\l+ lc_min\l+ lc_max\l+ lc_sumsquare\l+ lc_array_sum\l|}" alt="" coords="35,5,160,160"/><area shape="rect" id="node16" href="structlprocfs__counter__header.html" title="{lprocfs_counter_header\n|+ lc_config\l+ lc_name\l+ lc_units\l|}" alt="" coords="180,261,359,381"/><area shape="rect" id="node18" href="structptlrpc__service__ops.html" title="{ptlrpc_service_ops\n|+ so_thr_init\l+ so_thr_done\l+ so_req_handler\l+ so_hpreq_handler\l+ so_req_printer\l|}" alt="" coords="5,907,157,1061"/><area shape="rect" id="node21" href="structcfs__cpt__table.html" title="{cfs_cpt_table\n|+ ctb_nparts\l+ ctb_mask\l+ ctb_nodemask\l+ ctb_version\l|}" alt="" coords="433,915,567,1053"/><area shape="rect" id="node35" href="structptlrpc__nrs__resource.html" title="NRS resource." alt="" coords="848,2533,1003,2635"/><area shape="rect" id="node31" href="structptlrpc__nrs__pol__ops.html" title="NRS policy operations." alt="" coords="1267,3115,1413,3408"/><area shape="rect" id="node33" href="structptlrpc__nrs__request.html" title="NRS request." alt="" coords="1267,2755,1413,3048"/><area shape="rect" id="node42" href="structnrs__crrn__req.html" title="CRR&#45;N NRS request definition." alt="" coords="1581,2533,1704,2635"/><area shape="rect" id="node44" href="structnrs__orr__req.html" title="ORR/TRR NRS request definition." alt="" coords="1340,2481,1479,2687"/><area shape="rect" id="node46" href="structnrs__orr__key.html" title="As unique keys for grouping RPCs together, we use the object&#39;s OST FID for the..." alt="" coords="1471,2224,1569,2344"/><area shape="rect" id="node48" href="structlu__fid.html" title="File IDentifier." alt="" coords="1484,1752,1556,1872"/><area shape="rect" id="node50" href="structnrs__orr__req__range.html" title="Lower and upper byte offsets of a brw RPC." alt="" coords="1305,2233,1447,2335"/><area shape="rect" id="node52" href="structcfs__binheap__node.html" title="Binary heap node." alt="" coords="1124,2541,1265,2627"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Fields</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a45f53648b1a614576a8044aa875fa4cc"></a><!-- doxytag: member="ptlrpc_service_part::__cfs_cacheline_aligned" ref="a45f53648b1a614576a8044aa875fa4cc" args="" -->
struct <a class="el" href="structptlrpc__service.html">ptlrpc_service</a> *scp_service&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a45f53648b1a614576a8044aa875fa4cc">__cfs_cacheline_aligned</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">back reference to owner <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a616b2db3286d5fe98329a0322b348faf"></a><!-- doxytag: member="ptlrpc_service_part::scp_cpt" ref="a616b2db3286d5fe98329a0322b348faf" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>scp_cpt</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af6581a250bb165eb31291b5daf4a422e"></a><!-- doxytag: member="ptlrpc_service_part::scp_thr_nextid" ref="af6581a250bb165eb31291b5daf4a422e" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#af6581a250bb165eb31291b5daf4a422e">scp_thr_nextid</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">always increasing number <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0eb7001f059ddeb079a5b5cc633c837a"></a><!-- doxytag: member="ptlrpc_service_part::scp_nthrs_starting" ref="a0eb7001f059ddeb079a5b5cc633c837a" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a0eb7001f059ddeb079a5b5cc633c837a">scp_nthrs_starting</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"># of starting threads <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac4d1c9dcf8c480670ff145c147964a9c"></a><!-- doxytag: member="ptlrpc_service_part::scp_nthrs_stopping" ref="ac4d1c9dcf8c480670ff145c147964a9c" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#ac4d1c9dcf8c480670ff145c147964a9c">scp_nthrs_stopping</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"># of stopping threads, reserved for shrinking threads <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a281b166ae15b1ba09ae338866750ba77"></a><!-- doxytag: member="ptlrpc_service_part::scp_nthrs_running" ref="a281b166ae15b1ba09ae338866750ba77" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a281b166ae15b1ba09ae338866750ba77">scp_nthrs_running</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"># running threads <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a658b2ed23da83f38e3acbe91191412e0"></a><!-- doxytag: member="ptlrpc_service_part::scp_threads" ref="a658b2ed23da83f38e3acbe91191412e0" args="" -->
struct <a class="el" href="structlist__head.html">list_head</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a658b2ed23da83f38e3acbe91191412e0">scp_threads</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">service threads list <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac032a55e8e53094bebf77b83f52f9095"></a><!-- doxytag: member="ptlrpc_service_part::__cfs_cacheline_aligned" ref="ac032a55e8e53094bebf77b83f52f9095" args="" -->
spinlock_t scp_lock&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#ac032a55e8e53094bebf77b83f52f9095">__cfs_cacheline_aligned</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">serialize the following fields, used for protecting rqbd list and incoming requests waiting for preprocess, threads starting &amp; stopping are also protected by this lock. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a44b088268ad85c097e75785018da059f"></a><!-- doxytag: member="ptlrpc_service_part::scp_nrqbds_total" ref="a44b088268ad85c097e75785018da059f" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a44b088268ad85c097e75785018da059f">scp_nrqbds_total</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">total # req buffer descs allocated <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a498a960c1ab556b2cd15ff122069133a"></a><!-- doxytag: member="ptlrpc_service_part::scp_nrqbds_posted" ref="a498a960c1ab556b2cd15ff122069133a" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a498a960c1ab556b2cd15ff122069133a">scp_nrqbds_posted</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"># posted request buffers for receiving <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad128b103863a3a90a2a0fffeaa9b0198"></a><!-- doxytag: member="ptlrpc_service_part::scp_rqbd_allocating" ref="ad128b103863a3a90a2a0fffeaa9b0198" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#ad128b103863a3a90a2a0fffeaa9b0198">scp_rqbd_allocating</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">in progress of allocating rqbd <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8283d58f626b885a04d59e22ac5b234a"></a><!-- doxytag: member="ptlrpc_service_part::scp_nreqs_incoming" ref="a8283d58f626b885a04d59e22ac5b234a" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a8283d58f626b885a04d59e22ac5b234a">scp_nreqs_incoming</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"># incoming reqs <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4861a69db14903c4e80982c48be76c8b"></a><!-- doxytag: member="ptlrpc_service_part::scp_rqbd_idle" ref="a4861a69db14903c4e80982c48be76c8b" args="" -->
struct <a class="el" href="structlist__head.html">list_head</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a4861a69db14903c4e80982c48be76c8b">scp_rqbd_idle</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">request buffers to be reposted <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acd3cb2ad8f3ef3e78751f83373c0e688"></a><!-- doxytag: member="ptlrpc_service_part::scp_rqbd_posted" ref="acd3cb2ad8f3ef3e78751f83373c0e688" args="" -->
struct <a class="el" href="structlist__head.html">list_head</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#acd3cb2ad8f3ef3e78751f83373c0e688">scp_rqbd_posted</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">req buffers receiving <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a54fb502a4f6c138aaa49eb9afea6e39c"></a><!-- doxytag: member="ptlrpc_service_part::scp_req_incoming" ref="a54fb502a4f6c138aaa49eb9afea6e39c" args="" -->
struct <a class="el" href="structlist__head.html">list_head</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a54fb502a4f6c138aaa49eb9afea6e39c">scp_req_incoming</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">incoming reqs <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a22eb45de0fb6b349d79bb092fb83c00a"></a><!-- doxytag: member="ptlrpc_service_part::scp_rqbd_timeout" ref="a22eb45de0fb6b349d79bb092fb83c00a" args="" -->
cfs_duration_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a22eb45de0fb6b349d79bb092fb83c00a">scp_rqbd_timeout</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">timeout before re-posting reqs, in tick <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">wait_queue_head_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#aea613ac08a7dc84e671b4a260eed2765">scp_waitq</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">all threads sleep on this.  <a href="#aea613ac08a7dc84e671b4a260eed2765"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a73331d554c2adc1cd1b47d6949cee7b4"></a><!-- doxytag: member="ptlrpc_service_part::scp_hist_reqs" ref="a73331d554c2adc1cd1b47d6949cee7b4" args="" -->
struct <a class="el" href="structlist__head.html">list_head</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a73331d554c2adc1cd1b47d6949cee7b4">scp_hist_reqs</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">request history <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa72950e08d334ab8f1964a2640971efd"></a><!-- doxytag: member="ptlrpc_service_part::scp_hist_rqbds" ref="aa72950e08d334ab8f1964a2640971efd" args="" -->
struct <a class="el" href="structlist__head.html">list_head</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#aa72950e08d334ab8f1964a2640971efd">scp_hist_rqbds</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">request buffer history <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a46f749b9c04d8a939db8e29cbadadb0f"></a><!-- doxytag: member="ptlrpc_service_part::scp_hist_nrqbds" ref="a46f749b9c04d8a939db8e29cbadadb0f" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a46f749b9c04d8a939db8e29cbadadb0f">scp_hist_nrqbds</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"># request buffers in history <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9331a053ab8db12d43cfc74d75043f4e"></a><!-- doxytag: member="ptlrpc_service_part::scp_hist_seq" ref="a9331a053ab8db12d43cfc74d75043f4e" args="" -->
__u64&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a9331a053ab8db12d43cfc74d75043f4e">scp_hist_seq</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">sequence number for request <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aac3eedd439a5c744ab1cd7885152c68a"></a><!-- doxytag: member="ptlrpc_service_part::scp_hist_seq_culled" ref="aac3eedd439a5c744ab1cd7885152c68a" args="" -->
__u64&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#aac3eedd439a5c744ab1cd7885152c68a">scp_hist_seq_culled</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">highest seq culled from history <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa728eb6851d386b9eee3fd84ff1d37e5"></a><!-- doxytag: member="ptlrpc_service_part::__cfs_cacheline_aligned" ref="aa728eb6851d386b9eee3fd84ff1d37e5" args="" -->
spinlock_t scp_req_lock&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#aa728eb6851d386b9eee3fd84ff1d37e5">__cfs_cacheline_aligned</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">serialize the following fields, used for processing requests sent to this portal <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#afa479ca58224b1f1eb30793a2ebd7e65">scp_nreqs_active</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"># reqs in either of the NRS heads below  <a href="#afa479ca58224b1f1eb30793a2ebd7e65"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5cb3e1be6fad443994888bc086aa5283"></a><!-- doxytag: member="ptlrpc_service_part::scp_nhreqs_active" ref="a5cb3e1be6fad443994888bc086aa5283" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a5cb3e1be6fad443994888bc086aa5283">scp_nhreqs_active</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"># HPreqs being served <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af8d242d89a56c88d4522319d5ec82b94"></a><!-- doxytag: member="ptlrpc_service_part::scp_hreq_count" ref="af8d242d89a56c88d4522319d5ec82b94" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#af8d242d89a56c88d4522319d5ec82b94">scp_hreq_count</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"># hp requests handled <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaf079ff0824776d6cbf221ce0a736d4e"></a><!-- doxytag: member="ptlrpc_service_part::scp_nrs_reg" ref="aaf079ff0824776d6cbf221ce0a736d4e" args="" -->
struct <a class="el" href="structptlrpc__nrs.html">ptlrpc_nrs</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#aaf079ff0824776d6cbf221ce0a736d4e">scp_nrs_reg</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">NRS head for regular requests. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2daee35dee137743332c42d1ba3eaea1"></a><!-- doxytag: member="ptlrpc_service_part::scp_nrs_hp" ref="a2daee35dee137743332c42d1ba3eaea1" args="" -->
struct <a class="el" href="structptlrpc__nrs.html">ptlrpc_nrs</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a2daee35dee137743332c42d1ba3eaea1">scp_nrs_hp</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">NRS head for HP requests; this is only valid for services that can handle HP requests. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa25cfa93e5fe2aec6d68558d70e03b69"></a><!-- doxytag: member="ptlrpc_service_part::__cfs_cacheline_aligned" ref="aa25cfa93e5fe2aec6d68558d70e03b69" args="" -->
spinlock_t scp_rep_lock&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#aa25cfa93e5fe2aec6d68558d70e03b69">__cfs_cacheline_aligned</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">serialize the following fields, used for processing replies for this portal <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a38155a97f15fe794ff8720e2f8bcf249"></a><!-- doxytag: member="ptlrpc_service_part::scp_rep_active" ref="a38155a97f15fe794ff8720e2f8bcf249" args="" -->
struct <a class="el" href="structlist__head.html">list_head</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a38155a97f15fe794ff8720e2f8bcf249">scp_rep_active</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">all the active replies <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1ba1dd17ce94daf0c4b82611d2203b77"></a><!-- doxytag: member="ptlrpc_service_part::scp_rep_idle" ref="a1ba1dd17ce94daf0c4b82611d2203b77" args="" -->
struct <a class="el" href="structlist__head.html">list_head</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a1ba1dd17ce94daf0c4b82611d2203b77">scp_rep_idle</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">List of free reply_states. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2053b8073689ec3cedd16a7095656a13"></a><!-- doxytag: member="ptlrpc_service_part::scp_rep_waitq" ref="a2053b8073689ec3cedd16a7095656a13" args="" -->
wait_queue_head_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a2053b8073689ec3cedd16a7095656a13">scp_rep_waitq</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">waitq to run, when adding stuff to srv_free_rs_list <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a53b120d0b76021b70f62730a7fb490fe"></a><!-- doxytag: member="ptlrpc_service_part::scp_nreps_difficult" ref="a53b120d0b76021b70f62730a7fb490fe" args="" -->
atomic_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a53b120d0b76021b70f62730a7fb490fe">scp_nreps_difficult</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"># 'difficult' replies <br/></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrpd41d8cd98f00b204e9800998ecf8427e"></a> </p>
<br/><br/></div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">spinlock_t scp_at_lock&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#a690c0b60917bb43cf55d824846572969">__cfs_cacheline_aligned</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">AT stuff.  <a href="#a690c0b60917bb43cf55d824846572969"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afdd717e7ea139bdf2e2914ac425c8754"></a><!-- doxytag: member="ptlrpc_service_part::scp_at_estimate" ref="afdd717e7ea139bdf2e2914ac425c8754" args="" -->
struct <a class="el" href="structadaptive__timeout.html">adaptive_timeout</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#afdd717e7ea139bdf2e2914ac425c8754">scp_at_estimate</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">estimated rpc service time <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aba4a06d005f80a1ffb87884f00b68698"></a><!-- doxytag: member="ptlrpc_service_part::scp_at_array" ref="aba4a06d005f80a1ffb87884f00b68698" args="" -->
struct <a class="el" href="structptlrpc__at__array.html">ptlrpc_at_array</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#aba4a06d005f80a1ffb87884f00b68698">scp_at_array</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">reqs waiting for replies <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac1e4c68a5aa6d83f2e5441ea05fe9d52"></a><!-- doxytag: member="ptlrpc_service_part::scp_at_timer" ref="ac1e4c68a5aa6d83f2e5441ea05fe9d52" args="" -->
struct timer_list&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#ac1e4c68a5aa6d83f2e5441ea05fe9d52">scp_at_timer</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">early reply timer <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa705fe1ad3fe28ba1b44a3ea327e185f"></a><!-- doxytag: member="ptlrpc_service_part::scp_at_checktime" ref="aa705fe1ad3fe28ba1b44a3ea327e185f" args="" -->
cfs_time_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#aa705fe1ad3fe28ba1b44a3ea327e185f">scp_at_checktime</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">debug <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af1d7d89389261e865e0333f652c77b22"></a><!-- doxytag: member="ptlrpc_service_part::scp_at_check" ref="af1d7d89389261e865e0333f652c77b22" args="" -->
unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structptlrpc__service__part.html#af1d7d89389261e865e0333f652c77b22">scp_at_check</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">check early replies <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Definition of PortalRPC service partition data. </p>
<p>Although a service only has one instance of it right now, but we will have multiple instances very soon (instance per CPT).</p>
<p>it has four locks: <em>scp_lock</em> serialize operations on rqbd and requests waiting for preprocess <em>scp_req_lock</em> serialize operations active requests sent to this portal <em>scp_at_lock</em> serialize adaptive timeout stuff <em>scp_rep_lock</em> serialize operations on RS list (reply states)</p>
<p>We don't have any use-case to take two or more locks at the same time for now, so there is no lock order issue. </p>

<p>Definition at line <a class="el" href="lustre__net_8h_source.html#l01749">1749</a> of file <a class="el" href="lustre__net_8h_source.html">lustre_net.h</a>.</p>
<hr/><h2>Field Documentation</h2>
<a class="anchor" id="a690c0b60917bb43cf55d824846572969"></a><!-- doxytag: member="ptlrpc_service_part::__cfs_cacheline_aligned" ref="a690c0b60917bb43cf55d824846572969" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">spinlock_t scp_at_lock <a class="el" href="structptlrpc__service__part.html#a45f53648b1a614576a8044aa875fa4cc">ptlrpc_service_part::__cfs_cacheline_aligned</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>AT stuff. </p>
<p>serialize the following fields, used for changes on adaptive timeout </p>

<p>Definition at line <a class="el" href="lustre__net_8h_source.html#l01829">1829</a> of file <a class="el" href="lustre__net_8h_source.html">lustre_net.h</a>.</p>

</div>
</div>
<a class="anchor" id="afa479ca58224b1f1eb30793a2ebd7e65"></a><!-- doxytag: member="ptlrpc_service_part::scp_nreqs_active" ref="afa479ca58224b1f1eb30793a2ebd7e65" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="structptlrpc__service__part.html#afa479ca58224b1f1eb30793a2ebd7e65">ptlrpc_service_part::scp_nreqs_active</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p># reqs in either of the NRS heads below </p>
<p># reqs being served </p>

<p>Definition at line <a class="el" href="lustre__net_8h_source.html#l01811">1811</a> of file <a class="el" href="lustre__net_8h_source.html">lustre_net.h</a>.</p>

</div>
</div>
<a class="anchor" id="aea613ac08a7dc84e671b4a260eed2765"></a><!-- doxytag: member="ptlrpc_service_part::scp_waitq" ref="aea613ac08a7dc84e671b4a260eed2765" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">wait_queue_head_t <a class="el" href="structptlrpc__service__part.html#aea613ac08a7dc84e671b4a260eed2765">ptlrpc_service_part::scp_waitq</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>all threads sleep on this. </p>
<p>This wait-queue is signalled when new incoming request arrives and when difficult reply has to be handled. </p>

<p>Definition at line <a class="el" href="lustre__net_8h_source.html#l01791">1791</a> of file <a class="el" href="lustre__net_8h_source.html">lustre_net.h</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>lustre/include/<a class="el" href="lustre__net_8h_source.html">lustre_net.h</a></li>
</ul>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Jun 5 21:07:07 2016 for Lustre by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.6.1</small></address><br>
<small><a href="http://www.sun.com/contact">Contact</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/index.html">About Sun</a>&nbsp;|&nbsp;<a href="http://www.sun.com/aboutsun/media/index.html">News</a>&nbsp;|&nbsp;<a href="http://www.sun.com/corp_emp/">Employment</a>&nbsp;|&nbsp;<a href="http://www.sun.com/privacy/">Privacy</a>&nbsp;|&nbsp;<a href="http://www.sun.com/share/text/termsofuse.html">Terms of Use</a>&nbsp;|&nbsp;<a href="http://www.sun.com/suntrademarks/">Trademarks</a>&nbsp;|&nbsp;(C) 2008 Sun Microsystems, Inc.</small>
</body>
</html>
